{
    "source": "BDSA",
    "name": "BDSA-2020-3587",
    "title": "BookStack Vulnerable to Stored Cross-Site Scripting (XSS) via Comment Section Component",
    "description": "BookStack is vulnerable to cross-site scripting (XSS) through the `Comment` section. This allows an attacker to inject malicious code into a victim's browser in order to steal user session cookies or other sensitive information. The attacker must trick the victim into clicking a malicious link in order to achieve this.",
    "technicalDescription": "This issue occurs in the 'Comment' section of BookStack. An attacker can inject a malicious JavaScript payload into a comment due to insufficient input validation. When an authenticated user lands on the comment section, the stored payload will be executed in their browser. \n\nThe vendor advises that the following action should be taken after implementing the patch:\n> After upgrading, The command `php artisan bookstack:regenerate-comment-content` should be ran to remove any pre-existing dangerous content.",
    "publishedDate": "2020-12-01T16:09:32.381Z",
    "updatedDate": "2020-12-01T16:09:32.375Z",
    "disclosureDate": "2020-05-02T00:00:00.000Z",
    "solution": "Fixed in [**0.29.2**](https://github.com/BookStackApp/BookStack/tree/v0.29.2).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Kenichi Okuno, JPCERT/CC",
    "workaround": "The vendor states that:\n\n> Comments can be disabled in the system settings to prevent them being shown to users. Alternatively, comment creation permissions can be altered as required to only those who are trusted but this will not address existing exploitation of this vulnerability.\n\nThe vendor also states:\n\n> After upgrading, The command php artisan bookstack:regenerate-comment-content should be ran to remove any pre-existing dangerous content.",
    "vendorFixDate": "2020-05-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3587",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11055",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3587/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/releases/tag/v0.29.2",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/security/advisories/GHSA-5vf7-q87h-pg6w",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/security/advisories/GHSA-5vf7-q87h-pg6w",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/tree/v0.29.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3587/default-remediation-status"
            }
        ]
    }
}