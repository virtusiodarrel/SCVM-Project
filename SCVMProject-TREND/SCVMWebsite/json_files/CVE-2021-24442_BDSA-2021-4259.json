{
    "source": "BDSA",
    "name": "BDSA-2021-4259",
    "title": "WordPress Poll, Survey, Questionnaire and Voting System Vulnerable to Blind SQL Injection (SQLi) via 'date_answers' POST Parameter",
    "description": "WordPress Poll, Survey, Questionnaire and Voting System contains a blind SQL injection (SQLi) vulnerability due to lack of sanitization of user input. This could potentially allow an unauthenticated attacker to alter or retrieve information stored on the applications database.",
    "technicalDescription": "The vulnerability exists in the `front_end.php` page within the `save_poll_in_databese()` function. There is no sanitization of the variable `$new_answer` as it is passed to the SQL query when a user is changing their vote answer from the first vote answer on a poll. This could allow an attacker to inject malicious SQL commands via this unsanitized variable. This had been mitigated in versions **1.5.1** however it was later discovered that the same vulnerability remained in versions **1.5.1** and **1.5.2** when a user was casting a vote for the first time through the variable `$answer`.\n\nThis has been mitigated by sanitizing both `$new_answer` and `$answer` variables using the `intval()` function which converts the value stored in these variables to a integer so that SQLi cannot be performed.",
    "publishedDate": "2022-03-25T15:07:06.391Z",
    "updatedDate": "2022-04-01T11:34:01.988Z",
    "disclosureDate": "2021-06-22T00:00:00.000Z",
    "exploitPublishDate": "2022-03-22T00:00:00.000Z",
    "solution": "Fixed in version [**1.5.3**](https://en-gb.wordpress.org/plugins/polls-widget/advanced/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Toby Jackson",
    "workaround": "",
    "vendorFixDate": "2021-06-22T00:00:00.000Z",
    "discoveryDate": "2021-06-09T00:00:00.000Z",
    "vendorNotifiedDate": "2021-06-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4259",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-24442",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4259/ranges"
            },
            {
                "rel": "reference",
                "href": "https://en-gb.wordpress.org/plugins/polls-widget/advanced/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/163258/wppsqv152-sql.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/163258/wppsqv152-sql.txt",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4259/default-remediation-status"
            }
        ]
    }
}