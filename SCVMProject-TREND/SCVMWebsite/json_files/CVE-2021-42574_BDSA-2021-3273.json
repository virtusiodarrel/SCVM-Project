{
    "source": "BDSA",
    "name": "BDSA-2021-3273",
    "title": "Rust Vulnerable to Source Code Manipulation via 'Bidirectional Override' Unicode Codepoints",
    "description": "Rust is vulnerable to source code manipulation due to a Unicode feature which allows changing the visual order of text that appears in the code editor. An attacker with an access to a Rust application's codebase could introduce malicious code that would appear as harmless on the reviewer's machine.",
    "technicalDescription": "The vulnerable feature is `bidirectional override` Unicode codepoints. In some cases the use of those codepoints could lead to the reviewed code being different than the compiled code. For example, code `if access_level != \"user{U+202E} {U+2066}// Check if admin{U+2069} {U+2066}\" {` would be rendered by bidirectional-aware tools as `if access_level != \"user\" { // Check if admin`.\n\nAlthough the vulnerability originates from Unicode, Rust has introduced two new lints to detect and reject code containing the affected codepoints. The lints will prevent the compilation of source code that contains the vulnerable codepoints.",
    "publishedDate": "2021-11-01T12:48:09.908Z",
    "updatedDate": "2021-11-01T12:48:09.892Z",
    "disclosureDate": "2021-11-01T00:00:00.000Z",
    "exploitPublishDate": "2021-11-01T00:00:00.000Z",
    "solution": "Fixed in version [**1.56.1**](https://github.com/rust-lang/rust/releases/tag/1.56.1) by [this](https://github.com/rust-lang/rust/commit/dd61274930ec0cd17711fab52d2bc9ad3e9053de) commit.\n\nThe latest stable releases can be found [here](https://github.com/rust-lang/rust/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nicholas Boucher and Ross Anderson, University of Cambridge",
    "workaround": "If an upgrade is not possible, the vendor advises checking that the following codepoints are not present in your repository and your dependencies:\n```\nU+202A, U+202B, U+202C, U+202D, U+202E, U+2066, U+2067, U+2068, U+2069\n```",
    "vendorFixDate": "2021-10-31T00:00:00.000Z",
    "vendorNotifiedDate": "2021-07-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3273",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-176"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-42574",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3273/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.rust-lang.org/2021/11/01/cve-2021-42574.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.rust-lang.org/2021/11/01/cve-2021-42574.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://blog.rust-lang.org/2021/11/01/cve-2021-42574.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rust-lang/rust/commit/dd61274930ec0cd17711fab52d2bc9ad3e9053de",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rust-lang/rust/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rust-lang/rust/releases/tag/1.56.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://trojansource.codes/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://trojansource.codes/trojan-source.pdf",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/11/01/1",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3273/default-remediation-status"
            }
        ]
    }
}