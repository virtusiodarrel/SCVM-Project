{
    "source": "BDSA",
    "name": "BDSA-2021-4542",
    "title": "Pluck Vulnerable to Remote Code Execution (RCE) via 'Manage Files' Functionality",
    "description": "Pluck is vulnerable to a remote code execution (RCE) issue due to a lack of sufficient validation and protection measures in the 'manage files' functionality.\n\nAn attacker with administrative privileges could abuse these flaws in order to upload malicious PHP code, and then execute this code in the upload directory of Pluck to gain control over the server.",
    "technicalDescription": "This issue occurs due to the presence of two main flaws:\n* The first is that the `.htaccess` file is not sufficiently protected. An attacker with administrative privileges in Pluck could submit crafted web requests that result in the deletion of the `.htaccess` file. This is due to how the validation checks in the `data/inc/deletefile.php` file do not consider how the name of the file to be deleted may include upper case characters or non-alphanumeric characters. Deletion of this file allows PHP code to be executed in the upload directory.\n* The second flaw is that a race condition exists between the upload of a file and when the file extension is \"sanitized\". For example, files with a `.php` extension will have a `.txt` appended. An attacker could submit requests in a manner that abuses this race condition and execute malicious code on the server before the uploaded file's extension is modified.",
    "publishedDate": "2022-08-15T09:08:29.132Z",
    "updatedDate": "2022-08-15T09:08:29.119Z",
    "disclosureDate": "2021-03-03T00:00:00.000Z",
    "exploitPublishDate": "2021-03-03T00:00:00.000Z",
    "solution": "Fixed in [**4.7.16-dev2**](https://github.com/pluck-cms/pluck/releases/tag/4.7.16-dev2) by [this](https://github.com/pluck-cms/pluck/commit/6865aca52ad503762bf2b7a77c67268edb6d2cb1) commit and [this](https://github.com/pluck-cms/pluck/commit/53ac1757ef284986178f0a0cdd62f74dff8f157c) commit.\n\nThe latest stable releases are available [here](https://github.com/pluck-cms/pluck/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.6,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.7,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "l0ners",
    "workaround": "",
    "vendorFixDate": "2021-04-26T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4542",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-27984",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4542/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluck-cms/pluck/commit/53ac1757ef284986178f0a0cdd62f74dff8f157c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluck-cms/pluck/commit/6865aca52ad503762bf2b7a77c67268edb6d2cb1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluck-cms/pluck/issues/98",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluck-cms/pluck/issues/98",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluck-cms/pluck/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluck-cms/pluck/releases/tag/4.7.16-dev2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4542/default-remediation-status"
            }
        ]
    }
}