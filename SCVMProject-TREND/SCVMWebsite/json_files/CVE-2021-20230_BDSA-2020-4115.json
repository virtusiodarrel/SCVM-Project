{
    "source": "BDSA",
    "name": "BDSA-2020-4115",
    "title": "Stunnel Vulnerable to Authentication Bypass and Man-in-the-Middle (MiTM) Attacks via 'redirect' Option Flaw",
    "description": "Stunnel is vulnerable to authentication bypass and man-in-the-middle (MiTM) issues due to a failure to correctly verify certificate chains whenever certain requests are redirected. \n\nAn attacker could exploit this in order to access the affected service without being redirected, or potentially view or modify a victim's network traffic.",
    "technicalDescription": "This issue occurs in the `verify.c` file. Whenever the option `verifyChain = yes` has been specified, certificate chain verification should take place. However, this fails to occur whenever the `redirect` option is set. \n\nAn attacker with an invalid certificate signed by an incorrect CA could abuse this flaw to access the affected service instead of being redirected to the `redirect` address, or conduct MiTM style attacks against clients.",
    "publishedDate": "2021-01-26T16:30:34.207Z",
    "updatedDate": "2021-02-23T13:37:45.268Z",
    "disclosureDate": "2020-10-12T00:00:00.000Z",
    "solution": "Fixed in [**5.57**](https://github.com/mtrojnar/stunnel/releases/tag/stunnel-5.57).\n\nThe latest stable releases are available [here](https://www.stunnel.org/downloads.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rob Hoes",
    "workaround": "",
    "vendorFixDate": "2020-10-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4115",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20230",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4115/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/CVE-2021-20230",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1925226",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/1177580",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mtrojnar/stunnel/releases/tag/stunnel-5.57",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.stunnel.org/NEWS.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.stunnel.org/downloads.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4115/default-remediation-status"
            }
        ]
    }
}