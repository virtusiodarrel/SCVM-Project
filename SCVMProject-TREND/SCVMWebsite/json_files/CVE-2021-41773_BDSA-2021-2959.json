{
    "source": "BDSA",
    "name": "BDSA-2021-2959",
    "title": "Apache HTTP Server Vulnerable to Remote Code Execution (RCE) and Information Exposure via Path Traversal with Crafted URLs",
    "description": "Apache HTTP Server is vulnerable to information exposure and remote code execution (RCE) due to improper handling of path normalization. This could allow an attacker to map URLs to files outside of the document root which are not protected by \"require all denied\".  This could further allow RCE if CGI scripts are enabled for exposed paths.\n\nThe vendor states that this issue is known to be exploited in the wild.\n\n**Note**: it was discovered that the initial fix did not fully address this issue, and an additional fix was released which was disclosed as **CVE-2021-42013** (**BDSA-2021-3012**). \n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "The issue exists in the function `ap_normalize_path()` within the file `server/util.c`. The server does not properly normalize second dots in `uri-path` when preceded by a dot, allowing path traversal attacks.",
    "publishedDate": "2021-10-06T10:16:58.791Z",
    "updatedDate": "2022-05-05T15:03:25.672Z",
    "disclosureDate": "2021-10-04T00:00:00.000Z",
    "exploitPublishDate": "2021-10-06T00:00:00.000Z",
    "solution": "Fixed in version [**2.4.51**](https://github.com/apache/httpd/releases/tag/2.4.51) by these commits:\n* [Commit 1](https://github.com/apache/httpd/commit/98246aa96079dad5f7b20521bbc0142a04f1c5e7)\n* [Commit 2](https://github.com/apache/httpd/commit/c3a95d75da7815b1bcebd99e499573688c936297)\n* [Commit 3](https://github.com/apache/httpd/commit/dc55176ebcf16cbaea2b32f1b7fc6dd450a84666)\n* [Commit 4](https://github.com/apache/httpd/commit/8c9b41ffb34b101f9d6d3e838766e71bccf974e0)\n\nThe latest stable releases can be found [here](https://httpd.apache.org/download.cgi).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ash Daulton, cPanel Security Team",
    "workaround": "",
    "vendorFixDate": "2021-10-07T00:00:00.000Z",
    "vendorNotifiedDate": "2021-09-29T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2959",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41773",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2959/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/httpd/commit/8c9b41ffb34b101f9d6d3e838766e71bccf974e0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/httpd/commit/98246aa96079dad5f7b20521bbc0142a04f1c5e7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/httpd/commit/c3a95d75da7815b1bcebd99e499573688c936297",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/httpd/commit/dc55176ebcf16cbaea2b32f1b7fc6dd450a84666",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/httpd/releases/tag/2.4.51",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1400238",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1404731",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1404731",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://httpd.apache.org/download.cgi",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://httpd.apache.org/security/vulnerabilities_24.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2021/q4/17",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/50383",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2959/default-remediation-status"
            }
        ]
    }
}