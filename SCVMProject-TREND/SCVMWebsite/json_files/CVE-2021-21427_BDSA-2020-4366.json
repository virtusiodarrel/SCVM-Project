{
    "source": "BDSA",
    "name": "BDSA-2020-4366",
    "title": "Magento Vulnerable to SQL Injection via Improper Input Validation in '_prepareQuotedSqlCondition' Function",
    "description": "Magento is vulnerable to SQL injection due to the improper validation of client-provided input. A remote attacker with administrative privileges could access sensitive information by sending maliciously crafted requests to a vulnerable server.",
    "technicalDescription": "The function `prepareSqlCondition()`, of file `lib/Varien/Db/Adapter/Pdo/Mysql.php`, prepares a condition that is to be used in a dynamically generated SQL statement. It does this by calling `quoteInto()` in order to prepare the component of the condition that must be in quotes, and by then calling `str_replace()` in order to replace a placeholder string with the correct string value in the SQL statement. The manner in which it performs these operations means that an attacker could cause the string replacement operation to insert SQL code into the prepared statement. This could allow the attacker to execute malicious SQL statements against the back-end database, which could potentially allow them to access sensitive information. The attacker must have administrative privileges in order to exploit this vulnerability.",
    "publishedDate": "2021-05-26T10:33:05.157Z",
    "updatedDate": "2021-05-26T10:33:05.138Z",
    "disclosureDate": "2020-04-20T00:00:00.000Z",
    "solution": "Fixed in **20.0.9** and in [**19.4.13**](https://github.com/OpenMage/magento-lts/releases/tag/v19.4.13) by [this](https://github.com/OpenMage/magento-lts/commit/368a5857d0fc393c498b55c356448a5fabcb2119) commit.\n\nA source for **20.0.9** is not publicly available; the next available release is [**20.0.10**](https://github.com/OpenMage/magento-lts/releases/tag/v20.0.10).\n\nThe latest stable releases are available [here](https://github.com/OpenMage/magento-lts/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4366",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21427",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4366/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenMage/magento-lts/commit/368a5857d0fc393c498b55c356448a5fabcb2119",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenMage/magento-lts/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenMage/magento-lts/releases/tag/v19.4.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenMage/magento-lts/releases/tag/v20.0.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenMage/magento-lts/security/advisories/GHSA-fvrf-9428-527m",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4366/default-remediation-status"
            }
        ]
    }
}