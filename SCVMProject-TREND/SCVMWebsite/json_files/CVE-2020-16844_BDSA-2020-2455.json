{
    "source": "BDSA",
    "name": "BDSA-2020-2455",
    "title": "Istio Vulnerable to Unauthorized Resource Access via DENY Rule Flaw",
    "description": "Istio is vulnerable to an unauthorized resource access issue due to how Authorization Policies, specifically for TCP services that include DENY rules using a wildcard suffix, can be mishandled.\n\nAn attacker could use this issue to bypass the Authorization Policy in place for the TCP service and gain access to restricted and potentially sensitive resources.",
    "technicalDescription": "Istio is vulnerable to an unauthorized resource access issue because DENY rules for TCP service Authorization Policies that use wildcard suffixes are incorrectly translated into a string match without the wildcard.\n\nIf an Authorization Policy is defined with DENY rules using wildcard suffixes in the `source principals` or `namespace` fields, callers to the affected TCP services will not be denied access.\n\nAuthorization Policy ALLOW rules, rules using prefix and exact matching, and HTTP service rules are unaffected.",
    "publishedDate": "2020-09-22T15:28:16.284Z",
    "updatedDate": "2020-09-22T15:28:16.276Z",
    "disclosureDate": "2020-08-11T00:00:00.000Z",
    "solution": "Fixed in [**1.6.8**](https://github.com/istio/istio/releases/tag/1.6.8) by [this](https://github.com/istio/istio/commit/4c73414556b83f0e75c1b3a0a89a23103a71573c) commit and [**1.5.9**](https://github.com/istio/istio/releases/tag/1.5.9) by [this](https://github.com/istio/istio/commit/72d2e135374f421b656d6f1a21f474db46134ace) commit.\n\nThe latest stable releases are available [here](https://github.com/istio/istio/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has suggested a workaround [here](https://istio.io/latest/news/security/istio-security-2020-009/):\n\nDo not use suffix matching in DENY policies in the `source principal` or `namespace` field for TCP services and use Prefix and Exact matching where applicable. Where possible change TCP to HTTP for port name suffixes in your Services.",
    "vendorFixDate": "2020-07-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2455",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-16844",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2455/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1861625",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/commit/4c73414556b83f0e75c1b3a0a89a23103a71573c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/commit/72d2e135374f421b656d6f1a21f474db46134ace",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/releases/tag/1.5.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/releases/tag/1.6.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://istio.io/latest/news/security/istio-security-2020-009/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://istio.io/latest/news/security/istio-security-2020-009/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2455/default-remediation-status"
            }
        ]
    }
}