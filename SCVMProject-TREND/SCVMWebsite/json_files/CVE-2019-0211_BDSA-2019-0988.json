{
    "source": "BDSA",
    "name": "BDSA-2019-0988",
    "title": "Apache Httpd Vulnerable to Privilege Escalation via Out-of-Bounds Read in Multi Processing Modules (MPMs)",
    "description": "Apache Httpd has a local privilege escalation vulnerability exploited via a child process on Unix systems. This is due to an out-of-bounds access flaw in MPM bucket number management. An attacker can leverage this flaw to execute arbitrary code with the privileges of the parent process.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "Apache Httpd suffers from a local root privilege escalation vulnerability due to an out-of-bounds array access in MPMs `mod_prefork`, `mod_worker` and `mod_event` which leads to an arbitrary function call. In less-privileged child processes or threads this could allow an attacker to execute arbitrary code with the privileges of the parent process (usually root).\n\nThe component maintains a shared-memory area (SHM), scoreboard in order to get feedback from a pool of single-threaded, low-privilege worker processes that process HTTP requests it manages. Each worker maintains a `process_score` structure associated with its PID, and has full read/write access to the SHM.\n\nWhen Apache Httpd gracefully restarts, old workers are killed by the main process and replaced by new ones. At this point, every old worker's bucket value will be used by the main process to access an array of `all_buckets`. An out-of-bounds error allows a rogue worker to change its listener `bucket` index on the scoreboard and point to shared memory. This allows unprivileged code like scripts to run on the server with the privileges of the main process.",
    "publishedDate": "2019-04-10T14:46:46.871Z",
    "updatedDate": "2022-05-05T14:58:22.372Z",
    "disclosureDate": "2019-04-03T00:00:00.000Z",
    "exploitPublishDate": "2019-04-03T00:00:00.000Z",
    "solution": "Fixed in version [**2.4.39**](https://svn.apache.org/viewvc/httpd/httpd/tags/2.4.39/) by [this](https://svn.apache.org/viewvc?view=revision&revision=1855378) commit.\n\nThe latest stable releases are available [here](https://httpd.apache.org/download.cgi).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Charles Fol",
    "workaround": "",
    "vendorFixDate": "2019-03-13T00:00:00.000Z",
    "vendorNotifiedDate": "2019-02-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 9.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0988",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-250"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-0211",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0988/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cfreal.github.io/carpe-diem-cve-2019-0211-apache-local-root.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cfreal/exploits/tree/master/CVE-2019-0211-apache",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://httpd.apache.org/download.cgi",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://svn.apache.org/viewvc/httpd/httpd/tags/2.4.39/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://svn.apache.org/viewvc?view=revision&revision=1855378",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.apache.org/dist/httpd/CHANGES_2.4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0988/default-remediation-status"
            }
        ]
    }
}