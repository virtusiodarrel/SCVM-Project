{
    "source": "BDSA",
    "name": "BDSA-2020-2686",
    "title": "Traefik Vulnerable to Open Redirects via Mishandling of 'X-Forwarded-Prefix' Header",
    "description": "Traefik is vulnerable to an open redirect issue due to how the `X-Forwarded-Prefix` header is not sufficiently validated by the API dashboard component.\n\nAn attacker could use this issue to redirect victim users to an attacker controlled site and trick them into disclosing sensitive information like user names and passwords.",
    "technicalDescription": "Traefik is vulnerable to an open redirect issue because the API dashboard component does not sufficiently validate that the `X-Forwarded-Prefix` header value is that of a site relative path. This component can instead redirect to any URI supplied in the `X-Forwarded-Prefix` header.\n\nThe vendor has stated that exploitation of this vulnerability could prove unlikely as it would require the attacker to perform active header injection.",
    "publishedDate": "2020-10-09T13:28:10.895Z",
    "updatedDate": "2020-10-09T13:28:10.888Z",
    "disclosureDate": "2020-07-30T00:00:00.000Z",
    "solution": "Fixed in [**2.3.0-rc3**](https://github.com/traefik/traefik/releases/tag/v2.3.0-rc3) and [**2.2.8**](https://github.com/traefik/traefik/releases/tag/v2.2.8) by [this](https://github.com/traefik/traefik/commit/e63db782c11c7b8bfce30be4c902e7ef8f9f33d2) commit and fixed in [**1.7.26**](https://github.com/traefik/traefik/releases/tag/v1.7.26) by [this](https://github.com/traefik/traefik/commit/cfa04c300c5db95ae8a52c31a9d973b6dd9c2254) commit.\n\nThe latest stable releases are available [here](https://github.com/traefik/traefik/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.4,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.6,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "GitHub Application Security Team",
    "workaround": "The vendor has suggested a workaround [here](https://github.com/traefik/traefik/security/advisories/GHSA-6qq8-5wq3-86rp), stating:\n\nBy using the `headers` middleware, the request header `X-Forwarded-Prefix` value can be overridden by the value `.`(dot)",
    "vendorFixDate": "2020-07-30T00:00:00.000Z",
    "vendorNotifiedDate": "2020-07-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2686",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-601"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15129",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2686/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/traefik/traefik/commit/cfa04c300c5db95ae8a52c31a9d973b6dd9c2254",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/traefik/traefik/commit/e63db782c11c7b8bfce30be4c902e7ef8f9f33d2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/traefik/traefik/releases/tag/v1.7.26",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/traefik/traefik/releases/tag/v2.2.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/traefik/traefik/releases/tag/v2.3.0-rc3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/traefik/traefik/security/advisories/GHSA-6qq8-5wq3-86rp",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/traefik/traefik/security/advisories/GHSA-6qq8-5wq3-86rp",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://securitylab.github.com/advisories/GHSL-2020-140-Containous-Traefik",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2686/default-remediation-status"
            }
        ]
    }
}