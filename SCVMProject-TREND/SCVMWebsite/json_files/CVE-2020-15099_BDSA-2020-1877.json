{
    "source": "BDSA",
    "name": "BDSA-2020-1877",
    "title": "TYPO3 Content Management System (CMS) Vulnerable to Privilege Escalation via Possible Retrieval of 'typo3conf/LocalConfiguration.php' File",
    "description": "TYPO3 content management system (CMS) is vulnerable to privilege escalation if an attacker has already gained access to an encryption key or can generate codes through another vulnerability such as CVE-2020-15098.",
    "technicalDescription": "It is possible for an attacker to fetch arbitrary files, including the sensitive `typo3conf/LocalConfiguration.php` if they can generate special HMAC-SHA1 codes. They would only be able to do this through another vulnerability or if the `encryptionKey` was leaked by some other method. If they gained access to such files they could potentially elevate their privileges to administrative levels (if they have direct access to the database server), which would allow them to execute arbitrary code by injecting custom extensions. \n\nThe vendor is aware of a functional exploit. This does not seem to be available on the public clear internet at this moment in time.",
    "publishedDate": "2020-07-31T13:30:23.034Z",
    "updatedDate": "2021-01-21T15:37:57.387Z",
    "disclosureDate": "2020-07-28T00:00:00.000Z",
    "exploitPublishDate": "2019-01-26T00:00:00.000Z",
    "solution": "Fixed in **[v10.4.6](https://github.com/TYPO3/TYPO3.CMS/releases/tag/v10.4.6)** by [this](https://github.com/TYPO3/TYPO3.CMS/commit/6069aa2e63172b07154ca6e75c62660595539fa4) commit and **[v9.5.20](https://github.com/TYPO3/TYPO3.CMS/releases/tag/v9.5.20)** by [this](https://github.com/TYPO3/TYPO3.CMS/commit/6cd384be8e3086083887a3b2f0f5074331e5a334) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Oliver Hader",
    "workaround": "",
    "vendorFixDate": "2020-07-28T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1877",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-202"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15099",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1877/ranges"
            },
            {
                "rel": "reference",
                "href": "https://get.typo3.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/commit/6069aa2e63172b07154ca6e75c62660595539fa4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/commit/6cd384be8e3086083887a3b2f0f5074331e5a334",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/releases/tag/v10.4.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/releases/tag/v9.5.20",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ohader/typo3v9-hack/blob/master/.hack/3-API-RetrieveLocalConfiguration.md",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-core-sa-2020-007",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1877/default-remediation-status"
            }
        ]
    }
}