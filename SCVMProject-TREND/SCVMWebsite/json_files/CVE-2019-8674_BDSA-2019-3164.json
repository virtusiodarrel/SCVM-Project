{
    "source": "BDSA",
    "name": "BDSA-2019-3164",
    "title": "WebKit GTK Vulnerable to Cross-Site Scripting via Unsafe Handling of 'javascript:' URI Load Events",
    "description": "WebKit GTK is vulnerable to cross-site scripting (XSS) due to the existence of a race condition. An attacker could execute malicious scripts within the browser of a victim by tricking that victim into clicking on a crafted URI.",
    "technicalDescription": "The function `DocumentWriter::replaceDocument()` will replace a document that is currently being displayed with a new one, the contents of which is derived from the resource specified by an input `javascript:` URI. This function will call `DocumentWriter::begin()` in order to start the parsing process. This function will begin sending data from the resource specified in the `javascript:` URI to the parser of the active document, which will use that data to begin updating the active document. \n\nIf an attacker can cause a target web page to be loaded before the `DocumentWriter::begin()` function returns, then the document parser will start writing the new data to the newly loaded document instead of the old one.  This could allow an attacker to insert malicious scripts into the newly loaded document, which would be executed in the context of the origin of that document. This could allow the attacker to obtain sensitive data relating to that origin, such as session cookies.",
    "publishedDate": "2019-10-14T09:35:53.724Z",
    "updatedDate": "2022-07-07T14:17:58.684Z",
    "disclosureDate": "2019-10-01T00:00:00.000Z",
    "exploitPublishDate": "2019-10-01T00:00:00.000Z",
    "solution": "Fixed in version [**2.24.4**](https://webkitgtk.org/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sergei Glazunov of Google Project Zero",
    "workaround": "",
    "vendorFixDate": "2019-08-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3164",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-8674",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3164/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1882",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://webkitgtk.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/47450",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/47450",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3164/default-remediation-status"
            }
        ]
    }
}