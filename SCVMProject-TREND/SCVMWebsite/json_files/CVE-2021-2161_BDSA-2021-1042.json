{
    "source": "BDSA",
    "name": "BDSA-2021-1042",
    "title": "OpenJDK Vulnerable to Command Argument Manipulation via Improper Quote Processing",
    "description": "It was found that OpenJDK on the Windows platform did not properly detect command arguments that were not quoted correctly. This could be used to manipulate command arguments that come from untrusted sources.",
    "technicalDescription": "The vulnerability exists due to multiple quote character processing issues on Windows when `jdk.lang.process.allowAmbiguousCommands` system property is set to false. An argument that ends with a trailing double-quote preceded by a backslash is joined with the next argument instead of being properly encoded in the command string; empty arguments are silently ignored instead of being encoded as a pair of double-quotes (`\"\"`), allowing zero-length strings to be passed as arguments; double quotes in an argument are dropped and not passed to the process instead of being encoded.",
    "publishedDate": "2021-04-22T14:35:35.900Z",
    "updatedDate": "2022-08-23T09:07:26.826Z",
    "disclosureDate": "2021-04-20T00:00:00.000Z",
    "solution": "Fixed in:\n* **[jdk8u292-b01](https://hg.openjdk.java.net/jdk8u/jdk8u/rev/b785e6a31314)**\n* **[jdk7u301-b00](https://hg.openjdk.java.net/jdk7u/jdk7u/rev/bebb5ab92c46)** \n* **[jdk-11.0.11-ga](https://github.com/openjdk/jdk11u/releases/tag/jdk-11.0.11-ga)** by [this](https://github.com/openjdk/jdk11u/commit/7243dc3df6042ed9664ba8f70b60e398442e0a21) commit \n* **[jdk-13.0.7-ga](https://github.com/openjdk/jdk13u/releases/tag/jdk-13.0.7-ga)** by [this](https://github.com/openjdk/jdk13u/commit/7002ef50570a9905c62eff96fcd6d3f8eaf3b6cc) commit\n* **[jdk-15.0.3-ga](https://github.com/openjdk/jdk15u/releases/tag/jdk-15.0.3-ga)** by [this](https://github.com/openjdk/jdk15u/commit/e0cc6b018bab37a5d825b891d13195c411fe6a18) commit\n* **[jdk-16.0.1+1](https://github.com/openjdk/jdk16u/releases/tag/jdk-16.0.1%2B1)** by [this](https://github.com/openjdk/jdk16u/commit/2a9ec307ffac54b12aecfb91b11df822c6fe7bd2) commit\n\nThe latest stable releases are available [here](https://jdk.java.net/16/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Markus Loewe",
    "workaround": "",
    "vendorFixDate": "2021-03-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1042",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-147"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-2161",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1042/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2021-2161",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk11u/commit/7243dc3df6042ed9664ba8f70b60e398442e0a21",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk11u/releases/tag/jdk-11.0.11-ga",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk13u/commit/7002ef50570a9905c62eff96fcd6d3f8eaf3b6cc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk13u/releases/tag/jdk-13.0.7-ga",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk15u/commit/e0cc6b018bab37a5d825b891d13195c411fe6a18",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk15u/releases/tag/jdk-15.0.3-ga",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk16u/commit/2a9ec307ffac54b12aecfb91b11df822c6fe7bd2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk16u/releases/tag/jdk-16.0.1%2B1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.openjdk.java.net/jdk7u/jdk7u/rev/bebb5ab92c46",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.openjdk.java.net/jdk8u/jdk8u/rev/b785e6a31314",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jdk.java.net/16/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://openjdk.java.net/groups/vulnerability/advisories/2021-04-20",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.oracle.com/security-alerts/cpuapr2021.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1042/default-remediation-status"
            }
        ]
    }
}