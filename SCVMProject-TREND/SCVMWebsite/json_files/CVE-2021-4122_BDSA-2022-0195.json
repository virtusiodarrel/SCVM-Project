{
    "source": "BDSA",
    "name": "BDSA-2022-0195",
    "title": "cryptsetup Vulnerable to Data Decryption via LUKS2 Header Manipulation",
    "description": "cryptsetup is vulnerable to data decryption due to the LUKS2 online re-encryption extension trusting unprotected metadata during a crash recovery. An attacker can modify on-disk metadata to simulate decryption with a crashed re-encryption step and persistently decrypt part of the LUKS device.\n\n**Note:** this attack requires repeated physical access to the LUKS device.",
    "technicalDescription": "The decryption is performed when a valid user activates the device with a correct passphrase and modified metadata. The size of possible decrypted data depends on configured LUKS2 header size. With the default parameters (16 MiB LUKS2 header) and only one allocated keyslot (512 bit key for AES-XTS), for simulated decryption with checksum resilience SHA1 (20 bytes checksum for 4096-byte blocks) the maximal decrypted size can be over 3GiB.\n\nThe vulnerability was fixed by adding digest protection for re-encryption metadata. The digest is calculated from known keys and critical re-encryption metadata. An attacker cannot create a correct metadata digest without knowledge of a passphrase for used keyslots.\n\n**Note:** the former re-encryption operation (without the additional digest) is no longer supported. In-progress re-encryption needs to be finished before updating to new packages.",
    "publishedDate": "2022-01-21T15:50:35.094Z",
    "updatedDate": "2022-01-21T15:50:35.082Z",
    "disclosureDate": "2022-01-14T00:00:00.000Z",
    "solution": "Fixed in **[2.3.7](https://gitlab.com/cryptsetup/cryptsetup/-/tags/v2.3.7)** by [this](https://gitlab.com/cryptsetup/cryptsetup/commit/60addcff) commit and in **[2.4.3](https://gitlab.com/cryptsetup/cryptsetup/-/tags/v2.4.3)** by [this](https://gitlab.com/cryptsetup/cryptsetup/commit/de98f011) commit.\n\nThe latest stable releases can be found [here](https://mirrors.edge.kernel.org/pub/linux/utils/cryptsetup/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.5
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.9,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 0.7,
        "severity": "MEDIUM",
        "attackVector": "PHYSICAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "CVSS:3.1/AV:P/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Milan Broz",
    "workaround": "",
    "vendorFixDate": "2022-01-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0195",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-649"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-4122",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0195/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2032401",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/show_bug.cgi?id=1194469",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/cryptsetup/cryptsetup/-/tags/v2.3.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/cryptsetup/cryptsetup/-/tags/v2.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/cryptsetup/cryptsetup/commit/60addcff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/cryptsetup/cryptsetup/commit/de98f011",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://mirrors.edge.kernel.org/pub/linux/utils/cryptsetup/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0195/default-remediation-status"
            }
        ]
    }
}