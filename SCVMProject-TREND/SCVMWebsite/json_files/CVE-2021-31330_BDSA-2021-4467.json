{
    "source": "BDSA",
    "name": "BDSA-2021-4467",
    "title": "Reviewboard Vulnerable to Stored Cross-Site Scripting (XSS) via Markdown Editor",
    "description": "Reviewboard contains a stored cross-site scripting (XSS) vulnerability.  This allows an authenticated attacker with permissions to review, or edit existing reviews, to inject Javascript into markdown stored within the text.  This will be executed when viewed in a victims browser. Successful attacks may allow an attacker to steal session credentials which can lead to further attacks.",
    "technicalDescription": "The stored XSS is due to a lack of sanitization in the markdown parser used in `reviewboard/reviews/markdown_utils.py`. Reviewboard uses the `Python-Markdown` library to handle markdown.  This library removed any form of sanitization functionality. \n\nThis issue has been fixed by using the `Bleach` Python library to handle markdown.",
    "publishedDate": "2022-06-28T13:43:47.655Z",
    "updatedDate": "2022-06-28T13:43:47.640Z",
    "disclosureDate": "2021-04-14T00:00:00.000Z",
    "exploitPublishDate": "2021-04-14T00:00:00.000Z",
    "solution": "Fixed in version [**3.0.21**](https://github.com/reviewboard/reviewboard/releases/tag/release-3.0.21) and [**4.0-rc2**](https://github.com/reviewboard/reviewboard/releases/tag/release-4.0rc2) by [this](https://github.com/reviewboard/reviewboard/commit/6af09f270659373f9ab4490407e1371da61f0dd7) commit.\n\nThe latest stable releases can be found [here](https://github.com/reviewboard/reviewboard/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 1.7,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matt Schmidt",
    "workaround": "",
    "vendorFixDate": "2021-04-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4467",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-31330",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4467/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/reviewboard/reviewboard/commit/6af09f270659373f9ab4490407e1371da61f0dd7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/reviewboard/reviewboard/releases/tag/release-3.0.21",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/reviewboard/reviewboard/releases/tag/release-4.0rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/reviewboard/reviewboard/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mattschmidt.net/2021/04/14/review-board-xss-discovered/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://mattschmidt.net/2021/04/14/review-board-xss-discovered/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.reviewboard.org/docs/releasenotes/reviewboard/3.0.21/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.reviewboard.org/news/2021/04/14/review-board-3-0-21-and-4-0-rc-2-security-bug-fixes-and-docker/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4467/default-remediation-status"
            }
        ]
    }
}