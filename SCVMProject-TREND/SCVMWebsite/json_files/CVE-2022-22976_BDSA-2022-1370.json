{
    "source": "BDSA",
    "name": "BDSA-2022-1370",
    "title": "Spring Security Vulnerable to Weakened Bcrypt Hashing via Integer Overflow in 'BCryptPasswordEncoder' Component",
    "description": "Spring Security is vulnerable to the weakening of bcrypt-generated password hashes due to an integer overflow. An attacker that is able to obtain weak password hashes that have been produced by a vulnerable application could potentially retrieve the plaintext password. It should be noted that the `BCryptPasswordEncoder` class must have been configured to use the maximum work factor (31) in order for the vulnerability to manifest. This is a non-default value.",
    "technicalDescription": "The `BCryptPasswordEncoder` class, of file `crypto/src/main/java/org/springframework/security/crypto/bcrypt/BCryptPasswordEncoder.java`, is used by Spring Security in order to hash passwords via the bcrypt algorithm. If instances of this class have been configured to use a non-default work factor of 31, then an integer overflow will occur during the hashing process. This will lead to a failure to carry out any salting rounds. If the subsequent unsalted password hash is obtained by an attacker, then it will be easier from them to obtain the original plaintext password.",
    "publishedDate": "2022-05-18T14:13:25.607Z",
    "updatedDate": "2022-05-18T14:13:25.580Z",
    "disclosureDate": "2022-05-17T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**5.7.0**](https://github.com/spring-projects/spring-security/releases/tag/5.7.0)\n* [**5.6.4**](https://github.com/spring-projects/spring-security/releases/tag/5.6.4)\n* [**5.5.7**](https://github.com/spring-projects/spring-security/releases/tag/5.5.7)\n\nThe latest stable releases can be found [here](https://github.com/spring-projects/spring-security/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated [here](https://tanzu.vmware.com/security/cve-2022-22976) that the following workaround can be implemented:\n\n> Update your BCryptPasswordEncoder to use a lower number of rounds.",
    "vendorFixDate": "2022-05-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1370",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-22976",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1370/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.5.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.6.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.7.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://spring.io/blog/2022/05/15/cve-2022-22976-bcrypt-skips-salt-rounds-for-work-factor-of-31",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://tanzu.vmware.com/security/cve-2022-22976",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://tanzu.vmware.com/security/cve-2022-22976",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1370/default-remediation-status"
            }
        ]
    }
}