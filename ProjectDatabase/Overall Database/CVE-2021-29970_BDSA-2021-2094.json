{
    "source": "BDSA",
    "name": "BDSA-2021-2094",
    "title": "Mozilla Client Applications Vulnerability to Denial-of-Service (DoS) via Use-After-Free in Accessibility Feature  of Document",
    "description": "Mozilla Client Applications are vulnerable to  a denial-of-service (DoS) condition.  This allows an attacker to craft content that can be used to crash applications using one of the \"Accessibility Features\" available for Documents. \n\nThe vendor states that this vulnerability will result in a \"potentially exploitable crash\". The vendor also states that this vulnerability only affected applications when accessibility is enabled.",
    "technicalDescription": "The use-after-free occurs in the `mozilla::PresShell::RemoveRefreshObserver()` function of file `builds/worker/checkouts/gecko/layout/base/PresShell.cpp`.  The issue exists due to the improper handling of `DocAccessible` instances. It is possible for an instance of this class to exist beyond the removal of its associated `PressShell` instance. Whenever the application attempts to shutdown the `DocAccessible` instance, a use-after-free will occur. A crafted document can be used to trigger this issue, which could allow an attacker to crash the application and cause a DoS. The attacker may also be able to modify, or recover the contents of, application memory.",
    "publishedDate": "2021-07-15T14:57:22.912Z",
    "updatedDate": "2022-03-18T13:40:14.923Z",
    "disclosureDate": "2021-07-13T00:00:00.000Z",
    "exploitPublishDate": "2021-11-22T00:00:00.000Z",
    "solution": "Fixed in Firefox [**90**](https://ftp.mozilla.org/pub/firefox/releases/90.0/) by [this](https://hg.mozilla.org/mozilla-central/rev/65d3494db521b3d15112c092d0647a2899808381) revision.\n\nFixed in Firefox [**ESR 78.12**](https://ftp.mozilla.org/pub/firefox/releases/78.12.0esr/)\n\nFixed in Thunderbird [**78.12**](https://ftp.mozilla.org/pub/thunderbird/releases/78.12.0/)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Irvan Kurniawan",
    "workaround": "",
    "vendorFixDate": "2021-06-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2094",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-29970",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2094/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1709976",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/78.12.0esr/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/90.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/thunderbird/releases/78.12.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/65d3494db521b3d15112c092d0647a2899808381",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-28/#CVE-2021-29970",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-29/#CVE-2021-29970",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-30/#CVE-2021-29970",
                "label": "ADVISORY"
            }
        ]
    }
}