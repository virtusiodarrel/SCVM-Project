{
    "source": "BDSA",
    "name": "BDSA-2022-2121",
    "title": "Shescape Vulnerable to Arbitrary Command Execution via Insufficient Escaping of Whitespace",
    "description": "Shescape contains an arbitrary command execution vulnerability due to insufficient escaping of whitespace. An attacker could exploit this issue by including whitespace in an input passed to the application. This could result in an attacker invoking shell-specific behavior or invoking arbitrary commands through the insertion of special characters.",
    "technicalDescription": "This issue impacts users that use the `escape()` or `escapeAll()` functions with the interpolation option set to `true`. The following shells are impacted by this vulnerability:\n\n* Bash, Dash, Zsh and Powershell",
    "publishedDate": "2022-08-01T10:01:38.760Z",
    "updatedDate": "2022-08-01T10:01:38.747Z",
    "disclosureDate": "2022-07-15T00:00:00.000Z",
    "exploitPublishDate": "2022-07-15T00:00:00.000Z",
    "solution": "Fixed in version [**1.5.8**](https://github.com/ericcornelissen/shescape/releases/tag/v1.5.8) by [this](https://github.com/ericcornelissen/shescape/commit/aceea7358f7222984e21260381ebc5ec4543b76f) commit.\n\nThe latest stable releases can be found [here](https://github.com/ericcornelissen/shescape/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "As per the vendor, users should use the `interpolation: true` option. It has also been suggested to remove all whitespace from user input, though this has been noted to be prone to non-security related errors.",
    "vendorFixDate": "2022-07-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2121",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-150"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31180",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2121/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/commit/aceea7358f7222984e21260381ebc5ec4543b76f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/releases/tag/v1.5.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/security/advisories/GHSA-44vr-rwwj-p88h",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/security/advisories/GHSA-44vr-rwwj-p88h",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/security/advisories/GHSA-44vr-rwwj-p88h",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2121/default-remediation-status"
            }
        ]
    }
}