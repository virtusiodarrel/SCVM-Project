{
    "source": "BDSA",
    "name": "BDSA-2020-0894",
    "title": "Xen Vulnerable to Denial-of-Service (DoS) and Potential Privilege Escalation via Memory Corruption Associated with Shared xenoprof Ring Buffer",
    "description": "Xen is vulnerable to a denial-of-service (DoS) and potential privilege escalation via a malicious guest operating system manipulating data in a shared structure. The administrator has to enable \"active\" profiling for the guest for the vulnerability to be exploitable.",
    "technicalDescription": "Xen `xenoprof` code in `xen/common/xenoprof.c` was not atomically reading and checking the size and head/tail pointers of a shared ring buffer that a guest could write to. This could lead to inconsistencies and memory corruption. The vendor states that privilege escalation cannot be ruled out as an impact of this vulnerability.\n\nOnly x86 PV guests can leverage this flaw on builds of Xen with the Xenoprof functionality enabled.",
    "publishedDate": "2020-04-24T14:09:16.301Z",
    "updatedDate": "2020-10-13T14:14:02.727Z",
    "disclosureDate": "2020-04-14T00:00:00.000Z",
    "solution": "Fixed in \n* [**4.11.4**](https://xenbits.xen.org/gitweb/?p=xen.git;a=tree;h=ad644d65d869d322183156e26986cfe67e10f2d5;hb=96a8b5bc48be2ae9691369849036453f8850135b) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7900cb7c18b5ec5d379884166b0db35ebe3846e0) commit\n* [**4.12.3**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.12.3) by [this](https://github.com/xen-project/xen/commit/45624a73326d0924544c8f9c0ab1cd5e226018af) commit\n* [**4.13.1**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.1) by [this](https://github.com/xen-project/xen/commit/ef922bda43f645749e41bd2730f6206f291be289) commit\n\nFixed in other branches by [this](https://xenbits.xen.org/xsa/xsa313-2.patch) patch.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.9,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.4,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:L/AC:M/Au:N/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ilja Van Sprundel of IOActive",
    "workaround": "",
    "vendorFixDate": "2020-04-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0894",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-367"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11741",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0894/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/45624a73326d0924544c8f9c0ab1cd5e226018af",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/ef922bda43f645749e41bd2730f6206f291be289",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.12.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7900cb7c18b5ec5d379884166b0db35ebe3846e0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=tree;h=ad644d65d869d322183156e26986cfe67e10f2d5;hb=96a8b5bc48be2ae9691369849036453f8850135b",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-313.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/xsa313-2.patch",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0894/default-remediation-status"
            }
        ]
    }
}