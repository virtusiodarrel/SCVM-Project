{
    "source": "BDSA",
    "name": "BDSA-2020-0183",
    "title": "Squid Vulnerable to Server Side Request Forgery (SSRF) via Security Filter Bypass",
    "description": "Squid is vulnerable to server side request forgery (SSRF) due to improper validation of HTTP requests. This could allow an attacker to bypass security controls between the client and proxy and obtain unauthorized access to server resources.",
    "technicalDescription": "The issue exists in the function `getHeaderField()` within the file `src/http/one/Parser.cc`. Improper handling of malformed host headers could result in security filters not being enforced allow an attacker to perform SSRF by sending maliciously crafted HTTP requests.\n\nThe vendor states that the following configurations of Squid, acting as a reverse proxy, are affected by this vulnerability:\n* **2.x** up to and including **2.7.STABLE9** with `http_port`: `accel` or `vhost` options configured,\n* **3.x** up to and including **3.5.28** with `http_port`: `accel` or `vhost` options configured,\n*  **4.x** up to and including **4.9** with with `http_port`: `accel` option configured.",
    "publishedDate": "2020-02-06T17:22:36.061Z",
    "updatedDate": "2020-02-06T17:22:36.048Z",
    "disclosureDate": "2020-02-03T00:00:00.000Z",
    "solution": "Fixed in **[4.10](https://github.com/squid-cache/squid/releases/tag/SQUID_4_10)** by [this](https://github.com/squid-cache/squid/commit/d8e4715992d0e530871519549add5519cbac0598) commit and [this](https://github.com/squid-cache/squid/commit/b3a0719affab099c684f1cd62b79ab02816fa962) commit.\n\nFixed in the **3.5** branch by these commits which are not included in any release:\n* [Commit 1](https://github.com/squid-cache/squid/commit/8e657e835965c3a011375feaa0359921c5b3e2dd)\n* [Commit 2](https://github.com/squid-cache/squid/commit/d29ac78fd203f55bf391bcb24348ed43ea469d21)\n* [Commit 3](https://github.com/squid-cache/squid/commit/21d99bdeaed7b2208098d824496da954920ea720)\n\nThe latest stable releases are available [here](http://www.squid-cache.org/Versions/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Regis Leroy",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, vendor-supplied patches for **3.5**, **4.x** => **4.8** and **4.9** are available [here](http://www.squid-cache.org/Advisories/SQUID-2020_1.txt).",
    "vendorFixDate": "2019-12-12T00:00:00.000Z",
    "vendorNotifiedDate": "2019-07-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0183",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8449",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0183/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Advisories/SQUID-2020_1.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Advisories/SQUID-2020_1.txt",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/21d99bdeaed7b2208098d824496da954920ea720",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/8e657e835965c3a011375feaa0359921c5b3e2dd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/b3a0719affab099c684f1cd62b79ab02816fa962",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/d29ac78fd203f55bf391bcb24348ed43ea469d21",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/d8e4715992d0e530871519549add5519cbac0598",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/releases/tag/SQUID_4_10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0183/default-remediation-status"
            }
        ]
    }
}