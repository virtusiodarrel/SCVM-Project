{
    "source": "BDSA",
    "name": "BDSA-2020-2390",
    "title": "Cryptsetup Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Write in 'luks2_json_metadata.c' File",
    "description": "Cryptsetup contains an out-of-bounds write vulnerability due to improper validation of LUKS2 data segments. An attacker could exploit this flaw to cause denial-of-service by crashing the application.",
    "technicalDescription": "This vulnerability exists in `lib/luks2/luks2_json_metadata.c`. The function `hdr_validate_segments()` validates LUKS2 data segments. However, the code does not check for possible overflow conditions during memory allocation of the `intervals` array. As a result, the library could be tricked to expect successful allocation while the amount of memory allocated could be lesser than expected. Furthermore, an attacker can cause the application to read data from a malicious image and then write that data beyond the allocated memory.\nThis can cause a denial-of-service via an application crash. \n\n**Note**: This problem only affects 32-bit builds.",
    "publishedDate": "2020-09-16T12:18:49.528Z",
    "updatedDate": "2020-10-12T11:18:37.324Z",
    "disclosureDate": "2020-08-24T00:00:00.000Z",
    "solution": "Fixed in [**2.3.4**](https://gitlab.com/cryptsetup/cryptsetup/-/tags/v2.3.4) by these commits:\n* [Commit 1](https://gitlab.com/cryptsetup/cryptsetup/-/commit/52f5cb8cedf22fb3e14c744814ec8af7614146c7)\n* [Commit 2](https://gitlab.com/cryptsetup/cryptsetup/-/commit/46ee71edcd13e1dad50815ad65c28779aa6f7503)\n* [Commit 3](https://gitlab.com/cryptsetup/cryptsetup/-/commit/752c9a52798f11d3b765b673ebaa3058eb25316e)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.0,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.3,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tobias Stoeckmann",
    "workaround": "",
    "vendorFixDate": "2020-08-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2390",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14382",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2390/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/CVE-2020-14382",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1874712",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/cryptsetup/cryptsetup/-/blob/master/docs/v2.3.4-ReleaseNotes",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/cryptsetup/cryptsetup/-/commit/46ee71edcd13e1dad50815ad65c28779aa6f7503",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/cryptsetup/cryptsetup/-/commit/52f5cb8cedf22fb3e14c744814ec8af7614146c7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/cryptsetup/cryptsetup/-/commit/752c9a52798f11d3b765b673ebaa3058eb25316e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/cryptsetup/cryptsetup/-/commit/a7f80a27701450e40ef37e2224577f1a0c98cf0f",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/cryptsetup/cryptsetup/-/merge_requests/102",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/cryptsetup/cryptsetup/-/tags/v2.3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://people.canonical.com/~ubuntu-security/cve/2020/CVE-2020-14382.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://security-tracker.debian.org/tracker/CVE-2020-14382",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ubuntu.com/security/notices/USN-4493-1",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2390/default-remediation-status"
            }
        ]
    }
}