{
    "source": "BDSA",
    "name": "BDSA-2020-1503",
    "title": "Apache Spark Vulnerable to Remote Code Execution (RCE) via Master Authentication Bypass",
    "description": "Apache Spark is vulnerable to remote code execution (RCE) due to the improper validation of RPC operations. This could allow an attacker to supply a maliciously crafted RPC, bypass authentication and manipulate an application's resources in order to execute shell commands on the host system of a Spark cluster.",
    "technicalDescription": "The issue exists in the RPC handler for authenticated connections. Improper validation of RPC operations could allow unauthenticated access to application resources, even if the resource manager's master is configured to require authentication using a shared secret.\n\nSpark clusters using other resource managers, such as YARN and Mesos, are not affected by this vulnerability.",
    "publishedDate": "2020-06-24T10:07:33.003Z",
    "updatedDate": "2021-08-06T13:32:37.582Z",
    "disclosureDate": "2020-06-22T00:00:00.000Z",
    "solution": "Fixed in **[2.4.6-rc1](https://github.com/apache/spark/releases/tag/v2.4.6-rc1)** and **[3.0.0-rc2](https://github.com/apache/spark/releases/tag/v3.0.0-rc2)** by [this](https://github.com/apache/spark/commit/61b7d446b37cecc45e6d274bbfdde3b745bf068f) commit.\n\nAdditionally, the vendor recommends that network access to cluster machines should be restricted to trusted hosts only, where possible.\n\nThe latest stable releases are available [here](https://spark.apache.org/downloads.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ayoub Elaassal",
    "workaround": "",
    "vendorFixDate": "2020-04-17T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1503",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-9480",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1503/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/spark/commit/61b7d446b37cecc45e6d274bbfdde3b745bf068f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/spark/commit/8f3f73abc1fe62496722476460c174af0250e3fe",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/spark/releases/tag/v2.4.6-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/spark/releases/tag/v3.0.0-rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://spark.apache.org/downloads.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://spark.apache.org/security.html#CVE-2020-9480",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1503/default-remediation-status"
            }
        ]
    }
}