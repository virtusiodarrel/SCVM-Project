{
    "source": "BDSA",
    "name": "BDSA-2020-3660",
    "title": "Apache Groovy Vulnerable to Privilege Escalation and Information Exposure via Insecure 'createTempDir' Method",
    "description": "Apache Groovy is vulnerable to privilege escalation and information exposure due to inappropriate use of an insecure JDK method. A local attacker could exploit this vulnerability by supplying a system with maliciously crafted input.",
    "technicalDescription": "The issue exists with the method `createTempDir()` within the file `src/main/java/org/codehaus/groovy/runtime/DefaultGroovyStaticMethods.java`. The insecure method exposes a race condition which could result in temporary directories being created with insecure permissions and are thus accessible to all users. This could allow an attacker to expose sensitive information if Groovy uses these directories to store such information. If the directories are also used to write or store executable code, this could also facilitate privilege escalation.",
    "publishedDate": "2020-12-07T17:48:02.853Z",
    "updatedDate": "2021-04-06T11:05:07.422Z",
    "disclosureDate": "2020-12-06T00:00:00.000Z",
    "solution": "Fixed in:\n* [**2.4.21**](https://github.com/apache/groovy/releases/tag/GROOVY_2_4_21) by [this](https://github.com/apache/groovy/commit/4e418d4a34c973a7ec1e822552103043ac13780e) commit,\n* [**2.5.14**](https://github.com/apache/groovy/releases/tag/GROOVY_2_5_14) by [this](https://github.com/apache/groovy/commit/98dc5d713926cd81b006c510a1546ccd520fe17f) commit,\n* [**3.0.7**](https://github.com/apache/groovy/releases/tag/GROOVY_3_0_7) by [this](https://github.com/apache/groovy/commit/f069c35c4bbaf68547c76381509d59840a7ed32d) commit,\n* [**4.0.0-alpha-2**](https://github.com/apache/groovy/releases/tag/GROOVY_4_0_0_ALPHA_2) by [this](https://github.com/apache/groovy/commit/bcbe5c4c76db83736166530647c024ac1e47ef28) commit.\n\nNote: the vendor states that the fix for **2.4**, when Groovy is running on a pre-JDK7 version of the JDK, eliminates the risk of privilege escalation but still leaves the potential for sensitive information leakage. The vendor recommends applying the following mitigation for **2.4**/pre-JDK7 users:\n> Set the `java.io.tmpdir` system environment variable to a directory that is exclusively owned by the executing user.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jonathan Leitschuh",
    "workaround": "",
    "vendorFixDate": "2020-11-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3660",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-379"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-17521",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3660/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/groovy/commit/4e418d4a34c973a7ec1e822552103043ac13780e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/groovy/commit/98dc5d713926cd81b006c510a1546ccd520fe17f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/groovy/commit/bcbe5c4c76db83736166530647c024ac1e47ef28",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/groovy/commit/f069c35c4bbaf68547c76381509d59840a7ed32d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/groovy/releases/tag/GROOVY_2_4_21",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/groovy/releases/tag/GROOVY_2_5_14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/groovy/releases/tag/GROOVY_3_0_7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/groovy/releases/tag/GROOVY_4_0_0_ALPHA_2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groovy-lang.org/security.html#CVE-2020-17521",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3660/default-remediation-status"
            }
        ]
    }
}