{
    "source": "BDSA",
    "name": "BDSA-2020-1826",
    "title": "snap Vulnerable to Access Restriction Bypass via the 'XDG_DATA_DIRS' Variable Set by Malicious snap",
    "description": "snap is vulnerable to access restriction bypass. An attacker could exploit this vulnerability to control the way an URL will be opened, which gives them the ability to run additional executables outside the sandbox.",
    "technicalDescription": "This vulnerability is present due to the ability to the ability to modify `XDG_DATA_DIRS` when calling `xdg-open` in file `tests/main/xdg-open/task.yaml` and file `usersession/userd/launcher.go` of snap. \n\nAn attacker can exploit this vulnerability by altering the `XDG_DATA_DIRS` variable and controlling how the system opens an URL. This can include the ability to run an executable provided by the attacker outside of the sandbox.",
    "publishedDate": "2020-07-24T09:35:53.547Z",
    "updatedDate": "2020-07-24T09:35:53.537Z",
    "disclosureDate": "2020-07-15T00:00:00.000Z",
    "exploitPublishDate": "2020-05-22T00:00:00.000Z",
    "solution": "Fixed in [**2.45.2**](https://github.com/snapcore/snapd/releases/tag/2.45.2) by [this](https://github.com/snapcore/snapd/commit/06342a31878f1cf99d56da5483e71b9af61f46ad) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.4,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "James Henstridge",
    "workaround": "",
    "vendorFixDate": "2020-07-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1826",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-250"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11934",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1826/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/snapd/%2Bbug/1880085",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/snapd/%2Bbug/1880085",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/snapcore/snapd/commit/06342a31878f1cf99d56da5483e71b9af61f46ad",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/snapcore/snapd/releases/tag/2.45.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://people.canonical.com/~ubuntu-security/cve/2020/CVE-2020-11934.html?_ga=2.39478435.1649095121.1595509489-1784443893.1590573231",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1826/default-remediation-status"
            }
        ]
    }
}