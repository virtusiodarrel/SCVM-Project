{
    "source": "BDSA",
    "name": "BDSA-2019-0280",
    "title": "XNU Vulnerable to Copied Memory Manipulation via Copy-on-Write Behavior Bypass with Partial-Page File Truncation",
    "description": "XNU is vulnerable to copied memory manipulation due to insufficient protections on memory affected by copy-on-write behavior. This could allow a local attacker to modify or corrupt protected memory and cause a denial-of-service (DoS) by supplying maliciously crafted messages and system calls.",
    "technicalDescription": "Copy-on-write behavior allows unmodified copies of memory to be shared with their original source, deferring the copy operation until the memory is first modified. However, this behavior is not properly handled in XNU with file mappings. If the filesystem truncates a file, the function `ubc_setsize_ex()` does not always inform the memory management subsystem that any affected pages need to be deduplicated. This results in insufficient protections on copied memory read by a destination process being modified by the source process. An attacker could exploit this by supplying maliciously crafted messages, and attempting to modify them using `ftruncate()`. If processed, this could allow them to manipulate copies of memory read by another process, which could be leveraged to escalate their privileges or cause a system crash.",
    "publishedDate": "2019-02-27T16:15:57.630Z",
    "updatedDate": "2022-04-04T13:42:31.523Z",
    "disclosureDate": "2019-01-30T00:00:00.000Z",
    "exploitPublishDate": "2019-01-30T00:00:00.000Z",
    "solution": "Fixed in [**4903.241.1**](https://github.com/apple-oss-distributions/xnu/releases/tag/xnu-4903.241.1)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.6,
        "impactSubscore": 7.8,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:P/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.7,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn (Google Project Zero)",
    "workaround": "",
    "vendorFixDate": "2019-04-09T00:00:00.000Z",
    "vendorNotifiedDate": "2018-11-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0280",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-199"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-367"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-6208",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0280/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1725",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1725",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apple-oss-distributions/xnu/releases/tag/xnu-4903.241.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://support.apple.com/en-gb/HT209446",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0280/default-remediation-status"
            }
        ]
    }
}