{
    "source": "BDSA",
    "name": "BDSA-2021-2731",
    "title": "fetchmail Vulnerable to Information Exposure and Authentication Bypass via Improper Policy Enforcement",
    "description": "Fetchmail is vulnerable to information exposure and authentication bypass due to the improper handling of messages that are used in the TLS negotiation process. An attacker could exploit this issue in order to obtain sensitive information from network traffic that is being transmitted in plaintext between two peers, or to send input to a server that requires authentication without actually being authenticated.",
    "technicalDescription": "Fetchmail can be configured to secure communications sessions with TLS. A session can use an \"implicit\" TLS connection, whereby TLS is negotiated first. A TLS session can also be established during an unprotected session via the `STARTTLS` message. The `PREAUTH` message can also be used within IMAP sessions to announce that the session is starting in an \"authenticated state\". The `STARTTLS` message is invalid during such sessions. If such a session is being used and \"ssl\" mode has not been configured by the user, then Fetchmail can fail to enforce a mandatory TLS policy that has been configured by the user. If communication is occurring with a POP3 server, then a similar situation can occur if an `AUTH` message is responded to with a list that contains \"RPA\".  Fetchmail can also fail to negotiate TLS connections if the `--auth ssh` configuration setting has been specified, due to an implementation issue. \n\nThese issues can lead to data being transferred in plaintext when it should in fact be encrypted, and may allow unauthorized clients to communicate with servers that require authentication.",
    "publishedDate": "2021-09-27T14:17:05.950Z",
    "updatedDate": "2021-09-27T14:17:05.936Z",
    "disclosureDate": "2021-08-26T00:00:00.000Z",
    "solution": "Fixed in version [**6.4.22-rc1**](https://gitlab.com/fetchmail/fetchmail/-/tags/SNAPSHOT_6-4-22-rc1) by the following commits:\n* [Commit 1](https://gitlab.com/fetchmail/fetchmail/-/commit/b82c3ccb65e3279996a690ebf577263d7730e0b3)\n* [Commit 2](https://gitlab.com/fetchmail/fetchmail/-/commit/8517491d8558e202a33294ac61f2268ef802f03f)\n* [Commit 3](https://gitlab.com/fetchmail/fetchmail/-/commit/e7199006808bb19f58d232da02172ee820d2d83e)\n* [Commit 4](https://gitlab.com/fetchmail/fetchmail/-/commit/3837f0e2e42b43c69b46d240adcbbe3a2c68ce95)\n\nThe latest stable releases can be found [here](https://gitlab.com/fetchmail/fetchmail/-/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.8,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.2,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:A/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrew C. Aitchison",
    "workaround": "",
    "vendorFixDate": "2021-08-26T00:00:00.000Z",
    "vendorNotifiedDate": "2021-08-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2731",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-693"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39272",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2731/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/fetchmail/fetchmail/-/commit/3837f0e2e42b43c69b46d240adcbbe3a2c68ce95",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/fetchmail/fetchmail/-/commit/8517491d8558e202a33294ac61f2268ef802f03f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/fetchmail/fetchmail/-/commit/b82c3ccb65e3279996a690ebf577263d7730e0b3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/fetchmail/fetchmail/-/commit/e7199006808bb19f58d232da02172ee820d2d83e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/fetchmail/fetchmail/-/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/fetchmail/fetchmail/-/tags/SNAPSHOT_6-4-22-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.fetchmail.info/fetchmail-SA-2021-02.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2731/default-remediation-status"
            }
        ]
    }
}