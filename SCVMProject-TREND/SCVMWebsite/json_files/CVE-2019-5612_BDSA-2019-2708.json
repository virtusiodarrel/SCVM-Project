{
    "source": "BDSA",
    "name": "BDSA-2019-2708",
    "title": "FreeBSD Vulnerable to Information Disclosure via 'read(2)' Handler in 'midistat' Device Driver",
    "description": "FreeBSD is vulnerable to information disclosure and denial-of-service (DoS) due to the unsafe handling of system memory resources. An attacker could read the contents of kernel memory, or could cause the application to crash, by tricking a victim into running a crafted program.",
    "technicalDescription": "The `midistat` module within FreeBSD is implemented using code contained in the script `midi.c`. Some of this code defines the system call handlers used by the `midistat` device driver, using functions such as `midi_init()` and `midi_uninit()`. One such handler implements the functionality of the `read` system call. This handlers allocates and manipulates memory buffers within the kernel. These kernel memory resources are not handled safely, in that threads that are manipulating these resources do not implement locking routines. This means that if certain race conditions are satisfied within a multi-threaded application, the resources being controlled by one thread can be read by another. An attacker could therefore obtain the contents of kernel memory by tricking a victim into running a crafted program. On 32-bit systems, such a program could also trigger a kernel panic, which will cause FreeBSD to crash.\n\nCustom kernels without \"device sound\" are not vulnerable.",
    "publishedDate": "2019-08-27T16:19:41.818Z",
    "updatedDate": "2020-01-27T11:32:25.996Z",
    "disclosureDate": "2019-08-20T00:00:00.000Z",
    "solution": "Fixed in version [**12.1.0**](https://www.freebsd.org/releases/) by [this](https://svnweb.freebsd.org/base?view=revision&revision=351264) commit.\n\nFixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=351265) commit in the `stable/11` branch, which has not yet been included in any release.\n\nFixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=351260) commit in the `releng/11.2`, `releng/11.3` and `releng/12.0` branches, which has not yet been included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.8,
        "impactSubscore": 7.8,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Peter Holm, Mark Johnston",
    "workaround": "The vendor states that the vulnerability can be mitigated by restricting permissions on `/dev/midistat`. This can be achieved by adding an entry to `/etc/devfs.conf` and restarting the service, which can be performed using the following commands:\n`echo \"perm midistat 0600\" >> /etc/devfs.conf`\n`service devfs restart`",
    "vendorFixDate": "2019-08-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2708",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5612",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2708/ranges"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=351260",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=351264",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=351265",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-19:23.midi.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2708/default-remediation-status"
            }
        ]
    }
}