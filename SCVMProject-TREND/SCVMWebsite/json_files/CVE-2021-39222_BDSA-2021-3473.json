{
    "source": "BDSA",
    "name": "BDSA-2021-3473",
    "title": "Nextcloud Talk Vulnerable to Stored Cross-Site Scripting (XSS) via Local Image Preview Functionality",
    "description": "Nextcloud Talk is vulnerable to stored cross-site scripting (XSS) due to the unsafe implementation of image previewing functionality. A remote attacker could execute malicious scripts in the browser of a victim by tricking the victim into right-clicking on a malicious file and then opening the file in a new tab. This could potentially allow the attacker to obtain sensitive information, such as browser cookies.\n\nIt should be noted that this vulnerability can only be exploited within browsers which do not support Content-Security-Policy.",
    "technicalDescription": "",
    "publishedDate": "2021-11-17T11:26:09.685Z",
    "updatedDate": "2022-05-18T15:44:12.277Z",
    "disclosureDate": "2021-10-25T00:00:00.000Z",
    "solution": "Fixed in versionS: \n* [**12.0.0-alpha1**](https://github.com/nextcloud/spreed/releases/tag/v12.0.0-alpha.1) by [this](https://github.com/nextcloud/spreed/commit/78415e9952d5763697158b7a424771b7f24add9c) commit.\n* [**11.2.0**](https://github.com/nextcloud/spreed/releases/tag/v11.2.0) by [this](https://github.com/nextcloud/spreed/commit/e47e0fa5eb509608694c81f6c92d1173850d6334) commit.\n* [**11.1.2**](https://github.com/nextcloud/spreed/releases/tag/v11.1.2) by [this](https://github.com/nextcloud/spreed/commit/5571a2ea549da3f9475a32e4802b577f3fab034e) commit.\n* [**10.1.4**](https://github.com/nextcloud/spreed/releases/tag/v10.1.4) by [this](https://github.com/nextcloud/spreed/commit/c5e1bda4a63c25c1d8c2d0b2e1044954a9f04893) commit.\n* [**10.0.7**](https://github.com/nextcloud/spreed/releases/tag/v10.0.7) by [this](https://github.com/nextcloud/spreed/commit/e93e3f66b3eb9c73d764c87423263c2924c68396) commit.\n\nThe latest stable releases can be found [here](https://github.com/nextcloud/spreed/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "The vendor has stated [here](https://github.com/nextcloud/security-advisories/security/advisories/GHSA-xhxq-f4vg-jw5g) that the following workaround can be implemented:\n\n> Use a browser that has support for Content-Security-Policy.",
    "vendorFixDate": "2021-03-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3473",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39222",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3473/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-xhxq-f4vg-jw5g",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-xhxq-f4vg-jw5g",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/spreed/commit/5571a2ea549da3f9475a32e4802b577f3fab034e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/spreed/commit/78415e9952d5763697158b7a424771b7f24add9c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/spreed/commit/c5e1bda4a63c25c1d8c2d0b2e1044954a9f04893",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/spreed/commit/e47e0fa5eb509608694c81f6c92d1173850d6334",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/spreed/commit/e93e3f66b3eb9c73d764c87423263c2924c68396",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/spreed/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/spreed/releases/tag/v10.0.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/spreed/releases/tag/v10.1.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/spreed/releases/tag/v11.1.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/spreed/releases/tag/v11.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/spreed/releases/tag/v12.0.0-alpha.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3473/default-remediation-status"
            }
        ]
    }
}