{
    "source": "BDSA",
    "name": "BDSA-2020-0686",
    "title": "jQuery Vulnerable to Cross-Site Scripting (XSS) via 'jQuery.htmlPrefilter' Method",
    "description": "It was discovered that jQuery could allow for cross-site scripting (XSS) vulnerabilities to be introduced if `jQuery.htmlPrefilter` method is used. Attackers could exploit XSS vulnerabilities to execute JavaScript code in a target's browser by tricking them into accessing the vulnerable page. This would allow an attacker to steal an administrator's session tokens or execute arbitrary code on their behalf by sending the link to an unsuspecting user or waiting for them to discover it.",
    "technicalDescription": "`jQuery.htmlPrefilter` uses regex-based `replace` method to ensure that all closing tags are XHTML (eXtensible HTML)-compliant when passed to methods. It was found that in some cases the workings of the regex could be abused in order to introduce cross-site scripting (XSS) vulnerabilities. To fix this the regex functionality has now been disabled so that `jQuery.htmlPrefilter` returns strings unchanged.\n\nThis XSS vulnerability affects DOM manipulation methods (such as `.html()`, `.append()`) that use `.htmlPrefilter` method.\n\nTo sanitize user input with the new `jQuery.htmlPrefilter` behaviour, the vendor advises using `DOMPurify` plugin's `sanitize` method without the `SAFE_FOR_JQUERY` option.\n\nSince `htmlPrefilter` is used in jQuery manipulation methods, their workings have changed. The vendor now advises to not use self-closing tags for tags that may have content unless the page runs in XHTML mode. To make sure the page runs in XHTML mode it is required that the mime type sent is `application/xhtml+xml`.  In order to make it work in both HTML and XHTML modes, use self-closing tags for elements that do not have closing tags in HTML.",
    "publishedDate": "2020-04-14T17:24:19.811Z",
    "updatedDate": "2022-01-18T14:58:16.373Z",
    "disclosureDate": "2020-04-10T00:00:00.000Z",
    "exploitPublishDate": "2020-04-29T00:00:00.000Z",
    "solution": "Fixed in [**3.5.0**](https://github.com/jquery/jquery/releases/tag/3.5.0) by [this](https://github.com/jquery/jquery/commit/1d61fd9407e6fbe82fe55cb0b938307aa0791f77) commit.\n\nThe latest stable releases are available [here](https://jquery.com/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "If the old behaviour of `jQuery.htmlPrefilter` in jQuery **3.5.0** is required nonetheless, the vendor advises using `jQuery.UNSAFE_restoreLegacyHtmlPrefilter` from `jQuery Migrate` **3.2.0**. Since this reverses the security fix, it is also recommended to use `DOMPurify` plugin's `sanitize` method with `SAFE_FOR_JQUERY` set to `True` to properly sanitize user's HTML input again.",
    "vendorFixDate": "2020-03-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0686",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11022",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0686/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.jquery.com/2020/04/10/jquery-3-5-0-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.jquery.com/2020/04/10/jquery-3-5-0-released/",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jquery/jquery/commit/1d61fd9407e6fbe82fe55cb0b938307aa0791f77",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jquery/jquery/releases/tag/3.5.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jquery.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jquery.com/upgrade-guide/3.5/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/49766",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0686/default-remediation-status"
            }
        ]
    }
}