{
    "source": "BDSA",
    "name": "BDSA-2020-4574",
    "title": "Calico Vulnerable to Man-in-the-Middle (MitM) Attacks via Unsafe IPv6 Implementation",
    "description": "Calico is vulnerable to man-in-the-middle attacks due to the unsafe implementation of IPv6 functionality. An attacker who has compromised a pod can cause IPv6 traffic to be routed through that pod by sending out malicious IPv6 route advertisements. This may allow the attacker to obtain, or modify, sensitive information.",
    "technicalDescription": "The networking interfaces that are available on host nodes will typically accept IPv6 router advertisements by default. The pods that are running on these nodes will usually have the `CAP_NET_RAW` capability available, which will allow for the creation of raw sockets. An attacker who has compromised a pod within a node could use the pod's raw socket capabilities in order to send IPv6 route advertisements to the parent node. \n\nThese route advertisements can be used to reconfigure the node's routing tables, and cause IPv6 traffic to be sent to the compromised pod. Communications with remote hosts that would have occurred via IPv4 prior to the attack may also end up being sent to the compromised pod. This is due to the fact that, if an IPv6 address is offered alongside an IPv4 address during the DNS resolution process, then the IPv6 address may be prioritized. The attacker could therefore carry out a man-in-the-middle (MitM) attack in order to obtain or modify sensitive information. \n\nIt should be noted that the attack cannot be carried out if the host node's networking interfaces do not have IPv6 routing enabled, or the `CAP_NET_RAW` capability is not available.",
    "publishedDate": "2021-08-04T16:13:12.520Z",
    "updatedDate": "2021-08-04T16:13:12.515Z",
    "disclosureDate": "2020-06-01T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.14.1**](https://github.com/projectcalico/cni-plugin/releases/tag/v3.14.1) by [this](https://github.com/projectcalico/cni-plugin/commit/3fef1de5b3443eaa0c382100cc6b0ffa0f93a7a5) commit.\n* [**3.13.4**](https://github.com/projectcalico/cni-plugin/releases/tag/v3.13.4) by [this](https://github.com/projectcalico/cni-plugin/commit/c1910acd4230d1dfad99636b3e20f3ca9da37a8d) commit.\n* [**3.12.2**](https://github.com/projectcalico/cni-plugin/releases/tag/v3.12.2) by [this](https://github.com/projectcalico/cni-plugin/commit/cad38fdf697add2a6f9404b212af68bd6aacd446) commit.\n* [**3.11.3**](https://github.com/projectcalico/cni-plugin/releases/tag/v3.11.3) by [this](https://github.com/projectcalico/cni-plugin/commit/bf6ebc872a06667a1e21285357eb5eda029368a5) commit.\n* [**3.10.4**](https://github.com/projectcalico/cni-plugin/releases/tag/v3.10.4) by [this](https://github.com/projectcalico/cni-plugin/commit/75114aad214a2b0bf2b9363694d5bc522a4a6050) commit.\n* [**3.9.6**](https://github.com/projectcalico/cni-plugin/releases/tag/v3.9.6) by [this](https://github.com/projectcalico/cni-plugin/commit/8aef1f873e9d509cd8400a6520546b698a8731aa) commit.\n* [**3.8.9**](https://github.com/projectcalico/cni-plugin/releases/tag/v3.8.9) by [this](https://github.com/projectcalico/cni-plugin/commit/7f04a5c57dce6b59fe5a89526214c2e68f18aacb) commit.\n\nThe latest stable releases are available [here](https://github.com/projectcalico/cni-plugin/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.0,
        "impactSubscore": 3.7,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated that the following manual workaround can be implemented:\n\n> Set all running pods to be non-root and drop `CAP_NET_RAW` capability using `PodSecurityPolicy`.\n\n> SSH into the host node to manually disable IPv6 route advertisement by setting `/proc/sys/net/ipv6/conf/{all,default,interfaces}/accept_ra` to 0.",
    "vendorFixDate": "2020-05-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4574",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13597",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4574/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/commit/3fef1de5b3443eaa0c382100cc6b0ffa0f93a7a5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/commit/75114aad214a2b0bf2b9363694d5bc522a4a6050",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/commit/7f04a5c57dce6b59fe5a89526214c2e68f18aacb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/commit/8aef1f873e9d509cd8400a6520546b698a8731aa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/commit/bf6ebc872a06667a1e21285357eb5eda029368a5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/commit/c1910acd4230d1dfad99636b3e20f3ca9da37a8d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/commit/cad38fdf697add2a6f9404b212af68bd6aacd446",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/releases/tag/v3.10.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/releases/tag/v3.11.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/releases/tag/v3.12.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/releases/tag/v3.13.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/releases/tag/v3.14.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/releases/tag/v3.8.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/cni-plugin/releases/tag/v3.9.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.tigera.io/security-bulletins/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.tigera.io/security-bulletins/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4574/default-remediation-status"
            }
        ]
    }
}