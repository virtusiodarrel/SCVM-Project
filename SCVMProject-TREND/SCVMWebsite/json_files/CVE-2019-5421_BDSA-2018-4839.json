{
    "source": "BDSA",
    "name": "BDSA-2018-4839",
    "title": "Plataformatec Devise Vulnerable to Brute Force Attacks via Race Condition in 'increment_failed_attempts' Function",
    "description": "Plataformatec Devise is vulnerable to brute force attacks due to a race condition which prevents users from being properly locked. This could allow an attacker to perform greater numbers of login attempts than intended.",
    "technicalDescription": "When a failed login attempt is performed, the function `increment_failed_attempts` within the file `lib/devise/models/lockable.rb` reads and increases the counter `failed_attempts` in two separate operations, meaning it is not concurrency safe. This could result in multiple failed login attempts, if made at the same time, only incrementing the counter once. This could allow an attacker to make a large number of login attempts before a user is locked, depending on the rate of their attempts, the thread configuration of the server and the current congestion of the database.",
    "publishedDate": "2019-04-08T14:35:08.612Z",
    "updatedDate": "2019-04-08T14:35:08.591Z",
    "disclosureDate": "2018-11-27T00:00:00.000Z",
    "exploitPublishDate": "2018-11-27T00:00:00.000Z",
    "solution": "Fixed in **[4.6.0](https://github.com/plataformatec/devise/releases/tag/v4.6.0)** by [this](https://github.com/plataformatec/devise/commit/62703943bef75aba09ec3e346aba4c9159300ecd) commit.\n\nThe latest stable releases are available [here](https://github.com/plataformatec/devise/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Fredrik Eckardt",
    "workaround": "",
    "vendorFixDate": "2018-12-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-4839",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-367"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5421",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-4839/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plataformatec/devise/commit/62703943bef75aba09ec3e346aba4c9159300ecd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plataformatec/devise/issues/4981",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plataformatec/devise/issues/4981",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plataformatec/devise/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plataformatec/devise/releases/tag/v4.6.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-4839/default-remediation-status"
            }
        ]
    }
}