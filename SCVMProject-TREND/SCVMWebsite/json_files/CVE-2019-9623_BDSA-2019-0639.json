{
    "source": "BDSA",
    "name": "BDSA-2019-0639",
    "title": "FengOffice Vulnerable to Remote Code Execution (RCE) via File Upload Functionality",
    "description": "An unrestricted file upload vulnerability has been discovered in FengOffice. An attacker could exploit this vulnerability by uploading arbitrary files which could be utilized to execute malicious scripts against the target system.",
    "technicalDescription": "A weakness has been discovered in FengOffice which could be manipulated to execute arbitrary code against the system. The application does not handle sessions correctly, which allows unauthenticated users to upload files to application directories. It was discovered that the `.htaccess`file implements validation check to prevent `.php` files from being moved from the `/tmp` file to the main directory.  This validation process can be manipulated and bypassed.\n\nAn attacker could exploit this vulnerability by uploading two different files. An encoded PHP payload which will stored in the `/tmp` directory, and a script file that utilizes the `.stml` filetype. The script will execute to target the payload and move the file into the main directory location. After the initial script has moved the file the remainder will execute which can create a reverse shell on the target system.",
    "publishedDate": "2019-03-06T16:54:28.173Z",
    "updatedDate": "2019-04-17T11:02:25.584Z",
    "disclosureDate": "2019-02-28T00:00:00.000Z",
    "exploitPublishDate": "2019-02-28T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNCONFIRMED",
            "score": 5.8
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:U/RC:UC)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNKNOWN",
            "score": 8.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:U/RC:U"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Ozkan Mustafa Akkus",
    "workaround": "",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0639",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9623",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0639/ranges"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/151912/fengoffice3705-exec.rb.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/151912/fengoffice3705-exec.rb.txt",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46471",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0639/default-remediation-status"
            }
        ]
    }
}