{
    "source": "BDSA",
    "name": "BDSA-2021-1727",
    "title": "Zephyr OS Bluetooth LE Controller Vulnerable to Denial-of-Service (DoS) via  Invalid CONNECT_IND",
    "description": "Synopsys Cybersecurity Research Center (CyRC) has discovered that Zephyr's Bluetooth Low Energy Controller (LE Link Layer) is vulnerable to denial-of-service (DoS) caused by division by zero. An attacker can trigger this by sending an invalid interval value in a CONNECT_IND packet.\n\nTriggering this vulnerability does not require authentication or encryption. The only requirement is that the device is in advertising mode and accepting connections, and that the attacker is within range of the Bluetooth device.",
    "technicalDescription": "This vulnerability  occurs in `ull_slave_setup()` function in `ull-slave.c` which does not check if the interval value is correct. Receipt of  a CONNECT_IND connection request with Interval value set to 0x0000 leads to a division by zero and causes the target device to freeze.\n\nAn attacker is able to disrupt all the ongoing communication and cause  denial-of-service (DoS)  by sending such an invalid interval value in CONNECT_IND packet to any Zephyr based Bluetooth LE device which is advertising and open to connection.",
    "publishedDate": "2021-06-22T14:52:31.210Z",
    "updatedDate": "2021-09-21T12:45:50.071Z",
    "disclosureDate": "2021-06-11T00:00:00.000Z",
    "solution": "Fixed in [**2.6.0-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.6.0-rc1) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/813b24157b3e6bd51250cadabd96d087bf284caa) commit.\n\nFixed in [**2.5.1-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.5.1-rc1) by [this](https://github.com/zephyrproject-rtos/zephyr/commit/ef7cbbfb60ddb3dde416eaaed702826e4c1858ff) commit.\n\nFixed in [**1.14.3-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v1.14.3-rc1) by [this](https://github.com/zephyrproject-rtos/zephyr/commit/a219598694) commit.\n\nInstructions for manual backport of fix to [**1.14-branch**](https://github.com/zephyrproject-rtos/zephyr/tree/v1.14-branch) can be found [here](https://github.com/zephyrproject-rtos/zephyr/pull/33278).\n\nThe most recent release can be found [here](https://www.zephyrproject.org/developer-resources/#current-release).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:A/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matias Karhumaa  (Synopsys Cybersecurity Research Center   (CyRC))",
    "workaround": "",
    "vendorFixDate": "2021-03-15T00:00:00.000Z",
    "discoveryDate": "2021-02-02T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1727",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-369"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3432",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1727/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/813b24157b3e6bd51250cadabd96d087bf284caa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/ef7cbbfb60ddb3dde416eaaed702826e4c1858ff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/pull/33278",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/pull/33278",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v1.14.3-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.5.1-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.6.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/policy",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.synopsys.com/blogs/software-security/cyrc-advisory-zephyr-vulnerability/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.zephyrproject.org/developer-resources/#current",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1727/default-remediation-status"
            }
        ]
    }
}