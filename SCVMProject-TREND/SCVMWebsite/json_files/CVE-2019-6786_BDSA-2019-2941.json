{
    "source": "BDSA",
    "name": "BDSA-2019-2941",
    "title": "GitLab Vulnerable to Incorrect Access Control via LFS Pull on Tracked Objects",
    "description": "Gitlabs Large File Storage (LFS) functionality is vulnerable to incorrect access control.  This allows a remote attacker to obtain files from a git LFS storage by only knowing the hash and file size.",
    "technicalDescription": "The incorrect access control vulnerability is due to a lack of validation on the `.../repo.git/gitlab-lfs/objects/:oid/:size` endpoint.  If a remote attacker knows or can guess the `oid` and `size` values, any file from that LFS can be retrieved without proper authorization.  This is because the `oid` and `size` values are not properly validated while making calls to the endpoint.  \n\nFor a remote attacker to exploit this vulnerability, they require read access to the repository being targeted.  This is due to the attacker needing to know the `oid` SHA-256 for the LFS object.  It maybe possible to obtain this from a local cloned copy of the project, but this would also require the attacker to have read access to the targeted repository.  If an attacker has access to the server hosting the repository but not access to the repository itself, it may be possible to obtain the `oid` value from log files.\n\n\nThe result of this vulnerability is that a remote attacker can read LFS tracked files from a private or internal repository.",
    "publishedDate": "2019-09-17T12:51:04.564Z",
    "updatedDate": "2019-09-17T12:51:04.553Z",
    "disclosureDate": "2019-01-31T00:00:00.000Z",
    "exploitPublishDate": "2019-01-31T00:00:00.000Z",
    "solution": "Fixed in GitLab FOSS versions:\n\n* [**11.7.3 **](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.7.3)\n* [**11.6.8**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.6.8)\n* [**11.5.10**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.5.10)\n\nFixed in Workhorse versions:\n\n* [**8.1.1**](https://gitlab.com/gitlab-org/gitlab-workhorse/-/tags/v8.1.1) by [this](https://gitlab.com/gitlab-org/gitlab-workhorse/commit/12b9a8b47f9b373758517cbf326cfec58707d6cb) commit.\n* [**8.0.1**](https://gitlab.com/gitlab-org/gitlab-workhorse/-/tags/v8.0.1) by [this](https://gitlab.com/gitlab-org/gitlab-workhorse/commit/255f370a0dfde044dd767bbe4221bee49acbe490) commit.\n* [**7.6.1**](https://gitlab.com/gitlab-org/gitlab-workhorse/-/tags/v7.6.1) by [this](https://gitlab.com/gitlab-org/gitlab-workhorse/commit/b5e9a0fc805b1cb6bb4785c427da82c78d62fff5) commit.\n* [**7.1.4**](https://gitlab.com/gitlab-org/gitlab-workhorse/-/tags/v8.1.1) by [this](https://gitlab.com/gitlab-org/gitlab-workhorse/commit/52981b3e4e46dc48bd47fb8a3a71726cc264a9ad) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.1,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.6,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.8
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Maxim Ivanov",
    "workaround": "",
    "vendorFixDate": "2019-01-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2941",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-6786",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2941/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.5.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.6.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.7.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/issues/55879/designs",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-workhorse/-/tags/v7.1.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-workhorse/-/tags/v7.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-workhorse/-/tags/v8.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-workhorse/-/tags/v8.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-workhorse/commit/12b9a8b47f9b373758517cbf326cfec58707d6cb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-workhorse/commit/255f370a0dfde044dd767bbe4221bee49acbe490",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-workhorse/commit/52981b3e4e46dc48bd47fb8a3a71726cc264a9ad",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-workhorse/commit/b5e9a0fc805b1cb6bb4785c427da82c78d62fff5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-workhorse/issues/197",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-workhorse/issues/197",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2941/default-remediation-status"
            }
        ]
    }
}