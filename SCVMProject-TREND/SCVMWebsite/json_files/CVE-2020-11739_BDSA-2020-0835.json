{
    "source": "BDSA",
    "name": "BDSA-2020-0835",
    "title": "Xen Vulnerable to Denial-of-Service (DoS) via Missing Memory Barriers in 'read-write' Unlock Paths",
    "description": "It was discovered that XEN contains a denial-of-service (DoS) vulnerability. The issue occurs due to missing memory barriers on read-write unlock paths. The read-write locks are used in hypercalls therefore an attacker could exploit the race to potentially cause a memory leak or a hypervisor crash resulting in a DoS condition.",
    "technicalDescription": "The vulnerability occurs due to  `rwlock` unlock paths, using `atomic_sub()` to release the lock, which doesn't contain a memory barrier. On Arm this results in the processor being able to re-order memory access with the proceeding access. This could result in a condition where the writer could be executing a critical section of the memory at the same time as readers or other writers. \nThis renders many of the assumptions made by the application unsafe. \n\nA malicious guest user could exploit the race to cause a memory leak if ` XENMAPSPACE_grant_table` is used concurrently resulting in potential information disclosure or a hypervisor crash.",
    "publishedDate": "2020-04-20T16:10:17.573Z",
    "updatedDate": "2020-10-13T13:35:23.007Z",
    "disclosureDate": "2020-04-14T00:00:00.000Z",
    "solution": "Fixed in \n* [**4.11.4**](https://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=refs/tags/RELEASE-4.11.4) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=d430e15e021b81f1f6c3e35d703a6f195a9b2e5c) commit\n* [**4.12.3**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.12.3) by [this](https://github.com/xen-project/xen/commit/1541b26e844ea32dd1695fe9ebed76ed17b537cd) commit\n* [**4.13.1**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.1) by [this](https://github.com/xen-project/xen/commit/b6a2c42303cb70c87de49b4a70e28f7495432f07) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Julien Grall",
    "workaround": "",
    "vendorFixDate": "2020-04-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0835",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-119"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11739",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0835/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/1541b26e844ea32dd1695fe9ebed76ed17b537cd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/b6a2c42303cb70c87de49b4a70e28f7495432f07",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.12.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=d430e15e021b81f1f6c3e35d703a6f195a9b2e5c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=refs/tags/RELEASE-4.11.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-314.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0835/default-remediation-status"
            }
        ]
    }
}