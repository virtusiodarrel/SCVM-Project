{
    "source": "BDSA",
    "name": "BDSA-2021-1129",
    "title": "Terraform Vault Provider Vulnerable to Authentication Bypass via Incorrect GCP Bound Label Configuration",
    "description": "Terraform Vault Provider is vulnerable to authentication bypass due to the improper mapping of configuration values. An attacker could potentially access restricted functionality by sending crafted requests to a vulnerable endpoint.",
    "technicalDescription": "Terraform Vault Provider can configure Vault instances by communicating with Vault API endpoints. This functionality is implemented by mapping Terraform configuration values to the appropriate endpoint. The mapping for the bounds label Terraform configuration setting is incorrect, such that this configuration will not be applied within Vault. This is due to an incorrect string value being used in the `gcpRoleUpdateFields()` function, of file `vault/resource_gcp_auth_backend_role.go`.  The string that is used is `\"bound_instance_labels\"`, when it should in fact be `\"bound_labels\"`. This will lead to the incorrect application of security controls, which could allow an attacker to bypass authentication and access restricted functionality.",
    "publishedDate": "2021-05-26T10:35:22.870Z",
    "updatedDate": "2021-05-26T10:35:22.863Z",
    "disclosureDate": "2021-04-21T00:00:00.000Z",
    "solution": "Fixed in [**2.19.1**](https://github.com/hashicorp/terraform-provider-vault/releases/tag/v2.19.1) by [this](https://github.com/hashicorp/terraform-provider-vault/commit/02c055f9e126dedaac3b7ae4079d35dd43c5798e) commit.\n\nThe latest stable releases are available [here](https://github.com/hashicorp/terraform-provider-vault/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1129",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-30476",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1129/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.hashicorp.com/t/hcsec-2021-11-terraform-s-vault-provider-did-not-correctly-configure-bound-labels-for-gcp-auth/23464",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/terraform-provider-vault/commit/02c055f9e126dedaac3b7ae4079d35dd43c5798e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/terraform-provider-vault/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/terraform-provider-vault/releases/tag/v2.19.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1129/default-remediation-status"
            }
        ]
    }
}