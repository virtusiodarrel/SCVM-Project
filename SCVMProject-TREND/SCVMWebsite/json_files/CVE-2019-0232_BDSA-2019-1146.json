{
    "source": "BDSA",
    "name": "BDSA-2019-1146",
    "title": "Apache Tomcat Vulnerable to Remote Code Execution (RCE) via Improper Input Validation in JRE Command Line Arguments",
    "description": "An improper input validation vulnerability has been discovered in Apache Tomcat. An attacker could exploit this vulnerability through the command line to execute arbitrary code against the target system.\n\nThis vulnerability affects only Windows operating systems.",
    "technicalDescription": "A weakness has been discovered in Apache Tomcat which can lead to arbitrary code execution against the target system. The default data sanitization process implemented by the common gateway interface (CGI) servlet did not handle filenames correctly on  the Windows operating system (OS).  If the `enableCmdLineArguments` option is enabled on the CGI servlet arbitrary code could be passed by the Java Runtime Environment (JRE) to the OS. \n\nThe regular expression patterns utilized in the file `java/org/apache/catalina/servlets/CGIServlet.java` did not capture additional characters which could exist due to the Windows OS naming structure. \n\nNote: The `CGI Servlet` and `enableCmdLineArguments` are disabled by default in Tomcat version 9.0.x.",
    "publishedDate": "2019-04-23T10:31:54.827Z",
    "updatedDate": "2020-08-11T10:36:52.393Z",
    "disclosureDate": "2019-04-10T00:00:00.000Z",
    "exploitPublishDate": "2019-11-21T00:00:00.000Z",
    "solution": "Fixed in:\n* [**8.5.40**](https://github.com/apache/tomcat/releases/tag/8.5.40) by [this](https://github.com/apache/tomcat/commit/1c1d49ed4e6ef6a9a08aa341d77e891c38f8637c) commit and [this](https://github.com/apache/tomcat/commit/5bc4e6d7b1c22dc1bf99f475b7e70594ebdd83b9) commit, \n*  [**9.0.18**](https://github.com/apache/tomcat/releases/tag/9.0.18) by [this](https://github.com/apache/tomcat/commit/55f4eba042a25e2e56dfe4288814ad0884bfc748) commit and [this](https://github.com/apache/tomcat/commit/4b244d827ade2a36ef3b8734939541207b78f35c) commit,\n*  [**7.0.94**](https://github.com/apache/tomcat/releases/tag/7.0.94) by [this](https://github.com/apache/tomcat/commit/66644380111457f86c18e7cd96dbddb1ad44d39b) commit and [this](https://github.com/apache/tomcat/commit/7f0221b904956359f2d739aa3a2b53f8c12ed8c7) commit.",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "Ensure the CGI Servlet initialisation parameter `enableCmdLineArguments` is set to false.",
    "vendorFixDate": "2019-04-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1146",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-0232",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1146/ranges"
            },
            {
                "rel": "reference",
                "href": "http://mail-archives.us.apache.org/mod_mbox/www-announce/201904.mbox/%3C13d878ec-5d49-c348-48d4-25a6c81b9605%40apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-0232",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://codewhitesec.blogspot.com/2016/02/java-and-command-line-injections-in-windows.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/1c1d49ed4e6ef6a9a08aa341d77e891c38f8637c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/4b244d827ade2a36ef3b8734939541207b78f35c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/55f4eba042a25e2e56dfe4288814ad0884bfc748",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/5bc4e6d7b1c22dc1bf99f475b7e70594ebdd83b9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/66644380111457f86c18e7cd96dbddb1ad44d39b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/7f0221b904956359f2d739aa3a2b53f8c12ed8c7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/7.0.94",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/8.5.40",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/9.0.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/setrus/CVE-2019-0232",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/47073",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1146/default-remediation-status"
            }
        ]
    }
}