{
    "source": "BDSA",
    "name": "BDSA-2021-0282",
    "title": "MinIO Vulnerable to Server-Side Request Forgery (SSRF) via Insufficient JWT Token Validation",
    "description": "MinIO is vulnerable to server-side request forgery (SSRF) due to the insufficient validation of tokens. A remote attacker could cause a server to forward malicious traffic to internal services by sending maliciously crafted packets to that server.",
    "technicalDescription": "The function `LoginSTS()`, of the file `cmd/web-handlers.go`, is used by MinIO as the STS user login handler. This function uses the variable `args.Token`, which corresponds to the received JWT token. The value of this variable is not validated, and it is automatically used within the response that is generated by the function. This allows an attacker to send maliciously crafted requests to the server that do not contain valid JWT tokens, but will nonetheless cause the attacker's malicious traffic to be forwarded to internal services.\n\nThe vulnerability was fixed by adding validation logic for the received JWT token.",
    "publishedDate": "2021-02-03T15:21:08.734Z",
    "updatedDate": "2021-02-03T15:21:08.727Z",
    "disclosureDate": "2021-01-30T00:00:00.000Z",
    "solution": "Fixed in [**2021-01-30T00-20-58Z**](https://github.com/minio/minio/releases/tag/RELEASE.2021-01-30T00-20-58Z) by [this](https://github.com/minio/minio/commit/eb6871ecd960d570f70698877209e6db181bf276) commit.\n\nThe latest stable releases can be found [here](https://min.io/download).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Lenin Alevski",
    "workaround": "The vendor has stated that the browser front-end can be disabled by setting the environmental variable `MINIO_BROWSER=off`.",
    "vendorFixDate": "2021-01-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0282",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21287",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0282/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/minio/minio/commit/eb6871ecd960d570f70698877209e6db181bf276",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/minio/minio/releases/tag/RELEASE.2021-01-30T00-20-58Z",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/minio/minio/security/advisories/GHSA-m4qq-5f7c-693q",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/minio/minio/security/advisories/GHSA-m4qq-5f7c-693q",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://min.io/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0282/default-remediation-status"
            }
        ]
    }
}