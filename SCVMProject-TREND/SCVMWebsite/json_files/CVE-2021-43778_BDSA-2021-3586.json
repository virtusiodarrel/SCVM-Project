{
    "source": "BDSA",
    "name": "BDSA-2021-3586",
    "title": "Barcode GLPI Plugin Vulnerable to Path Traversal via Insufficient '$filename' Parameter Validation",
    "description": "The Barcode plugin for GLPI is vulnerable to path traversal due to the improper implementation of a security mechanism. A remote unauthenticated attacker could recover the contents of files that reside on a vulnerable server by submitting maliciously crafted HTTP requests to that server.",
    "technicalDescription": "The file `front/send.php` allows users to retrieve the contents of files that reside on a server. Clients specify the file that they would like to retrieve via the `file` HTTP GET request parameter. The value of this parameter is retrieved and assigned to the variable `filename`. Clients should only be able to retrieve files that are located in the directory that is denoted by the `$docDir` variable. A check exists within `front/send.php` which detects if `filename` contains the `../` and `..\\\\` character sequences. If these sequences are detected, then an error message is logged. However, the execution flow of the process is not altered in any way. An attacker could therefore retrieve arbitrary files that reside on the server by sending crafted HTTP GET requests to that server.\n\nThe vulnerability was fixed by terminating the execution of `front/send.php` if the `../` or `..\\\\` sequences are detected.",
    "publishedDate": "2021-11-30T09:46:59.496Z",
    "updatedDate": "2021-11-30T09:46:59.482Z",
    "disclosureDate": "2021-11-15T00:00:00.000Z",
    "exploitPublishDate": "2021-11-24T00:00:00.000Z",
    "solution": "Fixed in version [**2.6.1**](https://github.com/pluginsGLPI/barcode/releases/tag/2.6.1) by [this](https://github.com/pluginsGLPI/barcode/commit/428c3d9adfb446e8492b1c2b7affb3d34072ff46) commit.\n\nThe latest stable releases can be found [here](https://github.com/pluginsGLPI/barcode/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-11-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3586",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43778",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3586/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hansmach1ne/MyExploits/tree/main/Path%20Traversal%20in%20GLPI%20Barcode%20plugin",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluginsGLPI/barcode/commit/428c3d9adfb446e8492b1c2b7affb3d34072ff46",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluginsGLPI/barcode/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluginsGLPI/barcode/releases/tag/2.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluginsGLPI/barcode/security/advisories/GHSA-2pjh-h828-wcw9",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3586/default-remediation-status"
            }
        ]
    }
}