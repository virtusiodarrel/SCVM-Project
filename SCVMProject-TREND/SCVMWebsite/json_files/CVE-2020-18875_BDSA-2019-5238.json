{
    "source": "BDSA",
    "name": "BDSA-2019-5238",
    "title": "DotCMS Vulnerable to Privilege Escalation via Insufficient Velocity Session Restrictions",
    "description": "DotCMS is vulnerable to privilege escalation due to insufficient restrictions being enforced for Velocity sessions. A remote attacker could potentially modify attributes, such as their user ID, during a Velocity session in order to elevate their privileges.",
    "technicalDescription": "DotCMS uses the Apache Velocity template engine in order to provide users with a front-end development interface. Users can establish a session with the Velocity component of the DotCMS server using functionality that is provided by the `HttpSession` class, which exposes the `setAttribute()` method. This method can be used to modify a session's attributes. DotCMS also utilizes the `RequestWrapper` class, which is defined in the file `dotCMS/src/main/java/com/dotcms/rendering/velocity/viewtools/RequestWrapper.java`. This class also contains a `setAttribute()` method. DotCMS insufficiently restricts this attribute modification functionality. An attacker who has established a Velocity session could potentially modify the user ID that is associated with that session in order to escalate their privileges. They may also be able to modify other attributes in order to cause other adverse effects.\n\nThe vulnerability was mitigated by adding restrictions on what attributes can be modified within a Velocity session. This functionality uses a blacklist, `SET_VALUE_BLACKLIST`, which specifies attributes which cannot be modified by `setAttribute()`.",
    "publishedDate": "2021-08-20T13:57:33.256Z",
    "updatedDate": "2021-08-20T13:57:33.238Z",
    "disclosureDate": "2019-01-24T00:00:00.000Z",
    "solution": "Fixed in version [**5.1.0**](https://github.com/dotCMS/core/releases/tag/5.1.0) by [this](https://github.com/dotCMS/core/commit/9e6f5e6049caf3ae16f450419597fd9eb3c3a489) commit.\n\nThe latest stable releases can be found [here](https://github.com/dotCMS/core/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-01-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5238",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-676"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-18875",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5238/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/commit/9e6f5e6049caf3ae16f450419597fd9eb3c3a489",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/issues/15882",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/releases/tag/5.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5238/default-remediation-status"
            }
        ]
    }
}