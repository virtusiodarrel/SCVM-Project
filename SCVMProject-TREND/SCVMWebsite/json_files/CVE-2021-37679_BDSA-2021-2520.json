{
    "source": "BDSA",
    "name": "BDSA-2021-2520",
    "title": "Tensorflow Vulnerable to Information Exposure via Out-of-Bounds Read in 'NestedStackRaggedTensors' Function",
    "description": "Tensorflow contains an out-of-bounds read vulnerability. Successfully exploiting this could allow an attacker to read outside of the bounds of heap allocated data, which could potentially cause information disclosure.",
    "technicalDescription": "This vulnerability exists due to insufficient validation in the `NestedStackRaggedTensors()` function of file `tensorflow/core/kernels/ragged_tensor_from_variant_op.cc`. During the conversion from a `Variant` tensor to a `RaggedTensor`, there are no checks to ensure that all inner shapes match, which can lead to the output being filled with uninitialized contents from the heap in order to make up the difference. An attacker can take advantage of this by using a crafted input tensor in order to force an out-of-bounds read, resulting in information disclosure. \n\nAdditionally, this vulnerability can result in data loss during the conversion from a `Variant` tensor to a `RaggedTensor`. In certain circumstances this transformation can result in a loss of elements for each inner dimension between the input tensor and the output tensor. \n\nThe vendor has mitigated against this by including additional checks to ensure that the input tensor has a compatible shape.",
    "publishedDate": "2021-08-20T13:31:12.217Z",
    "updatedDate": "2021-08-20T13:31:12.206Z",
    "disclosureDate": "2021-08-11T00:00:00.000Z",
    "solution": "Fixed in:\n* **[2.3.4](https://github.com/tensorflow/tensorflow/releases/tag/v2.3.4)** by [this](https://github.com/tensorflow/tensorflow/commit/88e31ad1340) commit,\n* **[2.4.3](https://github.com/tensorflow/tensorflow/releases/tag/v2.4.3)** by [this](https://github.com/tensorflow/tensorflow/commit/2c39352546a) commit,\n* **[2.5.1](https://github.com/tensorflow/tensorflow/releases/tag/v2.5.1)** by [this](https://github.com/tensorflow/tensorflow/commit/3a1aea3572c) commit,\n* **[2.6.0-rc2](https://github.com/tensorflow/tensorflow/releases/tag/v2.6.0-rc2)** by [this](https://github.com/tensorflow/tensorflow/commit/7b1a377b3c2) commit.\n\nThe latest stable releases are available [here](https://github.com/tensorflow/tensorflow/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.2,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Haris Sahovic",
    "workaround": "",
    "vendorFixDate": "2021-07-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2520",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-37679",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2520/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/2c39352546a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/3a1aea3572c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/7b1a377b3c2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/88e31ad1340",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.6.0-rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-g8wg-cjwc-xhhp",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2520/default-remediation-status"
            }
        ]
    }
}