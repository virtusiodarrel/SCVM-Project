{
    "source": "BDSA",
    "name": "BDSA-2019-3341",
    "title": "Apache POI Vulnerable to XML External Entity (XXE) Injection via 'XSSFExportToXml' Tool",
    "description": "Apache is vulnerable to XML External Entity (XXE) injection due to the unsafe processing of client-provided input documents. An attacker could read files from the local file system, or from internal network resources, by providing a crafted Excel document to the application.",
    "technicalDescription": "The Apache POI application provides users with the `XSSFExportToXml` tool, which provides Microsoft Excel document conversion functionality. This is implemented using code contained within the file `XSSFExportToXml.java`. The XML parser that is implemented within this tool will process XML External Entity (XXE) objects that are contained within input files without any validation taking place. An attacker could therefore provide the application with a crafted Microsoft Excel file that contains malicious XXE objects that, when resolved, will cause the application to read arbitrary files from the local file system, or from internal network resources.",
    "publishedDate": "2019-10-29T09:50:45.174Z",
    "updatedDate": "2020-01-09T10:52:33.581Z",
    "disclosureDate": "2019-10-20T00:00:00.000Z",
    "solution": "Fixed in version [**4.1.1**](https://archive.apache.org/dist/poi/release/src/) by [this](https://svn.apache.org/viewvc?view=revision&revision=1867484) commit.\n\nThe latest stable releases can be found [here](https://poi.apache.org/download.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Artem Smotrakov from SAP",
    "workaround": "",
    "vendorFixDate": "2019-09-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3341",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-611"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12415",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3341/ranges"
            },
            {
                "rel": "reference",
                "href": "https://archive.apache.org/dist/poi/release/src/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/poi/commit/35906116edf297fbe512765cc4728acfca3b20eb#diff-e929435a005eff1c94928103dd965b53",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/13a54b6a03369cfb418a699180ffb83bd727320b6ddfec198b9b728e@%3Cannounce.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://poi.apache.org/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://svn.apache.org/viewvc?view=revision&revision=1867484",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3341/default-remediation-status"
            }
        ]
    }
}