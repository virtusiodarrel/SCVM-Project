{
    "source": "BDSA",
    "name": "BDSA-2021-3646",
    "title": "runc Vulnerable to Netlink-Based Container Configuration Override via Byte Array Attribute Integer Overflow",
    "description": "runc contains an integer overflow vulnerability in its netlink message serialization system that allows an attacker to inject control characters and override netlink-based container configuration.\n\n**Note:** according to the vendor the exploitation of this vulnerability is not possible in any released versions of runc and moreover requires already having some control over the configuration of the container. However, \"out of an abundance of caution\" the vendor treats all versions that do not contain the fix as vulnerable.",
    "technicalDescription": "The exploitation of this vulnerability requires creating a netlink byte array attribute with a length that would overflow a `uint16` integer, but this was found to be impossible to achieve in released versions due to reasons explained [here](https://github.com/opencontainers/runc/security/advisories/GHSA-v95c-p5hm-xq8f).\n\nThe vulnerability was introduced by [this](https://github.com/opencontainers/runc/commit/9c444070ec7bb83995dbc0185da68284da71c554) commit, and fixed by [this](https://github.com/opencontainers/runc/commit/d72d057ba794164c3cce9451a00b72a78b25e1ae) commit, in between releases **1.0.2** and **1.0.3**. Only snapshots of the [master branch](https://github.com/opencontainers/runc) between **2021-10-12** and **2021-12-03** are confirmed to be vulnerable.",
    "publishedDate": "2021-12-07T11:34:04.231Z",
    "updatedDate": "2022-03-22T13:56:16.607Z",
    "disclosureDate": "2021-12-06T00:00:00.000Z",
    "exploitPublishDate": "2021-12-06T00:00:00.000Z",
    "solution": "Fixed in version [**1.0.3**](https://github.com/opencontainers/runc/releases/tag/v1.0.3) by [this](https://github.com/opencontainers/runc/commit/d72d057ba794164c3cce9451a00b72a78b25e1ae) commit.\n\nThe latest stable releases can be found [here](https://github.com/opencontainers/runc/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Felix Wilhelm, Google Project Zero",
    "workaround": "",
    "vendorFixDate": "2021-12-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3646",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43784",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3646/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencontainers/runc",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencontainers/runc/commit/9c444070ec7bb83995dbc0185da68284da71c554",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencontainers/runc/commit/d72d057ba794164c3cce9451a00b72a78b25e1ae",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencontainers/runc/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencontainers/runc/releases/tag/v1.0.3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencontainers/runc/releases/tag/v1.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencontainers/runc/security/advisories/GHSA-v95c-p5hm-xq8f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/165165/GS20211206162620.tgz",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3646/default-remediation-status"
            }
        ]
    }
}