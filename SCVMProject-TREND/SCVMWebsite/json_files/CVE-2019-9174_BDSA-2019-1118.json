{
    "source": "BDSA",
    "name": "BDSA-2019-1118",
    "title": "GitLab CE/EE Vulnerable to Blind Server-side Request Forgery (SSRF) via Prometheus Integration Feature",
    "description": "GitLab CE and EE are vulnerable to server-side request forgery due to a time-of-check time-of-use (TOCTOU) race condition in the Prometheus integration feature. Potential attackers could leverage this flaw to target internal systems which should not be accessible from the external network.",
    "technicalDescription": "The validity of  `prometheus_service` is not checked right before sending a query,  giving an attacker a window of opportunity to modify it before the query goes out. The attacker can leverage this flaw by changing the DNS entry for `api_url` after the model was saved and checked for validity.\n\nThis vulnerability can be abused to trick a vulnerable server into sending arbitrary requests and use it as a pivot. That would allow the attacker to bypass the firewall and reach into the internal network which is not normally accessible from the public internet. This can be further leveraged to run reconnaissance on the internal systems or to perform other attacks that abuse the trust relationship with the server.",
    "publishedDate": "2019-04-19T13:52:48.224Z",
    "updatedDate": "2019-04-19T13:52:48.189Z",
    "disclosureDate": "2019-04-05T00:00:00.000Z",
    "exploitPublishDate": "2019-04-05T00:00:00.000Z",
    "solution": "Fixed in GitLab CE:\n* [**11.6.10**](https://gitlab.com/gitlab-org/gitlab-ce/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/70e832a217c67937c6fcdb0ad540b480afb54f78) commit,\n* [**11.7.6**](https://gitlab.com/gitlab-org/gitlab-ce/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/5f136e46f15e61a1df42a9e84cc9530190e6dee5) commit, and\n* [**11.8.1**](https://gitlab.com/gitlab-org/gitlab-ce/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/515bb4e6dd601ffc938cb519e7dfa7105c2c023d) commit.\n\nFixed in GitLab EE:\n* [**11.6.10**](https://gitlab.com/gitlab-org/gitlab-ee/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ee/commit/70e832a217c67937c6fcdb0ad540b480afb54f78) commit,\n* [**11.7.6**](https://gitlab.com/gitlab-org/gitlab-ee/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ee/commit/5f136e46f15e61a1df42a9e84cc9530190e6dee5) commit, and\n* [**11.8.1**](https://gitlab.com/gitlab-org/gitlab-ee/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ee/commit/515bb4e6dd601ffc938cb519e7dfa7105c2c023d) commit.",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.0
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ngalog",
    "workaround": "",
    "vendorFixDate": "2019-02-27T00:00:00.000Z",
    "vendorNotifiedDate": "2018-12-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 9.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1118",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9174",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1118/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/2019/03/04/security-release-gitlab-11-dot-8-dot-1-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/issues/55468",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ee/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1118/default-remediation-status"
            }
        ]
    }
}