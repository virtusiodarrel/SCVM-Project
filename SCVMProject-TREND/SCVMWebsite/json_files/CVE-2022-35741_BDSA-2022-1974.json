{
    "source": "BDSA",
    "name": "BDSA-2022-1974",
    "title": "Apache CloudStack Vulnerable to XML External Entities (XXE) via Unsafe Parsing of SAML 2.0 Messages",
    "description": "Apache CloudStack contains a XML external entities (XXE) vulnerability in its SAML 2.0 plugin because it parses SAML 2.0 messages in an unsafe manner. An attacker could exploit this flaw by supplying crafted XML-based messages and potentially cause arbitrary file reading, denial-of-service (DoS) or server-side request forgery (SSRF).",
    "technicalDescription": "This vulnerability affects the SAML 2.0 plugin of the application and hence requires this plugin to be enabled. It exists because the application uses standard XML libraries to parse SAML 2.0 messages that are constructed during the authentication flow. These libraries are vulnerable to XXE injection. An attacker could leverage this flaw by supplying crafted XML messages and potentially cause arbitrary file reading, denial-of-service (DoS) or server-side request forgery (SSRF).\n\nThis flaw has been mitigated by implementing safer `DocumentBuilderFactory` and `ParserPool` utilities in order to safely parse XML data.",
    "publishedDate": "2022-07-19T10:44:02.099Z",
    "updatedDate": "2022-08-18T15:12:14.679Z",
    "disclosureDate": "2022-07-18T00:00:00.000Z",
    "solution": "Fixed in:\n* **[4.16.1.1](https://github.com/apache/cloudstack/releases/tag/4.16.1.1)** by [this](https://github.com/apache/cloudstack/commit/b7415bf127ee3317554af752c0f83e2b580dd7bd) commit,\n* **[4.17.0.1](https://github.com/apache/cloudstack/releases/tag/4.17.0.1)** by [this](https://github.com/apache/cloudstack/commit/f27de6364402569fd3c2d1286ed5c749b9bd6e12) commit.\n\nThe latest stable releases can be found [here](https://github.com/apache/cloudstack/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.4,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "v3ged0ge",
    "workaround": "Users are recommended to disable SAML 2.0 plugin by setting `saml2.enabled` to false and restarting the management servers.",
    "vendorFixDate": "2022-07-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1974",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-611"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-35741",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1974/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/cloudstack/commit/b7415bf127ee3317554af752c0f83e2b580dd7bd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/cloudstack/commit/f27de6364402569fd3c2d1286ed5c749b9bd6e12",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/cloudstack/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/cloudstack/releases/tag/4.16.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/cloudstack/releases/tag/4.17.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/hwhxvtwp1d5dsm156bsf1cnyvtmrfv3f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/hwhxvtwp1d5dsm156bsf1cnyvtmrfv3f",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1974/default-remediation-status"
            }
        ]
    }
}