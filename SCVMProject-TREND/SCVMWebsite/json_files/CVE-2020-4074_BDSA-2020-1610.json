{
    "source": "BDSA",
    "name": "BDSA-2020-1610",
    "title": "PrestaShop Vulnerable to Authorization Bypass via Improper Access Controls to Execute Admin Commands",
    "description": "PrestaShop contains an improper access control vulnerability. An attacker could exploit this flaw to forge requests and execute admin commands they are not authenticated to carry out.",
    "technicalDescription": "The vulnerability occurs due to improper access control on multiple functions in the following files:\n* `classes/Context.php`\n* `classes/Cookie.php`\n* `classes/Customer.php`\n* `classes/Employee.php`\n* `classes/form/CustomerPersister.php`\n* `controllers/admin/AdminLoginController.php`\n* `install-dev/data/db_structure.sql`\n\nThe vulnerable functions fail to check for adequate permissions before executing. This could allow an attacker to forge requests and execute admin commands they are not authenticated to carry out. \n\nThe vendor has mitigated against this by implementing additional authentication checks.",
    "publishedDate": "2020-07-07T08:11:21.070Z",
    "updatedDate": "2020-07-07T08:11:21.062Z",
    "disclosureDate": "2020-07-02T00:00:00.000Z",
    "solution": "Fixed in [**1.7.6.6**](https://github.com/PrestaShop/PrestaShop/releases/tag/1.7.6.6) by [this](https://github.com/PrestaShop/PrestaShop/commit/30b6a7bdaca9cb940d3ce462906dbb062499fc30) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.4,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Komradz",
    "workaround": "The vendor provided the following workaround:\n> Enable `PS_COOKIE_CHECKIP` configuration but it's maybe not enough.",
    "vendorFixDate": "2020-06-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1610",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-4074",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1610/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrestaShop/PrestaShop/commit/30b6a7bdaca9cb940d3ce462906dbb062499fc30",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrestaShop/PrestaShop/releases/tag/1.7.6.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-ccvh-jh5x-mpg4",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1610/default-remediation-status"
            }
        ]
    }
}