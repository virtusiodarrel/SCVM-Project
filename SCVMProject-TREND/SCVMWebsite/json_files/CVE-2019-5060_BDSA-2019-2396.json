{
    "source": "BDSA",
    "name": "BDSA-2019-2396",
    "title": "SDL2_image Vulnerable to Denial-of-Service (DoS) via Integer Overflow in 'create_colorhash()' Function",
    "description": "SDL2_image is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause a victim's instance of the application to crash by tricking them into running the application using a crafted file as input.",
    "technicalDescription": "The function `create_colorhash()`, which is defined within the script `IMG_xpm.c`, is used by SDL2_image during the parsing of XPM images. This functions accepts the number of colors contained in the XPM image as input, the value of which is obtained from the header of the XPM file. This value is denoted by the variable `maxnum`, and is used to calculate how much memory to allocate for the `entries` and `table`components of the `hash` structure. The value of `maxnum` is not validated, and so  if it is very large an integer overflow can occur during the calculation. The memory buffer associated with the`table` component is filled using the `add_colorhash()` function, which accesses the buffer using an index. The buffer that was allocated will be too small due to the overflow, and so the application will attempt to write to a memory location outside of the boundaries of the buffer whenever `add_colorhash()` is being evaluated. This could cause an exception to be raised, halting program execution. An attacker could therefore cause a DoS by tricking a victim into running a program with a crafted XPM file as input.",
    "publishedDate": "2019-08-23T13:31:57.573Z",
    "updatedDate": "2019-08-23T13:31:57.561Z",
    "disclosureDate": "2019-07-29T00:00:00.000Z",
    "exploitPublishDate": "2019-07-29T00:00:00.000Z",
    "solution": "Fixed in version [**2.0.5**](https://www.libsdl.org/projects/SDL_image/release/) by [this](http://hg.libsdl.org/SDL_image/rev/26061e601c81) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Cory Duplantis of Cisco Talos",
    "workaround": "",
    "vendorFixDate": "2019-07-01T00:00:00.000Z",
    "vendorNotifiedDate": "2019-05-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2396",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-680"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5060",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2396/ranges"
            },
            {
                "rel": "reference",
                "href": "http://hg.libsdl.org/SDL_image/rev/26061e601c81",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2019-0844",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2019-0844",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.libsdl.org/projects/SDL_image/release/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2396/default-remediation-status"
            }
        ]
    }
}