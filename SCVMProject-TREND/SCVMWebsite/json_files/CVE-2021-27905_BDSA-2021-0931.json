{
    "source": "BDSA",
    "name": "BDSA-2021-0931",
    "title": "Apache Solr Vulnerable to Server Side Request Forgery (SSRF) via 'masterUrl' in ReplicationHandler",
    "description": "Apache Solr is vulnerable to server side request forgery (SSRF) attacks due to missing parameter checks when directing Solr instances to replicate index data into the local core. An attacker from external network could use this vulnerability to send requests to Solr's internal infrastructure.",
    "technicalDescription": "The vulnerability can be exploited via the `masterUrl` (`leaderUrl`) parameter when directing a `ReplicationHandler` (`/replication`) instance to replicate index data into the local core. Solr does not check these parameters against a similar configuration it uses for the `shards` parameter.",
    "publishedDate": "2021-04-14T08:28:45.957Z",
    "updatedDate": "2022-04-12T10:11:53.041Z",
    "disclosureDate": "2021-04-12T00:00:00.000Z",
    "solution": "Fixed in the **main** branch by [this](https://github.com/apache/solr/commit/c7abf3f32ca439b73fbe0ed5a3a6d70ecc411cbb) commit which is not yet included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Caolinhong(Skay) from QI-ANXIN Cert (QI-ANXIN Technology Group Inc.)",
    "workaround": "The vendor has provided the following workaround:\n```\nEnsure that any access to the replication handler is purely internal to Solr.  Typically, it's only accessed externally for diagnostic/informational purposes.\n```",
    "vendorFixDate": "2021-04-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0931",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-27905",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0931/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/solr/commit/c7abf3f32ca439b73fbe0ed5a3a6d70ecc411cbb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/solr/pull/47",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/SOLR-15217",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mail-archive.com/announce@apache.org/msg06482.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mail-archive.com/announce@apache.org/msg06482.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0931/default-remediation-status"
            }
        ]
    }
}