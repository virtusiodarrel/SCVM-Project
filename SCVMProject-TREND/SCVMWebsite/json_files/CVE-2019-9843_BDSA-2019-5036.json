{
    "source": "BDSA",
    "name": "BDSA-2019-5036",
    "title": "Diffplug Spotless Vulnerable to Information Disclosure from XML External Entities (XXE) Attack via XML Parsing Functionality",
    "description": "Spotless is vulnerable to an information disclosure issue due to how the XML parser in use (Eclipse WTP XML) automatically resolves external entities and is susceptible to XML external entities (XXE) attacks.\n\nAn attacker could use this issue to perform man-in-the-middle (MitM) style attacks and disclose potentially sensitive file contents.",
    "technicalDescription": "Spotless is vulnerable to information disclosure because the Eclipse WTP XML formatter does not respect the `resolveExternalEntities` setting and automatically resolves external entities / URIs, potentially over HTTP.\n\nAn attacker could supply an untrusted XML file on which a victim performs a `spotlessApply` operation. This operation could reference external entities over HTTP and allow the attacker to gather potentially sensitive information like passwords using man-in-the-middle (MitM) style techniques.\n\nTo remedy this issue, the vendor has altered the default XML formatter behavior to ignore external URIs.",
    "publishedDate": "2021-02-12T14:22:16.977Z",
    "updatedDate": "2021-02-22T09:18:08.344Z",
    "disclosureDate": "2019-02-13T00:00:00.000Z",
    "exploitPublishDate": "2019-02-13T00:00:00.000Z",
    "solution": "Fixed in lib [**1.20.0**](https://github.com/diffplug/spotless/releases/tag/lib%2F1.20.0), plugin-maven [**1.20.0**](https://github.com/diffplug/spotless/releases/tag/maven%2F1.20.0), and plugin-gradle [**3.20.0**](https://github.com/diffplug/spotless/releases/tag/gradle%2F3.20.0) by [this](https://github.com/diffplug/spotless/commit/e3f97f5e1a2a07a2593c576856a04c13dc77e73c) commit.\n\n\nThe latest stable releases are available [here](https://github.com/diffplug/spotless/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-03-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5036",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-611"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9843",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5036/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/diffplug/spotless/blob/main/plugin-maven/CHANGES.md#1200---2019-03-14",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/diffplug/spotless/commit/e3f97f5e1a2a07a2593c576856a04c13dc77e73c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/diffplug/spotless/commit/f70e1c7d8ad46ffd7ab12aa633cd6b99b0d0cd6e",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/diffplug/spotless/issues/358",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/diffplug/spotless/issues/358#issuecomment-463394794",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/diffplug/spotless/pull/369",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/diffplug/spotless/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/diffplug/spotless/releases/tag/gradle%2F3.15.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/diffplug/spotless/releases/tag/lib%2F1.15.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/diffplug/spotless/releases/tag/maven%2F1.15.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5036/default-remediation-status"
            }
        ]
    }
}