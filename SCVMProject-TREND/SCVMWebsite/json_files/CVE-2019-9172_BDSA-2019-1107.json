{
    "source": "BDSA",
    "name": "BDSA-2019-1107",
    "title": "GitLab CE/EE Vulnerable to Merge Request Information Disclosure via MR Commit API Endpoint",
    "description": "GitLab CE and EE are vulnerable to information disclosure due to a missing permission check in the commits API. An unauthorized user can obtain potentially sensitive information about merge requests, after access has been limited to project members, by using an alternative API endpoint.",
    "technicalDescription": "This flaw exists due to a missing permission check in the commits API which lets users list merge requests associated with a commit. If normal access to MRs has been blocked for the public by changing project permissions in the settings the `https://{gitlab}/api/v4/projects/{id}/merge_requests` endpoint will be restricted. Unauthorized users can bypass this restriction by using the `/projects/:id/repository/commits/:sha/merge_requests` endpoint instead.",
    "publishedDate": "2019-04-18T11:32:36.050Z",
    "updatedDate": "2019-04-18T11:32:36.022Z",
    "disclosureDate": "2019-04-05T00:00:00.000Z",
    "exploitPublishDate": "2019-04-05T00:00:00.000Z",
    "solution": "Fixed in GitLab CE:\n* [**11.6.10**](https://gitlab.com/gitlab-org/gitlab-ce/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/0155d2f14857dd9f323038c46166bcdfe86b9150) commit,\n* [**11.7.6**](https://gitlab.com/gitlab-org/gitlab-ce/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/e191ef81ccf3f9693e7fd365b1d009a37a7bc809) commit and\n* [**11.8.1**](https://gitlab.com/gitlab-org/gitlab-ce/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/912bd48c319d2bfa96a3522f096d8637cf850705) commit.\n\nFixed in GitLab EE:\n* [**11.6.10**](https://gitlab.com/gitlab-org/gitlab-ee/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ee/commit/0155d2f14857dd9f323038c46166bcdfe86b9150) commit,\n* [**11.7.6**](https://gitlab.com/gitlab-org/gitlab-ee/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ee/commit/e191ef81ccf3f9693e7fd365b1d009a37a7bc809) commit and\n* [**11.8.1**](https://gitlab.com/gitlab-org/gitlab-ee/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ee/commit/912bd48c319d2bfa96a3522f096d8637cf850705) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ngalog",
    "workaround": "",
    "vendorFixDate": "2019-01-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1107",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-862"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9172",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1107/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/2019/03/04/security-release-gitlab-11-dot-8-dot-1-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/commit/0155d2f14857dd9f323038c46166bcdfe86b9150",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/commit/912bd48c319d2bfa96a3522f096d8637cf850705",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/commit/e191ef81ccf3f9693e7fd365b1d009a37a7bc809",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/issues/54795",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ee/commit/0155d2f14857dd9f323038c46166bcdfe86b9150",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ee/commit/912bd48c319d2bfa96a3522f096d8637cf850705",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ee/commit/e191ef81ccf3f9693e7fd365b1d009a37a7bc809",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ee/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1107/default-remediation-status"
            }
        ]
    }
}