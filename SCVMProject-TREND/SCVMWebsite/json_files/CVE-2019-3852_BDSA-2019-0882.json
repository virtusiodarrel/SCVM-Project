{
    "source": "BDSA",
    "name": "BDSA-2019-0882",
    "title": "Moodle Vulnerable to Security Bypass via Improper Authorization in 'accesslib.php' File",
    "description": "Moodle is vulnerable to security bypass due to incorrect checking of user capabilities which does not consider context freezing. Users could be granted arbitrary write privileges, compromising the integrity of the underlying database.",
    "technicalDescription": "This flaw lies in two functions of `accesslib.php`: `get_users_by_capability()` and `get_with_capability_join()`. Code responsible for the construction of SQL queries does not check whether context locking is enabled and will not exclude locked capabilities from the check. This could lead to arbitrary modifications of the underlying database.",
    "publishedDate": "2019-04-01T15:51:37.315Z",
    "updatedDate": "2019-04-01T15:51:37.299Z",
    "disclosureDate": "2019-03-19T00:00:00.000Z",
    "solution": "Fixed in [**3.6.3**](https://download.moodle.org/) by [this](http://git.moodle.org/gw?p=moodle.git;a=commit;h=90c2e5e707c27cd1ef0b992cc5e55e76dcd17204) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrew Nicols",
    "workaround": "",
    "vendorFixDate": "2019-03-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0882",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3852",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0882/ranges"
            },
            {
                "rel": "reference",
                "href": "http://git.moodle.org/gw?p=moodle.git;a=commit;h=90c2e5e707c27cd1ef0b992cc5e55e76dcd17204",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://download.moodle.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=384015#p1547748",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0882/default-remediation-status"
            }
        ]
    }
}