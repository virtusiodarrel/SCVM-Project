{
    "source": "BDSA",
    "name": "BDSA-2020-0199",
    "title": "dotCMS Vulnerable to Remote Code Execution (RCE) via Incorrect Access Control on URIs",
    "description": "dotCMS contains an incorrect access control vulnerability. An authenticated attacker could exploit this flaw to upload malicious files to execute remote code with permissions of the user running dotCMS against the system.",
    "technicalDescription": "The vulnerability occurs due to incorrect access control. dotCMS does not sufficiently normalize URIs when performing checks that a user has permission to access a specific directory. If a dotCMS installation stores assets in Tomcat's `webapps/ROOT/assets` these files can be accessed by traversing the directory structure.\n\nWhen files are uploaded dotCMS creates a temporary file in `./assets` directory. An attacker could upload a malicious executable file to this directory and execute it with the permissions of the user running the dotCMS application.\n\nThis issue was addressed by implementing a filter to intercept and normalize URIs.",
    "publishedDate": "2020-02-10T10:48:46.577Z",
    "updatedDate": "2022-07-19T09:13:48.710Z",
    "disclosureDate": "2020-01-09T00:00:00.000Z",
    "exploitPublishDate": "2020-01-08T00:00:00.000Z",
    "solution": "Fixed in version [**5.2.4**](https://github.com/dotCMS/core/tree/5.2.4) by [this](https://github.com/dotCMS/core/commit/dba048d1417a5a9017adf48de7cfa0b5e55f1616) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-02-10T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0199",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-6754",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0199/ranges"
            },
            {
                "rel": "reference",
                "href": "https://dotcms.com/security/SI-54",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/commit/dba048d1417a5a9017adf48de7cfa0b5e55f1616",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/issues/17796",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/tree/5.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0199/default-remediation-status"
            }
        ]
    }
}