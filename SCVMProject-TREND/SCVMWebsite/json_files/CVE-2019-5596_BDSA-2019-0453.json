{
    "source": "BDSA",
    "name": "BDSA-2019-0453",
    "title": "FreeBSD Vulnerable to Privilege Escalation via Integer Overflow in 'm_dispose_extcontrolm' Function",
    "description": "An integer overflow vulnerability has been discovered in FreeBSD. An attacker could exploit this vulnerability to gain elevated privileges which could be utilized to execute other malicious actions.",
    "technicalDescription": "A weakness has been discovered in FreeBSD. A process which handles incoming control message containing rights, does not allocate a valid buffer size per message. In order to prevent the corresponding descriptors from being leaked into processes descriptor table the kernel handles the truncation case by killing descriptors referenced to the incoming message. An issue can occur in which the process does not release a reference obtained on the file corresponding to a received right. This can cause an integer overflow and force the reference counter to wrap around and free the file structure. \n\nThis functionality is located in the `m_dispose_extcontrolm` function located in the file `sys/kern/uipc_syscalls.c`.",
    "publishedDate": "2019-02-19T14:29:05.501Z",
    "updatedDate": "2020-01-02T12:19:44.762Z",
    "disclosureDate": "2019-02-05T00:00:00.000Z",
    "exploitPublishDate": "2019-12-30T00:00:00.000Z",
    "solution": "Fixed in branch [**12.0**](https://www.freebsd.org/) by [this](https://svnweb.freebsd.org/base?view=revision&revision=r343785) commit.\nFixed in branch [**11.2**](https://www.freebsd.org/) by [this](https://svnweb.freebsd.org/base?view=revision&revision=343786) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.9,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.4,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "(AV:L/AC:M/Au:N/C:C/I:C/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Peter Holm",
    "workaround": "",
    "vendorFixDate": "2019-02-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0453",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5596",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0453/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/freebsd/freebsd/commit/255362d099e7d3d7e8c1f143974bc1e764163d61",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/freebsd/freebsd/commit/255362d099e7d3d7e8c1f143974bc1e764163d61",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=343786",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=r343785",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/47829",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-19:02.fd.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0453/default-remediation-status"
            }
        ]
    }
}