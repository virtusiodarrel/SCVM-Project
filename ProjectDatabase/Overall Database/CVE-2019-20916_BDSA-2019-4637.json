{
    "source": "BDSA",
    "name": "BDSA-2019-4637",
    "title": "pip Vulnerable to Path Traversal and Remote Code Execution (RCE) via '_download_http_url()' Function",
    "description": "pip is vulnerable to directory traversal due to the unsafe handling of a HTTP request field. A remote attacker could overwrite sensitive files on a victim's machine if they can trick that victim into installing a package from a malicious server. This could allow the attacker to access the victim's machine, or potentially execute arbitrary code.",
    "technicalDescription": "The function `_download_http_url()`, which is defined within the file `pip/_internal/download.py`, is called whenever the `pip install` command is executed with a URI as a parameter. The `Content-Disposition` header within the server's response will be parsed for the `filename` field, the value of which will be used as the name of the file that is to be created. If this value contains  `../` character sequences, directory traversal will occur. An attacker could exploit this to overwrite arbitrary files on a victim's system, provided they can trick the victim into connecting to a malicious server. As pip typically runs with root privileges, the attacker could overwrite system configuration information in order to gain access to the vulnerable machine. On some platforms, such as Windows, remote code execution may also be possible.",
    "publishedDate": "2020-09-07T14:54:09.939Z",
    "updatedDate": "2020-09-07T14:54:09.934Z",
    "disclosureDate": "2019-04-16T00:00:00.000Z",
    "exploitPublishDate": "2019-04-16T00:00:00.000Z",
    "solution": "Fixed in [**19.2**](https://github.com/pypa/pip/releases/tag/19.2) by [this](https://github.com/pypa/pip/commit/5776ddd05896162e283737d7fcdf8f5a63a97bbc) commit.\n\nThe latest stable releases can be found [here](https://github.com/pypa/pip/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-06-11T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-4637",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-20916",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-4637/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pypa/pip/commit/5776ddd05896162e283737d7fcdf8f5a63a97bbc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pypa/pip/issues/6413",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pypa/pip/issues/6413",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pypa/pip/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pypa/pip/releases/tag/19.2",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}