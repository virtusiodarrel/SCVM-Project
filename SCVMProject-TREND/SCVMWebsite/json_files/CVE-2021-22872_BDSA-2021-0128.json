{
    "source": "BDSA",
    "name": "BDSA-2021-0128",
    "title": "Revive Adserver Vulnerable to Reflected Cross-Site Scripting (XSS) via 'QUERY_STRING' Parameter",
    "description": "Revive Adserver is vulnerable to reflected cross-site scripting (XSS) attacks. An attacker could exploit this vulnerability by tricking a victim into clicking on a malicious link containing a JavaScript payload. This could allow them to steal sensitive information such as session identifiers.\n\n**Note**: this issue exists due to an incomplete fix for **CVE-2020-8115** (**BDSA-2020-2810**).",
    "technicalDescription": "This vulnerability is present due to a lack of input sanitization for the `QUERY_STRING` parameter, as used in the `www/delivery/afr.php` file.\n\nIt was discovered that the initial fix for this vulnerability could be bypassed in IE11 and other legacy browsers by closing the script tag, thus an additional fix was required.",
    "publishedDate": "2021-01-20T15:11:33.807Z",
    "updatedDate": "2021-10-01T14:04:31.509Z",
    "disclosureDate": "2021-01-19T00:00:00.000Z",
    "exploitPublishDate": "2021-01-19T00:00:00.000Z",
    "solution": "Fixed in [**5.1.0**](https://github.com/revive-adserver/revive-adserver/releases/tag/v5.1.0) by these commits:\n* [Commit 1](https://github.com/revive-adserver/revive-adserver/commit/327aaf10)\n* [Commit 2](https://github.com/revive-adserver/revive-adserver/commit/9ec2fa26)\n* [Commit 3](https://github.com/revive-adserver/revive-adserver/commit/00fdb8d0e946a32dec5a06e261ca9444139790da)\n\nThe latest stable releases are available [here](https://github.com/revive-adserver/revive-adserver/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Axel Flamcourt",
    "workaround": "",
    "vendorFixDate": "2021-01-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0128",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22872",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0128/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/revive-adserver/revive-adserver/commit/00fdb8d0e946a32dec5a06e261ca9444139790da",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/revive-adserver/revive-adserver/commit/327aaf10",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/revive-adserver/revive-adserver/commit/9ec2fa26",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/revive-adserver/revive-adserver/releases/tag/v5.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/775693",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/775693",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/986365",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.revive-adserver.com/security/revive-sa-2020-001/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.revive-adserver.com/security/revive-sa-2021-001/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0128/default-remediation-status"
            }
        ]
    }
}