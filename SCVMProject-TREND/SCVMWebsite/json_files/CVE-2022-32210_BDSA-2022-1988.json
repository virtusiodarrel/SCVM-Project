{
    "source": "BDSA",
    "name": "BDSA-2022-1988",
    "title": "Undici Vulnerable to Adversary-in-the-Middle (AitM) Attack due to Improper Certificate Validation via 'ProxyAgent'",
    "description": "Undici, an NPM package, contains an improper certificate validation vulnerability. An attacker could exploit this issue to carry out an adversary-in-the-middle attack on another user within the network path between the client and target server. This may allow for the disclosure or modification of sensitive data.",
    "technicalDescription": "This issue exists due to the 'ProxyAgent' not validating the remote server's certificate, which in turn exposes all request and response data to the proxy. HTTP and HTTPS traffic is affected, and is present in cases where the `fetch` command is used with the 'ProxyAgent'.\n\nMitigation for this issue came in the form of adding HTTP 'CONNECT' tunneling for proxies.",
    "publishedDate": "2022-07-19T16:03:22.021Z",
    "updatedDate": "2022-07-19T16:03:22.005Z",
    "disclosureDate": "2022-06-13T00:00:00.000Z",
    "exploitPublishDate": "2022-05-27T00:00:00.000Z",
    "solution": "Fixed in version [**5.5.1**](https://github.com/nodejs/undici/releases/tag/v5.5.1) by [this](https://github.com/nodejs/undici/commit/df4f7e0e95f5112322a96fd7a666cb28c1d48327) commit.\n\nThe latest stable releases can be found [here](https://github.com/nodejs/undici/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.8
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 1.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tim Perry",
    "workaround": "As described by the vendor [here](https://github.com/nodejs/undici/security/advisories/GHSA-pgw7-wx7w-2w33), users should:\n\n> not use ProxyAgent as a dispatcher for TLS Connections.",
    "vendorFixDate": "2022-06-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1988",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-295"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-32210",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1988/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/commit/df4f7e0e95f5112322a96fd7a666cb28c1d48327",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/releases/tag/v5.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/security/advisories/GHSA-pgw7-wx7w-2w33",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/security/advisories/GHSA-pgw7-wx7w-2w33",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1583680",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1988/default-remediation-status"
            }
        ]
    }
}