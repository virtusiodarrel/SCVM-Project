{
    "source": "BDSA",
    "name": "BDSA-2020-0620",
    "title": "Sonatype Nexus Repository Manager Vulnerable to Remote Code Execution (RCE) via Malicious NXRM Request",
    "description": "Sonatype Nexus Repository Manager contains a remote code execution (RCE) vulnerability due to improper configuration. A remote, authenticated attacker could exploit this vulnerability by sending a malicious NXRM request to execute arbitrary code which could allow them to execute code outside the scope of the NXRM server.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "The `stripJavaEl` function in `components/nexus-common/src/main/java/org/sonatype/nexus/common/template/EscapeHelper.java`, introduced to mitigate CVE-2018-16621, was not applied to `org.sonatype.nexus.validation.ConstraintViolationFactory`. This results in unvalidated user-controlled data to be passed to `createViolation` function that will be evaluated as a Java EL expression by `buildConstraintViolationWithTemplate` function. \n\nAn attacker could exploit this vulnerability to introduce malicious Java EL and execute arbitrary code. \n\nThere are multiple scenarios where this is an issue, some require only basic authentication whereas others require elevated privileges. See [this](https://securitylab.github.com/advisories/GHSL-2020-011-nxrm-sonatype) advisory for low privileged account scenarios and [this](https://securitylab.github.com/advisories/GHSL-2020-012-nxrm-sonatype) advisory for high privileged account scenarios.",
    "publishedDate": "2020-04-02T15:50:09.158Z",
    "updatedDate": "2022-05-06T11:32:25.596Z",
    "disclosureDate": "2020-03-31T00:00:00.000Z",
    "exploitPublishDate": "2020-04-16T00:00:00.000Z",
    "solution": "Fixed in version [**3.21.2**](https://help.sonatype.com/repomanager3/download/download-archives---repository-manager-3) by [this](https://github.com/sonatype/nexus-public/commit/8852251a28187605730cd6b52606a5e4e38d524c#diff-694ac5f201a01fcb7d608df1033639c3) commit.\n\nThe latest stable releases can be found [here](https://help.sonatype.com/repomanager3/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "pwnster (Alvaro Mu\u00f1oz)",
    "workaround": "",
    "vendorFixDate": "2020-03-31T00:00:00.000Z",
    "vendorNotifiedDate": "2020-02-03T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0620",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10199",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0620/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sonatype/nexus-public/commit/8852251a28187605730cd6b52606a5e4e38d524c#diff-694ac5f201a01fcb7d608df1033639c3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://help.sonatype.com/repomanager3/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://help.sonatype.com/repomanager3/download/download-archives---repository-manager-3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/157261/nexus_repo_manager_el_injection.rb.txt",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://securitylab.github.com/advisories/GHSL-2020-011-nxrm-sonatype",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://securitylab.github.com/advisories/GHSL-2020-012-nxrm-sonatype",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://support.sonatype.com/hc/en-us/articles/360044882533",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0620/default-remediation-status"
            }
        ]
    }
}