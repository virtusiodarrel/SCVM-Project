{
    "source": "BDSA",
    "name": "BDSA-2022-1359",
    "title": "Strapi Vulnerable to Account Takeover via Information Leak in API User JSON Responses",
    "description": "Strapi is vulnerable to information leak flaws in several JSON responses. A remote authenticated attacker with access to the admin panel can leverage this to takeover other accounts that have a direct or indirect relationship through site functionality with the attacker user. Specifically, for API users where content types accessible to the authenticated user contains relationships to API users (from:users-permissions). The JSON response contains sensitive data that allows the attacker to hijack the password reset workflow and takeover the higher privileged users account. This has confidentiality, integrity and availability impacts.",
    "technicalDescription": "The problem exists in the **3.x** branch in the `shouldRemoveAttribute()`function of the `packages/strapi-utils/lib/sanitize-entity.js` file. It was not fully programmed to remove all sensitive information.\n\nIn the **4.x** branch the same underlying issue existed in the `packages/core/admin/server/services/permission/permissions-manager/sanitize.js` file in the `createSanitizeOutput()` function.\n\nThe issue was resolved in the **3.x** branch by adding special attributes to sensitive structures so they could be removed by `shouldRemoveAttribute()` in the sanitization code. The issue was resolved in **4.1.10** by properly sanitizing hidden attributes from admin API responses.",
    "publishedDate": "2022-05-19T12:52:52.604Z",
    "updatedDate": "2022-05-19T13:18:48.596Z",
    "disclosureDate": "2022-05-19T00:00:00.000Z",
    "exploitPublishDate": "2022-05-19T00:00:00.000Z",
    "solution": "Fixed in version [**3.6.10**](https://github.com/strapi/strapi/releases/tag/v3.6.10) by [these](https://github.com/strapi/strapi/pull/13189/commits) commits.\n\nFixed in version [**4.1.10**](https://github.com/strapi/strapi/releases/tag/v4.1.10) by [these](https://github.com/strapi/strapi/pull/13185/commits) commits.\n\nThe latest releases can be found [here](https://github.com/strapi/strapi/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Synopsys",
    "workaround": "",
    "vendorFixDate": "2022-05-11T00:00:00.000Z",
    "vendorNotifiedDate": "2021-11-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1359",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-201"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-30618",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1359/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/strapi/strapi/pull/13185/commits",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/strapi/strapi/pull/13189/commits",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/strapi/strapi/releases/tag/v3.6.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/strapi/strapi/releases/tag/v4.1.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/strapi/strapi/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synopsys.com/blogs/software-security/cyrc-advisory-strapi",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.synopsys.com/blogs/software-security/cyrc-advisory-strapi",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1359/default-remediation-status"
            }
        ]
    }
}