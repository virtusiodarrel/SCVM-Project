{
    "source": "BDSA",
    "name": "BDSA-2021-0207",
    "title": "Gentoo Portage Vulnerable to Authorization Bypass via Improper Preservation of Permissions in '/usr/lib64/nagios/plugins'Directory",
    "description": "Gentoo Portage contains an authorization bypass vulnerability due to the improper preservation of permissions in some circumstances. An attacker could exploit this flaw to write files into a directory for which they should not have access.",
    "technicalDescription": "The issue occurs due to Gentoo Portage package manager using an insecure temporary location to build packages. An attacker with system user access could exploit this flaw to write to the plugin directory, as in certain situations the source tree temporarily becomes writable to unprivileged users, despite the build taking place as root.\n\nThe nagioscore package is available in Gentoo as `net-analyzer/nagios-core`, by default the build system gives ownership of `/usr/lib64/nagios/plugins` to the `nagios` user before being amended to `root:root`.\n\n  ```\nemake DESTDIR=\"${D}\" install-basic\n  fowners root:root /usr/lib64/nagios/plugins\n```\n\nHere the `$D` variable is a reference to the mock-installation path under `PORTAGE_TMPDIR`, where the `fowners` function is utilized.\n\nThe issue occurs during the transitional period between a call being made to `emake` and a call to the `fowners()` function, for the `usr/lib64/nagios/plugins` directory, the mock installation image is writable by the `nagios` user.",
    "publishedDate": "2021-01-27T10:20:46.280Z",
    "updatedDate": "2021-01-27T10:20:46.273Z",
    "disclosureDate": "2020-01-21T00:00:00.000Z",
    "exploitPublishDate": "2020-01-21T00:00:00.000Z",
    "solution": "Fixed in [**2.3.94**](https://gitweb.gentoo.org/proj/portage.git/tag/?h=portage-2.3.94) by [this](https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=7f03ec4a46055a75eb13bf5fad85cf451822f589) commit and [this](https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=729dc030f6b318f84ca6336c7bd7dddaa7e48040) commit.\n\nThe latest stable releases are available [here](https://gitweb.gentoo.org/proj/portage.git/refs/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Michael Orlitzky",
    "workaround": "",
    "vendorFixDate": "2020-03-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0207",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-281"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20384",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0207/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.gentoo.org/692492",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitweb.gentoo.org/proj/portage.git/refs/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitweb.gentoo.org/proj/portage.git/tag/?h=portage-2.3.94",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=729dc030f6b318f84ca6336c7bd7dddaa7e48040",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=7f03ec4a46055a75eb13bf5fad85cf451822f589",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/01/21/1",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0207/default-remediation-status"
            }
        ]
    }
}