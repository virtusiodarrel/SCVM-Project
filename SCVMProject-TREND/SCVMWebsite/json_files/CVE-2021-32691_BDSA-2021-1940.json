{
    "source": "BDSA",
    "name": "BDSA-2021-1940",
    "title": "Apollos Apps Vulnerable to Account Takeover via Auto-Merging of User Records",
    "description": "Apollos Apps is vulnerable to account takeover due to auto-merging of user records. An unauthenticated attacker can take advantage of this in order to access anyone's account which includes all app functionality within the app, as well as any authenticated links to Rock-based webpages.",
    "technicalDescription": "This vulnerability exists in the `create` data source method on the `People` class. This method will automatically merge a new user account with an existing one if basic profile information is the same (for example name, birthday, gender, etc). An unauthenticated attacker can take advantage of this in order to access anyone's account which includes all app functionality within the app, as well as any authenticated links to Rock-based webpages.",
    "publishedDate": "2021-06-28T16:20:35.770Z",
    "updatedDate": "2021-06-28T16:20:35.763Z",
    "disclosureDate": "2021-06-16T00:00:00.000Z",
    "solution": "Fixed in [**2.20.0**](https://github.com/ApollosProject/apollos-apps/releases/tag/v2.20.0) by [this](https://github.com/ApollosProject/apollos-apps/commit/cb5f8f1c0b24f1b215b2bb5eb6f9a8e16d728ce2) commit. \n\nThe latest stable releases are available [here](https://github.com/ApollosProject/apollos-apps/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has provided a [workaround](https://github.com/ApollosProject/apollos-apps/security/advisories/GHSA-r578-pj6f-r4ff), stating that if you do not wish to upgrade your app to the new version, you can patch your server by overriding the `create` data source method on the `People` class.\n```\n  create = async (profile) => {\n    const rockUpdateFields = this.mapApollosFieldsToRock(profile);\n    // auto-merge functionality is compromised\n    // we are creating a new user and patching them with profile details\n    const id = await this.post('/People', {\n      Gender: 0, // required by Rock. Listed first so it can be overridden.\n      IsSystem: false, // required by rock\n    });\n    await this.patch(`/People/${id}`, {\n      ...rockUpdateFields,\n    });\n    return id;\n  };\n```",
    "vendorFixDate": "2021-06-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1940",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32691",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1940/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ApollosProject/apollos-apps/commit/cb5f8f1c0b24f1b215b2bb5eb6f9a8e16d728ce2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ApollosProject/apollos-apps/releases/tag/v2.20.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ApollosProject/apollos-apps/security/advisories/GHSA-r578-pj6f-r4ff",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ApollosProject/apollos-apps/security/advisories/GHSA-r578-pj6f-r4ff",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ApollosProject/apollos-apps/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1940/default-remediation-status"
            }
        ]
    }
}