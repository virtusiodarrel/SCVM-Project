{
    "source": "BDSA",
    "name": "BDSA-2019-4004",
    "title": "Kibana Vulnerable to Cross-site Scripting (XSS) via Map Visualizations",
    "description": "Kibana is vulnerable to stored cross-site scripting (XSS). An attacker could create a map visualization that includes arbitrary code which will execute in the user's browser when the visualization is viewed directly, or when the dashboard that includes the visualization is viewed . This could result in theft of cookie based session information or credentials.",
    "technicalDescription": "An attacker with permissions to create a coordinate or region map visualization could include arbitrary code in the \"WMS attribution\" field which is not being sanitized. This code will render when the visualization is viewed, directly or when included on a dashboard.",
    "publishedDate": "2019-12-20T16:06:08.144Z",
    "updatedDate": "2019-12-20T16:06:08.133Z",
    "disclosureDate": "2019-12-18T00:00:00.000Z",
    "solution": "Fixed in version [**7.5.1**](https://github.com/elastic/kibana/releases/tag/v7.5.1) by [this](https://github.com/elastic/kibana/commit/0a6352632f67d33ed37677eafe38011d9f6372d0) commit.\n\nFixed in version [**6.8.6**](https://github.com/elastic/kibana/releases/tag/v6.8.6) by [this](https://github.com/elastic/kibana/commit/33d674e823ac800dea339661b0733c45fd2449cd) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Eran Vaknin and Rotem Reiss",
    "workaround": "Map visualizations can be disabled by setting `xpack.maps.enabled: false`, `region_map.enabled: false`, and `tile_map.enabled: false` in `kibana.yml`.\n\nContent Security Policy (CSP) is enabled in Kibana by default from versions **6.7.0** and **7.0.0** which prevents most types of XSS when the application is accessed by a browser that supports CSP. This does not prevent an attacker including arbitrary code in the effected code but does reduce the likelihood of an exploit. To prevent the application being accessed by browsers that do not enforce CSP rules, `csp.strict: true` can be set in `kibana.yml`.",
    "vendorFixDate": "2019-12-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4004",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-7621",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4004/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.elastic.co/t/elastic-stack-6-8-6-and-7-5-1-security-update/212390",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/commit/0a6352632f67d33ed37677eafe38011d9f6372d0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/commit/33d674e823ac800dea339661b0733c45fd2449cd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/commit/b20d83a3793d3c87af035c0187924b1fb55668b3",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/releases/tag/v6.8.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/releases/tag/v7.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.elastic.co/community/security/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.elastic.co/community/security/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4004/default-remediation-status"
            }
        ]
    }
}