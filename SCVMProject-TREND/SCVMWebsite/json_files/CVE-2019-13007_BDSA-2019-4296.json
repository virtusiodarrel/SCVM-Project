{
    "source": "BDSA",
    "name": "BDSA-2019-4296",
    "title": "Gitlab Vulnerable to Denial-of-Service (DoS) via Resource Exhaustion in Service Templates",
    "description": "It was discovered Gitlab contains a resource exhaustion vulnerability. An attacker with admin privileges could exploit this flaw by enabling a service template to trigger an resource exhaustion leading to a denial-of-service (DoS) condition.",
    "technicalDescription": "The vulnerability resides in the `propagate_projects_with_template()` function in the `app/services/projects/propagate_service_template.rb` file.\n\nThe vulnerability occurs due to large number of `webhook` database entries being created when a service template is set to active. The `Select` query that finds projects to apply service templates returns the same values when the SQL query cache is utilized. The inserts continue to consume resources until the database connections timeout. As the cached results never reflect progress, eventually the database queries hang until Gitlab is restarted. \n\nThe issue was addressed by calling `Project.uncached` around the query to ensure new data is retrieved.",
    "publishedDate": "2020-03-11T16:23:40.190Z",
    "updatedDate": "2020-03-11T16:23:40.185Z",
    "disclosureDate": "2019-07-03T00:00:00.000Z",
    "exploitPublishDate": "2019-07-03T00:00:00.000Z",
    "solution": "Fixed in:\n* [**12.0.3**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.0.3) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/919aea521936c088bff986a1428634e4688d7ed2) commit.\n* [**11.11.5**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.11.5) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/103f2243c897d3ad46b137a153e909e76fde4573) commit.\n* [**11.10.8**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.10.8) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/a1fc251ed921b02e9e98fc27e445ed56d64a6971) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.8,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 5.5,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "MULTIPLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.2
        },
        "vector": "(AV:N/AC:M/Au:M/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-07-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4296",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13007",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4296/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/103f2243c897d3ad46b137a153e909e76fde4573",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/919aea521936c088bff986a1428634e4688d7ed2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/a1fc251ed921b02e9e98fc27e445ed56d64a6971",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/issues/63595",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/issues/63595",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.10.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.11.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4296/default-remediation-status"
            }
        ]
    }
}