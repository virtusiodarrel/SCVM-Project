{
    "source": "BDSA",
    "name": "BDSA-2020-3872",
    "title": "Odoo Vulnerable to Unauthorized Access to Follow Database Records via Improper Access Control in Discuss Application",
    "description": "Odoo is vulnerable to unauthorized access of database records due to improper access controls of the mail module. An authenticated attacker could exploit this to receive messages from database records and follow these for future changes and messages.",
    "technicalDescription": "In Odoo's Discuss application, users are able to converse using a system of private and public discussion channels. The mail module in Discuss application contains an improper access control that allows unauthorized users to become followers and subscribers of database records that they should not have access to. This results in getting access to discussions of these documents, reading old messages and posts, receiving future messages posted and future changes to these records.\n\nThis was addressed in `addons/mail/models/mail_followers.py` by adding a new `_check_rights` function to ensure a user is allowed to become a follower.",
    "publishedDate": "2020-12-23T12:19:15.675Z",
    "updatedDate": "2020-12-23T12:19:15.668Z",
    "disclosureDate": "2020-12-22T00:00:00.000Z",
    "solution": "Fixed in:\n* [**11.0**](https://github.com/odoo/odoo/tree/11.0) branch by [this](https://github.com/odoo/odoo/commit/a11cb62053c93eba377039370cc79933b2ea444a) commit.\n* [**12.0**](https://github.com/odoo/odoo/tree/12.0) branch by [this](https://github.com/odoo/odoo/commit/443517005639aaab0c5859d26b161848f7c5cf00) commit.\n* [**13.0**](https://github.com/odoo/odoo/tree/13.0) branch by [this](https://github.com/odoo/odoo/commit/1e00521f7908f0967f307da3120394a482dd2bad) commit.\n\nThe latest stable releases are available [here](https://www.odoo.com/page/download).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nils Hamerlinck (Trobz)",
    "workaround": "",
    "vendorFixDate": "2020-11-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3872",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11785",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3872/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/commit/1e00521f7908f0967f307da3120394a482dd2bad",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/commit/443517005639aaab0c5859d26b161848f7c5cf00",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/commit/a11cb62053c93eba377039370cc79933b2ea444a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/issues/63710",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/tree/11.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/tree/12.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/tree/13.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.odoo.com/page/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3872/default-remediation-status"
            }
        ]
    }
}