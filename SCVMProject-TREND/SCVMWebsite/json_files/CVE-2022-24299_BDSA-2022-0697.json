{
    "source": "BDSA",
    "name": "BDSA-2022-0697",
    "title": "pfSense Vulnerable to Arbitrary Command Execution via Improper Input Validation in 'OpenVPN' Component",
    "description": "pfSense is vulnerable to the execution of arbitrary commands due to a lack of validation of user-supplied input for the `data_ciphers` parameter. An authenticated attacker with access to the affected pages could exploit this by sending maliciously crafted request parameters to those pages. This will cause the execution of arbitrary shell commands on the underlying server.",
    "technicalDescription": "",
    "publishedDate": "2022-03-15T17:06:20.705Z",
    "updatedDate": "2022-08-30T16:02:52.830Z",
    "disclosureDate": "2022-01-13T00:00:00.000Z",
    "solution": "Fixed in version [**2.6.0**](https://www.pfsense.org/download) by [this](https://github.com/pfsense/pfsense/commit/78ce96a9af3b2ab5159ef6623078bfc4b15f8a89) commit.\n\nThe latest stable releases are available [here](https://www.pfsense.org/download).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Yutaka WATANABE of Ierae Security",
    "workaround": "The vendor has stated as a workaround:\n\n> Limit access to the affected pages to trusted administrators only",
    "vendorFixDate": "2022-01-17T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0697",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24299",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0697/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.netgate.com/downloads/pfSense-SA-22_03.webgui.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://docs.netgate.com/downloads/pfSense-SA-22_03.webgui.asc",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pfsense/pfsense/commit/78ce96a9af3b2ab5159ef6623078bfc4b15f8a89",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://jvn.jp/en/jp/JVN87751554/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://redmine.pfsense.org/issues/12677",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.pfsense.org/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0697/default-remediation-status"
            }
        ]
    }
}