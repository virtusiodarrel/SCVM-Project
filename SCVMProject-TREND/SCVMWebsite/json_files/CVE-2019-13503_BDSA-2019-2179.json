{
    "source": "BDSA",
    "name": "BDSA-2019-2179",
    "title": "Mongoose Vulnerable to Denial-of-Service (DoS) via Heap Buffer Over-Read in 'mg_parse_http()' Function",
    "description": "Mongoose is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause a victim's instance of the application to crash by tricking them into running the program with a crafted file as input.",
    "technicalDescription": "The function `mg_parse_http()`, which is defined within the scripts `mongoose.c` and `mg_http.c`, is used by Mongoose to parse HTTP requests and responses. This function has four parameters, one of which is the `char` pointer variable `s`. This points to the beginning of a string which constitutes the HTTP message. \n\nThe code expects the initial four bytes to contain characters corresponding to the HTTP message's status code. Whenever the function is parsing this string, it casts it to an integer using the `atoi()` function, and stores the return value in the variable `hm->resp_code`. It then adds four to the `s` variable, and then uses the `mg_skip()` function to parse until the expected end of the HTTP status message. This function uses a loop to increment `s` for as long as `s < end`, which corresponds to the expected end of the message. However, the code does not take into account that white space can exist before the status code, and thus the adjustment of `s` within `mg_parse_http()` will not be sufficient to skip to the end of the status code. This can lead to a conflict between the actual and expected end of the message; this conflict can lead to the parsing loops reading beyond the boundaries of the heap buffer that contains the message. \n\nThis buffer over-read can lead to the generation of an exception, halting the program's execution. An attacker could therefore cause a DoS by tricking a victim into running the program with a crafted file as input, which will trigger the aforementioned chain of events.",
    "publishedDate": "2019-07-19T09:33:19.587Z",
    "updatedDate": "2019-07-19T09:33:19.579Z",
    "disclosureDate": "2019-07-07T00:00:00.000Z",
    "exploitPublishDate": "2019-07-07T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/cesanta/mongoose/commit/82beafb56e94655ef44e84a618afa83c42476d85) commit which has not yet been included in any release.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-07-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2179",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-126"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13503",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2179/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cesanta/mongoose/commit/82beafb56e94655ef44e84a618afa83c42476d85",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cesanta/mongoose/pull/1035",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cesanta/mongoose/pull/1035",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2179/default-remediation-status"
            }
        ]
    }
}