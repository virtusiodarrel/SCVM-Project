{
    "source": "BDSA",
    "name": "BDSA-2022-1801",
    "title": "DomPDF Vulnerable to Server-Side Request Forgery (SSRF) via 'file_get_contents' Function",
    "description": "DomPDF is vulnerable to server-side request forgery (SSRF) due to the improper handling of redirect responses in the `file_get_contents()` function. An attacker could use a malicious URL in order to both bypass an application's IP address deny list and cause the application to issue requests on the attacker's behalf.\n\nIt should be noted that in order to be vulnerable, an application must use DomPDF with the `isRemoteEnabled`  and the `allow_url_fopen` configuration options set to `true`.",
    "technicalDescription": "",
    "publishedDate": "2022-06-30T15:37:34.842Z",
    "updatedDate": "2022-06-30T15:37:34.829Z",
    "disclosureDate": "2022-01-03T00:00:00.000Z",
    "exploitPublishDate": "2022-01-03T00:00:00.000Z",
    "solution": "Fixed in version [**2.0.0**](https://github.com/dompdf/dompdf/releases/tag/v2.0.0) by [this](https://github.com/dompdf/dompdf/commit/bb1ef65011a14730b7cfbe73506b4bb8a03704bd) commit.\n\nThe latest stable releases can be found [here](https://github.com/dompdf/dompdf/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "haxatron",
    "workaround": "",
    "vendorFixDate": "2022-06-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1801",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-0085",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1801/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dompdf/dompdf/commit/bb1ef65011a14730b7cfbe73506b4bb8a03704bd",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dompdf/dompdf/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dompdf/dompdf/releases/tag/v2.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/73dbcc78-5ba9-492f-9133-13bbc9f31236/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/73dbcc78-5ba9-492f-9133-13bbc9f31236/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1801/default-remediation-status"
            }
        ]
    }
}