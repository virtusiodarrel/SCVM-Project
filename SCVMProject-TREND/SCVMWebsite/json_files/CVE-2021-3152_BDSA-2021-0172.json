{
    "source": "BDSA",
    "name": "BDSA-2021-0172",
    "title": "Home Assistant Vulnerable to Information Disclosure via Custom Integration Leak",
    "description": "Home Assistant is vulnerable to an information disclosure issue due to how some custom integrations could leak information by potentially malicious requests.\n\nUsers of Home Assistant could install custom integrations that abuse this issue in order to disclose potentially sensitive information without their knowledge.",
    "technicalDescription": "Home Assistant is vulnerable to information disclosure because the custom integration functionality allows integrations to perform requests beyond which they should be permitted.\n\nTo remedy this issue, the vendor has added filtering functionality for requests that block requests containing harmful strings.",
    "publishedDate": "2021-01-22T11:57:25.828Z",
    "updatedDate": "2021-01-22T11:57:25.822Z",
    "disclosureDate": "2021-01-14T00:00:00.000Z",
    "solution": "Fixed in [**2021.1.3**](https://github.com/home-assistant/core/releases/tag/2021.1.3) by [this](https://github.com/home-assistant/core/commit/0bd2c13e261c7b3d96ba451c50f81dd3e659c5c9) commit and [this](https://github.com/home-assistant/core/commit/48be74805817451e04741561d49519e31a1573f1) commit.\n\nThe latest stable releases are available [here](https://github.com/home-assistant/core/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has advised [here](https://www.home-assistant.io/blog/2021/01/14/security-bulletin/), that if an update is not possible, custom integrations should be disabled.\n* Custom integrations can be disabled by renaming the `custom_components` folder inside the Home Assistant configuration folder to something else. Be sure to restart Home Assistant after it has been renamed.",
    "vendorFixDate": "2021-01-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0172",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-676"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3152",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0172/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/home-assistant/core/commit/0bd2c13e261c7b3d96ba451c50f81dd3e659c5c9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/home-assistant/core/commit/48be74805817451e04741561d49519e31a1573f1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/home-assistant/core/pull/45179",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/home-assistant/core/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/home-assistant/core/releases/tag/2021.1.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.home-assistant.io/blog/2021/01/06/release-20211/#release-202113---january-15",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.home-assistant.io/blog/2021/01/14/security-bulletin/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.home-assistant.io/blog/2021/01/14/security-bulletin/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0172/default-remediation-status"
            }
        ]
    }
}