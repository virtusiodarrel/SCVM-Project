{
    "source": "BDSA",
    "name": "BDSA-2020-3610",
    "title": "Gitea Vulnerable to Server Side Request Forgery (SSRF) via 'ParseRemoteAddr()' Function",
    "description": "Gitea is vulnerable to server-side request forgery (SSRF). An attacker could exploit this to gain information, or to target internal systems which should not be accessible to an attacker from the external network.",
    "technicalDescription": "This vulnerability exists in the `ParseRemoteAddr()` function of the `modules/auth/repo_form.go` file in Gitea, and is due to Gitea allowing URL encoded new lines in git protocol paths when there is a TCP port specified. An attacker could exploit this in order to perform server-side request forgery (SSRF) and gain information, or to target internal systems which should not be accessible to an attacker from the external network.\n\nThe vendor has mitigated against this by disallowing URL encoded new lines in git protocol paths if there is a port.",
    "publishedDate": "2020-12-03T16:31:53.385Z",
    "updatedDate": "2021-08-24T15:16:46.875Z",
    "disclosureDate": "2020-11-11T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.14.0-rc1**](https://github.com/go-gitea/gitea/releases/tag/v1.14.0-rc1) by [this](https://github.com/go-gitea/gitea/commit/5d932b35ca4ef56525b815961d7f4f48a5119875) commit,\n[**1.13.0**](https://github.com/go-gitea/gitea/releases/tag/v1.13.0) by [this](https://github.com/go-gitea/gitea/commit/122f8f86d5f6712a3b9be162aa01cb525ba4055a) commit,\n[**1.12.6**](https://github.com/go-gitea/gitea/releases/tag/v1.12.6) by [this](https://github.com/go-gitea/gitea/commit/480efbdb96e4092493ec1e3683b2ab688ac95096) commit.\n\nThe latest stable releases can be found [here](https://dl.gitea.io/gitea).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-11-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3610",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28991",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3610/ranges"
            },
            {
                "rel": "reference",
                "href": "https://dl.gitea.io/gitea",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/go-gitea/gitea/commit/122f8f86d5f6712a3b9be162aa01cb525ba4055a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/go-gitea/gitea/commit/480efbdb96e4092493ec1e3683b2ab688ac95096",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/go-gitea/gitea/commit/5d932b35ca4ef56525b815961d7f4f48a5119875",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/go-gitea/gitea/pull/13525",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/go-gitea/gitea/releases/tag/v1.12.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/go-gitea/gitea/releases/tag/v1.13.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/go-gitea/gitea/releases/tag/v1.14.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3610/default-remediation-status"
            }
        ]
    }
}