{
    "source": "BDSA",
    "name": "BDSA-2020-4320",
    "title": "FreeBSD Vulnerable to Remote Code Execution (RCE) via Insufficient Bound Checks During RDNSS and DNSSL Option Processing",
    "description": "FreeBSD is vulnerable to remote code execution (RCE) due to improper IPv6 router advertisement verification. An attacker on the local network could send crafted router advertisement messages and gain privileged command execution access on the machine running FreeBSD.",
    "technicalDescription": "The vulnerability may be triggered by the rtsold(8) daemon during RDNSS and DNSSL option processing. The daemon does not verify that the option does not extend past the end of the received packet before processing its contents. Although the kernel detects such malformed packets, it still passes them to rtsold, allowing for buffer overflows that lead to RCE. Note that rtsold only processes messages received from hosts attached to the same physical link as the interface(s) on which rtsold is listening.",
    "publishedDate": "2021-04-01T16:27:59.601Z",
    "updatedDate": "2021-05-13T10:46:40.873Z",
    "disclosureDate": "2020-12-01T00:00:00.000Z",
    "exploitPublishDate": "2021-01-28T00:00:00.000Z",
    "solution": "Fixed in versions **[12.2-STABLE](https://download.freebsd.org/ftp/releases/)** after revision [r368250](https://security.FreeBSD.org/patches/SA-20:32/rtsold.patch) and **[11.4-STABLE](https://download.freebsd.org/ftp/releases/)** after revision [r368253](https://security.FreeBSD.org/patches/SA-20:32/rtsold.patch).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 8.3,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 6.5,
        "severity": "MEDIUM",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "(AV:A/AC:L/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Francisco Falcon at Quarkslab",
    "workaround": "",
    "vendorFixDate": "2020-12-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4320",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-119"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25577",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4320/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.quarkslab.com/bad-neighbor-on-freebsd-ipv6-router-advertisement-vulnerabilities-in-rtsold-cve-2020-25577.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://download.freebsd.org/ftp/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://security.FreeBSD.org/patches/SA-20:32/rtsold.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-20:32.rtsold.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4320/default-remediation-status"
            }
        ]
    }
}