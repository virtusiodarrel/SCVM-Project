{
    "source": "BDSA",
    "name": "BDSA-2022-1201",
    "title": "Vditor Vulnerable to Stored Cross-Site Scripting (XSS) via Malicious Links created using '/guide/markdown' Endpoint",
    "description": "Vditor has a stored cross-site scripting (XSS) vulnerability due to an absence of correct parameter input validation. A remote attacker could insert JavaScript code and steal a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "This vulnerability arises when an attacker is creating a URL in the editor using the `/guide/markdown` endpoint. When the attacker uses malicious JavaScript code as the URL value, like `javascript:alert(document.domain)`, this code will be stored in the application without any sanitization. When a victim user clicks on this URL, the JavaScript code will execute in the victim's browser, thus resulting in stored XSS. The attacker can exploit this flaw to steal sensitive data like session tokens or cookies.\n\nThis issue has been fixed by implementing sanitization measures for user-supplied URLs that are submitted to the application.",
    "publishedDate": "2022-04-29T12:26:48.899Z",
    "updatedDate": "2022-04-29T12:26:48.886Z",
    "disclosureDate": "2022-03-31T00:00:00.000Z",
    "exploitPublishDate": "2022-03-31T00:00:00.000Z",
    "solution": "Fixed in version [**3.8.13**](https://github.com/Vanessa219/vditor/releases/tag/v3.8.13) by [this](https://github.com/vanessa219/vditor/commit/e912e36ea98251d700499b1ac7702708d3398476) commit.\n\nThe latest stable releases can be found [here](https://github.com/Vanessa219/vditor/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Pocas",
    "workaround": "",
    "vendorFixDate": "2022-03-31T00:00:00.000Z",
    "vendorNotifiedDate": "2022-01-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1201",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-0350",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1201/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Vanessa219/vditor/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Vanessa219/vditor/releases/tag/v3.8.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanessa219/vditor/commit/e912e36ea98251d700499b1ac7702708d3398476",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/8202aa06-4b49-45ff-aa0f-00982f62005c/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/8202aa06-4b49-45ff-aa0f-00982f62005c/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1201/default-remediation-status"
            }
        ]
    }
}