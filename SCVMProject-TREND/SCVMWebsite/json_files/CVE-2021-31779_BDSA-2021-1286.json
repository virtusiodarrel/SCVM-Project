{
    "source": "BDSA",
    "name": "BDSA-2021-1286",
    "title": "Yoast SEO for TYPO3 Vulnerable to Server-Side Request Forgery (SSRF) via Preview URL Generation Flaw",
    "description": "Yoast SEO for TYPO3 is vulnerable to server-side request forgery (SSRF) due to a flaw in how preview URLs are generated.\n\nA logged in TYPO3 backend user could use this issue to make HTTP requests to arbitrary domains including the webserver itself or other internally managed resources and disclose information.",
    "technicalDescription": "Yoast SEO for TYPO3 is vulnerable to server-side request forgery (SSRF) because analyzed URLs are not restricted to domains managed by the TYPO3 website. Complete generated URIs are passed with the `uriToCheck` parameter without sufficient validation.\n\nTo remedy this issue, the vendor has removed this behavior and instead implemented code to generate URLs based on the `pageId` and `languageId` parameters.",
    "publishedDate": "2021-05-11T14:28:13.408Z",
    "updatedDate": "2021-05-11T14:28:13.402Z",
    "disclosureDate": "2021-04-27T00:00:00.000Z",
    "solution": "Fixed in [**7.2.1**](https://github.com/Yoast/Yoast-SEO-for-TYPO3/releases/tag/7.2.1) by [this](https://github.com/Yoast/Yoast-SEO-for-TYPO3/commit/3fa83522368abd5228dc111d329892bc8c897df0) commit.\n\nThe latest stable releases are available [here](https://extensions.typo3.org/extension/yoast_seo).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.0,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrey Basarygin, Andrey Guzei, Mikhail Khramenkov, Alexander Sidukov, Maxim Teplykh (Solar Security)",
    "workaround": "",
    "vendorFixDate": "2021-04-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1286",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-31779",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1286/ranges"
            },
            {
                "rel": "reference",
                "href": "https://extensions.typo3.org/extension/yoast_seo",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Yoast/Yoast-SEO-for-TYPO3/blob/master/CHANGELOG.md#721-april-26-2021",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Yoast/Yoast-SEO-for-TYPO3/commit/3fa83522368abd5228dc111d329892bc8c897df0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Yoast/Yoast-SEO-for-TYPO3/releases/tag/7.2.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-ext-sa-2021-006",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1286/default-remediation-status"
            }
        ]
    }
}