{
    "source": "BDSA",
    "name": "BDSA-2019-1279",
    "title": "Parsedown Vulnerable to Remote Code Execution (RCE) via Class-Name Injection",
    "description": "Parsedown is vulnerable to remote code execution (RCE) due to the insufficient validation of user-provided input. An attacker could provide crafted input that will abuse existing functionality within a page to cause defacement, or to execute arbitrary JavaScript code.",
    "technicalDescription": "The function `blockFencedCode()`, defined within `Parsedown.php`, accepts the parameter `$Line`. The value of this parameter is derived from client-provided input. The value of the variable `$infostring` is then derived from that of  `$Line`, using the `substr()` function. This variable is then used to dynamically construct a HTML element, with the  `class` attribute being set to `language-$infostring`. No validation or sanitization is performed on the value of `$infostring` prior to this. If its value consists of a variety of class names separated by spaces, these will be included within the generated HTML element. An attacker could therefore specify class names which defined CSS styling to cause page defacement. If a script exists within the page that interacts with specific class elements, the attacker could potentially gain the ability to execute JavaScript code.",
    "publishedDate": "2019-04-26T12:33:49.349Z",
    "updatedDate": "2020-07-29T13:48:43.319Z",
    "disclosureDate": "2019-03-17T00:00:00.000Z",
    "exploitPublishDate": "2019-03-17T00:00:00.000Z",
    "solution": "Fixed in version [**1.7.2**](https://github.com/erusev/parsedown/releases/tag/1.7.2) by [this](https://github.com/erusev/parsedown/commit/bc003952fcbed63be7489e19e4a2710ae978866e) commit, and in version [**1.8.0-beta-6**](https://github.com/erusev/parsedown/releases/tag/v1.8.0-beta-6) by [this](https://github.com/erusev/parsedown/commit/8fd5464c46ddb778e65a53d60f72e06f7f7e5329) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-03-17T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1279",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-74"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10905",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1279/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/erusev/parsedown/commit/8fd5464c46ddb778e65a53d60f72e06f7f7e5329",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/erusev/parsedown/commit/bc003952fcbed63be7489e19e4a2710ae978866e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/erusev/parsedown/issues/699",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/erusev/parsedown/issues/699",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/erusev/parsedown/releases/tag/1.7.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/erusev/parsedown/releases/tag/v1.8.0-beta-6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1279/default-remediation-status"
            }
        ]
    }
}