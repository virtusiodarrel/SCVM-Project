{
    "source": "BDSA",
    "name": "BDSA-2020-2995",
    "title": "CRMEB Vulnerable to Server Side Request Forgery (SSRF) via Image Download Functionality",
    "description": "CRMEB is vulnerable to server side request forgery (SSRF). An attacker could submit a malicious image download request and make the server save a harmful file with arbitrary code on its system. Once the file is accessed the code would get executed on the server, allowing the attacker to execute arbitrary OS commands on the host.",
    "technicalDescription": "The issue is in the `downloadImage()` function in file `/crmeb/app/admin/controller/store/CopyTaobao.php`. The default value of `type` input variable is 0 which makes it skip the intended file verification and download process. The execution instead jumps to the `readfile($url);` and `$content = ob_get_contents();` statements which retrieve the content provided in the `url` parameter. The remaining code simply writes the retrieved content to the server's file system.",
    "publishedDate": "2020-10-28T16:10:39.240Z",
    "updatedDate": "2021-09-07T08:33:22.906Z",
    "disclosureDate": "2020-09-07T00:00:00.000Z",
    "exploitPublishDate": "2020-09-07T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNCORROBORATED",
            "score": 6.4
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:U/RC:UR)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "REASONABLE",
            "score": 8.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:U/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": true,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ViktorWkxStar (GitHub)",
    "workaround": "",
    "vendorNotifiedDate": "2020-09-07T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2995",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25466",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2995/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/crmeb/CRMEB/issues/22",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/crmeb/CRMEB/issues/22",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2995/default-remediation-status"
            }
        ]
    }
}