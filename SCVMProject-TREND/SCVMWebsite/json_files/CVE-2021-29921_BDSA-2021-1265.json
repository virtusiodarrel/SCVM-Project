{
    "source": "BDSA",
    "name": "BDSA-2021-1265",
    "title": "CPython Ipaddress Module Vulnerable to Indeterminate Server-Side Request Forgery (SSRF) & Remote File Inclusion (RFI) via Improper Input Validation of Octal Literals",
    "description": "The `ipaddress` module in CPython does not implement appropriate input validation measures for octal strings. This makes any application that relies on this module vulnerable to server-side request forgery (SSRF), remote file inclusion (RFI) and local file inclusion (LFI). An attacker could exploit this flaw by supplying octal strings as a part of the IP address input.",
    "technicalDescription": "This vulnerability exists because the application allows leading zeros as a part of the IP addresses received via the input. An attacker could use octal strings as a part of IP addresses that could lead to their misinterpretation. For example, the IP address `010.8.8.8` will be interpreted as `10.8.8.8` instead of `8.8.8.8`. This could allow the attacker to conduct an SSRF attack by using such malicious IP address strings. This could also possibly allow RFI and LFI attacks on applications that use the `ipaddress` module. This vulnerability was fixed in the `Lib/ipaddress.py` file by not permitting any leading zeros as a part of IP addresses.",
    "publishedDate": "2021-05-07T11:41:24.605Z",
    "updatedDate": "2021-12-03T16:26:38.425Z",
    "disclosureDate": "2021-04-30T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.8.12**](https://github.com/python/cpython/releases/tag/v3.8.12) by [this](https://github.com/python/cpython/commit/03dd89d62413c4a92831ed1b36e2ae8983bcb2d4) commit,\n* [**3.9.5**](https://github.com/python/cpython/releases/tag/v3.9.5) by [this](https://github.com/python/cpython/commit/5374fbc31446364bf5f12e5ab88c5493c35eaf04) commit,\n* [**3.10.0b1**](https://github.com/python/cpython/releases/tag/v3.10.0b1) by [this](https://github.com/python/cpython/commit/60ce8f0be6354ad565393ab449d8de5d713f35bc) commit.\n\nThe latest stable releases are available [here](https://github.com/python/cpython/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Joel Croteau, Victor Viale, Sick Codes, Kelly Kaoudis, John Jackson, Nick Sahler, Christian Heimes, Victor Stinner",
    "workaround": "",
    "vendorFixDate": "2021-05-02T00:00:00.000Z",
    "discoveryDate": "2021-03-29T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1265",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29921",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1265/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue36384",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/03dd89d62413c4a92831ed1b36e2ae8983bcb2d4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/5374fbc31446364bf5f12e5ab88c5493c35eaf04",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/60ce8f0be6354ad565393ab449d8de5d713f35bc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/e653d4d8e820a7a004ad399530af0135b45db27a",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.10.0b1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.8.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.9.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-014.md",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1265/default-remediation-status"
            }
        ]
    }
}