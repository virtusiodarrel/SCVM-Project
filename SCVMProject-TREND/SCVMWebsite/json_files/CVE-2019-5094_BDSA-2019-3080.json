{
    "source": "BDSA",
    "name": "BDSA-2019-3080",
    "title": "E2fsprogs Vulnerable to Code Execution via Out-of-Bounds Write in 'report_block' Function",
    "description": "E2fsprogs contains an out-of-bounds write flaw. This could be exploited by an attacker via the component's quota file functionality to execute arbritrary code.",
    "technicalDescription": "The quota feature of ext4 filesystems are hidden inodes on an ext4 partition that record usage statistics and can implement quotas on the file system. This vulnerability is exploited via a crafted `ext4` partition due to an out-of-bounds write on the heap. Upon mounting an ext4 partition, the system will measure the usage and limits of the disk and subsequently update the quota inodes on the disk if there have been any updates. The out-of-bounds write is caused by the `set_bit` value in the `report_block` function.",
    "publishedDate": "2019-10-01T13:32:44.695Z",
    "updatedDate": "2019-10-01T13:32:44.680Z",
    "disclosureDate": "2019-09-23T00:00:00.000Z",
    "exploitPublishDate": "2019-09-24T00:00:00.000Z",
    "solution": "Fixed in **[1.45.4](https://github.com/tytso/e2fsprogs/releases/tag/v1.45.4)** by [this](https://github.com/tytso/e2fsprogs/commit/8dbe7b475ec5e91ed767239f0e85880f416fc384) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.7,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.0
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Lilith (Cisco Talos)",
    "workaround": "",
    "vendorFixDate": "2019-09-01T00:00:00.000Z",
    "vendorNotifiedDate": "2019-08-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3080",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5094",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3080/ranges"
            },
            {
                "rel": "reference",
                "href": "http://e2fsprogs.sourceforge.net/e2fsprogs-release.html#1.45.4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tytso/e2fsprogs/commit/8dbe7b475ec5e91ed767239f0e85880f416fc384",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tytso/e2fsprogs/releases/tag/v1.45.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2019-0887",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2019-0887",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3080/default-remediation-status"
            }
        ]
    }
}