{
    "source": "BDSA",
    "name": "BDSA-2020-3949",
    "title": "dotCMS Vulnerable to SQL Injection (SQLi) via  'orderby' Parameter",
    "description": "dotCMS contains a SQL injection (SQLi) vulnerability due to the insufficient validation of user-supplied input. An attacker with manager permissions is able to input malicious SQL queries to access unauthorized information, modify contents of the database and cause potential access issues to the database.",
    "technicalDescription": "This vulnerability exists within the `orderby` parameter in the `dotmarketing/portlets/templates/business/TemplateFactoryImpl.java` file. This is due to `PaginatorOrdered`classes used as they do not sanitize the `orderby` parameter. An authenticated attacker with manager permissions could exploit this by crafting malicious SQL queries.",
    "publishedDate": "2020-12-31T17:03:33.499Z",
    "updatedDate": "2020-12-31T17:03:33.492Z",
    "disclosureDate": "2020-10-27T00:00:00.000Z",
    "exploitPublishDate": "2020-10-27T00:00:00.000Z",
    "solution": "Fixed in [**20.10.1**](https://github.com/dotCMS/core/releases/tag/v20.10.1) by [this](https://github.com/dotCMS/core/commit/ec4fc4d37543dac34eb27827c1cf302e7f88d505) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.6,
        "impactSubscore": 3.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "caixiaozhi",
    "workaround": "",
    "vendorFixDate": "2020-10-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3949",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27848",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3949/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/commit/ec4fc4d37543dac34eb27827c1cf302e7f88d505",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/issues/19500",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/issues/19500",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/releases/tag/v20.10.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3949/default-remediation-status"
            }
        ]
    }
}