{
    "source": "BDSA",
    "name": "BDSA-2021-2943",
    "title": "GitLab Vulnerable to Invalid User Impersonation via Administrative 'Impersonate' Functionality Flaw",
    "description": "GitLab is vulnerable to a user impersonation issue due to how the administrative 'impersonate' feature does not sufficiently ensure that when a session is stopped at a deep impersonation level that users resume their own sessions.\n\nAs a result of this flaw, when the feature is used twice by an administrative user, the admin can still be logged in as the second impersonated user which can lead to repudiation issues.",
    "technicalDescription": "To remedy this issue, the vendor has implemented the `impersonation_in_progress?` method in the `app/controllers/concerns/impersonation.rb` file and added multiple calls to this function in order to prevent double impersonation.",
    "publishedDate": "2021-10-05T14:58:26.309Z",
    "updatedDate": "2022-09-30T09:26:17.476Z",
    "disclosureDate": "2021-09-30T00:00:00.000Z",
    "solution": "Fixed in:\n* [**14.3.1**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.3.1) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/a3adc9bca8f340d1e88fda2e5c5d24326417acc4) commit,\n* [**14.2.5**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.2.5) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/c926588c9def57f8be7331b81f8823d5bae85f34) commit,\n* [**14.1.7**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.1.7) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/ca3adb2af6c380c90e10b599bfd99662a4108771) commit.\n\nThe latest stable releases are available [here](https://gitlab.com/gitlab-org/gitlab-foss/-/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "",
    "workaround": "",
    "vendorFixDate": "2021-09-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2943",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39896",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2943/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2021/09/30/security-release-gitlab-14-3-1-released/#improper-session-management-in-impersonation-feature",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-39896.json",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/a3adc9bca8f340d1e88fda2e5c5d24326417acc4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/c926588c9def57f8be7331b81f8823d5bae85f34",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/ca3adb2af6c380c90e10b599bfd99662a4108771",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.1.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.2.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2943/default-remediation-status"
            }
        ]
    }
}