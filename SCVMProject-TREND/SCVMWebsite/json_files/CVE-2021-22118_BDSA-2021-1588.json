{
    "source": "BDSA",
    "name": "BDSA-2021-1588",
    "title": "Spring Framework Vulnerable to Privilege Escalation via Unsafe Directory Management in 'WebFlux' Component",
    "description": "Spring Framework is vulnerable to privilege escalation due to the creation of unsafe temporary directories by the WebFlux component. A local authenticated attacker could modify arbitrary files via maliciously crafted `multipart` requests. \n\nThis vulnerability does not affect Spring MVC applications, or applications that do not handle `multipart` file requests.",
    "technicalDescription": "The `Synchronoss` and `SynchronossPartHttpMessageReader` components of Spring Framework's WebFlux functionality create directories in order to store files. The directories are created insecurely, such that multiple components may attempt to share the same directory. This collision could potentially allow a local authenticated attacker to read, or modify, sensitive files that are stored in the problematic directory. The attacker may also be able to modify arbitrary files on the system via maliciously crafted `multipart` HTTP requests.\n\nThis vulnerability does not affect Spring MVC applications, or applications that do not handle `multipart` file requests.",
    "publishedDate": "2021-05-26T16:08:04.314Z",
    "updatedDate": "2021-06-14T09:27:26.743Z",
    "disclosureDate": "2021-05-25T00:00:00.000Z",
    "solution": "Fixed in [**5.3.7**](https://github.com/spring-projects/spring-framework/releases/tag/v5.3.7)  by [this](https://github.com/spring-projects/spring-framework/commit/cce60c479c22101f24b2b4abebb6d79440b120d1) commit and [this](https://github.com/spring-projects/spring-framework/commit/0d0d75e25322d8161002d861fff3ec04ba8be5ac) commit, and in [**5.2.15**](https://github.com/spring-projects/spring-framework/releases/tag/v5.2.15.RELEASE) by [this](https://github.com/spring-projects/spring-framework/commit/85ad63bd35f6f10fa5549ba9a11869144338bd8a) commit.\n\nThe latest stable releases are available [here](https://github.com/spring-projects/spring-framework/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Trung Pham (Viettel Cyber Security)",
    "workaround": "",
    "vendorFixDate": "2021-05-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1588",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-376"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22118",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1588/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-framework/commit/0d0d75e25322d8161002d861fff3ec04ba8be5ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-framework/commit/85ad63bd35f6f10fa5549ba9a11869144338bd8a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-framework/commit/cce60c479c22101f24b2b4abebb6d79440b120d1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-framework/issues/26931",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-framework/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-framework/releases/tag/v5.2.15.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-framework/releases/tag/v5.3.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1588/default-remediation-status"
            }
        ]
    }
}