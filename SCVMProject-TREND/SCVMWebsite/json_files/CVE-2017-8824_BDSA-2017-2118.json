{
    "source": "BDSA",
    "name": "BDSA-2017-2118",
    "title": "Linux Kernel Vulnerable to Code Execution via Use-After-Free in 'dccp_disconnect()'",
    "description": "The Linux kernel is vulnerable to a use-after-free (*UAF*) flaw in its DCCP socket handling.  This allows a local attacker to cause a denial of service or execute code within the context of the kernel, enabling them to escalate privileges, subvert other processes, etc.",
    "technicalDescription": "Whenever the sock object is in `DCCP_CLOSED` state `dccp_disconnect()` did not free `dccps_hc_tx_ccid` and `dccps_hc_rx_ccid` and does not set them to `NULL`.  When the socket is cloned by `dccp_create_openreq_child()` via a call to `connect()`,  the kernel will access the old objects that can now be backed by another kernel object that the attacker can control.  This allows the attacker to change function pointers for example, allowing them full control over the execution context in the kernel.",
    "publishedDate": "2017-12-05T11:55:23.994Z",
    "updatedDate": "2018-09-18T09:05:04.429Z",
    "disclosureDate": "2017-12-04T00:00:00.000Z",
    "exploitPublishDate": "2017-12-04T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* [**3.2.97**](https://www.kernel.org)\n* [**3.16.52**](https://www.kernel.org)\n* [**3.18.95**](https://www.kernel.org)\n* [**4.1.50**](https://www.kernel.org)\n* [**4.4.116**](https://www.kernel.org)\n* [**4.9.82**](https://www.kernel.org)\n* [**4.14.20**](https://www.kernel.org)\n* [**4.15-rc3**](https://www.kernel.org)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=69c64866ce072dea1d1e59a0d61e0f66c0dffb76) git commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.0,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2017-12-04T00:00:00.000Z",
    "vendorNotifiedDate": "2017-12-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2118",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-8824",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2118/ranges"
            },
            {
                "rel": "reference",
                "href": "http://lists.openwall.net/netdev/2017/12/04/224",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://www.openwall.com/lists/oss-security/2017/12/05/1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://www.openwall.com/lists/oss-security/2017/12/05/1/2",
                "label": "POC"
            }
        ]
    }
}