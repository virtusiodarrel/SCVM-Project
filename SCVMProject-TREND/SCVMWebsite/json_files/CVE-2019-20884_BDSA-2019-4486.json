{
    "source": "BDSA",
    "name": "BDSA-2019-4486",
    "title": "Mattermost Server Vulnerable to Unspecified Impacts via Partial Post Attachments",
    "description": "Mattermost Server is vulnerable to unspecified impacts due to files being attached to multiple posts.",
    "technicalDescription": "This vulnerability is due to mis-management of the `file.PostId` and `post.FileIds` values in Mattermost Server. \n\nWhen a file gets attached to a post, the `post.FileIds` value is set on the post, and the `file.PostId` value is set on the file, even if the file is only partially attached. If  an attempt is then made to attach the same file to a different post, the file will remain attached to the original post because of the `file.PostId` value. However the `post.FileIds` value will still be set on the new post. An attacker can take advantage of this to cause unspecified impacts on the system.\n\nThe vendor has mitigated against this by preventing files from being attached to multiple posts.",
    "publishedDate": "2020-07-10T09:33:30.564Z",
    "updatedDate": "2020-07-10T09:33:30.560Z",
    "disclosureDate": "2019-01-11T00:00:00.000Z",
    "solution": "Fixed in [**5.8.0-rc1**](https://github.com/mattermost/mattermost-server/releases/tag/v5.8.0-rc1) by [this](https://github.com/mattermost/mattermost-server/commit/6325c5b569e00bd1e5af58190868994a503f84ec) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-01-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4486",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20884",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4486/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/commit/6325c5b569e00bd1e5af58190868994a503f84ec",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/pull/10094",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/releases/tag/v5.8.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mattermost.com/security-updates/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4486/default-remediation-status"
            }
        ]
    }
}