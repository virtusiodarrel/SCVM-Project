{
    "source": "BDSA",
    "name": "BDSA-2022-0958",
    "title": "gzip and xzutils Vulnerable to Arbitrary File Overwrites and Code Execution via 'zgrep/xzgrep' with Multi-Newline Filenames",
    "description": "gzip and xzutils are vulnerable to arbitrary file overwrites and code execution due to improper handling of file names containing multiple newline characters. An attacker could exploit this vulnerability by supplying a victim with a maliciously crafted file.",
    "technicalDescription": "The issue exists within the file `zgrep.in` of gzip and the file `src/scripts/xzgrep.in` of xzutils. An improperly defined sed command does not correctly handle file names which contains more than one newline character, which can result in the file name only being partially escaped. This can allow a crafted file name passed to `zgrep`/`xzgrep` to cause an overwrite of a targeted file. When a GNU `sed` extension is used, this can subsequently allow for arbitrary code to be injected and executed.",
    "publishedDate": "2022-04-08T12:43:24.792Z",
    "updatedDate": "2022-08-29T13:24:43.740Z",
    "disclosureDate": "2022-04-07T00:00:00.000Z",
    "exploitPublishDate": "2022-04-07T00:00:00.000Z",
    "solution": "Fixed in gzip [**1.12**](https://ftp.gnu.org/gnu/gzip/) by [this](https://git.savannah.gnu.org/cgit/gzip.git/commit/?id=dc9740df61e575e8c3148b7bd3c147a81ea00c7c) commit and [this](https://git.savannah.gnu.org/cgit/gzip.git/commit/?id=c99f320d5c0fd98fe88d9cea5407eb7ad9d50e8a) commit.\n\nFixed in xzutils [**5.26**](https://sourceforge.net/projects/lzmautils/files/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "cleemy desu wayo, with Trend Micro Zero Day Initiative",
    "workaround": "Fixed in xzutils **4.999.9beta** to **5.2.5**, **5.3.1alpha**, and **5.3.2alpha** by [this](https://github.com/xz-mirror/xz/commit/69d1b3fc29677af8ade8dc15dba83f0589cb63d6) commit which is not yet included in any release.",
    "vendorFixDate": "2022-04-06T00:00:00.000Z",
    "vendorNotifiedDate": "2022-03-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0958",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-1271",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0958/ranges"
            },
            {
                "rel": "reference",
                "href": "https://ftp.gnu.org/gnu/gzip/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.savannah.gnu.org/cgit/gzip.git/commit/?id=c99f320d5c0fd98fe88d9cea5407eb7ad9d50e8a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.savannah.gnu.org/cgit/gzip.git/commit/?id=d74a30d45c6834c8e9f87115197370fe86656d81",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.savannah.gnu.org/cgit/gzip.git/commit/?id=dc9740df61e575e8c3148b7bd3c147a81ea00c7c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xz-mirror/xz/commit/69d1b3fc29677af8ade8dc15dba83f0589cb63d6",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://lists.gnu.org/r/bug-gzip/2022-04/msg00011.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sourceforge.net/projects/lzmautils/files/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://tukaani.org/xz/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2022/04/08/2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2022/04/08/2",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.zerodayinitiative.com/advisories/ZDI-22-619/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0958/default-remediation-status"
            }
        ]
    }
}