{
    "source": "BDSA",
    "name": "BDSA-2020-0157",
    "title": "OSSEC-HIDS Vulnerable to Command Injection via 'OS_CleanMSG' Function",
    "description": "OSSEC-HIDS is vulnerable to command injection via the `OS_CleanMSG` function.  By using terminal characters an attacker may be able to obfuscate events or execute commands when the logs are viewed through vulnerable terminal emulators. This may be an unauthenticated attack for certain types and origins of logged data.",
    "technicalDescription": "The `OS_CleanMSG` function doesn't remove or encode terminal control characters or newlines from processed log messages. In several cases these special characters are later logged. If the logs are parsed using a vulnerable terminal emulator an attacker may be able to execute arbitrary commands.\n\nAs newlines are permitted in messages processed by ossec-analysisd an attacker may also be able to inject nested events to the log. This could trick system administrators into thinking alerts fired which didn't.",
    "publishedDate": "2020-02-05T14:04:13.227Z",
    "updatedDate": "2021-03-15T10:24:06.343Z",
    "disclosureDate": "2020-01-15T00:00:00.000Z",
    "solution": "",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:U/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 9.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:U/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "cpu",
    "workaround": "",
    "bdsaTags": [],
    "overallScore": 9.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0157",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-117"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8445",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0157/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ossec/ossec-hids/issues/1814",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ossec/ossec-hids/issues/1821",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0157/default-remediation-status"
            }
        ]
    }
}