{
    "source": "BDSA",
    "name": "BDSA-2021-0657",
    "title": "MagpieRSS Vulnerable to Remote Code Execution (RCE) via URL Parameter",
    "description": "MagpieRSS is vulnerable to remote code execution (RCE) due to insufficient sanitization of user-supplied input. It is possible to supply a crafted URL input that would cause MagpieRSS to save a malicious PHP file on the host server. The code on the file would get executed once it is accessed by the attacker.",
    "technicalDescription": "MagpieRSS uses curl to make requests to user-provided URLs. The URL parameter (`$URI`) is processed using the `escapeshellcmd` command in the file `extlib/Snoopy.class.inc`. However, it is possible to inject curl options in the URL. An attacker could use the `-o` option to create a new PHP file in `/var/www/html` that is sourced from their supplied URL. The code on the file would get executed once it is accessed by the attacker. The URL can also be used to disclose the contents of local files or perform server side request forgeries (SSRF).",
    "publishedDate": "2021-03-15T16:18:01.794Z",
    "updatedDate": "2022-03-07T17:18:06.802Z",
    "disclosureDate": "2021-03-15T00:00:00.000Z",
    "exploitPublishDate": "2021-03-15T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNCORROBORATED",
            "score": 6.4
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:U/RC:UR)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "REASONABLE",
            "score": 8.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:U/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": true,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "bl4ckh4ck5 (ExploitDB)",
    "workaround": "",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0657",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-88"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28940",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0657/ranges"
            },
            {
                "rel": "reference",
                "href": "https://pastebin.com/kpzHKKJu",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/49643",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/49643",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0657/default-remediation-status"
            }
        ]
    }
}