{
    "source": "BDSA",
    "name": "BDSA-2020-0391",
    "title": "Gitlab Vulnerable to Improper Access Control in Docker Registry via Deploy Tokens",
    "description": "GitLab contains an improper access control vulnerability. Due to the improper handling of deploy tokens, an attacker could bypass intended permissions and access docker registries that they do not have permissions to access.",
    "technicalDescription": "The issue occurs because the deploy tokens without `read_registry` scope can be used to access the docker registry.\nAn attacker could exploit this to gain unauthorized users access to the docker registry. This unauthorized access to the registry may go undetected as there is currently no auditing in place.",
    "publishedDate": "2020-03-09T14:48:02.793Z",
    "updatedDate": "2021-01-21T16:13:35.482Z",
    "disclosureDate": "2020-03-04T00:00:00.000Z",
    "exploitPublishDate": "2020-04-09T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**12.6.8**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.6.8) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/789293e45eba734e48f23564a245069b6befa7a4) commit,\n* [**12.7.7**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.7.7) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/c0b4e483c6ef80cf5c9c02abf74d2eb7954b3622) commit,\n* [**12.8.2**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.8.2) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/557577fba32186d09a11983618aabb5295b287e8) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "xanbanx",
    "workaround": "",
    "vendorFixDate": "2020-02-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0391",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8113",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0391/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2020/03/04/gitlab-12-dot-8-dot-2-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/557577fba32186d09a11983618aabb5295b287e8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/789293e45eba734e48f23564a245069b6befa7a4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/c0b4e483c6ef80cf5c9c02abf74d2eb7954b3622",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.6.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.7.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.8.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/31599",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/31599",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0391/default-remediation-status"
            }
        ]
    }
}