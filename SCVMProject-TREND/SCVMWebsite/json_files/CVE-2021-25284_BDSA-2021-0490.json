{
    "source": "BDSA",
    "name": "BDSA-2021-0490",
    "title": "SaltStack Salt Vulnerable to Sensitive Information Disclosure via 'cmdmod' Excessive Logging",
    "description": "Salt is vulnerable to a sensitive information disclosure issue due to how credentials can be logged in cleartext.\n\nA malicious user with access to the logs could obtain disclosed credentials and use them to conduct other attacks against the system.",
    "technicalDescription": "Salt is vulnerable to sensitive information disclosure because the `cmdmod` functionality can log passwords at `info` and `error` logging levels in cleartext to the `/var/log/salt/minion` log file.\n\nTo remedy this issue, the vendor has made changes to `cmdmod` so that only command names are logged.",
    "publishedDate": "2021-03-02T11:16:08.287Z",
    "updatedDate": "2021-03-02T11:16:08.281Z",
    "disclosureDate": "2021-02-25T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3002.3**](https://github.com/saltstack/salt/releases/tag/v3002.3) by [this](https://github.com/saltstack/salt/commit/ac2ce3a3a000e428122bc120179e083de95c1de7) commit,\n* [**3001.5**](https://github.com/saltstack/salt/releases/tag/3001.5) by [this](https://github.com/saltstack/salt/commit/413be1090cc04b8ac7fa6c07251d934d29ef120a) commit,\n* [**3000.7**](https://github.com/saltstack/salt/releases/tag/3000.7) by [this](https://github.com/saltstack/salt/commit/680b196c6a92f650dd864b323dca558ae7c8074c) commit.\n\nThe latest stable releases are available [here](https://repo.saltproject.io/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Carlos (nzlosh)",
    "workaround": "The vendor has supplied patches [here](https://gitlab.com/saltstack/open/salt-patches) for the following versions:\n* 3002.2\n* 3001.4\n* 3000.6\n* 2019.2.8\n* 2019.2.5\n* 2018.3.5\n* 2017.7.8\n* 2016.11.10\n* 2016.11.6\n* 2016.11.5\n* 2016.11.3\n* 2016.3.8\n* 2016.3.6\n* 2016.3.4\n* 2015.8.13\n* 2015.8.10\n\nThe vendor has stated [here](https://saltproject.io/security_announcements/active-saltstack-cve-release-2021-feb-25/) that links to each patch file are available from the `readme.md` file. Due to the regression found, there are more than one file per version to apply.",
    "vendorFixDate": "2021-01-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0490",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-532"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-779"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-25284",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0490/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/413be1090cc04b8ac7fa6c07251d934d29ef120a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/680b196c6a92f650dd864b323dca558ae7c8074c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/ac2ce3a3a000e428122bc120179e083de95c1de7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/3000.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/3001.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/v3002.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/saltstack/open/salt-patches",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://repo.saltproject.io/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://saltproject.io/security_announcements/active-saltstack-cve-release-2021-feb-25/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://saltproject.io/security_announcements/active-saltstack-cve-release-2021-feb-25/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0490/default-remediation-status"
            }
        ]
    }
}