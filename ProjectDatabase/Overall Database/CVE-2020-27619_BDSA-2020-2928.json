{
    "source": "BDSA",
    "name": "BDSA-2020-2928",
    "title": "Python 3 Vulnerable to Remote Code Execution (RCE) via CJK Codec Tests Implementation",
    "description": "Python 3 is vulnerable to remote code execution (RCE) due to the usage of an unsafe functions within its test suite. An attacker with control of the `pythontest.net` server could exploit this to execute arbitrary code on all test suite build bots. Alternatively, an attacker who controls the network of a machine that is running the test suite could execute arbitrary code on that machine by generating crafted network traffic.\n\nOnly instances of the test suite which have enabled downloads over the network are vulnerable.",
    "technicalDescription": "The Python test suite utilizes the function `_test_mapping_file_plain()`, of file `multibytecodec_support.py`. This function can execute `eval()` with an argument that is derived from content received from `pythontest.net`. An attacker with control of the `pythontest.net` server could exploit this to execute arbitrary code on all test suite build bots. Alternatively, an attacker who controls the network of a machine that is running the test suite could execute arbitrary code on that machine by generating crafted network traffic.\n\nDownloads over the network are disabled within the test suite by default. They must be explicitly enabled in order for this vulnerability to be exploitable. They are enabled by using the `-u network` or `-u all` flags with the `./python -m test` command.",
    "publishedDate": "2020-10-22T15:20:50.269Z",
    "updatedDate": "2021-10-14T13:36:35.617Z",
    "disclosureDate": "2020-10-05T00:00:00.000Z",
    "solution": "Fixed in: \n* [**3.10.0a2**](https://github.com/python/cpython/releases/tag/v3.10.0a2) by [this](https://github.com/python/cpython/commit/2ef5caa58febc8968e670e39e3d37cf8eef3cab8) commit and \n[this](https://github.com/python/cpython/commit/a8bf44d04915f7366d9f8dfbf84822ac37a4bab3) commit.\n* [**3.9.1-rc1**](https://github.com/python/cpython/releases/tag/v3.9.1rc1) [this](https://github.com/python/cpython/commit/b664a1df4ee71d3760ab937653b10997081b1794) commit.\n* [**3.8.7-rc1**](https://github.com/python/cpython/releases/tag/v3.8.7rc1) by [this](https://github.com/python/cpython/commit/2ef5caa58febc8968e670e39e3d37cf8eef3cab8) commit.\n* [**3.7.10**](https://github.com/python/cpython/releases/tag/v3.7.10) by [this](https://github.com/python/cpython/commit/43e523103886af66d6c27cd72431b5d9d14cd2a9) commit.\n* [**3.6.13**](https://github.com/python/cpython/releases/tag/v3.6.13) by [this](https://github.com/python/cpython/commit/e912e945f2960029d039d3390ea08835ad39374b) commit.\n\nThe latest stable releases are available [here](https://github.com/python/cpython/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Florian Bruhin",
    "workaround": "",
    "vendorFixDate": "2020-10-05T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.1,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-2928",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-749"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2020-27619",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-2928/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue41944",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/2ef5caa58febc8968e670e39e3d37cf8eef3cab8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/43e523103886af66d6c27cd72431b5d9d14cd2a9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/6c6c256df3636ff6f6136820afaefa5a10a3ac33",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/a8bf44d04915f7366d9f8dfbf84822ac37a4bab3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/b664a1df4ee71d3760ab937653b10997081b1794",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/e912e945f2960029d039d3390ea08835ad39374b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.10.0a2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.6.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.7.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.8.7rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.9.1rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://python-security.readthedocs.io/vuln/cjk-codec-download-eval.html",
                "label": "ADVISORY"
            }
        ]
    }
}