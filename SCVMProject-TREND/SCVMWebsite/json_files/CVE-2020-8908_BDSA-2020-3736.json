{
    "source": "BDSA",
    "name": "BDSA-2020-3736",
    "title": "Guava Vulnerable to Local Information Disclosure via Insecure Permissions on Temporary Directory Creation",
    "description": "Guava is vulnerable to creating temporary directories with insecure default permissions. A local attacker on the machine could learn the contents of sensitive temporary files.",
    "technicalDescription": "The library function `com.google.common.io.Files.createTempDir()` creates temporary directories with insecure default permissions (drwxr-xr-x). Files created within this directory will be readable to all local users on the system. The issue has been resolved by documenting the behavior, as well as deprecating the method. Other alternatives exist, for instance using the Java 7 and above `java.nio.file.Files.createTempDirectory()` function will create a more secure temporary directory.",
    "publishedDate": "2020-12-11T14:07:41.335Z",
    "updatedDate": "2021-02-05T10:00:57.204Z",
    "disclosureDate": "2020-09-08T00:00:00.000Z",
    "exploitPublishDate": "2020-09-08T00:00:00.000Z",
    "solution": "Fixed in **[30.0](https://github.com/google/guava/releases/tag/v30.0)** by [this](https://github.com/google/guava/commit/fec0dbc4634006a6162cfd4d0d09c962073ddf40) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.7
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jonathan Leitschuh",
    "workaround": "Explicitly change the permissions of the created temporary directory after its creation.",
    "vendorFixDate": "2020-08-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3736",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-379"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8908",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3736/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/guava/commit/fec0dbc4634006a6162cfd4d0d09c962073ddf40",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/guava/issues/4011",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/guava/issues/4011",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/guava/issues/4011",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/guava/releases/tag/v30.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3736/default-remediation-status"
            }
        ]
    }
}