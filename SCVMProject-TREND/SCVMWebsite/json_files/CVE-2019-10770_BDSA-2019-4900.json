{
    "source": "BDSA",
    "name": "BDSA-2019-4900",
    "title": "Ratpack Vulnerable to Cross-Site Scripting (XSS) via Error Handler in Development Mode",
    "description": "Ratpack is vulnerable to cross-site scripting (XSS). Attackers could exploit this vulnerability by crafting a web request within exception messages containing a malicious JavaScript payload. Users who view the associated messages will have the payload execute in their browser, potentially allowing the attacker to steal session tokens, cookies, or other sensitive information.",
    "technicalDescription": "This vulnerability exists in the `/ErrorPageRenderer.java` file when the development mode error handler contains untrusted data. Attackers could provide a maliciously crafted link to a victim that will run arbitrary JavaScript in the context of their browser. The vendor addressed this by escaping user-supplied input.",
    "publishedDate": "2020-12-11T15:15:22.265Z",
    "updatedDate": "2021-10-25T15:35:43.644Z",
    "disclosureDate": "2019-11-19T00:00:00.000Z",
    "exploitPublishDate": "2019-11-19T00:00:00.000Z",
    "solution": "Fixed in [**1.7.6**](https://github.com/ratpack/ratpack/releases/tag/v1.7.6) by [this](https://github.com/ratpack/ratpack/commit/c1d4357bbc4bceb24abb156fbb471257a0177eb6) commit.\n\nThe latest stable releases are available [here](https://github.com/ratpack/ratpack/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jonathan Leitschuh",
    "workaround": "",
    "vendorFixDate": "2020-01-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4900",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10770",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4900/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ratpack/ratpack/commit/c1d4357bbc4bceb24abb156fbb471257a0177eb6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ratpack/ratpack/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ratpack/ratpack/releases/tag/v1.7.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ratpack/ratpack/security/advisories/GHSA-r2wf-q3x4-hrv9",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ratpack/ratpack/security/advisories/GHSA-r2wf-q3x4-hrv9",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4900/default-remediation-status"
            }
        ]
    }
}