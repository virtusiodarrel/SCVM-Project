{
    "source": "BDSA",
    "name": "BDSA-2020-0331",
    "title": "Cacti Vulnerable to Remote Code Execution (RCE) via Session Cookie in 'graph_realtime.php'",
    "description": "Cacti is vulnerable to remote code execution via the `Realtime Graphs` page. This vulnerability may be exploited by an unauthenticated attacker if guest access to `Realtime Graphs` is enabled.",
    "technicalDescription": "File `graph_realtime.php` takes unsanitized `session_id()` as a parameter to `shell_exec` function. An attacker could replace the session ID with a crafted payload and have their commands executed with the privileges of the web server.\n\nThe exploit may not work on servers running PHP 7.2 and above as it strips any special characters from the session cookie.",
    "publishedDate": "2020-02-26T09:54:18.453Z",
    "updatedDate": "2020-08-14T15:18:33.752Z",
    "disclosureDate": "2020-02-21T00:00:00.000Z",
    "exploitPublishDate": "2020-02-21T00:00:00.000Z",
    "solution": "Fixed in version [**1.2.10**](https://github.com/Cacti/cacti/releases/tag/release%2F1.2.10) by [this](https://github.com/Cacti/cacti/commit/fea919e8fe05bb730c802054661fd3a7ec029784) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mohammad Askar, iSecur1ty",
    "workaround": "",
    "vendorFixDate": "2020-02-23T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0331",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8813",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0331/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Cacti/cacti/commit/fea919e8fe05bb730c802054661fd3a7ec029784",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Cacti/cacti/issues/3285",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Cacti/cacti/releases/tag/release%2F1.2.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://shells.systems/cacti-v1-2-8-authenticated-remote-code-execution-cve-2020-8813/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://shells.systems/cacti-v1-2-8-authenticated-remote-code-execution-cve-2020-8813/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/48128",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0331/default-remediation-status"
            }
        ]
    }
}