{
    "source": "BDSA",
    "name": "BDSA-2019-1682",
    "title": "SQLite Vulnerable to Denial-of-Service (DoS) via Heap Out-of-Bounds Read in 'rtreenode()' Function",
    "description": "(SQLi)te is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. A remote attacker could cause a victim's instance of the application to crash by providing crafted input that constitutes an invalid `rtree` table.",
    "technicalDescription": "The function `rtreenode()`, which is defined within the script `rtree.c`, is used by SQLite in order to parse `rtree` virtual tables. This function manipulates string data in memory using a variety of `char` arrays, which are referenced via the variables `zText `, `zCell` and `nCell`. In order to manipulate this data, the function accesses the arrays using indices that are calculated within a loop. Whenever `rtree` virtual tables with certain characteristics are being processed, the function will attempt to access memory that lies outside of the boundaries of the aforementioned buffers. This can cause an exception to be raised, halting program execution and causing a DoS. A remote attacker could therefore cause a victims instance of the application to crash by providing crafted input that constitutes an invalid `rtree` table.",
    "publishedDate": "2019-06-03T16:23:34.835Z",
    "updatedDate": "2019-09-25T16:19:39.762Z",
    "disclosureDate": "2019-04-16T00:00:00.000Z",
    "solution": "Fixed in version [**3.28.0**](https://www.sqlite.org/src/timeline?t=version-3.28.0) by [this](https://www.sqlite.org/src/info/90acdbfce9c08858) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-03-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1682",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-8457",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1682/ranges"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/releaselog/3_28_0.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/src/info/90acdbfce9c08858",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/src/timeline?t=version-3.28.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1682/default-remediation-status"
            }
        ]
    }
}