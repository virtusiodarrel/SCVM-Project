{
    "source": "BDSA",
    "name": "BDSA-2020-0379",
    "title": "Nextcloud Circles Vulnerable to Improper Authorization via Improper Access Control of Removed Email Addresses",
    "description": "Nextcloud Circles is vulnerable to improper authorization due to all access not being restricted when an email address is removed from a circle. An attacker could exploit this vulnerability to view potentially sensitive information in folders and files that had previously been shared with their email address as part of a circle.",
    "technicalDescription": "The sharing functionality in circles does not ensure that an email address member who was once part of a circle, where a folder or file was shared, is no longer able to access that content after they have left the circle.\nDue to the shared folder or file being linked to a circle specific token rather than per user and this token is sent to the email address members, it is possible for an attacker to continue to access the data after they are no longer part of the circle.\n\nAdditionally, if link shares or share by mail utilize a password,  the link is accessible without a password to an email address member who is no longer part of the circle.",
    "publishedDate": "2020-03-05T17:01:31.894Z",
    "updatedDate": "2020-03-05T17:01:31.875Z",
    "disclosureDate": "2020-03-01T00:00:00.000Z",
    "exploitPublishDate": "2020-03-01T00:00:00.000Z",
    "solution": "Fixed in version [**0.16.10**](https://github.com/nextcloud/circles/releases/tag/v0.16.10) by [this](https://github.com/nextcloud/circles/commit/e09665b45a704e952071c40e146b87997090ded7) commit and version [**0.17.8**](https://github.com/nextcloud/circles/releases/tag/v0.17.8) by [this](https://github.com/nextcloud/circles/commit/a64e144e9fc40573074301a90b02fdc21062cd59) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "michag86",
    "workaround": "",
    "vendorFixDate": "2019-08-31T00:00:00.000Z",
    "vendorNotifiedDate": "2019-08-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0379",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15610",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0379/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/circles/commit/a64e144e9fc40573074301a90b02fdc21062cd59",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/circles/commit/e09665b45a704e952071c40e146b87997090ded7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/circles/releases/tag/v0.16.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/circles/releases/tag/v0.17.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/673724",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/673724",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://nextcloud.com/security/advisory/?id=NC-SA-2019-013",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0379/default-remediation-status"
            }
        ]
    }
}