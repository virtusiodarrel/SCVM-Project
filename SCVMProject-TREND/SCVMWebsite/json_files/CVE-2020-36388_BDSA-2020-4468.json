{
    "source": "BDSA",
    "name": "BDSA-2020-4468",
    "title": "CiviCRM Vulnerable to Arbitrary PHP Code Execution via PHAR Deserialization",
    "description": "CiviCRM, in environments that do not utilize the `PharExtentionInterceptor` component (such as WordPress), is vulnerable to an arbitrary PHP code execution issue due to how PHAR files are unsafely deserialized.\n\nAn attacker with access to the back-end functionality could upload a crafted PHAR file in order to execute malicious code.",
    "technicalDescription": "CiviCRM is vulnerable to arbitrary PHP code execution because the `phar://` stream can be abused to deserialize PHAR metadata and trigger object injection.\n\nTo remedy this issue, the vendor has made changes to register an alternative PHAR stream wrapper that filters out insecure PHAR files.",
    "publishedDate": "2021-06-18T12:50:06.461Z",
    "updatedDate": "2021-09-10T10:08:24.041Z",
    "disclosureDate": "2020-04-15T00:00:00.000Z",
    "exploitPublishDate": "2021-06-22T00:00:00.000Z",
    "solution": "Fixed in [**5.24.3**](https://github.com/civicrm/civicrm-core/releases/tag/5.24.3) by [this](https://github.com/civicrm/civicrm-core/commit/bc95d82c443a61917298fcd002ba8bd478e9cb12) commit.\n\nThe latest stable releases are available [here](https://civicrm.org/download).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Patrick Figel (Greenpeace CEE), Dennis Brinkrolf (RIPS Technologies), Seamus Lee (JMA Consulting/CiviCRM)",
    "workaround": "",
    "vendorFixDate": "2020-04-11T00:00:00.000Z",
    "vendorNotifiedDate": "2021-02-18T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4468",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-36388",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4468/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.sonarsource.com/civicrm-code-execution-vulnerability-chain-explained",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.sonarsource.com/civicrm-code-execution-vulnerability-chain-explained",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://civicrm.org/advisory/civi-sa-2020-03",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://civicrm.org/blog/dev-team/civicrm-5243-security-release-and-esr-5213",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://civicrm.org/download",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/civicrm/civicrm-core/commit/bc95d82c443a61917298fcd002ba8bd478e9cb12",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/civicrm/civicrm-core/releases/tag/5.24.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4468/default-remediation-status"
            }
        ]
    }
}