{
    "source": "BDSA",
    "name": "BDSA-2022-1811",
    "title": "Linux Kernel Vulnerable to Buffer Overflow via Insufficient Sanity Checks in 'nft_set_desc_concat_parse()' Function",
    "description": "The Linux kernel contains a buffer overflow vulnerability because of insufficient sanity checks in the code. Exploiting this flaw could allow an attacker to cause a denial-of-service (DoS). This vulnerability could potentially be used to run arbitrary code on the system, although such an attack has not yet been demonstrated.",
    "technicalDescription": "This vulnerability exists because the `nft_set_desc_concat_parse()` function in `net/netfilter/nf_tables_api.c` does not contain sufficient sanity checks to ensure that:\n* `desc->field_count` is not larger than the length of the `desc->field_len` array.\n* The field length (i.e. `len`) is not larger than `desc->field_len` i.e. `U8_MAX`.\n* The total length of the concatenation is not larger than the length of the register array.\n\nIn absence of these checks, a buffer overflow can be triggered in the same function. Exploitation of this vulnerability can lead to a denial-of-service. It could also be possible for an attacker to run arbitrary code on the system, although this has not been demonstrated yet.\n\nThis issue has been fixed by implementing the missing sanity checks in the `nft_set_desc_concat_parse()` function of file `net/netfilter/nf_tables_api.c`.",
    "publishedDate": "2022-07-01T10:32:33.470Z",
    "updatedDate": "2022-07-01T10:32:33.455Z",
    "disclosureDate": "2022-05-31T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.10.120**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c0aff1faf66b6b7a19103f83e6a5d0fdc64b9048) commit\n* [**5.15.45**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=89ef50fe03a55feccf5681c237673a2f98161161) commit\n* [**5.17.13**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c88f3e3d243d701586239c5b69356ec2b1fd05f1) commit\n* [**5.18.2**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c9a46a3d549286861259c19af4747e12cfaeece9) commit\n* [**5.19-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fecf31ee395b0295f2d7260aa29946b7605f7c85) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.1,
        "impactSubscore": 8.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "zhangziming.zzm@antgroup.com",
    "workaround": "",
    "vendorFixDate": "2022-05-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-1811",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-120"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2022-2078",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-1811/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/CVE-2022-2078",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=89ef50fe03a55feccf5681c237673a2f98161161",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c0aff1faf66b6b7a19103f83e6a5d0fdc64b9048",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c88f3e3d243d701586239c5b69356ec2b1fd05f1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c9a46a3d549286861259c19af4747e12cfaeece9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fecf31ee395b0295f2d7260aa29946b7605f7c85",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}