{
    "source": "BDSA",
    "name": "BDSA-2021-2323",
    "title": "Centreon Vulnerable to SQL Injection (SQLi) via Insufficient Input Sanitization in 'csv_HostGroupLogs.php' File",
    "description": "Centreon is vulnerable to an SQL Injection (SQLi) issue due to a lack of sufficient input sanitization in the `csv_HostGroupLogs.php` file for values that are included in a database query.\n\nAn attacker with standard user privileges could abuse this issue in order to execute arbitrary SQL commands against the database to read or modify information. This issue could potentially be used to enable further attacks, such as privilege escalation.",
    "technicalDescription": "Centreon is vulnerable to an SQL Injection (SQLi) issue because multiple user controlled parameters that are used within a database query in the `www/include/reporting/dashboard/csvExport/csv_HostGroupLogs.php` file are not sufficiently sanitized.\n\nAn authenticated attacker that is a member of the `ALL` access list group could call the affected file and include malicious content in the affected parameters to execute arbitrary SQL commands. \n\nTo remedy this issue, the vendor has updated the validation for the `hostgroupId`, `startDate` and `endDate` parameters to ensure that integers are submitted for `csv_HostGroupLogs` queries.",
    "publishedDate": "2021-08-04T10:49:34.607Z",
    "updatedDate": "2021-08-04T10:49:34.600Z",
    "disclosureDate": "2021-07-28T00:00:00.000Z",
    "exploitPublishDate": "2021-07-28T00:00:00.000Z",
    "solution": "Fixed in:\n* [**21.04.2**](https://github.com/centreon/centreon/releases/tag/21.04.2) by [this](https://github.com/centreon/centreon/commit/ee38388ca2de18d96bbed8c8904bb380b69b3f5f) commit,\n* [**20.10.8**](https://github.com/centreon/centreon/releases/tag/20.10.8) by [this](https://github.com/centreon/centreon/commit/f94f8b8ca475eb7276cd695ca89cce2db757fa1b) commit,\n* [**20.04.14**](https://github.com/centreon/centreon/releases/tag/20.04.14) by [this](https://github.com/centreon/centreon/commit/b171ffc7b0adcf6ff8742e9db1f550bba60e6492) commit,\n* [**2.8.38**](https://github.com/centreon/centreon/releases/tag/2.8.38) by [this](https://github.com/centreon/centreon/commit/d3d56f8a95c1b75528453a4f69f9b8a5640fe39d) commit.\n\nThe latest stable releases are available [here](https://github.com/centreon/centreon/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Guillaume Andr\u00e9 & Th\u00e9o Louis-Tisserand from Synacktiv",
    "workaround": "",
    "vendorFixDate": "2021-05-05T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2323",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-37556",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2323/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/b171ffc7b0adcf6ff8742e9db1f550bba60e6492",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/d3d56f8a95c1b75528453a4f69f9b8a5640fe39d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/ee38388ca2de18d96bbed8c8904bb380b69b3f5f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/f94f8b8ca475eb7276cd695ca89cce2db757fa1b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/2.8.38",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/20.04.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/20.10.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/21.04.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synacktiv.com/sites/default/files/2021-07/Centreon_Multiple_vulnerabilities_0.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.synacktiv.com/sites/default/files/2021-07/Centreon_Multiple_vulnerabilities_0.pdf",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2323/default-remediation-status"
            }
        ]
    }
}