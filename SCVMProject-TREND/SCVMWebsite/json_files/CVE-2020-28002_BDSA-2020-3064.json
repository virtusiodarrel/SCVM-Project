{
    "source": "BDSA",
    "name": "BDSA-2020-3064",
    "title": "SonarQube Vulnerable to Remote Code Execution (RCE) and Authentication Bypass via 'sonar.login' Option Mishandling",
    "description": "SonarQube is vulnerable to authentication bypass due to the unsafe implementation of a command-line option. A remote attacker could analyze, create and overwrite projects without authorization by abusing this command line option. This could potentially allow the attacker to achieve remote code execution.",
    "technicalDescription": "SonarQube implements a command-line interface that allows users to access and create projects. Access to projects can be controlled, meaning that users must provide credentials at the command line in order to access them. This behavior is implemented using the `/api/CE/submit` endpoint. The `-D` flag is used to specify credentials, with arguments such as `sonar.password = test`. \n\nThe default configuration for this endpoint is insecure, such that supplying blank credentials with the aforementioned `-D` flag can lead to successful authentication. In this way, a remote attacker can analyze, create and overwrite existing projects, even if those projects are supposed to be private. This could potentially allow an attacker to add malicious code to a project, in order to achieve remote code execution.",
    "publishedDate": "2020-10-30T13:18:21.208Z",
    "updatedDate": "2021-01-11T17:05:34.743Z",
    "disclosureDate": "2020-10-29T00:00:00.000Z",
    "exploitPublishDate": "2020-10-29T00:00:00.000Z",
    "solution": "Fixed in [**8.6.0.39681**](https://github.com/SonarSource/sonarqube/releases/tag/8.6.0.39681) by [this](https://github.com/SonarSource/sonarqube/commit/6e18f97ab530ffc932b1b2a2888e31e112b4be96) commit and [this](https://github.com/SonarSource/sonarqube/commit/6424be5625e272f415067c9cd39af5fa07689c9a) commit.\n\nThe latest stable releases are available [here](https://github.com/SonarSource/sonarqube/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Christian Gutierrez",
    "workaround": "",
    "vendorFixDate": "2020-11-26T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3064",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-234"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28002",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3064/ranges"
            },
            {
                "rel": "reference",
                "href": "https://csl.com.co/sonarqube-auditando-al-auditor-parte-ii/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://csl.com.co/sonarqube-auditando-al-auditor-parte-ii/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/SonarSource/sonarqube/commit/6424be5625e272f415067c9cd39af5fa07689c9a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/SonarSource/sonarqube/commit/6e18f97ab530ffc932b1b2a2888e31e112b4be96",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/SonarSource/sonarqube/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/SonarSource/sonarqube/releases/tag/8.6.0.39681",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jira.sonarsource.com/browse/MMF-2146",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3064/default-remediation-status"
            }
        ]
    }
}