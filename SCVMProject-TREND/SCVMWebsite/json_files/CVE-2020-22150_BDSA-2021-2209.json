{
    "source": "BDSA",
    "name": "BDSA-2021-2209",
    "title": "piwigo Vulnerable to Cross-Site Scripting (XSS) vin 'set_cat_permalink' Function",
    "description": "piwigo contains a cross site scripting (XSS) vulnerability in the `set_cat_permalink` function due to lack of sanitization of user supplied input. An attacker can then exploit this, executing malicious scripts in the context of the browser allowing the theft of session tokens, cookies and sensitive information.",
    "technicalDescription": "This vulnerability exists in the `set_cat_permalink` function within the `admin/include/functions_permalinks.php` file. This is due to missing sanitization on the parameter `permalink`.  Attackers with administrator privileges could exploit this vulnerability by injecting malicious scripts which can then be executed when rendered in the victim's browser. The malicious scripts are triggered within an error message on the 'Permalinks' page under 'Permanent Links' section.",
    "publishedDate": "2021-07-26T12:36:00.017Z",
    "updatedDate": "2022-08-22T14:23:24.050Z",
    "disclosureDate": "2021-02-12T00:00:00.000Z",
    "exploitPublishDate": "2021-02-12T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 1.7,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 7.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N/E:P/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "B\u00f9i \u0110\u1ee9c Anh Khoa",
    "workaround": "A fix is proposed in [this](https://github.com/Piwigo/Piwigo/pull/1385) pull request which has not yet been merged.",
    "bdsaTags": [],
    "overallScore": 7.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2209",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-22150",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2209/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Piwigo/Piwigo/commit/b5fc14700a98dc44c43ff14c292af3e076858cb4",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Piwigo/Piwigo/issues/1158",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Piwigo/Piwigo/issues/1158",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Piwigo/Piwigo/pull/1385",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Piwigo/Piwigo/pull/1385",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Piwigo/Piwigo/pull/1385",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2209/default-remediation-status"
            }
        ]
    }
}