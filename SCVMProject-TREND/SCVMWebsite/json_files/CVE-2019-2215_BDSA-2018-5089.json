{
    "source": "BDSA",
    "name": "BDSA-2018-5089",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via Use-After-Free in 'binder_thread_release()' Function",
    "description": "The Linux Kernel is vulnerable to privilege escalation due to the mismanagement of system memory resources. A local attacker could gain root access to vulnerable systems by running a crafted application.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "Thread execution within the Linux kernel can be delayed. The threads that are in a suspended execution state are said to be 'waiting'. The state of each thread can be checked by the kernel using polling. The polling behavior is controlled using the fields contained in an `epoll` type structure. In order to track waiting threads, a so called 'wait list' is used. This is referenced via the `thread->wait` variable. The `epoll` structure will contain a reference to the wait list in order to conduct the aforementioned state checks.\n\nWhenever a thread is exiting, the function `binder_ioctl()` can be called. One of the variables that is passed to this function is `cmd`, which will control the function's behavior via  a `switch` statement. If the value of `cmd` is `BINDER_THREAD_EXIT`, the function `binder_thread_release()` is called in order to free the thread's wait queue. The reference to the wait queue will still remain in the `epoll` data structure, however. Later, whenever the process is closing, an attempt will be made to access the wait queue through the  `epoll` structure as part of the cleanup process. This constitutes a use-after-free. A local attacker can potentially exploit this use-after-free event in order to read and write to arbitrary memory addresses within the Linux kernel. The attacker can use this to escalate their privileges. In order to achieve this, they must be able to run a malicious binary on the target system.",
    "publishedDate": "2019-10-23T10:39:37.122Z",
    "updatedDate": "2022-05-05T14:59:35.527Z",
    "disclosureDate": "2018-01-09T00:00:00.000Z",
    "exploitPublishDate": "2019-10-03T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.196**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=80eb98a4ee70428d5b4b7202195a916385a76809) commit\n* [**4.9.196**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a494a71146a1cf3f48bb94cf33981db1f027e6a0) commit\n* [**4.14.17**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7a3cee43e935b9d526ad07f20bf005ba7e74d05b) commit\n* [**4.15.1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7654cae5433700f4f5ae6cafd785b84b52d10468) commit\n* [**4.16-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f5cb779ba16334b45ba8946d6bfa6d9834d1527f) commit\n\nThe latest stables releases can be found [here](https://www.kernel.org/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:L/AC:L/Au:N/C:C/I:C/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-01-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5089",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-2215",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5089/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1942",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1942",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7654cae5433700f4f5ae6cafd785b84b52d10468",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7a3cee43e935b9d526ad07f20bf005ba7e74d05b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=80eb98a4ee70428d5b4b7202195a916385a76809",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a494a71146a1cf3f48bb94cf33981db1f027e6a0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f5cb779ba16334b45ba8946d6bfa6d9834d1527f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5089/default-remediation-status"
            }
        ]
    }
}