{
    "source": "BDSA",
    "name": "BDSA-2022-1775",
    "title": "OpenSSL Vulnerable to Remote Memory Corruption via Heap-Based Buffer Overflow in 'bn_select_words' Function on 'AVX512' Capable Machines",
    "description": "It has been reported that OpenSSL on AVX512 capable machines is susceptible to a remote memory corruption issue due to the presence of a heap-based buffer overflow flaw in the `bn_select_words()` function.\n\n**Note**:  Reports suggest that in certain scenarios, this issue could be exploited to achieve remote code execution (RCE), however, the impacts of this issue are currently disputed by vendor who states in a [comment](https://github.com/openssl/openssl/issues/18625#issuecomment-1163977966) that they \"do not think this is a security vulnerability. It is just a serious bug making **3.0.4** release unusable on AVX512 capable machines.\". It has also been stated [here](https://github.com/openssl/openssl/issues/18625#issuecomment-1169075185) that the overflow flaw in only reachable via `Dual 1024 RSAZ` which itself is only reachable via `RSA` operations.",
    "technicalDescription": "The RCE vulnerability has not yet been proven, but a heap-based buffer overflow can be triggered in the `bn_reduce_once_in_place` call in `ossl_rsaz_mod_exp_avx512_x2` in `crypto/bn/rsaz_exp_x2.c` and will cause memory corruption.\nThis is due to the `factor_size` argument in `bn_reduce_once_in_place` being the bit size instead of the sizeof `BN_ULONG` values, which are 8-bytes on x64 systems.  As noted, this vulnerability only applies to x64 systems, which is the only architecture which can have AVX512 support.  This incorrect data type error will lead to `8192` bytes from heap memory being overflown.",
    "publishedDate": "2022-06-30T13:19:51.620Z",
    "updatedDate": "2022-07-15T08:26:39.594Z",
    "disclosureDate": "2022-06-22T00:00:00.000Z",
    "exploitPublishDate": "2022-06-22T00:00:00.000Z",
    "solution": "Fixed in version [**3.0.5**](https://github.com/openssl/openssl/releases/tag/openssl-3.0.5) by [this](https://github.com/openssl/openssl/commit/a1f7034bbd8f0730d360211f5ba0feeaef0b7b2c) commit.\n\nThe latest stable releases can be found [here](https://github.com/openssl/openssl/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Xi Ruoyao, Guido Vranken",
    "workaround": "A potential workaround is suggested [here](https://github.com/openssl/openssl/issues/18625#issuecomment-1171795834).\n\nThis workaround involves setting the following environment variable,\n\n`export OPENSSL_ia32cap=:~0x200000`.",
    "vendorFixDate": "2022-06-23T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1775",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-2274",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1775/ranges"
            },
            {
                "rel": "reference",
                "href": "https://edit.globalsecuritydatabase.org/identifier/GSD-2022-1002526",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/commit/10d8a109be0fe50315e4eeb0676f6571914cd47a",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/commit/a1f7034bbd8f0730d360211f5ba0feeaef0b7b2c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/issues/18625",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/issues/18625",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/issues/18625#issuecomment-1163977966",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/issues/18625#issuecomment-1169075185",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/issues/18625#issuecomment-1171795834",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/releases/tag/openssl-3.0.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://guidovranken.com/2022/06/27/notes-on-openssl-remote-memory-corruption/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://thehackernews.com/2022/06/openssh-to-release-security-patch-for.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.theregister.com/2022/06/27/openssl_304_memory_corruption_bug/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1775/default-remediation-status"
            }
        ]
    }
}