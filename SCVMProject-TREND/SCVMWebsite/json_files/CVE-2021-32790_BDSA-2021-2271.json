{
    "source": "BDSA",
    "name": "BDSA-2021-2271",
    "title": "WordPress WooCommerce Plugin Vulnerable to Information Disclosure via Blind SQL Injection (SQLi) in Authenticated 'Web-hook Search' API Endpoints",
    "description": "WooCommerce is vulnerable to a blind SQL injection (SQLi) issue due to a lack of sufficient input sanitization in 'Web-hook Search' API endpoints.\n\nAn attacker with administrative privileges or in possession of API keys to the WooCommerce site could abuse this issue in order to exfiltrate data using timing or other related attacks.",
    "technicalDescription": "WooCommerce is vulnerable to information disclosure because the `$search` parameter in a query that is present in the `search_webhooks()` function within the `includes/data-stores/class-wc-webhook-data-store.php ` file unsafely includes user supplied input. A malicious user with administrative access or valid API keys could exploit this issue with the `/wp-json/wc/v3/webhooks`, `/wp-json/wc/v2/webhooks` or other webhook listing API. \n\nThis issue allows read-only SQL queries to be executed to a degree where a carefully crafted search parameter could be used to disclose information using timing and related attacks.",
    "publishedDate": "2021-07-28T11:04:21.607Z",
    "updatedDate": "2022-08-03T14:27:40.970Z",
    "disclosureDate": "2021-07-23T00:00:00.000Z",
    "solution": "Fixed by [this](https://plugins.trac.wordpress.org/changeset/2564657) changeset in:\n* **5.5.1**,  **5.4.2**, **5.3.1**, **5.2.3**, **5.1.1**, **5.0.1**,\n* **4.9.3**, **4.8.1**, **4.7.2**, **4.6.3**, **4.5.3**, **4.4.2**, **4.3.4**, **4.2.3**, **4.1.2**, **4.0.2**, \n* **3.9.4**, **3.8.2**, **3.7.2**, **3.6.6**, **3.5.9**, **3.4.8**, **3.3.6**.\n\nThe latest stable releases are available [here](https://wordpress.org/plugins/woocommerce/advanced/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.4,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 0.7,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-07-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2271",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32790",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2271/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/woocommerce/woocommerce/security/advisories/GHSA-7vx5-x39w-q24g",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://plugins.trac.wordpress.org/changeset/2564657",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://woocommerce.com/posts/critical-vulnerability-detected-july-2021/#",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://wordpress.org/plugins/woocommerce/advanced/",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2271/default-remediation-status"
            }
        ]
    }
}