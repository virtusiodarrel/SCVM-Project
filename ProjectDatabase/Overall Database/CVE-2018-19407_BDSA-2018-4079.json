{
    "source": "BDSA",
    "name": "BDSA-2018-4079",
    "title": "Linux Kernel KVM Vulnerable to Denial-of-Serrvice (DoS) via NULL Pointer Dereference in 'vcpu_scan_ioapic' Function",
    "description": "Linux kernel is vulnerable to denial-of-service (DoS) as it may end up referencing an empty memory region due to a missing check. Crafted system calls may lead to a state where the Advanced Programmable Interrupt Controller (APIC) within KVM is not initialized prior to being accessed. A local attacker can leverage this flaw to crash the host.",
    "technicalDescription": "The flaw lies in the `vcpu_scan_ioapic()` function of the `/arch/x86/kvm/x86.c` source file. It is possible to trigger the `vcpu_scan_ioapic()` logic by writing to hyper-v synthetic interrupt controller (SynIC) `HV_X64_MSR_SINT6` model-specific register (MSR) before all required resources are initialized. SynIC is a Local Advanced Programmable Interrupt Controller (LAPIC) extension, which is controlled via MSRs. This will attempt to load SynIC vectors into EOI exit bitmap (enables userspace IOAPIC interactions with an in kernel APIC) before `irqchip` (interrupt controller) is initialized. This operation will end in a `NULL` pointer dereference and a crash.\n\nIntroduced in **3.10-rc1** by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3d81bc7e96d6bca0b8f8b7d1bf6ea72caa3aac57) commit.",
    "publishedDate": "2018-11-23T15:53:14.799Z",
    "updatedDate": "2019-02-05T13:36:14.477Z",
    "disclosureDate": "2018-11-20T00:00:00.000Z",
    "exploitPublishDate": "2018-11-20T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.9.143**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3a468e8e5a6124523e2e94c33866c609cc914876) commit,\n* [**4.14.86**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=83f00ab9a7c03e9f1410727d985b7fe9473002e1) commit,\n* [**4.19.7**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=61c42d657c859ccc95e53afdac64f73a0053b8ea) commit, and\n* [**4.20-rc5**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e97f852fd4561e77721bb9a4e0ea9d98305b1e93) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:L/AC:L/Au:S/C:N/I:N/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Wanpeng Li",
    "workaround": "",
    "vendorFixDate": "2018-11-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4079",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-476"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-19407",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4079/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3a468e8e5a6124523e2e94c33866c609cc914876",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=61c42d657c859ccc95e53afdac64f73a0053b8ea",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=83f00ab9a7c03e9f1410727d985b7fe9473002e1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e97f852fd4561e77721bb9a4e0ea9d98305b1e93",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://lkml.org/lkml/2018/11/20/580",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lkml.org/lkml/2018/11/20/580",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}