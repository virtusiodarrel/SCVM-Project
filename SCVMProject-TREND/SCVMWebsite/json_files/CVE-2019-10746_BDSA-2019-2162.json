{
    "source": "BDSA",
    "name": "BDSA-2019-2162",
    "title": "Mixin-deep Vulnerable to Denial-of-Service (DoS) Due to Prototype Pollution Attack via 'Object.prototype'",
    "description": "Mixin-deep is vulnerable to prototype pollution attack. This could allow an attacker to manipulate a function to add or modify properties of `Object.prototype` via a constructor payload. Successfully exploiting results in a denial-of-service (DoS) and code execution may be possible.",
    "technicalDescription": "This vulnerability allows an attacker to alter `Object.prototype` by injecting an additional value via a JSON object. This can be exploited to trigger a denial-of-service (DoS) by triggering an exception message or for code execution, including the ability to modify the application's source code to call external code paths. Property injection is also possible which can be exploited to expose cookies and other sensitive information. The vulnerability is caused by the use of `if (key !== '__proto__')` in `index.js`.\n\nThe vulnerable code was introduced by [this](https://github.com/jonschlinkert/mixin-deep/commit/578b0bc5e74e14de9ef4975f504dc698796bdf9c) commit.",
    "publishedDate": "2019-07-17T12:38:02.169Z",
    "updatedDate": "2019-07-17T12:38:02.155Z",
    "disclosureDate": "2019-06-19T00:00:00.000Z",
    "exploitPublishDate": "2019-06-19T00:00:00.000Z",
    "solution": "Fixed in:\n\n* **[1.3.2](https://github.com/jonschlinkert/mixin-deep/releases/tag/1.3.2)** by [this](https://github.com/jonschlinkert/mixin-deep/commit/90ee1fab375fccfd9b926df718243339b4976d50) commit.\n* **[2.0.1](https://github.com/jonschlinkert/mixin-deep/releases/tag/2.0.1)** by [this](https://github.com/jonschlinkert/mixin-deep/commit/8f464c8ce9761a8c9c2b3457eaeee9d404fa7af9) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "1. Freeze the prototype\u2014 use Object.freeze (Object.prototype).\n2. Require schema validation of JSON input.\n3. Avoid using unsafe recursive merge functions.\n4. Consider using objects without prototypes (for example, Object.create(null)), breaking the prototype chain and preventing pollution.\n5. As a best practice use Map instead of Object.",
    "vendorFixDate": "2019-06-19T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2162",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10746",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2162/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/paper/JavaScript_prototype_pollution_attack_in_NodeJS.pdf",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jonschlinkert/mixin-deep/commit/578b0bc5e74e14de9ef4975f504dc698796bdf9c",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jonschlinkert/mixin-deep/commit/578b0bc5e74e14de9ef4975f504dc698796bdf9c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jonschlinkert/mixin-deep/commit/8f464c8ce9761a8c9c2b3457eaeee9d404fa7af9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jonschlinkert/mixin-deep/commit/90ee1fab375fccfd9b926df718243339b4976d50",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jonschlinkert/mixin-deep/releases/tag/1.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jonschlinkert/mixin-deep/releases/tag/2.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-MIXINDEEP-450212",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-MIXINDEEP-450212",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-MIXINDEEP-450212",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2162/default-remediation-status"
            }
        ]
    }
}