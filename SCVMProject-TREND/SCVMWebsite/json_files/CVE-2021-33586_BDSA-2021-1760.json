{
    "source": "BDSA",
    "name": "BDSA-2021-1760",
    "title": "InspIRCd Vulnerable to Information Disclosure via 'Malformed PONG' Issue",
    "description": "InspIRCd is vulnerable to an information disclosure issue due to how the 'PONG' message functionality can send malformed 'PONG' messages.\n\nAn attacker with the ability to connect to the server could abuse this issue to access recently deallocated memory.",
    "technicalDescription": "InsplRCd is vulnerable to information disclosure because the `CommandPing:HandleLocal` function in the `src/coremods/core_user/core_user.cpp` file calls `ClientProtocol::Messages::Pong::Pong` without supplying the pinged server parameter. \n\nThis issue could cause malformed 'PONG' messages that contain the contents from recently deallocated memory to be sent to users in response to 'PING' requests. The vendor has stated [here](https://docs.inspircd.org/security/2021-01/) that they believe that the most likely memory to be disclosed is information regarding messages sent to the calling user, but the possibility that the messages could contain other information can not be ruled out.",
    "publishedDate": "2021-06-14T13:14:51.688Z",
    "updatedDate": "2021-06-14T13:14:51.676Z",
    "disclosureDate": "2021-05-14T00:00:00.000Z",
    "solution": "Fixed in [**3.10.0**](https://github.com/inspircd/inspircd/releases/tag/v3.10.0) by [this](https://github.com/inspircd/inspircd/commit/4350a11c663b0d75f8119743bffb7736d87abd4d) commit.\n\nThe latest stable releases are available [here](https://github.com/inspircd/inspircd/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrio Celos",
    "workaround": "If it is not possible to upgrade, patches are available for **3.8.0** and **3.8.1** [here](https://github.com/inspircd/inspircd/commit/6fbe4dd791e62005c5243762cf6bd01b48ed9d73.patch), and **3.9.0** [here](https://github.com/inspircd/inspircd/commit/4350a11c663b0d75f8119743bffb7736d87abd4d.patch).\n\nThe vendor has stated [here](https://docs.inspircd.org/security/2021-01/) that `/RELOADMODULE  core_user` should be run as a server operator after applying the relevant patch.",
    "vendorFixDate": "2021-05-14T00:00:00.000Z",
    "vendorNotifiedDate": "2021-05-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1760",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33586",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1760/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.inspircd.org/security/2021-01/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://docs.inspircd.org/security/2021-01/",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/inspircd/inspircd/commit/4350a11c663b0d75f8119743bffb7736d87abd4d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/inspircd/inspircd/commit/4350a11c663b0d75f8119743bffb7736d87abd4d.patch",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/inspircd/inspircd/commit/581d1d8fa0ef62e20409543570390613c78e6f5b",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/inspircd/inspircd/commit/6fbe4dd791e62005c5243762cf6bd01b48ed9d73.patch",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/inspircd/inspircd/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/inspircd/inspircd/releases/tag/v3.10.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1760/default-remediation-status"
            }
        ]
    }
}