{
    "source": "BDSA",
    "name": "BDSA-2019-1081",
    "title": "BoltCMS Vulnerable to Remote Code Execution (RCE) via Cross-Site Request Forgery (CSRF) in 'File Upload' Functionality",
    "description": "A cross-site request forgery (CSRF) vulnerability has been discovered in BoltCMS. An attacker could exploit this vulnerability by crafting a malicious link to trick a victim into executing malicious requests against the application.",
    "technicalDescription": "A weakness has been discovered in BoltCMS which can lead to arbitrary code execution against the target system. An authenticated user who has access to the `Files on the Stack` functionality can be tricked into submitting a malicious request via a crafted link. The POST request generated by URL `http://victim.com/bolt/editcontent/homepage` does not contain a CSRF token or other validation checks to determine the authenticity of the request being made to the application.\n\nAn improper authorization vulnerability exists which allows unauthorized users from accessing specific configuration files. It is possible to access the `config/config.yml` file and modify which file types are accepted by the application.\n\nAn attacker could exploit these two weakness to trick a victim into uploading a malicious HTML file that executes additional code to upload a malicious shell against the target system.",
    "publishedDate": "2019-04-16T13:54:59.330Z",
    "updatedDate": "2019-04-16T13:54:59.292Z",
    "disclosureDate": "2019-04-04T00:00:00.000Z",
    "exploitPublishDate": "2019-04-04T00:00:00.000Z",
    "solution": "Fixed in version [**3.6.7**](https://github.com/bolt/bolt/releases/tag/v3.6.7) by [this](https://github.com/bolt/bolt/pull/7768/commits/91187aef36363a870d60b0a3c1bf8507af34c9e4) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Felipe Gaspar",
    "workaround": "",
    "vendorFixDate": "2019-04-11T00:00:00.000Z",
    "discoveryDate": "2019-04-02T00:00:00.000Z",
    "vendorNotifiedDate": "2019-04-03T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1081",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10874",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1081/ranges"
            },
            {
                "rel": "reference",
                "href": "https://fgsec.net/author/felipegaspar/",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://fgsec.net/from-csrf-to-rce-bolt-cms/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bolt/bolt/pull/7768/commits/91187aef36363a870d60b0a3c1bf8507af34c9e4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bolt/bolt/releases/tag/v3.6.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1081/default-remediation-status"
            }
        ]
    }
}