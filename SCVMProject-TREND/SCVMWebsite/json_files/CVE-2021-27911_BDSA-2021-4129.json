{
    "source": "BDSA",
    "name": "BDSA-2021-4129",
    "title": "Mautic Vulnerable to Cross-Site Scripting (XSS) via Contact View",
    "description": "Mautic is vulnerable to cross-site scripting (XSS) due to improper validation of user supplied input in the 'Contact Name' field. An attacker can inject script code in to a 'Contact Name' so that when the vulnerability is triggered, sensitive information can be stolen such as authentication tokens and session cookies. An attacker must have editing permissions in order for this attack to be successful.",
    "technicalDescription": "The vulnerability exists in the file `app/bundles/LeadBundle/Views/Lead/lead.html.php` and contains insufficient sanitization for `'%name%' => $lead->getPrimaryIdentifier()`. \n\nA Contact can be added from multiple sources in addition to the user interface (UI) such as 3rd party syncing and other forms. An attacker could trick an authenticated user into syncing a contact from a specific source that contains malicious scripts in the contact name field. This vulnerability can be triggered when a user hovers over the Campaign's button from the action menu whilst viewing a contact's details.\n\nThis vulnerability was fixed by adding correct validation and escaping of characters.",
    "publishedDate": "2022-02-22T15:31:50.875Z",
    "updatedDate": "2022-02-22T15:31:50.855Z",
    "disclosureDate": "2021-08-30T00:00:00.000Z",
    "exploitPublishDate": "2021-08-30T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.3.4**](https://github.com/mautic/mautic/releases/tag/3.3.4) by [this](https://github.com/mautic/mautic/commit/29538f39dd16e2246c93c3a519ba8334a45d5e76) commit.\n* [**4.0.0**](https://github.com/mautic/mautic/releases/tag/4.0.0) by [this](https://github.com/mautic/mautic/commit/28aefd8a2709b3c77d4de4df6a8937104179362b) commit.\n\nThe latest stable releases can be found [here](https://github.com/mautic/mautic/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Hoang Nguyen, Rohit Pavaskar",
    "workaround": "",
    "vendorFixDate": "2021-08-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4129",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-27911",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4129/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/commit/28aefd8a2709b3c77d4de4df6a8937104179362b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/commit/29538f39dd16e2246c93c3a519ba8334a45d5e76",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/commit/29538f39dd16e2246c93c3a519ba8334a45d5e76",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/releases/tag/3.3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/releases/tag/4.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/security/advisories/GHSA-72hm-fx78-xwhc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4129/default-remediation-status"
            }
        ]
    }
}