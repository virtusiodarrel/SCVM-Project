{
    "source": "BDSA",
    "name": "BDSA-2021-2523",
    "title": "Dolibarr Vulnerable to Account Takeover via Insecure Password Reset Functionality",
    "description": "Dolibarr is vulnerable to account takeovers due to flaws in its password reset feature. A remote authenticated attacker could reset the password of a victim user by providing that victim's login name, via a malicious GET request, to the password reset interface. The attacker could then proceed to access the victim's account.",
    "technicalDescription": "The code that is contained in the file `htdocs/user/passwordforgotten.php` is used to implement Dolibarr's password reset functionality. The code that performs the password reset operation initially creates a new instance of the `User` class, `$edituser`, and then calls the object's `fetch()` method in order to load a user from the back-end database. This user is the target of the password change operation. The application then proceeds to call the `setPassword()` method of the `User` class in order to change the password of the loaded user. \n\nThe user name that is passed to `fetch()`  is derived from the `username` GET request parameter. No validation is performed on the value that is provided. An attacker could therefore send a maliciously crafted GET request to the application in order to reset the password of the user that is named in that request. The attacker could then proceed to log in to the victim's account.",
    "publishedDate": "2021-08-19T15:55:51.044Z",
    "updatedDate": "2021-08-19T15:55:51.030Z",
    "disclosureDate": "2021-07-05T00:00:00.000Z",
    "solution": "Fixed in version [**14.0.0**](https://github.com/Dolibarr/dolibarr/releases/tag/14.0.0) by [this](https://github.com/Dolibarr/dolibarr/commit/87f9530272925f0d651f59337a35661faeb6f377) commit.\n\nThe latest stable releases can be found [here](https://github.com/Dolibarr/dolibarr/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ahsan Aziz",
    "workaround": "",
    "vendorFixDate": "2021-07-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2523",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-640"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-25957",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2523/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/commit/87f9530272925f0d651f59337a35661faeb6f377",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/commit/87f9530272925f0d651f59337a35661faeb6f377",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/releases/tag/14.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2523/default-remediation-status"
            }
        ]
    }
}