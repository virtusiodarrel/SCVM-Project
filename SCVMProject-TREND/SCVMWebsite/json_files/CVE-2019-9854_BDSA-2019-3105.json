{
    "source": "BDSA",
    "name": "BDSA-2019-3105",
    "title": "Libreoffice Vulnerable to Directory Traversal Protection Bypass via Unsafe URL Assembly",
    "description": "Libreoffice is vulnerable to a directory traversal issue. This could allow an attacker to access scripts in arbitrary locations on the file system, possibly leading to local code execution.",
    "technicalDescription": "Instead of restricting the place that scripts can be loaded from to `share/Scripts/python` or `user/Scripts/python`, using URL encoding an attacker is able to bypass Libreoffice's path verification. This is due to it assembling the location from the unsanitized path which is passed in, rather than the sanitized path created as an output of the path verification step.\n\nAn attacker can use this to load scripts to be executed with the permissions of the current user from anywhere on the file system, potentially allowing for local code execution.",
    "publishedDate": "2019-11-27T16:03:15.435Z",
    "updatedDate": "2020-04-06T15:06:28.934Z",
    "disclosureDate": "2019-09-06T00:00:00.000Z",
    "solution": "Fixed in [**6.2.7.1**](https://github.com/LibreOffice/core/releases/tag/libreoffice-6.2.7.1) by the following commits:\n* [Commit 1](https://gerrit.libreoffice.org/c/core/+/61957)\n* [Commit 2](https://gerrit.libreoffice.org/c/core/+/76396)\n* [Commit 3](https://gerrit.libreoffice.org/c/core/+/77377)\n\nFixed in [**6.3.1.1**](https://github.com/LibreOffice/core/releases/tag/libreoffice-6.3.1.1) by the following commits:\n* [Commit 1](https://gerrit.libreoffice.org/c/core/+/61957)\n* [Commit 2](https://gerrit.libreoffice.org/c/core/+/76395)\n* [Commit 3](https://gerrit.libreoffice.org/c/core/+/77379)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-08-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3105",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-177"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9854",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3105/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/commit/7942929685fafb0f9c82feb8da7279e5103c87f0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/commit/87959e5deea6d33cd35dbb3b8423056f9566710e#diff-5306ca8749983031c34ab289ee5ccb43",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/commit/87d36feab5ce4b45798b0b80abe566fc7960d194",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/releases/tag/libreoffice-6.2.7.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/releases/tag/libreoffice-6.3.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.libreoffice.org/about-us/security/advisories/CVE-2019-9852",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.libreoffice.org/about-us/security/advisories/cve-2018-16858/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.libreoffice.org/about-us/security/advisories/cve-2019-9854/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3105/default-remediation-status"
            }
        ]
    }
}