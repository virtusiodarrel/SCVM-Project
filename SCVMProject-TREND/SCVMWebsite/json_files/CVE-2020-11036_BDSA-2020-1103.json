{
    "source": "BDSA",
    "name": "BDSA-2020-1103",
    "title": "GLPI Vulnerable to Stored Cross-Site Scripting (XSS) via Knowledge Base and Tickets",
    "description": "GLPI (Open Source IT Equipment Manager) is vulnerable to stored cross-site scripting (XSS) in multiple locations due to improper validation of user-supplied input. This could allow an attacker to inject arbitrary web scripts and obtain sensitive information such as authentication tokens and user session cookies.",
    "technicalDescription": "Stored XSS exists in the comments of items in the Knowledge base. This is due to the fact that the anti-XSS protection is removed via function `unclean_cross_side_scripting_deep` before displaying comments in the file `/inc/knowbaseitem_comment.class.php`.\n\nAnother stored XSS is in the ticketing system and requires a low-privileged user account to be exploited. An attacker would then change their surname to an arbitrary malicious JavaScript code, delete their first name and open a new ticket. The script would execute as soon as another privileged user opened the ticket. This vulnerability is possible because the anti-XSS `clean_cross_side_scripting_deep` function used here only prevents the opening/closing of tags, but in this case the JavaScript code is being embedded directly in the tag showing who made the last ticket update.\n\nIt is also worth noting that once navigated to `Setup -> General -> System menu` the `User-Agent` HTTP header is displayed back to the user without any filtering, but this is not exploitable unless chained with some other vulnerabilities.",
    "publishedDate": "2020-05-13T14:27:42.576Z",
    "updatedDate": "2020-05-13T14:27:42.571Z",
    "disclosureDate": "2020-05-12T00:00:00.000Z",
    "exploitPublishDate": "2020-05-12T00:00:00.000Z",
    "solution": "Fixed in [**9.4.6**](https://github.com/glpi-project/glpi/releases/tag/9.4.6) by the following commits:\n* [Commit 1](https://github.com/glpi-project/glpi/commit/01189af2c1d64753719eafae15bb35f20cea759b)\n* [Commit 2](https://github.com/glpi-project/glpi/commit/d45ae18626b8b52c93c101e617318d49ae05d8b3)\n* [Commit 3](https://github.com/glpi-project/glpi/commit/6dc5cb685616f6f1ae3b484cebc818fbb9cc6ccd)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-03-04T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1103",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11036",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1103/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/commit/01189af2c1d64753719eafae15bb35f20cea759b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/commit/6dc5cb685616f6f1ae3b484cebc818fbb9cc6ccd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/commit/d45ae18626b8b52c93c101e617318d49ae05d8b3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/releases/tag/9.4.6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/releases/tag/9.4.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/security/advisories/GHSA-3g3h-rwhr-7385",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://offsec.almond.consulting/multiple-vulnerabilities-in-glpi.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://offsec.almond.consulting/multiple-vulnerabilities-in-glpi.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1103/default-remediation-status"
            }
        ]
    }
}