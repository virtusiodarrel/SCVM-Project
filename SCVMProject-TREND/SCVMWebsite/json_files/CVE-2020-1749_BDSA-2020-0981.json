{
    "source": "BDSA",
    "name": "BDSA-2020-0981",
    "title": "Linux Kernel Vulnerable to Man-in-the-Middle Attacks via Unencrypted Communication over IPsec Tunnels",
    "description": "The Linux kernel is vulnerable to man-in-the-middle attacks due to improper processing of communications over IPsec tunnels. This could allow an attacker to intercept unencrypted traffic and obtain or modify sensitive information.",
    "technicalDescription": "The function `ip6_dst_lookup()` is inappropriately used to perform IPv6 lookups in other modules, rather than the function `ipv6_dst_lookup_flow()` which also operates on the XFRM layer of the IPsec protocol. This can result in data not being routed properly and being sent unencrypted rather than over an encrypted link when the IPsec tunnel is established.\n\nUsers are only affected by this issue if the IPv6 protocol is in use.",
    "publishedDate": "2020-05-01T15:37:24.203Z",
    "updatedDate": "2020-07-07T09:14:34.923Z",
    "disclosureDate": "2020-03-04T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.16.83**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b9f3e457098ea76f2d69bfc369bae1fd0cf2a6e5) commit\n* [**4.4.224**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7c9d04e1c3ed58f60592329459d9ca7789442ff7) commit\n* [**4.9.224**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=badbe56cb62faabe946fed8d7e8a25c009a95e3b) commit\n* [**4.14.181**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8ab8786f78c3fc930f9abf6d6d85e95567de4e1f) commit\n* [**4.19.119**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=5dd6835278454a7c7a045462253625de7c16b13e) commit\n* [**5.3.18**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fe0cacb0f518d76cf4a71322a464eb0713969318) commit\n* [**5.4.5**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=48d58ae9e87aaa11814364ddb52b3461f9abac57) commit\n* [**5.5-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6c8991f41546c3c472503dff1ea9daaddf9331c2) commit",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.5
        },
        "vector": "(AV:A/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Xiumei Mu (Red Hat QE Engineering)",
    "workaround": "",
    "vendorFixDate": "2019-12-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0981",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-311"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-1749",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0981/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1809833",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/?id=5f81bd2e5d804ca93f3ec8873451b22d2f454721",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=48d58ae9e87aaa11814364ddb52b3461f9abac57",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=5dd6835278454a7c7a045462253625de7c16b13e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6c8991f41546c3c472503dff1ea9daaddf9331c2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b9f3e457098ea76f2d69bfc369bae1fd0cf2a6e5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fe0cacb0f518d76cf4a71322a464eb0713969318",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0981/default-remediation-status"
            }
        ]
    }
}