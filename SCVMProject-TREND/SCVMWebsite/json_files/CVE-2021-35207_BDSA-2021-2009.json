{
    "source": "BDSA",
    "name": "BDSA-2021-2009",
    "title": "Zimbra Web Client Vulnerable to Cross-Site Scripting (XSS) via 'loginErrorCode' Parameter",
    "description": "Zimbra Web Client is vulnerable to cross-site scripting (XSS) due to the insufficient validation of client-provided input parameters. An attacker could execute malicious scripts in the browser of a victim by tricking them into clicking on a crafted link. This could allow the attacker to obtain sensitive information, such as browser cookies.",
    "technicalDescription": "The scripts `WebRoot/public/hostedlogin.jsp` and `WebRoot/public/login.jsp` are used to dynamically generate HTML content using data which has been extracted from the client's request. The `param` variable is used to store the request parameters. Both of the aforementioned scripts can utilize the `loginErrorCode` request parameter. If the value of the `loginOp` parameter is equal to `relogin`, then the value of the `loginErrorCode` parameter will be inserted into the HTML. \n\nNo validation or sanitization is performed on the value of `loginErrorCode` prior to its inclusion in the dynamically generated content. If it constitutes an XSS payload, then this payload will be executed within the browser of the client whenever the content is rendered. An attacker could therefore conduct XSS attacks by tricking a victim into clicking on a crafted link in which a malicious `loginErrorCode` parameter has been specified. This could allow the attacker to obtain sensitive information, such as browser cookies.",
    "publishedDate": "2021-07-05T12:19:36.111Z",
    "updatedDate": "2021-07-05T12:19:36.105Z",
    "disclosureDate": "2021-06-10T00:00:00.000Z",
    "solution": "Fixed in [**8.8.15-p23**](https://github.com/Zimbra/zm-web-client/releases/tag/8.8.15.p23) by [this](https://github.com/Zimbra/zm-web-client/commit/bc8445fdfd192a3388e82e11a0c901f02a9c9ebc) commit, and in [**9.0.0-p16**](https://github.com/Zimbra/zm-web-client/releases/tag/9.0.0.p16) by [this](https://github.com/Zimbra/zm-web-client/commit/84020324f0ae820bd8cf73570ccb7488e8f91301) commit.\n\nThe latest stable releases are available [here](https://github.com/Zimbra/zm-web-client/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-06-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2009",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-35207",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2009/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-web-client/commit/84020324f0ae820bd8cf73570ccb7488e8f91301",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-web-client/commit/bc8445fdfd192a3388e82e11a0c901f02a9c9ebc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-web-client/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-web-client/releases/tag/8.8.15.p23",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-web-client/releases/tag/9.0.0.p16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://wiki.zimbra.com/wiki/Security_Center",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2009/default-remediation-status"
            }
        ]
    }
}