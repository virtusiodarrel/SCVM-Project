{
    "source": "BDSA",
    "name": "BDSA-2019-1457",
    "title": "TYPO3 Vulnerable to Remote Code Execution (RCE) via Image Processing Module",
    "description": "TYPO3 is vulnerable to remote code execution (RCE) due to a flawed implementation of the image processing module. Under certain circumstances an attacker could leverage this flaw by supplying an image file containing PostScript code in order to run arbitrary code on the underlying host.",
    "technicalDescription": "TYPO3 uses ImageMagick (or GraphicsMagick) for image processing. Whenever the image processing module is invoked in order to convert data the mime-type of the source file is identified for invoking necessary coders required to read the data. This type guessing based on mime-type and internal file content checks may allow an attacker to trick the application into executing arbitrary code on the target host by supplying an image file containing PostScript code.\n\nFor exploitation to be possible the following preconditions must be met:\n\n* GhostScript binary `gs` has to be available on the target system.\n* ImageMagick `policy.xml` settings cannot restrict PDF, PostScript, and other related formats.\n* The attacker requires either a valid backend user account with access to `filelist` module, or a frontend application that allows file upload and preview without file mime-type validation.",
    "publishedDate": "2019-05-10T12:14:44.259Z",
    "updatedDate": "2020-07-28T14:35:36.143Z",
    "disclosureDate": "2019-05-07T00:00:00.000Z",
    "exploitPublishDate": "2019-05-09T00:00:00.000Z",
    "solution": "Fixed in:\n* [**8.7.25**](https://github.com/TYPO3/TYPO3.CMS/releases/tag/8.7.25) by [this](https://github.com/TYPO3/TYPO3.CMS/commit/51fdb774a57ee30e8d60c0e33b4a0b92d775739e) commit, and\n* [**9.5.6**](https://github.com/TYPO3/TYPO3.CMS/releases/tag/v9.5.6) by [this](https://github.com/TYPO3/TYPO3.CMS/commit/2c04eeac44733fda491f92c697f88c1337d19c79) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Lauritz Holtmann",
    "workaround": "ImageMagick `policy.xml` settings can be used to disable potentially dangerous file types. Refer to [this](https://imagemagick.org/script/security-policy.php) document. However, please note that restricting certain file types may break some critical functionality in your application.",
    "vendorFixDate": "2019-05-07T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1457",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-241"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11832",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1457/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/commit/2c04eeac44733fda491f92c697f88c1337d19c79",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/commit/51fdb774a57ee30e8d60c0e33b4a0b92d775739e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/releases/tag/8.7.25",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/releases/tag/v9.5.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://imagemagick.org/script/security-policy.php",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://security.lauritz-holtmann.de/advisories/cve-2019-11832/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-core-sa-2019-012/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1457/default-remediation-status"
            }
        ]
    }
}