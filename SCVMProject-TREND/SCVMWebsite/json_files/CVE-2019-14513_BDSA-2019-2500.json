{
    "source": "BDSA",
    "name": "BDSA-2019-2500",
    "title": "Dnsmasq Vulnerable to Denial-of-Service (DoS) via Buffer Over-Read in 'do_doctor()' Function",
    "description": "Dnsmasq is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause a victim's instance of the application to crash by tricking them into connecting to a malicious DNS server.",
    "technicalDescription": "The function `do_doctor()`, which is defined within the script `rfc1035.c`, is used by the Dnsmasq application to process the answer records contained in a DNS response. This function uses the variable `p` to store a pointer into the answer record data in memory. This pointer is incremented by 4 prior to the record processing routine, in order to bypass the time-to-live section. The function then uses loop operations to read through and parse the answer records, until bytes are encountered that signal that the end of a record has been reached. However, if the application receives a response that is larger than 4096 bytes, that response will be truncated. This can lead to the termination bytes being removed, and so the pointer will be incremented to point to a memory location outside of the buffer that stores the answer record data. Such an out-of-bounds read event could cause an exception to be raised, halting program execution. An attacker could therefore cause a DoS by hosting a malicious DNS server that will produce DNS responses that are greater than 4096 bytes, which will trigger the aforementioned out-of-bounds read event when processed by a victim's instance of Dnsmasq.",
    "publishedDate": "2019-08-09T08:29:07.772Z",
    "updatedDate": "2019-08-09T08:29:07.763Z",
    "disclosureDate": "2019-08-01T00:00:00.000Z",
    "exploitPublishDate": "2019-08-01T00:00:00.000Z",
    "solution": "Fixed in version [**2.76**](https://github.com/imp/dnsmasq/releases/tag/v2.76).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2016-05-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2500",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14513",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2500/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Slovejoy/dnsmasq-pre2.76",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Slovejoy/dnsmasq-pre2.76",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/imp/dnsmasq/releases/tag/v2.76",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2500/default-remediation-status"
            }
        ]
    }
}