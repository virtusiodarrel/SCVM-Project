{
    "source": "BDSA",
    "name": "BDSA-2018-5088",
    "title": "libpcap Vulnerable to Denial-of-Service (DoS) via Improper Payload Length Handling in 'daemon_msg_findallif_req()' Function",
    "description": "libpcap is vulnerable to denial-of-service (DoS) due to the improper management of variables. A remote attacker could cause a victim's instance of the application to crash by sending a request containing unexpected data.",
    "technicalDescription": "The function `daemon_msg_findallif_req()`, which is defined within the script `daemon.c`, contains code that is used to construct replies to client requests. One of the parameters accepted by this function is `plen`, which corresponds to the length of the received request. One of the first actions that is performed by this function is to discard any unnecessary payload data from the request. This is performed by calling the function `rpcapd_discard()`. After this has been called, the value of `plen` is assumed to be zero. \n\nThe function then proceeds to create and fill the memory buffer that contains the data that constitutes the reply to the request. The variable `plen` is used to store this buffer's size. The value of `plen` is incremented every time data is to be added to the buffer containing the reply. However, it is possible for the application to receive a request that has extra content such that `plen` will not have a value of zero following the evaluation of `rpcapd_discard()`. This will lead to a discrepancy between the actual size of the reply data buffer and `plen`, which can cause errors that will halt program execution. An attacker could therefore cause a DoS by sending crafted request packets which contain extra unexpected data and will thus lead to `plen` unexpectedly having a value greater than zero.",
    "publishedDate": "2019-10-14T14:17:40.219Z",
    "updatedDate": "2019-10-14T14:17:40.206Z",
    "disclosureDate": "2018-08-06T00:00:00.000Z",
    "solution": "Fixed in version [**1.9.1**](https://github.com/the-tcpdump-group/libpcap/releases/tag/libpcap-1.9.1) by [this](https://github.com/the-tcpdump-group/libpcap/commit/617b12c0339db4891d117b661982126c495439ea) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-08-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-5088",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-130"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-15161",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-5088/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/blob/libpcap-1.9/CHANGES",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/commit/617b12c0339db4891d117b661982126c495439ea",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/releases/tag/libpcap-1.9.1",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}