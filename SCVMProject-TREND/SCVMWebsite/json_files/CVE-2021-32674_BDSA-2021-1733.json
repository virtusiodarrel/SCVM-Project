{
    "source": "BDSA",
    "name": "BDSA-2021-1733",
    "title": "Zope Vulnerable to Remote Code Execution (RCE) via Authorized Python Modules Path Traversal in TAL Expressions",
    "description": "Zope is vulnerable to remote code execution (RCE) due to lack of sufficient validation when handling TAL expressions in the page template functionality which allows for path traversal.\n\nA remote attacker with the 'Manager' role could abuse the path traversal flaw in order to execute arbitrary code. Sites that allow untrusted users to access this functionality are most at risk.\n\n**Note:** This vulnerability exists due to an incomplete fix for **CVE-2021-32633** (**BDSA-2021-1546**).",
    "technicalDescription": "Zope is vulnerable to remote code execution (RCE) because the TAL expression functionality does not sufficiently protect against path traversal attempts. Some Python modules, including authorized ones, can be used in TAL expressions to access system files which could be abused to run arbitrary code.\n\nBy default, an attacker is required to have the 'Manager' role in order to add or edit Zope Page Templates through the web.\n\n**Note**: The TAL expression path traversal issue that can lead to remote code execution (RCE) was disclosed by the vendor [here](https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36), and was assigned **CVE-2021-32633** (**BDSA-2021-1546**). Patches were released as part of versions **5.2** and **4.6**. \nLater, [this](https://github.com/zopefoundation/Zope/security/advisories/GHSA-rpcg-f9q6-2mq6) advisory was published and assigned **CVE-2021-32674** to cover additional cases of TAL expression traversal vulnerabilities that were missed.",
    "publishedDate": "2021-06-11T13:33:57.238Z",
    "updatedDate": "2021-11-30T12:29:24.595Z",
    "disclosureDate": "2021-06-08T00:00:00.000Z",
    "exploitPublishDate": "2021-05-27T00:00:00.000Z",
    "solution": "Fixed in [**5.2.1**](https://github.com/zopefoundation/Zope/releases/tag/5.2.1) by [this](https://github.com/zopefoundation/Zope/commit/1f8456bf1f908ea46012537d52bd7e752a532c91) commit and [this](https://github.com/zopefoundation/Zope/commit/1d897910139e2c0b11984fc9b78c1da1365bec21) commit.\n\nFixed in [**4.6.1**](https://github.com/zopefoundation/Zope/releases/tag/4.6.1) by [this](https://github.com/zopefoundation/Zope/commit/e98d326326e36e8dddc53251e2ac9bfb3fcbe397) commit and [this](https://github.com/zopefoundation/Zope/commit/8af277ee3c1856b6b85a144555bff55c2a5688ff) commit.\n\nThe latest stable releases are available [here](https://github.com/zopefoundation/Zope/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated [here](https://github.com/zopefoundation/Zope/security/advisories/GHSA-rpcg-f9q6-2mq6) that the ability to add or edit Zope Page Templates through the web should be restricted to trusted users by using the standard Zope user / role permission mechanisms.",
    "vendorFixDate": "2021-06-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1733",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32674",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1733/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cyllective.com/blog/post/plone-authenticated-rce-cve-2021-32633/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/commit/1d897910139e2c0b11984fc9b78c1da1365bec21",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/commit/1f8456bf1f908ea46012537d52bd7e752a532c91",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/commit/8af277ee3c1856b6b85a144555bff55c2a5688ff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/commit/e98d326326e36e8dddc53251e2ac9bfb3fcbe397",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/releases/tag/4.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/releases/tag/5.2.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/security/advisories/GHSA-rpcg-f9q6-2mq6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/security/advisories/GHSA-rpcg-f9q6-2mq6",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://pypi.org/project/Zope/#id80",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1733/default-remediation-status"
            }
        ]
    }
}