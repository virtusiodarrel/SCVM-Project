{
    "source": "BDSA",
    "name": "BDSA-2022-2214",
    "title": "Cockpit Vulnerable to Insufficient Session Expiration via Lack of Request Validation after Password Change",
    "description": "Cockpit does not sufficiently validate requests after a password change operation, thus causing insufficient session expiration. An attacker who has captured a valid password change request can leverage this flaw to update a user account's details. This could enable the attacker to take over the user account.",
    "technicalDescription": "As specified in the PoC, an attacker will need to capture a password change request in order to exploit this vulnerability. Once it's captured, the attacker can use this request to update the details for the relevant user account. Even though the application will return a `401: Unauthorized Request` response, the details will still be updated. This can lead to the attacker taking over the user account. As suggested in the PoC, an attacker can exploit this vulnerability to compromise an admin account and execute malicious actions.\n\nThis vulnerability has been mitigated in the `lib/Lime/App.php` file by stopping the regular execution flow after a redirection operation has taken place.",
    "publishedDate": "2022-08-30T11:56:57.691Z",
    "updatedDate": "2022-08-30T11:56:57.680Z",
    "disclosureDate": "2022-08-08T00:00:00.000Z",
    "exploitPublishDate": "2022-08-08T00:00:00.000Z",
    "solution": "Fixed in version [**2.2.0**](https://github.com/Cockpit-HQ/Cockpit/releases/tag/2.2.0) by [this](https://github.com/cockpit-hq/cockpit/commit/dd8d0314912fa6517ebd2cc9939d9fafbe68731b) commit.\n\nThe latest stable releases can be found [here](https://github.com/Cockpit-HQ/Cockpit/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "whoisshuvam",
    "workaround": "",
    "vendorFixDate": "2022-08-08T00:00:00.000Z",
    "vendorNotifiedDate": "2022-08-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2214",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-613"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-2713",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2214/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Cockpit-HQ/Cockpit/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Cockpit-HQ/Cockpit/releases/tag/2.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cockpit-hq/cockpit/commit/dd8d0314912fa6517ebd2cc9939d9fafbe68731b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/3080fc96-75d7-4868-84de-9fc8c9b90290/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/3080fc96-75d7-4868-84de-9fc8c9b90290/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2214/default-remediation-status"
            }
        ]
    }
}