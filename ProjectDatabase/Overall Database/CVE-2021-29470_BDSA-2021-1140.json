{
    "source": "BDSA",
    "name": "BDSA-2021-1140",
    "title": "Exiv2 Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Read in 'jp2image.cpp' File",
    "description": "Exiv2 contains an out-of-bounds read vulnerability because of a lack of appropriate bounds checking. An attacker could exploit this flaw to cause a denial-of-service (DoS).",
    "technicalDescription": "This vulnerability exists in the `src/jp2image.cpp` file. The `encodeJp2Header()` function does not have appropriate size checking for `Jp2BoxHeader` and `length` before they are used to initialize other elements.  This can cause an out-of-bounds read condition when the application is handling a crafted image file. An attacker could supply such a crafted file and crash the application when it is writing metadata to this file. For this attack to work, the attacker must trick the victim to use this crafted image file for writing metadata. Also, the victim must use special command-line arguments like `insert` to trigger this vulnerability.\n\n**Note** This vulnerability is only triggered for write operations and not read operations on image files.",
    "publishedDate": "2021-04-26T15:57:44.258Z",
    "updatedDate": "2021-11-30T15:09:46.781Z",
    "disclosureDate": "2021-04-23T00:00:00.000Z",
    "solution": "Fixed in the **main** branch by [this](https://github.com/Exiv2/exiv2/commit/b3de96f4b4408347bed57e625963720e8d0dd2ea) commit which is not yet included in any release.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "zz of NSFOCUS Security Team and giantbranch of NSFOCUS Security Team",
    "workaround": "",
    "vendorFixDate": "2021-04-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1140",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-29470",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1140/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/commit/b3de96f4b4408347bed57e625963720e8d0dd2ea",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/security/advisories/GHSA-8949-hhfh-j7rj",
                "label": "ADVISORY"
            }
        ]
    }
}