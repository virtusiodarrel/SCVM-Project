{
    "source": "BDSA",
    "name": "BDSA-2022-0501",
    "title": "Linux Kernel Vulnerable to Information Exposure via Insufficient 'RNDIS_MSG_SET' Command Validation",
    "description": "The Linux kernel is vulnerable to information exposure due to the insufficient validation of data that is derived from user input. A local attacker could potentially recover sensitive data from memory by submitting maliciously crafted `RNDIS_MSG_SET ` commands.",
    "technicalDescription": "The function `rndis_set_response()`, of file `drivers/usb/gadget/function/rndis.c`, is used to handle `RNDIS_MSG_SET ` RNDIS control messages. This function performs arithmetic on a pointer so that data which is stored in the `buf` buffer can be processed. This arithmetic involves adding eight to this pointer, as well as the user-controlled offset value `BufOffset`. The value of `BufOffset` is not validated prior to this. An attacker can leverage this issue in order to extract the contents of kernel memory. This may allow the attacker to obtain sensitive data, including information that may assist the attacker in further exploiting the system.",
    "publishedDate": "2022-02-21T16:54:11.660Z",
    "updatedDate": "2022-02-21T16:54:11.642Z",
    "disclosureDate": "2022-02-11T00:00:00.000Z",
    "exploitPublishDate": "2022-02-17T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.9.302**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ff0a90739925734c91c7e39befe3f4378e0c1369) commit\n* [**4.14.267**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4c22fbcef778badb00fb8bb9f409daa29811c175) commit\n* [**4.19.230**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=db9aaa3026298d652e98f777bc0f5756e2455dda) commit\n* [**5.4.180**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c9e952871ae47af784b4aef0a77db02e557074d6) commit\n* [**5.10.101**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fb4ff0f96de37c44236598e8b53fe43b1df36bf3) commit\n* [**5.15.24**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2da3b0ab54fb7f4d7c5a82757246d0ee33a47197) commit\n* [**5.16.10**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2724ebafda0a8df08a9cb91557d33226bee80f7b) commit\n* [**5.17-rc4**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=38ea1eac7d88072bbffb630e2b3db83ca649b826) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-02-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.0,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-0501",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2022-25375",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-0501/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.16.10",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2724ebafda0a8df08a9cb91557d33226bee80f7b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2da3b0ab54fb7f4d7c5a82757246d0ee33a47197",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=38ea1eac7d88072bbffb630e2b3db83ca649b826",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4c22fbcef778badb00fb8bb9f409daa29811c175",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c9e952871ae47af784b4aef0a77db02e557074d6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=db9aaa3026298d652e98f777bc0f5756e2455dda",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fb4ff0f96de37c44236598e8b53fe43b1df36bf3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ff0a90739925734c91c7e39befe3f4378e0c1369",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=38ea1eac7d88072bbffb630e2b3db83ca649b826",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/szymonh/rndis-co",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}