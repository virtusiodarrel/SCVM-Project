{
    "source": "BDSA",
    "name": "BDSA-2021-0988",
    "title": "Zulip Server Vulnerable to Authorization Bypass via Private Stream Messages",
    "description": "Zulip Server is vulnerable to authorization bypass due to improper handling of messages sent by outgoing webhooks to private streams. This could allow an attacker to send arbitrary messages to private streams when they would otherwise not be allowed to.",
    "technicalDescription": "The issue exists within the file `zerver/lib/actions.py`. Insufficient stream access checks are applied when messages are sent by outgoing webhook bots, which could allow an attacker to send authorized messages if they have access to a bot's API key.",
    "publishedDate": "2021-04-16T15:32:30.937Z",
    "updatedDate": "2021-04-16T15:32:30.933Z",
    "disclosureDate": "2021-04-14T00:00:00.000Z",
    "solution": "Fixed in [**3.4**](https://github.com/zulip/zulip/releases/tag/3.4) by [this](https://github.com/zulip/zulip/commit/ba403e0bffa6899c5527f139ef03e7ea5c829087) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0988",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-30477",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0988/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.zulip.com/2021/04/14/zulip-server-3-4/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zulip/zulip/commit/ba403e0bffa6899c5527f139ef03e7ea5c829087",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zulip/zulip/releases/tag/3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0988/default-remediation-status"
            }
        ]
    }
}