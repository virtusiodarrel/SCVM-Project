{
    "source": "BDSA",
    "name": "BDSA-2019-3077",
    "title": "Gitlab Vulnerable to Information Disclosure via Arbitrary Server References in Embedded Image and Media Markdown",
    "description": "Gitlab contains an information disclosure vulnerability. An attacker could exploit this by embedding images in markdown that point to an arbitrary server that stores the users IP addresses when accessing the files.",
    "technicalDescription": "The vulnerability exists due to public facing instances of Gitlab allowing users to reference media like images or videos in issues and comments sections to external servers. Therefore when the users request the files that are located on external servers their IP addresses could be exposed and logged by the external server. \n\nThe issue was can be mitigated by configuring an asset proxy server.",
    "publishedDate": "2019-09-26T09:30:12.196Z",
    "updatedDate": "2019-09-26T09:30:12.186Z",
    "disclosureDate": "2019-08-29T00:00:00.000Z",
    "solution": "Upgrading to the latest version **does not** fix the vulnerability. This vulnerability can be mitigated by implementing an asset proxy, details of which is included in [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/b59176875532f41c1bfc303f5e8fc38d5eb1e271) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "@iframe",
    "workaround": "GitLab can be configured to use an asset proxy server when requesting external images or videos in\nissues and comments. This helps ensure that malicious images do not expose the user's IP address when they are fetched.",
    "vendorFixDate": "2019-09-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3077",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15726",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3077/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/2019/08/29/security-release-gitlab-12-dot-2-dot-3-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/b59176875532f41c1bfc303f5e8fc38d5eb1e271",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3077/default-remediation-status"
            }
        ]
    }
}