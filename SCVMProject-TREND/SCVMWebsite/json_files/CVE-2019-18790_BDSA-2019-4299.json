{
    "source": "BDSA",
    "name": "BDSA-2019-4299",
    "title": "Asterisk Vulnerable to Call Hijacking via Specially Crafted SIP Request Changing the IP of a Peer",
    "description": "Asterisk is vulnerable to an unauthenticated SIP request changing the IP address of a peer. A remote attacker could leverage this to cause a denial-of-service (DoS) or hijack a call.",
    "technicalDescription": "It is possible for a remote attacker to issue a SIP request that will change the SIP peers IP address without a `REGISTER` occurring. This could allow the attacker to hijack a call if they know only the peer's name. Authentication details are not required for the attack to be performed. The \u201cnat\u201d option needs to be set to the default, or \u201cauto_force_rport\u201d for this vulnerability to be exploitable.",
    "publishedDate": "2020-03-13T15:54:58.806Z",
    "updatedDate": "2021-09-21T10:31:31.319Z",
    "disclosureDate": "2019-11-21T00:00:00.000Z",
    "exploitPublishDate": "2019-11-21T00:00:00.000Z",
    "solution": "Fixed in Asterisk Open Source [**13.29.2**](https://github.com/asterisk/asterisk/releases/tag/13.29.2) by [this](http://downloads.asterisk.org/pub/security/AST-2019-006-13.diff) patch.\n\nFixed in Asterisk Open Source [**16.6.2**](https://github.com/asterisk/asterisk/releases/tag/16.6.2) by [this](http://downloads.asterisk.org/pub/security/AST-2019-006-16.diff) patch.\n\nFixed in Asterisk Open Source [**17.0.1**](https://github.com/asterisk/asterisk/releases/tag/17.0.1) by [this](http://downloads.asterisk.org/pub/security/AST-2019-006-17.diff) patch.\n\nFixed in Certified Asterisk [**13.21-cert5**](https://github.com/asterisk/asterisk/releases/tag/certified/13.21-cert5) by [this](http://downloads.asterisk.org/pub/security/AST-2019-006-13.21.diff) patch.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrey V. T.",
    "workaround": "The vendor supplies the following workaround:\n> Using any other option value for \u201cnat\u201d will prevent the attack (such as \u201cnat=no\u201d or \u201cnat=force_rport\u201d), but will need to be tested on an individual basis to ensure that it works for the user\u2019s deployment. On the fixed versions of Asterisk, it will no longer set the address of the peer before authentication is successful when a SIP request comes in.",
    "vendorFixDate": "2019-10-21T00:00:00.000Z",
    "vendorNotifiedDate": "2019-10-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4299",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-288"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-18790",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4299/ranges"
            },
            {
                "rel": "reference",
                "href": "http://downloads.asterisk.org/pub/security/AST-2019-006-13.21.diff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://downloads.asterisk.org/pub/security/AST-2019-006-13.diff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://downloads.asterisk.org/pub/security/AST-2019-006-16.diff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://downloads.asterisk.org/pub/security/AST-2019-006-17.diff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://downloads.digium.com/pub/security/AST-2019-006.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://downloads.digium.com/pub/security/AST-2019-006.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://issues.asterisk.org/jira/browse/ASTERISK-28589",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://issues.asterisk.org/jira/browse/ASTERISK-28589",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4299/default-remediation-status"
            }
        ]
    }
}