{
    "source": "BDSA",
    "name": "BDSA-2020-3596",
    "title": "Gitea Vulnerable to Remote Code Execution (RCE) and Privilege Escalation via 'git hooks' Feature",
    "description": "Gitea is vulnerable to remote code execution (RCE) and privilege escalation. This can allow an authenticated attacker to execute code as the operating system user running the instance.",
    "technicalDescription": "This vulnerability exists if a user is granted the privileges that are required to create git hooks. As there is no restriction on the type of commands that can be executed using git hooks, an attacker can leverage this in order to gain remote shell access to the system. This can allow an authenticated attacker to execute code as the operating system user running the instance.",
    "publishedDate": "2020-12-01T15:44:51.077Z",
    "updatedDate": "2021-02-22T16:30:06.157Z",
    "disclosureDate": "2020-10-07T00:00:00.000Z",
    "exploitPublishDate": "2020-10-07T00:00:00.000Z",
    "solution": "Fixed in [**1.13.0-rc1**](https://github.com/go-gitea/gitea/releases/tag/v1.13.0-rc1) by [this](https://github.com/go-gitea/gitea/commit/e00e8d8ad391ded1316d9dade4d2542199141be6) commit and [this](https://github.com/go-gitea/gitea/commit/8fe8ab5cbf2977f3a01ea12361df2cd76dce3ea9) commit.\n\nThe latest stable releases are available [here](https://github.com/go-gitea/gitea/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Niklas Goerke",
    "workaround": "Disable git hooks in the config file by setting `DISABLE_GIT_HOOKS = true`",
    "vendorFixDate": "2020-06-18T00:00:00.000Z",
    "vendorNotifiedDate": "2020-06-06T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3596",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-356"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14144",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3596/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/go-gitea/gitea/commit/8fe8ab5cbf2977f3a01ea12361df2cd76dce3ea9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/go-gitea/gitea/commit/e00e8d8ad391ded1316d9dade4d2542199141be6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/go-gitea/gitea/releases/tag/v1.13.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/49571",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-3-schwachstelle-in-gitea-1125-und-gogs-0122-ermoeglicht-ausfuehrung-von-code-nach-authent/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-3-schwachstelle-in-gitea-1125-und-gogs-0122-ermoeglicht-ausfuehrung-von-code-nach-authent/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-3-schwachstelle-in-gitea-1125-und-gogs-0122-ermoeglicht-ausfuehrung-von-code-nach-authent/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3596/default-remediation-status"
            }
        ]
    }
}