{
    "source": "BDSA",
    "name": "BDSA-2020-0559",
    "title": "Apache Traffic Server Vulnerable to HTTP Request Smuggling in HTTP Headers and Scheme Parsing",
    "description": "It was discovered Apache Traffic Server is vulnerable to HTTP request smuggling. Due to insufficient validation in HTTP headers and scheme parsing an attacker could send crafted HTTP requests to perform multiple web based attacks.",
    "technicalDescription": "The vulnerability occurs due to improper input validation in `HTTP headers` via the `http_parser_parse_req()` function in the `proxy/hdrs/HTTP.cc` file and `scheme parsing` via the `url_parse_scheme()` function in the `proxy/hdrs/URL.cc` file. A remote attacker could exploit this flaw using specially crafted HTTP requests allowing them to carry out HTTP request smuggling attacks.",
    "publishedDate": "2020-03-27T16:05:53.588Z",
    "updatedDate": "2020-03-27T16:05:53.580Z",
    "disclosureDate": "2020-03-10T00:00:00.000Z",
    "solution": "Fixed in version [**8.0.6-RC0**](https://github.com/apache/trafficserver/tree/8.0.6-rc0) by [this](https://github.com/apache/trafficserver/commit/ea847adb40bd3f86eba5b604ad4b9025896f5d22) commit and [this](https://github.com/apache/trafficserver/commit/6affb92d8c85896e8b60abb9f684af8109280a0a) commit.\n\nFixed in version [**7.1.9-RC0**](https://github.com/apache/trafficserver/releases/tag/7.1.9-rc0) by [this](https://github.com/apache/trafficserver/commit/bc7d4672471e18eb907c64abe1725ac5fb702926) commit and [this](https://github.com/apache/trafficserver/commit/3b6dc411c2321d55003c6b7151211e3cd51ceb49) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-01-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0559",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-17559",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0559/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/trafficserver/commit/3b6dc411c2321d55003c6b7151211e3cd51ceb49",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/trafficserver/commit/6affb92d8c85896e8b60abb9f684af8109280a0a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/trafficserver/commit/bc7d4672471e18eb907c64abe1725ac5fb702926",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/trafficserver/commit/ea847adb40bd3f86eba5b604ad4b9025896f5d22",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/trafficserver/releases/tag/7.1.9-rc0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/trafficserver/tree/8.0.6-rc0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/r99d18d0bc4daa05e7d0e5a63e0e22701a421b2ef5a8f4f7694c43869%40%3Cannounce.trafficserver.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0559/default-remediation-status"
            }
        ]
    }
}