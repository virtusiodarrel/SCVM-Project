{
    "source": "BDSA",
    "name": "BDSA-2021-2768",
    "title": "libarchive Vulnerable to Privilege Escalation via Unsafe Symlink Handling",
    "description": "libarchive is vulnerable to an improper link resolution flaw due to the incorrect handling of symlinks. A local attacker could provide a malicious archive to a victim user in order to trigger this vulnerability. This could allow the attacker to gain more privileges in a system.\n\n**Note**: This issue affects Linux systems.",
    "technicalDescription": "This vulnerability exists due to some modes, times, access control lists and file flags being set on `archive_write_close()` time. This means that while extracting an archive, an improper link resolution flaw can lead to changing these modes, times, access control lists and file flags outside of the archive. This happens when  a directory entry is marked for post-processing, then a  symlink entry with the same path can replaces the directory with the symlink, and postprocessing will alter the link target instead of the file itself. A local attacker can take advantage of this by providing a malicious archive to a victim user in order to trigger this vulnerability. This could then lead to the attacker gaining higher privileges in the system.\n\nThe vendor has mitigated against this by replacing instances of `chmod()` with `lchmod()`, as well as stripping trailing slashes from the file path in the `_archive_write_disk_close()` function of `libarchive/archive_write_disk_posix.c` in order to ensure that symlinks are not followed.",
    "publishedDate": "2021-09-14T16:00:51.641Z",
    "updatedDate": "2022-09-15T14:46:20.071Z",
    "disclosureDate": "2021-08-22T00:00:00.000Z",
    "solution": "Fixed in [**3.5.2**](https://github.com/libarchive/libarchive/releases/tag/v3.5.2) by [this](https://github.com/libarchive/libarchive/commit/b41daecb5ccb4c8e3b2c53fd6147109fc12c3043) commit.\n\nThe latest stable releases are available [here](https://www.libarchive.org/downloads/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-08-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2768",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-61"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-31566",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2768/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.mageia.org/show_bug.cgi?id=29431",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/commit/b41daecb5ccb4c8e3b2c53fd6147109fc12c3043",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/issues/1566",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/releases/tag/v3.5.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.libarchive.org/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2768/default-remediation-status"
            }
        ]
    }
}