{
    "source": "BDSA",
    "name": "BDSA-2020-2483",
    "title": "Xen Vulnerable to Denial-of-Service (DoS) via 32-Bit Domain Channel Limit Flaw",
    "description": "Xen is vulnerable to a denial-of-service (DoS) condition due to how the 32-bit domain event channel limit is not recorded correctly at domain initialization, and the domain is instead considered to be 64-bit. This limit is not updated accordingly.\n\nAn attacker could cause a denial-of-service by forcing the creation of event channels for 32-bit domains that are servicing other domains. This could lead to corruption of other parts of the shared info structure and affect the stability of the system.",
    "technicalDescription": "Xen is vulnerable to a denial-of-service (DoS) condition because the 2-level event channel model imposes different limits on the number of usable event channels for 32-bit x86 domains vs 64-bit x86 or ARM domains. In this model, 32-bit x86 domains are limited to **1023** channels, whereas all other domains can use up to **4095**.\n\nDuring domain initialization, these domains are all assumed to be 64-bit ones. At the point where domains get recognized as being 32-bit, the channel limit doesn't get updated accordingly. \n\nTherefore, 32-bit domains servicing other domains may observe event channel allocations to succeed when they should actually fail.  Further use of such event channels could then lead to corruption of other parts of the shared info structure.",
    "publishedDate": "2020-09-24T10:11:22.404Z",
    "updatedDate": "2022-02-02T09:27:10.000Z",
    "disclosureDate": "2020-09-22T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.14.1**](http://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=fae6f50c923abcd36267a20e6b20adc1a771084f) by [this](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b8c2efbe7b3e8fa5f0b0a3679afccd1204949070) commit,\n* [**4.13.2**](http://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=470e3aa86da501a2dfe3883ee340b9444bc8bcba) by [this](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e1364e05f92d6c2f12cc77f100cea584354c66cb) commit,\n* [**4.12.4**](http://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=f3be7536cc05514dc29cae2278e27c52d6c045e9) by [this](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b8c9776986968bd1e90835df408f8bfc60640040) commit.\n\nFixed in the following branches by these commits which are not yet included in any release:\n* **staging-4.11** branch by [this](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6e9de083d801104f50a78f5d8e872778a776c682) commit,\n* **staging-4.10** branch by [this](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=8fac37e162bf8c146031583ddc2e7b6bda145f98) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Julien Grall of Amazon",
    "workaround": "The vendor has stated [here](https://xenbits.xen.org/xsa/advisory-342.html), that there is no known workaround for x86 32-bit Domain 0 case.\n\nThe problem can be avoided by reducing the number of event channels available to 32-bit x86 guests to no more than **1023**.  For example, setting `max_event_channels=1023` in the `xl` domain configuration, or\ndeleting any existing setting (since **1023** is the default for`xl`/`libxl`).",
    "vendorFixDate": "2020-09-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2483",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-119"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25600",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2483/ranges"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6e9de083d801104f50a78f5d8e872778a776c682",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=8fac37e162bf8c146031583ddc2e7b6bda145f98",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b8c2efbe7b3e8fa5f0b0a3679afccd1204949070",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b8c9776986968bd1e90835df408f8bfc60640040",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e1364e05f92d6c2f12cc77f100cea584354c66cb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=470e3aa86da501a2dfe3883ee340b9444bc8bcba",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=f3be7536cc05514dc29cae2278e27c52d6c045e9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=fae6f50c923abcd36267a20e6b20adc1a771084f",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-342.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-342.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2483/default-remediation-status"
            }
        ]
    }
}