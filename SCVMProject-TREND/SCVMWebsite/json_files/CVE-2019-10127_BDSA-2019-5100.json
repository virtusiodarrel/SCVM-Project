{
    "source": "BDSA",
    "name": "BDSA-2019-5100",
    "title": "PostgreSQL Vulnerable to Authentication Bypass and Arbitrary Code Execution via ACL Entries",
    "description": "PostgreSQL contains an authentication bypass vulnerability. Successfully exploiting this could allow attackers with low privileges to execute arbitrary code, as well as read and delete arbitrary data directory files.\n\n**Note:** This vulnerability is present in the Windows installer for BigSQL-supplied PostgreSQL.",
    "technicalDescription": "This vulnerability exists due to the Access Control List (ACL) of both the binary installation directory and the data directory not being properly locked down, and keeping the inherited ACL instead. There are two possible attack scenarios:\n* An attacker who has both a Windows account with low privileges and a PostgreSQL account with  low privileges will be able to perform arbitrary code execution with the privileges of the PostgreSQL service account.\n* An attacker who only has a Windows account with low privileges will be able to bypass any restrictions placed on directory files, and can read and delete arbitrary data directory files.",
    "publishedDate": "2021-03-22T11:09:04.552Z",
    "updatedDate": "2022-08-01T09:12:04.825Z",
    "disclosureDate": "2019-05-09T00:00:00.000Z",
    "solution": "Fixed in:\n* [**11.3**](https://git.postgresql.org/gitweb/?p=postgresql.git;a=shortlog;h=refs/tags/REL_11_3),\n* [**10.8**](https://git.postgresql.org/gitweb/?p=postgresql.git;a=shortlog;h=refs/tags/REL_10_8),\n* [**9.6.13**](https://git.postgresql.org/gitweb/?p=postgresql.git;a=shortlog;h=refs/tags/REL9_6_13),\n* [**9.5.17**](https://git.postgresql.org/gitweb/?p=postgresql.git;a=shortlog;h=refs/tags/REL9_5_17),\n* [**9.4.22**](https://git.postgresql.org/gitweb/?p=postgresql.git;a=shortlog;h=refs/tags/REL9_4_22).\n\nThe latest stable releases are available [here](https://www.postgresql.org/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Conner Jones",
    "workaround": "",
    "vendorFixDate": "2019-05-06T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5100",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10127",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5100/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1707098",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.postgresql.org/gitweb/?p=postgresql.git;a=shortlog;h=refs/tags/REL9_4_22",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.postgresql.org/gitweb/?p=postgresql.git;a=shortlog;h=refs/tags/REL9_5_17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.postgresql.org/gitweb/?p=postgresql.git;a=shortlog;h=refs/tags/REL9_6_13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.postgresql.org/gitweb/?p=postgresql.git;a=shortlog;h=refs/tags/REL_10_8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.postgresql.org/gitweb/?p=postgresql.git;a=shortlog;h=refs/tags/REL_11_3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.postgresql.org/about/news/postgresql-113-108-9613-9517-and-9422-released-1939/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.postgresql.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5100/default-remediation-status"
            }
        ]
    }
}