{
    "source": "BDSA",
    "name": "BDSA-2022-1389",
    "title": "Elementor WordPress Plugin Vulnerable to Remote Code Execution (RCE) via Malicious File Upload with Onboarding Module",
    "description": "The Elementor plugin for WordPress is vulnerable to remote code execution (RCE) due to improper authorization of AJAX actions in the onboarding module. This could allow an authenticated attacker to deface a targeted site, or upload malicious files in order to execute code on the server.",
    "technicalDescription": "The issue exists in the function `add_action()` within the file `/core/app/modules/onboarding/module.php`. Missing permissions checks can allow an attacker to access any of the onboarding methods that are processed in this function through `maybe_handle_ajax()`. Calling `upload_and_install_pro()` can allow a crafted plugin including malicious code to be installed and executed.",
    "publishedDate": "2022-05-19T15:20:22.771Z",
    "updatedDate": "2022-05-19T15:20:22.759Z",
    "disclosureDate": "2022-04-12T00:00:00.000Z",
    "exploitPublishDate": "2022-04-19T00:00:00.000Z",
    "solution": "Fixed in version [**3.6.3**](https://wordpress.org/plugins/elementor/advanced/) by [this](https://plugins.trac.wordpress.org/changeset/2708766/elementor/trunk/core/app/modules/onboarding/module.php) changeset.\n\nThe latest stable releases are available [here](https://wordpress.org/plugins/elementor/advanced/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wordfence Threat Intelligence, Plugin Vulnerabilities Team",
    "workaround": "",
    "vendorFixDate": "2022-04-12T00:00:00.000Z",
    "vendorNotifiedDate": "2022-03-29T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1389",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-1329",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1389/ranges"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/166756/wpelementor36-exec.txt",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://plugins.trac.wordpress.org/changeset/2708766/elementor/trunk/core/app/modules/onboarding/module.php",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://wordpress.org/plugins/elementor/advanced/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.pluginvulnerabilities.com/2022/04/12/5-million-install-wordpress-plugin-elementor-contains-authenticated-remote-code-execution-rce-vulnerability/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.wordfence.com/blog/2022/04/elementor-critical-remote-code-execution-vulnerability/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1389/default-remediation-status"
            }
        ]
    }
}