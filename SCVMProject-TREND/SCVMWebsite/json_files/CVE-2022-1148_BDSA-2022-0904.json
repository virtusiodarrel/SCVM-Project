{
    "source": "BDSA",
    "name": "BDSA-2022-0904",
    "title": "Gitlab Vulnerable to Improper Authorization via Reused GitLab Pages Access Tokens",
    "description": "Improper authorization in Gitlab Pages allows an attacker to steal a user's access token via their malicious private Gitlab Pages website. The stolen token can then be reused on the victim's other private websites.",
    "technicalDescription": "The vulnerability is caused by the fact that Gitlab Pages session cookies are not properly validated to ensure that the requested subdomain is the same as the subdomain to which the session cookie was issued for. This could be exploited by the attacker creating a private Gitlab Page site at the root of their user page and only making it available to private collaborators. Once the victim accepts the collaboration request and visits the site, a service worker will be registered for the domain which would intercept the `/auth` endpoint. The script would then trigger OAuth2 authentication via a redirect, which would cause the OAuth2 to automatically redirect the browser back to the attacker's Gitlab page (`/auth` endpoint) with the session token. The request would then be captured by the service worker and sent to the attacker's controlled website.",
    "publishedDate": "2022-04-06T08:59:44.169Z",
    "updatedDate": "2022-07-15T15:56:14.269Z",
    "disclosureDate": "2022-03-31T00:00:00.000Z",
    "exploitPublishDate": "2022-06-08T00:00:00.000Z",
    "solution": "Fixed in:\n* [**14.9.2**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.9.2) by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/79709cabf71a57a336f490636a7e32a208fe0229) commit.\n* [**14.8.5**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.8.5) by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/5a5a862c8a9e37ca2ea84133f92b216eaa7cd148) commit.\n* [**14.7.7**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.7.7) by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/d335917e233658fa9d4452053469c3582ef38368) commit.\n\nThe latest stable releases are available [here](https://gitlab.com/gitlab-org/gitlab-foss/-/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ehhthing (HackerOne)",
    "workaround": "",
    "vendorFixDate": "2022-03-31T00:00:00.000Z",
    "vendorNotifiedDate": "2022-01-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0904",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-1148",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0904/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2022/03/31/critical-security-release-gitlab-14-9-2-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.7.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.8.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.9.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/5a5a862c8a9e37ca2ea84133f92b216eaa7cd148",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/79709cabf71a57a336f490636a7e32a208fe0229",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/d335917e233658fa9d4452053469c3582ef38368",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1439552",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0904/default-remediation-status"
            }
        ]
    }
}