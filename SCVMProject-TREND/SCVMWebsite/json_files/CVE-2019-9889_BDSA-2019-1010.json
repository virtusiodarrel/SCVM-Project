{
    "source": "BDSA",
    "name": "BDSA-2019-1010",
    "title": "Vanilla Vulnerable to Path Traversal, Local File Inclusion and Remote Code Execution (RCE) via Crafted 'type' Parameter",
    "description": "Vanilla has a path traversal flaw that exists within the `getSingleIndex` function. An authenticated remote attacker with admin credentials can exploit this flaw to trigger directory traversal and perform local file inclusion which can lead to remote code execution (RCE).",
    "technicalDescription": "The flaw exists in the `type` parameter used within a `require` call in the `getSingleIndex` function of the `AddonManager` class. \n\nAn authenticated attacker with admin privileges can access the function `verify()` in source file `applications/dashboard/controllers/class.addoncachecontroller.php` which accepts a` type` parameter. The type parameter can be maliciously crafted by an attacker as no validation is performed on `type`. The type parameter is then used as input into the `getSingleIndex` function in the `AddonManager` class where a call to `require` checks that the file path is readable. This allows directory traversal with local PHP file inclusion. \n\nA remote, context dependent attacker can leverage this PHP file inclusion to launch remote code execution (RCE) under the context of the web server. \n\nThis flaw can only be exploited if an attacker is able to upload a file in any directory with the name `*-index.php` containing PHP code. Vanilla does not allow this by default.",
    "publishedDate": "2019-04-12T14:19:24.675Z",
    "updatedDate": "2019-04-12T14:19:24.644Z",
    "disclosureDate": "2019-03-13T00:00:00.000Z",
    "exploitPublishDate": "2019-03-13T00:00:00.000Z",
    "solution": "Fixed in [**2.6.4**](https://github.com/vanilla/vanilla/releases/tag/Vanilla_2.6.4) by \n* [this](https://github.com/vanilla/vanilla/commit/9efd9c6c82eb8e287eb2570e1279a8c241b82520) commit \n* [this](https://github.com/vanilla/vanilla/commit/7119dc7f42dc6a8ab66bd420a8e7d216ff56e1de) commit and \n* [this](https://github.com/vanilla/vanilla/commit/f02e3fadc4878e62debadcc85eb11498fd0d8bc7) commit.\n\nFixed in [**2.8**](https://github.com/vanilla/vanilla/releases/tag/Vanilla_2.8) by \n* [this](https://github.com/vanilla/vanilla/commit/e9a101c1863351fba71c830a0d7715706c628352) commit \n* [this](https://github.com/vanilla/vanilla/commit/6b6c4e24784b15e107a9d9debff953faeac0d742) commit and \n* [this](https://github.com/vanilla/vanilla/commit/3894578e2f78d3fb7183080fbbdf29613b9c359c) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.6,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.7,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-09-21T00:00:00.000Z",
    "vendorNotifiedDate": "2018-09-18T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1010",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-98"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9889",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1010/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanilla/vanilla/commit/3894578e2f78d3fb7183080fbbdf29613b9c359c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanilla/vanilla/commit/6b6c4e24784b15e107a9d9debff953faeac0d742",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanilla/vanilla/commit/7119dc7f42dc6a8ab66bd420a8e7d216ff56e1de",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanilla/vanilla/commit/9efd9c6c82eb8e287eb2570e1279a8c241b82520",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanilla/vanilla/commit/e9a101c1863351fba71c830a0d7715706c628352",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanilla/vanilla/commit/f02e3fadc4878e62debadcc85eb11498fd0d8bc7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanilla/vanilla/pull/7840",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanilla/vanilla/releases/tag/Vanilla_2.6.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanilla/vanilla/releases/tag/Vanilla_2.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/411140",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1010/default-remediation-status"
            }
        ]
    }
}