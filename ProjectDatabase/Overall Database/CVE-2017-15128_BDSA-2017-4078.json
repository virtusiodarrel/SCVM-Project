{
    "source": "BDSA",
    "name": "BDSA-2017-4078",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) via Missing Size Check in 'hugetlb_mcopy_atomic_pte' Function",
    "description": "The Linux kernel is vulnerable to denial-of-service (DoS) due to the insufficient validation of a variable's value. A local attacker could cause a vulnerable system to crash by running a malicious binary.",
    "technicalDescription": "The `userfaultfd()` system call is used to create file descriptors within user space applications that can be used for page fault handling purposes. Memory ranges can then be associated with that file descriptor via `ioctl()` operations. If an attempt to access memory in that range triggers a page fault, the kernel will pass the page fault to the user space application. The application will resolve the page fault using `ioctl()` operations. Such operation specify a command that is to be carried out. One such command is denoted by the `UFFDIO_COPY ` macro. Such an operation will copy a continuous block of memory into the range that was registered for the file descriptor. \n\nThe function `hugetlb_mcopy_atomic_pte()`, of file `mm/hugetlb.c`, is used within the kernel in order to implement the functionality of the `UFFDIO_COPY` `ioctl()` operation. For file-backed mappings that are associated with inodes, the amount of actual data that is stored in the file will be denoted by the `i_size` member of the `inode` structure. However, the actual amount of memory that is mapped in order to store the file contents may exceed `i_size`. If this is the case, then a later call to `remove_inode_hugepages()` (of file `fs/hugetlbfs/inode.c`) will generate an error.\n\nThere is insufficient validation performed in `hugetlb_mcopy_atomic_pte()` to ensure that the memory in the pages that have been allocated does not exceed that of `i_size`. An attacker could therefore use a crafted series of system calls in order to trigger an error during the evaluation of `remove_inode_hugepages()` and cause a DoS. The vulnerability was fixed by introducing additional checks within `hugetlb_mcopy_atomic_pte()` which ensure that an excessive number of pages are not mapped.",
    "publishedDate": "2021-08-05T13:42:59.952Z",
    "updatedDate": "2021-08-25T14:23:51.136Z",
    "disclosureDate": "2017-11-03T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.13.12**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c14ee6986103f9232c99de035a996547faba6371) commit.\n* [**4.14-rc8**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1e3921471354244f70fe268586ff94a97a6dd4df) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:N/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2017-11-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-4078",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-229"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-15128",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-4078/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1e3921471354244f70fe268586ff94a97a6dd4df",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c14ee6986103f9232c99de035a996547faba6371",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1e3921471354244f70fe268586ff94a97a6dd4df",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}