{
    "source": "BDSA",
    "name": "BDSA-2022-1968",
    "title": "Grafana Vulnerable to Account Takeover via Improper OAuth Implementation",
    "description": "Grafana contains a vulnerability in its OAuth implementation that can allow an attacker to take over an existing Grafana account.",
    "technicalDescription": "To exploit this vulnerability, an attacker will need to be authenticated to Grafana via a configured OAuth Identity Provider. Once authenticated, the attacker can leverage this flaw to take over an existing Grafana account.\n\nThis issue has been fixed by improving the user lookup process for OAuth configurations.",
    "publishedDate": "2022-07-18T09:00:12.210Z",
    "updatedDate": "2022-07-18T09:00:12.197Z",
    "disclosureDate": "2022-07-14T00:00:00.000Z",
    "solution": "Fixed in:\n* **[8.3.10](https://github.com/grafana/grafana/releases/tag/v8.3.10)** by [this](https://github.com/grafana/grafana/commit/b8eb142e850945a76d4719ba519db80df23ab101) commit,\n* **[8.4.10](https://github.com/grafana/grafana/releases/tag/v8.4.10)** by [this](https://github.com/grafana/grafana/commit/967e17d7ef6bc62a108add33ea699710f0e15870) commit,\n* **[8.5.9](https://github.com/grafana/grafana/releases/tag/v8.5.9)** by [this](https://github.com/grafana/grafana/commit/41a2c694414feabef022ef49c84bff5909a70740) commit,\n* **[9.0.3](https://github.com/grafana/grafana/releases/tag/v9.0.3)** by [this](https://github.com/grafana/grafana/commit/4665dc253f15aac59643c40428504664ee036d90) commit.\n\nThe latest stable releases are available [here](https://github.com/grafana/grafana/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "HTTPVoid team",
    "workaround": "The vendor recommends users to disable any OAuth logins using the steps specified [here](https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-authentication/generic-oauth/). Alternatively, the vendor recommends users to ensure that all users authorized to log in via OAuth have a corresponding user account in Grafana linked to their email address.",
    "vendorFixDate": "2022-06-28T00:00:00.000Z",
    "vendorNotifiedDate": "2022-06-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1968",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-303"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31107",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1968/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/41a2c694414feabef022ef49c84bff5909a70740",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/4665dc253f15aac59643c40428504664ee036d90",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/967e17d7ef6bc62a108add33ea699710f0e15870",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/b8eb142e850945a76d4719ba519db80df23ab101",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/tag/v8.3.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/tag/v8.4.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/tag/v8.5.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/tag/v9.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/security/advisories/GHSA-mx47-6497-3fv2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/security/advisories/GHSA-mx47-6497-3fv2",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1968/default-remediation-status"
            }
        ]
    }
}