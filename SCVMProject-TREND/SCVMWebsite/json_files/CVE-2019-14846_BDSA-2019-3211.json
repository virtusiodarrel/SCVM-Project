{
    "source": "BDSA",
    "name": "BDSA-2019-3211",
    "title": "Ansible Vulnerable to Information Exposure via Leaked Credentials in DEBUG-Level Logging",
    "description": "Ansible is vulnerable to information exposure due to improper configuration of global log levels. This could allow a local attacker to obtain AWS credentials through DEBUG-level log files.",
    "technicalDescription": "The library `boto3` uses a hard-coded DEBUG level for logging. If Ansible logging is enabled, this would cause the DEBUG level to be set globally. This could result in exposure of AWS credentials through plugins which use `boto3` from the Ansible process:\n* `inventory/aws_ec2.py`\n* `inventory/aws_rds.py`\n* `lookup/aws_account_attribute.py`\n* `lookup/aws_secret.py`\n* `lookup/aws_ssm.py`\n\nThe vendor states that this issue does not affect AWS Ansible modules as they are executed in a separate process.",
    "publishedDate": "2019-10-14T11:54:49.460Z",
    "updatedDate": "2019-11-15T17:49:00.979Z",
    "disclosureDate": "2019-09-25T00:00:00.000Z",
    "solution": "Fixed in:\n* **[2.8.6](https://github.com/ansible/ansible/releases/tag/v2.8.6)** by [this](https://github.com/ansible/ansible/commit/cb0f535a8b254a2daf69cd067e842fabb2993034) commit,\n* **[2.7.14](https://github.com/ansible/ansible/releases/tag/v2.7.14)** by [this](https://github.com/ansible/ansible/commit/90e74dd2600e5cc42dd9b4f4656f3d651c4ce5c4) commit,\n* **[2.6.20](https://github.com/ansible/ansible/releases/tag/v2.6.20)** by [this](https://github.com/ansible/ansible/commit/d961f676c01023a6a21503df16ba551a550e515b) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Paul Milbank, Harvey Rendell, Tom Henderson (Pushpay Site Reliability Engineering)",
    "workaround": "",
    "vendorFixDate": "2019-09-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3211",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-532"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14846",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3211/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-14846",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/90e74dd2600e5cc42dd9b4f4656f3d651c4ce5c4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/cb0f535a8b254a2daf69cd067e842fabb2993034",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/d961f676c01023a6a21503df16ba551a550e515b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/pull/63366",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases/tag/v2.6.20",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases/tag/v2.7.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases/tag/v2.8.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3211/default-remediation-status"
            }
        ]
    }
}