{
    "source": "BDSA",
    "name": "BDSA-2019-5294",
    "title": "Android Kernel Vulnerable to Privilege Escalation via Out-of-Bounds Read in 'binder.c' File",
    "description": "The Android kernel contains a privilege escalation vulnerability. This is due to a miscalculation when checking if an address is within the bounds of a memory buffer in the binder driver for Android. Binder is the inter process communication system used by Android, allowing processes to communicate with each other. This vulnerability allows an attacker to escalate privileges to `ROOT` on devices using a vulnerable kernel.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "The vulnerable code lies within the `binder_transaction()` function in `drivers/android/binder.c`.  The `num_valid` variable is used to validate that the location of a memory address is within the bounds of a binder object. The `num_valid` variable is passed as a parameter to the `binder_fixup_parent()` function. Here it is passed to the `binder_validate_ptr()` function, and it is here that it is used in validating the address of Parent memory addresses. The miscalculation is due to a multiplication (`*`) instead of a division (`/`) being performed. This leads to a large offset value and allows the out-of-bounds read to occur. \n\nIt should be noted that this vulnerability has been used in a chain to perform a sandbox escape in the Google Chrome Application. This can be seen [here](https://labs.bluefrostsecurity.de/blog/2020/03/31/cve-2020-0041-part-1-sandbox-escape/).",
    "publishedDate": "2021-12-01T09:48:30.807Z",
    "updatedDate": "2022-06-06T15:49:27.696Z",
    "disclosureDate": "2020-03-02T00:00:00.000Z",
    "exploitPublishDate": "2020-03-31T00:00:00.000Z",
    "solution": "Fixed in Linux kernel version:\n* [**5.3.17**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=409579300981183be71034b483d1f5eedbbaed2d) commit\n* [**5.4.4**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=34d8a89fe156b082823f438f8240e8d57291c9f2) commit\n* [**5.5-rc2**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=16981742717b04644a41052570fb502682a315d2) commit\n\nThe latest stable releases can be found [here](https://www.kernel.org).\n\nFixed in Android kernel version [**ASB-2020-03-05_4.19-q-release**](https://android.googlesource.com/kernel/common/+/refs/tags/ASB-2020-03-05_4.19-q-release).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:L/AC:H/Au:N/C:C/I:C/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.9
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "JB Cayrou",
    "workaround": "",
    "vendorFixDate": "2019-12-14T00:00:00.000Z",
    "vendorNotifiedDate": "2019-12-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5294",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-0041",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5294/ranges"
            },
            {
                "rel": "reference",
                "href": "https://android.googlesource.com/kernel/common/+/2cfb6d416914acba47f6b27a57c75b18b5fc478f%5E%21/",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://android.googlesource.com/kernel/common/+/refs/tags/ASB-2020-03-05_4.19-q-release",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=16981742717b04644a41052570fb502682a315d2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=34d8a89fe156b082823f438f8240e8d57291c9f2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=409579300981183be71034b483d1f5eedbbaed2d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=16981742717b04644a41052570fb502682a315d2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bde4a19fc04f5f46298c86b1acb7a4af1d5f138d",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bluefrostsecurity/CVE-2020-0041",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/j4nn/CVE-2020-0041",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/koharin/CVE-2020-0041",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://labs.bluefrostsecurity.de/blog/2020/03/31/cve-2020-0041-part-1-sandbox-escape/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/lkml/20191213202531.55010-1-tkjos@google.com/",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://source.android.com/security/bulletin/2020-03-01",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synacktiv.com/en/publications/binder-analysis-and-exploitation-of-cve-2020-0041.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5294/default-remediation-status"
            }
        ]
    }
}