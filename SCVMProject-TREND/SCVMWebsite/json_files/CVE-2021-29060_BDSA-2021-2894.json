{
    "source": "BDSA",
    "name": "BDSA-2021-2894",
    "title": "Node.js 'color-string' Package Vulnerable to Regular Expression Denial-of-Service (ReDoS) via Long 'hwb()' Color Strings",
    "description": "color-string is vulnerable to a regular expression denial-of-service (ReDoS) issue due to how extremely long input lengths for `hwb()` color strings are mishandled.\n\nAn attacker could submit a string with a large character count in order to cause excessive backtracking and a cartesian scan, which results in exponential time complexity given a linear increase in input length.",
    "technicalDescription": "color-string is vulnerable to regular expression denial-of-service (ReDoS) conditions because the `hwb()` function in the `index.js` file does not sufficiently validate the size of input strings. Strings that reach more than 5000 characters can see several milliseconds of processing time, where strings reaching more that 50,000 characters cam see 1500 milliseconds of processing time.\n\nThis issue occurs due to how the regular expression that parses `hwb()` strings mishandled strings where the integer part of the `hue` value uses a 0-or-more quantifier followed by a 1-or-more quantifier.",
    "publishedDate": "2021-09-29T15:38:44.640Z",
    "updatedDate": "2021-09-29T15:38:44.627Z",
    "disclosureDate": "2021-03-05T00:00:00.000Z",
    "exploitPublishDate": "2021-03-22T00:00:00.000Z",
    "solution": "Fixed in [**1.5.5**](https://github.com/Qix-/color-string/releases/tag/1.5.5) by [this](https://github.com/Qix-/color-string/commit/0789e21284c33d89ebc4ab4ca6f759b9375ac9d3) commit.\n\nThe latest stable releases are available [here](https://www.npmjs.com/package/color-string).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Yeting Li, c/o Colin Ife via Snyk.io",
    "workaround": "",
    "vendorFixDate": "2021-03-05T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2894",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29060",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2894/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Qix-/color-string/commit/0789e21284c33d89ebc4ab4ca6f759b9375ac9d3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Qix-/color-string/releases/tag/1.5.5",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Qix-/color-string/releases/tag/1.5.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-257v-vj4p-3w2h",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yetingli/PoCs/blob/main/CVE-2021-29060/Color-String.md",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yetingli/PoCs/blob/main/CVE-2021-29060/Color-String.md",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yetingli/SaveResults/blob/main/js/color-string.js",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/color-string",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2894/default-remediation-status"
            }
        ]
    }
}