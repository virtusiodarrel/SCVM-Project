{
    "source": "BDSA",
    "name": "BDSA-2020-0584",
    "title": "Jackson Databind Vulnerable to Remote Code Execution (RCE) via Polymorphic Typing Issue in 'apache.openjpa' Gadget",
    "description": "Jackson Databind is vulnerable to remote code execution (RCE) due to how polymorphic data types are handled by a \"gadget\" used by the application. A remote attacker could execute arbitrary commands on the underlying system. Default typing must be enabled in order for this vulnerability to manifest.\n\nVersion **2.10.0** of Databind introduced functionality which allows developers to limit subtypes allowed by default typing using a whitelist.",
    "technicalDescription": "The `apache.openjpa` component used within Jackson Databind contains the `WASRegistryManagedRuntime` gadget type which can use deserialized JSON objects. The JSON object received by Jackson Databind could include a class name as the type ID for certain fields, so that the deserializer knows what concrete subtype to use for the values of those fields. Alternatively if Default Typing is enabled, default class names are used for all JSON properties that match a given set of criteria.\n\nWhenever an instance of the `WASRegistryManagedRuntime` class is being deserialized by Jackson Databind, the base class method `getTransactionManager()` can be invoked in order to set the value of the `_tm` attribute. This method performs a JNDI lookup against the resource that is specified in the `_registry` attribute. If the value of `_registry` constitutes an LDAP URI, then an LDAP lookup will be performed. If the LDAP entry constitutes a `Reference` object, then the application can download and instantiate a remotely hosted factory class from the location that is specified in that object. An attacker can host a crafted factory class that contains a malicious constructor or static initializer block in order to execute arbitrary code on the server.",
    "publishedDate": "2020-04-01T15:01:32.693Z",
    "updatedDate": "2021-08-16T10:22:43.756Z",
    "disclosureDate": "2020-03-28T00:00:00.000Z",
    "exploitPublishDate": "2020-05-21T00:00:00.000Z",
    "solution": "Fixed in [**2.9.10.4**](https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.9.10.4) by [this](https://github.com/FasterXML/jackson-databind/commit/e2ba12d5d60715d95105e3e790fc234cfb59893d) commit, and in [**2.6.7.4**](https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.6.7.4) by [this](https://github.com/FasterXML/jackson-databind/commit/74aba4042fce35ee0b91bd2847e788c10040d78b) commit.\n\nFixed in the **2.7** and **2.8** branches by [this](https://github.com/FasterXML/jackson-databind/commit/08fbfacf89a4a4c026a6227a1b470ab7a13e2e88) commit which is not yet included in any release.\n\nThe latest stable releases are available [here](https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "XuYuanzhen",
    "workaround": "",
    "vendorFixDate": "2020-03-28T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0584",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11113",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0584/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Al1ex/CVE-2020-11113",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/commit/08fbfacf89a4a4c026a6227a1b470ab7a13e2e88",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/commit/74aba4042fce35ee0b91bd2847e788c10040d78b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/commit/e2ba12d5d60715d95105e3e790fc234cfb59893d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/issues/2670",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.6.7.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.9.10.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0584/default-remediation-status"
            }
        ]
    }
}