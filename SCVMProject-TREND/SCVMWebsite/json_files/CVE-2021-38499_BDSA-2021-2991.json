{
    "source": "BDSA",
    "name": "BDSA-2021-2991",
    "title": "Mozilla Firefox Vulnerable to Memory Corruption via Multiple Memory Safety Bugs",
    "description": "Firefox contains multiple memory safety bugs that show evidence of memory corruption. The worst case exploitation scenario could potentially result in remote code execution (RCE), however this has not been demonstrated.",
    "technicalDescription": "These vulnerabilities exist due to:\n* `nsHttpTransaction::mConnection` not being released on the socket thread in `netwerk/protocol/http/nsHttpTransaction.cpp`.\n* Insufficient diagnostic assertions when using HTTP2.\n* The reference to `Http2Session` being destroyed during a `ReadSegment` call in `netwerk/protocol/http/Http2Session.cpp`.\n* The use of `sAsyncPanZoomControllerCount` in `gfx/layers/apz/src/AsyncPanZoomController.cpp`.\n* The presence of APZ support code for deprecated progressive paint functionality.\n* Lack of `TSan` suppression in `mozglue/build/TsanOptions.cpp`.\n* Insufficient checks on `MediaTransportHandlerSTS::mInitPromise` in `dom/media/webrtc/jsapi/MediaTransportHandler.cpp` before it is used.\n* Lack of a designated holder object for `JSOp::SetIntrinsic` values in `js/src/vm/GlobalObject-inl.h`.",
    "publishedDate": "2021-10-07T16:03:37.160Z",
    "updatedDate": "2022-07-18T09:15:19.301Z",
    "disclosureDate": "2021-10-05T00:00:00.000Z",
    "solution": "Fixed in Firefox [**93**](https://ftp.mozilla.org/pub/firefox/releases/93.0/) by the following commits:\n* [Commit 1](https://hg.mozilla.org/releases/mozilla-release/rev/a4237f33cc634921ee642bee821ee400c55ed824)\n* [Commit 2](https://hg.mozilla.org/releases/mozilla-release/rev/9f8eed9137f04176420f4148a3ecc72a91b33384)\n* [Commit 3](https://hg.mozilla.org/releases/mozilla-release/rev/568cde9bc686ce4ae172331ca1defa25263b5e59)\n* [Commit 4](https://hg.mozilla.org/releases/mozilla-release/rev/09c5cc761990bad86812781f413ae6d5ffcb5637)\n* [Commit 5](https://hg.mozilla.org/releases/mozilla-release/rev/83945376d6af5870b90fd8fb88d62036ef919d80)\n* [Commit 6](https://hg.mozilla.org/releases/mozilla-release/rev/b04a54bb11fbe1573cd08d0175106a00b1c74eb5)\n* [Commit 7](https://hg.mozilla.org/releases/mozilla-release/rev/b7bddce8fe3b4b709d7616ee947a8e9974b20049)\n* [Commit 8](https://hg.mozilla.org/releases/mozilla-release/rev/b4d43ddeed4fb972dc4c5023c743a234565ac2ff)\n\nThe latest releases for are available [here](https://ftp.mozilla.org/pub/firefox/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Julien Cristau, Christian Holler",
    "workaround": "",
    "vendorFixDate": "2021-10-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2991",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-38499",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2991/ranges"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/93.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/09c5cc761990bad86812781f413ae6d5ffcb5637",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/568cde9bc686ce4ae172331ca1defa25263b5e59",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/83945376d6af5870b90fd8fb88d62036ef919d80",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/9f8eed9137f04176420f4148a3ecc72a91b33384",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/a4237f33cc634921ee642bee821ee400c55ed824",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/b04a54bb11fbe1573cd08d0175106a00b1c74eb5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/b4d43ddeed4fb972dc4c5023c743a234565ac2ff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/b7bddce8fe3b4b709d7616ee947a8e9974b20049",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-43/#CVE-2021-38499",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2991/default-remediation-status"
            }
        ]
    }
}