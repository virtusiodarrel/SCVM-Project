{
    "source": "BDSA",
    "name": "BDSA-2021-2387",
    "title": "c-ares Vulnerable to Improper Domain Name Resolution via Insufficient Validation of DNS Returned Hostnames",
    "description": "c-ares is vulnerable to an improper domain name resolution issue due to a lack of sufficient validation for hostnames that are returned by DNS servers.\n\nThe lack of sufficient validation can lead to the output of the wrong hostnames which could result in traffic being directed to unintended domains.",
    "technicalDescription": "c-ares is vulnerable to improper domain name resolution because the `ares_expand_name()` function in the `src/lib/ares_expand_name.c` file mishandles domains that contain zero-bytes. When a domain is resolved using this implementation, the `CNAME` alias and name of the `A` record can be incorrect. \n\nThis issue could lead to DNS-cache injections where the library is used to implement a cache.",
    "publishedDate": "2021-08-11T10:44:42.280Z",
    "updatedDate": "2021-08-11T10:44:42.267Z",
    "disclosureDate": "2021-08-10T00:00:00.000Z",
    "exploitPublishDate": "2021-08-10T00:00:00.000Z",
    "solution": "Fixed in [**1.17.2**](https://github.com/c-ares/c-ares/releases/tag/cares-1_17_2) by [this](https://github.com/c-ares/c-ares/commit/362f91d807d293791008cdb7616d40f7784ece83) commit and [this](https://github.com/c-ares/c-ares/commit/44c009b8e62ea1929de68e3f438181bea469ec14) commit.\n\nThe latest stable releases are available [here](https://c-ares.haxx.se/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Philipp Jeitner and Haya Shulman, Fraunhofer SIT",
    "workaround": "",
    "vendorFixDate": "2021-06-11T00:00:00.000Z",
    "vendorNotifiedDate": "2021-06-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2387",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3672",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2387/ranges"
            },
            {
                "rel": "reference",
                "href": "https://c-ares.haxx.se/adv_20210810.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://c-ares.haxx.se/adv_20210810.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://c-ares.haxx.se/download/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/c-ares/c-ares/commit/362f91d807d293791008cdb7616d40f7784ece83",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/c-ares/c-ares/commit/44c009b8e62ea1929de68e3f438181bea469ec14",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/c-ares/c-ares/compare/809d5e8..44c009b.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/c-ares/c-ares/releases/tag/cares-1_17_2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2021/q3/84",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2387/default-remediation-status"
            }
        ]
    }
}