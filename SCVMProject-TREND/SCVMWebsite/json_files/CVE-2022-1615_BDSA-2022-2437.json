{
    "source": "BDSA",
    "name": "BDSA-2022-2437",
    "title": "Samba Vulnerable to Security Bypass via Insecure Random Number Generation in 'genrand.c' File",
    "description": "Samba uses an insecure random number generator for generating temporary keys. This could allow an attacker to bypass the security measures and conduct replay attacks, forge Kerberos tickets and gain access to weak generated passwords.",
    "technicalDescription": "This vulnerability exists because the `lib/util/genrand.c` file uses an insecure method for random number generation: `gnutls_rnd()`. This function can result in the generation of a deterministic secret. This could allow an attacker to conduct replay attacks for the NTLM challenge/response cycle. It could also result in the generation of weak passwords via the `generate_random_machine_password()` function during the `winbindd` password change process. This could allow the attacker to supply forged Kerberos tickets. \n\nThis vulnerability has been mitigated by checking the return values for the random number generation function. For cases where it has failed, the application calls `genrand_panic()` method that in turn calls `smb_panic()` function and aborts the application.",
    "publishedDate": "2022-09-02T10:54:13.412Z",
    "updatedDate": "2022-09-02T10:54:13.393Z",
    "disclosureDate": "2022-08-08T00:00:00.000Z",
    "exploitPublishDate": "2022-08-08T00:00:00.000Z",
    "solution": "Fixed in version [**4.17.0rc1**](https://gitlab.com/samba-team/samba/-/tags/samba-4.17.0rc1) by [this](https://gitlab.com/samba-team/samba/-/commit/9849e7440e30853c61a80ce1f11b7b244ed766fe) commit.\n\nThe latest stable releases can be found [here](https://gitlab.com/samba-team/samba/-/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "",
    "workaround": "",
    "vendorFixDate": "2022-07-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2437",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-338"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-1615",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2437/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.samba.org/show_bug.cgi?id=15103",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.samba.org/show_bug.cgi?id=15103",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/samba-team/samba/-/commit/9849e7440e30853c61a80ce1f11b7b244ed766fe",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/samba-team/samba/-/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/samba-team/samba/-/tags/samba-4.17.0rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2437/default-remediation-status"
            }
        ]
    }
}