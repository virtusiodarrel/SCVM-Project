{
    "source": "BDSA",
    "name": "BDSA-2021-1877",
    "title": "Eclipse Jetty Vulnerable to Insufficient Session Expiration via 'SessionListener#sessionDestroyed' Method",
    "description": "Eclipse Jetty is vulnerable to insufficient session expiry. This may result in sessions used on a shared computer persisting for longer than intended.",
    "technicalDescription": "This vulnerability occurs when an exception is thrown from the `SessionListener#sessionDestroyed()` method defined in file `jetty-server/src/main/java/org/eclipse/jetty/server/session/Session.java`. This will cause the session ID in the session ID manager to not be invalidated, which will subsequently mean the session is not invalidated in deployments which have clustered sessions and multiple contexts. This may result in sessions used on a shared computer persisting for longer than intended.\n\nThe vendor has stated that there is no known attack vector which a malicious user can exploit in order to cause the exception to be thrown in the `SessionListener#sessionDestroyed()` method, meaning that a physical attacker must rely on an application to cause the exception.",
    "publishedDate": "2021-06-23T10:42:28.764Z",
    "updatedDate": "2022-06-22T09:51:11.068Z",
    "disclosureDate": "2021-06-22T00:00:00.000Z",
    "solution": "Fixed in:\n* [**9.4.41.v20210516**](https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.41.v20210516) by [this](https://github.com/eclipse/jetty.project/commit/087f486b4461746b4ded45833887b3ccb136ee85) commit, \n* [**10.0.3**](https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.3) by [this](https://github.com/eclipse/jetty.project/commit/cd6462a6252d083b3c9ea2684aab0b4c9669ed19) commit, \n* [**11.0.3**](https://github.com/eclipse/jetty.project/releases/tag/jetty-11.0.3) by [this](https://github.com/eclipse/jetty.project/commit/cd6462a6252d083b3c9ea2684aab0b4c9669ed19) commit.\n\nThe latest stable releases are available [here](https://github.com/eclipse/jetty.project/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 2.9,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 0.4,
        "severity": "LOW",
        "attackVector": "PHYSICAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "CVSS:3.1/AV:P/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Romain Manni-Bucau, Stephen Connolly",
    "workaround": "The vendor has [stated](https://github.com/eclipse/jetty.project/security/advisories/GHSA-m6cp-vxjx-65j6) that a workaround is to ensure that the application catches all Throwables within their `SessionListener#sessionDestroyed()` implementations.",
    "vendorFixDate": "2021-05-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1877",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-613"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-34428",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1877/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/commit/087f486b4461746b4ded45833887b3ccb136ee85",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/commit/4e672c6b27eeecbb7e1152453d1364ad948b51cf",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/commit/cd6462a6252d083b3c9ea2684aab0b4c9669ed19",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-11.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.41.v20210516",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/security/advisories/GHSA-m6cp-vxjx-65j6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/security/advisories/GHSA-m6cp-vxjx-65j6",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1877/default-remediation-status"
            }
        ]
    }
}