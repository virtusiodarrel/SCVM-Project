{
    "source": "BDSA",
    "name": "BDSA-2021-1132",
    "title": "HashiCorp Vault Vulnerable to Man-in-the-Middle Attacks via Improper Revoked Certificate Handling",
    "description": "HashiCorp Vault is vulnerable to man-in-the-middle attacks due to the improper management of Certificate Revocation Lists (CRLs). A remote attacker could potentially obtain or modify sensitive information by utilizing a compromised certificate that has been revoked.",
    "technicalDescription": "Vault's CRL management functionality includes a capability which allows it to remove CRL entries that have expired. The `tidy_revoked_certs` parameter, which can be `True` or `False`, is used to indicate whether or not all revoked and expired certificates should be removed. The logic that handles this parameter is flawed, such that certificates that are revoked but have not yet expired will be removed from the CRL. Such certificates would therefore be treated as valid. Attackers which possess compromised certificates which have been revoked could use those certificates to conduct a man-in-the-middle attack.",
    "publishedDate": "2021-04-23T16:10:03.644Z",
    "updatedDate": "2021-04-23T16:10:03.638Z",
    "disclosureDate": "2021-04-21T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.7.1**](https://github.com/hashicorp/vault/releases/tag/v1.7.1) by [this](https://github.com/hashicorp/vault/commit/3144d8f14b749fac57f0970636b35c68fd673843) commit.\n* [**1.6.4**](https://github.com/hashicorp/vault/releases/tag/v1.6.4) by [this](https://github.com/hashicorp/vault/commit/6408b1cb57d2e71838ac75eb166cc179ff472d37) commit.\n* [**1.5.8**](https://github.com/hashicorp/vault/releases/tag/v1.5.8) by [this](https://github.com/hashicorp/vault/commit/e7bd0b5d8f00e955ae16a9a4f2be6ba6d428bba4) commit.\n\n\n\nThe latest stable releases are available [here]().",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1132",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-295"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29653",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1132/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.hashicorp.com/t/hcsec-2021-09-vault-s-pki-engine-crl-may-exclude-revoked-but-unexpired-certificates-after-tidy/23461",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/3144d8f14b749fac57f0970636b35c68fd673843",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/6408b1cb57d2e71838ac75eb166cc179ff472d37",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/e7bd0b5d8f00e955ae16a9a4f2be6ba6d428bba4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases/tag/v1.5.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases/tag/v1.6.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases/tag/v1.7.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1132/default-remediation-status"
            }
        ]
    }
}