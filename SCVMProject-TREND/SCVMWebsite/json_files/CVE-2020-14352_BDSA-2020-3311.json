{
    "source": "BDSA",
    "name": "BDSA-2020-3311",
    "title": "Librepo Vulnerable to Directory Traversal via Missing Path Validation in 'repomd.xml'",
    "description": "Librepo is vulnerable to directory traversal via missing path validation in `repomd.xml`. A remote attacker could exploit this in order to copy files outside of the destination directory via path traversal using malicious or malformed metadata relating to the repository. Successful exploitation of this flaw could lead to system compromise due to the potential ability to overwrite system files.",
    "technicalDescription": "This issue occurs due to lack of sanitation within the `librepo/yum.c` file. It was mitigated by the addition of a number of validation checks within the `prepare_repo_download_targets` function within `librepo/yum.c`.",
    "publishedDate": "2020-11-11T16:53:41.612Z",
    "updatedDate": "2020-11-11T16:53:41.607Z",
    "disclosureDate": "2020-08-13T00:00:00.000Z",
    "solution": "Fixed in [**1.2.3**](https://github.com/rpm-software-management/librepo/releases/tag/1.12.1) by [this](https://github.com/rpm-software-management/librepo/commit/7daea2a2429a54dad68b1de9b37a5f65c5cf2600) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sergei Iudin",
    "workaround": "",
    "vendorFixDate": "2020-08-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3311",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14352",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3311/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/cve-2020-14352",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1866498",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rpm-software-management/librepo/commit/7daea2a2429a54dad68b1de9b37a5f65c5cf2600",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rpm-software-management/librepo/releases/tag/1.12.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3311/default-remediation-status"
            }
        ]
    }
}