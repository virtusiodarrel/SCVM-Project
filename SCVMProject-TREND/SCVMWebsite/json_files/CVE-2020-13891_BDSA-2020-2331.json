{
    "source": "BDSA",
    "name": "BDSA-2020-2331",
    "title": "Mattermost Mobile for iOS Vulnerable to Authentication Token Leakage via Markdown Image Request",
    "description": "Mattermost Mobile for iOS is vulnerable to an authentication token leakage issue due to how the application can send the HTTP Authorization header along with GET requests to 3rd party media hosting servers when requesting an image.\n\nAn attacker could send a crafted Markdown message to a victim user and cause them to request the content from an attacker controlled media hosting server and leak their authentication token.",
    "technicalDescription": "Mattermost Mobile for iOS is vulnerable to an authentication token leakage issue because the client application performs a GET request for images which are declared using Markdown in channels or direct messages. The request to the specified URL can be sent to the media hosting server directly if no image proxy is enabled.\nThe issue is that the HTTP Authorization Header, containing the Bearer authentication token, is sent with the GET request to the media hosting server.\n\nThis means an attacker could send crafted Markdown messages containing URLs that direct victim users towards an attacker controlled media hosting server in order to steal the victim's authentication token. A valid authentication token can allow the attacker to impersonate the victim user by making authenticated requests that do not require a password to the Mattermost API. If the token is for a privileged account, the attacker can also cause denial-of-service (DoS) issues by disabling other user accounts.",
    "publishedDate": "2020-09-11T11:43:43.701Z",
    "updatedDate": "2020-09-11T12:16:15.988Z",
    "disclosureDate": "2020-06-16T00:00:00.000Z",
    "exploitPublishDate": "2020-07-20T00:00:00.000Z",
    "solution": "Fixed in [**1.31.2**](https://github.com/mattermost/mattermost-mobile/releases/tag/v1.31.2).\n\nThe latest stable releases are available [here](https://github.com/mattermost/mattermost-mobile/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jorge Ferreira, Wilberto Filho and Julio Fort from Blaze Information Security",
    "workaround": "",
    "vendorFixDate": "2020-05-27T00:00:00.000Z",
    "discoveryDate": "2020-05-22T00:00:00.000Z",
    "vendorNotifiedDate": "2020-05-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2331",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-201"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13891",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2331/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.blazeinfosec.com/cve-2020-13891-mattermost-mobile-for-ios-authentication-token-leakage-and-account-takeover/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.blazeinfosec.com/cve-2020-13891-mattermost-mobile-for-ios-authentication-token-leakage-and-account-takeover/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-mobile/blob/master/CHANGELOG.md#1312-release",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-mobile/releases/tag/v1.31.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mattermost.com/security-updates/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2331/default-remediation-status"
            }
        ]
    }
}