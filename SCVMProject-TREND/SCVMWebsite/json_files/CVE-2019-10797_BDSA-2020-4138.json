{
    "source": "BDSA",
    "name": "BDSA-2020-4138",
    "title": "Transport HTTP Vulnerable to HTTP Response Splitting via Insufficient Header Validation",
    "description": "Transport HTTP is vulnerable to HTTP response splitting due to a lack of validation of request headers. A remote attacker could send a maliciously crafted request to the application that will be interpreted as being sent by another client.",
    "technicalDescription": "The functions `createHttpResponse()`, `createFullHttpResponse()` and `createHttpRequest()`, as defined within the file `Util.java`, each initialize `HttpResponse` objects. These are created by invoking the `DefaultFullHttpResponse()` constructor. The `validateHeaders` parameter of this constructor is passed a value of `false`, which switches off HTTP header validation. This makes the application vulnerable to HTTP response splitting. A remote attacker could send maliciously crafted HTTP requests to a vulnerable server, with headers that contain escape sequences. This will cause the application to treat the malicious requests as if they came from other legitimate users.\n\nThe vulnerability was fixed by ensuring that the `false` argument is not passed to the constructor.",
    "publishedDate": "2021-02-04T11:16:34.829Z",
    "updatedDate": "2021-06-02T15:36:54.548Z",
    "disclosureDate": "2020-02-06T00:00:00.000Z",
    "solution": "Fixed in [**6.3.1**](https://github.com/wso2/transport-http/releases/tag/v6.3.1) by [this](https://github.com/wso2/transport-http/commit/4a4dc99c7b259646ee5e23b7aaa7c3a8bac959c1) commit.\n\nThe latest stable releases are available [here](https://github.com/wso2/transport-http/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-02-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4138",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-113"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10797",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4138/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/transport-http/commit/4a4dc99c7b259646ee5e23b7aaa7c3a8bac959c1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/transport-http/commit/4a4dc99c7b259646ee5e23b7aaa7c3a8bac959c1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/transport-http/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/transport-http/releases/tag/v6.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4138/default-remediation-status"
            }
        ]
    }
}