{
    "source": "BDSA",
    "name": "BDSA-2020-3526",
    "title": "October Content Management System (CMS) Vulnerable to PHP Code Execution via Sandbox Escape in CMS Templates",
    "description": "October CMS contains an arbitrary code execution vulnerability. An authenticated, privileged attacker could bypass security restrictions, by writing specific Twig code to enable them to escape the Twig sandbox and execute arbitrary PHP code. \n\n**Note** This vulnerability was initially not fully fixed and was further addressed by CVE-2020-26231 (BDSA-2020-3541).",
    "technicalDescription": "The vulnerability occurs due to insufficient policy restrictions in content management system (CMS) templates, preventing a privileged attacker with access to the backend from bypassing the `cms.enableSafeMode` in place to prevent PHP code execution. An attacker with `cms.manage_pages`, `cms.manage_layouts`, or `cms.manage_partials` permissions, could write specific Twig code to escape the sandbox and execute arbitrary PHP code.",
    "publishedDate": "2020-11-25T15:38:23.594Z",
    "updatedDate": "2020-11-26T12:48:06.111Z",
    "disclosureDate": "2020-11-22T00:00:00.000Z",
    "solution": "Fixed in version [**1.0.470**](https://github.com/octobercms/october/releases/tag/v1.0.470) by [this](https://github.com/octobercms/october/commit/61e49d9e0b5f7e5323353f254d4ff12905bbe573) and [this](https://github.com/octobercms/october/commit/4c650bb775ab849e48202a4923bac93bd74f9982) commit.\n\nFixed in version [**1.1.1**](https://github.com/octobercms/october/releases/tag/v1.1.1) by [this](https://github.com/octobercms/october/commit/d34fb8ab51108495a9a651b841202d935f4e12f7)and [this](https://github.com/octobercms/october/commit/4c650bb775ab849e48202a4923bac93bd74f9982) commit.\n\nThe latest stable releases are available [here](https://github.com/octobercms/october/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:L/AC:M/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ka1n4t",
    "workaround": "Workaround available [here](https://github.com/octobercms/october/compare/106daa2930de4cebb18732732d47d4056f01dd5b...7cb148c1677373ac30ccfd3069d18098e403e1ca) if unable to upgrade to Build 469.",
    "vendorFixDate": "2020-09-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3526",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15247",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3526/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/october/commit/4c650bb775ab849e48202a4923bac93bd74f9982",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/october/compare/106daa2930de4cebb18732732d47d4056f01dd5b...7cb148c1677373ac30ccfd3069d18098e403e1ca",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/october/releases/tag/v1.0.469",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/october/security/advisories/GHSA-94vp-rmqv-5875",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/october/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3526/default-remediation-status"
            }
        ]
    }
}