{
    "source": "BDSA",
    "name": "BDSA-2019-2321",
    "title": "WebKitGTK+ and WPE WebKit Vulnerable to Universal Cross-Site Scripting (UXSS) via Race Condition with Synchronous Cross-Origin Page Loads",
    "description": "WebKitGTK+ and WPE WebKit are vulnerable to universal cross-site scripting (UXSS) due a race condition enabled by synchronous cross-origin page loads. This could allow an attacker to execute web scripts on a victim's client in order to obtain sensitive information such as authentication tokens and user session cookies. Data accessible by an attacker is not restricted to session data for the particular web page targeted, and may include data belonging to any session managed by the browser at the time of the attack.",
    "technicalDescription": "An earlier vulnerability in WebKitGTK+ - initially disclosed as CVE-2017-2480 - allowed an attacker to attempt UXSS attacks by exploiting a time-of-check-time-of-use (TOCTOU) race condition in order to bypass same-origin policy checks. This was due to support of an obsolete window display method `showModalDialog` allowing the attacker to perform synchronous cross-origin page loads. \n\nAn access check was introduced to resolve this issue, but this could be bypassed because the HTML parser would fail to block `javascript:` URIs when the JavaScript execution context stack was empty. An additional fix to block script execution was then introduced, but it was discovered this could also be bypassed because it still allows JavaScript to be run when insertion of an `iframe` element with an existing content frame is still in progress in the parser.",
    "publishedDate": "2019-07-26T11:20:55.251Z",
    "updatedDate": "2021-10-01T16:01:24.128Z",
    "disclosureDate": "2019-07-24T00:00:00.000Z",
    "exploitPublishDate": "2019-07-24T00:00:00.000Z",
    "solution": "Fixed in WebKitGTK+ versions **[2.25.1](https://webkitgtk.org/releases/)** and **[2.24.4](https://webkitgtk.org/releases/)**.\n\nFixed in WPE WebKit version **[2.24.3](https://wpewebkit.org/releases/)**.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.6,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sergei Glazunov (Google Project Zero)",
    "workaround": "",
    "vendorFixDate": "2019-05-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2321",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-367"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-8649",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2321/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1818",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1818",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://webkitgtk.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://webkitgtk.org/security/WSA-2019-0004.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://wpewebkit.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://wpewebkit.org/security/WSA-2019-0004.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2321/default-remediation-status"
            }
        ]
    }
}