{
    "source": "BDSA",
    "name": "BDSA-2021-1836",
    "title": "Symfony Vulnerable to Authentication Bypass via Multiple Firewall Flaw",
    "description": "Symfony is vulnerable to an authentication bypass issue due to a token validation flaw that is present when multiple firewalls are defined.\n\nThis issue could allow a user that is authenticated on one part of an application to be incorrectly authenticated with the entire application.",
    "technicalDescription": "Symfony is vulnerable to an authentication bypass issue because the authentication token that is delivered by a firewall is available to all other firewalls that are defined. If an application defines different providers for different parts of the application, a user that is authenticated on one part of the application will then be considered authenticated with the whole application.\n\nTo remedy this issue, the vendor made changes to the token handling code in the `Firewall/ContextListener.php` file, in the **security-http** component, to ensure that the token is only available for the firewall that generated it.",
    "publishedDate": "2021-06-21T09:04:35.080Z",
    "updatedDate": "2021-07-01T10:31:39.496Z",
    "disclosureDate": "2021-06-17T00:00:00.000Z",
    "solution": "Fixed in the **security-http** repository in version [**5.3.2**](https://github.com/symfony/security-http/releases/tag/v5.3.2) by [this](https://github.com/symfony/security-http/commit/6bf4c31219773a558b019ee12e54572174ff8129) commit.\n\nThe fix was included in **symfony** version [**5.3.2**](https://github.com/symfony/symfony/releases/tag/v5.3.2) with [this](https://github.com/symfony/symfony/commit/3084764ad82f29dbb025df19978b9cbc3ab34728) commit.\n\nThe latest stable releases are available [here](https://github.com/symfony/symfony/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Bogdan, gndk, Pawe\u0142 Warcho\u0142, Warxcell, Adrien Lamotte",
    "workaround": "",
    "vendorFixDate": "2021-06-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1836",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32693",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1836/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/security-http/commit/6bf4c31219773a558b019ee12e54572174ff8129",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/security-http/releases/tag/v5.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/commit/3084764ad82f29dbb025df19978b9cbc3ab34728",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases/tag/v5.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/security/advisories/GHSA-rfcf-m67m-jcrq",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://symfony.com/blog/cve-2021-32693-authentication-granted-to-all-firewalls-instead-of-just-one",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1836/default-remediation-status"
            }
        ]
    }
}