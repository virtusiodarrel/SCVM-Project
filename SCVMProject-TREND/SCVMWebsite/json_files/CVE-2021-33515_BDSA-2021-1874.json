{
    "source": "BDSA",
    "name": "BDSA-2021-1874",
    "title": "Dovecot Vulnerable to Man-in-the-Middle (MitM) Attack and Command Injection via 'STARTTLS' in 'SMTP'",
    "description": "Dovecot contains a command injection vulnerability via `STARTTLS` in `SMTP`. An attacker could exploit this and mount a man-in-the-middle (MitM) attack in order to inject unencrypted commands into the TLS context and redirect user credentials and mails to themselves.",
    "technicalDescription": "This issue occurs in the `cmd_starttls_start()` and the `cmd_starttls_next()` functions of the `src/lib-smtp/smtp-server-cmd-starttls.c` file and the `smtp_server_connection_handle_input()` function of the `src/lib-smtp/smtp-server-connection.c` file due to missing checks. It was mitigated by the addition of checks which ensure that the input handler does not read any more commands once it has been locked via the `STARTTLS` command.",
    "publishedDate": "2021-06-22T14:07:13.891Z",
    "updatedDate": "2021-06-22T14:07:13.886Z",
    "disclosureDate": "2021-06-21T00:00:00.000Z",
    "exploitPublishDate": "2021-06-21T00:00:00.000Z",
    "solution": "Fixed in [**2.3.14.1**](https://github.com/dovecot/core/releases/tag/2.3.14.1) by [this](https://github.com/dovecot/core/commit/65bd1a27a361545c9ccf405b955c72a9c4d29b38) commit.\nFixed in [**2.3.15**](https://github.com/dovecot/core/releases/tag/2.3.15) by [this](https://github.com/dovecot/core/commit/321c339756f9b2b98fb7326359d1333adebb5295) commit.\n\nThe latest stable releases are available [here](https://github.com/dovecot/core/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Fabian Ising and Damian Poddebniak of M\u00fcnster University of Applied Sciences",
    "workaround": "",
    "vendorFixDate": "2021-05-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1874",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33515",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1874/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dovecot/core/commit/321c339756f9b2b98fb7326359d1333adebb5295",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dovecot/core/commit/65bd1a27a361545c9ccf405b955c72a9c4d29b38",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dovecot/core/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dovecot/core/releases/tag/2.3.14.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dovecot/core/releases/tag/2.3.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1204962",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1204962",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1874/default-remediation-status"
            }
        ]
    }
}