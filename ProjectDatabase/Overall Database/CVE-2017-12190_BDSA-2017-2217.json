{
    "source": "BDSA",
    "name": "BDSA-2017-2217",
    "title": "Linux Kernel SCSI IO Vector Memory Leak when Merging Small Consecutive Buffers Leads to Denial of Service (*DoS*)",
    "description": "An attacker can cause the Linux kernel to leak memory causing an out of memory error by issuing read/write commands to a SCSI disk.  This could allow the attacker to cause a denial of service (*DoS*) of the host machine if a SCSI disk is passed through to virtual machines.",
    "technicalDescription": "The functions `bio_map_user_iov()` and `bio_unmap_user()` in `block/bio.c` do unbalanced page ref-counting if an IO vector has small consecutive buffers belonging to the same page. `bio_add_pc_page()` merges them into one, but the page reference is never dropped, causing memory leak.  This requires root privileges, however an attacker may leak host memory if the SCSI disk is passed through to their virtual machine (*VM*).",
    "publishedDate": "2017-12-12T18:01:46.704Z",
    "updatedDate": "2018-10-03T07:02:06.186Z",
    "disclosureDate": "2017-09-21T00:00:00.000Z",
    "exploitPublishDate": "2017-09-21T00:00:00.000Z",
    "solution": "Upgrade to kernel versions: **3.2.95**, **3.16.50**, **3.18.76**, **4.1.46**, **4.4.93**, **4.9.57**, **4.13.8**, **4.14-rc5**\n\nAlternatively apply the patches:  [patch1](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=95d78c28b5a85bacbc29b8dba7c04babb9b0d467) [patch2](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=2b04e8f6bbb196cab4b232af0f8d48ff2c7a8058)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 5.1,
        "severity": "MEDIUM",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:A/AC:L/Au:S/C:N/I:N/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Vitaly Mayatskikh",
    "workaround": "",
    "vendorFixDate": "2017-10-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2217",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-401"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-12190",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2217/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1495089",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=2b04e8f6bbb196cab4b232af0f8d48ff2c7a8058",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=95d78c28b5a85bacbc29b8dba7c04babb9b0d467",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mail-archive.com/linux-kernel@vger.kernel.org/msg1495884.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mail-archive.com/linux-kernel@vger.kernel.org/msg1495887.html",
                "label": "POC"
            }
        ]
    }
}