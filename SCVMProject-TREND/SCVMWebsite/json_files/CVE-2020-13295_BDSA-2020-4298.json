{
    "source": "BDSA",
    "name": "BDSA-2020-4298",
    "title": "GitLab Runner Vulnerable to Server-Side Request Forgery (SSRF) via Malicious Redirects with Docker Client",
    "description": "GitLab Runner is vulnerable to server-side request forgery (SSRF) due to an improper implementation of shared runners in the docker client. This could allow an attacker to perform malicious actions as if they originated from the target server.",
    "technicalDescription": "The issue exists within the file `helpers/docker/official_docker_client.go`. The docker client will follow redirect responses sent by the `dockerd` daemon. This could allow an attacker in control of a compromised daemon to send crafted requests to local host, local network, and link-local addresses within the shared runner. This could enable them to perform malicious actions such as accessing the instance's metadata server, or use large responses to cause a denial-of-service (DoS) via resource exhaustion.",
    "publishedDate": "2021-03-26T14:39:54.434Z",
    "updatedDate": "2021-03-26T14:39:54.427Z",
    "disclosureDate": "2020-08-07T00:00:00.000Z",
    "exploitPublishDate": "2020-09-08T00:00:00.000Z",
    "solution": "Fixed in:\n* [**13.2.2**](https://gitlab.com/gitlab-org/gitlab-runner/-/tags/v13.2.2) by [this](https://gitlab.com/gitlab-org/gitlab-runner/-/commit/0e8b57a1d1b3a1d2b461ca80d40e30f1b5409174) commit\n* [**13.1.2**](https://gitlab.com/gitlab-org/gitlab-runner/-/tags/v13.1.2) by [this](https://gitlab.com/gitlab-org/gitlab-runner/-/commit/059173d7f15adc856a8aa4a12a2430127cde62ca) commit\n* [**13.0.2**](https://gitlab.com/gitlab-org/gitlab-runner/-/tags/v13.0.2) by [this](https://gitlab.com/gitlab-org/gitlab-runner/-/commit/159b1a2ee7b63c125dd26210a8444cb3b11ec79f) commit",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.3,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-07-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4298",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13295",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4298/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/cves/-/blob/master/2020/CVE-2020-13295.json",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-runner/-/commit/059173d7f15adc856a8aa4a12a2430127cde62ca",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-runner/-/commit/0e8b57a1d1b3a1d2b461ca80d40e30f1b5409174",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-runner/-/commit/159b1a2ee7b63c125dd26210a8444cb3b11ec79f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-runner/-/tags/v13.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-runner/-/tags/v13.1.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-runner/-/tags/v13.2.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/209096",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/209096",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4298/default-remediation-status"
            }
        ]
    }
}