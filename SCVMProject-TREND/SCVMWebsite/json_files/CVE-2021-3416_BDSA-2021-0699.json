{
    "source": "BDSA",
    "name": "BDSA-2021-0699",
    "title": "QEMU Vulnerable to Denial-of-Service (DoS) via Stack Overflow in NIC Emulator Components",
    "description": "QEMU is vulnerable to denial-of-service (DoS) due to the improper management of system memory resources. A local attacker could impact the performance of QEMU, or cause it to crash, by running a malicious guest.",
    "technicalDescription": "QEMU is capable of emulating a variety of network interface cards (NICs). The emulated devices can utilize DMA in order to exchange data with the system. The DMA API can utilize re-entrant code, which implements checks in order to ensure that the correct control flow is implemented. Whenever an emulated card is in loopback mode, these checks can be bypassed. This can lead to an infinite loop, in which each loop cycle involves a function call. Each function call will create a new stack frame. A stack overflow can therefore occur, which will cause the application to crash. A local attacker could therefore cause a DoS by causing QEMU to run a maliciously crafted guest that will trigger this infinite loop (or by running a malicious process).",
    "publishedDate": "2021-03-19T17:08:38.336Z",
    "updatedDate": "2021-04-19T11:22:20.288Z",
    "disclosureDate": "2021-02-25T00:00:00.000Z",
    "solution": "Fixed in [**6.0.0-rc0**](https://git.qemu.org/?p=qemu.git;a=tag;h=722580a134f3a4080fe084d16f4c3dd7592ed05a) by the following commits:\n* [Commit 1](https://git.qemu.org/?p=qemu.git;a=commit;h=705df5466c98f3efdd2b68d3b31dad86858acad7)\n* [Commit 2](https://git.qemu.org/?p=qemu.git;a=commit;h=1caff0340f49c93d535c6558a5138d20d475315c)\n* [Commit 3](https://git.qemu.org/?p=qemu.git;a=commit;h=331d2ac9ea307c990dc86e6493e8f0c48d14bb33)\n* [Commit 4](https://git.qemu.org/?p=qemu.git;a=commit;h=26194a58f4eb83c5bdf4061a1628508084450ba1)\n* [Commit 5](https://git.qemu.org/?p=qemu.git;a=commit;h=8c92060d3c0248bd4d515719a35922cd2391b9b4)\n* [Commit 6](https://git.qemu.org/?p=qemu.git;a=commit;h=8c552542b81e56ff532dd27ec6e5328954bdda73)\n* [Commit 7](https://git.qemu.org/?p=qemu.git;a=commit;h=5311fb805a4403bba024e83886fa0e7572265de4)\n* [Commit 8](https://git.qemu.org/?p=qemu.git;a=commit;h=99ccfaa1edafd79f7a3a0ff7b58ae4da7c514928)\n* [Commit 9](https://git.qemu.org/?p=qemu.git;a=commit;h=e73adfbeec9d4e008630c814759052ed945c3fed)\n* [Commit 10](https://git.qemu.org/?p=qemu.git;a=commit;h=37cee01784ff0df13e5209517e1b3594a5e792d1)\n\nThe latest stable releases are available [here](https://download.qemu.org/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-03-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0699",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-835"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3416",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0699/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1932827",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://download.qemu.org/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=commit;h=1caff0340f49c93d535c6558a5138d20d475315c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=commit;h=26194a58f4eb83c5bdf4061a1628508084450ba1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=commit;h=331d2ac9ea307c990dc86e6493e8f0c48d14bb33",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=commit;h=37cee01784ff0df13e5209517e1b3594a5e792d1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=commit;h=5311fb805a4403bba024e83886fa0e7572265de4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=commit;h=705df5466c98f3efdd2b68d3b31dad86858acad7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=commit;h=8c552542b81e56ff532dd27ec6e5328954bdda73",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=commit;h=8c92060d3c0248bd4d515719a35922cd2391b9b4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=commit;h=99ccfaa1edafd79f7a3a0ff7b58ae4da7c514928",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=commit;h=e73adfbeec9d4e008630c814759052ed945c3fed",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=tag;h=722580a134f3a4080fe084d16f4c3dd7592ed05a",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0699/default-remediation-status"
            }
        ]
    }
}