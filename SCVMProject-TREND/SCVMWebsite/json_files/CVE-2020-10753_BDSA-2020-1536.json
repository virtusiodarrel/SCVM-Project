{
    "source": "BDSA",
    "name": "BDSA-2020-1536",
    "title": "Ceph Vulnerable to HTTP Header Injection via 'ExposeHeader' Responses",
    "description": "Ceph is vulnerable to HTTP header injection due to improper response validation in the RadosGW (Ceph Object Gateway). This could allow an attacker to inject arbitrary malicious headers when cross-origin resource sharing (CORS) requests are performed.",
    "technicalDescription": "The issue exists in the function `RGWCORSRule::format_exp_headers()` within the file `src/rgw/rgw_cors.cc`. The function does not sanitize newlines in `ExposeHeader` responses, which could allow injection of arbitrary headers in responses to systems performing requests to the RadosGW S3 API. This could be leveraged by an attacker to perform malicious actions such as setting arbitrary cookies using `Set-Cookie`.\n\nOnly the RadosGW S3 API is affected by this vulnerability. The Swift API is unaffected.",
    "publishedDate": "2020-06-26T15:26:21.903Z",
    "updatedDate": "2021-09-08T15:10:54.993Z",
    "disclosureDate": "2020-06-25T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/ceph/ceph/commit/ea0a33719e1765a79eb0c7137262b8e93cd073e3) commit in:\n* **[14.2.10](https://github.com/ceph/ceph/releases/tag/v14.2.10)**\n* **[15.2.4](https://github.com/ceph/ceph/releases/tag/v15.2.4)**\n* **[16.1.0](https://github.com/ceph/ceph/releases/tag/v16.1.0)**",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "William Bowling",
    "workaround": "",
    "vendorFixDate": "2020-06-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1536",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10753",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1536/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/commit/ea0a33719e1765a79eb0c7137262b8e93cd073e3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/pull/35773",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases/tag/v14.2.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases/tag/v15.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases/tag/v16.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q2/214",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1536/default-remediation-status"
            }
        ]
    }
}