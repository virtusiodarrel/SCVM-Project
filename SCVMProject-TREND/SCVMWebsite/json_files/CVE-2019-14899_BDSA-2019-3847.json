{
    "source": "BDSA",
    "name": "BDSA-2019-3847",
    "title": "Various Operating System VPN Protocol Implementations Vulnerable to Network Discovery, Traffic Discovery and Traffic Injection",
    "description": "Various VPN systems interact with the underlying operating system's packet routing subsystem in an insecure manner. A network adjacent attacker could discover sensitive information relating to VPN network connections, such as the sites that are being visited, and inject traffic into such sessions. They could accomplish this by tricking a victim into connecting to a malicious router or access point. Only route based VPNs are impacted.",
    "technicalDescription": "The problem exists because under certain system configurations (`rp_filter` set to \u201cloose\u201d mode in Linux for example) elements of a connection can be spoofed and brute forced. The `rp_filter` configuration is specified in the file `50-default.conf`, within the `systemd` repository. \n\nThe attack involves spoofing packets and brute forcing various elements of the TCP/UDP protocol. Specifically there are three elements to the attack.\n1) Discovery of the  VPN  clients virtual IP address.  This involves sending spoofed and brute forced `SYN-ACK` packets to the victim device. When the correct virtual IP receives a `SYN-ACK` the victim responds with a `RST` while it instead does nothing when the wrong IP is guessed.\n2) Using this information and traffic analysis to make inferences about active connections. This is similar to the previous step in that the victim will respond with two challenge `ACK`s rather than a `RST` if the attacker spoofs and brute forces the correct port that the victim is using for a connection with `SYN-ACK` packets.\n3) Using the encrypted replies to unsolicited packets to determine the sequence and acknowledgment numbers of the active connection to hijack the TCP session.\n\nAn attacker can carry out the attack by tricking a victim into connecting to a malicious router or access point.\n\nThe affected operating systems include Linux, FreeBSD, OpenBSD, MacOS, iOS and Android. Essentially, most common Unix network stacks are affected. FreeBSD and OpenBSD are vulnerable due to unspecified configuration settings contained within `/etc/rc`. Only route based VPNs are impacted.",
    "publishedDate": "2019-12-09T16:28:16.370Z",
    "updatedDate": "2020-07-29T15:02:13.946Z",
    "disclosureDate": "2019-12-04T00:00:00.000Z",
    "exploitPublishDate": "2019-12-04T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.2,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNCORROBORATED",
            "score": 3.7
        },
        "vector": "(AV:A/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:U/RC:UR)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "REASONABLE",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:U/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "William J. Tolley, Beau Kujath, Jedidiah R. Crandall",
    "workaround": "",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3847",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-345"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14899",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3847/ranges"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q4/122",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q4/122",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3847/default-remediation-status"
            }
        ]
    }
}