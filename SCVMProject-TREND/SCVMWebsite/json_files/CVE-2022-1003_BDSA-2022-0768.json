{
    "source": "BDSA",
    "name": "BDSA-2022-0768",
    "title": "Mattermost Vulnerable to Privilege Escalation via Privilege Chaining",
    "description": "Mattermost is vulnerable to privilege escalation due to an unsafe combination of privileges which could allow system administrators to perform restricted actions that would be prohibited otherwise. This could allow an attacker to gain more privileges in a system.",
    "technicalDescription": "The vulnerability exists in the file `api4/config.go` within the function `migrateConfig()`. There are insufficient checks on cloud system administrator permissions for this API. An attacker who has cloud system admin privileges could exploit this vulnerability to perform actions beyond their restrictions. \n\nThis has been mitigated by introducing a check on user privileges in the same file. If the user is a cloud system administrator, an exception is raised and access is forbidden.",
    "publishedDate": "2022-03-21T15:06:31.362Z",
    "updatedDate": "2022-03-21T15:06:31.347Z",
    "disclosureDate": "2022-01-19T00:00:00.000Z",
    "solution": "Fixed in version [**6.4.0**](https://github.com/mattermost/mattermost-server/releases/tag/v6.4.0) by [this](https://github.com/mattermost/mattermost-server/commit/0b4626442632f19524e34e922dd8836d46fe7c72) commit.\n\nThe latest stable releases can be found [here](https://github.com/mattermost/mattermost-server/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 0.7,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rohitesh Gupta",
    "workaround": "",
    "vendorFixDate": "2022-01-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0768",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-268"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-1003",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0768/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/commit/0b4626442632f19524e34e922dd8836d46fe7c72",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/pull/19373",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/releases/tag/v6.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mattermost.com/security-updates/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0768/default-remediation-status"
            }
        ]
    }
}