{
    "source": "BDSA",
    "name": "BDSA-2020-1075",
    "title": "OpenNMS Vulnerable to Remote Code Execution (RCE) via Deserialization of Untrusted Data",
    "description": "OpenNMS is vulnerable to remote code execution (RCE) via deserialization of untrusted data. A remote attacker can take advantage of this by sending malicious MQ messages.",
    "technicalDescription": "In addition to the web interface and REST API users can also interact with OpenNMS via MQ channels which allow bidirectional client communication using ActiveMQ. Clients that communicate in this way are called minions and require that a minion user with the security role `ROLE_MINION` is added. By sending malicious MQ messages from a minion an attacker can take advantage of \"gadgets\" on the classpath of the target and achieve remote code execution.",
    "publishedDate": "2020-05-12T22:54:22.379Z",
    "updatedDate": "2020-07-15T11:54:15.862Z",
    "disclosureDate": "2020-04-30T00:00:00.000Z",
    "exploitPublishDate": "2020-04-17T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/OpenNMS/opennms/commit/e21fc14ce355533493da0db815bd81a66e291382) commit in:\n* [**26.1.0-1**](https://github.com/OpenNMS/opennms/releases/tag/opennms-26.1.0-1)\n* [**2018.1.18-1**](https://github.com/OpenNMS/opennms/releases/tag/meridian-foundation-2018.1.18-1)\n* [**2019.1.6-1**](https://github.com/OpenNMS/opennms/releases/tag/meridian-foundation-2019.1.6-1)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Florian Hauser",
    "workaround": "",
    "vendorFixDate": "2020-04-20T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1075",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12760",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1075/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/commit/e21fc14ce355533493da0db815bd81a66e291382",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/pull/2983",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/releases/tag/meridian-foundation-2018.1.18-1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/releases/tag/meridian-foundation-2019.1.6-1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/releases/tag/opennms-26.0.1-1",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/releases/tag/opennms-26.1.0-1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.opennms.org/browse/NMS-12673",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://issues.opennms.org/browse/NMS-12673",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.opennms.com/en/blog/2020-04-29-opennms-horizon-26-0-1-luchador-released/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.opennms.com/en/blog/2020-04-29-opennms-meridian-2018-1-18-wildfire-released/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.opennms.com/en/blog/2020-04-29-opennms-meridian-2019-1-6-europa-released/",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1075/default-remediation-status"
            }
        ]
    }
}