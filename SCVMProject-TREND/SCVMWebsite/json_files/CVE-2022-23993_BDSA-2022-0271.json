{
    "source": "BDSA",
    "name": "BDSA-2022-0271",
    "title": "pfSense Vulnerable to Cross-Site Scripting (XSS) via Insufficient Sanitization of 'pkg_filter' Value",
    "description": "pfSense is vulnerable to a cross-site scripting (XSS) issue due to the insufficient sanitization of the user-supplied `pkg_filter` parameter.\n\nAn attacker could trick a victim into following a crafted link in order to execute malicious scripts in the context of the victim's browser, with the aim of stealing information such as cookies or manipulating the rendering of the page.",
    "technicalDescription": "To remedy this issue, the vendor has updated the `src/usr/local/www/pkg.php` file by adding sanitization for the `pkg_filter` parameter and removing instances where this value is echoed to the user.",
    "publishedDate": "2022-01-28T12:33:18.355Z",
    "updatedDate": "2022-01-28T12:33:18.341Z",
    "disclosureDate": "2022-01-25T00:00:00.000Z",
    "solution": "Fixed in the **master** branch by [this](https://github.com/pfsense/pfsense/commit/5d82cce0d615a76b738798577a28a15803e59aeb) commit which is not yet available in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-01-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0271",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23993",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0271/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pfsense/pfsense/commit/32c477c5219626be348eb5c5f17751b4a151515c",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pfsense/pfsense/commit/5d82cce0d615a76b738798577a28a15803e59aeb",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pfsense/pfsense/commit/5d82cce0d615a76b738798577a28a15803e59aeb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pfsense/pfsense/commit/b000f96faa31e538d8ca4420fa25b58b8f37aff4",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0271/default-remediation-status"
            }
        ]
    }
}