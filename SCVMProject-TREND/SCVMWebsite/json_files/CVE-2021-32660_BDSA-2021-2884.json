{
    "source": "BDSA",
    "name": "BDSA-2021-2884",
    "title": "Backstage TechDocs Vulnerable to Cross-Site Scripting (XSS) via TechDocs Sanitization Bypass",
    "description": "Backstage TechDocs is vulnerable to cross-site scripting (XSS) due to the TechDocs API's ability to bypass the application's content filtering functionality. A remote authenticated attacker could execute malicious scripts in the browser of a victim by tricking them into viewing crafted documentation content via the TechDocs API. In situations where the TechDocs API is hosted on the same origin as the Backstage application or a related backstage plugin, then the attacker may be able to recover sensitive data.",
    "technicalDescription": "The TechDocs API does not perform the same sanitization on documentation content that would be performed by the TechDocs front end. A remote authenticated attacker could upload documentation content that contains maliciously crafted scripts, which will then be executed within the browser of a victim who views that content via the API. If the API is hosted on the same origin as the Backstage application (or another Backend plugin) then the malicious script could potentially access sensitive data that is associated with the application or plugin (e.g. session tokens).\n\nThe vulnerability was fixed by ensuring that the TechDocs API implements the same sanitization process as the TechDocs front end.",
    "publishedDate": "2021-09-29T12:25:12.159Z",
    "updatedDate": "2021-09-29T12:25:12.148Z",
    "disclosureDate": "2021-06-03T00:00:00.000Z",
    "solution": "Fixed in version [**0.6.4**](https://www.npmjs.com/package/@backstage/techdocs-common) by [this](https://github.com/backstage/backstage/commit/aad98c544e59369901fe9e0a85f6357644dceb5c) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-05-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2884",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32660",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2884/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/backstage/backstage/commit/aad98c544e59369901fe9e0a85f6357644dceb5c",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/backstage/backstage/security/advisories/GHSA-pwhf-39xg-4rxw",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/@backstage/techdocs",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2884/default-remediation-status"
            }
        ]
    }
}