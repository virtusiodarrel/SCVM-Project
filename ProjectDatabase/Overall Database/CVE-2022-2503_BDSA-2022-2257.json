{
    "source": "BDSA",
    "name": "BDSA-2022-2257",
    "title": "Linux Kernel Vulnerable to LoadPin Trusted Kernel Module and Firmware Verification Bypass via dm-verity Table Reload",
    "description": "The Linux kernels LoadPin feature used by dm-verity is vulnerable to a bypass of trusted module/firmware loading. A local privileged attacker on the machine could force the loading of specially crafted kernel modules or firmware that would allow the execution of arbitrary code in the kernel. This could also force the persistence of devices that do not verify the authenticity of firmware updates.",
    "technicalDescription": "The Dm-verity functionality was implemented to extend the root-of-trust to root filesystems for several distributions, including ChromeOS, Container-Optimized OS and Android. The LoadPin feature was implemented on top of this to restrict module/firmware loads to just the trusted root filesystem. A bypass exists because the device-mapper subsystem allows a root user to switch out the target with an equivalent dm-linear target and bypass verification till reboot. This can allow the loading of untrusted kernel modules and firmware.\n\nThe flaw was fixed by adding the `DM_TARGET_IMMUTABLE` feature property to the `verity_target`so that target types cannot be switched.",
    "publishedDate": "2022-08-15T09:41:13.854Z",
    "updatedDate": "2022-08-15T09:41:13.840Z",
    "disclosureDate": "2022-07-11T00:00:00.000Z",
    "exploitPublishDate": "2022-07-11T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.9.317**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=27798cca4e54fe9c390396c4cc655480f827bbd5) commit\n* [**4.14.282**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=388bc1e69663956f8cee43af3bd02bd3061d222d) commit\n* [**4.19.246**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6bff6107d1364c95109609c3fd680e6c8d7fa503) commit\n* [**5.4.197**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fd2f7e9984850a0162bfb6948b98ffac9fb5fa58) commit\n* [**5.10.120**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8df42bcd364cc3b41105215d841792aea787b133) commit\n* [**5.15.45**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=69712b170237ec5979f168149cd31e851a465853) commit\n* [**5.17.13**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a40560bbf6228ecf754d45aa7b1c50b488fed519) commit\n* [**5.18.2**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=417c73db67ea7ad8f03dfd34c6b0bb5f54294fa9) commit\n* [**5.19-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4caae58406f8ceb741603eee460d79bacca9b1b5) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.7,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-06-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.0,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-2257",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-305"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-345"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2022-2503",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-2257/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=27798cca4e54fe9c390396c4cc655480f827bbd5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=388bc1e69663956f8cee43af3bd02bd3061d222d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=417c73db67ea7ad8f03dfd34c6b0bb5f54294fa9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4caae58406f8ceb741603eee460d79bacca9b1b5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=69712b170237ec5979f168149cd31e851a465853",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6bff6107d1364c95109609c3fd680e6c8d7fa503",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8df42bcd364cc3b41105215d841792aea787b133",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a40560bbf6228ecf754d45aa7b1c50b488fed519",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fd2f7e9984850a0162bfb6948b98ffac9fb5fa58",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/security-research/security/advisories/GHSA-6vq3-w69p-w63m",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/security-research/security/advisories/GHSA-6vq3-w69p-w63m",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}