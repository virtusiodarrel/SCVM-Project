{
    "source": "BDSA",
    "name": "BDSA-2020-1584",
    "title": "Squid Vulnerable to HTTP Request Smuggling and Cache Poisoning via Flawed 'Content-Length' Header Interpretation",
    "description": "Squid is vulnerable to HTTP request smuggling and cache poisoning due to the mishandling of a particular request header. A remote authenticated attacker could conduct this request smuggling and cache poisoning by submitting maliciously crafted HTTP messages to a vulnerable server. It should be noted that the attacker requires the participation of an upstream server in order to carry out this attack.",
    "technicalDescription": "The HTTP `Content-Length` header is parsed by Squid using code contained within the file `ContentLengthInterpreter.cc`. This file contains the function `Http::ContentLengthInterpreter::checkValue()`, which can detect if certain illegal prefixes are present within the value of the header. However, there are certain illegal prefixes that this function fails to detect, including the explicit `+` and `-` signs. If these prefixes are present, the parser can fail to interpret the header correctly, which can lead to HTTP request smuggling and cache poisoning. \n\nA remote authenticated attacker could carry out such attacks by sending maliciously crafted requests to a vulnerable server, provided they are able to get a suitable upstream server to participate in the attack. According to the vendor, most popular server software are not vulnerable to participation in this attack.",
    "publishedDate": "2020-07-06T10:35:00.998Z",
    "updatedDate": "2020-07-06T10:35:00.992Z",
    "disclosureDate": "2020-06-26T00:00:00.000Z",
    "solution": "Fixed in [**5.0.3**](http://www.squid-cache.org/Versions/v5/) by [this](https://github.com/squid-cache/squid/commit/485c9a7bb1bba88754e07ad0094647ea57a6eb8d) commit.\n\nFixed in [**4.12**](http://www.squid-cache.org/Versions/v4/) by [this](https://github.com/squid-cache/squid/commit/ea12a34d338b962707d5078d6d1fc7c6eb119a22) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.5,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alex Rousskov (The Measurement Factory), Amit Klein (Safebreach)",
    "workaround": "",
    "vendorFixDate": "2020-05-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1584",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15049",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1584/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v5/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/485c9a7bb1bba88754e07ad0094647ea57a6eb8d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/ea12a34d338b962707d5078d6d1fc7c6eb119a22",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-qf3v-rc95-96j5",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1584/default-remediation-status"
            }
        ]
    }
}