{
    "source": "BDSA",
    "name": "BDSA-2021-3226",
    "title": "Prisma Vulnerable to Command Injection via 'getPackedPackage' Function",
    "description": "Prisma contains a command injection vulnerability.  This vulnerability lies within the sdk package. The vulnerable code path is only called during tests and while building the CLI tools. This mitigates the attack vector to a client using the library in a unintended way, while also supplying untrusted input to variables used by the library.",
    "technicalDescription": "The command injection occurs in the `getPackedPackage` function in `src/packages/sdk/src/getPackedPackage.ts`.  The commands `yarn pack` or `npm pack` are supplied with unescaped arguments. The unescaped arguments are `archivePath` and  `packageDir` respectively.  It is possible to modify the supplied directory name to include a shell escape character and additional commands that will be passed to the command line (`execa.command`).",
    "publishedDate": "2021-10-26T16:30:07.062Z",
    "updatedDate": "2021-10-26T16:30:07.045Z",
    "disclosureDate": "2021-03-31T00:00:00.000Z",
    "solution": "Fixed in version [**2.20.0**](https://github.com/prisma/prisma/releases/tag/2.20.0) by [this](https://github.com/prisma/prisma/commit/05e8c867aa20204d36e776c82a0cc0fcca25c83b) commit.\n\nThe latest stable releases can be found [here](https://github.com/prisma/prisma/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Erik Krogh Kristensen",
    "workaround": "",
    "vendorFixDate": "2021-03-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3226",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21414",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3226/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/prisma/prisma/commit/05e8c867aa20204d36e776c82a0cc0fcca25c83b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/prisma/prisma/pull/6245",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/prisma/prisma/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/prisma/prisma/releases/tag/2.20.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/prisma/prisma/security/advisories/GHSA-pxcc-hj8w-fmm7",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3226/default-remediation-status"
            }
        ]
    }
}