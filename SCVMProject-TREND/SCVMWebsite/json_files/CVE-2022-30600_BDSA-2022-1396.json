{
    "source": "BDSA",
    "name": "BDSA-2022-1396",
    "title": "Moodle Vulnerable to Account Lockout Bypass via Logic Flaw",
    "description": "Moodle contains a login flaw when counting failed login attempts. This can allow an unauthenticated attacker to bypass the account lockout threshold and login to Moodle by means of a brute force attack.",
    "technicalDescription": "This vulnerability exists in the `login_failed_count` parameter of the `login_attempt_failed()` function in `lib/authlib.php`.  There is a logic flaw where the value of `login_failed_count` is not consistent across threads, which can lead to the lockout threshold not being honored. This can allow an unauthenticated attacker to bypass the account lockout threshold and login to Moodle by means of a brute force attack. \n\nThe vendor has mitigated against this by wrapping the `login_failed_count` logic in a resource lock and forcing a user preferences cache reload.",
    "publishedDate": "2022-05-20T13:36:17.941Z",
    "updatedDate": "2022-05-20T14:04:33.355Z",
    "disclosureDate": "2022-05-17T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.0.1**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v4.0.1) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=f2ab11aa5b5) commit,\n* [**3.11.7**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.11.7) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=83a8cfb9e4b) commit,\n* [**3.10.11**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.10.11) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=eabd853d0ff) commit,\n* [**3.9.14**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.9.14) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=fa855204af3) commit.\n\nThe latest stable releases are available [here](https://download.moodle.org/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Shamim Rezaie",
    "workaround": "",
    "vendorFixDate": "2022-05-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1396",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-305"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-30600",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1396/ranges"
            },
            {
                "rel": "reference",
                "href": "https://download.moodle.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=83a8cfb9e4b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=eabd853d0ff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=f2ab11aa5b5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=fa855204af3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.10.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.11.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.9.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v4.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=434582",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1396/default-remediation-status"
            }
        ]
    }
}