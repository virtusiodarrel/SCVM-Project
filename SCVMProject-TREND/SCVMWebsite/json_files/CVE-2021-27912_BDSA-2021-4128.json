{
    "source": "BDSA",
    "name": "BDSA-2021-4128",
    "title": "Mautic Vulnerable to Cross-Site Scripting (XSS) via Asset View",
    "description": "Mautic is vulnerable to cross-site scripting (XSS) due to improper sanitization of user-supplied input via the `title` field when the web page is rendered.\n\nAn attacker with create or edit permissions can perform this attack and can use script code to steal sensitive information such as authentication tokens and session cookies when a victim visits a crafted link or a web page.",
    "technicalDescription": "The file that is vulnerable is `mautic/app/bundles/AssetBundle/Views/Asset/preview.html.php` as it contains insufficient sanitization in the function `$activeAsset->getTitle()`.\n\nThis vulnerability was mitigated in the same file by adding correct validation and escaping the output of the function.",
    "publishedDate": "2022-02-22T15:10:48.225Z",
    "updatedDate": "2022-02-22T15:11:18.745Z",
    "disclosureDate": "2021-08-30T00:00:00.000Z",
    "exploitPublishDate": "2021-08-30T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.3.4**](https://github.com/mautic/mautic/releases/tag/3.3.4) by [this](https://github.com/mautic/mautic/commit/6e43bc702ab44d7b26b122cd86b34ff7bbf5da47) commit.\n* [**4.0.0**](https://github.com/mautic/mautic/releases/tag/4.0.0) by [this](https://github.com/mautic/mautic/commit/6fbe359b2093d2ababd2224bf091b06728259d6a) commit.\n\nThe latest stable releases can be found [here](https://github.com/mautic/mautic/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Hoang Nguyen, Rohit Pavaskar",
    "workaround": "",
    "vendorFixDate": "2021-08-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4128",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-27912",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4128/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/commit/6e43bc702ab44d7b26b122cd86b34ff7bbf5da47",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/commit/6e43bc702ab44d7b26b122cd86b34ff7bbf5da47",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/commit/6fbe359b2093d2ababd2224bf091b06728259d6a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/releases/tag/3.3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/releases/tag/4.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/security/advisories/GHSA-rh5w-82wh-jhr8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4128/default-remediation-status"
            }
        ]
    }
}