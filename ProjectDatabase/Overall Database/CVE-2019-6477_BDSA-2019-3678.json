{
    "source": "BDSA",
    "name": "BDSA-2019-3678",
    "title": "BIND Vulnerable to Denial-of-Service (DoS) via Bypass of TCP Clients Limit",
    "description": "BIND is vulnerable to denial-of-service (DoS) via bypassing of the TCP clients limit. This is likely to manifest as an intermittent server problem.",
    "technicalDescription": "BIND should be able to limit the number of TCP clients that can be connected at a given time. The way in which BIND calculates the number of concurrent TCP clients was changed from counting the number of outstanding TCP clients to counting the TCP client connections. On a server with TCP-pipelining enabled a single TCP client can send multiple DNS requests over a single connection. Each outstanding query is treated by BIND as a separate client request, therefore bypassing the TCP clients limit. \n\nWhen pipelining is enabled each incoming query requires a similar resource allocation to a query received without pipelining enabled. A client using a TCP-pipelined connection to a server may consume more resources than the server can handle.  When a TCP connection with a high number of pipelined queries is closed, the load on the server can cause it to be unresponsive.",
    "publishedDate": "2019-11-26T16:42:44.363Z",
    "updatedDate": "2019-11-26T16:42:44.354Z",
    "disclosureDate": "2019-11-20T00:00:00.000Z",
    "solution": "Fixed in: \n* [**9.11.13**](https://gitlab.isc.org/isc-projects/bind9/-/tags/v9_11_13)\n* [**9.14.8**](https://gitlab.isc.org/isc-projects/bind9/-/tags/v9_14_8)\n* [**9.15.6**](https://gitlab.isc.org/isc-projects/bind9/-/tags/v9_15_6)\n\nThe fix for this vulnerability only addresses the memory leak issue. TCP pipelining may still malfunction but it will be limited to a single TCP connection and not degrade service for other clients. An affected client connection may appear to hand but will clear once the client or server initiates a close or reset.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vulnerability can be avoided by disabling server TCP-pipelining:\n\n`keep-response-order { any; };`\n\nThe server must also be restarted because neither a `reload` nor a `reconfig` operation will properly reset currently pipelining TCP clients.",
    "vendorFixDate": "2019-11-19T00:00:00.000Z",
    "vendorNotifiedDate": "2019-11-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-3678",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-6477",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-3678/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/-/tags/v9_11_13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/-/tags/v9_14_8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/-/tags/v9_15_6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://kb.isc.org/docs/cve-2019-6477",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://kb.isc.org/docs/cve-2019-6477",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "www.isc.org/downloads/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}