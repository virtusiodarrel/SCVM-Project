{
    "source": "BDSA",
    "name": "BDSA-2021-4138",
    "title": "Libarchive Vulnerable to Authorization Bypass via Improper Symlink ACL Handling",
    "description": "Libarchive is vulnerable to the bypassing of file access controls due to the incorrect handling of symlinks. An attacker could modify the ACL of files by extracting a maliciously crafted archive on a vulnerable host. This could allow the attacker to access files in an unauthorized manner.",
    "technicalDescription": "The function `set_acl()`, of file `libarchive/archive_disk_acl_freebsd.c`, is used by Libarchive in order to modify ACLs. Insufficient validation is performed on the targets of ACL modification operations. If a target is a symbolic link, and `set_acl()` invokes the `acl_set_file()` helper function in order to perform the modification operation, then the ACL that is modified will be that of the target of the symbolic link, rather than that of the symbolic link itself. An attacker could potentially leverage this issue in order to modify the ACLs of arbitrary files. This could allow the attacker to bypass file access restrictions and obtain sensitive information.",
    "publishedDate": "2022-02-18T17:02:29.027Z",
    "updatedDate": "2022-02-18T17:02:29.009Z",
    "disclosureDate": "2021-08-21T00:00:00.000Z",
    "solution": "Fixed in version [**3.5.2**](https://github.com/libarchive/libarchive/releases/tag/v3.5.2) by [this](https://github.com/libarchive/libarchive/commit/fba4f123cc456d2b2538f811bb831483bf336bad) commit.\n\nThe latest stable releases can be found [here](https://github.com/libarchive/libarchive/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.7,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-08-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4138",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-61"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23177",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4138/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/commit/fba4f123cc456d2b2538f811bb831483bf336bad",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/issues/1565",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/releases/tag/v3.5.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4138/default-remediation-status"
            }
        ]
    }
}