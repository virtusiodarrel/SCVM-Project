{
    "source": "BDSA",
    "name": "BDSA-2020-2587",
    "title": "Gitlab Vulnerable to Cross-Site Scripting (XSS) via Error Tracking Page",
    "description": "It was discovered that Gitlab contains a stored cross-site scripting (XSS) vulnerability. Due to lack of validation of user-supplied input this could allow an attacker to send malicious requests to execute arbitrary web scripts, steal a victim's session cookies and craft other attacks.",
    "technicalDescription": "The vulnerability occurs due to insufficient sanitization of use- supplied input in the error tracking feature.\nMultiple functions in the `app/assets/javascripts/error_tracking/components/stacktrace_entry.vue` file include these user-controlled values in messages using the `sprintf()` function.  \nAn attacker could exploit this to store potentially malicious scripts in user controlled variables which are included in the error tracking page, these scripts will then be executed in the victims browser when the error page is viewed.",
    "publishedDate": "2020-10-01T14:03:41.327Z",
    "updatedDate": "2021-04-29T14:19:08.975Z",
    "disclosureDate": "2020-08-03T00:00:00.000Z",
    "exploitPublishDate": "2020-08-03T00:00:00.000Z",
    "solution": "Fixed in: \n* [**13.1.2**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.1.2) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/11e9b7b58837da351f08c18e6f0f4faba4d7d301) commit,\n* [**13.0.8**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.0.8) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/11e9b7b58837da351f08c18e6f0f4faba4d7d301) commit,\n* [**12.10.13**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.10.13) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/5b4f92ef7a4e402bb59834dfea7aa1b043b78017) commit.\n\nThe latest stable releases are available [here](https://gitlab.com/gitlab-org/gitlab-foss/-/tags)",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.0,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 1.0,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "mike12",
    "workaround": "",
    "vendorFixDate": "2020-07-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2587",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13336",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2587/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2020/07/01/security-release-13-1-2-release/#cross-site-scripting-in-bitbucket-import-feature",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/cves/-/blob/master/2020/CVE-2020-13336.json",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/11e9b7b58837da351f08c18e6f0f4faba4d7d301",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/5b4f92ef7a4e402bb59834dfea7aa1b043b78017",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.10.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.0.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.1.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/215970",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2587/default-remediation-status"
            }
        ]
    }
}