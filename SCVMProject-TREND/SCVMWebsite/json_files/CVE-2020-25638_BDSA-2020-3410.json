{
    "source": "BDSA",
    "name": "BDSA-2020-3410",
    "title": "Hibernate ORM Vulnerable to SQL Injection via Unsafe SQL Debugging Functionality",
    "description": "Hibernate ORM is vulnerable to SQL injection due to the unsafe implementation of comments that are intended for debugging purposes. A remote attacker could potentially recover, modify or delete sensitive information that resides in back-end databases by submitting crafted requests that abuse these comments. It should be noted that only instances of Hibernate ORM that use a non-default configuration are affected.",
    "technicalDescription": "Hibernate ORM contains debugging functionality which adds comments to SQL statements. These are stored in the `comment` variable, and are added to statements via the `append()` function. These comments may include escape characters, which will not be sanitized. An attacker could use these escape characters in order to craft malicious SQL statements which will allow them to extract, modify or delete sensitive information in back-end databases. It should be noted that in order for the vulnerability to exist, Hibernate ORM must have a non-default configuration which uses the setting `hibernate.use_sql_comments=true` (the default is `false`).",
    "publishedDate": "2020-11-19T13:39:19.676Z",
    "updatedDate": "2020-12-04T12:21:44.956Z",
    "disclosureDate": "2020-11-19T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.4.24**](https://github.com/hibernate/hibernate-orm/releases/tag/5.4.24) by [this](https://github.com/hibernate/hibernate-orm/commit/36ebf7d3836e83e99f2a91777b5389e1daf1f2b7) commit.\n* [**5.3.20**](https://github.com/hibernate/hibernate-orm/releases/tag/5.3.20) by [this](https://github.com/hibernate/hibernate-orm/commit/d22bbb5c339c9df7712c3365bb1df97c91b35ec5) commit.\n\nThe latest stable releases are available [here](https://hibernate.org/orm/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vulnerability can be mitigated by using the setting `hibernate.use_sql_comments=false`.",
    "vendorFixDate": "2020-11-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3410",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25638",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3410/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hibernate/hibernate-orm/commit/36ebf7d3836e83e99f2a91777b5389e1daf1f2b7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hibernate/hibernate-orm/commit/d22bbb5c339c9df7712c3365bb1df97c91b35ec5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hibernate/hibernate-orm/releases/tag/5.3.20",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hibernate/hibernate-orm/releases/tag/5.4.24",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hibernate.atlassian.net/browse/HHH-14225",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hibernate.atlassian.net/browse/HHH-14225",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://hibernate.org/orm/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3410/default-remediation-status"
            }
        ]
    }
}