{
    "source": "BDSA",
    "name": "BDSA-2019-3903",
    "title": "DNSMasq Vulnerable to Denial-of-Service (DoS) via Infinite Loop in 'create_helper()' Function",
    "description": "DNSMasq is vulnerable to denial-of-service due to the mismanagement of system memory resources. A remote attacker could cause a victim's instance of the application to crash by generating a DHCP response in a malicious manner.",
    "technicalDescription": "The function `create_helper()`, which is defined within `helper.c`, performs a variety of operations in memory. These involve creating and manipulating buffers within the heap, which are accessed using pointer variables such as `p` and `action_str`. This function contains a `while` loop in which the condition is simply `(1)`. This means that the loop will run forever, unless the code execution path is directed to a statement that will explicitly terminate the loop. If data possessing certain properties is being parsed within this loop, the code's flow will never be redirected to the terminating statement. This loop will therefore continue to run indefinitely, which can lead to an exhaustion of memory resources due to the memory manipulation that the loop performs. This will cause the program to crash. A remote attacker could therefore cause a denial-of-service (DoS) by providing the application with crafted data that will trigger the aforementioned infinite loop condition.",
    "publishedDate": "2019-12-13T11:23:11.078Z",
    "updatedDate": "2020-07-06T10:13:30.943Z",
    "disclosureDate": "2019-10-23T00:00:00.000Z",
    "solution": "Fixed in [**2.81-rc1**](http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=tag;h=refs/tags/v2.81rc1) by [this](http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=69bc94779c2f035a9fffdb5327a54c3aeca73ed5) commit.\n\nThe latest stables releases can be found [here](http://www.thekelleys.org.uk/dnsmasq)",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.7,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.2,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-08-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.2,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-3903",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-402"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-835"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-14834",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-3903/ranges"
            },
            {
                "rel": "reference",
                "href": "http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=69bc94779c2f035a9fffdb5327a54c3aeca73ed5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=tag;h=refs/tags/v2.81rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.thekelleys.org.uk/dnsmasq",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1764425",
                "label": "ADVISORY"
            }
        ]
    }
}