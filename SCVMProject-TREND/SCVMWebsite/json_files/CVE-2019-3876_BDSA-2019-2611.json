{
    "source": "BDSA",
    "name": "BDSA-2019-2611",
    "title": "OpenShift OAuth Server Vulnerable to Cross-site Scripting (XSS) Generation of CLI Tokens due to Missing X-Frame-Options and Cross-site Request Forgery (CSRF) Protections",
    "description": "The OpenShift OAuth server is vulnerable to a cross-site request forgery (CSRF) vulnerability being able to allow the generation of CLI tokens. A remote attacker with an additional cross-site scripting (XSS) vulnerability could trick a user of the site to click on a specially crafted link that would then generate CLI tokens and exfiltrate them.",
    "technicalDescription": "The `/oauth/token/request` custom endpoint of the OpenShift OAuth server is missing X-Frame-Options and CSRF protections. This means that an additional XSS vulnerability could exfiltrate CLI tokens to an attacker.",
    "publishedDate": "2019-08-16T11:46:42.377Z",
    "updatedDate": "2019-08-16T11:46:42.368Z",
    "disclosureDate": "2019-07-25T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/openshift/origin/commit/1183798c31d2339b16bfec3db6d6125049f60cd5) commit.  It is not yet part of any stable release.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Mo Khan",
    "workaround": "The vendor supplies the following workaround:\n\nThe `corsAllowedOrigin` definition within `master-config.yaml` should contain elements in the form :\n\n```\ncorsAllowedOrigins:\n- (?i)//my\\.subdomain\\.domain\\.com(:|\\z)\n```\n\nand not the form\n\n```\ncorsAllowedOrigins:\n- domain.com\n```\n\nThe first will permit cross origin requests only if the host matches exactly, whereas the second will permit from any host that merely contains the string (such as ABCDdomain.com or even domain.comABCD.com).",
    "vendorFixDate": "2019-06-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2611",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3876",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2611/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/errata/RHSA-2019:1851",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openshift/origin/commit/1183798c31d2339b16bfec3db6d6125049f60cd5",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2611/default-remediation-status"
            }
        ]
    }
}