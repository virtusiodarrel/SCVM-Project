{
    "source": "BDSA",
    "name": "BDSA-2022-1877",
    "title": "Mermaid Vulnerable to Information Disclosure via Arbitrary Cascading Stylesheet (CSS) Injection",
    "description": "Mermaid is vulnerable to arbitrary cascading style sheet (CSS) injection which could allow for the disclosure of sensitive information. An attacker could exploit this flaw by sending HTTP requests to load crafted CSS and trick a user in to performing unwanted actions such as navigating to a malicious link.",
    "technicalDescription": "Due to insufficient escaping of input, this vulnerability could be exploited by an attacker by using a bruteforce technique on the input field attribute `value` to craft a HTTP request. This would involve looping through one character at a time in order to find a correct match which will then send a request loading an image to communicate to the attacker what the value of that character is, leading to information disclosure. \n\nThis could also allow an attacker to change the format of documents and web pages via CSS selectors and functions and have a user perform unwanted actions. \n\nThis vulnerability has been mitigated by escaping user input before it is embedded within the CSS blocks of the application.",
    "publishedDate": "2022-07-06T13:26:04.900Z",
    "updatedDate": "2022-07-06T13:26:04.882Z",
    "disclosureDate": "2022-06-28T00:00:00.000Z",
    "exploitPublishDate": "2022-06-28T00:00:00.000Z",
    "solution": "Fixed in version [**9.1.3**](https://github.com/mermaid-js/mermaid/releases/tag/9.1.3) by [this](https://github.com/mermaid-js/mermaid/commit/0ae1bdb61adff1cd485caff8c62ec6b8ac57b225) commit.\n\nThe latest stable releases can be found [here](https://github.com/mermaid-js/mermaid/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-06-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1877",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-74"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31108",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1877/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mermaid-js/mermaid/commit/0ae1bdb61adff1cd485caff8c62ec6b8ac57b225",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mermaid-js/mermaid/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mermaid-js/mermaid/releases/tag/9.1.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mermaid-js/mermaid/security/advisories/GHSA-x3vm-38hw-55wf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mermaid-js/mermaid/security/advisories/GHSA-x3vm-38hw-55wf",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1877/default-remediation-status"
            }
        ]
    }
}