{
    "source": "BDSA",
    "name": "BDSA-2020-4271",
    "title": "Singularity Vulnerable to Information Disclosure and Content Injection via Insecure Permissions on Temporary Directories",
    "description": "Singularity is vulnerable to information disclosure and content injection issues due to how temporary directories used in container execution have insecure permissions.\n\nAn attacker could use this flaw to read the contents of the affected image, or potentially inject arbitrary content into the running container.",
    "technicalDescription": "Singularity is vulnerable to information disclosure and content injection because the temporary sandbox directory that container images are extracted to when an action command (`run`, `shell`, `exec`) is run with the `fakeroot` or `user namespace` option, has insecure permissions set.\n\nThe insecure permissions on the directory could allow any user with access to the system the ability to read the contents of the image, or in the case of an image that contains a world-writable file or directory, inject arbitrary content into the running container.",
    "publishedDate": "2021-03-29T14:54:59.341Z",
    "updatedDate": "2021-04-01T16:17:46.708Z",
    "disclosureDate": "2020-09-15T00:00:00.000Z",
    "solution": "Fixed in [**3.6.3**](https://github.com/hpcng/singularity/releases/tag/v3.6.3) by [this](https://github.com/hpcng/singularity/commit/98ad49a3de9043ea287d65f4d544632ff074e506) commit.\n\nThe latest stable releases are available [here](https://github.com/hpcng/singularity/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "xman",
    "workaround": "The vendor has stated [here](https://github.com/hpcng/singularity/security/advisories/GHSA-w6v2-qchm-grj7), that the issue can potentially be mitigated if `TMPDIR` is set to a location that is only accessible to the user, as any subdirectories directly under `TMPDIR` cannot then be accessed by others. The vendor believes this is difficult to enforce, so it is not recommended to rely on this as a mitigation.",
    "vendorFixDate": "2020-09-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4271",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-276"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25039",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4271/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/commit/98ad49a3de9043ea287d65f4d544632ff074e506",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases/tag/v3.6.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/security/advisories/GHSA-w6v2-qchm-grj7",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/security/advisories/GHSA-w6v2-qchm-grj7",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4271/default-remediation-status"
            }
        ]
    }
}