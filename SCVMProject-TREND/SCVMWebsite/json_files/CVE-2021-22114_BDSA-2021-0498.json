{
    "source": "BDSA",
    "name": "BDSA-2021-0498",
    "title": "Spring Integration Zip Vulnerable to Arbitrary File Write via Unsanitized File Names",
    "description": "Spring Integration Zip is vulnerable to an arbitrary file write vulnerability via a directory traversal. An attacker could exploit this vulnerability by supplying the component with a maliciously crafted archive that, when unpacked, would cause an arbitrary file to be written to the file system.",
    "technicalDescription": "This vulnerability arises due to a failure to sanitize file names contained within archives. An attacker who is capable of uploading a malicious archive and causing it to be unpacked by the target component could write arbitrary files to the file system.\n\nMost archive programs will not allow users to archive files that contain characters that are considered special by the operating system, such as the `../` combination that refers to the parent directory of the current folder. However, by directly editing the archive with a hex editor, an attacker could easily circumvent such a restriction. By editing the archive in such a way that it contains a file named (for example) `../../../../../../temp/foo.txt`, they could write a file called `foo.txt` to the `temp` directory off the root of the file system. The operating system generally does not care how many `../` sequences are used, as any attempt to go up one level from root will simply lead back to root.\n\nThe impact of this vulnerability depends on whether or not the system administrator has set the correct privileges throughout the file system, or whether there are folders that the component can write to and also execute code directly from.\n\nThis issue is fixed in `UnZipTransformer.java` by ensuring that the directory the file is being unzipped into is the same as the the intended output directory.\n\nThis vulnerability was first reported to be fixed in version **1.0.1**, followed by an additional fix in **1.0.2** (`CVE-2018-1261`, `CVE-2018-1263`). However, it has been found that special file names could still be used to exploit the vulnerability, resulting in `CVE-2021-22114`, which has also been fixed.",
    "publishedDate": "2021-03-02T12:02:02.563Z",
    "updatedDate": "2021-03-02T12:02:02.549Z",
    "disclosureDate": "2021-01-28T00:00:00.000Z",
    "solution": "Fixed in [**1.0.4**](https://github.com/spring-projects/spring-integration-extensions/releases/tag/zip.v1.0.4.RELEASE) by the following commits:\n* [Commit 1](https://github.com/spring-projects/spring-integration-extensions/commit/a5573eb232ff85199ff9bb28993df715d9a19a25)\n* [Commit 2](https://github.com/spring-projects/spring-integration-extensions/commit/d10f537283d90eabd28af57ac97f860a3913bf9b)\n* [Commit 3](https://github.com/spring-projects/spring-integration-extensions/commit/ad398071e205b24c0fb58ae7401ac4a97a7cf759)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Trung Pham, Viettel Cyber Security",
    "workaround": "",
    "vendorFixDate": "2021-02-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0498",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22114",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0498/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-integration-extensions/commit/a5573eb232ff85199ff9bb28993df715d9a19a25",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-integration-extensions/commit/ad398071e205b24c0fb58ae7401ac4a97a7cf759",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-integration-extensions/commit/d10f537283d90eabd28af57ac97f860a3913bf9b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-integration-extensions/releases/tag/zip.v1.0.4.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://tanzu.vmware.com/security/cve-2021-22114",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0498/default-remediation-status"
            }
        ]
    }
}