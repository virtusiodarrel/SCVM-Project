{
    "source": "BDSA",
    "name": "BDSA-2021-1714",
    "title": "Jetty Vulnerable to Information Disclosure via Double Encoding in Requests to 'ConcatServlet' and 'WelcomeFilter'",
    "description": "Jetty is vulnerable to information disclosure due to improper requested path verification. This allows crafted requests to access protected resources of the web application which, depending on the implementation, might reveal sensitive information.",
    "technicalDescription": "Requests to the `ConcatServlet` and `WelcomeFilter` are able to access protected resources within the `WEB-INF directory`. This is possible due to both `ConcatServlet` and `WelcomeFilter` decoding the supplied path to verify it is not in `WEB-INF` or `META-INF` directories. Since the decoded path is used in the call to the `RequestDispatcher` servlet, it decodes the path again, resulting in double decoding. This means a double encoded `WEB-INF` directory in a request would bypass the security checks.",
    "publishedDate": "2021-06-10T14:50:04.347Z",
    "updatedDate": "2021-06-10T15:04:35.827Z",
    "disclosureDate": "2021-06-09T00:00:00.000Z",
    "exploitPublishDate": "2021-06-09T00:00:00.000Z",
    "solution": "Fixed in [**9.4.41**](https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.41.v20210512) by [this](https://github.com/eclipse/jetty.project/commit/1c05b0bcb1) commit.\n\nFixed in [**10.0.3**](https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.3) and [**11.0.3**](https://github.com/eclipse/jetty.project/releases/tag/jetty-11.0.3) by [this](https://github.com/eclipse/jetty.project/commit/f58dbedcd0) commit.\n\nThe latest stable releases are available [here](https://www.eclipse.org/jetty/download.php).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "stevenseeley (GitHub)",
    "workaround": "The vendor provides the following workaround:\n\nIf you cannot update to the latest version of Jetty, you can instead deploy your own version of the `ConcatServlet` and/or the `WelcomeFilter` by using the code from the latest version of Jetty.",
    "vendorFixDate": "2021-05-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1714",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28169",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1714/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/commit/1c05b0bcb1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/commit/f58dbedcd0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-11.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.41.v20210512",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/security/advisories/GHSA-gwcr-j4wh-j3cq",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/security/advisories/GHSA-gwcr-j4wh-j3cq",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/security/advisories/GHSA-gwcr-j4wh-j3cq",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.eclipse.org/jetty/download.php",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1714/default-remediation-status"
            }
        ]
    }
}