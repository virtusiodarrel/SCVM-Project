{
    "source": "BDSA",
    "name": "BDSA-2019-1732",
    "title": "Spring Security Oauth Vulnerable to Open Redirect via 'DefaultRedirectResolver'",
    "description": "Spring Security OAuth is vulnerable to open redirection that can leak an authorization code to an attacker. An attacker can redirect a user agent to a URI under the control of the attacker who can then steal the authorization code.",
    "technicalDescription": "The flaw exists in source file `java/org/springframework/security/oauth2/provider/endpoint/DefaultRedirectResolver.java`. The boolean parameter `matchSubdomains` is set to true by default during initial configuration. This allows an attacker to specify a manipulated redirection URI via the `redirect_uri` parameter in a crafted request to the authorization endpoint using the authorization code grant type. This can cause the authorization server to redirect the resource owner user-agent to a URI under the control of the attacker with the leaked authorization code.\n\nApplications which act in the role of an Authorization Server (e.g.` @EnableAuthorizationServer`) and which use the `DefaultRedirectResolver` (default) in the `AuthorizationEndpoint`, are vulnerable to this flaw. Applications which use a different `RedirectResolver`, are not vulnerable. Applications which act in the role of a Resource Server (e.g. `@EnableResourceServer`) or as a Client (e.g. `@EnableOAuthClient`), are not vulnerable. \n\nUsers of Spring Boot **1.5.x** and Spring IO Platform Cairo should override the `spring-security-oauth `version to the latest version containing the patch. Spring Boot **1.5.x**. users should upgrade to **2.0.18.RELEASE**. Spring IO Platform Cairo users should change their version to **2.2.5.RELEASE**.",
    "publishedDate": "2019-06-10T14:57:17.180Z",
    "updatedDate": "2022-08-26T14:58:11.643Z",
    "disclosureDate": "2019-05-30T00:00:00.000Z",
    "solution": "Fixed in:\n* [**2.3.6**](https://github.com/spring-projects/spring-security-oauth/releases/tag/2.3.6.RELEASE) by [this](https://github.com/spring-projects/spring-security-oauth/commit/f769ff98) commit,\n* [**2.2.5**](https://github.com/spring-projects/spring-security-oauth/releases/tag/2.2.5.RELEASE) by [this](https://github.com/spring-projects/spring-security-oauth/commit/346bb74d) commit,\n* [**2.1.5**](https://github.com/spring-projects/spring-security-oauth/releases/tag/2.1.5.RELEASE) by [this](https://github.com/spring-projects/spring-security-oauth/commit/cb714f4c) commit,\n* [**2.0.18**](https://github.com/spring-projects/spring-security-oauth/releases/tag/2.0.18.RELEASE) by [this](https://github.com/spring-projects/spring-security-oauth/commit/1434dcf0) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mike Noordermeer",
    "workaround": "",
    "vendorFixDate": "2019-05-28T00:00:00.000Z",
    "vendorNotifiedDate": "2019-05-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1732",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-345"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-601"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11269",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1732/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/commit/1434dcf0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/commit/346bb74d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/commit/cb714f4c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/commit/f769ff98",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/releases/tag/2.0.18.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/releases/tag/2.1.5.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/releases/tag/2.2.5.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/releases/tag/2.3.6.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://pivotal.io/security/cve-2019-11269",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://projects.spring.io/spring-security-oauth/docs/oauth2.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://spring.io/blog/2019/05/30/cve-2019-11269-spring-security-oauth-2-3-6-2-2-5-2-1-5-2-0-18-released",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1732/default-remediation-status"
            }
        ]
    }
}