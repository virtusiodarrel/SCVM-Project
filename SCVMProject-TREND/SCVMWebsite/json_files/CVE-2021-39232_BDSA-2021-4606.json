{
    "source": "BDSA",
    "name": "BDSA-2021-4606",
    "title": "Apache Ozone Vulnerable to Improper Authorization via Missing Authorization Checks",
    "description": "Apache Ozone contains an improper authorization vulnerability. An authenticated attacker could exploit this issue by executing unauthorized commands that only an 'admin' is expected to perform due to missing authorization checks.",
    "technicalDescription": "This vulnerability exists within the `hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/server/SCMClientProtocolServer.java` file due to missing authorization checks for executing 'admin' SCM commands. \n\nThis has been mitigated in the same file by introducing authorization checks `getScm().checkAdminAccess()` so that only 'admin' users can execute specific SCM commands.",
    "publishedDate": "2022-09-09T15:45:55.636Z",
    "updatedDate": "2022-09-14T15:42:02.538Z",
    "disclosureDate": "2020-12-16T00:00:00.000Z",
    "solution": "Fixed in version [**1.1.0RC1**](https://github.com/apache/ozone/releases/tag/ozone-1.1.0-RC1) by [this](https://github.com/apache/ozone/commit/475db7b715fee8495fab29f33866a91ef28b0a5b) commit.\n\nThe latest stable releases can be found [here](https://ozone.apache.org/downloads/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wei-Chiu Chuang",
    "workaround": "",
    "vendorFixDate": "2021-01-12T00:00:00.000Z",
    "vendorNotifiedDate": "2020-12-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4606",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-862"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39232",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4606/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ozone/commit/475db7b715fee8495fab29f33866a91ef28b0a5b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ozone/pull/1710",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ozone/releases/tag/ozone-1.1.0-RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/HDDS-4530",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/v7p4w7r4fb3kmy1ds0klvbrr0y2dtz83",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ozone.apache.org/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4606/default-remediation-status"
            }
        ]
    }
}