{
    "source": "BDSA",
    "name": "BDSA-2022-2131",
    "title": "Joplin Vulnerable to Remote Code Execution (RCE) via Cross-Site Scripting (XSS) in 'GotoAnything' Dialog",
    "description": "Joplin is vulnerable to cross-site scripting (XSS), which may lead to remote code execution (RCE), due to improper sanitization of user-supplied input. This could allow an attacker to inject arbitrary web scripts and obtain sensitive information such as authentication tokens and user session cookies via a crafted payload.",
    "technicalDescription": "This vulnerability exists within the `packages/lib/string-utils.js` file in the `surroundKeywords` function. It contains insufficient escaping of user input when searching (`Ctrl+P`) for specific keywords within a notebook and is triggered when the search is completed. RCE can be achieved by sharing the vulnerable notebook.\n\nThis was mitigated in the same file by escaping the output of the function when the search is performed.",
    "publishedDate": "2022-08-01T14:58:13.212Z",
    "updatedDate": "2022-08-01T14:58:13.202Z",
    "disclosureDate": "2022-07-25T00:00:00.000Z",
    "exploitPublishDate": "2022-07-25T00:00:00.000Z",
    "solution": "Fixed in version [**2.9.1**](https://github.com/laurent22/joplin/releases/tag/v2.9.1) by [this](https://github.com/laurent22/joplin/commit/e797ebb864fbf429a49b6d20e5779d0c9aa6c4d5) commit.\n\nThe latest stable releases can be found [here](https://github.com/laurent22/joplin/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ly1g3",
    "workaround": "",
    "vendorFixDate": "2022-06-30T00:00:00.000Z",
    "vendorNotifiedDate": "2022-06-15T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2131",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-35131",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2131/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laurent22/joplin/commit/e797ebb864fbf429a49b6d20e5779d0c9aa6c4d5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laurent22/joplin/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laurent22/joplin/releases/tag/v2.9.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ly1g3/Joplin-CVE-2022-35131",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ly1g3/Joplin-CVE-2022-35131",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2131/default-remediation-status"
            }
        ]
    }
}