{
    "source": "BDSA",
    "name": "BDSA-2022-1786",
    "title": "Espressif Bluetooth Mesh SDK Vulnerable to Memory Corruption via 'SegN' Field During PDU Provisioning",
    "description": "Espressif\u2019s Bluetooth Mesh SDK contains a memory corruption vulnerability which can be triggered during Protocol Data Unit (PDU) provisioning. An attacker could send a Provisioning PDU with an invalid `SegN` field, which would cause the message handled by the firmware to be much larger than the current buffer could store. This would result in the corruption of the global buffer, which could be exploited to cause a crash, unexpected behaviour, or potentially a complete takeover of the targeted system.",
    "technicalDescription": "",
    "publishedDate": "2022-07-11T15:28:58.342Z",
    "updatedDate": "2022-07-11T15:28:58.333Z",
    "disclosureDate": "2022-06-23T00:00:00.000Z",
    "solution": "Fixed in:\n* **[4.3.3](https://github.com/espressif/esp-idf/releases/tag/v4.3.3)** by [this](https://github.com/espressif/esp-idf/commit/b4ef1b80a2) commit,\n* **release/v4.1** branch by [this](https://github.com/espressif/esp-idf/commit/5aa6fa39ea) commit which is not yet included in any release,\n* **release/v4.2** branch by [this](https://github.com/espressif/esp-idf/commit/7691b8effb) commit which is not yet included in any release,\n* **release/v4.4** branch by [this](https://github.com/espressif/esp-idf/commit/7a34692e6f) commit which is not yet included in any release,\n* **master** branch by [this](https://github.com/espressif/esp-idf/commit/a094532785) commit which is not yet included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.2,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:A/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Han Yan, Lewei Qu, Dongxiang Ke from Baidu AIoT Security Team",
    "workaround": "",
    "vendorFixDate": "2022-04-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1786",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-788"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24893",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1786/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espressif/esp-idf/commit/5aa6fa39ea",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espressif/esp-idf/commit/7691b8effb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espressif/esp-idf/commit/7a34692e6f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espressif/esp-idf/commit/a094532785",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espressif/esp-idf/commit/b4ef1b80a2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espressif/esp-idf/releases/tag/v4.3.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espressif/esp-idf/security/advisories/GHSA-7f7f-jj2q-28wm",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1786/default-remediation-status"
            }
        ]
    }
}