{
    "source": "BDSA",
    "name": "BDSA-2020-4573",
    "title": "Maxsite Vulnerable to Cross-Site Scripting via Insufficient Input Validation in Multiple Functions",
    "description": "Maxsite is vulnerable to cross-site scripting (XSS) due to the insufficient validation of client-provided input data. A remote attacker could execute malicious scripts in the browser of a victim by tricking that victim into clicking on a maliciously crafted link. This could allow the attacker to obtain sensitive information, such as session cookies.",
    "technicalDescription": "Maxsite utilizes multiple functions that obtain the URI from a client's request. These include:\n\n* `mso_menu_build()` (of file `application/maxsite/common/core/format.php`).\n* `mso_segment_array()`, `mso_url_get()`, and `mso_get_permalink_page()` (of file `application/maxsite/common/core/url.php`).\n* `global_cache_uninstall()` (of file `application/maxsite/plugins/global_cache/index.php`).\n* `sape_init()` (of file `application/maxsite/plugins/sape/index.php`). \n\nThese functions use the URI to dynamically generate content that will be returned to the client. For example, the `mso_menu_build()` function, of file `application/maxsite/common/core/format.php`, is used to obtain a series of HTML `li` elements that together constitute a list of menu items. Some of the content that is contained in these elements is derived from the URI path that is specified in the client's request. Whenever the path is extracted (via `$_SERVER['REQUEST_URI']`), its value is not sanitized or validated. If the value contains a XSS payload, that payload will be included within the list of menu items. Whenever the menu is rendered on the screen, the payload will be executed. \n\nAn attacker could therefore perform reflected XSS attacks against a victim by tricking them into clicking on a crafted link which will cause one of the aforementioned functions to be executed. This could allow the attacker to obtain sensitive information, such as browser cookies.",
    "publishedDate": "2021-08-04T14:18:38.619Z",
    "updatedDate": "2021-08-04T14:18:38.612Z",
    "disclosureDate": "2020-10-21T00:00:00.000Z",
    "exploitPublishDate": "2020-10-21T00:00:00.000Z",
    "solution": "Fixed in [**108**](https://github.com/maxsite/cms/releases/tag/v108) by [this](https://github.com/maxsite/cms/commit/6b0ab1de9f3d471485d1347e800a9ce43fedbf1a) commit.\n\nThe latest stable releases are available [here](https://github.com/maxsite/cms/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-10-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4573",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-35265",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4573/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/maxsite/cms/commit/6b0ab1de9f3d471485d1347e800a9ce43fedbf1a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/maxsite/cms/issues/414",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/maxsite/cms/issues/414",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/maxsite/cms/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/maxsite/cms/releases/tag/v108",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4573/default-remediation-status"
            }
        ]
    }
}