{
    "source": "BDSA",
    "name": "BDSA-2019-4182",
    "title": "Waitress Vulnerable to HTTP Request Smuggling via Improper 'Transfer-Encoding' Header Parsing",
    "description": "Waitress is vulnerable to HTTP request smuggling due to improper parsing of the `Transfer-Encoding` header. A remote attacker could cause manipulated content to be served to other users, or could potentially cause the disclosure of sensitive information.",
    "technicalDescription": "When parsing the `Transfer-Encoding` header, Waitress only looks for a string `chunked`. If it is not there, the header gets ignored and `Content-Header` is used for determining the request size instead. Such parsing is different from the HTTP standard, meaning that a proxy server used in front of the Waitress application could interpret the HTTP request size differently and relay a single request that would be treated as multiple ones on the Waitress backend. This effectively leads to HTTP request smuggling, which could potentially cause maliciously manipulated web content to be served to other users or disclosure of sensitive information.",
    "publishedDate": "2020-01-14T13:33:46.671Z",
    "updatedDate": "2020-01-14T13:33:46.659Z",
    "disclosureDate": "2019-12-20T00:00:00.000Z",
    "solution": "Fixed in [**1.4.0**](https://github.com/Pylons/waitress/releases/tag/v1.4.0) by [this](https://github.com/Pylons/waitress/commit/f11093a6b3240fc26830b6111e826128af7771c3) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-12-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4182",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-16786",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4182/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Pylons/waitress/commit/f11093a6b3240fc26830b6111e826128af7771c3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Pylons/waitress/releases/tag/v1.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Pylons/waitress/security/advisories/GHSA-g2xc-35jw-c63p",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4182/default-remediation-status"
            }
        ]
    }
}