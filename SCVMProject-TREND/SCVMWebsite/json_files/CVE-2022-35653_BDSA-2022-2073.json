{
    "source": "BDSA",
    "name": "BDSA-2022-2073",
    "title": "Moodle Vulnerable to Reflected Cross-Site Scripting (XSS) via LTI Module",
    "description": "Moodle is vulnerable to reflected cross-site scripting (XSS) in the LTI module. This could allow an unauthenticated attacker  to execute arbitrary code on the victim's machine, which may steal sensitive information such as authentication tokens and user session cookies.",
    "technicalDescription": "This vulnerability exists within the files `mod/lti/classes/output/repost_crosssite_page.php` and `mod/lti/templates/repost_crosssite.mustache` due to improper sanitization of user-supplied data. \n\nIt has been mitigated by correctly escaping HTML when reposting cross site posts.",
    "publishedDate": "2022-07-26T11:23:54.744Z",
    "updatedDate": "2022-08-24T11:25:54.356Z",
    "disclosureDate": "2022-07-18T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* [**3.9.15**](https://github.com/moodle/moodle/releases/tag/v3.9.15) by [this](https://github.com/moodle/moodle/commit/77a1413fa055a5e9af40225f6cbcbce26537a283) commit.\n* [**3.11.8**](https://github.com/moodle/moodle/releases/tag/v3.11.8) by [this](https://github.com/moodle/moodle/commit/f1c0f2849bae856de40499589d47ccab775c90df) commit.\n* [**4.0.2**](https://github.com/moodle/moodle/releases/tag/v4.0.2) by [this](https://github.com/moodle/moodle/commit/b327defe5d2bca62929accd59c0e10b449df73bd) commit.\n\nThe latest stable releases can be found [here](https://github.com/moodle/moodle/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Luuk Verhoeven",
    "workaround": "",
    "vendorFixDate": "2022-07-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2073",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-35653",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2073/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/77a1413fa055a5e9af40225f6cbcbce26537a283",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/b327defe5d2bca62929accd59c0e10b449df73bd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/f1c0f2849bae856de40499589d47ccab775c90df",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.11.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.9.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v4.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=436460",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2073/default-remediation-status"
            }
        ]
    }
}