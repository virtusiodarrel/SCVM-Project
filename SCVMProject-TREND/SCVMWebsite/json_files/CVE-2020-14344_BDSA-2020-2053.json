{
    "source": "BDSA",
    "name": "BDSA-2020-2053",
    "title": "Libx11 Vulnerable to Denial-of-Service (DoS) and Memory Corruption via Integer Overflow in 'X Input Method' Module",
    "description": "Libx11 contains an integer overflow vulnerability. An attacker could exploit this flaw to cause denial-of-service and heap memory corruption by sending malicious input to the X Input Method module.",
    "technicalDescription": "This vulnerability exists in the X Input Method implementation in Libx11, mainly in the `modules/im/ximcp/imRmAttr.c` file. In this file, appropriate bounds checking is not in place for the variable `num`. This could possibly lead to an integer overflow at the following lines:\ni) `alloc_len = sizeof(XIMStyles) + sizeof(XIMStyle) * num;`\nii) `alloc_len = sizeof(XIMHotKeyTriggers) + sizeof(XIMHotKeyTrigger) * num;`\nThis could subsequently lead to a crash.\nFurthermore, the file `modules/im/ximcp/imRmAttr.c` also contains a comparison bug concerning signed/unsigned values. The variables `names_len`, `len`, `min_len` and `values_len` are supposed to contain unsigned (positive) values. But these variables have been declared as signed integers. If these variables contain negative values and they are passed along, it could lead to memory corruption because of comparison issues.\nAlso, appropriate size checking is not in place for the variable `len` in the switch case `XimType_XFontSet`. This could lead to a buffer overflow at line 340: `(void)strncpy(base_name, (char *)&data[1], (size_t)len);`. This could happen when the size of `len` exceeds that of the variable `data_len`, which will lead to extra bytes being copied to `base_name`.\n\n**Note** The fix commit (https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/388b303c62aa35a245f1704211a023440ad2c488) introduces a regression which was fixed later in the following commit: \n\n(https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/93fce3f4e79cbc737d6468a4f68ba3de1b83953b)",
    "publishedDate": "2020-08-14T11:26:27.344Z",
    "updatedDate": "2020-08-14T11:26:27.336Z",
    "disclosureDate": "2020-07-31T00:00:00.000Z",
    "solution": "Fixed in **[1.6.10](https://gitlab.freedesktop.org/xorg/lib/libx11/-/tags/libX11-1.6.10)** by the following commits:\n* [Commit 1](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/1703b9f3435079d3c6021e1ee2ec34fd4978103d)\n* [Commit 2](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/1a566c9e00e5f35c1f9e7f3d741a02e5170852b2)\n* [Commit 3](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/2fcfcc49f3b1be854bb9085993a01d17c62acf60)\n* [Commit 4](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/388b303c62aa35a245f1704211a023440ad2c488)\n* [Commit 5](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/0e6561efcfaa0ae7b5c74eac7e064b76d687544e)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.7,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-07-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2053",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-119"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-680"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14344",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2053/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/0e6561efcfaa0ae7b5c74eac7e064b76d687544e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/1703b9f3435079d3c6021e1ee2ec34fd4978103d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/1a566c9e00e5f35c1f9e7f3d741a02e5170852b2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/2fcfcc49f3b1be854bb9085993a01d17c62acf60",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/388b303c62aa35a245f1704211a023440ad2c488",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/93fce3f4e79cbc737d6468a4f68ba3de1b83953b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/tags/libX11-1.6.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.x.org/archives/xorg-announce/2020-July/003050.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2053/default-remediation-status"
            }
        ]
    }
}