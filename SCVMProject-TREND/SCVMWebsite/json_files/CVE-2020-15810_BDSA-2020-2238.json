{
    "source": "BDSA",
    "name": "BDSA-2020-2238",
    "title": "Squid Vulnerable to HTTP(S) Request Smuggling via Improper Data Validation",
    "description": "Squid is vulnerable to HTTP(S) request smuggling attacks due to improper data validation of HTTP and HTTPS traffic. A remote authenticated attacker could exploit this by submitting maliciously crafted HTTP messages to a vulnerable server, which can result in cache poisoning.",
    "technicalDescription": "This vulnerability is due to improper data validation and can allow an attacker to manipulate the content in a request to contain other malicious requests. Exploiting this, an attacker could poison the proxy cache and any downstream caches. The poisoned cache will be treated as valid.\n\nIt was addressed in the `HttpHeader::parse` function with the file `src/HttpHeader.cc` by adding a `field-name` token as defined in RFC 7230.\n\n\n**Note:** See advice provided by the vendor on whether you are vulnerable or not below.\n\nAll Squid with `relaxed_header_parser` configured \"off\" are not vulnerable.\n\nAll Squid-**3.x** up to and including **3.5.28**:\n* with `relaxed_header_parser` configured to \"on\" or \"warn\" are vulnerable.\n* without `relaxed_header_parser` configured are vulnerable.\n\nAll Squid-**4.x** up to and including **4.12**:\n* with `relaxed_header_parser` configured to \"on\" or \"warn\" are vulnerable.\n* without `relaxed_header_parser` configured are vulnerable.\n\nAll Squid-**5.x** up to and including **5.0.3**: \n* with `relaxed_header_parser` configured to \"on\" or \"warn\" are vulnerable.\n* without `relaxed_header_parser` configured are vulnerable.",
    "publishedDate": "2020-08-31T14:21:44.705Z",
    "updatedDate": "2020-08-31T14:29:03.448Z",
    "disclosureDate": "2020-08-23T00:00:00.000Z",
    "solution": "Fixed in [**4.13**](http://www.squid-cache.org/Versions/) by [this](https://github.com/squid-cache/squid/commit/9c8e2a71aa1d3c159a319d9365c346c48dc783a5) commit and [**5.0.4**](http://www.squid-cache.org/Versions/) by [this](https://github.com/squid-cache/squid/commit/43a14bd954315df0e5a63c96c95bc9e1907d30e6) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 3.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Amit Klein of Safebreach",
    "workaround": "As a workaround, the vendor suggests to disable the relaxed HTTP parser in `squid.conf`:\n\n```\nrelaxed_header_parser off\n```",
    "vendorFixDate": "2020-08-11T00:00:00.000Z",
    "vendorNotifiedDate": "2020-05-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2238",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15810",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2238/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/43a14bd954315df0e5a63c96c95bc9e1907d30e6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/9c8e2a71aa1d3c159a319d9365c346c48dc783a5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-3365-q9qx-f98m",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-3365-q9qx-f98m",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2238/default-remediation-status"
            }
        ]
    }
}