{
    "source": "BDSA",
    "name": "BDSA-2022-1912",
    "title": "NextAuth.js Vulnerable to Phishing Attacks via Improper Handling of Email Input in 'Signin' Endpoint",
    "description": "NextAuth.js is vulnerable to potential phishing style attacks due to how the email `signin` endpoint does not sufficiently sanitize user-supplied email addresses.\n\nAn attacker could pass a crafted email input to the `signin` endpoint in order to trick the server into sending an email to a victim user that contains a potentially malicious link disguised as the user's email address within the HTML of the email body.",
    "technicalDescription": "To remedy this issue, the vendor has opted to not render the user-supplied email address within the HTML of mail sent from the `signin` endpoint.",
    "publishedDate": "2022-07-11T15:59:03.446Z",
    "updatedDate": "2022-07-11T15:59:03.435Z",
    "disclosureDate": "2022-07-06T00:00:00.000Z",
    "exploitPublishDate": "2022-07-01T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.29.8**](https://www.npmjs.com/package/next-auth/v/3.29.8) by [this](https://github.com/nextauthjs/next-auth/commit/35a3ea66209648156e86e4f73c81800ef7afa420) commit and [this](https://github.com/nextauthjs/next-auth/commit/8a133bf5fdbf4d8bebf4d2079a517c9a433d44b6) commit.\n* [**4.9.0**](https://www.npmjs.com/package/next-auth/v/4.9.0) by [this](https://github.com/nextauthjs/next-auth/commit/cd6ccfde898037290ae949d500ace8a378376cd8) commit and [this](https://github.com/nextauthjs/next-auth/commit/ae834f1e08a4a9915665eecb9479c74c6b039c9c) commit.\n\nThe latest stable releases can be found [here](https://github.com/nextauthjs/next-auth/releases).\n\n**Note:** The vendor has recommended in their [advisory](https://github.com/nextauthjs/next-auth/security/advisories/GHSA-pgjx-7f9g-9463) that users should upgrade to **v4** as **v3** is considered unmaintained.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sandiipmaity",
    "workaround": "The vendor has advised [here](https://github.com/nextauthjs/next-auth/security/advisories/GHSA-pgjx-7f9g-9463) that for users who cannot upgrade to a new version, it is possible to sanitize the `email` parameter that is passed to `sendVerificationRequest` and rendered in HTML, or exclude it from the HTML body. More information can be found in the [customizing emails documentation](https://next-auth.js.org/providers/email#customizing-emails).",
    "vendorFixDate": "2022-07-05T00:00:00.000Z",
    "vendorNotifiedDate": "2022-06-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1912",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31127",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1912/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextauthjs/next-auth/blob/cd6ccfde898037290ae949d500ace8a378376cd8/packages/next-auth/tests/email.test.ts",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextauthjs/next-auth/commit/35a3ea66209648156e86e4f73c81800ef7afa420",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextauthjs/next-auth/commit/8a133bf5fdbf4d8bebf4d2079a517c9a433d44b6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextauthjs/next-auth/commit/ae834f1e08a4a9915665eecb9479c74c6b039c9c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextauthjs/next-auth/commit/cd6ccfde898037290ae949d500ace8a378376cd8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextauthjs/next-auth/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-pgjx-7f9g-9463",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-pgjx-7f9g-9463",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://next-auth.js.org/providers/email#customizing-emails",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/next-auth/v/3.29.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/next-auth/v/4.9.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1912/default-remediation-status"
            }
        ]
    }
}