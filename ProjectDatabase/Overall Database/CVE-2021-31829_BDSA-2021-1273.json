{
    "source": "BDSA",
    "name": "BDSA-2021-1273",
    "title": "Linux Kernel Vulnerable to Information Exposure via BPF Stack Memory Disclosure During Speculation",
    "description": "The Linux kernel is vulnerable to information disclosure due to insufficient protections being placed on the Berkeley Packet Filter (BPF) stack. A local attacker could potentially recover sensitive data from kernel memory by running a malicious executable which leverages speculative execution.",
    "technicalDescription": "The file `kernel/bpf/verifier.c` contains code that tries to ensure that BPF stack memory is accessed correctly and safely. This involves the patching and movement of pointer values that are stored in memory and registers. The BPF stack can contain kernel memory that is uninitialized, and so may contain sensitive values from previous use. The verifier does not sufficiently protect this memory whenever speculative operations are being performed. This leads to the existence of a side-channel that can be used to recover the potentially sensitive data from kernel memory.",
    "publishedDate": "2021-05-07T15:02:31.776Z",
    "updatedDate": "2021-10-04T14:49:02.154Z",
    "disclosureDate": "2021-05-03T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.14.236**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=19e4f40ce75079b9532f35f92780db90104648f1) commit,\n* [**4.19.193**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bd9df99da9569befff2234b1201ac4e065e363d0) commit,\n* [**5.4.117**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8ba25a9ef9b9ca84d085aea4737e6c0852aa5bfd) commit,\n* [**5.10.35**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2fa15d61e4cbaaa1d1250e67b251ff96952fa614) commit,\n* [**5.11.19**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b50fb1b08d6cb3b3b4661d254792794ecdfebab4) commit,\n* [**5.12.2**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0356e50a7fa65e9b27cf3363a8f8188608859182) commit,\n* [**5.13-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=801c6058d14a82179a7ee17a4b532cac6fad067f) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.7,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Piotr Krysiuk",
    "workaround": "",
    "vendorFixDate": "2021-05-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.1,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1273",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-399"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-514"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-31829",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1273/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0356e50a7fa65e9b27cf3363a8f8188608859182",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=19e4f40ce75079b9532f35f92780db90104648f1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2fa15d61e4cbaaa1d1250e67b251ff96952fa614",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=801c6058d14a82179a7ee17a4b532cac6fad067f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8ba25a9ef9b9ca84d085aea4737e6c0852aa5bfd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b50fb1b08d6cb3b3b4661d254792794ecdfebab4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bd9df99da9569befff2234b1201ac4e065e363d0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/torvalds/linux/commit/801c6058d14a82179a7ee17a4b532cac6fad067f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}