{
    "source": "BDSA",
    "name": "BDSA-2022-0592",
    "title": "KiCad EDA Vulnerable to Local Code Execution via Stack-Based Buffer Overflow in 'ReadIJCoord' Function",
    "description": "KiCad EDA is vulnerable to a stack-based buffer overflow. An attacker could exploit this flaw which may lead to local code execution by tricking a victim in to running a maliciously crafted file on the application.",
    "technicalDescription": "The vulnerability exists within the file `gerbview/rs274_read_XY_and_IJ_coordinates.cpp`. In the `ReadIJCoord()` function, the char variable `text` is assigned a line buffer length of 256 bytes. There are insufficient checks on `Text` which stores the data supplied to this function. If the data supplied is larger than the bounds of the line buffer, this will cause an overflow.\n\nAn attacker can exploit and trigger this vulnerability by sending a crafted 'gerber' or 'excellon' file that can lead to code execution.\n\nThis has been mitigated in both the `ReadXYCoord()` and `ReadIJCoord()` functions by removing the use of the unchecked stack char array and now reserving the anticipated length of the line buffer rather than a assigning a fixed length.",
    "publishedDate": "2022-03-07T16:03:15.940Z",
    "updatedDate": "2022-03-07T16:03:15.926Z",
    "disclosureDate": "2022-02-16T00:00:00.000Z",
    "exploitPublishDate": "2022-02-16T00:00:00.000Z",
    "solution": "Fixed in version [**6.0.2**](https://github.com/KiCad/kicad-source-mirror/releases/tag/6.0.2) by [this](https://github.com/KiCad/kicad-source-mirror/commit/7ed569058c516974c47b4a506daa3daea4248e05) commit.\n\nThe latest stable releases can be found [here](https://github.com/KiCad/kicad-source-mirror/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Claudio Bozzato",
    "workaround": "",
    "vendorFixDate": "2022-02-03T00:00:00.000Z",
    "vendorNotifiedDate": "2022-02-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0592",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23804",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0592/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/KiCad/kicad-source-mirror/commit/7ed569058c516974c47b4a506daa3daea4248e05",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/KiCad/kicad-source-mirror/releases/tag/6.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/KiCad/kicad-source-mirror/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2022-1453",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2022-1453",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.kicad.org/blog/2022/02/KiCad-6.0.2-Release/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0592/default-remediation-status"
            }
        ]
    }
}