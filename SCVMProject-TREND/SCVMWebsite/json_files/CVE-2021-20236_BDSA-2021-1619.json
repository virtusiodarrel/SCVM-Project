{
    "source": "BDSA",
    "name": "BDSA-2021-1619",
    "title": "ZeroMQ LibZMQ Vulnerable to Denial-of-Service (DoS) via Stack Overflow on Server Running PUB/XPUB Socket",
    "description": "ZeroMQ LibZMQ is vulnerable to denial-of-service (DoS) via a stack overflow on servers running PUB/XPUB sockets. \n\nThis issue affects users with listening TCP PUB/XPUB endpoints who do NOT use CURVE/ZAP for authentication.",
    "technicalDescription": "The PUB/XPUB subscription score or mtrie is traversed using recursive calls. When unsubscribing the recursive calls are not tail calls, so even with optimizations the stack will grow linearly with the length of a topic.   \n\nA remote attacker can send a subscription to arbitrary length topics. As a result the server will create an mtrie which is large enough that when unsubscribing traversing it will cause a stack overflow.",
    "publishedDate": "2021-06-01T13:36:55.347Z",
    "updatedDate": "2021-06-01T13:36:55.341Z",
    "disclosureDate": "2020-09-07T00:00:00.000Z",
    "exploitPublishDate": "2020-05-26T00:00:00.000Z",
    "solution": "Fixed in [**4.3.3**](https://github.com/zeromq/libzmq/releases/tag/v4.3.3) by [this](https://github.com/zeromq/libzmq/commit/e0e3ce081e476522be4007573599b132d73c4655) commit and [this](https://github.com/zeromq/libzmq/commit/ab301ebf799b4dbddb1351d77da49b2e6e1cf8ec) commit. \n\nThe latest stable releases are available [here](https://github.com/zeromq/libzmq/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-06-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1619",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-674"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20236",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1619/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=22488",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zeromq/libzmq/commit/ab301ebf799b4dbddb1351d77da49b2e6e1cf8ec",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zeromq/libzmq/commit/e0e3ce081e476522be4007573599b132d73c4655",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zeromq/libzmq/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zeromq/libzmq/releases/tag/v4.3.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zeromq/libzmq/security/advisories/GHSA-qq65-x72m-9wr8",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1619/default-remediation-status"
            }
        ]
    }
}