{
    "source": "BDSA",
    "name": "BDSA-2019-4023",
    "title": "PHP Vulnerable to Information Exposure and Denial-of-Service (DoS) via Out-of-Bounds Read in BCMath Extension",
    "description": "PHP is vulnerable to information exposure due to improper processing of functions in the BCMath extension. This could allow an attacker to obtain sensitive information from process memory or cause an application crash.",
    "technicalDescription": "The issue exists in the function `bc_str2num` within the file `ext/bcmath/libbcmath/src/str2num.c`. The function does not properly handle non-ASCII numbers which the OS interprets as a value, such as superscript numbers. This can lead to a buffer underflow in the function `bc_shift_addsub` and an out-of-bounds read condition.\n\nExploitability of this issue depends on the specific system configuration - for example, it was found that this issue can cause a crash on Windows 7 SP1 or Windows Server 2016, but a crash does not occur on Windows 10.",
    "publishedDate": "2019-12-23T15:46:02.231Z",
    "updatedDate": "2019-12-23T15:46:02.223Z",
    "disclosureDate": "2019-11-28T00:00:00.000Z",
    "exploitPublishDate": "2019-11-28T00:00:00.000Z",
    "solution": "Fixed in:\n* **[7.4.1](https://github.com/php/php-src/releases/tag/php-7.4.1)** by [this](https://github.com/php/php-src/commit/aa3bb910721cc7e08079e20b9f914a7d684832ee) commit,\n* **[7.3.13](https://github.com/php/php-src/releases/tag/php-7.3.13)** by [this](https://github.com/php/php-src/commit/63d0fa4a92a2c0ce3e4e31cda2e9291e12055c77) commit,\n* **[7.2.26](https://github.com/php/php-src/releases/tag/php-7.2.26)** by [this](https://github.com/php/php-src/commit/2d07f00b73d8f94099850e0f5983e1cc5817c196) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-12-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4023",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11046",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4023/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=78878",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=78878",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/2d07f00b73d8f94099850e0f5983e1cc5817c196",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/63d0fa4a92a2c0ce3e4e31cda2e9291e12055c77",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/aa3bb910721cc7e08079e20b9f914a7d684832ee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.2.26",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.3.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.4.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4023/default-remediation-status"
            }
        ]
    }
}