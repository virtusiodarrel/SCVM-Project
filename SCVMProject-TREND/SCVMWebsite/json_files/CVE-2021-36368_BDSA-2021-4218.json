{
    "source": "BDSA",
    "name": "BDSA-2021-4218",
    "title": "OpenSSH Client Vulnerable to Authentication Prompt Spoofing via 'Trivial Authentication'",
    "description": "OpenSSH Client is vulnerable to authentication prompt spoofing due to improper handling of SSH connections where trivial authentication responses are requested. This could allow an attacker to trick a victim into thinking they are providing credentials for an SSH session when such data is actually being used for other purposes.",
    "technicalDescription": "The issue exists due to insufficient restrictions on SSH connections where trivial or no authentication inputs are required by a malicious server. In such cases a server may still be able to establish the SSH session, then send a spoofed prompt which appears to still be part of the user authentication phase but is able to take input credentials for other purposes.\n\nThe Vendor disputes the validity of this vulnerability, stating [here](https://bugzilla.mindrot.org/show_bug.cgi?id=3316):\n> First, the root cause is forwarding an agent to an attacker-controlled destination - the user is effectively delegating use of their keys to that attacker.\n\n> Second this is not an authentication bypass, since nothing is being bypassed. The user is becoming confused as to the context of a FIDO touch request. That makes this more like phishing than anything else.",
    "publishedDate": "2022-03-14T16:24:11.869Z",
    "updatedDate": "2022-05-31T13:07:33.638Z",
    "disclosureDate": "2021-05-31T00:00:00.000Z",
    "exploitPublishDate": "2021-05-31T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "UNCONFIRMED",
            "score": 3.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:W/RC:UC)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "UNKNOWN",
            "score": 5.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N/E:P/RL:W/RC:U"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Manfred Kaiser (AUT-milCERT)",
    "workaround": "Per the Vendor, this attack may be mitigated by setting `LogLevel=verbose` so **ssh(1)** will print a message at the conclusion of authentication.",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4218",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-345"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-36368",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4218/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mindrot.org/show_bug.cgi?id=3316",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mindrot.org/show_bug.cgi?id=3316",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://docs.ssh-mitm.at/trivialauth.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://docs.ssh-mitm.at/trivialauth.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssh/openssh-portable/pull/258",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssh/openssh-portable/pull/270",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4218/default-remediation-status"
            }
        ]
    }
}