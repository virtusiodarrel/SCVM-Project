{
    "source": "BDSA",
    "name": "BDSA-2021-2011",
    "title": "Zimbra Web Client Vulnerable to Stored Cross-Site Scripting (XSS) via 'ZmMailMsgView' Component",
    "description": "Zimbra Web Client is vulnerable to stored cross-site scripting due to the unsafe generation of web content. An attacker could execute malicious scripts within the browser of a victim by tricking them into opening web content that utilizes malicious data that has been saved by the attacker. This could allow the attacker to obtain sensitive information, such as browser cookies.",
    "technicalDescription": "The function `ZmMailMsgView.prototype._displayContent ()`, which is defined in the script `WebRoot/js/zimbraMail/mail/view/ZmMailMsgView.js`, modifies the attributes of tags that are contained within HTML `form` elements. The modification is performed by an anonymous function, which is passed to the `replace()` method. \n\nThe anonymous function dynamically generates `action` and `target` attributes which will be included in the form that is returned by `ZmMailMsgView.prototype._displayContent ()`. The modified attribute values are obtained from certain patterns that are specified within the HTML content, which in turn correspond to data which has been saved by the user. If such a pattern constitutes a cross-site scripting (XSS) payload, then this will be inserted into the form, and will be executed whenever the form is rendered in a browser. An attacker could exploit this in order to conduct XSS attacks, which could allow them obtain sensitive information (such as browser cookies).",
    "publishedDate": "2021-07-05T14:13:39.067Z",
    "updatedDate": "2021-07-05T14:13:39.062Z",
    "disclosureDate": "2021-06-17T00:00:00.000Z",
    "solution": "Fixed in [**9.0.0-p16**](https://github.com/Zimbra/zm-web-client/releases/tag/9.0.0.p16) by [this](https://github.com/Zimbra/zm-web-client/commit/2ff6afe2ba45955ef01da51d3ee3e8e713abd76f) commit, and in [**8.8.15-p23**](https://github.com/Zimbra/zm-web-client/releases/tag/8.8.15.p23) by [this](https://github.com/Zimbra/zm-web-client/commit/161316137810e9de8bc69abec7ed77e9409c6c20) commit.\n\nThe latest stable releases are available [here](https://github.com/Zimbra/zm-web-client/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-06-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2011",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-35208",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2011/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-web-client/commit/161316137810e9de8bc69abec7ed77e9409c6c20",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-web-client/commit/2ff6afe2ba45955ef01da51d3ee3e8e713abd76f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-web-client/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-web-client/releases/tag/8.8.15.p23",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-web-client/releases/tag/9.0.0.p16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://wiki.zimbra.com/wiki/Zimbra_Releases/9.0.0/P16",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2011/default-remediation-status"
            }
        ]
    }
}