{
    "source": "BDSA",
    "name": "BDSA-2021-0711",
    "title": "Apache Tomcat Vulnerable to Remote Code Execution (RCE) via Improper Directory Validation in 'FileStore' Class",
    "description": "Apache Tomcat is vulnerable to remote code execution (RCE) due to the improper validation of a file storage location. A remote authenticated attacker could execute arbitrary code on a vulnerable server by sending crafted requests to that server.\n\n**Note:** This vulnerability was originally assigned **CVE-2020-9484** (**BDSA-2020-1193**), however it was not completely fixed, and the vendor has stated it is still exploitable using a highly unlikely configuration edge case.",
    "technicalDescription": "The `FileStore` class contains the `directory()` method, which returns a `File` object that specifies the full path to a session persistence directory. This method makes use of the `directory` field, which is a string that specifies the path. The `directory()` method does not perform sufficient validation on this path. This could potentially allow an attacker to upload a file containing a dangerous serialized object, which they could then deserialize via crafted requests in order to achieve arbitrary code execution on the server. \n\nIn order to accomplish this, the attacker must be able to control the contents and name of a file on the server.  They must also know the path to this file relative to the directory used by the `FileStore` component. The server must also be configured to use the `PersistenceManager` with a `FileStore` object, with that `PersistenceManager` being configured with `sessionAttributeValueClassNameFilter=\"null\"`. This is the default case, unless the `SecurityManager` component is in use.\n\n**Note:** This vulnerability was originally assigned **CVE-2020-9484** (**BDSA-2020-1193**), however it was not completely fixed, and the vendor has stated it is still exploitable using a highly unlikely configuration edge case.",
    "publishedDate": "2021-03-22T14:45:45.047Z",
    "updatedDate": "2021-07-09T11:56:06.661Z",
    "disclosureDate": "2021-03-01T00:00:00.000Z",
    "exploitPublishDate": "2020-05-21T00:00:00.000Z",
    "solution": "Fixed in:\n* [**10.0.1**](https://github.com/apache/tomcat/releases/tag/10.0.1) by [this](https://github.com/apache/tomcat/commit/6d66e99ef85da93e4d2c2a536ca51aa3418bfaf4) commit,\n* [**9.0.42**](https://github.com/apache/tomcat/releases/tag/9.0.42) by [this](https://github.com/apache/tomcat/commit/4785433a226a20df6acbea49296e1ce7e23de453) commit,\n* [**8.5.62**](https://github.com/apache/tomcat/releases/tag/8.5.62) by [this](https://github.com/apache/tomcat/commit/93f0cc403a9210d469afc2bd9cf03ab3251c6f35) commit.\n* [**7.0.108**](https://github.com/apache/tomcat/releases/tag/7.0.108) by [this](https://github.com/apache/tomcat/commit/74b105657ffbd1d1de80455f03446c3bbf30d1f5) commit.\n\nThe latest stable releases are available [here](http://tomcat.apache.org/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Trung Pham",
    "workaround": "",
    "vendorFixDate": "2020-01-20T00:00:00.000Z",
    "vendorNotifiedDate": "2021-01-12T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0711",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-25329",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0711/ranges"
            },
            {
                "rel": "reference",
                "href": "http://tomcat.apache.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://tomcat.apache.org/security-10.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/4785433a226a20df6acbea49296e1ce7e23de453",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/6d66e99ef85da93e4d2c2a536ca51aa3418bfaf4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/74b105657ffbd1d1de80455f03446c3bbf30d1f5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/93f0cc403a9210d469afc2bd9cf03ab3251c6f35",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/10.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/7.0.108",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/8.5.62",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/9.0.42",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/masahiro331/CVE-2020-9484",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/rfe62fbf9d4c314f166fe8c668e50e5d9dd882a99447f26f0367474bf%40%3Cannounce.tomcat.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0711/default-remediation-status"
            }
        ]
    }
}