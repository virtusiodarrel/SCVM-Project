{
    "source": "BDSA",
    "name": "BDSA-2020-3190",
    "title": "SPICE vdagent Vulnerable to Session Hijacking via Crafted Client Connections",
    "description": "SPICE vdagent is vulnerable to session hijacking due to improper handling of client connections. A local attacker could exploit this vulnerability by supplying a system with maliciously crafted input.",
    "technicalDescription": "The component does not properly perform user session checks, exposing a race condition which could allow an attacker to hijack a session. If the attacker can force the system to reuse a process ID for a connection - in between the initial `connect()` call to `spice-vdagentd` and the ID being retrieved and checked by `agent_connect()` - this may allow them to associate their connection with a process running in the active session. This can enable privileged actions such as sending maliciously crafted data to the host, retrieving host clipboard content and file data, or denying the legitimate user of the hijacked session access to SPICE features.",
    "publishedDate": "2020-11-06T15:52:28.953Z",
    "updatedDate": "2021-01-22T17:07:20.293Z",
    "disclosureDate": "2020-11-04T00:00:00.000Z",
    "exploitPublishDate": "2020-11-04T00:00:00.000Z",
    "solution": "Fixed in [**0.21.0**](https://gitlab.freedesktop.org/spice/linux/vd_agent/-/tags/spice-vdagent-0.21.0) by [this](https://gitlab.freedesktop.org/spice/linux/vd_agent/-/commit/51c415df82a52e9ec033225783c77df95f387891) commit and [this](https://gitlab.freedesktop.org/spice/linux/vd_agent/-/commit/5c50131797e985d0a5654c1fd7000ae945ed29a7) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matthias Gerstner",
    "workaround": "",
    "vendorFixDate": "2020-09-21T00:00:00.000Z",
    "vendorNotifiedDate": "2020-09-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3190",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25653",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3190/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/spice/linux/vd_agent/-/commit/51c415df82a52e9ec033225783c77df95f387891",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/spice/linux/vd_agent/-/commit/5c50131797e985d0a5654c1fd7000ae945ed29a7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/spice/linux/vd_agent/-/tags/spice-vdagent-0.21.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ubuntu.com/security/notices/USN-4617-1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/11/04/1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/11/04/1",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3190/default-remediation-status"
            }
        ]
    }
}