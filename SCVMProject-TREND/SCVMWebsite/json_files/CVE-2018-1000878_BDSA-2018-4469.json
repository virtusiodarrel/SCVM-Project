{
    "source": "BDSA",
    "name": "BDSA-2018-4469",
    "title": "Libarchive Vulnerable Denial-of-Service (DoS) via Use After Free via 'ppmd7' in RAR Decoder",
    "description": "A use-after-free vulnerability has been discovered in libarchive. An attacker could exploit this vulnerability by crafting a malicious RAR file to cause a denial-of-service (DoS) condition.",
    "technicalDescription": "The `ppmd7` operations utilized in Libarchive RAR decoder located in the file `archive_read_support_format_rar.c` can trigger a use-after-free vulnerability leading to an application crash. The ppmd7 codec is based on slightly modified PPMdH data compression technique which is located in the file `libarchive/archive_ppmd7_private.h`.\n\nA malicious RAR archive which states that it is split across multiple volumes causes the `ppmd7` operations to call the `rar_br_fillup` function. In certain situations this can invoke the  `rar_read_ahead` and `archive_read_format_rar_read_header` functions to be called.  The two functions compare the old and new filenames to see if they contain an exact match, if the match is not correct the buffer would be freed. This can cause an issue as `ppmd7` operations still attempt to utilize the memory which has just been cleaned, resulting in an denial-of-service (DoS) condition.",
    "publishedDate": "2018-12-24T13:39:08.681Z",
    "updatedDate": "2019-08-07T09:32:47.870Z",
    "disclosureDate": "2018-12-03T00:00:00.000Z",
    "solution": "Fixed in version [**3.4.0**](https://github.com/libarchive/libarchive/releases/tag/v3.4.0) by [this](https://github.com/libarchive/libarchive/commit/bfcfe6f04ed20db2504db8a254d1f40a1d84eb28) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-12-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4469",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-1000878",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4469/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/ubuntu/+source/libarchive/+bug/1794909",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/commit/bfcfe6f04ed20db2504db8a254d1f40a1d84eb28",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/pull/1105",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/releases/tag/v3.4.0",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}