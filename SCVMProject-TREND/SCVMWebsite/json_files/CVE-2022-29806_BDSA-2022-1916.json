{
    "source": "BDSA",
    "name": "BDSA-2022-1916",
    "title": "ZoneMinder Vulnerable to Remote Code Execution (RCE) via Arbitrary File Write Chained with Path Traversal",
    "description": "ZoneMinder is vulnerable to remote code execution (RCE) via an arbitrary file write in the debug log file option chained with path traversal in the language settings. An attacker could exploit this by creating a debug log file at an arbitrary pathname before supplying a malicious file to the `ZM_LANG_DEFAULT`value which is automatically appended with `.php` if the file exists.",
    "technicalDescription": "This issue occurs in the `web/includes/lang.php` file. It was mitigated by the introduction of improved validation relating to accepted languages.",
    "publishedDate": "2022-07-11T16:00:55.800Z",
    "updatedDate": "2022-07-11T16:00:55.790Z",
    "disclosureDate": "2022-04-27T00:00:00.000Z",
    "exploitPublishDate": "2022-04-27T00:00:00.000Z",
    "solution": "Fixed in [**1.36.13**](https://github.com/ZoneMinder/zoneminder/releases/tag/1.36.13) by [this](https://github.com/ZoneMinder/zoneminder/commit/2396e98fb94d6f78fd5850c04080605efa094572) commit.\n\nThe latest stable releases can be found [here](https://github.com/ZoneMinder/zoneminder/releases).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Krastanoel",
    "workaround": "There are two possible mitigations but the obvious fix is to validate `ZM_LANG_DEFAULT` option in `includes/lang.php#L46` to prevent the path traversal. We could also validate the `ZM_LOG_DEBUG_FILE` to only allow specific file extension eg: .`txt`,`log` or define static directory where the log file should be write eg: `/var/log/zm` to prevent future chained attacks.",
    "vendorFixDate": "2022-02-08T00:00:00.000Z",
    "vendorNotifiedDate": "2022-02-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1916",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-29806",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1916/ranges"
            },
            {
                "rel": "reference",
                "href": "https://forums.zoneminder.com/viewtopic.php?t=31638",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ZoneMinder/zoneminder/commit/2396e98fb94d6f78fd5850c04080605efa094572",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ZoneMinder/zoneminder/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ZoneMinder/zoneminder/releases/tag/1.36.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://krastanoel.com/cve/2022-29806",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://krastanoel.com/cve/2022-29806",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/166980/ZoneMinder-Language-Settings-Remote-Code-Execution.html",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1916/default-remediation-status"
            }
        ]
    }
}