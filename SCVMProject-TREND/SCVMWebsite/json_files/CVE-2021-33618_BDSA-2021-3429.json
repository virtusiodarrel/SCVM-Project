{
    "source": "BDSA",
    "name": "BDSA-2021-3429",
    "title": "Dolibarr Vulnerable to Stored Cross-Site Scripting (XSS) via Insufficient Sanitization in Pop-Up Windows",
    "description": "Dolibarr is vulnerable to a stored cross-site scripting (XSS) issue due to a lack of sufficient input sanitization in pop-up windows.\n\nAn authenticated attacker could abuse this issue by submitting malicious scripts using the affected components that can execute when a victim user browses to the affected content. Such scripts could be used to steal information from the victim, like browser cookies, or manipulate the web page in unintended ways.",
    "technicalDescription": "Dolibarr is vulnerable to stored cross-site scripting (XSS) because greater than (`>`) and smaller than (`<`) characters are not escaped by the application when reflected in small pop-up windows within the details of a given object. This flaw can allow attackers to add custom HTML tags and attributes meaning that it is possible to craft an input that can execute scripts in the context of a victim user's browser.",
    "publishedDate": "2021-11-12T12:23:36.119Z",
    "updatedDate": "2021-11-12T12:23:36.108Z",
    "disclosureDate": "2021-11-10T00:00:00.000Z",
    "exploitPublishDate": "2021-11-10T00:00:00.000Z",
    "solution": "Fixed in [**14.0.0**](https://github.com/Dolibarr/dolibarr/releases/tag/14.0.0) by [this](https://github.com/Dolibarr/dolibarr/commit/9d44df8a64e0857e0647ba08312a7301500f03f8) commit.\n\nThe latest stable releases are available [here](https://www.dolibarr.org/downloads.php).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Trovent Security GmbH, Nick Decker",
    "workaround": "The third-party reporter has recommended [here](https://trovent.io/security-advisory-2105-02) that user input should be escaped regardless of where it is reflected and that all HTML tags and attributes should be blocked.",
    "vendorFixDate": "2021-05-31T00:00:00.000Z",
    "discoveryDate": "2021-05-25T00:00:00.000Z",
    "vendorNotifiedDate": "2021-05-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3429",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33618",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3429/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/commit/9d44df8a64e0857e0647ba08312a7301500f03f8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/releases/tag/14.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://trovent.io/security-advisory-2105-02",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://trovent.io/security-advisory-2105-02",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://trovent.io/security-advisory-2105-02",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.dolibarr.org/downloads.php",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3429/default-remediation-status"
            }
        ]
    }
}