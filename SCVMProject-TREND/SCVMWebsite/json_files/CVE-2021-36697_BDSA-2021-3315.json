{
    "source": "BDSA",
    "name": "BDSA-2021-3315",
    "title": "Pandora FMS Vulnerable to Arbitrary PHP Code Execution via Unrestricted Upload of Special '.htaccess' File Through Admin File Manager",
    "description": "Pandora FMS is vulnerable to allowing an admin level authenticated attacker to upload a specially crafted `.htaccess` file. By doing this, the attacker can then upload a specially crafted new file that will be executed as PHP when browsed. This could allow the execution of arbitrary system commands.",
    "technicalDescription": "The administrator level File Manager functionality does not restrict the upload of special `.htaccess` files. These files can be used to tell the webserver to execute code contained within special file types. By then uploading one of these newly defined file types, an attacker could execute arbitrary PHP code.\n\nAn low level user could leverage an existing cross-site scripting (XSS) flaw (such as CVE-2021-36698) to exploit this by tricking a logged in administrator into clicking a specially crafted link or visiting a page on the site with a stored XSS payload.",
    "publishedDate": "2021-11-04T14:12:04.764Z",
    "updatedDate": "2021-11-04T14:12:04.745Z",
    "disclosureDate": "2021-09-17T00:00:00.000Z",
    "exploitPublishDate": "2021-09-17T00:00:00.000Z",
    "solution": "Fixed in version [**757**](https://pandorafms.com/community/get-started/).\n\nThe latest releases can be found [here](https://pandorafms.com/community/get-started/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Kamill\u00f3 Matek",
    "workaround": "",
    "vendorFixDate": "2021-09-15T00:00:00.000Z",
    "vendorNotifiedDate": "2021-07-09T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3315",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-36697",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3315/ranges"
            },
            {
                "rel": "reference",
                "href": "https://k4m1ll0.com/chained_exploit_htaccess.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://k4m1ll0.com/chained_exploit_htaccess.html",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://pandorafms.com/community/get-started/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3315/default-remediation-status"
            }
        ]
    }
}