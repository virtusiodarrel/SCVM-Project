{
    "source": "BDSA",
    "name": "BDSA-2021-0688",
    "title": "StackStorm Vulnerable to Denial-of-Service (DoS) via Infinite Loop in Logger Method Functionality",
    "description": "StackStorm  contains a vulnerability to denial-of-service (DoS) condition via an infinite loop.  A local attacker could exploit this vulnerability by supplying maliciously crafted input data.",
    "technicalDescription": "This vulnerability exists when the decoding of data is written to the logger method and logged under `ERROR` log level. Local attackers could exploit this by crafting a malicious payload containing unicode characters to trigger an infinite loop condition during the decoding process, causing the application to crash, thus resulting in a DoS. The vendor addressed this by modifying the custom logger method to decode the underlying byte string and removing any characters not included the ascii range which is passing data to the underlying log formatter method. \n\n**Note:** The vendor has stated for this issue to be exploited users must be running Python 3 and system locale / encoding not set to UTF-8.",
    "publishedDate": "2021-03-18T13:59:28.456Z",
    "updatedDate": "2021-03-18T13:59:28.448Z",
    "disclosureDate": "2021-03-16T00:00:00.000Z",
    "solution": "Fixed in [ **3.4.1**](https://github.com/StackStorm/st2/releases/tag/v3.4.1) by [this](https://github.com/StackStorm/st2/commit/ccf33f97f437cea5a840a97ec587f818ed609aeb) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 1.2,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.9
        },
        "vector": "(AV:L/AC:H/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.2,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.4,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.8
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-03-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0688",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-835"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28667",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0688/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/StackStorm/st2/commit/ccf33f97f437cea5a840a97ec587f818ed609aeb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/StackStorm/st2/releases/tag/v3.4.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://stackstorm.com/2021/03/10/stackstorm-v3-4-1-security-fix/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0688/default-remediation-status"
            }
        ]
    }
}