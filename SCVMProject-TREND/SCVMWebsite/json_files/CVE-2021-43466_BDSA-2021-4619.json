{
    "source": "BDSA",
    "name": "BDSA-2021-4619",
    "title": "thymeleaf-spring Vulnerable to Template Injection Leading to Remote Code Execution (RCE) via Double Evaluation of Unsanitized Parameters",
    "description": "thymeleaf-spring is vulnerable to template injection. This can lead to remote code execution (RCE) through double evaluation of certain parameters.\n\n**Note** the vendor states:\n> Just in order to reduce anxiety around this issue, I'd like to explain that CVE-2021-43466 only affects those applications that contain controllers or controller configurations that take a request parameter and directly use it, without previous filtering, as the name of the view to be rendered \u2014 which is something IMHO no one should be doing, as it is a bit like voluntarily providing a way for code injection.",
    "technicalDescription": "Under specific scenarios outlined [here](https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/), server side template injection in thymeleaf-spring can lead to remote-code execution. This only affects applications that take a request parameter and directly use it through a controller. The issue occurs because of double evaluation of these parameters.\n\n**Note** The vendor partially addressed the issue in version **3.0.13** but improved the protections in **3.0.14** and it is recommended to upgrade to at least this version for this specific issue.",
    "publishedDate": "2022-09-28T13:56:51.821Z",
    "updatedDate": "2022-09-29T09:58:05.592Z",
    "disclosureDate": "2021-11-10T00:00:00.000Z",
    "exploitPublishDate": "2020-06-23T00:00:00.000Z",
    "solution": "Fixed in version [ **thymeleaf-spring3-3.0.14.RELEASE**](https://mvnrepository.com/artifact/org.thymeleaf/thymeleaf-spring3), [**thymeleaf-spring4-3.0.14.RELEASE**](https://mvnrepository.com/artifact/org.thymeleaf/thymeleaf-spring4), and [**thymeleaf-spring5-3.0.14.RELEASE**](https://github.com/thymeleaf/thymeleaf-spring/releases/tag/thymeleaf-spring5-3.0.14.RELEASE) by [this](https://github.com/thymeleaf/thymeleaf-spring/commit/d75834ca34f4a8dca3ee626c9ce22060e90427bc) commit.\n\nThe latest stable releases can be found [here](https://mvnrepository.com/artifact/org.thymeleaf/thymeleaf-spring5).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-12-03T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4619",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-95"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43466",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4619/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-qcj6-jqrg-4wp2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/thymeleaf/thymeleaf-spring/commit/d75834ca34f4a8dca3ee626c9ce22060e90427bc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/thymeleaf/thymeleaf-spring/issues/263#issuecomment-977199524",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/thymeleaf/thymeleaf-spring/releases/tag/thymeleaf-spring5-3.0.14.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mvnrepository.com/artifact/org.thymeleaf/thymeleaf-spring3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mvnrepository.com/artifact/org.thymeleaf/thymeleaf-spring4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mvnrepository.com/artifact/org.thymeleaf/thymeleaf-spring5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4619/default-remediation-status"
            }
        ]
    }
}