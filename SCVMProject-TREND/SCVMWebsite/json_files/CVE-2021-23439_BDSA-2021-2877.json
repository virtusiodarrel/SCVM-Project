{
    "source": "BDSA",
    "name": "BDSA-2021-2877",
    "title": "file-upload-with-preview Vulnerable to Reflected Cross-Site Scripting (XSS) via Crafted Filename",
    "description": "file-upload-with-preview is vulnerable to reflected cross-site scripting (XSS) due to improper validation of uploaded filenames. This could allow an attacker to inject malicious JavaScript and steal sensitive information such as authentication tokens and user session cookies, by tricking a user into uploading a crafted file.",
    "technicalDescription": "The issue exists within the file `src/file-upload-with-preview.js`. Filenames are not validated before being included in `innerHTML`.\n\nThe vendor addressed this issue by changing the filename to be included in non-executable `textContent`.",
    "publishedDate": "2021-09-28T13:58:44.744Z",
    "updatedDate": "2021-09-28T13:59:27.992Z",
    "disclosureDate": "2021-09-05T00:00:00.000Z",
    "solution": "Fixed in version [**4.2.0**](https://www.npmjs.com/package/file-upload-with-preview/v/4.2.0) by [this](https://github.com/johndatserakis/file-upload-with-preview/commit/265043ee872fc92beec1c5aefe20c5a396e9a86b) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Michele Di Stefano",
    "workaround": "",
    "vendorFixDate": "2021-09-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2877",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23439",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2877/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/johndatserakis/file-upload-with-preview/commit/265043ee872fc92beec1c5aefe20c5a396e9a86b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-FILEUPLOADWITHPREVIEW-1579492",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/file-upload-with-preview/v/4.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2877/default-remediation-status"
            }
        ]
    }
}