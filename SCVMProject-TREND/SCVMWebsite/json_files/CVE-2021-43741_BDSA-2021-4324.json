{
    "source": "BDSA",
    "name": "BDSA-2021-4324",
    "title": "CMSimple Vulnerable to Authenticated Remote Command Execution via Local File Inclusion through 'config.php' File",
    "description": "CMSimple allows an authenticated remote attacker to upload malicious files on the server and access them using local file inclusion. This could allow the attacker to execute malicious commands on the server.",
    "technicalDescription": "Exploiting this vulnerability requires an attacker to be authenticated to the application. Once authenticated, the attacker can firstly upload a malicious file using `PHP_SESSION_UPLOAD_PROGRESS` parameter. This file, as demonstrated in the exploit code, can contain malicious code that will open a reverse shell. Then, the attacker can navigate to the content management system (CMS) Settings page and trigger a local file inclusion using directory traversal. This will alter the contents of `config.php` file in such a way that it will trigger the access of the uploaded malicious file. When the file is accessed, it will execute the embedded malicious code and a reverse shell will be opened. Using this reverse shell, the attacker can execute malicious commands on the server.",
    "publishedDate": "2022-04-13T15:32:26.554Z",
    "updatedDate": "2022-08-23T12:06:10.422Z",
    "disclosureDate": "2021-11-15T00:00:00.000Z",
    "exploitPublishDate": "2021-11-15T00:00:00.000Z",
    "solution": "",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:U/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.1,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 9.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:F/RL:U/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "S1lv3r",
    "workaround": "",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4324",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43741",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4324/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/iiSiLvEr/CVEs/tree/main/CVE-2021-43741",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/iiSiLvEr/CVEs/tree/main/CVE-2021-43741",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/165064/cmsimple54-lfiexec.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/165064/cmsimple54-lfiexec.txt",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4324/default-remediation-status"
            }
        ]
    }
}