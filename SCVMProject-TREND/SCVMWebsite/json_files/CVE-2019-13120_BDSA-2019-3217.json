{
    "source": "BDSA",
    "name": "BDSA-2019-3217",
    "title": "FreeRTOS Vulnerable to Information Disclosure via Missing Length Checks in 'prvProcessReceivedPublish'",
    "description": "FreeRTOS contains an information disclosure vulnerability.  This vulnerability resides in the MQTT (Message Queuing Telemetry Transport) library.  Applications using this library, and allowing untrusted connections, can be targeted by remote attackers to disclose memory.",
    "technicalDescription": "The information disclosure is due to possible out-of-bounds reads triggered by the `prvProcessReceivedPublish()` function in `lib/mqtt/aws_mqtt_lib.c`.  This is due to missing checks on the two byte length field on packets received a MQTT broker.  A crafted MQTT packet can be create that will result in an incorrect length value being allocated.  This will cause out-of-bounds reads in multiple functions within `lib/mqtt/aws_mqtt_lib.c`.",
    "publishedDate": "2019-10-14T14:29:28.024Z",
    "updatedDate": "2019-10-14T14:29:28.012Z",
    "disclosureDate": "2019-06-28T00:00:00.000Z",
    "solution": "Fixed in version [**1.4.9**](https://github.com/aws/amazon-freertos/releases/tag/v1.4.9) by [this](https://github.com/aws/amazon-freertos/commit/2ad14e5786ecf633d9dde8397a5eedff802eabd5) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wenqiang Li (University of Georgia)",
    "workaround": "",
    "vendorFixDate": "2019-06-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3217",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13120",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3217/ranges"
            },
            {
                "rel": "reference",
                "href": "https://aws.amazon.com/cn/freertos/security-updates/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/amazon-freertos/commit/10ad505b4d1ead1526b3348e72c9f14c44e52c1f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/amazon-freertos/commit/2ad14e5786ecf633d9dde8397a5eedff802eabd5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/amazon-freertos/releases/tag/v1.4.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3217/default-remediation-status"
            }
        ]
    }
}