{
    "source": "BDSA",
    "name": "BDSA-2022-2703",
    "title": "fhir-works-on-aws-authz-smart Vulnerable to Sensitive Data Exposure via 'search-type' Requests",
    "description": "A sensitive data exposure vulnerability has been discovered in fhir-works-on-aws-authz-smart. An authenticated attacker could exploit this by making `search-type` requests with the API in order to retrieve more information than the client\u2019s OAuth scope should permit. Although this is the case the flaw does not permit access to information about individuals other than what the client was already authorized to access.",
    "technicalDescription": "This issue occurs in the `src/smartAuthorizationHelper.ts`, `src/smartHandler.ts`, and `src/smartScopeHelper.ts` files due to how `include` and `revInclude` are handled. It was mitigated by moving the logic of dealing with non-root resourceTypes returned from a `search-type` operation from `filterOutUnusableScope` to `authorizeAndFilterReadResponse` and by making `hasSystemAccess` more explicit.",
    "publishedDate": "2022-09-27T14:39:39.769Z",
    "updatedDate": "2022-09-27T14:39:39.759Z",
    "disclosureDate": "2022-09-12T00:00:00.000Z",
    "solution": "Fixed in [**3.1.3**](https://github.com/awslabs/fhir-works-on-aws-authz-smart/releases/tag/v3.1.3) by [this](https://github.com/awslabs/fhir-works-on-aws-authz-smart/commit/203bbc0dd17de748c36b33c68b866ed2dfd613d3) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/fhir-works-on-aws-authz-smart).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-09-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2703",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-39230",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2703/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/awslabs/fhir-works-on-aws-authz-smart/commit/203bbc0dd17de748c36b33c68b866ed2dfd613d3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/awslabs/fhir-works-on-aws-authz-smart/pull/92",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/awslabs/fhir-works-on-aws-authz-smart/releases/tag/v3.1.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/awslabs/fhir-works-on-aws-authz-smart/security/advisories/GHSA-vv7x-7w4m-q72f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/fhir-works-on-aws-authz-smart",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2703/default-remediation-status"
            }
        ]
    }
}