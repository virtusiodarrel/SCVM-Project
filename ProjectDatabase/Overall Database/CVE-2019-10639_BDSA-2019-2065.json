{
    "source": "BDSA",
    "name": "BDSA-2019-2065",
    "title": "Linux Kernel Vulnerable to Remote Kernel Address Space Layout Randomisation (KASLR) Bypass via IP ID Values of Connectionless Protocols",
    "description": "The Linux kernel is vulnerable to a remote kernel address space layout randomisation (KASLR) bypass via connectionless protocols. A sufficiently advanced attacker, able to control approximately 400 Internet addresses, and several thousand computers in a cluster, could learn the base address of the kernel in under 100 seconds. With this information the attacker could be enabled to further exploit the kernel with other vulnerabilities.",
    "technicalDescription": "The Linux kernel uses an algorithm for the IP ID counter that picks an index (bucket|) to a counter as a function of the source and destination IP address, the protocol, and a key that is initialized upon first IP transmission with random data. With KASLR enabled, this key also contains bits from a `struct net ` data structure. This structure is in the data section of the kernel at a fixed offset from the base address.\n\nBy observing connectionless network traffic sent from a Linux host, by WebRTC (specifically the STUN protocol, available to attackers through web browsers and JavaScript), ICMP or DNS for example, it is possible to derive 32 bits of the `struct net`.\n\nThe attacker who wants to learn the base address of the kernel of the device will force the browser to rapidly emit UDP packets to each IP that it controls. The IP IDs can be collected from all IP addresses, and bucket collisions identified by looking for IP pairs whose IP IDs are sequentially close. As noted earlier, the choice of the bucket is a function of the source and destination IP addresses, and a device key that contains a kernel address. By enumerating over the key space to find the key which generates collisions for the same pairs for which collisions were observed, this kernel address will be revealed.\n\nBypassing KASLR could allow further exploitation with additional remote kernel vulnerabilities.",
    "publishedDate": "2019-07-10T11:22:17.620Z",
    "updatedDate": "2019-09-02T10:37:01.221Z",
    "disclosureDate": "2019-06-25T00:00:00.000Z",
    "exploitPublishDate": "2019-06-25T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.16.70**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=188da790e1f4d164bcfdea486e91fd47e1ba59c5) commit\n* [**3.18.139**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c2bca92ba948f3def1f99f6b429ec39e07354dc2) commit\n* [**4.4.179**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0ede14314f6d9e6a172eb4c4b6b9fe5477aa70bc) commit\n* [**4.9.169**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6996763856e1fb27ccae260e41fd73a3fff56678) commit\n* [**4.14.112**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=adbb8bdd392db14dc80ad1ac29f8f1d37ab57a62) commit\n* [**4.19.35**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a1c2f3229734a4bb8d5ac008c0a67e025aa11547) commit\n* [**5.0.8**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ec7aeb6a0709855c6b76bc10e8a218e84d80fc68) commit\n* [**5.1-rc4**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=355b98553789b646ed97ad801a619ff898471b92) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Amit Klein, Benny Pinkas",
    "workaround": "",
    "vendorFixDate": "2019-03-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2065",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-326"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-331"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-10639",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2065/ranges"
            },
            {
                "rel": "reference",
                "href": "https://arxiv.org/pdf/1906.10478.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://arxiv.org/pdf/1906.10478.pdf",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=355b98553789b646ed97ad801a619ff898471b92",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}