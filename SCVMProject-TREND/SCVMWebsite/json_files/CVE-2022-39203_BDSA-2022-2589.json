{
    "source": "BDSA",
    "name": "BDSA-2022-2589",
    "title": "matrix-appservice-irc Vulnerable to Authorization Bypass via String Parsing Flaw in 'matrix-org-irc' Library",
    "description": "matrix-appservice-irc is vulnerable to a privilege escalation style issue due to the presence of a string parsing flaw in the underlying matrix-org-irc library. An attacker could leverage this issue in order to cause the bridge to merge an existing channel with an attacker controlled one, which will grant the attacker permissions in an existing channel.",
    "technicalDescription": "",
    "publishedDate": "2022-09-16T15:55:11.981Z",
    "updatedDate": "2022-09-16T15:55:11.968Z",
    "disclosureDate": "2022-09-13T00:00:00.000Z",
    "solution": "Fixed in matrix-org-irc version [**1.3.0**](https://www.npmjs.com/package/matrix-org-irc/v/1.3.0).\n\nFixed in matrix-appservice-irc version [**0.35.0**](https://github.com/matrix-org/matrix-appservice-irc/releases/tag/0.35.0) with an update to matrix-org-irc **1.3.0** in [this](https://github.com/matrix-org/matrix-appservice-irc/commit/9a75c32cb23721e221039f49e9a181224fd066b3) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Val Lorentz",
    "workaround": "The vendor has stated [here](https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-xvqg-mv25-rwvw) that the following workaround can be implemented:\n\n> Disable dynamic channel joining via `dynamicChannels.enabled` to prevent users from joining new channels, which prevents any new channels being bridged outside of what is already bridged, and what is specified in the config.",
    "vendorFixDate": "2022-09-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2589",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-39203",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2589/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/matrix-appservice-irc/commit/9a75c32cb23721e221039f49e9a181224fd066b3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/matrix-appservice-irc/releases/tag/0.35.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-xvqg-mv25-rwvw",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-xvqg-mv25-rwvw",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://matrix.org/blog/2022/09/13/security-release-of-matrix-appservice-irc-0-35-0-high-severity",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/matrix-org-irc/v/1.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2589/default-remediation-status"
            }
        ]
    }
}