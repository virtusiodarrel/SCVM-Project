{
    "source": "BDSA",
    "name": "BDSA-2020-3774",
    "title": "Xenstored Ocaml Implementation Vulnerable to Denial-of-Service (DoS) and Privilege Escalation via Missing Permissions Checks",
    "description": "The Xenstored Ocaml implementation is vulnerable to denial-of-service (DoS) and potential privilege escalation due to missing permissions checks. A guest administrator can deny service to the whole system by deleting the whole of xenstore. In addition depending on other software in use a guest administrator could escalate their privileges to that of the host. \n\nAll systems using oxenstored are vulnerable.  Building and using oxenstored is the default in the upstream Xen distribution, if the Ocaml compiler is available.\n\nSystems using C xenstored are not vulnerable, no matter what toolstack or management software is in use.",
    "technicalDescription": "In the Ocaml xenstored implementation, the internal representation of the tree has special cases for the root node due to it having no parent. For certain operations on the root node permissions checks were not put in place. \n\nAn unprivileged guest can get and modify permissions, list and delete the root node. If the whole xenstore tree is deleted this causes a host wide denial of service. Depending on the toolstack and other management software in use it may be possible for the attacker to gain access to any part of xenstore. Systems using libxl (for example, via xl or libvirt) are vulnerable to privilege escalation.",
    "publishedDate": "2020-12-15T17:13:43.518Z",
    "updatedDate": "2022-02-04T12:32:07.493Z",
    "disclosureDate": "2020-12-15T00:00:00.000Z",
    "solution": "Fixed in:\n* **[4.13.3](https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.3)** by [this](https://github.com/xen-project/xen/commit/2fa586cb82) commit\n* **[4.14.1](https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.1)** by [this](https://github.com/xen-project/xen/commit/f130d5f013) commit\n* **[4.15.0-rc1](https://github.com/xen-project/xen/releases/tag/4.15.0-rc1)** by [this](https://github.com/xen-project/xen/commit/feeafa007b) commit\n* **stable-4.10** branch by [this](https://github.com/xen-project/xen/commit/e8231b61b2) commit which is not yet included in any release\n* **stable-4.11** branch by [this](https://github.com/xen-project/xen/commit/d2b6bf98ee) commit which is not yet included in any release\n* **stable-4.12** branch by [this](https://github.com/xen-project/xen/commit/c64ff3b47e) commit which is not yet included in any release",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.1
        },
        "vector": "(AV:L/AC:M/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Edwin T\u00f6r\u00f6k of Citrix",
    "workaround": "",
    "vendorFixDate": "2020-12-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3774",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-29479",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3774/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/2fa586cb82",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/c64ff3b47e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/d2b6bf98ee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/e8231b61b2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/f130d5f013",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/feeafa007b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/4.15.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-353.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3774/default-remediation-status"
            }
        ]
    }
}