{
    "source": "BDSA",
    "name": "BDSA-2021-2208",
    "title": "mongo-express Vulnerable to Cross-Site Scripting (XSS) and Cross-Site Request Forgery (CSRF) in Collection Preview Functionality",
    "description": "mongo-express is vulnerable to cross-site scripting (XSS) and cross-site request forgery (CSRF) issues due to a lack of sufficient sanitization in the Collection preview functionality.\n\nAn attacker could submit a large amount of data that contains a malicious script payload and wait for an administrative user to preview the content. The attacker could use this attack method to export collection data, or potentially abuse the administrative user's privileges and submit requests on their behalf to drop databases\\collections.",
    "technicalDescription": "mongo-express is vulnerable to cross-site scripting (XSS) and cross-site request forgery (CSRF) because the Collection preview functionality does not sufficiently escape user supplied input when rendering large Collection documents. When the content of a cell is larger than the supported size, the full document can be shown unescaped when an administrative user clicks on a row. Data cells that are identified as media can also be rendered without being sufficiently sanitized.",
    "publishedDate": "2021-07-26T13:41:03.281Z",
    "updatedDate": "2021-07-26T13:41:03.271Z",
    "disclosureDate": "2021-06-19T00:00:00.000Z",
    "exploitPublishDate": "2021-06-19T00:00:00.000Z",
    "solution": "Fixed in [**1.0.0-alpha3**](https://github.com/mongo-express/mongo-express/releases/tag/v1.0.0-alpha.3) by [this](https://github.com/mongo-express/mongo-express/commit/f5e0d4931f856f032f22664b5e5901d5950cfd4b) commit.\n\nThe latest stable releases are available [here](https://github.com/mongo-express/mongo-express/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jafar Akhondali",
    "workaround": "",
    "vendorFixDate": "2021-03-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2208",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21422",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2208/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-7p8h-86p5-wv3p",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongo-express/mongo-express/commit/f5e0d4931f856f032f22664b5e5901d5950cfd4b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongo-express/mongo-express/issues/577",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongo-express/mongo-express/issues/577",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongo-express/mongo-express/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongo-express/mongo-express/releases/tag/v1.0.0-alpha.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongo-express/mongo-express/security/advisories/GHSA-7p8h-86p5-wv3p",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongo-express/mongo-express/security/advisories/GHSA-7p8h-86p5-wv3p",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2208/default-remediation-status"
            }
        ]
    }
}