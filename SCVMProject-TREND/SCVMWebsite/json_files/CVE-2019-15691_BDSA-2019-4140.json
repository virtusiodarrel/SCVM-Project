{
    "source": "BDSA",
    "name": "BDSA-2019-4140",
    "title": "TigerVNC Vulnerable to Remote Code Execution (RCE) via Improper Stack Variable Handling When Throwing an Exception",
    "description": "TigerVNC contains a remote code execution vulnerability due to an access to a stack variable that gets deallocated during stack unwinding after an exception is thrown.",
    "technicalDescription": "The issue revolves around the manipulation of `InStream* underlying` variable in `ZlibInstream` files. Reportedly its improper handling during stack unwinding could be used to achieve remote code execution on the client. The issue was fixed by adding more safety checks and certain functions so that implicit accesses (such as when throwing an exception) to the `underlying` variable are avoided. \n\nNote that for this vulnerability to be exploited the peer needs to be authenticated first.",
    "publishedDate": "2020-01-07T14:25:32.057Z",
    "updatedDate": "2021-07-06T09:03:36.114Z",
    "disclosureDate": "2019-12-20T00:00:00.000Z",
    "solution": "Fixed in [**1.10.1**](https://github.com/TigerVNC/tigervnc/releases/tag/v1.10.1) by [this](https://github.com/TigerVNC/tigervnc/commit/d61a767d6842b530ffb532ddd5a3d233119aad40) commit.\n\nThe latest stable releases are available [here](https://github.com/TigerVNC/tigervnc/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Pavel Cheremushkin",
    "workaround": "",
    "vendorFixDate": "2019-09-10T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4140",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15691",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4140/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TigerVNC/tigervnc/commit/d61a767d6842b530ffb532ddd5a3d233119aad40",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TigerVNC/tigervnc/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TigerVNC/tigervnc/releases/tag/v1.10.1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TigerVNC/tigervnc/releases/tag/v1.10.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4140/default-remediation-status"
            }
        ]
    }
}