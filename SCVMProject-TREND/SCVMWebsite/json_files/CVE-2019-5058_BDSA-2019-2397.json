{
    "source": "BDSA",
    "name": "BDSA-2019-2397",
    "title": "SDL2 Vulnerable to Denial-of-Service (DoS) Due to Heap-Based Buffer Overflow via XCF Image",
    "description": "SDL2 contains a heap-based buffer overflow flaw. This could be exploited by an attacker supplying a specially crafted XCF image to the component. If successful, a denial-of-service (DoS) will occur due to the component crashing. Sensitive memory addresses may also be exposed. In addition, an attacker could trick a user into uploading a malicious XCF image, resulting in arbitrary code execution.",
    "technicalDescription": "This vulnerability is caused by an erroneous `if` statement in `SDL_image/IMG_xcf.c`. An attacker could set the correct level values to mismatch an image's values, resulting in the row pointer being calculated beyond the bounds of the pixels buffer via `SDL_CalculatePitch` in `SDL/src/video/SDL_surface.c`. This is due to lack of sanitization when calculating the pitch of a surface from the width of an image, which can be user controlled. Once this pointer is written to, it will be writing out of the bounds of the heap buffer, causing a heap overflow, resulting in potential code execution.",
    "publishedDate": "2019-08-21T15:20:25.864Z",
    "updatedDate": "2019-08-21T15:20:25.854Z",
    "disclosureDate": "2019-05-30T00:00:00.000Z",
    "exploitPublishDate": "2019-05-30T00:00:00.000Z",
    "solution": "Fixed in **[2.0.5](http://hg.libsdl.org/SDL_image/rev/6dd3b4df8ec1)** by [this](http://hg.libsdl.org/SDL_image/rev/b1a80aec2b10) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Cory Duplantis",
    "workaround": "",
    "vendorFixDate": "2019-06-10T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2397",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5058",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2397/ranges"
            },
            {
                "rel": "reference",
                "href": "http://hg.libsdl.org/SDL_image/rev/6dd3b4df8ec1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://hg.libsdl.org/SDL_image/rev/b1a80aec2b10",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2019-0842",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2019-0842",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2397/default-remediation-status"
            }
        ]
    }
}