{
    "source": "BDSA",
    "name": "BDSA-2019-0904",
    "title": "libssh2 Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Write in 'userauth_keyboard_interactive()' Function",
    "description": "libssh is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause a victim's instance of the application to crash by tricking the user into connecting to a malicious server.",
    "technicalDescription": "The function `userauth_keyboard_interactive()`, defined within `userauth.c`, contains code that is used to conduct challenge-response authentication between a client and server. The `session` structure is used to store data relating to the authentication process. One component of this structure is the `userauth_kybd_num_prompts` variable. The value stored in this unsigned integer variable is used in a multiplication calculation that dynamically allocates memory via the `LIBSSH2_CALLOC` function. This memory buffer is then written to by the application. If this value is too large, an integer overflow can occur that will result in the incorrect quantity of memory being allocated. Whenever the application attempts to write to the buffer, it will write to a location that lies outside the buffer's boundaries. This out-of-bounds write operation can raise an exception, halting program execution and causing a DoS. An attacker could therefore cause a DoS by supplying crafted packets in which the value of `userauth_kybd_num_prompts` is too large; this can be done by tricking a victim into connecting to a malicious server. \n\nThis flaw can only be triggered on 32-bit architectures, or whenever the program is compiled against the 32-bit version of the libssh2 library.",
    "publishedDate": "2019-04-02T13:04:13.285Z",
    "updatedDate": "2019-04-02T13:04:13.270Z",
    "disclosureDate": "2019-03-11T00:00:00.000Z",
    "solution": "Fixed in version [**1.8.1**](https://github.com/libssh2/libssh2/releases/tag/libssh2-1.8.1) by [this](https://github.com/libssh2/libssh2/commit/c286e4d82f24def116d9679cb2453948f74e8183) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-03-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0904",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3856",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0904/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libssh2/libssh2/commit/c286e4d82f24def116d9679cb2453948f74e8183",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libssh2/libssh2/releases/tag/libssh2-1.8.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.libssh2.org/CVE-2019-3856.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0904/default-remediation-status"
            }
        ]
    }
}