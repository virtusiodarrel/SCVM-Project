{
    "source": "BDSA",
    "name": "BDSA-2022-1041",
    "title": "libsox Vulnerable to Remote Code Execution (RCE) via Heap-Based Buffer Overflow in 'start_read' Function",
    "description": "libsox is vulnerable to remote code execution (RCE) due to improper processing of data in the NIST Speech Header Resources (SPHERE) speech recognition format. An attacker could exploit this vulnerability by supplying a system with a maliciously crafted `.sph` file.",
    "technicalDescription": "The issue exists in the function `start_read` within the file `sphere.c`. The function does not properly process files which have invalid `end_head` headers. This can result in an off-by-one error on a call to `lsx_reads`, causing an integer underflow of `header_size` and leading to a heap buffer overflow.\n\nThe reporter states the following with regards to possible exploitation of this issue:\n> While normally such a situation might result in a wild copy (i.e. we couldn\u2019t stop the bug from writing into things we don\u2019t want it to and crashing), we\u2019re bailed out by the overall structure of this function. We\u2019d simply have our next read be our overflow string of any size that we wanted, and then the following read just being \"end_head\". This would allow us to arbitrarily overwrite data on the heap while also allowing us to continue into the code to actually utilize the heap overflow.",
    "publishedDate": "2022-04-15T15:54:49.176Z",
    "updatedDate": "2022-09-30T13:16:56.008Z",
    "disclosureDate": "2022-03-23T00:00:00.000Z",
    "solution": "",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:U/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 9.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:U/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Lilith (Cisco Talos)",
    "workaround": "",
    "vendorNotifiedDate": "2021-12-22T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1041",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-40426",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1041/ranges"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2021-1434",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1041/default-remediation-status"
            }
        ]
    }
}