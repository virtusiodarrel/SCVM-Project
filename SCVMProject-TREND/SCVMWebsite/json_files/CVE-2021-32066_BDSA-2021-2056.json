{
    "source": "BDSA",
    "name": "BDSA-2021-2056",
    "title": "Ruby Vulnerable to Man-in-the-Middle (MitM) Attacks via Missing StartTLS Exception",
    "description": "Ruby is vulnerable to man-in-the-middle (MitM) attacks due to the `Net::IMAP` module not raising an error when `StartTLS`, a channel security upgrade command, fails with an unknown response. The missing error handling could allow MitM attackers to bypass the connection's encryption mechanism (TLS) and cause damage to the connection's confidentiality and integrity.",
    "technicalDescription": "MitM attacks are possible because `Net::IMAP` does not raise an exception when the IMAP server does not respond with a `tagged_response` to an explicit call of `imap.starttls`. \n\nThe vulnerability was fixed by raising `UnknownResponseError` in the function `get_tagged_response`,  in the file `lib/net/imap.rb` when the tagged response does not match any of the expected conditions.",
    "publishedDate": "2021-07-09T08:07:11.274Z",
    "updatedDate": "2021-07-09T08:07:11.256Z",
    "disclosureDate": "2021-07-07T00:00:00.000Z",
    "exploitPublishDate": "2021-07-08T00:00:00.000Z",
    "solution": "Fixed in:\n* **[2.6.8](https://github.com/ruby/ruby/releases/tag/v2_6_8)** by [this](https://github.com/ruby/ruby/commit/95ba9053e2) commit\n* **[2.7.4](https://github.com/ruby/ruby/releases/tag/v2_7_4)** by [this](https://github.com/ruby/ruby/commit/a21a3b7d23) commit\n* **[3.0.2](https://github.com/ruby/ruby/releases/tag/v3_0_2)** by [this](https://github.com/ruby/ruby/commit/e2ac25d0eb) commit\n\nThe latest stable releases are available [here](https://www.ruby-lang.org/en/downloads/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alexandr Savca",
    "workaround": "",
    "vendorFixDate": "2021-07-07T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2056",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-295"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32066",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2056/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/95ba9053e2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/a21a3b7d23",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/e2ac25d0eb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/releases/tag/v2_6_8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/releases/tag/v2_7_4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/releases/tag/v3_0_2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1178562",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1178562",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2021/07/07/trusting-pasv-responses-in-net-ftp/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2056/default-remediation-status"
            }
        ]
    }
}