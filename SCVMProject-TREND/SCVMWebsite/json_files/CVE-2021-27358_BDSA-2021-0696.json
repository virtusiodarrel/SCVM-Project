{
    "source": "BDSA",
    "name": "BDSA-2021-0696",
    "title": "Grafana Vulnerable to Denial-of-Service (DoS) via Insufficient Restrictions for Snapshot Creation",
    "description": "Grafana is vulnerable to denial-of-service (DoS) due to insufficient restrictions being placed on dangerous functionality. A remote attacker could cause the service to become unavailable by creating a malicious snapshot.",
    "technicalDescription": "The function `SnapshotPublicModeOrSignedIn()`, of file `auth.go`, is used by Grafana in the process of deciding whether or not  snapshots can be created. Access to the snapshot creation functionality is insufficiently restricted, such that they can be created by an anonymous user. A remote attacker could exploit the snapshot creation API in order to cause a DoS.",
    "publishedDate": "2021-03-19T13:54:54.550Z",
    "updatedDate": "2022-03-18T13:11:55.886Z",
    "disclosureDate": "2021-03-18T00:00:00.000Z",
    "solution": "Fixed in [**7.4.2**](https://github.com/grafana/grafana/releases/tag/v7.4.2) by [this](https://github.com/grafana/grafana/commit/064546f3823ea40f59c22832f1966524f798f8be) commit.\n\nThe latest stable releases are available [here](https://github.com/grafana/grafana/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-02-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0696",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-749"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-27358",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0696/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/064546f3823ea40f59c22832f1966524f798f8be",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/tag/v7.4.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://grafana.com/docs/grafana/latest/release-notes/release-notes-7-4-2/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0696/default-remediation-status"
            }
        ]
    }
}