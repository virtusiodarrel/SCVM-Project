{
    "source": "BDSA",
    "name": "BDSA-2021-0482",
    "title": "Mozilla Firefox Vulnerable to Denial-of-Service (DoS) and Arbitrary Code Execution via Multiple Memory Safety Flaws",
    "description": "Mozilla Firefox is vulnerable to denial-of-service (DoS) issues and potential arbitrary code execution due to the presence of multiple memory safety flaws.\n\nThese flaws could be used by an attacker to trigger an out of memory error and cause a crash. Some of the flaws also showed memory corruption evidence meaning it could be possible for arbitrary code to be run.",
    "technicalDescription": "Memory safety issues exists in the following locations:\n* Race condition in `mark<js::jit::JitCode>`\n* `EXCEPTION_ACCESS_VIOLATION_READ` in `OnStreamComplete`\n* `EXCEPTION_ACCESS_VIOLATION_READ` in `mozilla::ipc::IProtocol::ActorDealloc`\n* Use-after-poison in `nsBlockFrame::ReflowBlockFrame`\n* Race condition with `TransportSecurityInfo` fields\n* Incorrect return unit in `max_memory_length`\n* Out-of-bounds access with `LUse` register field\n* Invalid value in `VideoInfo::Rotation`\n* Insufficient thread safety in `nsAutoOwningEventTarget::AssertCurrentThreadOwnsMe`\n* Pointer index expression overflow in `LZ4HC_init_internal`\n* Heap use-after-free in `gfxFontCache::HashEntry::KeyEquals`",
    "publishedDate": "2021-03-01T11:58:13.329Z",
    "updatedDate": "2022-01-07T15:01:39.836Z",
    "disclosureDate": "2021-02-23T00:00:00.000Z",
    "solution": "Fixed in [**86.0**](https://ftp.mozilla.org/pub/firefox/releases/86.0/) by the following revisions:\n\n* [Revision 1](https://hg.mozilla.org/mozilla-central/rev/4e07cf6a753615eb882847e1a57705c443cb2c5f)\n* [Revision 2](https://hg.mozilla.org/mozilla-central/rev/4ce960f145fc49d5573a062fac57b23bcd4e424f)\n* [Revision 3](https://hg.mozilla.org/mozilla-central/rev/0aa3712fa83703c48f4f967192703f87dc2b1c0f)\n* [Revision 4](https://hg.mozilla.org/mozilla-central/rev/753585f3f88fb9d1fd798b76b3cef64d866f056a)\n* [Revision 5](https://hg.mozilla.org/mozilla-central/rev/86e06386072c4e59d1e7b473791627bdfbf41183)\n* [Revision 6](https://hg.mozilla.org/mozilla-central/rev/bf8f615202dd9b24f5158ab92398253af86b6c71)\n* [Revision 7](https://hg.mozilla.org/mozilla-central/rev/c939bff74f3624a8ce78f802f3122ca4a4616e7c)\n* [Revision 8](https://hg.mozilla.org/mozilla-central/rev/5208d36713dbd97452656dd89f948654fec9e0fe)\n* [Revision 9](https://hg.mozilla.org/mozilla-central/rev/f15cc33e5e952bfc238635578552a27a42839ca0)\n* [Revision 10](https://hg.mozilla.org/mozilla-central/rev/2e4f2dc6d455710ac5c553cb87f6c590b9227628)\n* [Revision 11](https://hg.mozilla.org/mozilla-central/rev/c5dd5d053cb14df3d0d95c758aa1f77bbe85ef07)\n* [Revision 12](https://hg.mozilla.org/mozilla-central/rev/f309346f397c40586a15e04fc471095c969e4966)\n\nPlease note there may be more fix revisions related to this vulnerability not listed above.\n\nThe latest stable releases are available [here](https://ftp.mozilla.org/pub/firefox/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-02-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0482",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-120"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23979",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0482/ranges"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/86.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/0aa3712fa83703c48f4f967192703f87dc2b1c0f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/2e4f2dc6d455710ac5c553cb87f6c590b9227628",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/4ce960f145fc49d5573a062fac57b23bcd4e424f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/4e07cf6a753615eb882847e1a57705c443cb2c5f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/5208d36713dbd97452656dd89f948654fec9e0fe",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/753585f3f88fb9d1fd798b76b3cef64d866f056a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/86e06386072c4e59d1e7b473791627bdfbf41183",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/bf8f615202dd9b24f5158ab92398253af86b6c71",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/c5dd5d053cb14df3d0d95c758aa1f77bbe85ef07",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/c939bff74f3624a8ce78f802f3122ca4a4616e7c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/f15cc33e5e952bfc238635578552a27a42839ca0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/f309346f397c40586a15e04fc471095c969e4966",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-07/#CVE-2021-23979",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0482/default-remediation-status"
            }
        ]
    }
}