{
    "source": "BDSA",
    "name": "BDSA-2022-1527",
    "title": "Smarty Vulnerable to Arbitrary PHP Code Execution via 'smarty_function_math()' Function",
    "description": "Smarty is vulnerable to arbitrary PHP code execution due to insufficient validation of user-supplied input in the `smarty_function_math()` function. An authenticated attacker could exploit this flaw by crafting a malicious math string to execute arbitrary code.",
    "technicalDescription": "This vulnerability exists in the `libs/plugins/function.math.php` file within the `smarty_function_math()` function due to insufficient validation of user-supplied input. \n\nThis has been mitigated by validating the string supplied to the math function to check for illegal characters so that PHP code cannot be executed within the application.",
    "publishedDate": "2022-06-01T15:14:54.236Z",
    "updatedDate": "2022-08-23T11:37:01.565Z",
    "disclosureDate": "2022-01-09T00:00:00.000Z",
    "exploitPublishDate": "2022-03-31T00:00:00.000Z",
    "solution": "Fixed in version [**3.1.42**](https://github.com/smarty-php/smarty/releases/tag/v3.1.42) by [this](https://github.com/smarty-php/smarty/commit/7ad97ad030b4289711e30819c928b8bc33c62b23) commit and version [**4.0.2**](https://github.com/smarty-php/smarty/releases/tag/v4.0.2) by [this](https://github.com/smarty-php/smarty/commit/215d81a9fa3cd63d82fb3ab56ecaf97cf1e7db71) commit.\n\nThe latest stable releases can be found [here](https://github.com/smarty-php/smarty/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "AndyNoel",
    "workaround": "",
    "vendorFixDate": "2022-01-09T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1527",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-74"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29454",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1527/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/commit/215d81a9fa3cd63d82fb3ab56ecaf97cf1e7db71",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/commit/7ad97ad030b4289711e30819c928b8bc33c62b23",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/releases/tag/v3.1.42",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/releases/tag/v4.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/security/advisories/GHSA-29gp-2c3m-3j6m",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xz.aliyun.com/t/11085",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xz.aliyun.com/t/11085",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1527/default-remediation-status"
            }
        ]
    }
}