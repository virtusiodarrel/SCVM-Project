{
    "source": "BDSA",
    "name": "BDSA-2019-0551",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via Out-of-bounds Read/Write in SNMP NAT Module",
    "description": "Linux kernel is vulnerable to privilege escalation due to errors in the implementation of the ASN.1 decoder. Certain ASN.1-encoded payloads of SNMP messages may lead to out-of-bounds read/write operations due to a missing check on the packet data length. This can be furthered leveraged by a local attacker to escalate their privileges on the system.",
    "technicalDescription": "This flaw lies in the `fast_csum()` and `snmp_helper()` functions in the `/net/ipv4/netfilter/nf_nat_snmp_basic_main.c` source file. The `nf_nat_snmp_basic` module, responsible for parsing and modifying the ASN.1-encoded payloads of SNMP messages, has been modified to use the kernel's ASN.1 infrastructure instead of an open-coded parser.\n\nThe ASN.1 decoder can invoke callbacks when it encounters certain objects while parsing data. The SNMP helper has two callbacks - `snmp_version()` and `snmp_helper()`. The problem is that it is not guaranteed that the callbacks will get as much data as is expected. Callbacks do not check the `datalen` value before attempting to perform operations on `data`. As a result, the `snmp_version()` and `snmp_helper()` functions may perform OOB read/write operations beyond the end of the packet data.\n\nA local attacker could leverage this flaw for privilege escalation by setting up new network namespaces with an iptables configuration that invokes SNMP translation.",
    "publishedDate": "2019-02-27T16:30:06.398Z",
    "updatedDate": "2019-05-14T15:43:27.025Z",
    "disclosureDate": "2019-02-25T00:00:00.000Z",
    "exploitPublishDate": "2019-02-25T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.19.25**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6a3f7237871c4d5c090ab9a6fce3ba6a1baf1f82) commit,\n* [**4.20.12**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=42038180a1d6f6f0c7ce9a67f70330a7eddcea3d) commit, and\n* [**5.0-rc7**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn",
    "workaround": "",
    "vendorFixDate": "2019-02-11T00:00:00.000Z",
    "vendorNotifiedDate": "2019-02-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0551",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9162",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0551/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1776",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1776",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=42038180a1d6f6f0c7ce9a67f70330a7eddcea3d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6a3f7237871c4d5c090ab9a6fce3ba6a1baf1f82",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0551/default-remediation-status"
            }
        ]
    }
}