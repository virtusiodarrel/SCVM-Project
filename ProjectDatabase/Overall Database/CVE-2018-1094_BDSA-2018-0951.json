{
    "source": "BDSA",
    "name": "BDSA-2018-0951",
    "title": "Linux Kernel Vulnerable to Denial-of-Service via NULL Pointer Dereference in 'ext4_fill_super' Function",
    "description": "Linux Kernel is vulnerable to denial-of-service (*DoS*) due to the way certain file system mounts are handled. The affected function does not initialize an essential driver in some situations. This can be leveraged to cause a crash via crafted `ext4` images.",
    "technicalDescription": "The vulnerability exists in the `ext4_fill_super` function of the  `fs/ext4/super.c` source file. The affected function does not always initialize the essential `crc32` driver even though the extended attribute code now uses a `crc32c` checksum for hashing purposes. This can also lead to NULL pointer dereferences if one of the metadata checksum features is enabled when the file system is originally mounted. If the driver was not initialized these operations cannot be performed.\n\nA potential attacker could intentionally trigger a NULL pointer dereference in the `ext4_xattr_inode_hash` function to cause kernel panic, ultimately resulting in a denial-of-service (*DoS*) condition. An attacker could leverage this flaw by mounting a crafted `ext4` image to the affected system.",
    "publishedDate": "2018-04-06T09:02:07.170Z",
    "updatedDate": "2018-09-26T07:55:05.621Z",
    "disclosureDate": "2018-03-22T00:00:00.000Z",
    "exploitPublishDate": "2018-03-22T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* [**3.18.106**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=628597956599f0f6766e0b6cfe22aa8dcff6cf5a) commit,\n* [**4.1.52**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=176df3e2add7cd7029a3493ea825e5582cb84ef0) commit,\n* [**4.4.129**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4845fefe6d13a28702f92102dff11c1b773f00d0) commit,\n* [**4.9.96**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=68e3579a5fef4b45e14802808476baac5797e741) commit,\n* [**4.14.36**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b2623d8166563a19bee0cc8292e4ec951a42a6da) commit, and [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=26dbb30c58ffb85bc015bd5e58831483d50f7d18) commit,\n* [**4.16.4**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=adebf4b54f615014f09f90c6eca9499ed2958ea0) commit, and [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=114c42aaa63152d31d3c18d5b750de9560f38a63) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wen Xu",
    "workaround": "",
    "vendorFixDate": "2018-03-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.0,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-0951",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-476"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-1094",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-0951/ranges"
            },
            {
                "rel": "reference",
                "href": "http://openwall.com/lists/oss-security/2018/03/29/1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.kernel.org/show_bug.cgi?id=199183",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=114c42aaa63152d31d3c18d5b750de9560f38a63",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=176df3e2add7cd7029a3493ea825e5582cb84ef0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=26dbb30c58ffb85bc015bd5e58831483d50f7d18",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4845fefe6d13a28702f92102dff11c1b773f00d0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=628597956599f0f6766e0b6cfe22aa8dcff6cf5a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=68e3579a5fef4b45e14802808476baac5797e741",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=adebf4b54f615014f09f90c6eca9499ed2958ea0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b2623d8166563a19bee0cc8292e4ec951a42a6da",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}