{
    "source": "BDSA",
    "name": "BDSA-2021-0340",
    "title": "Elasticsearch Vulnerable to Sensitive Information Disclosure via Audit Log Information Leakage",
    "description": "Elasticsearch is vulnerable to an information disclosure issue due to how the audit logging functionality can log sensitive information such as password hashes or authentications tokens when audit logging is enabled with ` xpack.security.audit.logfile.events.emit_request_body`.\n\nThis issue could allow an administrative user to access this sensitive information.",
    "technicalDescription": "",
    "publishedDate": "2021-02-11T16:32:43.703Z",
    "updatedDate": "2021-07-02T15:58:36.369Z",
    "disclosureDate": "2021-02-10T00:00:00.000Z",
    "solution": "Fixed in [**7.10.0**](https://github.com/elastic/elasticsearch/releases/tag/v7.10.0) and [**6.8.14**](https://github.com/elastic/elasticsearch/releases/tag/v6.8.14).\n\nThe latest stable releases are available [here](https://github.com/elastic/elasticsearch/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has suggested [here](https://discuss.elastic.co/t/elastic-stack-7-11-0-and-6-8-14-security-update/263915) that if an upgrade is not possible, the `emit_request_body` option should be disabled in the `elasticsearch.yml` file.",
    "vendorFixDate": "2021-02-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0340",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-779"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7021",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0340/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.elastic.co/t/elastic-stack-7-11-0-and-6-8-14-security-update/263915",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://discuss.elastic.co/t/elastic-stack-7-11-0-and-6-8-14-security-update/263915",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/releases/tag/v6.8.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/releases/tag/v7.10.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0340/default-remediation-status"
            }
        ]
    }
}