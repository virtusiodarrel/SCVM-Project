{
    "source": "BDSA",
    "name": "BDSA-2021-1546",
    "title": "Zope Vulnerable to Remote Code Execution (RCE) via Path Traversal in TAL Expressions",
    "description": "Zope is vulnerable to remote code execution due to a path traversal via TAL expressions. \n\nA remote attacker that successfully exploits this could execute arbitrary code on the application.",
    "technicalDescription": "This vulnerability exists due to untrusted users being assigned the Zope Manager role allowing for adding/editing Zope page templates. Attackers could exploit this by access untrusted modules indirectly through Python modules allowing for the attacker to achieve remote code execution (RCE) via TAL expressions. \n\nThe vendor addressed this by preventing traversal to names starting with ``_`` in TAL expressions.\n\n**Note**: The fixes released in **5.2** and **4.6** following the publication of [this](https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36) advisory can be considered incomplete as there are other path traversal cases that they do not address. The vendor later published [this](https://github.com/zopefoundation/Zope/security/advisories/GHSA-rpcg-f9q6-2mq6) advisory to address the additional cases and released versions **5.2.1** and **4.6.1**. The additional cases were assigned **CVE-2021-32674** (**BDSA-2021-1733**).",
    "publishedDate": "2021-05-24T15:29:10.978Z",
    "updatedDate": "2021-08-06T13:39:18.143Z",
    "disclosureDate": "2021-05-21T00:00:00.000Z",
    "exploitPublishDate": "2021-05-27T00:00:00.000Z",
    "solution": "Fixed in [**5.2.1**](https://github.com/zopefoundation/Zope/releases/tag/5.2.1) by [this](https://github.com/zopefoundation/Zope/commit/1f8456bf1f908ea46012537d52bd7e752a532c91) commit and [this](https://github.com/zopefoundation/Zope/commit/1d897910139e2c0b11984fc9b78c1da1365bec21) commit.\n\nFixed in [**4.6.1**](https://github.com/zopefoundation/Zope/releases/tag/4.6.1) by [this](https://github.com/zopefoundation/Zope/commit/e98d326326e36e8dddc53251e2ac9bfb3fcbe397) commit and [this](https://github.com/zopefoundation/Zope/commit/8af277ee3c1856b6b85a144555bff55c2a5688ff) commit.\n\nThe latest stable releases are available [here](https://github.com/zopefoundation/Zope/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "",
    "workaround": "The vendor has stated [here](https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36) that the ability to add or edit Zope Page Templates through the web should be restricted to trusted users by using the standard Zope user / role permission mechanisms.",
    "vendorFixDate": "2021-06-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1546",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32633",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1546/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cyllective.com/blog/post/plone-authenticated-rce-cve-2021-32633/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/commit/1d897910139e2c0b11984fc9b78c1da1365bec21",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/commit/1f8456bf1f908ea46012537d52bd7e752a532c91",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/commit/8af277ee3c1856b6b85a144555bff55c2a5688ff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/commit/e98d326326e36e8dddc53251e2ac9bfb3fcbe397",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/releases/tag/4.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/releases/tag/5.2.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/security/advisories/GHSA-rpcg-f9q6-2mq6",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1546/default-remediation-status"
            }
        ]
    }
}