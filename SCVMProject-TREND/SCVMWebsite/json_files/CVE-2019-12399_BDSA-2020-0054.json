{
    "source": "BDSA",
    "name": "BDSA-2020-0054",
    "title": "Apache Kafka Connect Vulnerable to Information Disclosure via Connector Task Configuration Request",
    "description": "Apache Kafka Connect application endpoint returns sensitive data in plaintext rather than to the secret's provider location when it receives a client request for a particular configuration file.",
    "technicalDescription": "Apache Kafka Connect cluster will provide the plaintext secret rather than the externalized secrets variable if requested for its connector's task configurations. The issue is related to how the `AbstractHerder` class identifies task configurations that contain variables for externalized secrets. Method `matcher.matches()` in `keysWithVariableValues` expects the entire input string to match the regular expression, therefore it does not cover cases when there are additional characters besides the secret, allowing plaintext secrets to be returned in task configuration queries. The vulnerability was fixed by replacing `matcher.matches` with `matcher.find`, so that task configurations with externalized secrets are correctly found.",
    "publishedDate": "2020-01-20T15:45:57.406Z",
    "updatedDate": "2021-02-16T17:29:23.526Z",
    "disclosureDate": "2020-01-13T00:00:00.000Z",
    "exploitPublishDate": "2019-08-09T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/apache/kafka/commit/794637232cea44ee458839a293091473e81fb01e) commit in:\n* [**2.2.2**](https://github.com/apache/kafka/releases/tag/2.2.2)\n* [**2.3.1**](https://github.com/apache/kafka/releases/tag/2.3.1)\n* [**2.4.0**](https://github.com/apache/kafka/releases/tag/2.4.0)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "HIGH",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.5
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:H/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "HIGH",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:H/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Oleksandr Diachenko",
    "workaround": "",
    "vendorFixDate": "2019-08-13T00:00:00.000Z",
    "vendorNotifiedDate": "2019-08-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0054",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12399",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0054/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/kafka/commit/794637232cea44ee458839a293091473e81fb01e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/kafka/releases/tag/2.2.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/kafka/releases/tag/2.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/kafka/releases/tag/2.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/KAFKA-8774",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/KAFKA-8774",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q1/4",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0054/default-remediation-status"
            }
        ]
    }
}