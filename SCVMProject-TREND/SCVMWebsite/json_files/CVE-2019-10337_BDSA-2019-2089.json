{
    "source": "BDSA",
    "name": "BDSA-2019-2089",
    "title": "Token Macro Plugin for Jenkins Vulnerable to XML External Entities (XXE) Attack via 'call' Method",
    "description": "The Token Macro plugin for Jenkins is vulnerable to XML external entities (XXE) attacks.  If an application is using this plugin to process untrusted input, an attacker can use this to obtain sensitive information, perform server-side request forgery (SSRF) or cause a denial-of-service (DoS) condition.",
    "technicalDescription": "The vulnerability is due to the `call()` method of the `readXML` class in `XmlFileMacro.java` allowing external entities under default configuration.  This is due to the class passing a raw file to `javax.xml.parsers.DocumentBuilder`.  Any Jenkins instance passing user supplied files to the Token Macro plugin could be manipulated into sending internal files to an attacker controlled server.  This could could be used to disclose information or perform server-side request forgery.  It is also possible to supply a crafted file that could be used to cause a DoS against the XML parser.\n\nThe `readXML` class and the `call` method were introduced by [this](https://github.com/jenkinsci/token-macro-plugin/commit/c6d4ae5c5a6d3d03f2a575029c23ea3fbd7bc155) commit.",
    "publishedDate": "2019-07-15T12:07:53.932Z",
    "updatedDate": "2019-07-15T12:07:53.922Z",
    "disclosureDate": "2019-06-11T00:00:00.000Z",
    "solution": "Fixed in version [**2.8**](https://github.com/jenkinsci/token-macro-plugin/releases/tag/token-macro-2.8) by [this](https://github.com/jenkinsci/token-macro-plugin/commit/004319f1b6e2a0f097a096b9df9dc19a5ac0d9b0) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Daniel Beck, CloudBees, Inc.",
    "workaround": "",
    "vendorFixDate": "2019-06-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2089",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-611"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10337",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2089/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/token-macro-plugin/commit/004319f1b6e2a0f097a096b9df9dc19a5ac0d9b0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/token-macro-plugin/commit/c6d4ae5c5a6d3d03f2a575029c23ea3fbd7bc155",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/token-macro-plugin/releases/tag/token-macro-2.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jenkins.io/security/advisory/2019-06-11/#SECURITY-1399",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2089/default-remediation-status"
            }
        ]
    }
}