{
    "source": "BDSA",
    "name": "BDSA-2022-1147",
    "title": "curl Vulnerable to Incorrect Connection Re-use via Not Considering IPv6 Zone IDs",
    "description": "curl may re-use an incorrect connection because it does not take the zone ID into consideration when handling IPv6 connections. A remote attacker could leverage this to force the incorrect re-use of a previous connection, resulting in potential confidentiality impacts.",
    "technicalDescription": "The problem exists in the `hashkey()` function of file `lib/conncache.c` because of a logic flaw where the zone ID is not included in the \"bundle\" hashkey.\n\n**NOTE** This vulnerability is not exploitable with public IPv6 addresses on linux systems (the kernel strips out zone index for public addresses). It is exploitable with macOS however, and possibly other non-linux OSes.",
    "publishedDate": "2022-04-27T09:56:34.399Z",
    "updatedDate": "2022-04-29T12:36:34.257Z",
    "disclosureDate": "2022-04-25T00:00:00.000Z",
    "exploitPublishDate": "2022-04-27T00:00:00.000Z",
    "solution": "Fixed in version [**7.83.0**](https://github.com/curl/curl/releases/tag/curl-7_83_0) by [this](https://github.com/curl/curl/commit/058f98dc3fe595f21dc26a5b9b1699e519ba5705) commit.\n\nThe latest releases can be found [here](https://github.com/curl/curl/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Harry Sintonen",
    "workaround": "",
    "vendorFixDate": "2022-04-25T00:00:00.000Z",
    "vendorNotifiedDate": "2022-04-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-1147",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-201"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2022-27775",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-1147/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/058f98dc3fe595f21dc26a5b9b1699e519ba5705",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/2d0e9b40d3237b1",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_83_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1551588",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1551588",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2022/q2/63",
                "label": "ADVISORY"
            }
        ]
    }
}