{
    "source": "BDSA",
    "name": "BDSA-2020-1573",
    "title": "Mattermost Server Vulnerable to Denial-of-Service (DoS) via Infinite Loop in Webhook Requests",
    "description": "It was discovered that Mattermost Server contains an infinite loop vulnerability splitting post attachments into multiple posts.  An attacker could exploit this flaw to cause an excessive resource consumption resulting in denial-of-service (DoS).",
    "technicalDescription": "The vulnerability occurs in the `SplitWebhookPost()` function in the `app/webhook.go` file. The function performs an assignment copy of a `model.post` instead of using `model.Post.clone()`. This resulted in the `post.props` map being copied over to the copy and the function entering an infinite loop.",
    "publishedDate": "2020-07-01T09:45:46.286Z",
    "updatedDate": "2020-07-01T09:45:46.276Z",
    "disclosureDate": "2020-01-16T00:00:00.000Z",
    "solution": "Fixed in [**5.23.0-rc4**](https://github.com/mattermost/mattermost-server/commits/v5.23.0-rc4) by [this](https://github.com/mattermost/mattermost-server/commit/ed1576d007a09b07574b18784b9eabb3d8c9db53) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-05-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1573",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-835"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14447",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1573/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/commit/9c0575ce6ef662c18ad7eb91bf6084c6fac1b7ae",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/commit/ed1576d007a09b07574b18784b9eabb3d8c9db53",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/commits/v5.23.0-rc4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mattermost.com/security-updates/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1573/default-remediation-status"
            }
        ]
    }
}