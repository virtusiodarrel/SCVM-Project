{
    "source": "BDSA",
    "name": "BDSA-2019-2586",
    "title": "Nokogiri Vulnerable to Arbitrary Code Execution via Command Injection in 'load_file' Method",
    "description": "Nokogiri is vulnerable to command injection. An attacker could exploit this vulnerability by passing maliciously crafted input to Nokogiri when a particular undocumented method is being used to ingest untrusted user data. This would allow the attacker to achieve command injection, potentially executing commands on the server in the context of the application user.",
    "technicalDescription": "The vulnerability lies in code generated by the Rexial package which allows code to be executed in a subprocess by invoking the `Kernal.open` method within Ruby. The vulnerable method is `Nokogiri::CSS::Tokenizer#load_file`. The vulnerability was fixed by changing the behavior of Rexical, regenerating the code in question and bumping the Rexical version dependency in Nokogiri.",
    "publishedDate": "2019-08-21T13:51:09.136Z",
    "updatedDate": "2020-07-15T14:54:05.634Z",
    "disclosureDate": "2019-07-20T00:00:00.000Z",
    "solution": "Fixed in [**1.10.4**](https://github.com/sparklemotion/nokogiri/releases/tag/v1.10.4) by [this](https://github.com/sparklemotion/nokogiri/commit/5fe449fd3ab8cc25a71499128529c821c10dde83) commit.\n\nFixed in Rexical [**1.0.7**](https://github.com/tenderlove/rexical/releases/tag/v1.0.7) by [this](https://github.com/tenderlove/rexical/commit/a652474dbc66be350055db3e8f9b3a7b3fd75926) commit and [this](https://github.com/tenderlove/rexical/commit/003297eff43048660a14d027767380519b249cc5) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-08-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2586",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5477",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2586/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sparklemotion/nokogiri/commit/5fe449fd3ab8cc25a71499128529c821c10dde83",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sparklemotion/nokogiri/issues/1915",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sparklemotion/nokogiri/releases/tag/v1.10.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tenderlove/rexical/commit/003297eff43048660a14d027767380519b249cc5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tenderlove/rexical/commit/a652474dbc66be350055db3e8f9b3a7b3fd75926",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tenderlove/rexical/releases/tag/v1.0.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/650835",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2586/default-remediation-status"
            }
        ]
    }
}