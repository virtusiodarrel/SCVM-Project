{
    "source": "BDSA",
    "name": "BDSA-2019-2918",
    "title": "WordPress Vulnerable to Cross-Site Scripting (XSS) via 'wp_kses_bad_protocol_once'",
    "description": "WordPress contains a cross-site scripting (XSS) flaw. This could allow a remote attacker to execute arbitrary JavaScript in the target's browser by supplying a specially crafted HTTP request which executes code via the vulnerable parameter.",
    "technicalDescription": "This vulnerability is due to invalid URL sanitization for user-supplied encoded input passed via the `string` parameter to the `wp_kses_bad_protocol_once` function in `src/wp-includes/kses.php`. For example, the cross-site scripting (XSS) payload: `javascript&#58alert(1)` will incorrectly trigger.",
    "publishedDate": "2019-09-12T15:20:30.936Z",
    "updatedDate": "2019-11-22T11:42:45.029Z",
    "disclosureDate": "2019-09-05T00:00:00.000Z",
    "exploitPublishDate": "2017-04-17T00:00:00.000Z",
    "solution": "Fixed in **[5.2.3](https://github.com/WordPress/wordpress-develop/releases/tag/5.2.3)** by [this](https://github.com/WordPress/wordpress-develop/commit/66a1deb18b4009c6772a9d7fd05a7578ecd25d80) commit.\n\nFixed in **[5.1.2](https://github.com/WordPress/wordpress-develop/releases/tag/5.1.2)** by [this](https://github.com/WordPress/wordpress-develop/commit/19a8957bd073a1cfc1f75000e41b48d5676e36f7) commit.\n\nFixed in **[5.0.6](https://github.com/WordPress/wordpress-develop/releases/tag/5.0.6)** by [this](https://github.com/WordPress/wordpress-develop/commit/810fd451153e3b6ca746240b4aef7d576a0314bc) commit.\n\nFixed in **[4.9.11](https://github.com/WordPress/wordpress-develop/releases/tag/4.9.11)** by [this](https://github.com/WordPress/wordpress-develop/commit/f78242362b84cb5c1ad327c32b4585fa9d7b736a) commit.\n\nFixed in **[4.8.10](https://github.com/WordPress/wordpress-develop/releases/tag/4.8.10)** by [this](https://github.com/WordPress/wordpress-develop/commit/d4546a80c2ec1bdd9fe999c25e58a899f97b116b) commit.\n\nFixed in **[4.7.14](https://github.com/WordPress/wordpress-develop/releases/tag/4.7.14)** by [this](https://github.com/WordPress/wordpress-develop/commit/7d32848c553f83891833d10e0eaf999e2dd38d7b) commit.\n\nFixed in **[4.6.15](https://github.com/WordPress/wordpress-develop/releases/tag/4.6.15)** by [this](https://github.com/WordPress/wordpress-develop/commit/f4e42693a56117f529f909fc7b8b16c86a2ebb40) commit.\n\nFixed in **[4.5.18](https://github.com/WordPress/wordpress-develop/releases/tag/4.5.18)** by [this](https://github.com/WordPress/wordpress-develop/commit/fafead9bef48099f20a04614807da588df45bbfe) commit.\n\nFixed in **[4.4.19](https://github.com/WordPress/wordpress-develop/releases/tag/4.4.19)** by [this](https://github.com/WordPress/wordpress-develop/commit/06968503f3b7d188a8ce5d36dd7291cb167e136e) commit.\n\nFixed in **[4.3.20](https://github.com/WordPress/wordpress-develop/releases/tag/4.3.20)** by [this](https://github.com/WordPress/wordpress-develop/commit/c49ecfb258d2109c4ff3ef7141772cfa4498de91) commit.\n\nFixed in **[4.2.24](https://github.com/WordPress/wordpress-develop/releases/tag/4.2.24)** by [this](https://github.com/WordPress/wordpress-develop/commit/ee7ee51c07c2a193c90c5253d55675ede3d3cdd0) commit.\n\nFixed in **[4.1.27](https://github.com/WordPress/wordpress-develop/releases/tag/4.1.27)** by [this](https://github.com/WordPress/wordpress-develop/commit/ac50f6e34c88cc2ac452bd3d25bb43de22bdb227) commit.\n\nFixed in **[4.0.27](https://github.com/WordPress/wordpress-develop/releases/tag/4.0.27)** by [this](https://github.com/WordPress/wordpress-develop/commit/ad1512f32028035c5f9903aae87ca7d665ebd467) commit.\n\nFixed in **[3.9.28](https://github.com/WordPress/wordpress-develop/releases/tag/3.9.28)** by [this](https://github.com/WordPress/wordpress-develop/commit/db633b0e08fb91656f7dee8628f39304aaaadfc2) commit.\n\nFixed in **[3.8.30](https://github.com/WordPress/wordpress-develop/releases/tag/3.8.30)** by [this](https://github.com/WordPress/wordpress-develop/commit/a17a542f41229cb0418fe9c290c18e7a27901bca) commit.\n\nFixed in **[3.7.30](https://github.com/WordPress/wordpress-develop/releases/tag/3.7.30)** by [this](https://github.com/WordPress/wordpress-develop/commit/3ae989d5c2bb94f8400dd743b6966671d7fcaf64) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Soroush Dalili",
    "workaround": "",
    "vendorFixDate": "2019-09-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2918",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-16222",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2918/ranges"
            },
            {
                "rel": "reference",
                "href": "(https://github.com/WordPress/wordpress-develop/commit/19a8957bd073a1cfc1f75000e41b48d5676e36f7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/06968503f3b7d188a8ce5d36dd7291cb167e136e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/3ae989d5c2bb94f8400dd743b6966671d7fcaf64",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/66a1deb18b4009c6772a9d7fd05a7578ecd25d80",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/7d32848c553f83891833d10e0eaf999e2dd38d7b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/810fd451153e3b6ca746240b4aef7d576a0314bc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/a17a542f41229cb0418fe9c290c18e7a27901bca",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/ac50f6e34c88cc2ac452bd3d25bb43de22bdb227",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/ad1512f32028035c5f9903aae87ca7d665ebd467",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/b43712e0f79a9f5bea52217e06155e2f471c490c",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/c49ecfb258d2109c4ff3ef7141772cfa4498de91",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/d4546a80c2ec1bdd9fe999c25e58a899f97b116b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/db633b0e08fb91656f7dee8628f39304aaaadfc2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/ee7ee51c07c2a193c90c5253d55675ede3d3cdd0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/f4e42693a56117f529f909fc7b8b16c86a2ebb40",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/f78242362b84cb5c1ad327c32b4585fa9d7b736a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/commit/fafead9bef48099f20a04614807da588df45bbfe",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/wordpress-develop/releases/tag/5.2.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/339483",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2918/default-remediation-status"
            }
        ]
    }
}