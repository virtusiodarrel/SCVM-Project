{
    "source": "BDSA",
    "name": "BDSA-2019-4742",
    "title": "WALinuxAgent Vulnerable to Information Disclosure via Insecure Swap File Permissions",
    "description": "WALinuxAgent is vulnerable to information disclosure due to the creation of swap files with weak permissions. An authenticated attacker could obtain potentially sensitive information by reading the contents of these swap files.",
    "technicalDescription": "WAlinuxAgent can be configured to create swap files on ephemeral drives. These swap files are created using code contained in `resourcedisk/default.py` and `resourcedisk/freebsd.py`. The permissions bit field that the swap files are created with is `0644`. This effectively gives read access to all users. An authenticated attacker could exploit this in order to obtain sensitive information.\n\nIt should be noted that none of the distributions that are endorsed by Azure are vulnerable be default. However, customized images on which Python 3 is the default Python version may be vulnerable.",
    "publishedDate": "2020-10-09T13:46:30.234Z",
    "updatedDate": "2020-10-09T13:46:52.322Z",
    "disclosureDate": "2019-03-14T00:00:00.000Z",
    "solution": "Fixed in [**2.2.38**](https://github.com/Azure/WALinuxAgent/releases/tag/v2.2.38) by [this](https://github.com/Azure/WALinuxAgent/commit/8b2fa7d6051d0ee9952be4b42185c24d2a2eacff) commit.\n\nThe latest stable releases can be found [here](https://github.com/Azure/WALinuxAgent/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Francis McBratney (Destinatech Limited)",
    "workaround": "The following steps can be taken to manually mitigate the issue:\n\n> To mitigate this issue, validate whether the swapfile exists and if so, make sure it is secured by setting its access permissions to root only by executing the following command as root:\n> `sudo chmod 600 /mnt/resource/swapfile` \n> or \n> `sudo chmod 600 /mnt/swapfile`\n>  depending on the specific distro.",
    "vendorFixDate": "2019-03-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4742",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-0804",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4742/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Azure/WALinuxAgent/commit/8b2fa7d6051d0ee9952be4b42185c24d2a2eacff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Azure/WALinuxAgent/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Azure/WALinuxAgent/releases/tag/v2.2.38",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0804",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0804",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4742/default-remediation-status"
            }
        ]
    }
}