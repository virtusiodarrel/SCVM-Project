{
    "source": "BDSA",
    "name": "BDSA-2022-2430",
    "title": "NodeBB Vulnerable to Account Takeover via Usage of Cryptographically Weak Pseudo Random Number Generator (PRNG) in 'utils.generateUUID()' Function",
    "description": "NodeBB uses a cryptographically weak pseudo random number generator (PRNG) in the `utils.generateUUID()` function. This could allow an attacker to calculate the reset code by using a specially crafted script and invoking the password reset functionality multiple times. Using the reset code, the attacker can take over the corresponding account.",
    "technicalDescription": "This vulnerability exists because the application uses `Math.random()` for random number generation. This function relies on a weak cryptographic pseudorandom number generator and it can allow an attacker to correctly deduce the reset code by repeatedly invoking the password reset functionality. This reset code can allow the attacker to take over a victim's account. However, the attacker needs access to the victim's email address in order to exploit this vulnerability.\n\nThis issue has been mitigated by strengthening the function for random number generation that is used for the password reset codes.",
    "publishedDate": "2022-09-01T12:39:41.461Z",
    "updatedDate": "2022-09-01T12:39:41.448Z",
    "disclosureDate": "2022-08-24T00:00:00.000Z",
    "solution": "Fixed in **[1.19.8](https://github.com/NodeBB/NodeBB/releases/tag/v1.19.8)** by [this](https://github.com/NodeBB/NodeBB/commit/81e3c1ba488d03371a5ce8d0ebb5c5803026e0f9) commit, and in **[2.0.1](https://github.com/NodeBB/NodeBB/releases/tag/v2.0.1)** by [this](https://github.com/NodeBB/NodeBB/commit/e802fab87f94a13f397f04cfe6068f2f7ddf7888) commit.\n\nThe latest stable releases can be found [here](https://github.com/NodeBB/NodeBB/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "HakuPiku",
    "workaround": "",
    "vendorFixDate": "2022-05-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2430",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-338"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-36045",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2430/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NodeBB/NodeBB/commit/81e3c1ba488d03371a5ce8d0ebb5c5803026e0f9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NodeBB/NodeBB/commit/e802fab87f94a13f397f04cfe6068f2f7ddf7888",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NodeBB/NodeBB/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NodeBB/NodeBB/releases/tag/v1.19.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NodeBB/NodeBB/releases/tag/v2.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NodeBB/NodeBB/security/advisories/GHSA-p4cc-w597-6cpm",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2430/default-remediation-status"
            }
        ]
    }
}