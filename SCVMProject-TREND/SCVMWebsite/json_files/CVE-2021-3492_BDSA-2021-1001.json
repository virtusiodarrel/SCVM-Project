{
    "source": "BDSA",
    "name": "BDSA-2021-1001",
    "title": "Ubuntu Kernel Vulnerable to Denial-of-Service (DoS) via Double Free and Memory Exhaustion in 'Shiftfs'",
    "description": "The Ubuntu kernel contains a denial-of-service (DoS) vulnerability.  This allows an attacker or a malicious application to cause the kernel to crash.\n\n**Note:** The vulnerability occurs in `Shiftfs`.  This package is not included in the upsteam Linux kernel.",
    "technicalDescription": "The DoS is due to a double free potentially occurring in `copy_to_user` function calls.  The functions `shiftfs_btrfs_ioctl_fd_replace` and `shiftfs_btrfs_ioctl_fd_restore` in `fs/shiftfs.c` can return the value of memory addresses upon error instead of returning a negative error code as `Shiftfs` expects.  Additionally some return values are initialized at the start of these functions and not freed if an error occurs.  This vulnerability can cause file system calls to trigger double free or cause memory exhaustion, this may cause the kernel to crash.",
    "publishedDate": "2021-04-19T15:08:53.851Z",
    "updatedDate": "2021-04-19T15:08:53.842Z",
    "disclosureDate": "2021-04-15T00:00:00.000Z",
    "solution": "Fixed in [**Ubuntu-5.8.0-50.56**](https://git.launchpad.net/~ubuntu-kernel/ubuntu/+source/linux/+git/groovy/tag/?h=Ubuntu-5.8.0-50.56) by [this](https://git.launchpad.net/~ubuntu-kernel/ubuntu/+source/linux/+git/focal/commit/?id=25c891a949bf918b59cbc6e4932015ba4c35c333) commit and [this](https://git.launchpad.net/~ubuntu-kernel/ubuntu/+source/linux/+git/focal/commit/?id=8fee52ab9da87d82bc6de9ebb3480fff9b4d53e6) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1001",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-415"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3492",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1001/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.launchpad.net/~ubuntu-kernel/ubuntu/+source/linux/+git/focal/commit/?id=25c891a949bf918b59cbc6e4932015ba4c35c333",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.launchpad.net/~ubuntu-kernel/ubuntu/+source/linux/+git/focal/commit/?id=8fee52ab9da87d82bc6de9ebb3480fff9b4d53e6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.launchpad.net/~ubuntu-kernel/ubuntu/+source/linux/+git/groovy/tag/?h=Ubuntu-5.8.0-50.56",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/04/16/2",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1001/default-remediation-status"
            }
        ]
    }
}