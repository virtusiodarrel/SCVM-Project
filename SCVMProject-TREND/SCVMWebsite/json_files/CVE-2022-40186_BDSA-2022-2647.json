{
    "source": "BDSA",
    "name": "BDSA-2022-2647",
    "title": "HashiCorp Vault Vulnerable to Information Disclosure via Alias Metadata Leak",
    "description": "HashiCorp Vault is vulnerable to an information disclosure issue due to a flaw in how entity aliases can be mishandled. Entity aliases that are mapped to a single entity and share an alias name, but have different mount accessors, can cause alias metadata to be leaked between the aliases.\n\nIf templated policies are using alias metadata for path names, the leak could result in one authentication method being granted access to the mount accessor of another authentication method which could lead to the unintended access of data.\n\n**Note**: The vendor has stated in their [advisory](https://discuss.hashicorp.com/t/hcsec-2022-18-vault-entity-alias-metadata-may-leak-between-aliases-with-the-same-name-assigned-to-the-same-entity/44550) that \"entity aliases whose names were created by Vault using the auto-generation feature are unaffected by this bug as this requires a privileged operator to map entity aliases that share names, but have different mounts, to a single entity.\"",
    "technicalDescription": "This issue exists due to how the metadata of an entity alias for an authentication method can be overwritten when executing a login operation for an authentication method with the same alias name within a single given entity. So when a Vault deployment is using templated polices that use `alias.Name`, after deployment of the policy the `identity.entity.aliases.<mount accessor>.name` key may be overwritten for a different mount accessor with the same alias name.\n\nTo remedy this issue, the vendor has updated the `changedAliasIndex()` function in the `vault/identity_store.go` file to check if the mount accessors in question are different.",
    "publishedDate": "2022-09-23T09:50:21.887Z",
    "updatedDate": "2022-09-23T09:50:21.874Z",
    "disclosureDate": "2022-09-20T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.11.3**](https://github.com/hashicorp/vault/releases/tag/v1.11.3) by [this](https://github.com/hashicorp/vault/commit/e93f3c2c4fb981b035f465bb44a66f14b2c23682) commit,\n* [**1.10.6**](https://github.com/hashicorp/vault/releases/tag/v1.10.6) by [this](https://github.com/hashicorp/vault/commit/e5caf39f7eb94df92a4f0ec5231f06e0b0fa40ea) commit,\n* [**1.9.9**](https://github.com/hashicorp/vault/releases/tag/v1.9.9) by [this](https://github.com/hashicorp/vault/commit/f788761c3dbb6a73b53200c74bc964d5fcb9a3d8) commit.\n\nThe latest stable releases are available [here](https://www.vaultproject.io/downloads).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "While the vendor has not directly offered any workarounds for this issue, Vault's [entity alias documentation](https://developer.hashicorp.com/vault/api-docs/secret/identity/entity-alias#create-an-entity-alias) recommends that users create a unique alias for each entity whenever possible.",
    "vendorFixDate": "2022-08-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2647",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-40186",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2647/ranges"
            },
            {
                "rel": "reference",
                "href": "https://developer.hashicorp.com/vault/api-docs/secret/identity/entity-alias#create-an-entity-alias",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://discuss.hashicorp.com/t/hcsec-2022-18-vault-entity-alias-metadata-may-leak-between-aliases-with-the-same-name-assigned-to-the-same-entity/44550",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/blob/main/CHANGELOG.md#1113",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/e5caf39f7eb94df92a4f0ec5231f06e0b0fa40ea",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/e93f3c2c4fb981b035f465bb44a66f14b2c23682",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/f788761c3dbb6a73b53200c74bc964d5fcb9a3d8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/pull/16838",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases/tag/v1.10.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases/tag/v1.11.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases/tag/v1.9.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.vaultproject.io/downloads",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2647/default-remediation-status"
            }
        ]
    }
}