{
    "source": "BDSA",
    "name": "BDSA-2020-2687",
    "title": "openSUSE Packaging of apt-cacher-ng Vulnerable to Symlink Attacks via Privilege Escalation",
    "description": "The openSUSE packaging of apt-cacher-ng exposes the application to symlink attacks via privilege escalation. Additional unexplored security issues could also be possible.",
    "technicalDescription": "The systemd service unit configuration (`apt-cacher-ng.service`) in the openSUSE packaging of apt-cacher-ng causes the daemon to run as root. This does not apply to the upstream version. \n\nAlthough the openSUSE packaging doesn't use the unprivileged apt-cacher-ng user it still creates it on the system. The directory `/run/apt-cacher-ng` is created for this user via a systemd-tmpfiles configuration file from upstream. The daemon assumes that this directory is safe to handle without precautions but this assumption is broken by the bad packaging.\n\nAn attacker who gained access to the apt-cacher-ng user account could therefore perform symlink attacks in `/run/apt-cacher-ng` to cause writes to privileged file system locations by root once the service is started/restarted. In addition the socket path `/run/apt-cacher-ng/socket` could be replaced by an attacker-controlled socket, allowing them to hijack privileged client connections to apt-cacher-ng.",
    "publishedDate": "2021-02-05T13:55:40.671Z",
    "updatedDate": "2021-02-05T13:55:40.658Z",
    "disclosureDate": "2020-01-20T00:00:00.000Z",
    "solution": "Fixed in [**3.1-lp151.3.3.1**](http://download.opensuse.org/update/leap/15.1/oss/src/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.6,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 2.7,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "(AV:L/AC:M/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matthias Gerstner",
    "workaround": "",
    "vendorFixDate": "2020-01-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2687",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-250"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-18899",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2687/ranges"
            },
            {
                "rel": "reference",
                "href": "http://download.opensuse.org/update/leap/15.1/oss/src/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/show_bug.cgi?id=1157703",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q1/22",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2687/default-remediation-status"
            }
        ]
    }
}