{
    "source": "BDSA",
    "name": "BDSA-2021-1249",
    "title": "Exim Vulnerable to Authenticated Command Execution via New-Line Injection in 'spool_out.c'",
    "description": "Exim contains a command execution vulnerability. This allows an authenticated attacker to use crafted input that can execute command on an underlying server running Exim. The attackers commands will be run with root privileges.",
    "technicalDescription": "The vulnerability is due to how exim uses `auth_xtextdecode` to read `AUTH=` parameter data without any sanitization. This results in `authenticated_sender` data being written to the spool header file that may contain malicious characters. Using hex bytes, an attacker can inject new-line characters followed by additional commands. \n\nThe researches that discovered this vulnerability have demonstrated how this vulnerability can be used to read information from a server.\n\nThis vulnerability has been mitigated by sanitizing `authenticated_sender` in `src/src/spool_out.c`.",
    "publishedDate": "2021-05-05T15:53:16.569Z",
    "updatedDate": "2021-05-05T15:53:16.560Z",
    "disclosureDate": "2021-05-04T00:00:00.000Z",
    "exploitPublishDate": "2021-05-04T00:00:00.000Z",
    "solution": "Fixed in [**4.94.1**](https://github.com/Exim/exim/releases/tag/exim-4.94.1) by [this](https://github.com/Exim/exim/commit/fcddccd650178ceeec3655c6c40f420164a8706e) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "qualys",
    "workaround": "",
    "vendorFixDate": "2021-04-27T00:00:00.000Z",
    "discoveryDate": "2020-10-20T00:00:00.000Z",
    "vendorNotifiedDate": "2020-10-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1249",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28021",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1249/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exim/exim/commit/fcddccd650178ceeec3655c6c40f420164a8706e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exim/exim/releases/tag/exim-4.94.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.qualys.com/2021/05/04/21nails/21nails.txt?_ga=2.266751755.444021674.1620208011-1511986837.1620208011",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.qualys.com/2021/05/04/21nails/21nails.txt?_ga=2.266751755.444021674.1620208011-1511986837.1620208011",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1249/default-remediation-status"
            }
        ]
    }
}