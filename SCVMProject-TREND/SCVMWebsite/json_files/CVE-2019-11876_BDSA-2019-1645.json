{
    "source": "BDSA",
    "name": "BDSA-2019-1645",
    "title": "PrestaShop Vulnerable to Reflected Cross-Site Scripting (XSS) via 'shop_country' Parameter",
    "description": "PrestaShop contains a cross-site scripting (XSS) vulnerability due to missing sanitization for a user-supplied input. This could allow a remote attacker to insert JavaScript code and steal session tokens, cookies, or other sensitive information by tricking user into clicking a crafted link.",
    "technicalDescription": "The vulnerability is caused by insufficient sanitization within the `shop_country` parameter in the `index.php` file. An attacker could include malicious scripts within the victim's webpage which will execute in the context of the user's browser. Exploitation of this vulnerability however does require the victim to follow the initial stages of the setup before the malicious link is executed, which includes accepting terms and conditions.",
    "publishedDate": "2019-05-27T13:12:22.116Z",
    "updatedDate": "2019-05-27T13:58:05.625Z",
    "disclosureDate": "2019-05-24T00:00:00.000Z",
    "exploitPublishDate": "2019-05-24T00:00:00.000Z",
    "solution": "Fixed in version [**1.7.6.0-beta.1**](https://github.com/PrestaShop/PrestaShop/releases/tag/1.7.6.0-beta.1) by [this](https://github.com/PrestaShop/PrestaShop/commit/eeeae5ab1f4dc81626f216b8eb2facce450c64cf) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alexander Drabek",
    "workaround": "",
    "vendorFixDate": "2019-05-10T00:00:00.000Z",
    "discoveryDate": "2019-05-07T00:00:00.000Z",
    "vendorNotifiedDate": "2019-05-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1645",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11876",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1645/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrestaShop/PrestaShop/commit/eeeae5ab1f4dc81626f216b8eb2facce450c64cf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrestaShop/PrestaShop/releases/tag/1.7.6.0-beta.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.logicallysecure.com/blog/xss-presta-xss-drupal/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.logicallysecure.com/blog/xss-presta-xss-drupal/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1645/default-remediation-status"
            }
        ]
    }
}