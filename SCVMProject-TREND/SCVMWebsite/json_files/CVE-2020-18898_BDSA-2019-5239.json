{
    "source": "BDSA",
    "name": "BDSA-2019-5239",
    "title": "Exiv2 Vulnerable to Denial-of-Service (DoS) via Stack Overflow in 'printIFDStructure' Function",
    "description": "Exiv2 is vulnerable to denial-of-service (DoS) due to the exhaustion of static memory resources. An attacker could crash a vulnerable instance of the application by causing it to process a maliciously crafted input file.\n\nIt should be noted that the input file must be processed with the `-pR` flag being specified. This flag is disabled by default in release builds. The vendor has stated that they will not issue a patch for this reason.",
    "technicalDescription": "The function `Image::printIFDStructure()`, of file `src/image.cpp`, contains several `if` blocks that will call `printIFDStructure()` recursively whenever the `if` statement's condition is true. For certain malformed image files, the condition will always evaluate to true, due to a failure of the application to update its state. As a result of this, the function will call itself indefinitely. Each time the function is called, a new stack frame is created. All of the available stack memory will eventually be exhausted, leading to a stack overflow. This will cause an exception to be raised, halting program execution. An attacker could use a maliciously crafted image file that will trigger the recursive function call in order to cause a DoS.\n\nIt should be noted that the vulnerability will only manifest itself if the `-pR` flag is enabled and is specified for the invocation of Exiv2 that is used to process the input file. This flag is disabled by default in release builds. The vendor has stated that they do not intend to issue a patch for this issue.",
    "publishedDate": "2021-08-23T13:46:59.300Z",
    "updatedDate": "2021-08-23T13:46:59.289Z",
    "disclosureDate": "2019-03-13T00:00:00.000Z",
    "exploitPublishDate": "2019-03-13T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 2.2
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:N/A:P/E:POC/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Cheng Wen",
    "workaround": "Ensure that any instances of Exiv2 that are executed are release builds. If a debug build is used, ensure that it is not invoked using the `-pR` flag with untrusted input.",
    "vendorNotifiedDate": "2019-03-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5239",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-674"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-18898",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5239/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/issues/741",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/issues/741",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/issues/741",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5239/default-remediation-status"
            }
        ]
    }
}