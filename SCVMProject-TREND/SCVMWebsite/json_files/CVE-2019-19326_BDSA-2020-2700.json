{
    "source": "BDSA",
    "name": "BDSA-2020-2700",
    "title": "Silverstripe Content Management System (CMS) Vulnerable to Cache Poisoning via 'HTTPRequestBuilder' Class",
    "description": "Silverstripe Content Management System (CMS) contains a cache poisoning vulnerability. An attacker could exploit this vulnerability to corrupt cached responses by sending a specially crafted request.",
    "technicalDescription": "Silverstripe CMS sites that have opted to allow HTTP Cache Headers on responses served by the framework's HTTP layer could be vulnerable to web cache poisoning. Through malicious modification of the `X-Original-Url` and `X-HTTP-Method-Override` headers responses can return unexpected responses to other consumers of this cached response. The majority of other headers associated with web cache poisoning are already disabled through request hostname forgery whitelists. \n\nThis issue was mitigated by stopping the use of the `X-HTTP-Method-Override` and `X-Original-Url `headers and the `_method` `POST` variable, as with the addition of `SS_HTTPRequest::setHttpMethod()`.",
    "publishedDate": "2020-10-09T14:38:19.164Z",
    "updatedDate": "2020-10-09T14:38:19.157Z",
    "disclosureDate": "2020-07-13T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.7.5**](https://github.com/silverstripe/silverstripe-framework/releases/tag/3.7.5) by [this](https://github.com/silverstripe/silverstripe-framework/commit/98926e4e6c26d1d43bb1faf516d15bdb2739556e) commit,\n* [**4.4.7**](https://github.com/silverstripe/silverstripe-framework/releases/tag/4.4.7) by [this](https://github.com/silverstripe/silverstripe-framework/commit/107706c12cd9cf4d1b8b96b6a6e223633209d851) commit,\n* [**4.5.4**](https://github.com/silverstripe/silverstripe-framework/releases/tag/4.5.4) by [this](https://github.com/silverstripe/silverstripe-framework/commit/8518987cbd1eaca71b65dd4a4b35591db941509a) commit,\n* [**4.6.0**](https://github.com/silverstripe/silverstripe-framework/releases/tag/4.6.0) by [this](https://github.com/silverstripe/silverstripe-framework/commit/71db45b18b4a3bce6a4630ff3a6c116c15f35874) commit.\n\nThe latest stable releases are available [here](https://github.com/silverstripe/silverstripe-framework/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "memN0ps -Aura Information Security, Will Boucher - Pulse Security, Sabine Degen",
    "workaround": "",
    "vendorFixDate": "2020-07-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2700",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19326",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2700/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/commit/107706c12cd9cf4d1b8b96b6a6e223633209d851",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/commit/71db45b18b4a3bce6a4630ff3a6c116c15f35874",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/commit/8518987cbd1eaca71b65dd4a4b35591db941509a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/commit/98926e4e6c26d1d43bb1faf516d15bdb2739556e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/3.7.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/4.4.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/4.5.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/4.6.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.silverstripe.org/download/security-releases/CVE-2019-19326",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2700/default-remediation-status"
            }
        ]
    }
}