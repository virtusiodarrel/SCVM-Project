{
    "source": "BDSA",
    "name": "BDSA-2020-4222",
    "title": "Nextcloud Server Vulnerable to Sensitive Data Exposure via External Storage App",
    "description": "Nextcloud Server is vulnerable to sensitive data exposure via external storage app. An attacker with local system admin privileges could exploit this to view the passwords of all users.",
    "technicalDescription": "This issue occurs in the `apps/files_external/lib/Lib/Auth/Password/LoginCredentials.php` file, the `apps/files_external/lib/Service/UserGlobalStoragesService.php` file, and the `LoginCredentials` class of the `apps/files_external/lib/Lib/Auth/Password/LoginCredentials.php` file because passwords are stored in the `oc_credentials` database table even when the `Log-in credentials, save in database` is not in use. It was mitigated by ensuring that login credentials are only stored in the database if there is an external storage which needs it, that saved credentials are removed once they are no longer required for accessing any storage, and that saved credentials are updated upon password change.",
    "publishedDate": "2021-03-01T16:57:10.198Z",
    "updatedDate": "2021-03-01T16:57:10.190Z",
    "disclosureDate": "2020-10-03T00:00:00.000Z",
    "exploitPublishDate": "2021-03-01T00:00:00.000Z",
    "solution": "Fixed in [**20.0.0rc1**](https://github.com/nextcloud/server/releases/tag/v20.0.0RC1) by the following commits:\n[Commit 1](https://github.com/nextcloud/server/commit/7ad0f66fc437a63d9b4deac3cd74814882acd6f0) \n[Commit 2](https://github.com/nextcloud/server/commit/c864e5dfc245e1de1bed6b73e11e5b3a4cdf65b7) \n[Commit 3](https://github.com/nextcloud/server/commit/d1bd3ba594e2ee949a29a0ce53aaa6ba78aaf354) \n\nThe latest stable releases are available [here](https://github.com/nextcloud/server/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 0.5,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Anderson Luiz Alves",
    "workaround": "",
    "vendorFixDate": "2020-07-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4222",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-257"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-312"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8296",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4222/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/7ad0f66fc437a63d9b4deac3cd74814882acd6f0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/c864e5dfc245e1de1bed6b73e11e5b3a4cdf65b7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/d1bd3ba594e2ee949a29a0ce53aaa6ba78aaf354",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/issues/17439",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/pull/21037",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v20.0.0RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/867164",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/867164",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://nextcloud.com/security/advisory/?id=NC-SA-2021-006",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4222/default-remediation-status"
            }
        ]
    }
}