{
    "source": "BDSA",
    "name": "BDSA-2022-0719",
    "title": "Pimcore Vulnerable to Stored Cross-Site Scripting (XSS) via Events Page",
    "description": "Pimcore is vulnerable to stored cross-site scripting (XSS). This could allow an attacker with administrative privileges to inject arbitrary web scripts and obtain sensitive information such as authentication tokens and user session cookies or manipulate how pages are rendered.",
    "technicalDescription": "This vulnerability has been mitigated by introducing a `Content-Security-Policy` HTTP response header. Specific resources are restricted when pages are loaded. Some restrictions include only allowing scripts to be loaded from the same origin as the page and only allowing scripts to be loaded from specific domains stored in the array `$allowedUrls`.\n\n`nonce` has been introduced in this policy which holds a random value and is generated via the `getNonce()` function.  If this random value does not match the tag in a script then the script will not execute. This prevents untrusted and malicious scripts from being executed on the page.",
    "publishedDate": "2022-03-16T17:53:19.566Z",
    "updatedDate": "2022-06-20T10:05:46.165Z",
    "disclosureDate": "2022-02-21T00:00:00.000Z",
    "exploitPublishDate": "2022-02-21T00:00:00.000Z",
    "solution": "Fixed in [**10.4.0**](https://github.com/pimcore/pimcore/releases/tag/v10.4.0) by [this](https://github.com/pimcore/pimcore/commit/6e0922c5b2959ac1b48500ac508d8fc5a97286f9) commit.\n\nThe latest stable releases are available [here](https://github.com/pimcore/pimcore/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 1.7,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Asura-N",
    "workaround": "",
    "vendorFixDate": "2022-03-14T00:00:00.000Z",
    "vendorNotifiedDate": "2022-02-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0719",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-0704",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0719/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/commit/6e0922c5b2959ac1b48500ac508d8fc5a97286f9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/releases/tag/v10.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/4142a8b4-b439-4328-aaa3-52f6fedfd0a6/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/4142a8b4-b439-4328-aaa3-52f6fedfd0a6/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0719/default-remediation-status"
            }
        ]
    }
}