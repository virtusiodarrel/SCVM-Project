{
    "source": "BDSA",
    "name": "BDSA-2020-0692",
    "title": "Ceph Vulnerable to Information Disclosure/Forgery via Reuse of Nonce Values",
    "description": "Ceph contains an information disclosure/forgery due to improper handling of nonce values in the secure mode of the messenger v2 protocol. An attacker could identify a victims session nonce value which could be reused to forge authentication tags, obtain sensitive information from sent data and manipulate encrypted data.",
    "technicalDescription": "Ceph reuses `AES-GCM` nonce values due to the wrapping that occurs when these values are created in `src/msg/async/ProtocolV2.cc`. \n\nThe secure mode of messenger V2 protocol uses `AES-128-GCM` with 96-bit nonces consisting of a 32-bit counter followed by a 64-bit salt. The counter is incremented after processing each frame and the salt is fixed for the session. Both of these values are initialized from the session key generated during negotiation and therefore are random values. Because the nonce value will wrap, after `2**32` frames the nonce reuse will occur and the session continues.\n\nThis allows an attacker to reveal the subkey for authentication tags with a single nonce value identified. After a few nonce values have been used twice the attacker can obtain sensitive information and may be able to encrypt-authenticate plaintext of their choice.",
    "publishedDate": "2020-04-15T11:01:38.155Z",
    "updatedDate": "2020-04-29T07:50:58.004Z",
    "disclosureDate": "2020-03-06T00:00:00.000Z",
    "solution": "Fixed in version [**15.2.1**](https://github.com/ceph/ceph/releases/tag/v15.2.1) by [this](https://github.com/ceph/ceph/commit/20b7bb685c5ea74c651ca1ea547ac66b0fee7035) commit and [this](https://github.com/ceph/ceph/commit/dfd1d81cec62e21e21696dc87d4db5f920e51a67) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ilya Dryomov (Red Hat)",
    "workaround": "",
    "vendorFixDate": "2020-03-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0692",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-323"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-1759",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0692/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph-ci/commit/659ec7dc6e30fe961832f813da007f49e603a33d",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph-ci/commit/659ec7dc6e30fe961832f813da007f49e603a33d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph-ci/commit/84d2e215969cde830b086d11544aeb3666614211",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph-ci/commit/84d2e215969cde830b086d11544aeb3666614211",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/commit/fe387e02b11df98357d8cdbfa3b1f1d5f2bb3f74",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases/tag/v15.2.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q2/17",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0692/default-remediation-status"
            }
        ]
    }
}