{
    "source": "BDSA",
    "name": "BDSA-2019-4867",
    "title": "EspoCRM Vulnerable to Stored Cross-Site Scripting (XSS) via 'fileName' and 'name' Parameters",
    "description": "EspoCRM has a stored cross-site scripting (XSS) vulnerability due to an absence of correct parameter input validation. A remote attacker could insert JavaScript code and steal a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "EspoCRM allows users to store documents in accounts via the following endpoint: `/api/v1/Document`. However, while processing the input received from such requests, the application does not correctly sanitize the input for the parameters `fileName` and `name`. An attacker could exploit this flaw by uploading a crafted file which contains malicious JavaScript code in its name. When users open the page which contains this crafted file, the malicious code will be executed in their browsers. Attackers can exploit this vulnerability to steal sensitive information like session tokens or cookies.",
    "publishedDate": "2020-12-01T14:48:15.666Z",
    "updatedDate": "2020-12-01T14:48:15.660Z",
    "disclosureDate": "2019-07-18T00:00:00.000Z",
    "exploitPublishDate": "2019-07-18T00:00:00.000Z",
    "solution": "Fixed in [**5.6.5**](https://github.com/espocrm/espocrm/releases/tag/5.6.5) by [this](https://github.com/espocrm/espocrm/commit/03773dd92924ec9c1fe7b30fb99ea1a6f8e90b76) commit.\n\nThe latest stable releases are available [here](https://www.espocrm.com/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "dayn1ne",
    "workaround": "",
    "vendorFixDate": "2019-07-18T00:00:00.000Z",
    "vendorNotifiedDate": "2019-07-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4867",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14349",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4867/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/commit/03773dd92924ec9c1fe7b30fb99ea1a6f8e90b76",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/issues/1358",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/issues/1358",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/releases/tag/5.6.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.espocrm.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4867/default-remediation-status"
            }
        ]
    }
}