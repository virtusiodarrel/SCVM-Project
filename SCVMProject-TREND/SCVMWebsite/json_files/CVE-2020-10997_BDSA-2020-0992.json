{
    "source": "BDSA",
    "name": "BDSA-2020-0992",
    "title": "Percona XtraBackup Vulnerable to Information Disclosure via Unsafe Command-Line Logging",
    "description": "Percona XtraBackup is vulnerable to information disclosure due to the unsafe logging of commands. A remote attacker could potentially decrypt a victim's cloud-based backup data by examining the files associated with that data.",
    "technicalDescription": "The function `make_argv()`, which is defined within `backup_mysql.cc`, is used by XtraBackup to parse arguments that have been passed over the command line and truncate any sensitive values, so that they are not logged. However, this function neglects to truncate the value of the `--transition-key` and `--transition_key` arguments. This means that this value could be written into the cloud backup data. \n\nA remote attacker who is able to access the encrypted backup data may be able to decrypt that data by investigating the backup files.\n\n**Note:** This issue results in an incomplete fix, which was reported as CVE-2020-10997. A further patch fixing the incomplete fix is detailed in BDSA-2022-1570.",
    "publishedDate": "2020-05-04T15:24:21.610Z",
    "updatedDate": "2022-06-07T12:04:22.970Z",
    "disclosureDate": "2020-03-26T00:00:00.000Z",
    "solution": "Fixed in:\n\n* [**2.4.25**](https://github.com/percona/percona-xtrabackup/releases/tag/percona-xtrabackup-2.4.25) by [this](https://github.com/percona/percona-xtrabackup/commit/7742f875bb289a874246fb4653b7cd9f14b588fe) commit.\n* [**8.0.28-20**](https://github.com/percona/percona-xtrabackup/releases/tag/percona-xtrabackup-8.0.28-20) by [this](https://github.com/percona/percona-xtrabackup/commit/7742f875bb289a874246fb4653b7cd9f14b588fe) commit.\n\nThe latest stable releases are available [here](https://github.com/percona/percona-xtrabackup/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-04-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0992",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-117"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10997",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0992/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/percona/percona-xtrabackup/commit/0b38ffc0f30",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/percona/percona-xtrabackup/commit/7742f875bb289a874246fb4653b7cd9f14b588fe",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/percona/percona-xtrabackup/releases/tag/percona-xtrabackup-2.4.25",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/percona/percona-xtrabackup/releases/tag/percona-xtrabackup-8.0.28-20",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/percona/percona-xtrabackup/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jira.percona.com/browse/PXB-2142",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0992/default-remediation-status"
            }
        ]
    }
}