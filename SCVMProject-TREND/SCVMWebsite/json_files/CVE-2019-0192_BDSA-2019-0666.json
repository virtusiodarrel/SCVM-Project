{
    "source": "BDSA",
    "name": "BDSA-2019-0666",
    "title": "Apache Solr Vulnerable to Remote Code Execution (RCE) via Unsafe Deserialization Using JMX Server Configuration",
    "description": "Apache Solr is vulnerable to remote code execution (RCE) due to exposure of an API allowing a malicious configuration of the Java Management Extensions (JMX) server. This could allow an attacker to supply malicious data which is executed on a target system via unsafe deserialization.",
    "technicalDescription": "Solr allows the JMX server to be configured using the Config API. With this API, `jmx.serviceUrl` can be set to point to a remote method invocation (RMI) server, which can be exploited to send arbitrary objects which will be unsafely deserialized by Solr. An attacker could exploit this by sending an HTTP POST request to the API pointing the JMX server to a malicious RMI server, which could allow them to execute code on the target system within the privileges of the Solr process.\n\nThe vendor addressed this issue by disallowing configuration of the JMX server via the API.",
    "publishedDate": "2019-03-08T16:33:00.096Z",
    "updatedDate": "2021-10-05T15:22:12.636Z",
    "disclosureDate": "2019-03-07T00:00:00.000Z",
    "exploitPublishDate": "2019-03-10T00:00:00.000Z",
    "solution": "Fixed in **[7.0](http://lucene.apache.org/solr/)**, and **[6.6.6](https://github.com/apache/lucene-solr/releases/tag/releases%2Flucene-solr%2F6.6.6)** by [this](https://github.com/apache/lucene-solr/commit/375038364a15d26bdeae080a6a168b99bfaf78c8) commit.",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Michael Stepankin",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, the vendor recommends one of the following options:\n* Disable the `ConfigAPI` by running Solr with the system property `disable.configEdit=true`.\n* Apply the `SOLR-13301.patch`, which is available [here](https://issues.apache.org/jira/browse/SOLR-13301), and re-compile Solr.",
    "vendorFixDate": "2017-09-19T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0666",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-0192",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0666/ranges"
            },
            {
                "rel": "reference",
                "href": "http://lucene.apache.org/solr/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://mail-archives.us.apache.org/mod_mbox/www-announce/201903.mbox/%3CCAECwjAV1buZwg%2BMcV9EAQ19MeAWztPVJYD4zGK8kQdADFYij1w%40mail.gmail.com%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/lucene-solr/commit/375038364a15d26bdeae080a6a168b99bfaf78c8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/lucene-solr/releases/tag/releases%2Flucene-solr%2F6.6.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mpgn/CVE-2019-0192",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/SOLR-13301",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/SOLR-13301",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0666/default-remediation-status"
            }
        ]
    }
}