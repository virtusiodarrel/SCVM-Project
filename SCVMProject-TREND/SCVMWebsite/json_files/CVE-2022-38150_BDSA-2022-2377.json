{
    "source": "BDSA",
    "name": "BDSA-2022-2377",
    "title": "Varnish Vulnerable to Denial-of-Service (DoS) via Improper 'Reason Phrase' Handling",
    "description": "Varnish is vulnerable to denial-of-service (DoS) due to the improper handling of \"Reason phrase\" values. An attacker could cause a vulnerable server to crash by causing that server to process a specially formatted Reason phrase that is embedded within the status line of a backend server's response. The attacker must be able to control the HTTP/1 responses that are sent from a Varnish server's backends in order to carry out such an attack.",
    "technicalDescription": "The vulnerability exists due to the improper handling of pseudo-headers within the `http_isfiltered()` function of file `bin/varnishd/cache/cache_http.c`.",
    "publishedDate": "2022-08-29T12:55:16.406Z",
    "updatedDate": "2022-08-29T12:55:16.395Z",
    "disclosureDate": "2022-08-09T00:00:00.000Z",
    "exploitPublishDate": "2022-08-01T00:00:00.000Z",
    "solution": "Fixed in version [**7.1.1**](https://github.com/varnishcache/varnish-cache/releases/tag/varnish-7.1.1) by [this](https://github.com/varnishcache/varnish-cache/commit/19544fdc6649bd294f25314d9f609b4979b1fe48) commit, and in version [**7.0.3**](https://github.com/varnishcache/varnish-cache/releases/tag/varnish-7.0.3) by [this](https://github.com/varnishcache/varnish-cache/commit/782f42fb14012d6464aead9ece5aa0a0727b1808) commit.\n\nThe latest stable releases can be found [here](https://varnish-cache.org/releases/index.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Anthony Schwartz, Guillaume Quintard",
    "workaround": "The vendor has stated [here](https://varnish-cache.org/security/VSV00009.html) that the following workaround can be implemented:\n\n> If upgrading Varnish is not possible, it is possible to mitigate the problem by adding the following snippet at the beginning of the vcl_backend_response VCL function:\n\n> `sub vcl_backend_response {\n      set beresp.status = beresp.status;\n}`\n\n> By setting the status code to itself as described above, the reason field will automatically be reset to the standard value for the given status code, or \u201cUnknown HTTP Status\u201d if no standard value exists for that code. This would overwrite any existing attack content in the reason field.",
    "vendorFixDate": "2022-08-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2377",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-229"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-38150",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2377/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/varnishcache/varnish-cache/commit/19544fdc6649bd294f25314d9f609b4979b1fe48",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/varnishcache/varnish-cache/commit/782f42fb14012d6464aead9ece5aa0a0727b1808",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/varnishcache/varnish-cache/commit/f4dffe593b04a33f07423db3f9dc69eb428b2e85",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/varnishcache/varnish-cache/issues/3830",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/varnishcache/varnish-cache/releases/tag/varnish-7.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/varnishcache/varnish-cache/releases/tag/varnish-7.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://varnish-cache.org/releases/index.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://varnish-cache.org/security/VSV00009.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://varnish-cache.org/security/VSV00009.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2377/default-remediation-status"
            }
        ]
    }
}