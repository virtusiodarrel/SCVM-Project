{
    "source": "BDSA",
    "name": "BDSA-2020-4148",
    "title": "Helm Vulnerable to Remote Code Execution (RCE) via Path Traversal during Plugin Installation",
    "description": "Helm is vulnerable to remote code execution (RCE) due to the unsafe extraction of archived files. An attacker could overwrite arbitrary files on a victim's system, and potentially execute arbitrary code, by tricking them into installing a malicious plugin over HTTP.",
    "technicalDescription": "The file `pkg/plugin/installer/http_installer.go` contains code that is used by Helm in order to extract files from plugin archives that have been downloaded over HTTP. Such plugins can specify file paths that are to be used during the installation process. These paths are insufficiently validated. An attacker can craft a malicious plugin that specifies paths to existing files on a victim's system. These files will be overwritten with attacker-controlled content whenever the plugin archive is installed. An attacker could potentially leverage this to achieve arbitrary code execution.\n\nThe vulnerability was fixed by adding code to `pkg/plugin/installer/http_installer.go` which validates the paths that are specified in plugin archives.",
    "publishedDate": "2021-02-05T15:24:25.266Z",
    "updatedDate": "2021-03-19T12:49:25.709Z",
    "disclosureDate": "2020-06-16T00:00:00.000Z",
    "exploitPublishDate": "2018-06-05T00:00:00.000Z",
    "solution": "Fixed in [**3.2.4**](https://github.com/helm/helm/releases/tag/v3.2.4) by [this](https://github.com/helm/helm/commit/0ad800ef43d3b826f31a5ad8dfbb4fe05d143688) commit.\n\nThe latest stable releases are available [here](https://github.com/helm/helm/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "snoopysecurity Sam Sanoop",
    "workaround": "",
    "vendorFixDate": "2020-06-15T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4148",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-4053",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4148/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/commit/0ad800ef43d3b826f31a5ad8dfbb4fe05d143688",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases/tag/v3.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/security/advisories/GHSA-qq3j-xp49-j73f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/research/zip-slip-vulnerability",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/research/zip-slip-vulnerability",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4148/default-remediation-status"
            }
        ]
    }
}