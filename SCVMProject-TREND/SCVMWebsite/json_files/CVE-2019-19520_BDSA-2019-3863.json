{
    "source": "BDSA",
    "name": "BDSA-2019-3863",
    "title": "OpenBSD Vulnerable to Privilege Escalation via Improper 'xlock' Permissions Check",
    "description": "OpenBSD is vulnerable to privilege escalation due to the improper management of permissions when performing certain operations relating to device drivers. A local attacker could gain the permissions of a particular group by opening a handle to their own driver.",
    "technicalDescription": "The `xlock` binary is installed within OpenBSD by default, and will set the effective group ID of the executing user to `auth`. The `dlopen()` function can be used to obtain a handle to a driver, and is implemented using code contained in the `driOpenDriver()` function, which is defined within `dri_common.c`. This function will attempt to search the path specified by the `LIBGL_DRIVERS_PATH` environmental variable in order to find the necessary driver, which will be a shared object file that will be loaded into the address space of the process that requires that driver. This function implements checks to ensure that users cannot elevate privileges by loading drivers contained within `LIBGL_DRIVERS_PATH` in association with `suid` binaries or libraries. However, this function fails to perform the same checks for `sgid` binaries. \n\nIf a local attacker sets `LIBGL_DRIVERS_PATH` to a directory that contains a driver that will set the user's real group ID to that which is set by the `sgid` binary, and then executes the `xlock` binary, the user will gain the privileges of that group.",
    "publishedDate": "2019-12-10T11:11:40.575Z",
    "updatedDate": "2019-12-10T11:11:40.509Z",
    "disclosureDate": "2019-12-04T00:00:00.000Z",
    "exploitPublishDate": "2019-12-04T00:00:00.000Z",
    "solution": "Fixed by [this](https://ftp.openbsd.org/pub/OpenBSD/patches/6.6/common/009_mesaxlock.patch.sig) patch which is not yet included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-12-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3863",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19520",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3863/ranges"
            },
            {
                "rel": "reference",
                "href": "https://ftp.openbsd.org/pub/OpenBSD/patches/6.6/common/009_mesaxlock.patch.sig",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/bugtraq/2019/Dec/8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/bugtraq/2019/Dec/8",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.openbsd.org/errata66.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3863/default-remediation-status"
            }
        ]
    }
}