{
    "source": "BDSA",
    "name": "BDSA-2022-1203",
    "title": "Vditor Vulnerable to Stored Cross-Site Scripting (XSS) via 'href' Attribute by escaping Double Quotes",
    "description": "Vditor has a cross-site scripting (XSS) vulnerability due to an absence of correct parameter input validation. A remote attacker could insert JavaScript code and steal a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "To exploit this vulnerability, an attacker can use the `/guide/markdown` endpoint to create a link. Because the application does not encode the double quotes for the `href` attribute, the attacker can break out of them by using the escape character `/`. After breaking out, the attacker can then insert malicious JavaScript code like `onmousemove=\"alert(document.domain)` into the application. This code will execute in a victim's browser when the victim hovers their mouse over the created link. Exploitation of this flaw can result in the theft of session tokens and cookies.\n\nThis issue has been fixed in the `src/js/lute/lute.min.js` file by implementing input sanitization measures for preventing XSS.",
    "publishedDate": "2022-04-29T13:20:06.498Z",
    "updatedDate": "2022-04-29T13:20:06.486Z",
    "disclosureDate": "2022-03-14T00:00:00.000Z",
    "exploitPublishDate": "2022-03-14T00:00:00.000Z",
    "solution": "Fixed in version [**3.8.11**](https://github.com/Vanessa219/vditor/releases/tag/v3.8.11) by [this](https://github.com/vanessa219/vditor/commit/219f8a9e272aba3cbc0096a82cac776532dbb9e5) commit.\n\nThe latest stable releases can be found [here](https://github.com/Vanessa219/vditor/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Pocas",
    "workaround": "",
    "vendorFixDate": "2022-01-22T00:00:00.000Z",
    "vendorNotifiedDate": "2022-01-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1203",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-0341",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1203/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Vanessa219/vditor/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Vanessa219/vditor/releases/tag/v3.8.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanessa219/vditor/commit/219f8a9e272aba3cbc0096a82cac776532dbb9e5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/fa546b57-bc15-4705-824e-9474b616f628/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/fa546b57-bc15-4705-824e-9474b616f628/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1203/default-remediation-status"
            }
        ]
    }
}