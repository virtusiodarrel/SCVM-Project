{
    "source": "BDSA",
    "name": "BDSA-2019-1398",
    "title": "GitLab CE Vulnerable to Information Disclosure via Insufficiently Protected Credentials in 'Quick Actions' JSON Serialization",
    "description": "An insufficiently protected credentials vulnerability has been discovered in GitLab CE. An attacker could exploit this vulnerability by accessing a JSON response to obtain sensitive information which could aid in the execution of other malicious attacks.",
    "technicalDescription": "A weakness has been discovered in GitLab CE which can lead to information disclosure. The quick actions implemented by the application does not validate user access rights before processing which can lead to project authentication tokens being returned in the response. It is possible to reference other projects through the `/move` command that will generate a request to the `/:namespace/:project/notes` functionality. If this command is executed it will generate a JSON response that contains a serialized project model displaying `runner_token` values in plain text. \n\nThis functionality is located in the file `app/controllers/concerns/notes_actions.rb`.",
    "publishedDate": "2019-05-03T15:27:47.250Z",
    "updatedDate": "2019-05-03T15:27:47.236Z",
    "disclosureDate": "2019-03-20T00:00:00.000Z",
    "exploitPublishDate": "2019-03-21T00:00:00.000Z",
    "solution": "Fixed in GitLab CE [**11.8.3**](https://gitlab.com/gitlab-org/gitlab-ce/tags/v11.8.3)  by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/be48d80cbca27af061eb957ff6835202a0a6d982) commit. \nFixed in GitLab CE [**11.7.7**](https://gitlab.com/gitlab-org/gitlab-ce/tags/v11.7.7) by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/794e4471f3c64894e5489ffafb4e22b45be880ad) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jobert Abma",
    "workaround": "",
    "vendorFixDate": "2019-03-19T00:00:00.000Z",
    "vendorNotifiedDate": "2019-03-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1398",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-312"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-522"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9866",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1398/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/2019/03/20/critical-security-release-gitlab-11-dot-8-dot-3-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/commit/794e4471f3c64894e5489ffafb4e22b45be880ad",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/commit/be48d80cbca27af061eb957ff6835202a0a6d982",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/issues/59003",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/tags/v11.7.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/tags/v11.8.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/509924",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/509924",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1398/default-remediation-status"
            }
        ]
    }
}