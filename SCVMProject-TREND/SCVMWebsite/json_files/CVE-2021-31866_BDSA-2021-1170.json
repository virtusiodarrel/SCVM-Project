{
    "source": "BDSA",
    "name": "BDSA-2021-1170",
    "title": "Redmine Vulnerable to Information Disclosure via  Side Channel Attacks on String Comparison Operations",
    "description": "Redmine is vulnerable to side channel attacks based on timing differences in string comparison operations in different files. This could allow an attacker to expose sensitive information like authentication keys by observing the timing difference.",
    "technicalDescription": "This vulnerability primarily exists in the following files: `app/controllers/mail_handler_controller.rb` and `app/controllers/sys_controller.rb`. They use the `==` operator for comparing the values of API keys with the ones received from the user input. However, this allows an attacker to observe the time difference for different string comparisons and subsequently deduce the correct keys based on that difference. This issue was addressed by introducing a new method `secure_compare()` for safely comparing strings with variable lengths.",
    "publishedDate": "2021-04-28T15:04:22.849Z",
    "updatedDate": "2021-04-28T15:04:22.843Z",
    "disclosureDate": "2021-04-26T00:00:00.000Z",
    "solution": "Fixed in [**4.0.9**](https://github.com/redmine/redmine/releases/tag/4.0.9) by [this](https://github.com/redmine/redmine/commit/b4d5dd7ad71bfbdfc37d4a79594203078867dc66) commit.\n\nFixed in [**4.1.3**](https://github.com/redmine/redmine/releases/tag/4.1.3) by [this](https://github.com/redmine/redmine/commit/23e09ef64e26d6f63dcdcd624827440d9ad05f93) commit.\n\nFixed in [**4.2.0**](https://github.com/redmine/redmine/releases/tag/4.2.0) by [this](https://github.com/redmine/redmine/commit/770a31a78ec1c48f9bee7d61b61e1f0d00a60478) commit.\n\nThe latest stable releases are available [here](https://github.com/redmine/redmine/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-03-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1170",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-31866",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1170/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redmine/redmine/commit/23e09ef64e26d6f63dcdcd624827440d9ad05f93",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redmine/redmine/commit/770a31a78ec1c48f9bee7d61b61e1f0d00a60478",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redmine/redmine/commit/b4d5dd7ad71bfbdfc37d4a79594203078867dc66",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redmine/redmine/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redmine/redmine/releases/tag/4.0.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redmine/redmine/releases/tag/4.1.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redmine/redmine/releases/tag/4.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.redmine.org/projects/redmine/wiki/Security_Advisories",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1170/default-remediation-status"
            }
        ]
    }
}