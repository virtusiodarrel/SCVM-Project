{
    "source": "BDSA",
    "name": "BDSA-2020-3200",
    "title": "Nextcloud Vulnerable to File Integrity Attacks via Insecure SHA256-HMAC Message Authentication Codes",
    "description": "It was found that Nextcloud improperly verifies file integrity when parts of the file are replaced with their earlier version. An attacker that has access to the file storage (but not the file encryption secrets) could modify the files this way and they would still pass Nextcloud's integrity checks.",
    "technicalDescription": "Nextcloud Server creates `SHA256-HMAC` based message authentication codes for each individual 6072 byte-sized block of data. Each block's version and position within the file are concatenated and included in the hash calculations in order to prevent blocks from being moved. However, the concatenation is ambiguous since, for example, version `1` and position `10` (which adds up to `110`) may be taken as version `11` and position `0` (which also adds up to `110`). This allows for individual blocks to be replaced with their earlier versions and have them still pass Nextcloud's integrity checks.\n\nThis vulnerability was fixed by adding a `_` character in between the version and position strings.",
    "publishedDate": "2020-11-06T12:28:02.402Z",
    "updatedDate": "2020-11-06T12:28:02.392Z",
    "disclosureDate": "2020-11-05T00:00:00.000Z",
    "exploitPublishDate": "2020-11-05T00:00:00.000Z",
    "solution": "Fixed in:\n* [**17.0.9-rc1**](https://github.com/nextcloud/server/releases/tag/v17.0.9RC1) by [this](https://github.com/nextcloud/server/commit/9f51097243bfaf97ac618307dc46655886098f40) commit\n* [**18.0.8-rc1**](https://github.com/nextcloud/server/releases/tag/v18.0.8RC1) by [this](https://github.com/nextcloud/server/commit/7ffd98d91aea99eba17c6469090c728d7371acb5) commit\n* [**19.0.2-rc1**](https://github.com/nextcloud/server/releases/tag/v19.0.2RC1) by [this](https://github.com/nextcloud/server/commit/8ffc3c0de6dedb3957c9031fe803192c63344d6e) commit\n* [**20.0.0-rc1**](https://github.com/nextcloud/server/releases/tag/v20.0.0RC1) by [this](https://github.com/nextcloud/server/commit/9975b80d41f32e3210dfb50dcf41d6cb72fd9121) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "yahe (HackerOne)",
    "workaround": "",
    "vendorFixDate": "2020-08-12T00:00:00.000Z",
    "vendorNotifiedDate": "2019-07-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3200",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-694"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8133",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3200/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/7ffd98d91aea99eba17c6469090c728d7371acb5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/8ffc3c0de6dedb3957c9031fe803192c63344d6e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/9975b80d41f32e3210dfb50dcf41d6cb72fd9121",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/9f51097243bfaf97ac618307dc46655886098f40",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v17.0.9RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v18.0.8RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v19.0.2RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v20.0.0RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/661051",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/661051",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3200/default-remediation-status"
            }
        ]
    }
}