{
    "source": "BDSA",
    "name": "BDSA-2019-3567",
    "title": "Apache Solr Vulnerable to Remote Code Execution (RCE) via Insecure Settings in 'JMX Monitoring'",
    "description": "It was discovered that Apache Solr contains an insecure setting on its default configuration options for JMX monitoring, an attacker with network access could exploit this to possibly execute code on the Solr server.",
    "technicalDescription": "The vulnerability occurs due to the default configuration of the `ENABLE_REMOTE_JMX_OPTS` setting being set to enabled in the `solr.in.sh` file. \n\nThis exposes JMX monitoring on the `RMI_PORT` without authentication. This could allow any user with network access to Solr nodes access to the JMX monitoring. A malicious user could exploit this to execute remote code on the Solr Server.",
    "publishedDate": "2019-11-20T11:16:12.328Z",
    "updatedDate": "2021-10-05T15:09:29.197Z",
    "disclosureDate": "2019-11-18T00:00:00.000Z",
    "exploitPublishDate": "2019-11-19T00:00:00.000Z",
    "solution": "Fixed in version [**8.3.0**](https://github.com/apache/lucene-solr/releases/tag/releases%2Flucene-solr%2F8.3.0) by [this](https://github.com/apache/lucene-solr/commit/d468d71c030dba77fb7e6bed295e5766248a5944) commit.",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "Ensure the effective `solr.in.sh` file has `ENABLE_REMOTE_JMX_OPTS` set to `false`",
    "vendorFixDate": "2019-08-12T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3567",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12409",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3567/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/lucene-solr/commit/d468d71c030dba77fb7e6bed295e5766248a5944",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/lucene-solr/releases/tag/releases%2Flucene-solr%2F8.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jas502n/CVE-2019-12409/",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/6640c7e370fce2b74e466a605a46244ccc40666ad9e3064a4e04a85d@%3Csolr-user.lucene.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/6640c7e370fce2b74e466a605a46244ccc40666ad9e3064a4e04a85d@%3Csolr-user.lucene.apache.org%3E",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3567/default-remediation-status"
            }
        ]
    }
}