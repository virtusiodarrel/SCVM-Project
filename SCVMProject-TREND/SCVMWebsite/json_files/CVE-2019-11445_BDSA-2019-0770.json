{
    "source": "BDSA",
    "name": "BDSA-2019-0770",
    "title": "OpenKM Vulnerable to Remote Code Execution (RCE) via Unrestricted File Upload in Admin 'Export' Field",
    "description": "An unrestricted file upload vulnerability has been discovered in OpenKM. An attacker could exploit this vulnerability by uploading a malicious JSP file which can be moved through the system file structure via specific admin functionality, to execute arbitrary code against the target system.",
    "technicalDescription": "Administrative users of OpenKM can upload files to the `/okm:root` directory. This file can then be exported to a specified file system location. The code that enables this functionality is found within the script `repository_export.jsp`. The file system location that is specified by the user is stored within the variable `fsPath`. The value of `fsPath` is then validated to ensure that it is not null, or an empty string. No further validation is performed. An attacker could therefore exploit this functionality to export a script containing malicious code to a directory underneath the web root. The attacker could browse to the malicious script in order to execute its code on the server. Thus this vulnerability will allow an attacker to execute arbitrary code with root privileges.",
    "publishedDate": "2019-03-20T12:22:27.542Z",
    "updatedDate": "2022-06-21T14:40:20.405Z",
    "disclosureDate": "2019-03-09T00:00:00.000Z",
    "exploitPublishDate": "2019-03-09T00:00:00.000Z",
    "solution": "Fixed in version [**6.3.8**](https://github.com/openkm/document-management-system/releases/tag/v6.3.8) by [this](https://github.com/openkm/document-management-system/commit/5a841d4edd421da28c8aa145d5b274ac3ea29ef4) commit.\n\nThe latest stable releases can be found [here](https://github.com/openkm/document-management-system/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.6,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.7,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "\u00d6zkan Mustafa Akku\u015f",
    "workaround": "",
    "vendorFixDate": "2019-04-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0770",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11445",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0770/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openkm/document-management-system/commit/5a841d4edd421da28c8aa145d5b274ac3ea29ef4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openkm/document-management-system/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openkm/document-management-system/releases/tag/v6.3.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46526",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46526",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0770/default-remediation-status"
            }
        ]
    }
}