{
    "source": "BDSA",
    "name": "BDSA-2020-2239",
    "title": "Squid Vulnerable to HTTP(S) Request Splitting via Improper Data Validation",
    "description": "Squid is vulnerable to HTTP(S) request splitting attacks due to improper data validation of HTTP and HTTPS traffic. A remote authenticated attacker could exploit this by submitting maliciously crafted HTTP messages to a vulnerable server, which can result in cache poisoning.",
    "technicalDescription": "This vulnerability exists due to improper data validation and can allow an attacker to manipulate the content in a request to contain other malicious requests. Exploiting this, an attacker could poison the web browser cache and any downstream caches. The poisoned cache will be treated as valid.\n\nThis was addressed by improving Transfer-Encoding handling within `HttpHeader::parse` function in the file `src/HttpHeader.cc`.\n\n**Note:** See advice provided by the vendor on whether you are vulnerable or not below.\n\nAll Squid with `relaxed_header_parser` configured \"off\" are not vulnerable.\n\nAll Squid-**3.x** up to and including **3.5.28**:\n* with `relaxed_header_parser` configured to \"on\" or \"warn\" are vulnerable.\n* without `relaxed_header_parser` configured are vulnerable.\n\nAll Squid-**4.x** up to and including **4.12**:\n* with `relaxed_header_parser` configured to \"on\" or \"warn\" are vulnerable.\n* without `relaxed_header_parser` configured are vulnerable.\n\nAll Squid-**5.x** up to and including **5.0.3**: \n* with `relaxed_header_parser` configured to \"on\" or \"warn\" are vulnerable.\n* without `relaxed_header_parser` configured are vulnerable.",
    "publishedDate": "2020-08-31T14:29:11.524Z",
    "updatedDate": "2020-08-31T14:29:11.518Z",
    "disclosureDate": "2020-08-23T00:00:00.000Z",
    "solution": "Fixed in [**4.13**](http://www.squid-cache.org/Versions/) by [this](https://github.com/squid-cache/squid/commit/fd68382860633aca92065e6c343cfd1b12b126e7) commit and [**5.0.4**](http://www.squid-cache.org/Versions/) by [this](https://github.com/squid-cache/squid/commit/f95f1031d3f4194bca2e8e0a1a8a9b64045d06f5) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 3.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "R\u00e9gis Leroy",
    "workaround": "As a workaround, the vendor suggests to disable the relaxed HTTP parser in `squid.conf`:\n\n```\nrelaxed_header_parser off\n```",
    "vendorFixDate": "2020-08-11T00:00:00.000Z",
    "vendorNotifiedDate": "2019-07-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2239",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-113"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15811",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2239/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/f95f1031d3f4194bca2e8e0a1a8a9b64045d06f5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/fd68382860633aca92065e6c343cfd1b12b126e7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-c7p8-xqhm-49wv",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-c7p8-xqhm-49wv",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2239/default-remediation-status"
            }
        ]
    }
}