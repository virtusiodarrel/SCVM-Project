{
    "source": "BDSA",
    "name": "BDSA-2021-4541",
    "title": "Pluck Vulnerable to Remote Code Execution (RCE) via Directory Traversal due to Insufficient Validation in 'unzip.class.php' FIle",
    "description": "Pluck contains a Zip Slip vulnerability i.e. directory traversal conducted using malicious zip file uploads. This could allow an attacker to upload malicious zip files and cause remote code execution (RCE).",
    "technicalDescription": "This vulnerability exists because the `data/inc/lib/unzip.class.php` file does not properly validate the uploaded zip files before they are stored on the server. To exploit this vulnerability, an attacker could first create a malicious zip file using a tool like `evilarc`. Then, the attacker could access the `admin.php?action=themeinstall ` endpoint and upload the malicious zip file. Because of the zip slip vulnerability, this file could be stored in an arbitrary directory on the server. As specified in the PoC, an attacker could create a file `shell.php` and have it stored 2 levels up from the actual storage directory by leveraging the zip slip vulnerability. Then, the attacker can access this file directly using `<pluck_domain>/shell.php` URL. This could lead to execution of arbitrary code with the privileges of the user running the application.\n\nThis issue has been mitigated in `data/inc/lib/unzip.class.php` file by implementing appropriate validation mechanisms for zip file uploads.",
    "publishedDate": "2022-08-12T14:58:57.721Z",
    "updatedDate": "2022-08-12T14:58:57.711Z",
    "disclosureDate": "2021-04-21T00:00:00.000Z",
    "exploitPublishDate": "2021-04-21T00:00:00.000Z",
    "solution": "Fixed in version [**4.7.16-dev2**](https://github.com/pluck-cms/pluck/releases/tag/4.7.16-dev2) by [this](https://github.com/pluck-cms/pluck/commit/89c40c744656b57c204c93eebc50b68b27bcfeae) commit.\n\nThe latest stable releases can be found [here](https://github.com/pluck-cms/pluck/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "naiagoesawoo",
    "workaround": "",
    "vendorFixDate": "2021-04-26T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-21T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4541",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-31746",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4541/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluck-cms/pluck/commit/89c40c744656b57c204c93eebc50b68b27bcfeae",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluck-cms/pluck/issues/100",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluck-cms/pluck/issues/100",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluck-cms/pluck/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluck-cms/pluck/releases/tag/4.7.16-dev2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4541/default-remediation-status"
            }
        ]
    }
}