{
    "source": "BDSA",
    "name": "BDSA-2020-1542",
    "title": "Openshift Origin Vulnerable to Information Disclosure via Failed OAuthTokens Protection",
    "description": "The OpenShift API Server leaks OAuthTokens in the logs when an API Server panic occurs. Although OAuthTokens can be used to log into the API Server, an attacker must first be able to cause an API Server to panic and have the permissions to read the logs.",
    "technicalDescription": "The OAuthTokens are unintentionally logged in the function `WithPanicRecovery` in file `vendor/k8s.io/kubernetes/staging/src/k8s.io/apiserver/pkg/server/filters/wrap.go`.\n\n**Note:** By default, OAuthTokens are only valid for one day.",
    "publishedDate": "2020-06-26T15:19:36.602Z",
    "updatedDate": "2021-07-29T09:38:13.195Z",
    "disclosureDate": "2020-05-26T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/openshift/origin/commit/9aa216204d217e717629e8721c71c39c870af451) commit in Openshift Origin and [this](https://github.com/openshift/oauth-server/commit/3fe013cde6b0a61bc2326c66255fb126d216ef0c) commit in Openshift OAuth Server. The fixes are not yet included in any release.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-08-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1542",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-533"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10752",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1542/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1839942",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openshift/enhancements/pull/323",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openshift/oauth-server/commit/3fe013cde6b0a61bc2326c66255fb126d216ef0c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openshift/origin/commit/9aa216204d217e717629e8721c71c39c870af451",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1542/default-remediation-status"
            }
        ]
    }
}