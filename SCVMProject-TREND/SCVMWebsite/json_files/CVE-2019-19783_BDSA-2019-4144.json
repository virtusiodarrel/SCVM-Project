{
    "source": "BDSA",
    "name": "BDSA-2019-4144",
    "title": "Cyrus IMAP Vulnerable to Authorization Bypass via Folder Mishandling in 'autosieve_createfolder()' Function",
    "description": "Cyrus IMAP is vulnerable to authorization bypass due to flaws within its mailbox creation process. A remote attacker with a valid user account could bypass the application's access control policies and create a mailbox they couldn't create otherwise by uploading a crafted sieve script.",
    "technicalDescription": "The function `autosieve_createfolder()`, which is defined within `lmtp_sieve.c`, can be called by the `sieve_fileinto()` function to create a mailbox if it is missing (as indicated by the `IMAP_MAILBOX_NONEXISTENT` flag). The function `mboxlist_createmailbox()` is called by `autosieve_createfolder()` in order to build the new mailbox. One of the parameters of the `mboxlist_createmailbox()` function is `isadmin`, which is used to decide if the mailbox creation process should be carried out with administrative privileges. The function `autosieve_createfolder()` passes a value of `1` to this parameter, meaning that the mailbox will always be created with administrative privileges, regardless of the actual privileges of the user. \n\nSeveral configuration settings are required in order for this execution path to be taken. First, the `anysievefolder` option must be enabled (it is disabled by default). The `fileinto` directive must also contain the `.create` argument, and the `sieve_extensions` configuration option must also specify that the `mailbox` extension is enabled. This is enabled by default.\n\nIf these conditions are met, a remote authenticated attacker with the ability to upload a custom sieve script to their account could create any valid mailbox on a vulnerable server, regardless of whether or not they are permitted to do so under ACL restrictions.",
    "publishedDate": "2020-01-08T14:10:31.529Z",
    "updatedDate": "2020-07-15T09:39:25.316Z",
    "disclosureDate": "2019-12-16T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.1.9**](https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-3.1.9) by [this](https://github.com/cyrusimap/cyrus-imapd/commit/673ebd96e2efbb8895d08648983377262f35b3f7) commit.\n* [**3.0.13**](https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-3.0.13) by [this](https://github.com/cyrusimap/cyrus-imapd/commit/7080d0a0ac09b293e9e2f46f505584609b902cde) commit.\n* [**2.5.15**](https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-2.5.15) by [this](https://github.com/cyrusimap/cyrus-imapd/commit/b1c348078884667b006e427230ff9f5249420f3a) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-12-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4144",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-250"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19783",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4144/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/commit/673ebd96e2efbb8895d08648983377262f35b3f7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/commit/7080d0a0ac09b293e9e2f46f505584609b902cde",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/commit/b1c348078884667b006e427230ff9f5249420f3a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-2.5.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-3.0.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-3.1.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.cyrusimap.org/imap/download/release-notes/3.0/x/3.0.13.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4144/default-remediation-status"
            }
        ]
    }
}