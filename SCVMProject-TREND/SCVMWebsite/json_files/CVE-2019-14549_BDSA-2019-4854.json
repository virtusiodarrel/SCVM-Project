{
    "source": "BDSA",
    "name": "BDSA-2019-4854",
    "title": "EspoCRM Vulnerable to Stored Cross-Site Scripting (XSS) via '#Admin/entityManager'",
    "description": "EspoCRM is vulnerable to stored cross-site scripting (XSS) via the `#Admin/entityManager`endpoint. An authenticated attacker could exploit this to execute malicious scripts in the context of a victim's browser, allowing for the theft of session tokens, cookies, and other sensitive information.",
    "technicalDescription": "This issue occurs due to a lack of filtering and validation on the `breadcrumbs` and `side tab title` components. An attacker with admin access could add an entity label containing a malicious payload. This payload will then be fired when a victim user visits the affected tab and it will capture their cookies. These cookies can then be used by the attacker to login to and potentially takeover the victim user account. It was mitigated by the addition of XSS protection via validation and filtering.",
    "publishedDate": "2020-11-27T14:47:30.836Z",
    "updatedDate": "2020-11-27T14:47:30.830Z",
    "disclosureDate": "2019-08-03T00:00:00.000Z",
    "exploitPublishDate": "2019-08-03T00:00:00.000Z",
    "solution": "Fixed in [**5.6.9**](https://github.com/espocrm/espocrm/releases/tag/5.6.9) by [this](https://github.com/espocrm/espocrm/commit/ffd3f762ce4a8de3b8962f33513e073c55d943b5) commit.\n\nThe latest stable releases are available [here](https://github.com/espocrm/espocrm/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Gaurav Narwani",
    "workaround": "",
    "vendorFixDate": "2019-07-30T00:00:00.000Z",
    "vendorNotifiedDate": "2019-07-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4854",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14549",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4854/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gauravnarwani.com/publications/cve-2019-14549/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gauravnarwani.com/publications/cve-2019-14549/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/commit/ffd3f762ce4a8de3b8962f33513e073c55d943b5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/issues/1369",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/releases/tag/5.6.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4854/default-remediation-status"
            }
        ]
    }
}