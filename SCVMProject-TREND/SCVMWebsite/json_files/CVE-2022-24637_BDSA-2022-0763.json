{
    "source": "BDSA",
    "name": "BDSA-2022-0763",
    "title": "Open Web Analytics Vulnerable to Information Disclosure and Privilege Escalation via Improper Escaping",
    "description": "Open Web Analytics contains a privilege escalation and information disclosure vulnerability due to improper escaping of single quotation marks in PHP file requests. An attacker could exploit this vulnerability by replacing double quotation marks with single quotation marks, which stop escape sequences from being evaluated. This may allow for retrieval of base64-encoded serialized data, which includes information such as the MySQL user's username, hashed password, temporary passkey and API key. The attacker could utilize the temporary passkey to reset the user's password and obtain full administrator privileges.",
    "technicalDescription": "This vulnerability stems from a single quote/double quote confusion flaw in the `putItemToCacheStore()` method in  `modules/fileCache/classes/fileCache.php` file. This method is used to write serialized data (enclosed by `cache_file_header` and `cache_file_footer`) to cache files. Because of the use of single quotes in the following lines of code,\n```\nvar $cache_file_header = '<?php\\n/*';\nvar $cache_file_footer = '*/\\n?>';\n```\nescape sequences will not be evaluated correctly.  This will result in the `<?php` tag becoming invalid. Thus, cache files created in this way will not be PHP files. If anyone tries to see their contents using commands like `cat`, sensitive information will be disclosed in plaintext. An attacker can trigger an admin login that will result in the creation of a cache file. Using the admin privileges, the attacker can trigger a PHP file write by updating the application settings. Using a crafted POST request, the attacker can update settings belonging to the `owa_error` class.",
    "publishedDate": "2022-03-21T12:37:32.793Z",
    "updatedDate": "2022-03-21T15:24:32.199Z",
    "disclosureDate": "2022-03-18T00:00:00.000Z",
    "exploitPublishDate": "2022-03-18T00:00:00.000Z",
    "solution": "Fixed in version [**1.7.4**](https://github.com/Open-Web-Analytics/Open-Web-Analytics/releases/tag/1.7.4) by [this](https://github.com/Open-Web-Analytics/Open-Web-Analytics/commit/c1c823445df7dc96ee940e340805a7ba7a538482) commit.\n\nThe latest stable releases can be found [here](https://github.com/Open-Web-Analytics/Open-Web-Analytics/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Scryh",
    "workaround": "",
    "vendorFixDate": "2022-02-02T00:00:00.000Z",
    "vendorNotifiedDate": "2022-02-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0763",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-153"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24637",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0763/ranges"
            },
            {
                "rel": "reference",
                "href": "https://devel0pment.de/?p=2494",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://devel0pment.de/?p=2494",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Open-Web-Analytics/Open-Web-Analytics/commit/c1c823445df7dc96ee940e340805a7ba7a538482",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Open-Web-Analytics/Open-Web-Analytics/releases/tag/1.7.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Open-Web-Analytics/Open-Web-Analytics/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0763/default-remediation-status"
            }
        ]
    }
}