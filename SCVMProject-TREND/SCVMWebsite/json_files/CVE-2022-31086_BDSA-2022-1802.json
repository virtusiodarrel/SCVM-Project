{
    "source": "BDSA",
    "name": "BDSA-2022-1802",
    "title": "LDAP Account Manager (LAM) Vulnerable to Remote Code Execution (RCE) via Malicious PHP File Upload",
    "description": "LDAP Account Manager (LAM) is vulnerable to remote code execution (RCE) due to improper handling of regular expressions allowing upload of arbitrary PHP scripts. An attacker could exploit this vulnerability on systems where the `/config/templates/pdf/` directory is accessible for remote users.",
    "technicalDescription": "The issue exists within the file `lam/lib/pdfstruct.inc`. Improperly defined regular expressions to validate files uploaded to `/config/templates/pdf/` can allow malicious PHP scripts to be uploaded to this directory and subsequently executed.",
    "publishedDate": "2022-06-30T14:55:31.419Z",
    "updatedDate": "2022-09-22T08:37:11.152Z",
    "disclosureDate": "2022-06-27T00:00:00.000Z",
    "solution": "Fixed in version [**8.0**](https://github.com/LDAPAccountManager/lam/releases/tag/lam_8_0) by [this](https://github.com/LDAPAccountManager/lam/commit/f1d5d04952f39a1b4ea203d3964fa88e1429dfd4) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.6,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.7,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Arseniy Sharoglazov and Andrey Medov",
    "workaround": "",
    "vendorFixDate": "2022-06-27T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 5.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1802",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-185"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31086",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1802/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LDAPAccountManager/lam/commit/f1d5d04952f39a1b4ea203d3964fa88e1429dfd4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LDAPAccountManager/lam/releases/tag/lam_8_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LDAPAccountManager/lam/security/advisories/GHSA-q9pc-x84w-982x",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1802/default-remediation-status"
            }
        ]
    }
}