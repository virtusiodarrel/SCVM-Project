{
    "source": "BDSA",
    "name": "BDSA-2020-1020",
    "title": "Keycloak Vulnerable to Unauthorized Modification of Access Controls via 'Remove Device' Feature",
    "description": "Keycloak contains a vulnerability that allows an authenticated attacker to modify access controls for other users.  The issue is in the 'Remove Device' feature, where an attacker can remove other users registered multi factor authentication (MFA) devices.",
    "technicalDescription": "The vulnerability is due to a lack of validation of the given `userID` value to multiple functions in `model/jpa/src/main/java/org/keycloak/models/jpa/JpaUserCredentialStore.java`, `model/jpa/src/main/java/org/keycloak/storage/jpa/JpaUserFederatedStorageProvider.java`,  `services/src/main/java/org/keycloak/services/resources/account/AccountCredentialResource.java`, and `services/src/main/java/org/keycloak/services/resources/admin/UserResource.java`.  An authenticated attacker can modify requests to contain arbitrary `userID` values,  if the modified value exists, the action will be performed on that account.  This includes modifying access controls to accounts such as the \"Remove Device\" feature for MFA authentication.",
    "publishedDate": "2020-05-07T13:35:51.228Z",
    "updatedDate": "2021-08-18T14:44:52.179Z",
    "disclosureDate": "2020-03-18T00:00:00.000Z",
    "solution": "Fixed in [**9.0.2**](https://github.com/keycloak/keycloak/releases/tag/9.0.2) by [this](https://github.com/keycloak/keycloak/commit/5ddd605ee96b8551c7eb00b609a0b97939925b77) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.0,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Oliver P",
    "workaround": "",
    "vendorFixDate": "2020-03-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1020",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10686",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1020/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-10686",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/5ddd605ee96b8551c7eb00b609a0b97939925b77",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases/tag/9.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.jboss.org/browse/KEYCLOAK-13259",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1020/default-remediation-status"
            }
        ]
    }
}