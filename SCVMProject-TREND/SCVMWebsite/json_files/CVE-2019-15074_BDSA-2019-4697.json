{
    "source": "BDSA",
    "name": "BDSA-2019-4697",
    "title": "MantisBT Vulnerable to Stored Cross-Site Scripting (XSS) via Timeline Feature",
    "description": "MantisBT contains a vulnerability to stored cross-site scripting (XSS) due to insufficient of validation of user controlled input. An attacker could execute arbitrary code in the victims browser which could result in theft of cookie based session information or credentials.",
    "technicalDescription": "This vulnerability exists within the `html()` function within the `core/classes/IssueAttachmentTimelineEvent.class.php` file. Attacks can exploit this when `CSP` settings are permitted when uploading. This could allow the attacker to obtain sensitive information, such as browser cookies.\nThe vendor addressed by sanitizing the filename before display.",
    "publishedDate": "2020-09-25T13:12:26.618Z",
    "updatedDate": "2020-09-25T13:12:26.612Z",
    "disclosureDate": "2019-08-14T00:00:00.000Z",
    "solution": "Fixed in [**2.21.2**](https://github.com/mantisbt/mantisbt/releases/tag/release-2.21.2) by [this](https://github.com/mantisbt/mantisbt/commit/9cee1971c498bbe0a72bca1c773fae50171d8c27) commit.\n\nThe latest stable releases are also available [here](https://github.com/mantisbt/mantisbt/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Kamran Saifullah",
    "workaround": "",
    "vendorFixDate": "2019-08-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4697",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15074",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4697/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mantisbt/mantisbt/commit/9cee1971c498bbe0a72bca1c773fae50171d8c27",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mantisbt/mantisbt/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mantisbt/mantisbt/releases/tag/release-2.21.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mantisbt.org/bugs/view.php?id=25995",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4697/default-remediation-status"
            }
        ]
    }
}