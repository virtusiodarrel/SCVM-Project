{
    "source": "BDSA",
    "name": "BDSA-2021-0920",
    "title": "Gradle Vulnerable to Information Disclosure via 'TextResourceFactory' Component",
    "description": "Gradle contains an information disclosure vulnerability due to the downloading of files to the system temporary directory. A local attacker can take advantage of this in order to gain access to sensitive data not intended for them.\n\n**Note:** The vendor has stated that if you do not use the `TextResourceFactory` API, you are not vulnerable.",
    "technicalDescription": "This vulnerability exists when remote files are accessed through `TextResourceFactory`. Any files accessed this way will be downloaded into the system temporary directory with open permissions. This will allow a local attacker to gain access to sensitive data from files stored in the temporary directory.",
    "publishedDate": "2021-04-13T09:43:18.851Z",
    "updatedDate": "2021-11-22T09:48:52.031Z",
    "disclosureDate": "2021-04-10T00:00:00.000Z",
    "solution": "Fixed in [**7.0.0-M3**](https://github.com/gradle/gradle/releases/tag/v7.0.0-M3) by [this](https://github.com/gradle/gradle/commit/8c2f6b7db50ab071a289fb5c4cbb9b2125609105) commit. \n\nThe latest stable releases are available [here](https://gradle.org/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has provided the following [workaround](https://github.com/gradle/gradle/security/advisories/GHSA-fp8h-qmr5-j4c8):\n\n\"Set a more restrictive `umask` that removes read access to other users. When files are created in the system temporary directory, they will not be accessible to other users.\n\nIf you are unable to change your system's `umask`, you can move the Java temporary directory by setting the System Property `java.io.tmpdir`. The new path needs to limit permissions to the build user only.\"",
    "vendorFixDate": "2021-03-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0920",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-377"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29429",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0920/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gradle/gradle/commit/8c2f6b7db50ab071a289fb5c4cbb9b2125609105",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gradle/gradle/releases/tag/v7.0.0-M3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gradle/gradle/security/advisories/GHSA-fp8h-qmr5-j4c8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gradle/gradle/security/advisories/GHSA-fp8h-qmr5-j4c8",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://gradle.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0920/default-remediation-status"
            }
        ]
    }
}