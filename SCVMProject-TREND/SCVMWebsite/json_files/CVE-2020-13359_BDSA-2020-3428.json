{
    "source": "BDSA",
    "name": "BDSA-2020-3428",
    "title": "GitLab Vulnerable to Unauthorized Terraform State Modification via Record Exposure in Terraform API",
    "description": "GitLab is vulnerable to the modification of its Terraform configuration due to the exposure of sensitive data within the Terraform API. A remote attacker with project maintainer privileges could overwrite the state of the Terraform configuration by abusing the data that is returned whenever certain operations occur.",
    "technicalDescription": "GitLab utilizes Terraform state information in order to manage project configuration information and metadata. The API that is used in order to manage the Terraform implementation is unsafe. Scripts such as `api/terraform/state.rb` and `requests/api/terraform/state_spec.rb ` do not sanitize their output correctly, which can lead to the exposure of resource identifiers which can be used to access and modify the current Terraform state. An attacker requires project maintainer privileges in order to exploit this vulnerability.",
    "publishedDate": "2020-11-19T16:32:35.875Z",
    "updatedDate": "2020-11-19T16:32:35.869Z",
    "disclosureDate": "2020-11-17T00:00:00.000Z",
    "solution": "Fixed in: \n* [**13.3.9**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.3.9) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/093cb8505c75036807c2007d43415da62d1e0ac4) commit.\n* [**13.4.5**](https://about.gitlab.com/releases/categories/releases/)\n* [**13.5.2**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.5.2) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/0cb369aa5f70b59e5922d8f5431a3302fd93574e) commit.\n\nThe latest stable releases can be found [here](https://about.gitlab.com/releases/categories/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-10-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3428",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-203"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13359",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3428/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2020/11/02/security-release-gitlab-13-5-2-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/categories/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/093cb8505c75036807c2007d43415da62d1e0ac4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/0cb369aa5f70b59e5922d8f5431a3302fd93574e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.3.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.5.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3428/default-remediation-status"
            }
        ]
    }
}