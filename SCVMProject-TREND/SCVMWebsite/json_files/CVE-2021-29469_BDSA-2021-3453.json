{
    "source": "BDSA",
    "name": "BDSA-2021-3453",
    "title": "redis Vulnerable to Regular Expression Denial-of-Service (ReDoS) via Inefficient 'monitor_regex' Expression",
    "description": "redis is vulnerable to regular expression denial-of-service (ReDoS) due to a poorly implemented regular expression.  A remote attacker could impact the performance of a vulnerable application, or perhaps cause it to crash, by causing it to process maliciously crafted messages.",
    "technicalDescription": "The file `lib/utils.js` contains a regular expression, `monitor_regex`, which is used to detect monitor messages whenever clients are in monitor mode. This regular expression is inefficiently crafted, such that it is processed with exponential complexity. If certain messages are being processed, then the performance of the application will be adversely affected by the parsing process. An attacker could exploit this in order to carry out a ReDoS attack.\n\nThe vulnerability was fixed by modifying the regular expression so that it is processed more efficiently.",
    "publishedDate": "2021-11-15T16:41:26.610Z",
    "updatedDate": "2021-11-15T16:41:26.598Z",
    "disclosureDate": "2021-02-25T00:00:00.000Z",
    "solution": "Fixed in version [**3.1.1**](https://github.com/redis/node-redis/releases/tag/v3.1.1) by [this](https://github.com/redis/node-redis/commit/2d11b6dc9b9774464a91fb4b448bad8bf699629e) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/redis).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Erik Krogh Kristensen",
    "workaround": "",
    "vendorFixDate": "2021-04-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3453",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-185"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29469",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3453/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/node-redis/commit/2d11b6dc9b9774464a91fb4b448bad8bf699629e",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/node-redis/issues/1569",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/node-redis/releases/tag/v3.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/node-redis/security/advisories/GHSA-35q2-47q7-3pc3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/redis",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3453/default-remediation-status"
            }
        ]
    }
}