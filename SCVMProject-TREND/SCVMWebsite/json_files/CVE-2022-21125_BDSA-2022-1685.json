{
    "source": "BDSA",
    "name": "BDSA-2022-1685",
    "title": "Xen Vulnerable to Hypervisor and VM Information Disclosure via Various x86 MMIO Stale Data CPU Microarchitectural Flaws - Shared Buffers Data Sampling",
    "description": "Xen is vulnerable to several CPU (X86 Intel only) microarchitectural stale data flaws. An attacker with access to one virtual machine could learn sensitive information contained within other running virtual machines, or from the Xen hypervisor itself. \n\nThis particular vulnerability only exists with Intel X86 client CPUs including Xeon E3 and is called Shared Buffers Data Sampling (SBDS). This only affects CPUs vulnerable to [MDS](https://xenbits.xen.org/xsa/advisory-297.html) due to previously undiscovered leakage channels.",
    "technicalDescription": "Xen does not cleanup multi-core fill buffers correctly for some Intel processors. A user on a guest system could learn sensitive information about other guests or the hypervisor itself.\n\nInformation about fill buffers and uncore buffers could all be exposed.",
    "publishedDate": "2022-06-17T15:32:31.311Z",
    "updatedDate": "2022-09-06T10:49:40.910Z",
    "disclosureDate": "2022-06-14T00:00:00.000Z",
    "solution": "Fixed in:\n* The **staging-4.13** branch by the following commits which are not yet included in any release:\n\t* [Commit 1](https://github.com/xen-project/xen/commit/87ff11354f) \n\t* [Commit 2](https://github.com/xen-project/xen/commit/413b08328a) \n\t* [Commit 3](https://github.com/xen-project/xen/commit/a84bc5bde5) \n* The **staging-4.14** branch by the following commits which are not yet included in any release:\n\t* [Commit 1](https://github.com/xen-project/xen/commit/c5f774eaee) \n\t* [Commit 2](https://github.com/xen-project/xen/commit/9f07848283) \n\t* [Commit 3](https://github.com/xen-project/xen/commit/878e684e15)\n* [**4.15.3**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.3) by the following commits:\n\t* [Commit 1](https://github.com/xen-project/xen/commit/a3faf63260)\n\t* [Commit 2](https://github.com/xen-project/xen/commit/680c6f4d6b)\n\t* [Commit 3](https://github.com/xen-project/xen/commit/1a377949ce)\n* [**4.16.2**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.16.2) by the following commits:\n\t* [Commit 1](https://github.com/xen-project/xen/commit/2e82446cb2)\n\t* [Commit 2](https://github.com/xen-project/xen/commit/a83108736d)\n\t* [Commit 3](https://github.com/xen-project/xen/commit/0e80f9f611)\n\nOther versions/branches can be fixed by applying the patches listed [here](https://xenbits.xen.org/xsa/advisory-404.html).\n\t\nThe latest stable releases can be found [here](https://xenproject.org/downloads/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.2,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Ke Sun, Alan Miller, Shlomi Alkalay, Robert Jones, Ezra Caltum",
    "workaround": "**Note** Only a microcode update (IPU 2022.1 from May 2022) for the affected processors can fully mitigate the issue in combination with the following vendor provided advice:\n> In configurations where less privileged domains have MMIO access to buggy endpoints, `spec-ctrl=unpriv-mmio` can be enabled which will cause Xen to mitigate cross-domain fill buffer leakage, and extend SRBDS protections to protect RNG data from leakage.\n\n> Per Xen's support statement, PCI passthrough should be to trusted domains because the overall system security depends on factors outside of Xen's control. As such, Xen, in a supported configuration, is not vulnerable to DRPW/SBDR.",
    "vendorFixDate": "2022-06-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1685",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-21125",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1685/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/0e80f9f611",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/1a377949ce",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/2e82446cb2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/2ebe8fe9b7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/413b08328a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/680c6f4d6b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/878e684e15",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/87ff11354f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/8c24b70fed",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/9f07848283",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/a3faf63260",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/a83108736d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/a84bc5bde5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/c5f774eaee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/e06b95c1d4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.16.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00615.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-297.html",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-404.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-404.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1685/default-remediation-status"
            }
        ]
    }
}