{
    "source": "BDSA",
    "name": "BDSA-2019-4422",
    "title": "SilverStripe GraphQL Vulnerable to Cross-Site Request Forgery (CSRF) via Mutation Queries",
    "description": "The GraphQL Server for SilverStripe is vulnerable to Cross-Site Request Forgery (CSRF) due to insufficient protection on mutation queries.  An attacker can exploit this flaw and use it to trick users into carrying out an unwanted HTTP requests.",
    "technicalDescription": "This CSRF vulnerability occurs due to improper validation of HTTP tokens on mutation queries on GraphQL endpoints.\n\nAn attacker would be able to take advantage of this vulnerability when a user is creating a GraphQL query formed with a fragment portion before the mutation, and will be able to trick the user into carrying out carrying out unwanted HTTP requests.\n\nThe vendor has mitigated against this by enforcing validation of tokens.",
    "publishedDate": "2020-06-11T10:05:09.729Z",
    "updatedDate": "2020-06-11T10:05:09.720Z",
    "disclosureDate": "2019-06-10T00:00:00.000Z",
    "solution": "Fixed in:\n* [**2.0.5**](https://github.com/silverstripe/silverstripe-graphql/releases/tag/2.0.5) by [this](https://github.com/silverstripe/silverstripe-graphql/commit/db28f3075ae2335905f43ac808e9177497e354ff) commit,\n* [**3.1.1**](https://github.com/silverstripe/silverstripe-graphql/releases/tag/3.1.1) by [this](https://github.com/silverstripe/silverstripe-graphql/commit/32b727e02dd8d9b907ff0d515d1b9b82737f2b38) commit,\n* [**3.2.0**](https://github.com/silverstripe/silverstripe-graphql/releases/tag/3.2.0) by [this](https://github.com/silverstripe/silverstripe-graphql/commit/3c1dd6b839b7c0e2cbc85074bb5840ebded6097c) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-06-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4422",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12437",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4422/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-graphql/commit/32b727e02dd8d9b907ff0d515d1b9b82737f2b38",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-graphql/commit/3c1dd6b839b7c0e2cbc85074bb5840ebded6097c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-graphql/commit/db28f3075ae2335905f43ac808e9177497e354ff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-graphql/releases/tag/2.0.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-graphql/releases/tag/3.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-graphql/releases/tag/3.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.silverstripe.org/download/security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4422/default-remediation-status"
            }
        ]
    }
}