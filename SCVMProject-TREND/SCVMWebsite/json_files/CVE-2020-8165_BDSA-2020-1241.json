{
    "source": "BDSA",
    "name": "BDSA-2020-1241",
    "title": "Ruby on Rails Vulnerable to Remote Code Execution (RCE) via Unmarshalling of User-Provided Objects in MemCacheStore and RedisCacheStore",
    "description": "Ruby on Rails is vulnerable to remote code execution (RCE) due to unexpected behaviour when writing untrusted user input to a cache store. This allows attackers to inject untrusted Ruby objects into the application and, in worst case scenarios, execute arbitrary commands on the host.",
    "technicalDescription": "The vulnerability exists due to MemCacheStore and RedisCacheStore exhibiting unexpected behavior when an untrusted user input is written to cache using the `raw: true` parameter. Once the stored input is re-read, it is evaluated as a Marshalled object instead of plain text. This allows for user input to be interpreted as part of Ruby code and thus could result in remote code execution (RCE).\n\nApplications that do not use the `raw` option when storing untrusted user input are not affected by this vulnerability.",
    "publishedDate": "2020-05-28T14:28:15.753Z",
    "updatedDate": "2020-05-28T14:28:15.744Z",
    "disclosureDate": "2020-05-18T00:00:00.000Z",
    "exploitPublishDate": "2020-05-26T00:00:00.000Z",
    "solution": "Fixed in [**5.2.4.3**](https://github.com/rails/rails/releases/tag/v5.2.4.3) by [this](https://github.com/rails/rails/commit/f7e077f85e61fc0b7381963eda0ceb0e457546b5) and [this](https://github.com/rails/rails/commit/467e3399c9007996c03ffe3212689d48dd25ae99) commit.\n\nFixed in [**6.0.3.1**](https://github.com/rails/rails/releases/tag/v6.0.3.1) by [this](https://github.com/rails/rails/commit/bd39a13cb9936e7261b271830950aae9bd0706bc) and [this](https://github.com/rails/rails/commit/0a7ce52486adb36984174bd51257a0069fe7a9db) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dylan Thacker-Smith",
    "workaround": "If an upgrade is not possible, the vendor recommends ensuring that all user-provided strings cached using the `raw` argument conform to the expected format.",
    "vendorFixDate": "2020-05-18T00:00:00.000Z",
    "vendorNotifiedDate": "2018-09-24T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1241",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8165",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1241/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/0a7ce52486adb36984174bd51257a0069fe7a9db",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/467e3399c9007996c03ffe3212689d48dd25ae99",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/bd39a13cb9936e7261b271830950aae9bd0706bc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/f7e077f85e61fc0b7381963eda0ceb0e457546b5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v5.2.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v6.0.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/forum/#!topic/rubyonrails-security/bv6fW4S0Y1c",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/413388",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1241/default-remediation-status"
            }
        ]
    }
}