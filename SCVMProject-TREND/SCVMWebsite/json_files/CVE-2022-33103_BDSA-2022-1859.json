{
    "source": "BDSA",
    "name": "BDSA-2022-1859",
    "title": "Das U-Boot Vulnerable to Arbitrary Code Execution via Out-of-Bounds Write in 'sqfs_readdir()' Function",
    "description": "Das U-Boot is vulnerable to an out of bounds write flaw in its handling of certain squashfs file system features. An attacker who is able to supply specially crafted file systems could cause the execution of arbitrary code.",
    "technicalDescription": "The problem occurs in the `fs/squashfs/sqfs.c` file where the `sqfs_readdir()` function has a mismatch with the maximum length of directory names that can be supported with the underlying file handling code. The squashfs code supports maximum names of 65535 bytes, whereas the underlying code only supports 255. This can result in a buffer overflow through `sqfs_readdir()` function  using `strncpy()` to the undersized buffer.",
    "publishedDate": "2022-07-05T14:16:03.899Z",
    "updatedDate": "2022-07-05T14:16:03.887Z",
    "disclosureDate": "2022-05-26T00:00:00.000Z",
    "exploitPublishDate": "2022-05-26T00:00:00.000Z",
    "solution": "Fixed in version [**2022.07-rc5**](https://github.com/u-boot/u-boot/releases/tag/v2022.07-rc5) by [this](https://github.com/u-boot/u-boot/commit/2ac0baab4aff1a0b45067d0b62f00c15f4e86856) commit.\n\nThe latest releases can be found [here](https://github.com/u-boot/u-boot/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jincheng Wang",
    "workaround": "",
    "vendorFixDate": "2022-06-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1859",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-33103",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1859/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/u-boot/u-boot/commit/2ac0baab4aff1a0b45067d0b62f00c15f4e86856",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/u-boot/u-boot/releases/tag/v2022.07-rc5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/u-boot/u-boot/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/all/CALO=DHFB+yBoXxVr5KcsK0iFdg+e7ywko4-e+72kjbcS8JBfPw@mail.gmail.com/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/all/CALO=DHFB+yBoXxVr5KcsK0iFdg+e7ywko4-e+72kjbcS8JBfPw@mail.gmail.com/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1859/default-remediation-status"
            }
        ]
    }
}