{
    "source": "BDSA",
    "name": "BDSA-2021-1621",
    "title": "Squid Vulnerable to Denial-of-Service (DoS) via Memory Leak in Cache Manager API",
    "description": "Squid is vulnerable to denial-of-service (DoS) due to memory leaks that can be triggered via Cache Manager API. A trusted client could use this vulnerability to exhaust the memory available for Squid and other applications that run on the machine hosting Squid.",
    "technicalDescription": "The vulnerability can be triggered by making `cache_object://0/io?&` queries. Due to the usage of `sscan()` and regex processing, the empty parameter (`&`) causes parsing issues in `Mgr::QueryParams::Parse` (file `src/mgr/QueryParams.cc`). This issue results in memory leaks which can be repeatedly triggered in order to exhaust the free memory available for Squid and other applications. Note that this attack is limited to clients with Cache Manager API access privilege.",
    "publishedDate": "2021-06-01T13:09:57.067Z",
    "updatedDate": "2021-06-01T15:21:39.614Z",
    "disclosureDate": "2021-05-10T00:00:00.000Z",
    "exploitPublishDate": "2021-03-03T00:00:00.000Z",
    "solution": "Fixed in [**4.15**](http://www.squid-cache.org/Versions/v4/) by [this](https://github.com/squid-cache/squid/commit/0003e3518) commit and [**5.0.6**](http://www.squid-cache.org/Versions/v5/) by [this](https://github.com/squid-cache/squid/commit/2db70e047) commit.\n\nThe latest stable releases are available [here](http://www.squid-cache.org/Versions/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.7
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:N/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.8,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 1.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:N/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Joshua Rogers of Opera Software",
    "workaround": "The vendor provides the following workaround:\n\nEither,\n\nDisable Cache Manager access entirely if not needed.\n\nPlace the following line in `squid.conf` before lines containing `allow` :\n\n`http_access deny manager`\n\nOr,\n\nHarden Cache Manager access privileges.\n\nFor example; require authentication or other access controls in `http_access` beyond the default IP address restriction.",
    "vendorFixDate": "2021-05-06T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1621",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-401"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28652",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1621/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v5/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://bugs.squid-cache.org/show_bug.cgi?id=5106",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/0003e3518",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/2db70e047",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-m47m-9hvw-7447",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-m47m-9hvw-7447",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1621/default-remediation-status"
            }
        ]
    }
}