{
    "source": "BDSA",
    "name": "BDSA-2019-4685",
    "title": "Apport Vulnerable to Arbitrary File Writes via 'cwd' Variable Handling Race Condition",
    "description": "Apport is vulnerable to the creation of files in arbitrary directories due to a race condition that involves the use of a variable. A local attacker could exploit this to write a core file to arbitrary directories. A denial-of-service (DoS) could also potentially be performed.",
    "technicalDescription": "The function `get_pid_info()` sets the value of the `cwd` variable to a string that specifies the directory in which a crashed process has been executed. The value of `cwd` is later used by the function `write_user_coredump()` as the target directory to which the core dump file will be written. An attacker could modify the value of `cwd` during the period of time between which it has been set and when it is used by utilizing symbolic links or by manipulating mount points. This will allow the attacker to write the core file to arbitrary directories. Under some circumstances, the attacker may also be able to cause a DoS.",
    "publishedDate": "2020-09-25T15:58:07.391Z",
    "updatedDate": "2020-09-25T15:58:07.385Z",
    "disclosureDate": "2019-10-30T00:00:00.000Z",
    "solution": "Fixed by [this](https://launchpadlibrarian.net/441496833/lp1839413-eoan_apport-2.20.11-0ubuntu7_apport-2.20.11-0ubuntu8.debdiff) patch in:\n* [**2.20.11-0ubuntu8.1**](https://launchpad.net/ubuntu/+source/apport/2.20.11-0ubuntu8.1)\n* [**2.20.10-0ubuntu27.2**](https://launchpad.net/ubuntu/+source/apport/2.20.10-0ubuntu27.2)\n* [**2.20.9-0ubuntu7.8**](https://launchpad.net/ubuntu/+source/apport/2.20.9-0ubuntu7.8)\n* [**2.20.1-0ubuntu2.20**](https://launchpad.net/ubuntu/+source/apport/2.20.1-0ubuntu2.20)\n\nThe latest stable releases can be found [here](https://launchpad.net/ubuntu/+source/apport).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.2,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sander Bos",
    "workaround": "",
    "vendorFixDate": "2019-10-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4685",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-367"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11482",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4685/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/apport/+bug/1839413",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/apport",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/apport/2.20.1-0ubuntu2.20",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/apport/2.20.10-0ubuntu27.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/apport/2.20.11-0ubuntu8.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/apport/2.20.9-0ubuntu7.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpadlibrarian.net/441496833/lp1839413-eoan_apport-2.20.11-0ubuntu7_apport-2.20.11-0ubuntu8.debdiff",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4685/default-remediation-status"
            }
        ]
    }
}