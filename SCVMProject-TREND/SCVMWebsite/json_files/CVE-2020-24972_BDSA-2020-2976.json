{
    "source": "BDSA",
    "name": "BDSA-2020-2976",
    "title": "Kleopatra Vulnerable to Arbitrary Code Execution via 'openpgp4fpr' Handler",
    "description": "Kleopatra is vulnerable to arbitrary code execution due to insufficient sanitization of user-supplied input.",
    "technicalDescription": "This vulnerability exists due to  `openpgp4fpr:` URLs being supported without safe handling of command line parameters. Remote attackers could exploit this using a maliciously crafted URL via `openpgp4fpr` handler and tricking a victim into processing it resulting in the execution of arbitrary code. The vendor addressed this by preventing the query and search parameters being parsed as values and instead as positional arguments. This results in the URL handler for `openpgp4fpr:`being registered as`kleoptra --query -- $1`. The vendor also adds a double dash to prevent command line injections via file names.",
    "publishedDate": "2020-10-26T16:00:48.911Z",
    "updatedDate": "2021-10-01T10:43:55.447Z",
    "disclosureDate": "2020-08-30T00:00:00.000Z",
    "solution": "Fixed in [**20.07.80**](https://github.com/KDE/kleopatra/releases/tag/v20.07.80) by [this](https://github.com/KDE/kleopatra/commit/b4bd63c1739900d94c04da03045e9445a5a5f54b) commit and [this](https://github.com/KDE/kleopatra/commit/9abdda396818842de1d9af9a153b66a1399f7c0f) commit.\n\nThe latest stable release are available [here](https://github.com/KDE/kleopatra/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-07-07T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2976",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-24972",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2976/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/KDE/kleopatra/commit/9abdda396818842de1d9af9a153b66a1399f7c0f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/KDE/kleopatra/commit/b4bd63c1739900d94c04da03045e9445a5a5f54b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/KDE/kleopatra/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/KDE/kleopatra/releases/tag/v20.07.80",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://security.gentoo.org/glsa/202008-21",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2976/default-remediation-status"
            }
        ]
    }
}