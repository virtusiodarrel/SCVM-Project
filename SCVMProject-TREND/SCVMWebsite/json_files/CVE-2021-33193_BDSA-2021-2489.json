{
    "source": "BDSA",
    "name": "BDSA-2021-2489",
    "title": "Apache HTTP Server Vulnerable to Request Line Injection via Block Rules Bypass Flaw",
    "description": "Apache HTTP Server, when using HTTP/2, permits the use of spaces in the `:method` pseudo-header which could allow for request line injection.\n\nAn attacker could submit a crafted method that includes spaces to bypass block rules which could enable request splitting or cache poisoning attacks.",
    "technicalDescription": "Apache HTTP Server, when using HTTP/2, is vulnerable to request line injection because the 'mod_proxy' functionality allows the use of spaces in the `:method` pseudo-header. Where the back-end server tolerates trailing 'junk' in the request line, this can allow the block rules to be bypassed in order to access restricted functionality and for subfolders to be escaped from.",
    "publishedDate": "2021-08-19T10:42:36.419Z",
    "updatedDate": "2021-11-08T09:11:52.627Z",
    "disclosureDate": "2021-08-05T00:00:00.000Z",
    "exploitPublishDate": "2021-08-05T00:00:00.000Z",
    "solution": "Fixed in **[2.4.49](https://github.com/apache/httpd/releases/tag/2.4.49)** by [this](https://github.com/apache/httpd/commit/ecebcc035ccd8d0e2984fe41420d9e944f456b3c) commit.\n\nThe latest stable releases are available [here](https://httpd.apache.org/download.cgi).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "James Kettle (PortSwigger)",
    "workaround": "In the reporter's research article [here](https://portswigger.net/research/http2#primitives), it is suggested that HTTP/2 could be disabled as a temporary measure.",
    "vendorFixDate": "2021-05-27T00:00:00.000Z",
    "vendorNotifiedDate": "2021-05-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2489",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33193",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2489/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/httpd/commit/ecebcc035ccd8d0e2984fe41420d9e944f456b3c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/httpd/releases/tag/2.4.49",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1391549",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1391549",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://httpd.apache.org/download.cgi",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2021-33193",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://portswigger.net/research/http2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://portswigger.net/research/http2",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://portswigger.net/research/http2#primitives",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2489/default-remediation-status"
            }
        ]
    }
}