{
    "source": "BDSA",
    "name": "BDSA-2021-1762",
    "title": "Zephyr L2CAP Implementation Vulnerable to Denial-of-Service (DoS) or Remote Code Execution (RCE) via Use-After_Free",
    "description": "Synopsys Cybersecurity Research Center (CyRC) has discovered that the Zerphyr L2CAP Implementation is vulnerable to a use-after-free whereby an attacker can cause denial-of-service (DoS), and potentially remote code execution (RCE) by causing the target device to reference a memory block that has already been freed.\n\nTriggering this vulnerability does not require authentication or encryption. The only requirement is that the device is in advertising mode and accepting connections, and that the attacker is within range of the Bluetooth device.",
    "technicalDescription": "This vulnerability lies in `bt_att_sent()` function in `l2cap.c` file where a pointer is used to access a memory that has already been released. This can be triggered by a central device connecting to the target and creating an L2CAP connection for Enhanced ATT. If the attacker sends an invalid ATT request then immediately disconnects, the target device will freeze, causing a denial-of-service (DoS) and potentially remote code execution through exploitation of the use-after-free.",
    "publishedDate": "2021-06-22T15:45:15.484Z",
    "updatedDate": "2022-07-12T11:20:26.308Z",
    "disclosureDate": "2021-06-14T00:00:00.000Z",
    "solution": "Fixed in [**2.6.0-rc2**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.6.0-rc2) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/c99b7ba71c6f0d2e8faa8b8dfb73d1cad1d8ad3e) commit.\n\nFixed in [**2.5.1-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.5.1-rc1) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/12201c62f6177eb58c9f7e262b095be60d3f5e36) commit.\n\nFix was backported to [**2.4-branch**](https://github.com/zephyrproject-rtos/zephyr/tree/v2.4-branch) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/54cf9207e463919b621a2c60a8ecf9d46fbb6d1a) commit.\n\n\nThe most recent release can be found [here](https://www.zephyrproject.org/developer-resources/#current-release).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.5,
        "severity": "MEDIUM",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:A/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matias Karhumaa (Synopsys Cybersecurity Research Center (CyRC))",
    "workaround": "",
    "vendorFixDate": "2021-05-25T00:00:00.000Z",
    "discoveryDate": "2021-03-17T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-18T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1762",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3455",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1762/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/12201c62f6177eb58c9f7e262b095be60d3f5e36",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/54cf9207e463919b621a2c60a8ecf9d46fbb6d1a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/c99b7ba71c6f0d2e8faa8b8dfb73d1cad1d8ad3e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/pull/35597",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.5.1-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.6.0-rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/policy",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v2.4-branch",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synopsys.com/blogs/software-security/cyrc-advisory-zephyr-vulnerability/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.zephyrproject.org/developer-resources/#current",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.zephyrproject.org/developer-resources/#current-release",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1762/default-remediation-status"
            }
        ]
    }
}