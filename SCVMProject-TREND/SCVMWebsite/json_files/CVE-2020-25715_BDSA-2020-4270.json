{
    "source": "BDSA",
    "name": "BDSA-2020-4270",
    "title": "pki-core Vulnerable to DOM Based Cross-Site Scripting (XSS) via 'ListCerts'",
    "description": "pki-core is vulnerable to a DOM based cross-site scripting (XSS) attack. This could allow an attacker to execute malicious JavaScript code in a user's browser and steal sensitive information, such as authentication tokens or user session cookies. In some circumstances this could also allow the attacker to execute arbitrary code, and send and sign arbitrary certificates.\n\n**Note:** This vulnerability requires the victim to have installed their RHCS certificate in the web browser.",
    "technicalDescription": "This vulnerability exists in the `processCertFilter()` and `fillX509RecordIntoArg()` functions of the `listCerts` page of file `base/ca/src/com/netscape/cms/servlet/cert/ListCerts.java` in pki-core. An attacker can use a specially crafted POST request in order to include malicious JavaScript within dynamically generated web content, which will be executed in a victim's browser.",
    "publishedDate": "2021-03-16T15:25:14.773Z",
    "updatedDate": "2021-06-16T15:43:52.905Z",
    "disclosureDate": "2020-10-23T00:00:00.000Z",
    "exploitPublishDate": "2020-10-23T00:00:00.000Z",
    "solution": "Fixed in [**10.11.0-alpha1**](https://github.com/dogtagpki/pki/releases/tag/v10.11.0-alpha1) by [this](https://github.com/dogtagpki/pki/commit/13f4c7fe7d71d42b46b25f3e8472ef7f35da5dd6) commit.\n\nThe latest stable releases are available [here](https://github.com/dogtagpki/pki/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "A third party has supplied the following workaround:\n> Because the cross-site scripting (XSS) attack requires the victim to have their RHCS certificate installed in their web browser to be successful, it is recommended that web browser not hold the keys and that the user use the command line interface (CLI) instead.",
    "vendorFixDate": "2021-03-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4270",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25715",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4270/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1891016",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1891016",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1891016",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dogtagpki/pki/commit/13f4c7fe7d71d42b46b25f3e8472ef7f35da5dd6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dogtagpki/pki/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dogtagpki/pki/releases/tag/v10.11.0-alpha1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4270/default-remediation-status"
            }
        ]
    }
}