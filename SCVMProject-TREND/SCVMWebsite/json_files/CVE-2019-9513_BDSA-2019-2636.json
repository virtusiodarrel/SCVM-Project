{
    "source": "BDSA",
    "name": "BDSA-2019-2636",
    "title": "Multiple Components using HTTP/2 Vulnerable to Denial-of-Service (DoS) via Resource Loop",
    "description": "Multiple components that support the HTTP/2 protocol are vulnerable to denial-of-service (DoS). An attacker could cause this by repeatedly shuffling the priority of streams, this can cause the component to consume excessive CPU, which could lead to a DoS.",
    "technicalDescription": "One feature of HTTP/2 is that multiple request streams can be organized into a \"prioritization tree\" to help facilitate new features around multiplexing of frames from multiple streams and having them interleaved and delivered to the client. \nThis allows the client to express how it would prefer to receive responses from the server, allowing the server to prioritize specific streams, including how much CPU and memory get allocated to that stream.\n\nDue to an issue with how these HTTP/2 streams are prioritized, if an attacker is able to create a prioritization tree with enough request streams in a complex layout, and is also able to continually and significantly change the prioritization within the priority tree, the attacker can cause excessive amounts of CPU to be consumed. This could lead to a DoS.",
    "publishedDate": "2019-08-22T11:14:12.156Z",
    "updatedDate": "2021-01-27T15:54:31.616Z",
    "disclosureDate": "2019-08-13T00:00:00.000Z",
    "solution": "**Node.js:**\nFixed in:\n* [**8.16.1**]( https://nodejs.org/dist/latest-v8.x/) by [these](https://github.com/nodejs/node/commit/affa23bc88849f962e6fd784852c3db242bfeb19) commits.\n* [**10.16.3**](https://nodejs.org/dist/latest-v10.x/) by [these](https://github.com/nodejs/node/commit/004e2b759ffff2dff4b0d45c630e3305350b41df) commits.\n* [**12.8.1**](https://nodejs.org/dist/latest-v12.x/) by [these](https://github.com/nodejs/node/commit/edc2e5be34abe45b6d2e0dbccecb1771ecf82286) commits.\n\n**Envoy**\nFixed in [**1.11.1**](https://github.com/envoyproxy/envoy/releases/tag/v1.11.1) by [this](https://github.com/envoyproxy/envoy/commit/9f16bca5044260f5ceeb49c5836b9326a75a0b49) commit.\n\n**Istio**\nFixed in **[1.1.13](https://github.com/istio/istio/releases/tag/1.1.13)** and **[1.2.4](https://github.com/istio/istio/releases/tag/1.2.4)**.\n\n**nghttp2**\nFixed in [**1.39.2**](https://github.com/nghttp2/nghttp2/releases/tag/v1.39.2) by [this](https://github.com/nghttp2/nghttp2/commit/95efb3e19d174354ca50c65d5d7227d92bcd60e1) commit.\n\n**nginx**\nFixed in:\n* [**1.16.1**](https://github.com/nginx/nginx/releases/tag/release-1.16.1) by [this](https://github.com/nginx/nginx/commit/39bb3b9d4a33bd03c8ae0134dedc8a7700ae7b2b) commit. \n* [**1.17.3**](https://github.com/nginx/nginx/releases/tag/release-1.17.3) by [this](https://github.com/nginx/nginx/commit/5ae726912654da10a9a81b2c8436829f3e94f69f) commit.\n\n**Proxygen**\nFixed in [**2019.08.19.00**](https://github.com/facebook/proxygen/releases/tag/v2019.08.19.00) by [this](https://github.com/facebook/proxygen/commit/ce5fb2b8199dbbb579b114065d19a0e564381457) commit.\n\n**httpd**\nFixed in **[2.4.41](https://httpd.apache.org/download.cgi#apache24)** by [this](https://github.com/apache/httpd/commit/04a5ac01fd5a32439eba91f2ad96e56f40014cff) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "For nghttpx, additionally limiting inbound traffic by `--read-rate` and `--read-burst` options is quite effective against this kind of attack.",
    "vendorFixDate": "2019-08-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2636",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9513",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2636/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1735741",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://developers.google.com/web/fundamentals/performance/http2/#stream_prioritization",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Netflix/security-bulletins/blob/master/advisories/third-party/2019-002.md",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/httpd/commit/04a5ac01fd5a32439eba91f2ad96e56f40014cff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/9f16bca5044260f5ceeb49c5836b9326a75a0b49",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.11.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/proxygen/commit/ce5fb2b8199dbbb579b114065d19a0e564381457",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/proxygen/releases/tag/v2019.08.19.00",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/releases/tag/1.1.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/releases/tag/1.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nghttp2/nghttp2/releases/tag/v1.39.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nginx/nginx/commit/39bb3b9d4a33bd03c8ae0134dedc8a7700ae7b2b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nginx/nginx/commit/5ae726912654da10a9a81b2c8436829f3e94f69f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nginx/nginx/releases/tag/release-1.16.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nginx/nginx/releases/tag/release-1.17.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/commit/004e2b759ffff2dff4b0d45c630e3305350b41df",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/commit/affa23bc88849f962e6fd784852c3db242bfeb19",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/commit/edc2e5be34abe45b6d2e0dbccecb1771ecf82286",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://httpd.apache.org/download.cgi#apache24",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://nghttp2.org/blog/2019/08/19/nghttp2-v1-39-2/",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://nginx.org/en/CHANGES",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://nodejs.org/dist/latest-v10.x/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://nodejs.org/dist/latest-v12.x/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://nodejs.org/dist/latest-v8.x/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://vuls.cert.org/confluence/pages/viewpage.action?pageId=56393752",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kb.cert.org/vuls/id/605641/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2636/default-remediation-status"
            }
        ]
    }
}