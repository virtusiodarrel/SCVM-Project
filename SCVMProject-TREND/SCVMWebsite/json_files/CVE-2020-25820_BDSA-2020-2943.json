{
    "source": "BDSA",
    "name": "BDSA-2020-2943",
    "title": "BigBlueButton Vulnerable to Arbitrary File Disclosure and Server-Side Request Forgery via File Upload Functionality",
    "description": "BigBlueButton is vulnerable to arbitrary file disclosure and server-side request forgery issues due to how LibreOffice documents are handled when uploaded to the server.\n\nAn attacker with appropriate upload privileges could submit a crafted file referencing local files to display their contents in the final converted LibreOffice file. They could also perform server-side requests using a similar attack method.",
    "technicalDescription": "BigBlueButton is vulnerable to arbitrary file disclosure and server-side request forgery issues because the Open Document Format (ODF) that LibreOffice documents use supports using the XML Linking Language (XLink) to create links between documents. When a LibreOffice document is uploaded to the system, it is converted to a PDF format without validating if files are referenced with XLinks.\n\nIf a local file is referenced in the uploaded document with an XLink, the contents of the file can be included in the final PDF file when converted using LibreOffice. This allows an attacker to extract information from arbitrary files on the system.\n\nAn attacker can also perform server-side requests as LibreOffice embeds XLinks to remote locations upon conversion.",
    "publishedDate": "2020-10-23T08:54:07.082Z",
    "updatedDate": "2022-02-23T14:37:34.105Z",
    "disclosureDate": "2020-10-21T00:00:00.000Z",
    "exploitPublishDate": "2020-10-21T00:00:00.000Z",
    "solution": "Fixed in [**2.2.27**](https://github.com/bigbluebutton/bigbluebutton/releases/tag/v2.2.27) by [this](https://github.com/bigbluebutton/bigbluebutton/commit/db413c59e99ff81b19426bb761da4097fd418f34) commit.\n\nThe latest stable releases are available [here](https://github.com/bigbluebutton/bigbluebutton/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "A workaround, suggested [here](https://www.redteam-pentesting.de/en/advisories/rt-sa-2020-005), is to disable the conversion feature if it is not used. If this is not possible, the allowed upload file types should be restricted to PDF files.",
    "vendorFixDate": "2020-10-08T00:00:00.000Z",
    "discoveryDate": "2020-09-11T00:00:00.000Z",
    "vendorNotifiedDate": "2020-09-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2943",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25820",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2943/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bigbluebutton/bigbluebutton/commit/63195ec5d2b665548eb974bfd6a6b75355c85fcb",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bigbluebutton/bigbluebutton/commit/db413c59e99ff81b19426bb761da4097fd418f34",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bigbluebutton/bigbluebutton/pull/10619",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bigbluebutton/bigbluebutton/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bigbluebutton/bigbluebutton/releases/tag/v2.2.27",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.golem.de/news/big-blue-button-das-grosse-blaue-sicherheitsrisiko-2010-151610-2.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.golem.de/news/big-blue-button-das-grosse-blaue-sicherheitsrisiko-2010-151610.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.golem.de/news/big-blue-button-das-grosse-blaue-sicherheitsrisiko-2010-151610.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.redteam-pentesting.de/en/advisories/rt-sa-2020-005",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.redteam-pentesting.de/en/advisories/rt-sa-2020-005",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.redteam-pentesting.de/en/advisories/rt-sa-2020-005",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2943/default-remediation-status"
            }
        ]
    }
}