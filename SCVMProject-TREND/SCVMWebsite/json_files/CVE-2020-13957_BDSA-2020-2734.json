{
    "source": "BDSA",
    "name": "BDSA-2020-2734",
    "title": "Apache Solr Vulnerable to Authentication Bypass via 'ConfigSet' UPLOAD/CREATE Actions",
    "description": "It was found that some dangerous features in Apache Solr could be enabled due to an authorization bypass on the upload and creation permissions of configuration sets. The vendor states that the features, once enabled, could be used to achieve remote code execution (RCE).",
    "technicalDescription": "The problem is within `ConfigSets` API, when a `ConfigSet` is created based on an already uploaded one (using the `CREATE` call), the `trusted` flag is not set which allows for authorization/authentication check mechanisms to be bypassed by using a combination of `UPLOAD`/`CREATE` actions. The issue was fixed by copying `ConfigSet` root data from the base `ConfigSet` when using the `CREATE` command so that the `trusted` flag is set.",
    "publishedDate": "2020-10-13T15:41:36.452Z",
    "updatedDate": "2020-10-27T09:35:08.037Z",
    "disclosureDate": "2020-10-12T00:00:00.000Z",
    "exploitPublishDate": "2020-10-13T00:00:00.000Z",
    "solution": "Fixed in **[8.6.3](https://github.com/apache/lucene-solr/releases/tag/releases/lucene-solr/8.6.3)** by [this](https://github.com/apache/lucene-solr/commit/e001c222181) commit.\n\nThe latest stable releases are available [here](https://lucene.apache.org/solr/downloads.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tom\u00e1s Fern\u00e1ndez L\u00f6bbe, Andr\u00e1s Salamon",
    "workaround": "The vendor says that any of the following are enough to prevent this vulnerability:\n\n* Disable `UPLOAD` command in `ConfigSets` API if not used by setting the system property: `configset.upload.enabled` to `false`.\n* Use [Authentication/Authorization](https://lucene.apache.org/solr/guide/8_6/authentication-and-authorization-plugins.html) and make sure unknown requests aren't allowed.\n* If upgrading is not an option, consider applying the patch in [SOLR-14663](https://issues.apache.org/jira/browse/SOLR-14663).\n* No Solr API, including the Admin UI, is designed to be exposed to non-trusted parties. Tune your firewall so that only trusted computers and people are allowed access",
    "vendorFixDate": "2020-10-02T00:00:00.000Z",
    "vendorNotifiedDate": "2020-07-17T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2734",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13957",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2734/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cwiki.apache.org/confluence/display/solr/SolrSecurity",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Imanfeng/Apache-Solr-RCE#cve-2020-13957",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/lucene-solr/commit/e001c222181",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/lucene-solr/releases/tag/releases/lucene-solr/8.6.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/SOLR-14663",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/SOLR-14925",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/SOLR-14925",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://lucene.apache.org/solr/guide/8_6/authentication-and-authorization-plugins.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2734/default-remediation-status"
            }
        ]
    }
}