{
    "source": "BDSA",
    "name": "BDSA-2021-2841",
    "title": "Kubernetes Vulnerable to Information Exposure via Confused Deputy Attack",
    "description": "Kubernetes is vulnerable to information exposure via a confused deputy attack.",
    "technicalDescription": "An attacker who can create or edit Endpoints or EndpointSlices in the Kubernetes API could potentially direct a  LoadBalancer or Ingress implementation to expose backend IPs the attacker should not have access to. If the target's NetworkPolicy already trusts the Load Balancer or Ingress implementation, NetworkPolicy can not be used to prevent exposure from other namespaces, potentially bypassing any security controls such as LoadBalancerSourceRanges.",
    "publishedDate": "2021-09-24T15:17:38.848Z",
    "updatedDate": "2022-07-14T10:36:33.411Z",
    "disclosureDate": "2021-07-14T00:00:00.000Z",
    "solution": "",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 2.8
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:N/A:N/E:U/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.1,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.6,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 2.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N/E:U/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "To mitigate the exposure it's recommended to restrict write access to Endpoints and EndpointSlices by updating the system:aggregate-to-edit role using the file in [this](https://github.com/kubernetes/kubernetes/issues/103675) GitHub issue. This removes write access to Endpoints from the admin and edit roles.  \n\nNote that this prevents new versions of Kubernetes from reconciling new default permissions to this role. No new default permissions have  been added to this role since **1.14.0**, but it's recommended to remove the `autoupdate=false` annotation as soon as a fix or other mitigation is possible.  \n\nFor use-cases that need to edit these resources, a new purpose-built Role should be created with the desired permissions, and used only for those cases.",
    "bdsaTags": [],
    "overallScore": 2.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2841",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-441"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-25740",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2841/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/issues/103675",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/issues/103675",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/kubernetes-security-announce/c/WYE9ptrhSLE",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2841/default-remediation-status"
            }
        ]
    }
}