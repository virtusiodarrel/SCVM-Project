{
    "source": "BDSA",
    "name": "BDSA-2018-4423",
    "title": "SQLite Vulnerable to Remote Code Execution (RCE) & Denial-of-Service (DoS) via SQL Injection in FTS3 Extension",
    "description": "It has been discovered that SQLite is vulnerable to SQL Injection. An attacker could exploit this vulnerability by crafting malicious statements to target database tables, which can leak program memory, cause a denial-of-service (DoS) or execute arbitrary code against the target system.",
    "technicalDescription": "An integer overflow vulnerability in FTS3 extension modules in SQLite can be manipulated to execute arbitrary code against the target system. The FTS3 module allows users to perform full text searches on several documents with various rules.\n\nThe weakness in function `fts3GetVarint32` located in the file `ext/fts3/fts3_write.c` allowed malicious SQL statements to manipulate the parameters `nPrefix` and `nSuffix` to trigger an integer overflow, which could lead to a denial-of-service (DoS) condition. \n\nThis issue was fixed in version **3.25.5** but it was later discovered additional SQL statements could be used to target the local tables utilized by the FTS3 module. The FTS3 extension also stores the search content in real database tables known as `shadow tables`.\n\nIt has been discovered that the application enables direct write access to the `shadow tables` by default which allows arbitrary SQL statements to manipulate the index data which could lead to remote code execution (RCE). The file `src/main.c` utilizes an array called `aFlagOp` to store the database configuration options. The array does not contain the `SQLITE_DBCONFIG_DEFENSIVE` flag which prevents direct write access.\n\nAn attacker could exploit this vulnerability by crafting a malicious webpage which executes JavaScript to drop the original `ft` table and create a shadow table utilizing FTS3 extensions. This could be targeted with additional SQL statements to leak program memory, cause an application crash or execute arbitrary code against the system.",
    "publishedDate": "2018-12-20T16:22:04.743Z",
    "updatedDate": "2018-12-24T10:04:49.142Z",
    "disclosureDate": "2018-12-14T00:00:00.000Z",
    "exploitPublishDate": "2018-12-14T00:00:00.000Z",
    "solution": "Fixed in SQLite version [**3.26.0**](https://www.sqlite.org/download.html) by [this](https://sqlite.org/src/info/940f2adc8541a838) commit and [this](https://www.sqlite.org/src/artifact/0efc9f6fba87f7b4) commit.\n\nFixed in Chromium [**71.0.3578.75**](https://github.com/chromium/chromium/releases/tag/71.0.3578.75) by [this](https://chromium.googlesource.com/chromium/src/+/c368e30ae55600a1c3c9cb1710a54f9c55de786e) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tencent Blade Team",
    "workaround": "",
    "vendorFixDate": "2018-11-10T00:00:00.000Z",
    "vendorNotifiedDate": "2018-11-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.1,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4423",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-20346",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4423/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blade.tencent.com/magellan/index_en.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://chromereleases.googleblog.com/2018/12/stable-channel-update-for-desktop.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://chromium.googlesource.com/chromium/src/+/c368e30ae55600a1c3c9cb1710a54f9c55de786e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chromium/chromium/releases/tag/71.0.3578.75",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://news.ycombinator.com/item?id=18685296",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sqlite.org/src/info/940f2adc8541a838",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://worthdoingbadly.com/sqlitebug/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/releaselog/3_26_0.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/src/artifact/0efc9f6fba87f7b4",
                "label": "PATCH"
            }
        ]
    }
}