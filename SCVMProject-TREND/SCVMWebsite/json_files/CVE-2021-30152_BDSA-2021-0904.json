{
    "source": "BDSA",
    "name": "BDSA-2021-0904",
    "title": "MediaWiki Vulnerable to Page Protection Manipulation via API Permissions Flaw",
    "description": "MediaWiki is vulnerable to a page protection manipulation issue due to how the MediaWiki API does not sufficiently validate that users have the correct permissions to alter page protections.\n\nAn attacker could use this issue to restrict other users from editing a page by applying high level protections to it. Page protections could potentially be removed with this flaw.",
    "technicalDescription": "MediaWiki is vulnerable to page protection manipulation because the MediaWiki API incorrectly uses `$wgRestrictionLevels` to validate if users have permission to alter page protections.\n\nAn attacker can apply protections higher than their current level which could potentially impact how other users interact with the page. If the `edit` and/or `protect` types have not been restricted, the protection level can be removed again by the attacker.",
    "publishedDate": "2021-04-09T13:58:48.092Z",
    "updatedDate": "2021-04-09T13:58:48.086Z",
    "disclosureDate": "2021-04-08T00:00:00.000Z",
    "exploitPublishDate": "2021-04-08T00:00:00.000Z",
    "solution": "Fixed in [**1.35.2**](https://gerrit.wikimedia.org/g/mediawiki/core/+/refs/tags/1.35.2) by [this](https://gerrit.wikimedia.org/r/c/mediawiki/core/+/678038) commit.\n\nFixed in [**1.31.13**](https://gerrit.wikimedia.org/g/mediawiki/core/+/refs/tags/1.31.13) by [this](https://gerrit.wikimedia.org/r/c/mediawiki/core/+/678032) commit.\n\nThe latest stable releases are available [here](https://releases.wikimedia.org/mediawiki/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Magiczocker10",
    "workaround": "",
    "vendorFixDate": "2021-04-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0904",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-280"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-30152",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0904/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/g/mediawiki/core/+/refs/tags/1.31.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/g/mediawiki/core/+/refs/tags/1.35.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/r/c/mediawiki/core/+/678032",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/r/c/mediawiki/core/+/678038",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://phabricator.wikimedia.org/T270713",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://phabricator.wikimedia.org/T270713",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://releases.wikimedia.org/mediawiki/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.mediawiki.org/wiki/Release_notes/1.35#MediaWiki_1.35.2",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0904/default-remediation-status"
            }
        ]
    }
}