{
    "source": "BDSA",
    "name": "BDSA-2020-0119",
    "title": "JFrog Artifactory Vulnerable to Remote Code Execution (RCE) via Malicious Freemarker Template",
    "description": "JFrog Artifactory is vulnerable to remote code execution (RCE) via malicious Freemarker templates. An attacker can take advantage of this to read and write arbitrary files on the Artifactory instance.",
    "technicalDescription": "JFrog allows authenticated users to upload, deploy and execute Freemarker templates.  Due to the presence of the `DefaultObjectWrapper` class in Artifactory a malicious freemarker template will be able to execute sensitive Java functions. The attack works by reusing Java objects that exist in the scope of the template. The attacker can use the security object exposed by Artifactory and chain together several method calls to access the contents of a file:\n\n`security.getClass().getProtectionDomain().getClassLoader().getURLs()[0].toURI().resolve('/etc/passwd').toURL().getContent()`",
    "publishedDate": "2020-02-06T09:36:35.646Z",
    "updatedDate": "2020-02-06T09:36:35.624Z",
    "disclosureDate": "2020-01-23T00:00:00.000Z",
    "exploitPublishDate": "2020-01-23T00:00:00.000Z",
    "solution": "Fixed in: \n* **[5.11.8](https://jfrog.com/open-source/#artifactory)**\n* **[6.1.6](https://jfrog.com/open-source/#artifactory)**\n* **[6.3.9](https://jfrog.com/open-source/#artifactory)**\n* **[6.7.8](https://jfrog.com/open-source/#artifactory)**\n* **[6.8.17](https://jfrog.com/open-source/#artifactory)**\n* **[6.9.6](https://jfrog.com/open-source/#artifactory)**\n* **[6.10.9](https://jfrog.com/open-source/#artifactory)**\n* **[6.11.7](https://jfrog.com/open-source/#artifactory)**\n* **[6.12.3](https://jfrog.com/open-source/#artifactory)**\n* **[6.13.2](https://jfrog.com/open-source/#artifactory)**\n* **[6.14.2](https://jfrog.com/open-source/#artifactory)**\n* **[6.15.1](https://jfrog.com/open-source/#artifactory)**\n* **[6.16.0](https://jfrog.com/open-source/#artifactory)**",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ryan Hanson",
    "workaround": "",
    "vendorFixDate": "2019-12-10T00:00:00.000Z",
    "vendorNotifiedDate": "2019-10-25T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0119",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7931",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0119/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/atredispartners/advisories/blob/master/ATREDIS-2019-0006.md",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/atredispartners/advisories/blob/master/ATREDIS-2019-0006.md",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://jfrog.com/open-source/#artifactory",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.jfrog.com/confluence/display/RTF/Release+Notes#ReleaseNotes-Artifactory6.15.1",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0119/default-remediation-status"
            }
        ]
    }
}