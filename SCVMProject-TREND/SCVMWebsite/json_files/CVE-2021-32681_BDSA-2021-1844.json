{
    "source": "BDSA",
    "name": "BDSA-2021-1844",
    "title": "Wagtail Vulnerable to Cross-Site Scripting (XSS) via StreamField Blocks",
    "description": "Wagtail is vulnerable to cross-site scripting (XSS) attacks due to the improper sanitization of dynamically-generated web content. An authenticated remote attacker can use this to execute malicious HTML code in a victim's browser, which could be used to steal session tokens, cookies, or other sensitive information.",
    "technicalDescription": "This vulnerability exists when the `{% include_block %}` template tag is used to output the value of a plain-text StreamField block which does not specify a template for rendering. These plain-text StreamField blocks could be a `CharBlock`, a `TextBlock` or a user-defined block which has been derived from `FieldBlock`. When this occurs then the tag output is not properly escaped as HTML.  An authenticated remote attacker with the ability to author StreamField content can exploit this vulnerability in order to insert arbitrary HTML or scripts, which will subsequently get executed in a victims browser.",
    "publishedDate": "2021-06-18T15:38:47.847Z",
    "updatedDate": "2021-09-10T15:17:30.771Z",
    "disclosureDate": "2021-06-17T00:00:00.000Z",
    "solution": "Fixed in:\n* [**2.11.8**](https://github.com/wagtail/wagtail/releases/tag/v2.11.8) by [this](https://github.com/wagtail/wagtail/commit/e24f10c77b9bac95c9bcecbd84916c9eaa7e59cf) commit and [this](https://github.com/wagtail/wagtail/commit/084a9c10cd206b79fa44d922d81beecf660cf494) commit,\n* [**2.12.5**](https://github.com/wagtail/wagtail/releases/tag/v2.12.5) by [this](https://github.com/wagtail/wagtail/commit/07e7bb5abf307bc4890bd0a8966f99d0ba40b960) commit and [this](https://github.com/wagtail/wagtail/commit/5e054de3e29af3f0fc0279cb4bee47f13ad030e4) commit,\n* [**2.13.2**](https://github.com/wagtail/wagtail/releases/tag/v2.13.2) by [this](https://github.com/wagtail/wagtail/commit/86ed9255ae735020711389eed882dd8fababc39a) commit and [this](https://github.com/wagtail/wagtail/commit/342bd0cbcf49f7a1c7007062d9dd36ddd22af94d) commit. \n\nThe latest stable releases are available [here](https://github.com/wagtail/wagtail/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 1.7,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Karen Tracey",
    "workaround": "The vendor has provided the following [workarounds](https://github.com/wagtail/wagtail/security/advisories/GHSA-xfrw-hxr5-ghqf):\n\nSite implementors who wish to retain the existing behaviour of allowing editors to insert HTML content in these blocks (and are willing to accept the risk of untrusted editors inserting arbitrary code) may disable the escaping by surrounding the relevant `{% include_block %}` tag in `{% autoescape off %}...{% endautoescape %}`.\n\nSite implementors who are unable to upgrade to a current supported version should audit their use of `{% include_block %}` to ensure it is not used to output `CharBlock` / `TextBlock` values with no associated template. \nNote that this only applies where `{% include_block %}` is used directly on that block (uses of include_block on a block containing a CharBlock / TextBlock, such as a StructBlock, are unaffected). In these cases, the tag can be replaced with Django's `{{ ... }}` syntax - e.g. `{% include_block my_title_block %}` becomes `{{ my_title_block }}`.",
    "vendorFixDate": "2021-06-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1844",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32681",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1844/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/commit/07e7bb5abf307bc4890bd0a8966f99d0ba40b960",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/commit/084a9c10cd206b79fa44d922d81beecf660cf494",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/commit/342bd0cbcf49f7a1c7007062d9dd36ddd22af94d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/commit/5e054de3e29af3f0fc0279cb4bee47f13ad030e4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/commit/86ed9255ae735020711389eed882dd8fababc39a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/commit/e24f10c77b9bac95c9bcecbd84916c9eaa7e59cf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/releases/tag/v2.11.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/releases/tag/v2.12.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/releases/tag/v2.13.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/security/advisories/GHSA-xfrw-hxr5-ghqf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/security/advisories/GHSA-xfrw-hxr5-ghqf",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1844/default-remediation-status"
            }
        ]
    }
}