{
    "source": "BDSA",
    "name": "BDSA-2019-1475",
    "title": "Serendipity Vulnerable to Stored Cross-site Scripting (XSS) via Mishandled EXIF Data in Editor Preview and Media Library Features",
    "description": "Serendipity is vulnerable to stored cross-site scripting (XSS) due to improper handling of EXIF tags in image files. This could allow an attacker to execute arbitrary JavaScript in the context of a blog author's browser.",
    "technicalDescription": "An attacker can exploit this by tricking an author of a blog into including an image with maliciously crafted EXIF tags. In the Media Properties section of the media library, the EXIF tag information is not properly escaped, leading to HTML or JavaScript contained in the tag being executed in the browser of an author that views the image properties.\n\nIf the crafted image was then used as part of a blogpost, even if properly escaped in the media properties section, the script would still get added to the blogpost unescaped, meaning that any author viewing the image properties in this section would also trigger the exploit.",
    "publishedDate": "2019-05-13T16:19:52.233Z",
    "updatedDate": "2019-05-13T16:23:00.877Z",
    "disclosureDate": "2019-03-07T00:00:00.000Z",
    "exploitPublishDate": "2019-03-08T00:00:00.000Z",
    "solution": "Fixed in version [**2.1.5**](https://github.com/s9y/Serendipity/releases/tag/2.1.5) by [this](https://github.com/s9y/Serendipity/commit/c310da1ffd566eb890a7f99f65ca5cbd9069908a) commit and [this](https://github.com/s9y/Serendipity/commit/a35aa1b5fa546c06fc0561b032eb0d3bbbc5cac7) commit.\n\nFixed in **[2.3-beta1](https://github.com/s9y/Serendipity/releases/tag/2.3-beta1)** by [this](https://github.com/s9y/Serendipity/commit/99b81901803093daa7bf60cfab6a72d8786d17c1) commit and [this](https://github.com/s9y/Serendipity/commit/eda8f71065342af2dda8339d3f39e7e8da752004) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Hanno B\u00f6ck",
    "workaround": "",
    "vendorFixDate": "2019-04-27T00:00:00.000Z",
    "vendorNotifiedDate": "2019-03-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1475",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11870",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1475/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/s9y/Serendipity/commit/99b81901803093daa7bf60cfab6a72d8786d17c1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/s9y/Serendipity/commit/a35aa1b5fa546c06fc0561b032eb0d3bbbc5cac7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/s9y/Serendipity/commit/c310da1ffd566eb890a7f99f65ca5cbd9069908a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/s9y/Serendipity/commit/eda8f71065342af2dda8339d3f39e7e8da752004",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/s9y/Serendipity/issues/598",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/s9y/Serendipity/issues/598",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/s9y/Serendipity/releases/tag/2.1.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/s9y/Serendipity/releases/tag/2.3-beta1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1475/default-remediation-status"
            }
        ]
    }
}