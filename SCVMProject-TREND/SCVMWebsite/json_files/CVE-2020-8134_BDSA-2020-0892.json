{
    "source": "BDSA",
    "name": "BDSA-2020-0892",
    "title": "Ghost Content Management System (CMS) Vulnerable to Server-Side Request Forgery (SSRF) via Improper Validation in 'oembed' Endpoint",
    "description": "Ghost content management system (CMS) is vulnerable to server side request forgery (SSRF). An attacker could exploit this to carry out arbitrary GET requests on the internal network that Ghost is hosted on.",
    "technicalDescription": "The `getOembedUrlFromHTML` and `isIpOrLocalhost` functions in the `oembed` endpoint improperly validate user-supplied URLs which are supposed to embed content from other sites. By including a crafted link to an attacker-controlled site, an attacker with published credentials can carry out SSRF on the internal server that Ghost is hosted on.",
    "publishedDate": "2020-04-24T14:41:54.081Z",
    "updatedDate": "2020-04-24T14:41:54.073Z",
    "disclosureDate": "2020-03-09T00:00:00.000Z",
    "exploitPublishDate": "2020-03-09T00:00:00.000Z",
    "solution": "Fixed in version [**2.38.1**](https://github.com/TryGhost/Ghost/tree/2.38.1) by [this](https://github.com/TryGhost/Ghost/commit/5efef45dd0d6d71af222e059eb514757fdcefb0e) commit and [this](https://github.com/TryGhost/Ghost/commit/a98579c2ef52e09349ee08f36a2a3e2e3670568a) commit.\n\nFixed by version [**3.10.0**](https://github.com/TryGhost/Ghost/tree/3.10.0) by [this](https://github.com/TryGhost/Ghost/commit/47739396705519a36018686894d1373e9eb92216) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.7,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nick Mykhailyshyn",
    "workaround": "",
    "vendorFixDate": "2020-03-03T00:00:00.000Z",
    "vendorNotifiedDate": "2020-02-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0892",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8134",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0892/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TryGhost/Ghost/commit/47739396705519a36018686894d1373e9eb92216",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TryGhost/Ghost/commit/5efef45dd0d6d71af222e059eb514757fdcefb0e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TryGhost/Ghost/commit/a98579c2ef52e09349ee08f36a2a3e2e3670568a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TryGhost/Ghost/releases/tag/3.10.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TryGhost/Ghost/tree/2.38.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/793704",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/793704",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0892/default-remediation-status"
            }
        ]
    }
}