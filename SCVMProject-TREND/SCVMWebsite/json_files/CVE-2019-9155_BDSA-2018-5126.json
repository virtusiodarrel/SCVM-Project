{
    "source": "BDSA",
    "name": "BDSA-2018-5126",
    "title": "OpenPGP.js Vulnerable to Invalid Curve Attack via Elliptic Curve Diffie-Hellman (ECDH) Key Exchange Implementation",
    "description": "OpenPGP.js is vulnerable to invalid curve attack due to the public key of the Elliptic Curve Diffie-Hellman (ECDH) key exchange not verifying the partner's public key is valid. This allows an attacker to recover the victims private key by submitting carefully crafted requests and identifying if decryption failed. An attacker could recover or modify communications of which used the victims private key via a man-in-the-middle attack.",
    "technicalDescription": "The `Curve.prototype.keyFromPublic` function in `src/crypto/public_key/elliptic/curves.js` does not check that the public key of the communication partner is a valid point on the elliptic curve, resulting in an alternative curve being used to calculate the secret key rather than the intended curve. This allows an attacker to identify the victims private key by choosing multiple altered curves and resulting public key, and observing whether decryption fails.",
    "publishedDate": "2020-03-11T19:26:37.825Z",
    "updatedDate": "2020-03-11T19:26:37.817Z",
    "disclosureDate": "2018-12-17T00:00:00.000Z",
    "exploitPublishDate": "2019-08-22T00:00:00.000Z",
    "solution": "Fixed in version [**4.3.0**](https://github.com/openpgpjs/openpgpjs/releases/tag/v4.3.0) by [this](https://github.com/openpgpjs/openpgpjs/commit/cb3f6447084672610f0132cc8f0a2dddcbf2c501) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wolfgang Ettlinger - SEC Consult Vulnerability Lab",
    "workaround": "",
    "vendorFixDate": "2018-12-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5126",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-310"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-325"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9155",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5126/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openpgpjs/openpgpjs/commit/cb3f6447084672610f0132cc8f0a2dddcbf2c501",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openpgpjs/openpgpjs/releases/tag/v4.3.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openpgpjs/openpgpjs/releases/tag/v4.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/154191/OpenPGP.js-4.2.0-Signature-Bypass-Invalid-Curve-Attack.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/154191/OpenPGP.js-4.2.0-Signature-Bypass-Invalid-Curve-Attack.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5126/default-remediation-status"
            }
        ]
    }
}