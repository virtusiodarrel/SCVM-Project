{
    "source": "BDSA",
    "name": "BDSA-2019-0292",
    "title": "Rssh Vulnerable to Remote Code Execution via 'allowscp' Bypass",
    "description": "Rssh is vulnerable to remote code execution (RCE) due to a flaw in the verification process of the scp functionality. An attacker with privileges to perform a secure copy of a file to the server can abuse the `PKCS11Provider` option to load and execute any code in that file.",
    "technicalDescription": "A flaw in the verification of the scp functionality can allow an attacker to bypass the `allowscp` setting intended to limit user permissions to copying files to and from the server. It is possible to pass additional arguments to the scp command which are not sufficiently checked on the server. One option, `PKCS11Provider`, can be used to load and execute code from a shared module. An attacker can abuse this functionality by firstly uploading a malicious `.so` file to the server and then supplying it as argument to scp:\n```\nssh rssh_user@host 'scp -o PKCS11Provider=./payload.so 1 localhost:\n```\nThis will execute the uploaded file, allowing arbitrary command execution on the underlying host.",
    "publishedDate": "2019-02-05T12:31:00.968Z",
    "updatedDate": "2019-03-08T14:07:31.611Z",
    "disclosureDate": "2019-01-16T00:00:00.000Z",
    "exploitPublishDate": "2019-01-16T00:00:00.000Z",
    "solution": "Fixed in **[rssh 2.3.4-9/2.3.4-5+deb9u1](https://salsa.debian.org/debian/rssh/tags)** on Debian by [this](https://salsa.debian.org/debian/rssh/commit/275de933b45a9df586f6b33eacbd3442f6e24218) commit.\n\n**NOTE**: upstream rssh is no longer maintained.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ESnet Security Team",
    "workaround": "",
    "vendorFixDate": "2019-01-29T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0292",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-1000018",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0292/ranges"
            },
            {
                "rel": "reference",
                "href": "https://esnet-security.github.io/vulnerabilities/20190115_rssh",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://salsa.debian.org/debian/rssh/commit/275de933b45a9df586f6b33eacbd3442f6e24218",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://salsa.debian.org/debian/rssh/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://sourceforge.net/p/rssh/mailman/message/36519118/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://tracker.debian.org/news/1025858/accepted-rssh-234-5deb9u1-source-amd64-into-stable-embargoed-stable/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0292/default-remediation-status"
            }
        ]
    }
}