{
    "source": "BDSA",
    "name": "BDSA-2020-2932",
    "title": "Xen Vulnerable to Denial-of-Service via Race Conditions in Superpage Mapping Process",
    "description": "Xen is vulnerable to denial-of-service (DoS) due to the existence of multiple race conditions that can occur during memory mapping operations. An attacker could cause a victim's instance of Xen to crash by tricking them into running a maliciously crafted guest.\n\nOnly x86 systems are affected by this vulnerability. ARM systems are not vulnerable. HVM and PVH guests can only exploit this issue when running in shadow mode on VT-x capable hardware.",
    "technicalDescription": "The Xen hypervisor uses so-called 'superpages' in order optimize its usage of the TLB. The management of these superpages adds additional, non-trivial overhead if robust locking is implemented. The code that manages these tables avoids ubiquitous locking operations in order to avoid this overhead. This causes the existence of several race conditions. A malicious guest that uses pass-through devices can carry out precisely timed operations in order to trigger these race conditions, which can cause the hypervisor to crash. An attacker could therefore cause a DoS by tricking a victim into running such a guest.\n\nOnly x86 systems are affected by this vulnerability. ARM systems are not vulnerable. HVM and PVH guests can only exploit this issue when running in shadow mode on VT-x capable hardware.",
    "publishedDate": "2020-10-22T15:43:17.729Z",
    "updatedDate": "2021-10-20T09:01:19.256Z",
    "disclosureDate": "2020-10-20T00:00:00.000Z",
    "solution": "Fixed in [**4.13.2**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.2) by the following commits:\n* [Commit 1](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=98ec9711e5263350e19753edde6f922535e41744)\n* [Commit 2](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7f5d6760b6e5e710846c50b5c2dbdd094872d3bc)\n* [Commit 3](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=a2c0c91b3ee265a710ba2d5cfc3b0fc90930ed0b)\n\nFixed in [**4.12.4**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.12.4) by the following commits:\n* [Commit 1](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e461318da32774df4d6b7c1337a70d731833f00b)\n* [Commit 2](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1cec2531fbb221abf533187153ca0676155f34d5)\n* [Commit 3](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=03926de91c2e92ded7cfea227aee17486d745225)\n\nFixed in [**4.14.1**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.1) by the following commits:\n* [Commit 1](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=9e757fcdbb758ae2d0459bcaabc8ff6cf505a43d)\n* [Commit 2](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=809a70b161ca0adaed0ef198e2b86e846f9de442)\n* [Commit 3](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b4271092f29ab105b53e026a243310926b59c076)\n\nFixed by the following commits in the **stable-4.11** branch, which have not yet been included in any release:\n* [Commit 1](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=f5ec9f287d00af28b2939c0f628c25c31ebefd18)\n* [Commit 2](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ad7d04055ea50177bcfdc471ad3bb6e819ec60e0)\n* [Commit 3](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7912bbe636ef5c9db61c193182c7937a820b7c2b)\n\nFixed by the following commits in the **stable-4.10** branch, which have not yet been included in any release:\n* [Commit 1](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=75a05daf1ddfc0057bd9eeedfd1d872bb47faeda)\n* [Commit 2](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=c334b87cef3d923002705838d843ae604650d8c1)\n* [Commit 3](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=07ad8ff3b84771257b36545af8192171eabbd8ac)\n\nThe latest stable releases are available [here](https://xenproject.org/downloads/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.1,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Hongyan Xia (Amazon)",
    "workaround": "The vendor states that the following workaround can be implemented:\n\n> Running all guests in HVM or PVH mode, in each case with HAP enabled, prevent those guests from exploiting the vulnerability.",
    "vendorFixDate": "2020-10-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2932",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27672",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2932/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.12.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=03926de91c2e92ded7cfea227aee17486d745225",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=07ad8ff3b84771257b36545af8192171eabbd8ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1cec2531fbb221abf533187153ca0676155f34d5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=75a05daf1ddfc0057bd9eeedfd1d872bb47faeda",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7912bbe636ef5c9db61c193182c7937a820b7c2b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7f5d6760b6e5e710846c50b5c2dbdd094872d3bc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=809a70b161ca0adaed0ef198e2b86e846f9de442",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=98ec9711e5263350e19753edde6f922535e41744",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=9e757fcdbb758ae2d0459bcaabc8ff6cf505a43d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=a2c0c91b3ee265a710ba2d5cfc3b0fc90930ed0b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ad7d04055ea50177bcfdc471ad3bb6e819ec60e0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b4271092f29ab105b53e026a243310926b59c076",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=c334b87cef3d923002705838d843ae604650d8c1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e461318da32774df4d6b7c1337a70d731833f00b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=f5ec9f287d00af28b2939c0f628c25c31ebefd18",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-345.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-345.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2932/default-remediation-status"
            }
        ]
    }
}