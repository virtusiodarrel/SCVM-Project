{
    "source": "BDSA",
    "name": "BDSA-2019-1454",
    "title": "PharStreamWrapper Vulnerable to Deserialization Protection Bypass via PharMetaDataInterceptor",
    "description": "The PharMetaDataIntereceptor in PharStreamWrapper mishandles Phar stub parsing for TYPO3. This could allow a remote attacker to bypass a deserialization protection mechanism.",
    "technicalDescription": "The vulnerable file is `src/Phar/Reader.php`. Due to differences in the handling of how PHP Phar detects the end of a Phar stub in comparison to the Phar parser, it is possible to circumvent the deserialization protection in the PharMetaDataInterceptor. Successfully exploiting could lead to an attacker bypassing protections to prevent the deserialization of unwanted code.",
    "publishedDate": "2019-05-15T14:57:57.619Z",
    "updatedDate": "2020-08-04T12:05:00.783Z",
    "disclosureDate": "2019-03-31T00:00:00.000Z",
    "solution": "Fixed in \n\n* **[2.1.1](https://github.com/TYPO3/phar-stream-wrapper/releases/tag/v2.1.1)** by [this](https://github.com/TYPO3/phar-stream-wrapper/commit/f7df5c56e18a74f55af95177d3d2605365c53dc6) commit,\n* **[3.1.1](https://github.com/TYPO3/phar-stream-wrapper/releases/tag/v3.1.1)** by [this](https://github.com/TYPO3/phar-stream-wrapper/commit/ccce11b962007d87b64b1b1dbe063a32ff7ace79) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tom Klingenberg",
    "workaround": "",
    "vendorFixDate": "2019-03-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1454",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11830",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1454/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/phar-stream-wrapper/commit/ccce11b962007d87b64b1b1dbe063a32ff7ace79",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/phar-stream-wrapper/issues/24",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/phar-stream-wrapper/releases/tag/v2.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/phar-stream-wrapper/releases/tag/v3.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-psa-2019-008/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1454/default-remediation-status"
            }
        ]
    }
}