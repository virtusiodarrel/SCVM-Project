{
    "source": "BDSA",
    "name": "BDSA-2020-4493",
    "title": "json NPM Package Vulnerable to Command Injection when Parsing 'lookup' Strings",
    "description": "json is vulnerable to command injection due to insecure parsing of any user-provided bracketed lookup string. An attacker can include system commands into the bracketed string which will subsequently be executed on the server.",
    "technicalDescription": "The vulnerability lies in the `parseLookup()` function in  `/lib/json.js` where user-provided bracketed expressions are not checked before being evaluated via `vm.runInNewContext`.  An attacker can use a specially crafted lookup string to exploit this to cause arbitrary commands to be executed on the server that could, for example, expose sensitive information.\n \nThis vulnerability has been fixed by limiting the allowed bracketed lookup syntax.",
    "publishedDate": "2021-06-30T11:38:48.160Z",
    "updatedDate": "2021-06-30T11:38:48.154Z",
    "disclosureDate": "2020-08-23T00:00:00.000Z",
    "exploitPublishDate": "2020-08-23T00:00:00.000Z",
    "solution": "Fixed in [**10.0.0**](https://github.com/trentm/json/tree/10.0.0) with [this](https://github.com/trentm/json/commit/cc4798169f9e0f181f8aa61905b88479badcd483) commit.\n\nThe latest releases are available [here](https://github.com/trentm/json/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "posix-lee",
    "workaround": "",
    "vendorFixDate": "2020-08-23T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4493",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7712",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4493/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/trentm/json/commit/cc4798169f9e0f181f8aa61905b88479badcd483",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/trentm/json/issues/144",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/trentm/json/issues/144",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/trentm/json/pull/145",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/trentm/json/tags",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/trentm/json/tree/10.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4493/default-remediation-status"
            }
        ]
    }
}