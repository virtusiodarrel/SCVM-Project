{
    "source": "BDSA",
    "name": "BDSA-2021-1803",
    "title": "Silverstripe Vulnerable to Uploaded File Validation Bypass via Square Brackets in Field Name",
    "description": "It is possible to create form fields in Silverstripe that would allow attackers to bypass the built-in validation when uploading files.",
    "technicalDescription": "Creating a `FileField` with a name that contains square brackets causes PHP to interpret the name as multiple values. This allows multiple files to be used in the field (which is unsupported) and also skips the security validations preventing the `FileField->saveInto()` routine from being run. If a custom controller logic relies on the Form system to provide validation, it will fail. The vendor notes that this issue is only for the `FileField`, not the `UploadField` which is used within the content management system (CMS).",
    "publishedDate": "2021-06-16T14:35:24.201Z",
    "updatedDate": "2021-06-16T14:35:24.195Z",
    "disclosureDate": "2021-06-08T00:00:00.000Z",
    "exploitPublishDate": "2021-06-08T00:00:00.000Z",
    "solution": "Fixed in **[4.8.0](https://github.com/silverstripe/silverstripe-framework/releases/tag/4.8.0)** by [this](https://github.com/silverstripe/silverstripe-framework/commit/802455137) commit and in **[4.7.4](https://github.com/silverstripe/silverstripe-framework/releases/tag/4.7.4)** by [this](https://github.com/silverstripe/silverstripe-framework/commit/06dbd5237) commit.\n\nThe latest stable releases are available [here](https://www.silverstripe.org/download/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.7,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.2,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dylan Wagstaff, Silverstripe",
    "workaround": "",
    "vendorFixDate": "2021-06-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1803",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-26138",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1803/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/commit/802455137",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/4.8.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.silverstripe.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.silverstripe.org/download/security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.silverstripe.org/download/security-releases/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1803/default-remediation-status"
            }
        ]
    }
}