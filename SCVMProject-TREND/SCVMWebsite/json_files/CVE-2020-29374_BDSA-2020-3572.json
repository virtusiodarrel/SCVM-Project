{
    "source": "BDSA",
    "name": "BDSA-2020-3572",
    "title": "Linux Kernel Vulnerable to Information Disclosure via Unsafe 'get_user_pages()' Implementation",
    "description": "The Linux kernel is vulnerable to information disclosure due to mismanaging memory after duplicating (forking) processes. A local attacker could manipulate system calls to leak information from other processes.",
    "technicalDescription": "Information may get disclosed from processes that belong to the same parent process as the malicious process. The malicious process could save a counted reference to its parent's page and drop it from its page tables. The Copy-on-Write (COW) handler would notice this and would grant the parent process write access to the original page. The write access to the original page could then be passed on to a legitimate forked process, which could write some secret data in it. The malicious process could then read the secret data because performing a read on a COW page does not break its clean COW status.\n\nThis issue was fixed by forcing the underlying kernel function `get_user_pages()` (in `mm/gup.c`) to break COW when getting a COW-mapped page so that it does not return pages that are no longer associated with the original virtual memory.",
    "publishedDate": "2020-12-01T10:50:53.734Z",
    "updatedDate": "2021-11-15T12:27:58.559Z",
    "disclosureDate": "2020-11-16T00:00:00.000Z",
    "exploitPublishDate": "2020-11-16T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.289**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=58facc9c7ae307be5ecffc1697552550fedb55bd) commit\n* [**4.9.287**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9bbd42e79720122334226afad9ddcac1c3e6d373) commit\n* [**4.14.232**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=407faed92b4a4e2ad900d61ea3831dd597640f29) commit\n* [**4.19.189**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=5e24029791e809d641e9ea46a1f99806484e53fc) commit\n* [**5.4.47**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1027dc04f557328eb7b7b7eea48698377a959157) commit\n* [**5.6.19**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=465121c2c982c9438b6760c2161b50bec603c6e1) commit\n* [**5.7.3**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8e45fdafdecc8436c5b6e1620c30726056e6b29c) commit\n* [**5.8-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=17839856fd588f4ab6b789f482ed3ffd7c403e1f) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.7
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn, Google Project Zero",
    "workaround": "",
    "vendorFixDate": "2020-06-02T00:00:00.000Z",
    "vendorNotifiedDate": "2020-05-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3572",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-267"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-29374",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3572/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=2045",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=2045",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1027dc04f557328eb7b7b7eea48698377a959157",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=407faed92b4a4e2ad900d61ea3831dd597640f29",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=465121c2c982c9438b6760c2161b50bec603c6e1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=58facc9c7ae307be5ecffc1697552550fedb55bd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=5e24029791e809d641e9ea46a1f99806484e53fc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8e45fdafdecc8436c5b6e1620c30726056e6b29c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9bbd42e79720122334226afad9ddcac1c3e6d373",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=17839856fd588f4ab6b789f482ed3ffd7c403e1f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=17839856fd588f4ab6b789f482ed3ffd7c403e1f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3572/default-remediation-status"
            }
        ]
    }
}