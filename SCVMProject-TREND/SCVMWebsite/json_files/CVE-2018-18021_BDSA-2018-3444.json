{
    "source": "BDSA",
    "name": "BDSA-2018-3444",
    "title": "Linux Kernel Vulnerable to Privilege Escalation by 'Taking Control' of KVM Hypervisor",
    "description": "A privilege escalation vulnerability has been discovered in the Linux Kernel. Register accesses that span multiple registers can bypass kernel sanity checking. A user with permissions to create virtual machines can trigger an error causing the hypervisor to redirect the executions to another location while granting full register control. An attacker could exploit this vulnerability to gain elevated privileges and execute malicious actions.\n\nThis issue only affects `arm 64-bit` architecture.",
    "technicalDescription": "The function `validate_core_offset` located in file `arch/arm64/kvm/guest.c` does not validate the core register file access permissions for guest. Userspace is able to access the core register file without any restrictions. This can cause an issue as unaligned register accesses or accesses which span multiple registers can bypass the `PSTATE` sanity check executed in `KVM_SET_ON_REG ioctl() `. The sanity check fails to determine the configuration difference between the physical and the virtual CPU. \n\nUsers with permissions to create KVM-based virtual machines (VM) can cause kernel panic by triggering an illegal exception return which will result in a denial-of-service(DoS) condition.  It is also possible for guest machines to redirect execution elsewhere within the hypervisor which has full register control instead of returning to guest. This impact is limited by which execution modes are available to guest and what compatibility features the hardware virtualization supports.",
    "publishedDate": "2018-10-05T14:38:05.002Z",
    "updatedDate": "2018-10-10T13:51:18.458Z",
    "disclosureDate": "2018-10-02T00:00:00.000Z",
    "solution": "Fixed in version [**4.18.12**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a3f93459d689d990b3ecfbe782fec89b97d3279)  and [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d26c25a9d19b5976b319af528886f89cf455692d) git commit.\n\nThis has been cherry-picked and back ported to:\n* [**4.9.131**](https://www.kernel.org)\n* [**4.9.132**](https://www.kernel.org)\n* [**4.14.74**](https://www.kernel.org)\n* [**4.14.75**](https://www.kernel.org)\n* [**4.4.160**](https://www.kernel.org)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:L/AC:L/Au:N/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Will Deacon",
    "workaround": "",
    "vendorFixDate": "2018-09-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3444",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-18021",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3444/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a3f93459d689d990b3ecfbe782fec89b97d3279",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d26c25a9d19b5976b319af528886f89cf455692d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/patchwork/patch/994598/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2018/q4/4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}