{
    "source": "BDSA",
    "name": "BDSA-2021-2041",
    "title": "GitLab Vulnerable to Cross-Site Request Forgery (CSRF) 'Mutations' Abuse via Insufficient Validation in GraphQL API",
    "description": "GitLab is vulnerable to a cross-site request forgery (CSRF) issue that allows mutations to be called due to a lack of sufficient validation. \n\nAn attacker could trick an authenticated victim user into accessing an attacker controlled site and send a GitLab GraphQL API request on the victim's behalf in order to execute mutations.",
    "technicalDescription": "The GraphQL API is GitLab is vulnerable to a cross-site request forgery (CSRF) issue that allows an attacker to call mutations as a victim user because the API does not validate what HTTP request method is used for this functionality.\n\nTo remedy this issue, the vendor has made changes to the to the GraphQL API in order to restrict mutations from being carried out when a `GET` request is used.",
    "publishedDate": "2021-07-08T12:51:45.691Z",
    "updatedDate": "2022-04-11T13:49:58.026Z",
    "disclosureDate": "2021-07-06T00:00:00.000Z",
    "exploitPublishDate": "2021-08-02T00:00:00.000Z",
    "solution": "Fixed in [**13.12.6**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.12.6) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/6e99894dbc9836bb9e97fcf98c7646cde175e9dd) commit and  [**14.0.2**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.0.2) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/c31c9f964a81f104f4c265b6082b469361fb1653) commit.\n\nThe latest stable releases are available [here](https://gitlab.com/gitlab-org/gitlab-foss/-/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.3,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.1,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "az3z3l",
    "workaround": "",
    "vendorFixDate": "2021-07-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2041",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22224",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2041/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2021/07/01/security-release-gitlab-14-0-2-released/#csrf-on-graphql-api-allows-executing-mutations-through-get-requests",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-22224.json",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/6e99894dbc9836bb9e97fcf98c7646cde175e9dd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/c31c9f964a81f104f4c265b6082b469361fb1653",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.12.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1122408",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2041/default-remediation-status"
            }
        ]
    }
}