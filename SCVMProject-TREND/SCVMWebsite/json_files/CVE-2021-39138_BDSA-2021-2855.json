{
    "source": "BDSA",
    "name": "BDSA-2021-2855",
    "title": "Parse Server Vulnerable to Improper Authentication via Flawed 'authProvider' Usage",
    "description": "Parse Server is vulnerable to an improper authentication issue due to how the `authProvider` field under `createdWith` can incorrectly indicate that a session was created using a username and password when it was an anonymous session.\n\nThis flaw could cause issues later if the field is relied upon to make authentication decisions, meaning that anonymous users could appear as if they have logged in with a username and password.\n\n**Note**: As stated by the vendor [here](https://github.com/parse-community/parse-server/security/advisories/GHSA-23r4-5mxp-c7g5), this issue only affects users/developers who depend on `createdWith` directly.",
    "technicalDescription": "Parse Server is vulnerable to improper authentication because the `authProvider` field in `_Session` class under `createdWith` shows anonymous users as if they have logged in creating a password. In this case, the `authProvider` property is set to `password`, where it should otherwise be `authProvider: anonymous`. \n\nThe vendor has stated [here](https://github.com/parse-community/parse-server/security/advisories/GHSA-23r4-5mxp-c7g5) that the applied fix will set the correct `authProvider: anonymous` for future sign-ups of anonymous users, however, the fix does not remedy incorrect instances of `authProvider: password` for existing sessions of anonymous users. Users should take care if the application logic depends on the `authProvider` (or `createdWith`) field.",
    "publishedDate": "2021-09-27T14:21:03.361Z",
    "updatedDate": "2021-09-27T14:21:03.349Z",
    "disclosureDate": "2021-08-18T00:00:00.000Z",
    "solution": "Fixed in [**4.5.2**](https://github.com/parse-community/parse-server/releases/tag/4.5.2) by [this](https://github.com/parse-community/parse-server/commit/1306da7454035ac6592c66741a7b89882a9c701e) commit.\n\nThe latest stable releases are available [here](https://github.com/parse-community/parse-server/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Corey Baker",
    "workaround": "The vendor has stated [here](https://github.com/parse-community/parse-server/security/advisories/GHSA-23r4-5mxp-c7g5) that if anonymous logins are allowed, the `createdWith` session field should not be used to make decisions.",
    "vendorFixDate": "2021-08-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2855",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39138",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2855/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/1306da7454035ac6592c66741a7b89882a9c701e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases/tag/4.5.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/security/advisories/GHSA-23r4-5mxp-c7g5",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/security/advisories/GHSA-23r4-5mxp-c7g5",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2855/default-remediation-status"
            }
        ]
    }
}