{
    "source": "BDSA",
    "name": "BDSA-2022-0144",
    "title": "Umbraco Vulnerable to Account Takeover via Password Reset URL Manipulation",
    "description": "A vulnerability has been found in Umbraco whereby it is possible to overwrite the password reset URL via the host header. An unauthenticated remote attacker could exploit this by pointing the URL to a malicious server in order to view the password reset token once the link has been followed. This could lead to subsequent account takeover attacks.",
    "technicalDescription": "This issue occurs because `UmbracoApplicationUrl` or `ApplicationUrl` configuration element is used in instances where the application code needs to construct a URL pointing back to the site such as when a password reset is required. If this element has not been specifically set, then its value can be manipulated.\n\nMitigations for **CVE-2022-22690**, a related vulnerability which may allow an attacker to persistently overwrite the `UmbracoApplicationUrl`, mean that the likelihood of successfully exploiting this attack is lessened because the password reset process would now have to be invoked on behalf of the user and thus would likely occur unexpectedly as opposed to upon request by the user.",
    "publishedDate": "2022-01-20T12:38:17.349Z",
    "updatedDate": "2022-08-30T09:43:11.197Z",
    "disclosureDate": "2022-01-18T00:00:00.000Z",
    "exploitPublishDate": "2022-01-18T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "UNCORROBORATED",
            "score": 4.1
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:W/RC:UR)"
    },
    "cvss3": {
        "baseScore": 8.3,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.6,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "REASONABLE",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:W/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "AppCheck",
    "workaround": "As a workaround specifically set the `UmbracoApplicationUrl` within the Umbraco Configuration. Alternatively, specifying a specific hostname within the IIS bindings will prevent this vulnerability from being exploited.",
    "vendorNotifiedDate": "2021-07-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0144",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-640"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-22691",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0144/ranges"
            },
            {
                "rel": "reference",
                "href": "https://appcheck-ng.com/umbraco-applicationurl-overwrite-persistent-password-reset-poison-cve-2022-22690-cve-2022-22691/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://appcheck-ng.com/umbraco-applicationurl-overwrite-persistent-password-reset-poison-cve-2022-22690-cve-2022-22691/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://appcheck-ng.com/umbraco-applicationurl-overwrite-persistent-password-reset-poison-cve-2022-22690-cve-2022-22691/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0144/default-remediation-status"
            }
        ]
    }
}