{
    "source": "BDSA",
    "name": "BDSA-2022-1164",
    "title": "nconf Vulnerable to Prototype Pollution via 'set' Function",
    "description": "nconf is vulnerable to prototype pollution due to insufficient input validation within the memory engine. This could allow an attacker to maliciously modify object prototypes, which depending on how objects are used by an application, could cause impacts such as denial-of-service (DoS), cross-site scripting (XSS) or remote code execution (RCE).",
    "technicalDescription": "The issue exists with the `set()` function within the file `lib/nconf/stores/memory.js`, which sets properties for stored nested JSON configurations. Insufficient input validation can allow this function to be exploited to perform malicious `Object.prototype` modifications.",
    "publishedDate": "2022-04-28T08:40:59.788Z",
    "updatedDate": "2022-04-28T08:47:23.929Z",
    "disclosureDate": "2022-04-12T00:00:00.000Z",
    "exploitPublishDate": "2022-04-12T00:00:00.000Z",
    "solution": "Fixed in version [**0.11.4**](https://github.com/indexzero/nconf/releases/tag/v0.11.4) by [this](https://github.com/indexzero/nconf/commit/feaba562b812b21215897f71b0c8b3bf39cf8d7d) commit.\n\nThe latest stable releases are available [here](https://github.com/indexzero/nconf/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alessio Della Libera (Snyk Research Team)",
    "workaround": "",
    "vendorFixDate": "2022-04-10T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1164",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-21803",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1164/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/indexzero/nconf/commit/feaba562b812b21215897f71b0c8b3bf39cf8d7d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/indexzero/nconf/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/indexzero/nconf/releases/tag/v0.11.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-NCONF-2395478",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-NCONF-2395478",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1164/default-remediation-status"
            }
        ]
    }
}