{
    "source": "BDSA",
    "name": "BDSA-2021-4119",
    "title": "Python Vulnerable to Cross-Site Scripting (XSS) via Improper Newline Character Handling",
    "description": "Python is vulnerable to cross-site scripting (XSS) due to the `urllib.parse` module's improper handling of newline characters. An attacker could potentially leverage this issue in order to inject malicious scripts into dynamically generated web content. This could potentially allow the attacker to obtain sensitive information, such as browser cookies.",
    "technicalDescription": "The `urllib.parse` module is implemented using code that is contained in the file `Lib/urllib/parse.py`. This module's sanitization functionality incorrectly handles newline and tab characters that reside in the path component of the URL which is being processed. If a server uses the `urllib.parse` module to process untrusted input, then an attacker could potentially inject malicious JavaScript into web content that is dynamically generated by that server.\n\nThe vulnerability was fixed via the addition of the `_remove_unsafe_bytes_from_url()` method, which is invoked within the `urlsplit()` method in order to remove problematic characters.",
    "publishedDate": "2022-02-10T16:39:55.823Z",
    "updatedDate": "2022-08-12T08:22:33.585Z",
    "disclosureDate": "2021-04-18T00:00:00.000Z",
    "exploitPublishDate": "2021-04-18T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.10.0-b1**](https://github.com/python/cpython/releases/tag/v3.10.0b1) by [this](https://github.com/python/cpython/commit/76cd81d60310d65d01f9d7b48a8985d8ab89c8b4) commit.\n* [**3.9.5**](https://github.com/python/cpython/releases/tag/v3.9.5) by [this](https://github.com/python/cpython/commit/491fde0161d5e527eeff8586dd3972d7d3a631a7) commit.\n* [**3.8.11**](https://github.com/python/cpython/releases/tag/v3.8.11) by [this](https://github.com/python/cpython/commit/515a7bc4e13645d0945b46a8e1d9102b918cd407) commit.\n* [**3.7.11**](https://github.com/python/cpython/releases/tag/v3.7.11) by [this](https://github.com/python/cpython/commit/f4dac7ec55477a6c5d965e594e74bd6bda786903) commit.\n* [**3.6.14**](https://github.com/python/cpython/releases/tag/v3.6.14) by [this](https://github.com/python/cpython/commit/6c472d3a1d334d4eeb4a25eba7bf3b01611bf667) commit.\n\n\nThe latest stable releases are available [here](https://github.com/python/cpython/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-4119",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-229"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2022-0391",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-4119/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue43882",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue43882",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/491fde0161d5e527eeff8586dd3972d7d3a631a7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/515a7bc4e13645d0945b46a8e1d9102b918cd407",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/5751a22ede6a1c40f3926439e6c8368889f9b8d2",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/6c472d3a1d334d4eeb4a25eba7bf3b01611bf667",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/76cd81d60310d65d01f9d7b48a8985d8ab89c8b4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/f4dac7ec55477a6c5d965e594e74bd6bda786903",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.10.0b1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.6.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.7.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.8.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.9.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/tags",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}