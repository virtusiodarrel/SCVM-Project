{
    "source": "BDSA",
    "name": "BDSA-2020-0277",
    "title": "Dojox Vulnerable to Cross-site Scripting (XSS) via Insufficient Validation in 'dojox.xmpp.util.xmlEncode' Function",
    "description": "dojox contains cross-site scripting (XSS) vulnerability due to insufficient validation of user controlled input. This could allow a remote attacker to execute arbitrary code in a victim's browser which could steal cookie-based session cookies or credentials. The link containing the malicious code must be clicked by the victim.",
    "technicalDescription": "The `dojox.xmpp.util.xmlEncode` function in the file `xmpp/util.js` does not sufficiently validate user-controlled input. The function will replace only the first instance of a number of potentially dangerous characters with the HTML entity encoded version. This means that any further instances of the same potentially dangerous characters will not be encoded. An attacker needs to supply at least two of these dangerous characters to be able to then use them as part of an exploit.",
    "publishedDate": "2020-02-18T12:27:47.817Z",
    "updatedDate": "2020-02-18T12:27:47.810Z",
    "disclosureDate": "2020-02-03T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**1.16.1**](https://github.com/dojo/dojox/releases/tag/1.16.1) by [this](https://github.com/dojo/dojox/commit/c697f10b6dd519f92d19b375bb7316d57ed136b0) commit,\n* [**1.15.2**](https://github.com/dojo/dojox/releases/tag/1.15.2) by [this](https://github.com/dojo/dojox/commit/b27953ada05ebe6b9458562adbb70a61989f87b7) commit,\n* [**1.14.5**](https://github.com/dojo/dojox/releases/tag/1.14.5) by [this](https://github.com/dojo/dojox/commit/cf8e20f35b00e7cf8ffbf108c67edfd003f7180f) commit,\n* [**1.13.6**](https://github.com/dojo/dojox/releases/tag/1.13.6) by [this](https://github.com/dojo/dojox/commit/a981b0d8da2eac5b7c7e1c56ccd0104258cf4387) commit,\n* [**1.12.7**](https://github.com/dojo/dojox/releases/tag/1.12.7) by [this](https://github.com/dojo/dojox/commit/ce595a1c0c2b4e42262dba8f98759e574a6e32c8) commit, \n* [**1.11.9**](https://github.com/dojo/dojox/releases/tag/1.11.9) by [this](https://github.com/dojo/dojox/commit/017b4b9c1bfcca01ae4b37dd4935a1f68c39ba7c) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-02-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0277",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10785",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0277/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/commit/017b4b9c1bfcca01ae4b37dd4935a1f68c39ba7c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/commit/a981b0d8da2eac5b7c7e1c56ccd0104258cf4387",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/commit/b27953ada05ebe6b9458562adbb70a61989f87b7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/commit/c697f10b6dd519f92d19b375bb7316d57ed136b0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/commit/ce595a1c0c2b4e42262dba8f98759e574a6e32c8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/commit/cf8e20f35b00e7cf8ffbf108c67edfd003f7180f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/pull/315",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/releases/tag/1.11.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/releases/tag/1.12.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/releases/tag/1.13.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/releases/tag/1.14.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/releases/tag/1.15.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/releases/tag/1.16.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dojo/dojox/security/advisories/GHSA-pg97-ww7h-5mjr",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0277/default-remediation-status"
            }
        ]
    }
}