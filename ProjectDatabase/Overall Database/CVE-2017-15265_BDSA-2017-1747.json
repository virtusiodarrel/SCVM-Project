{
    "source": "BDSA",
    "name": "BDSA-2017-1747",
    "title": "Linux kernel: alsa: Use-After-Free in /dev/snd/seq",
    "description": "A race condition that leads to a use-after-free vulnerability in the alsa sound system for the Linux kernel can be exploited by an attacker to cause denial of service or execution of arbitrary code.",
    "technicalDescription": "`snd_seq_create_port()` is executed via a user controlled ioctl. This code does not take a reference count to an object that it creates on the kernel heap and therefore opens up a race condition that allows another attacker controlled thread to delete the object.  When the object is deleted and freed, another object that can be determined by an attacker can be created in its place.  The initial thread that created the first object will run 'snd_seq_system_client_ev_port_start()' on memory now controlled by the attacker, allowing them to overwrite or read memory that can lead to arbitrary code execution in the context of the kernel.",
    "publishedDate": "2017-10-13T11:40:13.812Z",
    "updatedDate": "2018-10-03T07:02:06.186Z",
    "disclosureDate": "2017-10-09T00:00:00.000Z",
    "solution": "[Fixed](https://www.kernel.org) in versions:\n**3.2.95**\n**3.10.108**\n**3.16.50**\n**3.18.76**\n**4.1.46**\n**4.4.93**\n**4.9.57**\n**4.13.8**\n**4.14-rc5**\n**4.15-rc1**\n\nAlternatively apply the [patch](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/sound/core/seq/seq_clientmgr.c?id=71105998845fb012937332fe2e806d443c09e026)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "TEMPORARY_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:TF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.0,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "TEMPORARY_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:U/RL:T/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ADLab of venustech",
    "workaround": "",
    "vendorFixDate": "2017-10-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1747",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-15265",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1747/ranges"
            },
            {
                "rel": "reference",
                "href": "http://mailman.alsa-project.org/pipermail/alsa-devel/2017-October/126292.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/show_bug.cgi?id=1062520",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/sound/core/seq/seq_clientmgr.c?id=71105998845fb012937332fe2e806d443c09e026",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}