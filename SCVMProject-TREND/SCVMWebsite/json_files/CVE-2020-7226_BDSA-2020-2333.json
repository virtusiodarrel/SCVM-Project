{
    "source": "BDSA",
    "name": "BDSA-2020-2333",
    "title": "Cryptacular Vulnerable to Denial-of-Service (DoS) via Excessive Memory Allocation in 'decode()' Function",
    "description": "Cryptacular is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker can take advantage of this by triggering excessive memory allocation during a decode operation, causing the system to crash.",
    "technicalDescription": "This vulnerability exists in the `decode()` function in the `src/main/java/org/cryptacular/CiphertextHeader.java` file of Cryptacular.\n\nDuring the decode operation the `nonce` array length which is associated with `new byte[]` can depend on an untrusted input within the encoded data header, allowing it to exceed the maximum allocated memory. An attacker can take advantage of this by controlling the `new byte[]` attribute and triggering excessive memory allocation during a decode operation, causing the system to crash.\n\nThe vendor has mitigated against this by defining a new header which allocates memory after HMAC checks, which guards against untrusted input. In order to preserve backwards compatibility, the vendor has hardened the decode process in the old header which implements restrictions on the `nonce` size.",
    "publishedDate": "2020-09-11T10:13:43.499Z",
    "updatedDate": "2020-11-09T09:41:42.086Z",
    "disclosureDate": "2020-01-19T00:00:00.000Z",
    "solution": "Fixed in [**1.2.4**](https://github.com/vt-middleware/cryptacular/releases/tag/v1.2.4) by the following commits:\n* [Commit 1](https://github.com/vt-middleware/cryptacular/commit/8c6c7528f1e24c6b71f3e36db0cb8a697256ce25)\n* [Commit 2](https://github.com/vt-middleware/cryptacular/commit/132f15ead532d78d4c19d2bcb39ec8f319ad6945)\n* [Commit 3](https://github.com/vt-middleware/cryptacular/commit/00395c232cdc62d4292ce27999c026fc1f076b1d)\n\nFixed in **[1.1.4](https://github.com/vt-middleware/cryptacular/releases/tag/v1.1.4)** by the following commits:\n* [Commit 1](https://github.com/vt-middleware/cryptacular/commit/4a838e149341772380f2db79a36df9057b02ac2a)\n* [Commit 2](https://github.com/vt-middleware/cryptacular/commit/57a8bf8e9c3878fc76634ff7c9473934fc416315)\n* [Commit 3](https://github.com/vt-middleware/cryptacular/commit/09425c2fece76586f1757f86f42826a6b7064bc2)\n* [Commit 4](https://github.com/vt-middleware/cryptacular/commit/c8a773d1700ec553e66c54905b021140b438098b)\n* [Commit 5](https://github.com/vt-middleware/cryptacular/commit/c2e8f5d7c673d28c9fbe3a67a3d766cb4822d8c0)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-01-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2333",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7226",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2333/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/commit/00395c232cdc62d4292ce27999c026fc1f076b1d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/commit/09425c2fece76586f1757f86f42826a6b7064bc2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/commit/132f15ead532d78d4c19d2bcb39ec8f319ad6945",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/commit/4a838e149341772380f2db79a36df9057b02ac2a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/commit/57a8bf8e9c3878fc76634ff7c9473934fc416315",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/commit/8c6c7528f1e24c6b71f3e36db0cb8a697256ce25",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/commit/c2e8f5d7c673d28c9fbe3a67a3d766cb4822d8c0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/commit/c8a773d1700ec553e66c54905b021140b438098b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/issues/52",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/pull/53",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/pull/56",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/releases/tag/v1.1.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vt-middleware/cryptacular/releases/tag/v1.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2333/default-remediation-status"
            }
        ]
    }
}