{
    "source": "BDSA",
    "name": "BDSA-2021-2888",
    "title": "Node.js 'remark-html' Package Vulnerable to Unsafe Default HTML Parsing Leading to Potential Cross-Site Scripting (XSS) Attacks",
    "description": "remark-html can potentially leave applications open to cross-site scripting (XSS) attacks due to how the remark-html documentation is misleading.\n\nThe documentation states that remark-html is safe by default, however, this is not the case and users must opt into this feature. This could mean that arbitrary HTML can be passed through without sufficient sanitization and lead to cross-site scripting (XSS) attacks.",
    "technicalDescription": "In order to remedy this issue, the vendor has made changes throughout `index.js` to ensure that the `sanitize` option is enabled by default and matches the documentation.",
    "publishedDate": "2021-09-29T14:23:04.272Z",
    "updatedDate": "2021-09-29T14:23:04.258Z",
    "disclosureDate": "2021-09-07T00:00:00.000Z",
    "solution": "Fixed in [**14.0.1**](https://github.com/remarkjs/remark-html/releases/tag/14.0.1) by [this](https://github.com/remarkjs/remark-html/commit/b75c9dde582ad87ba498e369c033dc8a350478c1) commit, and [**13.0.2**](https://github.com/remarkjs/remark-html/releases/tag/13.0.2) by [this](https://github.com/remarkjs/remark-html/commit/b0b1ba5c55a58b26bbe1ca3b6def18e95dbbd89e) commit.\n\nThe latest stable releases are available [here](https://www.npmjs.com/package/remark-html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matthieu Sieben",
    "workaround": "The vendor has stated [here](https://github.com/remarkjs/remark-html/security/advisories/GHSA-9q5w-79cv-947m) that on older versions, users can make sure to pass `sanitize: true` when making use of this plugin:\n* `.use(remarkHtml, {sanitize: true})`",
    "vendorFixDate": "2021-09-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2888",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39199",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2888/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/remarkjs/remark-html/commit/b0b1ba5c55a58b26bbe1ca3b6def18e95dbbd89e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/remarkjs/remark-html/commit/b75c9dde582ad87ba498e369c033dc8a350478c1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/remarkjs/remark-html/releases/tag/13.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/remarkjs/remark-html/releases/tag/14.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/remarkjs/remark-html/security/advisories/GHSA-9q5w-79cv-947m",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/remarkjs/remark-html/security/advisories/GHSA-9q5w-79cv-947m",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/remark-html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2888/default-remediation-status"
            }
        ]
    }
}