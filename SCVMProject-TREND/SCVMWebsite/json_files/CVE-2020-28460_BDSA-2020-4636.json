{
    "source": "BDSA",
    "name": "BDSA-2020-4636",
    "title": "multi-ini Vulnerable to Prototype Pollution via Insufficient Sanitization in 'Parser' Class",
    "description": "multi-ini is vulnerable to prototype pollution attacks due to an insufficiently thorough validation procedure. A remote attacker could modify the prototypes of objects in memory by sending maliciously crafted requests to a vulnerable endpoint. The exact impact that the attacker can achieve will depend on how the object is used, but can potentially include remote code execution (RCE) and denial-of-service (DoS).\n\nThis vulnerability exists due to an incomplete fix for **CVE-2020-28448** (**BDSA-2020-4633**).",
    "technicalDescription": "The `Parser` class, which is defined in the file `src/parser.js`, contains methods that can be used to modify the properties of objects. Such methods include `assignValue()` and `handleSection()`. It is possible for the name of the property that is to be modified, and its new value, to be derived from user input. \n\nThe application attempts to prevent prototype pollution by checking the name of the property to be modified. If it is `__proto__`, then the function terminates. However, the `prototype` and `constructor` properties can also be used to conduct a pollution attack. The validation code does not detect if these properties are to be modified. An attacker could therefore pollute one of these properties in order to achieve impacts such as RCE or DoS.\n\nThe vulnerability was fixed by ensuring that the validation code also checks if the `prototype` or `constructor` properties are to be modified.\n\nThis vulnerability exists due to an incomplete fix for **CVE-2020-28448** (**BDSA-2020-4633**).",
    "publishedDate": "2021-10-01T15:12:44.506Z",
    "updatedDate": "2021-10-01T15:48:59.483Z",
    "disclosureDate": "2020-12-19T00:00:00.000Z",
    "exploitPublishDate": "2020-12-21T00:00:00.000Z",
    "solution": "Fixed in version [**2.1.2**](https://www.npmjs.com/package/multi-ini) by by [this](https://github.com/evangelion1204/multi-ini/commit/b9ddfb8932cd0249b5ea81f1b949812bf3bda8b2) commit and [this](https://github.com/evangelion1204/multi-ini/commit/6b2212b2ce152c19538a2431415f72942c5a1bde) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nikita Stupin (Advanced Software Technology Lab, Huawei)",
    "workaround": "",
    "vendorFixDate": "2020-12-19T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4636",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-668"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-915"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28460",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4636/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/evangelion1204/multi-ini/commit/6b2212b2ce152c19538a2431415f72942c5a1bde",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/evangelion1204/multi-ini/commit/b9ddfb8932cd0249b5ea81f1b949812bf3bda8b2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-MULTIINI-1053229",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/multi-ini",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/multi-ini/v/2.1.2",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4636/default-remediation-status"
            }
        ]
    }
}