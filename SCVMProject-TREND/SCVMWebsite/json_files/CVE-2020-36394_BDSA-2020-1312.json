{
    "source": "BDSA",
    "name": "BDSA-2020-1312",
    "title": "linux-pam pam_setquota Module Vulnerable to Unprivileged User Gaining Control Over Block Device Quota via fusermount Tool",
    "description": "pam_setquota is vulnerable to allowing an unprivileged user to gain full control over which block device the quota is applied. A local attacker may leverage this to write more data than their quota should allow to a specified block device.",
    "technicalDescription": "The pam_setquota module as part of linux-pam (`modules/pam_setquota/pam_setquota.c`) can mis-match quotas intended for a users home directory onto an unrelated block device. The issue arises because tools like `fusermount` from libfuse allow unprivileged users to mount a FUSE file system using an arbitrary source device name. This can result in a mount entry in `/proc/mounts` looking like this:\n\n> ` /dev/sda1 on /home/user type fuse (rw,nosuid,nodev,relatime,user_id=1000,group_id=100)`\n\npam_setquota will parse this and apply the quota intended for the users home directory onto the given block device when the attacker logs in. This could allow the bypass of quotas intended for the block device.\n\nThe issue has been fixed by skipping mountpoints equal to the user's `$HOME`.\n\n**Note** that this vulnerability does not exist in a tagged release of the code. Only development snapshots of linux-pam between [this](https://github.com/linux-pam/linux-pam/commit/192611c6fb9b46ad4186c6dfb4c26c646e9b29a1) commit and [this](https://github.com/linux-pam/linux-pam/commit/27ded8954a1235bb65ffc9c730ae5a50b1dfed61) commit are affected.",
    "publishedDate": "2020-06-05T15:22:24.789Z",
    "updatedDate": "2021-06-23T09:07:16.588Z",
    "disclosureDate": "2020-06-04T00:00:00.000Z",
    "exploitPublishDate": "2020-06-04T00:00:00.000Z",
    "solution": "Fixed in [**v1.4.0**](https://github.com/linux-pam/linux-pam/releases/tag/v1.4.0) by [this](https://github.com/linux-pam/linux-pam/commit/27ded8954a1235bb65ffc9c730ae5a50b1dfed61) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matthias Gerstner",
    "workaround": "",
    "vendorFixDate": "2020-05-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1312",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-358"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-36394",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1312/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/show_bug.cgi?id=1171721",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/show_bug.cgi?id=1171721",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/linux-pam/linux-pam/commit/192611c6fb9b46ad4186c6dfb4c26c646e9b29a1",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/linux-pam/linux-pam/commit/27ded8954a1235bb65ffc9c730ae5a50b1dfed61",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/linux-pam/linux-pam/releases/tag/v1.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1312/default-remediation-status"
            }
        ]
    }
}