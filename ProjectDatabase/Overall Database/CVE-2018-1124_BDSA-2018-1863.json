{
    "source": "BDSA",
    "name": "BDSA-2018-1863",
    "title": "procps Vulnerable to Heap Corruption via 'file2strvec' Function",
    "description": "procps is vulnerable to a heap corruption vulnerability due to integer overflow which could result in local privilege escalation. An attacker could exploit this vulnerability to cause a denial-of-service (*DoS*) condition or execute arbitrary code on the target system.",
    "technicalDescription": "procps is vulnerable to a heap corruption vulnerability. The function `file2strvec` located in file `proc/readproc.c`  parses processes either by `/proc/PID/cmdline`  or `/proc/PID/environ` and stores a copy in-memory of the argument strings and related pointers. If the function is called and passed to `openrocs()` or `readproctab` it utilizes 3 variables. The variables `c`, `tot`, and `tot + c + align` processed in the while loop located in the function can cause integer overflow. \n\nThe variable`tot` is causing a denial-of service (*DoS*) on `32 bit` system, but it is possible to execute arbitrary code on `64 bit` systems. How the `procps` utility is executed changes the complexity of the attack. If the utility is executed by a script it may be possible to use brute-force techniques to rerun the attack, it becomes a one-shot if the utility is executed manually by an administrator. \n\nA local attacker could exploit this vulnerability to gain higher privileges by starting the process used to create entries. This could result in a denial-of-service (*DoS*) condition or allow the attacker to execute arbitrary code through the `proc` utilities run by other users of the system.",
    "publishedDate": "2018-06-15T13:43:15.915Z",
    "updatedDate": "2019-02-14T13:57:04.163Z",
    "disclosureDate": "2018-05-17T00:00:00.000Z",
    "exploitPublishDate": "2018-05-17T00:00:00.000Z",
    "solution": "Fixed in version [**3.3.15**](https://gitlab.com/procps-ng/procps/tags/v3.3.15) by [this](https://gitlab.com/procps-ng/procps/commit/36c350f07c75aabf747fb833f52a234ae5781b20) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Craig Small",
    "workaround": "",
    "vendorFixDate": "2018-05-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-1863",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-119"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-1124",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-1863/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-1124",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/procps-ng/procps/commit/36c350f07c75aabf747fb833f52a234ae5781b20",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/procps-ng/procps/tags/v3.3.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.qualys.com/2018/05/17/procps-ng-audit-report-advisory.txt",
                "label": "POC"
            }
        ]
    }
}