{
    "source": "BDSA",
    "name": "BDSA-2022-2342",
    "title": "LibreNMS Vulnerable to Remote Code Execution (RCE) via Command Injection in Multiple Parameters",
    "description": "LibreNMS is vulnerable to remote code execution due to the existence of a command injection flaw in the 'Services' component. A remote attacker could execute arbitrary commands on a vulnerable server by sending maliciously crafted requests to a vulnerable endpoint.",
    "technicalDescription": "Several variables which are used by the 'Services' component of LibreNMS are insufficiently sanitized. These variables are `$service['service_type']`, `$service['service_ip']`, `$service['hostname']` and `$service['overwrite_ip']`. The values of these variables can be used to dynamically build commands that are to be executed on the underlying server. An attacker could leverage this issue in order to perform a command injection attack, thus achieving remote code execution on a vulnerable server.",
    "publishedDate": "2022-08-24T15:48:31.227Z",
    "updatedDate": "2022-08-24T15:48:31.216Z",
    "disclosureDate": "2022-04-21T00:00:00.000Z",
    "solution": "Fixed in version [**22.4.0**](https://github.com/librenms/librenms/releases/tag/22.4.0) by [this](https://github.com/librenms/librenms/commit/8b82341cb742e7bd4966964b399012f7ba017e0b) commit.\n\nThe latest stable releases can be found [here](https://github.com/librenms/librenms/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-04-21T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2342",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-29712",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2342/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/librenms/librenms/commit/8b82341cb742e7bd4966964b399012f7ba017e0b",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/librenms/librenms/pull/13932",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/librenms/librenms/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/librenms/librenms/releases/tag/22.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2342/default-remediation-status"
            }
        ]
    }
}