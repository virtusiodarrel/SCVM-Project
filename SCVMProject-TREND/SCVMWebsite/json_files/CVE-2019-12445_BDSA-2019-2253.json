{
    "source": "BDSA",
    "name": "BDSA-2019-2253",
    "title": "GitLab Vulnerable to Stored Cross-Site Scripting (XSS) via Note Objects",
    "description": "GitLab is vulnerable to stored cross-site scripting (XSS) due to improper validation of user supplied input in imported projects with note objects. This could allow an attacker to inject arbitrary web scripts and obtain sensitive information such as authentication tokens and user session cookies.",
    "technicalDescription": "GitLab contains validation checks within the file `app/models/concerns/cache_markdown_field.rb` which are designed to regenerate certain values of note objects when new objects are created during project imports, in order to invalidate values of fields such as `note_html` which can be modified in `project.json` to include malicious input.\n\nHowever, these checks can be bypassed, resulting in such fields not being regenerated and retaining the modified input in the project import. These checks do not work as intended because the wrong values are included in and removed from the `changed_attributes` and `invalidations` lists respectively, and a constant value is used in validation of the `cached_markdown_version` field.\n\nAn attacker could exploit this by creating an export of a project with at least 1 discussion in at least 1 merge request, and adding the fields `note_html` and `cached_markdown_version` with maliciously crafted input to the `project.json`. If this project is then imported, and a victim views the discussion of the import, any included scripts will be executed on their system.",
    "publishedDate": "2019-07-22T14:08:36.289Z",
    "updatedDate": "2022-05-25T14:25:18.633Z",
    "disclosureDate": "2019-06-03T00:00:00.000Z",
    "exploitPublishDate": "2019-07-19T00:00:00.000Z",
    "solution": "Fixed in:\n* **[11.11.1](https://gitlab.com/gitlab-org/gitlab-ce/-/tags/v11.11.1)** by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/affb2b0d11607606414bf5235e199816d517b6b7) commit,\n* **[11.10.5](https://gitlab.com/gitlab-org/gitlab-ce/-/tags/v11.10.5)** by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/126bba35866e77df1d3e720370689dec55c0df5d) commit,\n* **[11.9.12](https://gitlab.com/gitlab-org/gitlab-ce/-/tags/v11.9.12)** by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/7b39a999e128bd95cc2b6ab5d4ea043ae1c06319) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "nyangawa",
    "workaround": "",
    "vendorFixDate": "2019-05-28T00:00:00.000Z",
    "vendorNotifiedDate": "2019-03-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2253",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12445",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2253/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/2019/06/03/security-release-gitlab-11-dot-11-dot-1-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/-/tags/v11.10.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/-/tags/v11.11.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/-/tags/v11.9.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/commit/126bba35866e77df1d3e720370689dec55c0df5d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/commit/7b39a999e128bd95cc2b6ab5d4ea043ae1c06319",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/commit/affb2b0d11607606414bf5235e199816d517b6b7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/issues/58856",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/issues/58856",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2253/default-remediation-status"
            }
        ]
    }
}