{
    "source": "BDSA",
    "name": "BDSA-2019-0054",
    "title": "ZeroMQ Vulnerable to Remote Code Execution (RCE) via Pointer Overflow in 'size_ready()' Function",
    "description": "ZeroMQ is vulnerable to remote code execution (RCE) due to a flaw in libzmq which allows an attacker to force an integer overflow. This can be leveraged to inject arbitrary code into the memory, past the bounds of the intended buffer. If an attacker is able to retrieve necessary memory addresses via other means, they will be able to execute arbitrary commands on the underlying host.",
    "technicalDescription": "This flaw lies in the `zmq::v2_decoder_t::size_ready()` function of the `/src/v2_decoder.cpp` source file. The problem is an inadequate bounds check of the user-supplied `msg_size_`  variable, which can return a false result if a very large value overflows the `read_pos_` pointer. This means that a check can pass even if `msg_size_` bytes will not fit in the currently allocated memory block. After setting `msg_size_` to a high value, an attacker will subsequently be able to send arbitrary bytes to libzmq which will copy them into an internal buffer.\n\nIf an attacker is able to obtain required memory address (e.g. via a memory leak vulnerability), it is then possible to jump to the injected code and have it executed on the underlying host. This vulnerability can also cause a crash and denial-of-service (DoS) due to overwriting of arbitrary memory regions (without requiring a memory leak).",
    "publishedDate": "2019-01-14T16:05:46.215Z",
    "updatedDate": "2019-05-13T15:46:49.458Z",
    "disclosureDate": "2019-01-08T00:00:00.000Z",
    "exploitPublishDate": "2019-01-08T00:00:00.000Z",
    "solution": "Fixed in [**4.3.1**](https://github.com/zeromq/libzmq/releases/tag/v4.3.1) by [this](https://github.com/zeromq/libzmq/commit/1a2ed12716693073032d57dac4e269df3d373751) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Guido Vranken",
    "workaround": "",
    "vendorFixDate": "2019-01-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0054",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-6250",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0054/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zeromq/libzmq/commit/1a2ed12716693073032d57dac4e269df3d373751",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zeromq/libzmq/issues/3351",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zeromq/libzmq/issues/3351",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zeromq/libzmq/releases/tag/v4.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0054/default-remediation-status"
            }
        ]
    }
}