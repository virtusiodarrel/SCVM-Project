{
    "source": "BDSA",
    "name": "BDSA-2021-3640",
    "title": "Chamilo Vulnerable to Multiple Instances of Stored Cross-Site Scripting (XSS) via Unsanitized Input Fields",
    "description": "Chamilo contains multiple instances of stored cross-site scripting (XSS). This allows remote attackers to inject malicious JavaScript into web pages that will be stored on the back end server. The malicious script will execute when loaded in a victim's browser. Multiple fields and pages within Chamilo are affected.",
    "technicalDescription": "The stored XSS vulnerability is due to a lack of sanitization on multiple data input fields in Chamilo. These fields include:\n\n* Course Name field (admin access required)\n* Course Description and Title (teacher access required)\n* Course Documents (student access required)",
    "publishedDate": "2021-12-06T10:15:34.635Z",
    "updatedDate": "2021-12-06T10:15:34.624Z",
    "disclosureDate": "2021-12-04T00:00:00.000Z",
    "exploitPublishDate": "2021-12-04T00:00:00.000Z",
    "solution": "Fixed in [**1.11.16-beta.1**](https://github.com/chamilo/chamilo-lms/releases/tag/v1.11.16-beta.1) by the following commits:\n\n* [Commit 1](https://github.com/chamilo/chamilo-lms/commit/fd54f6194285f949c86060d3b2a7967b43689480).\n* [Commit 2](https://github.com/chamilo/chamilo-lms/commit/cf84be1ca1d9a08ad1341dfbf8df475b13a89072).\n* [Commit 3](https://github.com/chamilo/chamilo-lms/commit/19189a91d1eac9aa204b9439b82e3e73c8ac2e03).\n\nThe latest stable releases can be found [here](https://github.com/chamilo/chamilo-lms/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrej Spuler",
    "workaround": "",
    "vendorFixDate": "2021-05-14T00:00:00.000Z",
    "vendorNotifiedDate": "2021-05-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3640",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-35415",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3640/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/andrejspuler/writeups/tree/main/chamilo-lms#multiple-stored-cross-site-scripting-vulnerabilities",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/andrejspuler/writeups/tree/main/chamilo-lms#multiple-stored-cross-site-scripting-vulnerabilities",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/commit/19189a91d1eac9aa204b9439b82e3e73c8ac2e03",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/commit/cf84be1ca1d9a08ad1341dfbf8df475b13a89072",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/commit/fd54f6194285f949c86060d3b2a7967b43689480",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/releases/tag/v1.11.16-beta.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://support.chamilo.org/projects/1/wiki/Security_issues#Issue-61-2021-05-14-Low-impact-very-low-risk-XSS-in-course-name",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://support.chamilo.org/projects/1/wiki/Security_issues#Issue-62-2021-05-14-Low-impact-low-risk-XSS-in-course-description",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://support.chamilo.org/projects/1/wiki/Security_issues#Issue-63-2021-05-14-Low-impact-moderate-risk-XSS-in-course-documents",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://support.chamilo.org/projects/1/wiki/Security_issues#Issue-64-2021-05-14-Low-impact-low-risk-XSS-in-course-document-title-on-upload",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3640/default-remediation-status"
            }
        ]
    }
}