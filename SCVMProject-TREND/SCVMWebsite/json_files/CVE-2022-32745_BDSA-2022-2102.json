{
    "source": "BDSA",
    "name": "BDSA-2022-2102",
    "title": "Samba Vulnerable to Denial-of-Service (DoS) and Information Exposure via via LDAP Request",
    "description": "A segmentation fault has been discovered in Samba. An authenticated attacker could exploit this via a crafted message which could cause the array of structures to be partially uninitialized, or result in accesses to an arbitrary element beyond the end of an array. This could result in a denial-of-service (DoS) condition or Information exposure, depending on the contents of the uninitialized memory.",
    "technicalDescription": "This issue occurs in the `source4/dsdb/samdb/ldb_modules/util.c` and `source4/dsdb/samdb/ldb_modules/samldb.c` files due to incorrect values being used as the limit for a loop, and as the `count` parameter for the `memcpy()` function. It was mitigated by ensuring that the number of bytes to copy to `memcpy()` has been specified, ensuring that `memcpy()` is not called with a NULL pointer, making sure that the correct value is used for the loop count limit, and by checking to confirm that the application does not attempt to access elements of an empty array.",
    "publishedDate": "2022-07-28T13:23:40.146Z",
    "updatedDate": "2022-09-26T13:46:39.821Z",
    "disclosureDate": "2022-07-27T00:00:00.000Z",
    "solution": "Fixed in [**4.16.4**](https://github.com/samba-team/samba/releases/tag/samba-4.16.4) by the following commits:\n[Commit 1](https://github.com/samba-team/samba/commit/e0d25e172c48c1cd083466dc304257698aadf4af),\n[Commit 2](https://github.com/samba-team/samba/commit/701aef133fd6efb03f8b32dfd5a4d93acf8b9fce),\n[Commit 3](https://github.com/samba-team/samba/commit/f2ded77168dbc54b1d0c8ead08701c48af3f3a74),\n[Commit 4](https://github.com/samba-team/samba/commit/1d7690b000f115ea39fb498d63de46ab6705f927).\n\nFixed in [**4.15.9**](https://github.com/samba-team/samba/releases/tag/samba-4.15.9) by the following commits:\n[Commit 1](https://github.com/samba-team/samba/commit/6af497232e4ed24c33a29b77825fa854a73b5427),\n[Commit 2](https://github.com/samba-team/samba/commit/d85bb9f5edc08ce2042be366c720dd027788f5bd),\n[Commit 3](https://github.com/samba-team/samba/commit/d2dbb3b6818d429b12d54e68510286d033d4abd7),\n[Commit 4](https://github.com/samba-team/samba/commit/c231d424b89ba718262ed376431a982baaeef33f).\n\nFixed in [**4.14.14**](https://github.com/samba-team/samba/releases/tag/samba-4.14.14) by the following commits:\n[Commit 1](https://github.com/samba-team/samba/commit/65d96369fa4f915f01e203cfc8b15e48c5b4b440),\n[Commit 2](https://github.com/samba-team/samba/commit/4d2d30c21b16a53d5547cb803efe49cb6304ce37),\n[Commit 3](https://github.com/samba-team/samba/commit/7c8427e5d2f247921ab44996829acfed1f5f2360),\n[Commit 4](https://github.com/samba-team/samba/commit/6237c85565332e0be1890dd57cc7e25fb76571d7).\n\nThe latest stable releases can be found [here](https://download.samba.org/pub/samba/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Joseph Sutton of Catalyst",
    "workaround": "",
    "vendorFixDate": "2022-07-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2102",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-32745",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2102/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.samba.org/show_bug.cgi?id=15008",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://download.samba.org/pub/samba/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/1d7690b000f115ea39fb498d63de46ab6705f927",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/4d2d30c21b16a53d5547cb803efe49cb6304ce37",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/6237c85565332e0be1890dd57cc7e25fb76571d7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/65d96369fa4f915f01e203cfc8b15e48c5b4b440",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/6af497232e4ed24c33a29b77825fa854a73b5427",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/701aef133fd6efb03f8b32dfd5a4d93acf8b9fce",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/7c8427e5d2f247921ab44996829acfed1f5f2360",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/c231d424b89ba718262ed376431a982baaeef33f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/d2dbb3b6818d429b12d54e68510286d033d4abd7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/d85bb9f5edc08ce2042be366c720dd027788f5bd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/e0d25e172c48c1cd083466dc304257698aadf4af",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/f2ded77168dbc54b1d0c8ead08701c48af3f3a74",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.14.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.15.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.16.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/history/samba-4.16.4.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/security/CVE-2022-32745.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2102/default-remediation-status"
            }
        ]
    }
}