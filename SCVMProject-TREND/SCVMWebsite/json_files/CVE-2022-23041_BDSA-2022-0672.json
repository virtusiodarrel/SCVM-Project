{
    "source": "BDSA",
    "name": "BDSA-2022-0672",
    "title": "Linux PV Device Frontends Vulnerable to Unauthorized Memory Access and Denial-of-Service (DoS) via Race Condition in Multiple Drivers",
    "description": "Xen is vulnerable to Linux PV device frontend attacks due to exposed race conditions in multiple drivers when handling the removal of access rights for the corresponding backend. This could allow an attacker, through a malicious backend, to perform unauthorized memory page accesses and expose/corrupt data, or cause a denial-of-service (DoS) of the guest.",
    "technicalDescription": "The issue exists in the `blkfront`, `netfront`, `scsifront`, `usbfront`, `dmabuf`, `xenbus`, `9p`, `kbdfront`, and `pvcalls` drivers. A race condition is exposed between the delayed freeing of a grant reference and freeing of associated data pages, which can allow a malicious backend to retain access to guest memory pages.",
    "publishedDate": "2022-03-11T17:01:09.918Z",
    "updatedDate": "2022-09-20T15:49:54.848Z",
    "disclosureDate": "2022-03-10T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.9.320**](https://www.kernel.org)\n* [**4.14.285**](https://www.kernel.org)\n* [**4.19.249**](https://www.kernel.org)\n* [**5.4.200**](https://www.kernel.org)\n* [**5.10.124**](https://www.kernel.org)\n* [**5.15.49**](https://www.kernel.org)\n\nFixed by these commits:\n* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=42baefac638f06314298087394b982ead9ec444b)\n* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b0576cc9c6b843d99c6982888d59a56209341888)\n* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5cadd4bb1d7fc9ab201ac14620d1a478357e4ebd)\n\nFixed in [**5.17-rc8**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b5521fe9a9336caa1caa2db126f1d3ba1bc8303e) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Demi Marie Obenour and Simon Gaiser (Invisible Things Lab)",
    "workaround": "",
    "vendorFixDate": "2022-03-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0672",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23041",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0672/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=42baefac638f06314298087394b982ead9ec444b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5cadd4bb1d7fc9ab201ac14620d1a478357e4ebd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b0576cc9c6b843d99c6982888d59a56209341888",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b5521fe9a9336caa1caa2db126f1d3ba1bc8303e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-396.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0672/default-remediation-status"
            }
        ]
    }
}