{
    "source": "BDSA",
    "name": "BDSA-2021-3863",
    "title": "Keycloak Vulnerable to Incorrect Authorization via 'createUser' Function",
    "description": "Keycloak contains an incorrect authorization vulnerability which allows unauthorized users the ability to add new users via the administrative REST API. An attacker could exploit this to create new default users even if the new user registration is disabled.",
    "technicalDescription": "This vulnerability exists due to insufficient access controls in the `createUser` function in the file `services/src/main/java/org/keycloak/services/resources/admin/UsersResource.java`, where unauthorized users can add new default user accounts.\n\nIt was addressed by ensuring that the admin permissions feature is enabled before allowing users to create new users.",
    "publishedDate": "2021-12-22T14:16:15.148Z",
    "updatedDate": "2022-03-23T14:04:58.602Z",
    "disclosureDate": "2021-12-17T00:00:00.000Z",
    "solution": "Fixed in version [**15.1.1**](https://github.com/keycloak/keycloak/releases/tag/15.1.1) by [this](https://github.com/keycloak/keycloak/commit/d9d0bfb218865ed05011957cbcc926fd415bcefe) commit.\n\nThe latest stable releases can be found [here](https://www.keycloak.org/downloads).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Grzegorz Soba\u0144ski (MLabs)",
    "workaround": "",
    "vendorFixDate": "2021-12-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3863",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-863"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-4133",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3863/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2033602",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/b19fe5c01b2a6af57ae651cb5b3b60c7f4c05d75",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/d9d0bfb218865ed05011957cbcc926fd415bcefe",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/issues/9247",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases/tag/15.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/security/advisories/GHSA-83x4-9cwr-5487",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.keycloak.org/downloads",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3863/default-remediation-status"
            }
        ]
    }
}