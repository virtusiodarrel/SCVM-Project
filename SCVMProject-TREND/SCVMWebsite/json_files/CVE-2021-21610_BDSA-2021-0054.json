{
    "source": "BDSA",
    "name": "BDSA-2021-0054",
    "title": "Jenkins Vulnerable to Reflected Cross-Site Scripting (XSS) via Unsafe Elements in 'Markup Formatter Preview' Module",
    "description": "Jenkins has a reflected cross-site scripting (XSS) vulnerability because it does not restrict unsafe elements in the `Markup Formatter Preview` module. A remote attacker could insert JavaScript code and steal a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "Jenkins usually allows administrators to preview the descriptions they have edited. They can use a markup formatter for creating/editing descriptions. However, the markup formatter, handled by the `core/src/main/java/hudson/markup/MarkupFormatter.java` file, does not restrict unsafe elements in the URL from being rendered and executed. Thus, reflected cross-site scripting is possible if a formatter like `anything-goes-formatter` is being used for markup.\nExploiting the reflected XSS vulnerability in such cases could result in theft of cookies and other session information.\nThis vulnerability was fixed by forcing preview URLs to be handled using POST requests and introducing Content-Security-Policy (CSP) to prevent unsafe elements from executing.",
    "publishedDate": "2021-01-14T10:41:52.759Z",
    "updatedDate": "2021-09-20T11:18:25.495Z",
    "disclosureDate": "2021-01-13T00:00:00.000Z",
    "solution": "Fixed in [**2.263.2**](https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.263.2) by [this](https://github.com/jenkinsci/jenkins/commit/956651d1296c792527117827cf49cb0d31f39b4d) commit.\n\nFixed in [**2.275**](https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.275) by [this](https://github.com/jenkinsci/jenkins/commit/89ec0c40b68cd1e4e9f9ef5ebcafd87e7fa16589) commit.\n\nThe latest stable releases are available [here](https://www.jenkins.io/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Daniel Beck, CloudBees, Inc.",
    "workaround": "",
    "vendorFixDate": "2021-01-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0054",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21610",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0054/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/commit/89ec0c40b68cd1e4e9f9ef5ebcafd87e7fa16589",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/commit/956651d1296c792527117827cf49cb0d31f39b4d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/commit/f1086984fb6e2275d3ef639378d6f3137f5f649e",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.263.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.275",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/security/advisory/2021-01-13/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0054/default-remediation-status"
            }
        ]
    }
}