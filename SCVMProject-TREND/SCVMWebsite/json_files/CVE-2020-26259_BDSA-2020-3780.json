{
    "source": "BDSA",
    "name": "BDSA-2020-3780",
    "title": "XStream Vulnerable to Arbitrary File Deletion via Unmarshalling of Specially Crafted Input",
    "description": "XStream is vulnerable to an arbitrary file deletion flaw in it's handling of unmarshalling specially crafted input. A remote attacker could delete arbitrary files on the server, if the server process has sufficient rights. As well as impacting the integrity of data, this might lead to a denial-of-service (DoS) of applications on the system that rely on specific files for their operation.",
    "technicalDescription": "If a JAX-WS runtime is on the classpath of the running application, and XStream is not running with the [suggested](https://x-stream.github.io/security.html#framework) white listing approach of the security framework, arbitrary files may be deleted from the server. This can occur during the unmarshalling of specially crafted input streams of any type supported by XStream and the application, eg XML, JSON etc. Specifically, `com.sun.xml.internal.ws.util.ReadAllStream$FileStream` has a `tempFile` property that causes the specified file to be deleted when unmarshalled.\n\nThe issue has been resolved by adding items to the default blacklist, including `com.sun.xml.internal.ws.util.ReadAllStream$FileStream` with a regular expression.",
    "publishedDate": "2020-12-16T16:33:51.672Z",
    "updatedDate": "2021-07-05T09:05:48.631Z",
    "disclosureDate": "2020-12-13T00:00:00.000Z",
    "exploitPublishDate": "2020-12-13T00:00:00.000Z",
    "solution": "Fixed in [**1.4.15**](https://github.com/x-stream/xstream/releases/tag/XSTREAM_1_4_15) by [this](https://github.com/x-stream/xstream/commit/0bcbf50126a62dfcd65f93a0da0c6d1ae92aa738) commit.\n\nThe latest stable releases can be found [here](https://github.com/x-stream/xstream/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Liaogui Zhong",
    "workaround": "Users who configured the white listing approach of the Security Framework, without the affected classes on the whitelist, are not vulnerable.\n\nFor users of the blacklisting approach of the security framework, the vendor supplies a comprehensive workaround [here](https://x-stream.github.io/CVE-2020-26259.html).",
    "vendorFixDate": "2020-12-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3780",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-184"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-26259",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3780/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/commit/0bcbf50126a62dfcd65f93a0da0c6d1ae92aa738",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/releases/tag/XSTREAM_1_4_15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/security/advisories/GHSA-jfvx-7wrx-43fh",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/security/advisories/GHSA-jfvx-7wrx-43fh",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/CVE-2020-26259.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/CVE-2020-26259.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/CVE-2020-26259.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/security.html#framework",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3780/default-remediation-status"
            }
        ]
    }
}