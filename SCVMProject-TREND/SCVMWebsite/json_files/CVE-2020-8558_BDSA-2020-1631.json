{
    "source": "BDSA",
    "name": "BDSA-2020-1631",
    "title": "Kubernetes Vulnerable to Localhost Boundary Bypass via Insecure Firewall Rules",
    "description": "Kubernetes kube-proxy allows adjacent hosts to reach local services running on a node or in the node's network namespace. For example, an attacker with access to another system on the same network as the API server could execute unauthorized arbitrary requests on the nodes of the vulnerable cluster.",
    "technicalDescription": "The vulnerability affects all cluster nodes that run local services (bound to `127.0.0.1`) that do not require authentication and share the same LAN with untrusted hosts. Furthermore, this only affects clusters that allow untrusted pods to run containers with `CAP_NET_RAW ` capability (Kubernetes allows this by default).\n\nIPv6-only services that bind to a localhost address are not affected.\n\nThe Kubernetes API server is vulnerable if it is running on port `8080` (does not require authentication).\n\nThis issue was fixed by adding an iptables rule that rejects external requests.",
    "publishedDate": "2020-07-09T14:25:24.948Z",
    "updatedDate": "2020-07-09T14:25:24.938Z",
    "disclosureDate": "2020-06-19T00:00:00.000Z",
    "solution": "Fixed in:\n* **[1.16.11](https://github.com/kubernetes/kubernetes/releases/tag/v1.16.11)** by [this](https://github.com/kubernetes/kubernetes/commit/d22a61e21d6) commit,\n* **[1.17.7](https://github.com/kubernetes/kubernetes/releases/tag/v1.17.7)** by [this](https://github.com/kubernetes/kubernetes/commit/b24a7974a92) commit,\n* **[1.18.4](https://github.com/kubernetes/kubernetes/releases/tag/v1.18.4)** by [this](https://github.com/kubernetes/kubernetes/commit/a8a673aab09) commit,\n* **[1.19.0-beta.1](https://github.com/kubernetes/kubernetes/releases/tag/v1.19.0-beta.1)** by [this](https://github.com/kubernetes/kubernetes/commit/8bed088224f) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.5,
        "severity": "MEDIUM",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:A/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "J\u00e1nos K\u00f6v\u00e9r, Ericsson",
    "workaround": "To mitigate this vulnerability the vendor advises adding the following iptables rule on the affected nodes:\n\n`iptables -I INPUT --dst 127.0.0.0/8 ! --src 127.0.0.0/8 -m conntrack ! --ctstate RELATED,ESTABLISHED,DNAT -j DROP`\n\nThis will reject traffic to `127.0.0.1` which does not originate on the node.\n\nIf a cluster does not have the API Server port `8080` disabled, the vendor recommends disabling it via `--insecure-port=0` flag in the Kubernetes API server command line.",
    "vendorFixDate": "2020-05-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1631",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8558",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1631/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/commit/8bed088224f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/commit/a8a673aab09",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/commit/b24a7974a92",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/commit/d22a61e21d6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/issues/92315",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/releases/tag/v1.16.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/releases/tag/v1.17.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/releases/tag/v1.18.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/releases/tag/v1.19.0-beta.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1631/default-remediation-status"
            }
        ]
    }
}