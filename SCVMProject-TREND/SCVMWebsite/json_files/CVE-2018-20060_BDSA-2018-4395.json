{
    "source": "BDSA",
    "name": "BDSA-2018-4395",
    "title": "urllib3 Vulnerable to Information Exposure via 'Authorization HTTP Header' during Cross-Origin Redirect",
    "description": "An information exposure vulnerability has been discovered in urllib3. An attacker could exploit this vulnerability to retrieve the authorization header value which could leak credential data.",
    "technicalDescription": "It has been discovered in urllib3 that authentication headers would be forwarded on cross-origin redirects by default. This configuration is handled by the `forward_auth_headers_across_hosts` function which value defaults to `True`. This also forced the HTTP header to be exposed and transmitted in plain-text to any location that differs in host or port. \n\nThe function located in the file ` urllib3/util/retry.py` contains the function `__init__` which is called on a retry, that did not utilize a default black list to verify which headers could be sent in the request. \n\nAn attacker could exploit this vulnerability through man in the middle (MITM) techniques to steal sensitive information which can lead to session hijacking.",
    "publishedDate": "2018-12-17T14:22:13.839Z",
    "updatedDate": "2020-05-26T14:50:29.053Z",
    "disclosureDate": "2018-01-26T00:00:00.000Z",
    "solution": "Fixed in version [**1.23**](https://github.com/urllib3/urllib3/releases/tag/1.23) by [these](https://github.com/urllib3/urllib3/pull/1346) commits.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-03-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4395",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-552"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-20060",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4395/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1649153",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/urllib3/urllib3/issues/1316",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/urllib3/urllib3/pull/1346",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/urllib3/urllib3/releases/tag/1.23",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}