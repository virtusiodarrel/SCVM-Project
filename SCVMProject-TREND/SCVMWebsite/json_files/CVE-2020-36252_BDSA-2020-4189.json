{
    "source": "BDSA",
    "name": "BDSA-2020-4189",
    "title": "ownCloud Server Vulnerable to Improper File Access via Predictable ID Number",
    "description": "ownCloud Server is vulnerable to improper file access via predictable ID numbers. An attacker who has one outgoing share from a victim could exploit this in order to gain access to other files via a request using a predictable ID.",
    "technicalDescription": "This issue related to incorrect usage of privileged API's and it occurs because the `file-id` values relating to shares are numeric and sequential. Through enumeration an attacker can access all existing versions of all the victim's files, including those that are unshared. This can occur as soon as the potential victim has sent at least one outgoing share with the attacker. It was mitigated by a review of the privileged API's used in owncloud-server and the replacement of these with less privileged alternatives where applicable.",
    "publishedDate": "2021-02-19T13:41:45.378Z",
    "updatedDate": "2021-02-19T13:41:45.374Z",
    "disclosureDate": "2020-02-28T00:00:00.000Z",
    "solution": "Fixed in [**10.3.1**](https://github.com/owncloud/core/releases/tag/v10.3.1).\n\nThe latest stable releases are available [here](https://github.com/owncloud/core/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.7,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has proposed the following mitigation:\n> Disable `files_versions` app by executing `occ app:disable files_versions`",
    "vendorFixDate": "2019-11-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4189",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-648"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-36252",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4189/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/owncloud/core/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/owncloud/core/releases/tag/v10.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://owncloud.com/security-advisories/access-to-all-file-versions/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://owncloud.com/security-advisories/access-to-all-file-versions/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4189/default-remediation-status"
            }
        ]
    }
}