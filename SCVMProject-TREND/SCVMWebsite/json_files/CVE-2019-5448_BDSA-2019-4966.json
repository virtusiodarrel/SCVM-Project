{
    "source": "BDSA",
    "name": "BDSA-2019-4966",
    "title": "Yarn Vulnerable to Authentication Data Information Disclosure via HTTP URLs in Lockfile",
    "description": "Yarn is vulnerable to an information disclosure flaw because it utilizes HTTP URLs in a lockfile. A remote attacker able to sniff network traffic could learn authentication details.",
    "technicalDescription": "The Yarn registry is a DNS alias to the npm registry and for a few months in 2018 the npm registry returned HTTP URLs instead of the secure HTTPS ones. The lockfile entries generated during this period may still utilize HTTP URLs, so any affected installation will send authentication data over the network unencrypted. This could allow a man-in-the-middle attacker to learn this authentication data.",
    "publishedDate": "2020-12-24T12:27:15.517Z",
    "updatedDate": "2020-12-24T12:27:15.508Z",
    "disclosureDate": "2019-07-12T00:00:00.000Z",
    "solution": "Fixed in **[1.17.3](https://github.com/yarnpkg/yarn/releases/tag/v1.17.3)** by [this](https://github.com/yarnpkg/yarn/commit/c10ef6ab60f0bc80f65838d675325f6c17f04f24) commit.\n\nFixed in **[1.18.0](https://github.com/yarnpkg/yarn/releases/tag/v1.18.0)** by [this](https://github.com/yarnpkg/yarn/commit/2f08a7405cc3f6fe47c30293050bb0ac94850932) commit.\n\nIt is recommended that you also edit your lockfiles with the following command, to replace any reference to the HTTP protocol:\n\n`$ sed -i '' 's/http:/https:/g' yarn.lock`",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "@skovorodan of Exodus",
    "workaround": "",
    "vendorFixDate": "2019-07-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4966",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-311"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5448",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4966/ranges"
            },
            {
                "rel": "reference",
                "href": "https://classic.yarnpkg.com/blog/2019/07/12/recommended-security-update/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yarnpkg/yarn/commit/2f08a7405cc3f6fe47c30293050bb0ac94850932",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yarnpkg/yarn/commit/c10ef6ab60f0bc80f65838d675325f6c17f04f24",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yarnpkg/yarn/releases/tag/v1.17.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yarnpkg/yarn/releases/tag/v1.18.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/640904",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4966/default-remediation-status"
            }
        ]
    }
}