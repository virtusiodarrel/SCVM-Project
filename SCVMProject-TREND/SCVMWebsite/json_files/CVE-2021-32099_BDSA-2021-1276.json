{
    "source": "BDSA",
    "name": "BDSA-2021-1276",
    "title": "Pandora FMS Vulnerable to Login Bypass via SQL Injection",
    "description": "Pandora FMS is vulnerable to login bypass via SQL injection. An unauthenticated attacker can bypass administrator authentication and ultimately execute arbitrary code on the target system. \n\nAlthough Pandora FMS is not typically accessible to a remote attacker this issue can be exploited by taking advantage of a cross-site request forgery vulnerability.",
    "technicalDescription": "In the file `/include/lib/User.php`, the user-controlled parameter `$data['phpsessionid']` is passed to the `db_get_row_filter` function. This function calls a couple of internal functions that dynamically build a SQL query. Lack of proper sanitization at this point exposes the application to SQL injection. An attacker can then use this to alter the result set of the DB query. The PHP function `session_decode` then loads data from this result set and populates it into the current `$SESSION`. In this way an attacker can impersonate any user including an administrator.",
    "publishedDate": "2021-06-03T09:25:47.800Z",
    "updatedDate": "2021-09-22T15:44:14.140Z",
    "disclosureDate": "2020-09-22T00:00:00.000Z",
    "solution": "Fixed in [**7.0NG.743**](https://pandorafms.org/features/free-download-monitoring-software/) by [this](https://github.com/pandorafms/pandorafms/commit/9f9cc9beda4b77aa96636069c8bac5a63a6aadf1) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dennis Brinkrolf",
    "workaround": "",
    "vendorFixDate": "2020-01-30T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1276",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32099",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1276/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pandorafms/pandorafms/commit/9f9cc9beda4b77aa96636069c8bac5a63a6aadf1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://pandorafms.com/blog/whats-new-in-pandora-fms-743/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://pandorafms.org/features/free-download-monitoring-software/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1276/default-remediation-status"
            }
        ]
    }
}