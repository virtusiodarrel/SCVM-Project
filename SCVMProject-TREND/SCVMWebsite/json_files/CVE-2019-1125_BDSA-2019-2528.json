{
    "source": "BDSA",
    "name": "BDSA-2019-2528",
    "title": "Linux Kernel Vulnerable to Information Disclosure via Spectre-v1 Like Side-Channel with swapgs",
    "description": "The Linux kernel is vulnerable to a Spectre-V1 side-channel based information leak. A local attacker on the machine with a vulnerable processor can learn sensitive information about the kernels internal working state such that they bypass the protection feature kernel address space layout randomisation (KALSR), or read other sensitive memory.",
    "technicalDescription": "The kernel entry code in interrupt, exception and NMI handlers have conditional `swapgs` checks. As `GS` comes from the user/attacker this can open up a potential Spectre-V1 gadget whereby the attacker can force a speculative read of any kernel value, and the gadget would reveal the kernel value via an L1 cache timing side channel. See BDSA-2018-0008 for more information on the general problem.\n\nThis issue has been fixed by adding an `lfence` on both the `swapgs` from the user, and kernel non-`swapgs` paths.\n\nThis affects x86 processors. AMD believe their processors are not vulnerable to this specific variant of the speculative execution problem.",
    "publishedDate": "2019-08-09T14:39:52.876Z",
    "updatedDate": "2019-08-14T14:14:54.172Z",
    "disclosureDate": "2019-08-07T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.16.72**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bba3308d5fe2c8c4605db3ea868ba57ad990d27d) commit\n* [**4.4.189**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=73e2c1bd2714f902c5ee290445579b79afc6a0e6) commit\n* [**4.9.189**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=90d45f0856f3479a742ae29d5150c59116d3f34a) commit\n* [**4.14.137**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ee524c14856d2eab5d3d2202c12c06d2e7190c2a) commit\n* [**4.19.65**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=23e7a7b3a75f6dd24c161bf7d1399f251bf5c109) commit\n* [**5.2.7**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=405d06fba6937bf272917ec36bd1cf4ad7f7f286) commit\n* [**5.3-rc4**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a2059825986a1c8143fd6698774fa9d83733bb11) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.7,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.5
        },
        "vector": "(AV:L/AC:M/Au:N/C:C/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Researchers at BitDefender",
    "workaround": "",
    "vendorFixDate": "2019-07-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2528",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-1125",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2528/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/CVE-2019-1125",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=18ec54fdd6d18d92025af097cd042a75cf0ea24c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=a2059825986a1c8143fd6698774fa9d83733bb11",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://software.intel.com/security-software-guidance/insights/more-information-swapgs-and-speculative-only-segment-loads",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2528/default-remediation-status"
            }
        ]
    }
}