{
    "source": "BDSA",
    "name": "BDSA-2020-1029",
    "title": "Trixbox Vulnerable to OS Command Injection via 'endpoint_devicemap.php'",
    "description": "Trixbox contains an OS command injection vulnerability.  This allows an authenticated attacker to execute commands on the system hosting Trixbox with the privileges of Asterisks, the underlying private branch exchange (PBX) software of Trixbox.  Although it has been demonstrated to be trivial to elevate the privileges of the injected code to root.  This vulnerability totally compromises the confidentiality, integrity, and availability triad of a system.",
    "technicalDescription": "The OS command injection vulnerability is due to a lack of sanitization on input supplied to an underlying shell spawned by Trixbox. This occurs through `network` POST parameter in the `/maint/modules/endpointcfg/endpoint_devicemap.php` page. A functional exploit exists for this vulnerability.  It has also previously been [reported](https://sourceforge.net/p/asteriskathome/bugs/235/) that Trixbox is vulnerable to such attacks through other vectors.",
    "publishedDate": "2020-05-07T13:35:28.813Z",
    "updatedDate": "2021-01-26T14:17:21.658Z",
    "disclosureDate": "2020-05-05T00:00:00.000Z",
    "exploitPublishDate": "2020-05-04T00:00:00.000Z",
    "solution": "",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 9.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 8.0,
        "severity": "HIGH",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNCORROBORATED",
            "score": 8.2
        },
        "vector": "(AV:N/AC:L/Au:S/C:C/I:C/A:C/E:F/RL:U/RC:UR)"
    },
    "cvss3": {
        "baseScore": 9.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.1,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "REASONABLE",
            "score": 9.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:F/RL:U/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Anastasios Stasinopoulos",
    "workaround": "",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1029",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7351",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1029/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rapid7/metasploit-framework/commit/d2b196f17257e419468ad3d743f5a9c013c8852e",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/157565/trixbox_ce_endpoint_devicemap_rce.rb.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sourceforge.net/p/asteriskathome/bugs/235/",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1029/default-remediation-status"
            }
        ]
    }
}