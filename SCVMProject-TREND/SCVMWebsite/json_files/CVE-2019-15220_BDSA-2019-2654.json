{
    "source": "BDSA",
    "name": "BDSA-2019-2654",
    "title": "Linux Kernel is Vulnerable to Denial-of-Service (DoS) via Use-After-Free in p54usb Driver",
    "description": "Linux kernel is vulnerable to denial-of-service (DoS) as the prism54 softmac hardware driver fails to adequately allocate, track and release memory. An attacker with physical access to the target machine could leverage this flaw to trigger a use-after-free error and cause a crash by using a malicious device.",
    "technicalDescription": "Current implementation of the driver defined in `/drivers/net/wireless/intersil/p54/p54usb.c` contains a race condition between disconnect and firmware loading. This flaw is a result of multiple issues.\n\nFirstly, if kernel is unable to load the firmware, the callback routine will attempt to unbind the driver from the USB `_device_` instead of USB `_interface_` which it is actually bound to.\n\nAnother problem is that the firmware-loader callback routine may send a completion signal to the disconnect handler and then attempt to access a private data structure that the handler has already freed. This will lead to a crash due to use-after-free.",
    "publishedDate": "2019-08-20T13:32:28.571Z",
    "updatedDate": "2019-08-20T13:32:28.560Z",
    "disclosureDate": "2019-08-19T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.9.186**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=feca0ce34518f69447d0d13cd431d0eef647a794) commit,\n* [**4.14.134**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c760ecb74f84f729ae31b9fbc6b772923cdc78df) commit,\n* [**4.19.59**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=449a8d08a4bc45101fa26e6d233b98258d33620a) commit,\n* [**5.1.18**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cae928691200cbe65da1b31d92472f50abe48a14) commit,\n* [**5.2.1**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9baa5b4925da756e7a47444514bc88a6818d300f) commit, and\n* [**5.3-rc1**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6e41e2257f1094acc37618bf6c856115374c6922) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.6,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 0.9,
        "severity": "MEDIUM",
        "attackVector": "PHYSICAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "CVSS:3.0/AV:P/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-06-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2654",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15220",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2654/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=449a8d08a4bc45101fa26e6d233b98258d33620a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6e41e2257f1094acc37618bf6c856115374c6922",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9baa5b4925da756e7a47444514bc88a6818d300f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c760ecb74f84f729ae31b9fbc6b772923cdc78df",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cae928691200cbe65da1b31d92472f50abe48a14",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=feca0ce34518f69447d0d13cd431d0eef647a794",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://syzkaller.appspot.com/bug?id=082c09653e43e33a6a56f8c57cf051eeacae9d5f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2654/default-remediation-status"
            }
        ]
    }
}