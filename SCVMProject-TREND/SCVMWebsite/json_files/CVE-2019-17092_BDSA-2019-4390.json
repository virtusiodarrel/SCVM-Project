{
    "source": "BDSA",
    "name": "BDSA-2019-4390",
    "title": "OpenProject 'Project List' Vulnerable to Cross-Site Scripting (XSS) via Unsanitised 'sortBy' Parameter",
    "description": "OpenProject contains a cross-site scripting (XSS) vulnerability in the 'Project List' functionality due to a lack of sanitization of user-supplied input. An attacker could insert a malicious script and steal a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "OpenProject is vulnerable to cross-site scripting (XSS) because the `sortBy` parameter used in the `/project` path to display a list of projects accepts user input and is not sanitized before it's value is used. Inserting a value into the `sortBy` parameter that is not one of the allowed values results in this value being reflected back in mishandled error messages.\n\nThis allows malicious URLs to be crafted through adding scripts to this parameter which can enable reflected XSS attacks that can execute in the context of a victim's browser.\n\nThis vulnerability was mitigated by using the Ruby on Rails `safe_join` method to build safe HTML error messages.",
    "publishedDate": "2020-05-13T09:49:29.273Z",
    "updatedDate": "2020-05-13T09:50:09.643Z",
    "disclosureDate": "2019-10-14T00:00:00.000Z",
    "exploitPublishDate": "2019-10-14T00:00:00.000Z",
    "solution": "Fixed in:\n* [**9.0.4**](https://github.com/opf/openproject/releases/tag/v9.0.4) by [this](https://github.com/opf/openproject/commit/b1f1184da257f03ad0cb98d659cd297c76ab4681) commit.\n* [**10.0.2**](https://github.com/opf/openproject/releases/tag/v10.0.2) by [this](https://github.com/opf/openproject/commit/3d97126e6dff28cab23e2d02a3c77a2b49b1e738) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "David Haintz",
    "workaround": "",
    "vendorFixDate": "2019-10-08T00:00:00.000Z",
    "discoveryDate": "2019-09-27T00:00:00.000Z",
    "vendorNotifiedDate": "2019-10-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4390",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-17092",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4390/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opf/openproject/commit/3d97126e6dff28cab23e2d02a3c77a2b49b1e738",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opf/openproject/commit/b1f1184da257f03ad0cb98d659cd297c76ab4681",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opf/openproject/releases/tag/v10.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opf/openproject/releases/tag/v9.0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://sec-consult.com/en/blog/advisories/reflected-xss-vulnerability-in-openproject-cve-2019-17092/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sec-consult.com/en/blog/advisories/reflected-xss-vulnerability-in-openproject-cve-2019-17092/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.openproject.org/release-notes/openproject-10-0-2/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openproject.org/release-notes/openproject-9-0-4/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4390/default-remediation-status"
            }
        ]
    }
}