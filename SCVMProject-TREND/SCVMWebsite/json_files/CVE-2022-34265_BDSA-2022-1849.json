{
    "source": "BDSA",
    "name": "BDSA-2022-1849",
    "title": "Django Vulnerable to SQL Injection via Unsanitized Input to 'Trunc()' and 'Extract()' Database Functions",
    "description": "Django is vulnerable to SQL injection when an application passes unsanitized user input to certain database functions. This could allow an attacker to extract information from or modify the database.",
    "technicalDescription": "The issue occurs because the `Trunc(kind)` and `Extract(lookup_name)` database functions were subject to SQL injection if untrusted data was used as a `kind`/`lookup_name` value.\n\nThe issue was resolved in `django/db/models/functions/datetime.py` by checking the arguments in question with a special regular expression and raising an error if the were detected as invalid.",
    "publishedDate": "2022-07-05T11:43:35.154Z",
    "updatedDate": "2022-09-13T13:54:11.553Z",
    "disclosureDate": "2022-07-04T00:00:00.000Z",
    "exploitPublishDate": "2022-07-09T00:00:00.000Z",
    "solution": "This was thought to have been fixed in:\n* **4.0.6** by [this](https://github.com/django/django/commit/0dc9c016fadb71a067e5a42be30164e3f96c0492) commit.\n* **3.2.14** by [this](https://github.com/django/django/commit/a9010fe5555e6086a9d9ae50069579400ef0685e) commit.\n* **remotes/origin/stable/4.1.x** branch by [this](https://github.com/django/django/commit/284b188a4194e8fa5d72a73b09a869d7dd9f0dc5) commit.\n\nHowever additional commits were released to improve the fixes above:\n* [Commit 1](https://github.com/django/django/commit/877c800f255ccaa7abde1fb944de45d1616f5cc9)\n* [Commit 2](https://github.com/django/django/commit/5e2f4ddf2940704a26a4ac782b851989668d74db)\n\nThese commits have been merged into the **4.1.x** branch in **4.1.0-rc1** and **4.1**.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Takuto Yoshikai (Aeye Security Lab)",
    "workaround": "Applications that constrain the lookup name and kind choice to a known safe list are unaffected.",
    "vendorFixDate": "2022-07-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1849",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-34265",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1849/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aeyesec/CVE-2022-34265",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/0dc9c016fadb71a067e5a42be30164e3f96c0492",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/284b188a4194e8fa5d72a73b09a869d7dd9f0dc5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/5e2f4ddf2940704a26a4ac782b851989668d74db",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/877c800f255ccaa7abde1fb944de45d1616f5cc9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/a9010fe5555e6086a9d9ae50069579400ef0685e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/weblog/2022/jul/04/security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/weblog/2022/jul/04/security-releases/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1849/default-remediation-status"
            }
        ]
    }
}