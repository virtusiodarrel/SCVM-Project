{
    "source": "BDSA",
    "name": "BDSA-2021-2292",
    "title": "Fetchmail Vulnerable to Denial-of-Service (DoS) via Improper Buffer Reallocation for Large Log Messages",
    "description": "Fetchmail is vulnerable to denial-of-service (DoS) due to mismanaging memory when logging large messages. This flaw could potentially be triggered by receiving large headers which would cause Fetchmail to crash or misreport certain log messages.",
    "technicalDescription": "The vulnerability is caused by an inappropriate buffer reallocation in `report.c` when a log message exceeds 2 kB in size. The bad memory allocation for messages causes logging functions to read junk memory. Although the exact impact of this depends on compiler and operating system configurations used (such as verbosity or the usage of `varargs.h`/`stdarg.h` interface), Fetchmail may crash or misreport each first log message that requires a buffer reallocation.",
    "publishedDate": "2021-07-29T14:51:18.278Z",
    "updatedDate": "2021-08-09T10:26:24.037Z",
    "disclosureDate": "2021-07-28T00:00:00.000Z",
    "solution": "Fixed by [this](https://gitlab.com/fetchmail/fetchmail/-/commit/c546c829) commit in:\n* [**6.4.20**](https://gitlab.com/fetchmail/fetchmail/-/tags/RELEASE_6-4-20)\n* [**6.5.0-beta4**](https://gitlab.com/fetchmail/fetchmail/-/tags/6.5.0.beta4)\n* [**7.0.0-alpha9**](https://gitlab.com/fetchmail/fetchmail/-/tags/7.0.0-alpha9)\n\nThe latest stable releases are available [here](https://sourceforge.net/projects/fetchmail/files/branch_6.4/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Christian Herdtweck of Intra2net AG",
    "workaround": "",
    "vendorFixDate": "2021-07-07T00:00:00.000Z",
    "vendorNotifiedDate": "2021-07-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2292",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-131"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-36386",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2292/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/fetchmail/fetchmail/-/commit/c546c829",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/fetchmail/fetchmail/-/tags/6.5.0.beta4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/fetchmail/fetchmail/-/tags/7.0.0-alpha9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/fetchmail/fetchmail/-/tags/RELEASE_6-4-20",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://sourceforge.net/p/fetchmail/git/ci/a909daef2d643dbf2455096111550bb44237b8c7/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sourceforge.net/projects/fetchmail/files/branch_6.4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.fetchmail.info/fetchmail-SA-2021-01.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2292/default-remediation-status"
            }
        ]
    }
}