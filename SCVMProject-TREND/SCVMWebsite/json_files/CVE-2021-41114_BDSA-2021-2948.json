{
    "source": "BDSA",
    "name": "BDSA-2021-2948",
    "title": "TYPO3 Vulnerable to HTTP Header Injection via Request Handling",
    "description": "TYPO3 is vulnerable to host spoofing due to improper validation of the HTTP `Host` header. This can allow an unauthenticated attacker to use HTTP header injection in order to generate absolute URLs during the frontend rendering process which can be forged to any value the attacker requires. This can then be used to further compromise TYPO3.\n\n**Note:** This vulnerability was originally reported as **CVE-2014-3941** and now exists due to the introduction of a regression during TYPO3 v11 development.",
    "technicalDescription": "This vulnerability exists due to improper validation of the HTTP `Host` header in TYPO3 because of a dependency cycle between `HTTP_HOST` generation and verification. The `$GLOBALS['TYPO3_REQUEST']` variable is not available during the HTTP_HOST verification in the  `ServerRequestFactory::fromGlobals()` function, which leads to the verification being skipped entirely. This can allow an unauthenticated attacker to generate absolute URLs during the frontend rendering process which can be forged to any value the attacker requires  even in a name-based virtual hosts environment.\n\nThe vendor has mitigated against this by delaying the verification until after the `$GLOBALS['TYPO3_REQUEST']` variable is available.\n\n**Note:** The reintroduction of this vulnerability was caused by the setting  `$GLOBALS['TYPO3_CONF_VARS']['SYS']['trustedHostsPattern'] ` no longer being evaluated.",
    "publishedDate": "2021-10-05T16:22:49.386Z",
    "updatedDate": "2021-10-05T16:22:49.375Z",
    "disclosureDate": "2021-10-05T00:00:00.000Z",
    "solution": "Fixed in version [**11.5.0**](https://github.com/TYPO3/typo3/releases/tag/v11.5.0) by [this](https://github.com/TYPO3/typo3/commit/5cbff85506cebe343e5ae59228977547cf8e3cf4) commit.\n\nThe latest stable releases are available [here](https://get.typo3.org/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.7,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.2,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Benjamin Franzke",
    "workaround": "",
    "vendorFixDate": "2021-10-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2948",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41114",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2948/ranges"
            },
            {
                "rel": "reference",
                "href": "https://get.typo3.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/typo3/commit/5cbff85506cebe343e5ae59228977547cf8e3cf4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/typo3/releases/tag/v11.5.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-core-sa-2021-015",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2948/default-remediation-status"
            }
        ]
    }
}