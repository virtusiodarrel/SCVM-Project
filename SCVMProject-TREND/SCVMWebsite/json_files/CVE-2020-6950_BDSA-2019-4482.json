{
    "source": "BDSA",
    "name": "BDSA-2019-4482",
    "title": "Mojarra Vulnerable to Information Disclosure via Path Traversal in 'loc' and 'con' Parameters",
    "description": "Mojarra is vulnerable to information disclosure due to insufficient input sanitization of the locale prefix name and the contract name. An attacker can leverage this flaw to download configuration files or Java bytecodes from applications without authorization.",
    "technicalDescription": "This vulnerability exists in the `getLocalePrefix()` function of the `ResourceManager.java` source file. The problem is due to the lack of validation of the `localePrefix` variable retrieved from the `loc` parameter. The attacker can pass in strings like `../` to traverse beyond the intended directory and download configuration files or Java bytecodes from applications without authorization.\n\nThere was an incomplete fix for this issue by [this](https://github.com/eclipse-ee4j/mojarra/commit/475c71e282d695fbbb1946a75e267d1b8d9d7503) commit, which did not remove the malicious data from the `localePrefix` variable. In some circumstances the application continued to process this input.\n\nAdditionally, the same issue occurs in the `findPathConsideringContracts()` functions in `impl/src/main/java/com/sun/faces/application/resource/ClasspathResourceHelper.java` and `impl/src/main/java/com/sun/faces/application/resource/WebappResourceHelper.java` source files. This is due to a lack of validation of the `contractName` variable retrieved from the `con` parameter.",
    "publishedDate": "2020-07-08T12:38:10.552Z",
    "updatedDate": "2021-11-30T15:35:01.077Z",
    "disclosureDate": "2019-05-12T00:00:00.000Z",
    "solution": "Fixed in [**2.3.14**](https://github.com/eclipse-ee4j/mojarra/releases/tag/2.3.14-RELEASE) by [this](https://github.com/eclipse-ee4j/mojarra/commit/cefbb9447e7be560e59da2da6bd7cb93776f7741) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "An Trinh",
    "workaround": "",
    "vendorFixDate": "2019-09-05T00:00:00.000Z",
    "vendorNotifiedDate": "2019-05-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4482",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-23"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-6950",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4482/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse-ee4j/mojarra/commit/475c71e282d695fbbb1946a75e267d1b8d9d7503",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse-ee4j/mojarra/commit/cefbb9447e7be560e59da2da6bd7cb93776f7741",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse-ee4j/mojarra/issues/4571",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse-ee4j/mojarra/releases/tag/2.3.14-RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/javaserverfaces/mojarra/issues/4364",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4482/default-remediation-status"
            }
        ]
    }
}