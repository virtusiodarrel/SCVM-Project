{
    "source": "BDSA",
    "name": "BDSA-2020-0642",
    "title": "LeptonCMS Vulnerable to Stored Cross-Site Scripting (XSS) via 'content' Parameter in Page Edit Functionality",
    "description": "LeptonCMS is vulnerable to stored cross-site scripting (XSS) due to improper validation of user-supplied input in the page edit functionality of the WYSIWYG module. This could allow an authenticated attacker to inject arbitrary web scripts and steal sensitive information such as authentication tokens and user session cookies.",
    "technicalDescription": "The issue exists within the file `upload/modules/wysiwyg/save.php`. LeptonCMS does not sanitize the `content` parameter. An authenticated attacker could exploit this by editing and saving a page with maliciously crafted input targeting this parameter. If a victim accesses the page, any included web scripts will be executed.\n\nThere was an incomplete fix for this issue by [this](https://gitlab.com/lepton-cms/LEPTON/-/commit/7a93dbdfcf01cd78f308f5a11cdca8e27565ad91) commit, which was limited to removing script tags from user input. This was insufficient as an attacker could use alternative HTML event handlers to run JavaScript.",
    "publishedDate": "2020-04-07T10:44:02.952Z",
    "updatedDate": "2020-05-12T13:52:19.124Z",
    "disclosureDate": "2020-03-25T00:00:00.000Z",
    "exploitPublishDate": "2020-03-25T00:00:00.000Z",
    "solution": "Fixed in **[4.6.0](https://gitlab.com/lepton-cms/LE/-/tags/4.6.0)** by [this](https://gitlab.com/lepton-cms/LEPTON/-/commit/52215f708395a329c9e17ea33bfc6762d4efccbb) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sun Cyber Security Research",
    "workaround": "",
    "vendorFixDate": "2020-03-21T00:00:00.000Z",
    "discoveryDate": "2020-03-18T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0642",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12707",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0642/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/lepton-cms/LE/-/tags/4.6.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/lepton-cms/LEPTON/-/commit/52215f708395a329c9e17ea33bfc6762d4efccbb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/lepton-cms/LEPTON/-/commit/7a93dbdfcf01cd78f308f5a11cdca8e27565ad91",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/156905/leptoncms450-xss.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/156905/leptoncms450-xss.txt",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0642/default-remediation-status"
            }
        ]
    }
}