{
    "source": "BDSA",
    "name": "BDSA-2021-3395",
    "title": "uclibc and uclibc-ng Vulnerable to Domain Hijacking and Code Injection via Crafted Domain Names",
    "description": "uclibc and uclibc-ng are vulnerable to domain hijacking and code injection due to the improper validation of domains returned by domain name servers. This could be leveraged by an attacker in applications using the uclibc/uclibc-ng library which do not further validate processed domains, in order to perform domain spoofing or attacks such as remote code execution (RCE) or cross-site scripting (XSS).",
    "technicalDescription": "The issue exists within the file `libc/inet/resolv.c`. The functions `gethostbyname()`, `getaddrinfo()`, `gethostbyaddr()` and `getnameinfo()` do not properly validate special characters in domain names. This can allow malicious domains to be incorrectly transformed or crafted scripts to be injected.",
    "publishedDate": "2021-11-10T15:24:55.713Z",
    "updatedDate": "2022-07-06T09:41:55.222Z",
    "disclosureDate": "2021-11-09T00:00:00.000Z",
    "solution": "Fixed in uclibc-ng version [**1.0.39**](https://downloads.uclibc-ng.org/releases/1.0.39/) by [this](https://github.com/wbx-github/uclibc-ng/commit/0f822af0445e5348ce7b7bd8ce1204244f31d174) commit.\n\nThe latest stable releases are available [here](https://downloads.uclibc-ng.org/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Philipp Jeitner and Haya Shulman, Fraunhofer SIT",
    "workaround": "",
    "vendorFixDate": "2021-08-09T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3395",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43523",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3395/ranges"
            },
            {
                "rel": "reference",
                "href": "https://downloads.uclibc-ng.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://downloads.uclibc-ng.org/releases/1.0.39/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wbx-github/uclibc-ng/commit/0f822af0445e5348ce7b7bd8ce1204244f31d174",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2021/q4/101",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3395/default-remediation-status"
            }
        ]
    }
}