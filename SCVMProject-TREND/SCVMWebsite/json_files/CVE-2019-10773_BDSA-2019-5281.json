{
    "source": "BDSA",
    "name": "BDSA-2019-5281",
    "title": "Yarn Vulnerable to Symlink Attacks via Crafted 'bin' Keys During Package Install Process",
    "description": "Yarn is vulnerable to symlink attacks due to the improper handling of manifests during the package install process. This could allow an attacker to generate arbitrary symlinks and overwrite files by supplying a system with maliciously crafted `bin` keys.",
    "technicalDescription": "The issue exists within the file `src/util/normalize-manifest/fix.js`. During the `yarn install` process, the component does not validate that the `bin` field references a valid file name and is within the dependency tree. This can allow symlinks to be created which could arbitrarily overwrite existing files on the target system.",
    "publishedDate": "2021-09-27T13:28:12.762Z",
    "updatedDate": "2021-09-27T13:28:12.749Z",
    "disclosureDate": "2019-12-12T00:00:00.000Z",
    "exploitPublishDate": "2019-12-12T00:00:00.000Z",
    "solution": "Fixed in version [**1.22.0**](https://github.com/yarnpkg/yarn/releases/tag/v1.22.0) by [this](https://github.com/yarnpkg/yarn/commit/039bafd74b7b1a88a53a54f8fa6fa872615e90e7) commit.\n\nThe latest stable releases are available [here](https://github.com/yarnpkg/yarn/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Daniel Ruf",
    "workaround": "",
    "vendorFixDate": "2019-12-11T00:00:00.000Z",
    "vendorNotifiedDate": "2019-12-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5281",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-61"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10773",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5281/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.daniel-ruf.de/critical-design-flaw-npm-pnpm-yarn/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.daniel-ruf.de/critical-design-flaw-npm-pnpm-yarn/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yarnpkg/yarn/commit/039bafd74b7b1a88a53a54f8fa6fa872615e90e7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yarnpkg/yarn/issues/7761",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yarnpkg/yarn/issues/7761",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yarnpkg/yarn/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yarnpkg/yarn/releases/tag/v1.22.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5281/default-remediation-status"
            }
        ]
    }
}