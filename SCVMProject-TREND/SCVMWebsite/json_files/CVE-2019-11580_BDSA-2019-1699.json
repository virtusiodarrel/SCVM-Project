{
    "source": "BDSA",
    "name": "BDSA-2019-1699",
    "title": "Atlassian Crowd Vulnerable to Remote Code Execution (RCE) via 'pdkinstall' Development Plugin",
    "description": "Atlassian Crowd is vulnerable to remote code execution (RCE) due to functionality that is provided by an incorrectly enabled module. A remote attacker could install arbitrary plugins onto a vulnerable instance of Atlassian Crowd or Crowd Data Center by using crafted requests.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "The `pdkinstall-plugin` is an module used within Atlassian products to assist with the development and testing of Puppet code. This module assists users in the installation of plugins that can be used to extend functionality. Atlassian Crowd has this module enabled in such a manner that it is accessible in an arbitrary manner to both authenticated and unauthenticated users. A malicious user could therefore abuse this functionality by installing plugins that contain malicious code. This malicious code will then be executed by the targeted instance of Atlassian Crowd or Crowd Data Center.",
    "publishedDate": "2019-06-07T14:52:13.156Z",
    "updatedDate": "2022-05-05T15:09:52.207Z",
    "disclosureDate": "2019-05-06T00:00:00.000Z",
    "exploitPublishDate": "2019-07-16T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.0.5**](https://www.atlassian.com/software/crowd/download-archive)\n* [**3.1.6**](https://www.atlassian.com/software/crowd/download-archive)\n* [**3.2.8**](https://www.atlassian.com/software/crowd/download-archive)\n* [**3.3.5**](https://www.atlassian.com/software/crowd/download-archive)\n* [**3.4.4**](https://www.atlassian.com/software/crowd/download)",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor advises that the following steps are an effective workaround:\n\n* Stop Crowd.\n* Find and delete any pdkinstall-plugin jar files from the Crowd installation directory and the data directory.\n* Remove the pdkinstall-plugin jar file from `<Crowd installation directory>/crowd-webapp/WEB-INF/classes/atlassian-bundled-plugins.zip`\n\t\t\ta. Unzip the `<Crowd installation directory>/crowd-webapp/WEB-INF/classes/atlassian-bundled-plugins.zip` file.\n\t\t\tb. Delete the `pdkinstall-plugin-0.4.jar` file inside the extracted folder.\n\t\t\tc. Zip the contents of the folder back into `<Crowd installation directory>/crowd-webapp/WEB-INF/classes/atlassian-bundled-plugins.zip`\n* Start Crowd.\n* If you have any issues starting Crowd after these changes - clear the plugin cache.\n* Check that there are no `pdkinstall-plugin` jar files in the installation directory or the data directory.",
    "vendorFixDate": "2019-05-02T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1699",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-749"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11580",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1699/ranges"
            },
            {
                "rel": "reference",
                "href": "https://confluence.atlassian.com/crowd/crowd-security-advisory-2019-05-22-970260700.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://confluence.atlassian.com/crowd/crowd-security-advisory-2019-05-22-970260700.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.atlassian.com/software/crowd/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.atlassian.com/software/crowd/download-archive",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.tenable.com/blog/cve-2019-11580-proof-of-concept-for-critical-atlassian-crowd-remote-code-execution",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1699/default-remediation-status"
            }
        ]
    }
}