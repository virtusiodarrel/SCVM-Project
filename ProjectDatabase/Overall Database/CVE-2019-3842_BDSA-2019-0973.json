{
    "source": "BDSA",
    "name": "BDSA-2019-0973",
    "title": "Systemd Vulnerable to Privilege Escalation via PolicyKit Session Connection Spoofing",
    "description": "Systemd is vulnerable to privilege escalation due to insecure usage of an environmental variable in PAM. An authenticated attacker with SSH access could leverage this flaw to spoof a pre-existing active session to PolicyKit and assume its privileges.",
    "technicalDescription": "This flaw lies in the `getenv_harder()` function of the `src/login/pam_systemd.c` source file. Current code responsible for obtaining an environmental variable does not consider that it might get loaded into `su` or `sudo`. Since both of them run with `SUID` and do not clean their environment before invoking PAM modules `getenv(key)` may return a value which should be kept secret.\n\nAn authenticated remote attacker with SSH access could leverage this flaw to spoof a pre-existing active session to PolicyKit and assume its privileges. This permission level is normally only given to clients in an active session on the local console. Given the spoofed session can be running as root, this can lead to a complete system compromise.",
    "publishedDate": "2019-04-10T09:18:10.715Z",
    "updatedDate": "2021-08-26T15:11:09.175Z",
    "disclosureDate": "2019-04-08T00:00:00.000Z",
    "exploitPublishDate": "2019-04-23T00:00:00.000Z",
    "solution": "Fixed in [**242-rc4**](https://github.com/systemd/systemd/releases/tag/v242-rc4) by [this](https://github.com/systemd/systemd/commit/83d4ab55336ff8a0643c6aa627b31e351a24040a) commit.\n\nThe latest stable releases are available [here](https://github.com/systemd/systemd/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.1,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn",
    "workaround": "",
    "vendorFixDate": "2019-02-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-0973",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-290"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-3842",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-0973/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/commit/83d4ab55336ff8a0643c6aa627b31e351a24040a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/releases/tag/v242-rc4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.debian.org/debian-security-announce/2019/msg00072.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46743",
                "label": "POC"
            }
        ]
    }
}