{
    "source": "BDSA",
    "name": "BDSA-2021-2154",
    "title": "libcurl Incorrectly Uses Client Certificates due to CURLOPT_SSLCERT Naming Mix up",
    "description": "libcurl contains a vulnerability that can cause the wrong client certificate to be used in some rare circumstances. This can occur when libcurl is built to use the macOS native TLS library Secure Transport.",
    "technicalDescription": "The wrong client certificate can be used due to the native macOS TLS librarry providing an option for applications to ask for the client certificate by name or by file name (`CURLOPT_SSLCERT` option or `--cert` with the command line tool). In some (rare) circumstances the `sectransp_connect_step1` function in `lib/vtls/sectransp.c` will return the incorrect certificate when a client certificate name matches a file name.  This will cause the file to be used instead of the correct certificate.",
    "publishedDate": "2021-07-22T09:12:59.580Z",
    "updatedDate": "2021-07-22T09:12:59.574Z",
    "disclosureDate": "2021-07-21T00:00:00.000Z",
    "solution": "Fixed in [**7.78.0**](https://github.com/curl/curl/releases/tag/curl-7_78_0) by [this](https://github.com/curl/curl/commit/fd9b40bf8dfd43edcbc0d254d613d95a11061c05) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Harry Sintonen",
    "workaround": "",
    "vendorFixDate": "2021-07-20T00:00:00.000Z",
    "vendorNotifiedDate": "2021-06-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2154",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-295"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22926",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2154/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22926.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://daniel.haxx.se/blog/2021/06/07/bye-bye-metalink-in-curl/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://daniel.haxx.se/blog/2021/07/21/curl-7-78-0-five-in-one/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/d2fe616e7e",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/fd9b40bf8dfd43edcbc0d254d613d95a11061c05",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_78_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2154/default-remediation-status"
            }
        ]
    }
}