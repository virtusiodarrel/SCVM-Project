{
    "source": "BDSA",
    "name": "BDSA-2019-1820",
    "title": "dotCMS Vulnerable to SQL Injection via Improper Input Validation in 'discardConflicts' Function",
    "description": "An SQL injection vulnerability has been discovered in dotCMS. An attacker could exploit this vulnerability by injecting malicious characters to target the system database and execute malicious actions to retrieve information or corrupt the data.",
    "technicalDescription": "A weakness has been discovered in dotCMS which can be manipulated to launch SQL attacks against the system. The `discardConflict` function located in the file `dotCMS/src/main/java/com/dotcms/integritycheckers/AbstractIntegrityChecker.java` constructs an SQL statement from unsanitized parameter values.\n\nA malicious actor with publisher permissions can manipulate the `view_unpushed_bundles.jsp` file with malicious SQL code.",
    "publishedDate": "2019-06-19T13:40:45.932Z",
    "updatedDate": "2022-07-19T09:28:55.149Z",
    "disclosureDate": "2019-06-19T00:00:00.000Z",
    "solution": "Fixed in version [**5.1.6**](https://github.com/dotCMS/core/releases/tag/5.1.6) by [this](https://github.com/dotCMS/core/commit/ce5c3e8079d64929abb76ec3ec7ac7c71a4a26b6) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Johannes Moritz - RIPS TECHNOLOGIES GMBH",
    "workaround": "",
    "vendorFixDate": "2019-05-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1820",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12872",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1820/ranges"
            },
            {
                "rel": "reference",
                "href": "https://dotcms.com/security/SI-53",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/commit/ce5c3e8079d64929abb76ec3ec7ac7c71a4a26b6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/commit/ebd238ce19e8ff04bbefdd95010e573732394a20",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/issues/16624",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dotCMS/core/releases/tag/5.1.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1820/default-remediation-status"
            }
        ]
    }
}