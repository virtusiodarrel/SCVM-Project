{
    "source": "BDSA",
    "name": "BDSA-2020-4315",
    "title": "FreeBSD Vulnerable to Privilege Escalation via bhyve Guest Escape",
    "description": "FreeBSD is vulnerable to privilege escalation due to the mismanagement of system memory resources when using bhyve virtualization. A malicious guest could use this flaw to escape the virtual machine and completely take over the host machine.",
    "technicalDescription": "The vulnerability is caused by the fact that certain AMD instructions that operate on the physical addresses of the host and are not subject to nested page table translation do not cause an exception when the guest user invokes them. A malicious guest user could use this flaw to write to arbitrary host memory and take control of the host.\n\nSystems that use bhyve with an Intel CPU are not vulnerable.",
    "publishedDate": "2021-04-01T16:06:06.691Z",
    "updatedDate": "2021-04-01T16:06:06.686Z",
    "disclosureDate": "2020-09-15T00:00:00.000Z",
    "solution": "Fixed in versions **[12.2-STABLE](https://download.freebsd.org/ftp/releases/)** after revision [r365767](https://security.FreeBSD.org/patches/SA-20:29/bhyve_svm.patch) and **[11.4-STABLE](https://download.freebsd.org/ftp/releases/)** after revision [r365773](https://security.FreeBSD.org/patches/SA-20:29/bhyve_svm.patch).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:L/AC:L/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Maxime Villard",
    "workaround": "",
    "vendorFixDate": "2020-09-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4315",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-392"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7467",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4315/ranges"
            },
            {
                "rel": "reference",
                "href": "https://download.freebsd.org/ftp/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://security.FreeBSD.org/patches/SA-20:29/bhyve_svm.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-20:29.bhyve_svm.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4315/default-remediation-status"
            }
        ]
    }
}