{
    "source": "BDSA",
    "name": "BDSA-2021-1670",
    "title": "Django Vulnerable to Indeterminate Server-Side Request Forgery (SSRF) & Remote File Inclusion (RFI) via Improper Input Validation of Octal Literals",
    "description": "Django does not implement appropriate input validation measures for octal strings. This could make it vulnerable to server-side request forgery (SSRF), remote file inclusion (RFI) and local file inclusion (LFI). An attacker could exploit this flaw by supplying octal strings as a part of the IP address input.",
    "technicalDescription": "This vulnerability exists in the `validate_ipv4_address()`, `validate_ipv46_address()` and `URLValidator` components in Django and is due to the application allowing leading zeros within received IP addresses. An attacker could use octal strings as a part of IP addresses that could lead to their misinterpretation. For example, the IP address `010.8.8.8` will be interpreted as `10.8.8.8` instead of `8.8.8.8`. This could allow an attacker to conduct SSRF attacks by using malicious IP address strings as well as possibly allowing RFI and LFI attacks\n\nThe vendor has mitigated against this vulnerability by not permitting any leading zeros as a part of IP addresses.",
    "publishedDate": "2021-06-04T13:11:21.060Z",
    "updatedDate": "2021-06-04T13:11:21.055Z",
    "disclosureDate": "2021-06-02T00:00:00.000Z",
    "solution": "Fixed in:\n* The **main** branch by [this](https://github.com/django/django/commit/e1d787f1b36d13b95187f8f425425ae1b98da188) commit,\n* [**3.2.4**](https://github.com/django/django/releases/tag/3.2.4) by [this](https://github.com/django/django/commit/9f75e2e562fa0c0482f3dde6fc7399a9070b4a3d) commit,\n* [**3.1.12**](https://github.com/django/django/releases/tag/3.1.12) by [this](https://github.com/django/django/commit/203d4ab9ebcd72fc4d6eb7398e66ed9e474e118e) commit,\n* [**2.2.24**](https://github.com/django/django/releases/tag/2.2.24) by [this](https://github.com/django/django/commit/f27c38ab5d90f68c9dd60cabef248a570c0be8fc) commit.\n\nThe latest stable releases are available [here](https://www.djangoproject.com/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "",
    "workaround": "",
    "vendorFixDate": "2021-06-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1670",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33571",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1670/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue36384",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/203d4ab9ebcd72fc4d6eb7398e66ed9e474e118e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/9f75e2e562fa0c0482f3dde6fc7399a9070b4a3d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/e1d787f1b36d13b95187f8f425425ae1b98da188",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/f27c38ab5d90f68c9dd60cabef248a570c0be8fc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/2.2.24",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/3.1.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/3.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/weblog/2021/jun/02/security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1670/default-remediation-status"
            }
        ]
    }
}