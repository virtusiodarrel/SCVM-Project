{
    "source": "BDSA",
    "name": "BDSA-2021-1348",
    "title": "Bitcoin Core Vulnerable to Data Manipulation and Denial-of-Service (DoS) via Replace By Fee Policy",
    "description": "Bitcoin Core is vulnerable to data manipulation due to the Replace By Fee policy being improperly implemented. An attacker can take advantage of this by using an unconfirmed child transaction to trigger a loss of funds for another user, as well as trigger a denial-of-service (DoS).",
    "technicalDescription": "This vulnerability exists due to Bitcoin Core incorrectly implementing the Replace By Fee policy. This policy states that if an unconfirmed parent transaction is replaceable, then any related child transactions are also replaceable through inferred inheritance. However in Bitcoin Core it is  possible for child transactions to be replaced even if the parent transaction is not replaceable. An attacker can take advantage of this by using an unconfirmed child transaction to trigger a loss of funds for another user, as well as trigger a denial-of-service (DoS).",
    "publishedDate": "2021-05-14T15:00:27.381Z",
    "updatedDate": "2022-08-23T08:53:02.238Z",
    "disclosureDate": "2021-05-06T00:00:00.000Z",
    "solution": "Fixed in [**22.0rc1**](https://github.com/ElementsProject/elements/releases/tag/v22.0rc1) by [this](https://github.com/ElementsProject/elements/commit/82bc7faec8079b50f248655a97950087948f065d) commit.\n\nThe latest stable releases are available [here](https://github.com/bitcoin/bitcoin/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Antoine Riard",
    "workaround": "",
    "vendorFixDate": "2021-06-08T00:00:00.000Z",
    "discoveryDate": "2021-03-18T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1348",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-19"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-31876",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1348/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bitcoinops.org/en/newsletters/2021/05/12/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ElementsProject/elements/commit/82bc7faec8079b50f248655a97950087948f065d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ElementsProject/elements/releases/tag/v22.0rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bitcoin/bitcoin/pull/21946",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bitcoin/bitcoin/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-May/018893.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1348/default-remediation-status"
            }
        ]
    }
}