{
    "source": "BDSA",
    "name": "BDSA-2020-1061",
    "title": "Roundcube Webmail Vulnerable to Cross-Site Request Forgery (CSRF) Authenticated Session Logout via Token Check Bypasses",
    "description": "Webmail is vulnerable to cross-site request forgery (CSRF) in `index.php` due to logic flaws in checks applied on requests which can lead to authenticated users being logged out. An attacker could exploit this vulnerability by tricking an authenticated user into opening a malicious link which will then log them out of their current Webmail session.",
    "technicalDescription": "Webmail is vulnerable to cross-site request forgery (CSRF) session logout issues due to flaws in logic for both the login and logout actions in `index.php`.\n\nA login `POST` request that does not contain a valid token can delete the active session as the token checks applied on the request are not taken into account before `kill_session()` is called.\n\nA logout `POST` request that does not contain a valid token can end the session as the token check was only applied on logout `GET` requests.\n\nThe existence of these issues mean an attacker can craft a URL or web form that can potentially log out an authenticated user who is tricked into making the request.\n\nThe vulnerability was mitigated for login requests by checking for a valid token in login `POST` requests before calling `kill_session()`. The security checks for logout requests were also expanded to consider both `GET` and `POST` requests.",
    "publishedDate": "2020-05-14T10:50:41.967Z",
    "updatedDate": "2020-05-14T11:36:52.871Z",
    "disclosureDate": "2020-03-29T00:00:00.000Z",
    "exploitPublishDate": "2020-03-29T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.4.4**](https://github.com/roundcube/roundcubemail/releases/tag/1.4.4) by [this](https://github.com/roundcube/roundcubemail/commit/9bbda422ff0b782b81de59c86994f1a5fd93f8e6) commit.\n* [**1.3.11**](https://github.com/roundcube/roundcubemail/releases/tag/1.3.11) by [this](https://github.com/roundcube/roundcubemail/commit/1e7bec9cb868fa32b05acf6b0a557a6311350c56) commit.\n* [**1.2.10**](https://github.com/roundcube/roundcubemail/releases/tag/1.2.10) by [this](https://github.com/roundcube/roundcubemail/commit/cceeff2472c00acb2c6b96c9df7a289f1db77713) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Xudong Zheng",
    "workaround": "",
    "vendorFixDate": "2020-04-26T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1061",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12626",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1061/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/commit/1e7bec9cb868fa32b05acf6b0a557a6311350c56",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/commit/9bbda422ff0b782b81de59c86994f1a5fd93f8e6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/commit/cceeff2472c00acb2c6b96c9df7a289f1db77713",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/pull/7302",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/pull/7302",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/releases/tag/1.2.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/releases/tag/1.3.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/releases/tag/1.4.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1061/default-remediation-status"
            }
        ]
    }
}