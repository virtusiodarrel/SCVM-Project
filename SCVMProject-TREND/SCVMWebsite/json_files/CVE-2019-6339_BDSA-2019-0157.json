{
    "source": "BDSA",
    "name": "BDSA-2019-0157",
    "title": "Drupal Core Vulnerable to Remote Code Execution (RCE) via .phar File Stream Wrapper",
    "description": "Drupal Core is vulnerable to remote code execution (RCE) due to the incorrect handling of `.phar` files. An attacker with administrative access could execute arbitrary commands on the system running the application by tricking victims into navigating to a crafted `.phar` file.",
    "technicalDescription": "Drupal Core can process `.phar` files using code contained within the `PharStreamWrapper` name space.  These files archive complete PHP applications within a single file. Drupal Core treats `.php` files as being potentially dangerous, and converts them automatically to text files to prevent unintended code execution. Files with the `.phar` extension are not subject to the same security controls, despite the fact that they also expose an application to remote code execution vulnerabilities if user input is being processed. Therefore, an attacker with administrative access could potentially execute arbitrary commands on a system that is running applications that uses `.phar` files and which processes user-provided input.",
    "publishedDate": "2019-01-18T16:42:52.969Z",
    "updatedDate": "2021-01-28T10:02:06.359Z",
    "disclosureDate": "2019-01-15T00:00:00.000Z",
    "exploitPublishDate": "2019-04-11T00:00:00.000Z",
    "solution": "Fixed in version [**8.6.6**](https://github.com/drupal/core/releases/tag/8.6.6) by [this](https://github.com/drupal/core/commit/d8d246ca327398b5dbc2fd3afe03a7dc7ec3b1f5) commit.\n\nFixed in version [**8.5.9**](https://github.com/drupal/core/releases/tag/8.5.9) by [this](https://github.com/drupal/core/commit/3cce2c5eaf34d510f11e2838a601e7c2a52198c2) commit.\n\nFixed in version [**7.62**](https://www.drupal.org/project/drupal/releases/7.62)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.4,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 5.5,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "MULTIPLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "(AV:N/AC:M/Au:M/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.7,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-01-15T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0157",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-116"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-184"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-6339",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0157/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/core/commit/3cce2c5eaf34d510f11e2838a601e7c2a52198c2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/core/commit/d8d246ca327398b5dbc2fd3afe03a7dc7ec3b1f5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/core/releases/tag/8.5.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/core/releases/tag/8.6.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/thezdi/PoC/tree/master/Drupal",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/drupal/releases/7.62",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-core-2019-002",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.ixiacom.com/company/blog/exploiting-php-phar-deserialization-vulnerabilities-part-1",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0157/default-remediation-status"
            }
        ]
    }
}