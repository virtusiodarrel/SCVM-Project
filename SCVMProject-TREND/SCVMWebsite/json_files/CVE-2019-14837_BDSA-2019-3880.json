{
    "source": "BDSA",
    "name": "BDSA-2019-3880",
    "title": "Keycloak Vulnerable to Authentication Bypass via Use of Hard-Coded Open Domain",
    "description": "Keycloak is vulnerable to authentication bypass due to new service accounts utilizing a hard-coded open domain as default. A remote attacker could reset a user's password and gain access to their account by registering a mail server for that domain.",
    "technicalDescription": "Keycloak allows for the creation of service accounts. When a new service account is created, it is automatically associated with a placeholder email address. This email address is built using code contained within `ClientManager.java`, which constructs the email address as `username + \"@placeholder.org\"`. As the domain is hard-coded, it will be the same for all default service account email addresses. The password reset feature used within Keycloak will send an email to this address containing a link that can be used to set a new password for the service account. If an attacker has control of the `placeholder.org` domain, they could register an email server on that domain. If they know the client ID of a victim, they can then have the password reset email for that client ID sent to the email server, and then use the link to reset the password and gain access to the victim's account.",
    "publishedDate": "2019-12-11T14:32:38.530Z",
    "updatedDate": "2021-07-06T13:54:57.144Z",
    "disclosureDate": "2019-12-02T00:00:00.000Z",
    "exploitPublishDate": "2019-09-13T00:00:00.000Z",
    "solution": "Fixed in version [**8.0.0**](https://github.com/keycloak/keycloak/releases/tag/8.0.0) by [this](https://github.com/keycloak/keycloak/commit/9a7c1a91a59ab85e7f8889a505be04a71580777f) commit.\n\nThe latest stable releases can be found [here](https://github.com/keycloak/keycloak/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Vadim Ashikhman",
    "workaround": "It is possible to mitigate this by manually editing the default Email ID (`service_account_name@placeholder.org`) to some valid email ID (`abc@gmail.com`) in the `USER_ENTITY` table in the RHSSO database.",
    "vendorFixDate": "2019-10-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3880",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-453"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14837",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3880/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1730227",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1730227",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1730227",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/9a7c1a91a59ab85e7f8889a505be04a71580777f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/d8c1081578324957c4764a937e744314ee24749b",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases/tag/8.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3880/default-remediation-status"
            }
        ]
    }
}