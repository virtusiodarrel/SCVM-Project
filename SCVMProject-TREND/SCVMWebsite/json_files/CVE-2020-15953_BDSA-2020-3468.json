{
    "source": "BDSA",
    "name": "BDSA-2020-3468",
    "title": "LibEtPan Vulnerable to Response Injection via Mishandling of Extra Data in 'STARTTLS' Messages",
    "description": "LibEtPan is vulnerable to response injection due to the mishandling of extra data within 'STARTTLS' messages. An attacker could exploit this issue in order to inject malicious responses into a valid session, which could potentially allow them to mimic an entire session.",
    "technicalDescription": "The functions `mailimap_starttls()`, `mailpop3_stls()` and `mailesmtp_starttls()` contain code that is used for processing STARTTLS  exchanges in the POP3, IMAP and SMTP protocols. The application receives data in these exchanges via byte streams, which are implemented via structures. These structures contain a data buffer, the length of which is tracked by the `read_buffer_len` attribute. If the application reads a message that initiates TLS (e.g. `A OK begin TLS\\r\\n`), and data is located after the `\\r\\n` characters, then that data will be read into the aforementioned data buffer, with `read_buffer_len` being set to the length of the read data. This is a protocol violation, but is permitted by the application. An attacker could inject arbitrary data into responses by inserting it after the `\\r\\n` character sequence, which in worst-case scenarios could potentially allow them to mimic an entire session.",
    "publishedDate": "2020-11-23T10:37:45.843Z",
    "updatedDate": "2021-09-13T11:12:39.411Z",
    "disclosureDate": "2020-06-18T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/duesee/libetpan/commit/54627507a6979635016e149b1f5f738ff67) commit and [this](https://github.com/dinhvh/libetpan/commit/298460a2adaabd2f28f417a0f106cb3b68d27df9) commit in the **master** branch, which have not yet been included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-07-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3468",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-231"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15953",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3468/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dinhvh/libetpan/commit/298460a2adaabd2f28f417a0f106cb3b68d27df9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dinhvh/libetpan/issues/386",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/duesee/libetpan/commit/54627507a6979635016e149b1f5f738ff67",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3468/default-remediation-status"
            }
        ]
    }
}