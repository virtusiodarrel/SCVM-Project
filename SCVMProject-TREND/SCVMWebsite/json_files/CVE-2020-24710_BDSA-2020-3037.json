{
    "source": "BDSA",
    "name": "BDSA-2020-3037",
    "title": "Gophish Vulnerable to Server Side Request Forgery (SSRF) via 'Import Site' Feature",
    "description": "Gophish is vulnerable to server side request forgery (SSRF) via the 'Import Site' feature.  An authenticated attacker could use this issue to discover information about the internal network.",
    "technicalDescription": "It was discovered that this flaw could allow an authenticated attacker to perform port scans on the server hosting Gophish. The resulting error messages often disclosed the `localhost` or a `loopback` address in the banner of the service being tested. Where this information was not displayed, available ports could be inferred via long response times. \n\nThis was mitigated by restricting outbound connections to only allowed IP ranges, and the introduction of the `allowed_internal_hosts` flag, which lets an administrator set one or more IP ranges in `CIDR` format. If `allowed_internal_hosts` is in use then all internal connections will be blocked except these hosts.",
    "publishedDate": "2020-10-29T15:07:33.501Z",
    "updatedDate": "2020-10-29T15:07:33.487Z",
    "disclosureDate": "2020-09-29T00:00:00.000Z",
    "exploitPublishDate": "2020-07-24T00:00:00.000Z",
    "solution": "Fixed in [**0.11.0**](https://github.com/gophish/gophish/releases/tag/v0.11.0) by [this](https://github.com/gophish/gophish/commit/e3352f481e94054ffe08494c9225d3878347b005) commit.\n\nThe latest stable releases are available [here](https://github.com/gophish/gophish/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Marcus Nilsson of usd AG /  @dunderhay",
    "workaround": "",
    "vendorFixDate": "2020-08-20T00:00:00.000Z",
    "discoveryDate": "2020-06-18T00:00:00.000Z",
    "vendorNotifiedDate": "2020-06-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3037",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-24710",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3037/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gophish/gophish/commit/e3352f481e94054ffe08494c9225d3878347b005",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gophish/gophish/issues/1908",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gophish/gophish/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gophish/gophish/releases/tag/v0.11.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gophish/gophish/releases/tag/v0.11.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://herolab.usd.de/security-advisories/usd-2020-0054/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3037/default-remediation-status"
            }
        ]
    }
}