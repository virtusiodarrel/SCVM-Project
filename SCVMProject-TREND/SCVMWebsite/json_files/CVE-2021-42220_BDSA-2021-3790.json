{
    "source": "BDSA",
    "name": "BDSA-2021-3790",
    "title": "Dolibarr Vulnerable to Privilege Escalation via Stored Cross-Site Scripting (XSS) In 'Ticket Creation Flow' Functionality",
    "description": "Dolibarr contains a stored cross-site scripting (XSS) vulnerability due to lack of sufficient sanitization of user input (XSS). An attack with low level privileges can exploit this by passing malicious code, which when copied by an admin, can allow the attacker to gain full permissions.",
    "technicalDescription": "This vulnerability exists within the 'ticket creation flow'. An attacker with low-level user privileges and access to the `Tickets` module can trick an administrator into copying the malicious text in the `Message` field, achieving privilege escalation. For it to succeed, the payload must not include any HTML tags or JavaScript events forbidden by the WAF (Web Application Firewall).\n\n`onbeforecopy` and `onbeforecut` are two JavaScript events which are vulnerable to use in a crafted payload. This vulnerability is mitigated by including them on the WAF deny list.",
    "publishedDate": "2021-12-16T15:19:01.617Z",
    "updatedDate": "2021-12-16T15:19:01.605Z",
    "disclosureDate": "2021-10-09T00:00:00.000Z",
    "exploitPublishDate": "2021-10-09T00:00:00.000Z",
    "solution": "Fixed in version [**14.0.3**](https://github.com/Dolibarr/dolibarr/releases/tag/14.0.3) by [this](https://github.com/Dolibarr/dolibarr/commit/2f61c4e93bf94d2b55d086b8185ab10c5dce3948) commit.\n\nThe latest stable releases can be found [here](https://github.com/Dolibarr/dolibarr/tags)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Oscar Gutierrez",
    "workaround": "",
    "vendorFixDate": "2021-10-08T00:00:00.000Z",
    "vendorNotifiedDate": "2021-10-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3790",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-42220",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3790/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/commit/2f61c4e93bf94d2b55d086b8185ab10c5dce3948",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/releases/tag/14.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/164544/Dolibarr-ERP-CRM-14.0.2-Cross-Site-Scripting-Privilege-Escalation.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://truedigitalsecurity.com/advisory-summary-2021",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3790/default-remediation-status"
            }
        ]
    }
}