{
    "source": "BDSA",
    "name": "BDSA-2021-0673",
    "title": "Moodle Vulnerable to Information Disclosure via Improper Authorization in Individual Courses",
    "description": "Moodle does not contain proper authorization checks while allowing one user to view another user's enrolled courses. This could cause unauthorized information disclosure.",
    "technicalDescription": "This vulnerability primarily exists in `/enrol/externallib.php`. This file does not contain sufficient authorization measures when fetching the courses that other users have enrolled in. This results in the requesting entity being able to access profile information about other users. An attacker could exploit this flaw to cause information disclosure.",
    "publishedDate": "2021-03-16T16:12:07.258Z",
    "updatedDate": "2021-03-16T16:12:07.252Z",
    "disclosureDate": "2021-03-15T00:00:00.000Z",
    "solution": "Fixed by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=a251c260c43cd75da5fd615640be8d91e20174a2) commit\nin:\n* **[3.5.17](https://git.moodle.org/gw?p=moodle.git;a=tag;h=bec4e775007f5706ce7dd419630f6c9481831fa2)**\n* **[3.8.8](https://git.moodle.org/gw?p=moodle.git;a=tag;h=0c66ff02a81758ff1a99b60dc6f7812ede5f033d)**\n* **[3.9.5](https://git.moodle.org/gw?p=moodle.git;a=tag;h=ef0ebaf0f9e10ef47402a33bf777088767b653d7)**\n* **[3.10.2](https://git.moodle.org/gw?p=moodle.git;a=tag;h=a282d747c46b47a3a4623e29de7eb3399fb834ef)**",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Paul Holden",
    "workaround": "",
    "vendorFixDate": "2021-03-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0673",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20283",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0673/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=a251c260c43cd75da5fd615640be8d91e20174a2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=0c66ff02a81758ff1a99b60dc6f7812ede5f033d",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=a282d747c46b47a3a4623e29de7eb3399fb834ef",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=bec4e775007f5706ce7dd419630f6c9481831fa2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=ef0ebaf0f9e10ef47402a33bf777088767b653d7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=419654",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0673/default-remediation-status"
            }
        ]
    }
}