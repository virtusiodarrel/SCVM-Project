{
    "source": "BDSA",
    "name": "BDSA-2022-0681",
    "title": "Apache HTTP Server Vulnerable to HTTP Request Smuggling via Mishandling of Errors on Inbound Connections",
    "description": "Apache HTTP Server is vulnerable to an HTTP request smuggling issue due to how inbound connections are not closed when errors are encountered whilst discarding the request body.\n\nAn attacker could abuse this issue by sending crafted requests in order to bypass authorization checks which could allow access to unintended internal resources.",
    "technicalDescription": "To remedy this issue, the vendor has updated the close connection logic in the `ap_discard_request_body()` function of the `modules/http/http_filters.c` file to allow `AP_CONN_CLOSE` to be set within the function itself.",
    "publishedDate": "2022-03-14T17:13:55.888Z",
    "updatedDate": "2022-08-25T08:02:22.664Z",
    "disclosureDate": "2022-03-14T00:00:00.000Z",
    "exploitPublishDate": "2022-08-25T00:00:00.000Z",
    "solution": "Fixed in [**2.4.53-rc1**](https://github.com/apache/httpd/releases/tag/2.4.53-rc1-candidate) by [this](https://github.com/apache/httpd/commit/19aa2d83b379719420f3a178413325156d7a62f3) commit.\n\nThe latest stable releases are available [here](https://github.com/apache/httpd/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "James Kettle of Portswigger",
    "workaround": "",
    "vendorFixDate": "2022-03-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0681",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-22720",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0681/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/httpd/commit/19aa2d83b379719420f3a178413325156d7a62f3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/httpd/releases/tag/2.4.53-rc1-candidate",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/httpd/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1667974",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1667974",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://httpd.apache.org/security/vulnerabilities_24.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2022/q1/179",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0681/default-remediation-status"
            }
        ]
    }
}