{
    "source": "BDSA",
    "name": "BDSA-2021-1476",
    "title": "RPM Vulnerable to Database Corruption via Improper OpenPGP Signature Handling in 'rpmReadPackageFile' Function",
    "description": "RPM is vulnerable to database corruption due to the improper handling of signature header values. An attacker could corrupt a victim's RPM database by tricking them into installing a maliciously crafted package.",
    "technicalDescription": "The function `rpmReadPackageFile()`, of file `lib/package.c`, is used by RPM in order to read file headers. RPM files can contain a variety of headers, one of which is the signature header. This can contain signature tags. The function `headerMergeLegacySigs()` is used by `rpmReadPackageFile()` in order to copy signature tags from the signature header to the metadata header. These signature tags can then be copied to the RPM database. The tags that are copied are not validated. If corrupted signature tags are entered in to the database, then detrimental behavior can occur. Such behavior can include installed packages being irretrievable and installed dependencies being listed as missing. An attacker could exploit this vulnerability by tricking a victim into installing an unsupported or modified package.\n\nIt should be noted that any damage that is done to the database is not permanent, and data cannot be lost permanently. Database damage that has been caused by this vulnerability can be fixed by running the `rpmdb --rebuilddb` or `rpm --rebuilddb` commands.",
    "publishedDate": "2021-05-20T13:54:43.961Z",
    "updatedDate": "2021-05-20T13:54:43.954Z",
    "disclosureDate": "2021-03-03T00:00:00.000Z",
    "solution": "Fixed in [**4.17.0-alpha**](https://github.com/rpm-software-management/rpm/releases/tag/rpm-4.17.0-alpha) by [this](https://github.com/rpm-software-management/rpm/commit/d6a86b5e69e46cc283b1e06c92343319beb42e21) commit.\n\nThe latest stable releases are available [here](https://github.com/rpm-software-management/rpm/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Demi Marie Obenour",
    "workaround": "",
    "vendorFixDate": "2021-03-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1476",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-229"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3421",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1476/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1927747",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rpm-software-management/rpm/commit/d6a86b5e69e46cc283b1e06c92343319beb42e21",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rpm-software-management/rpm/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rpm-software-management/rpm/releases/tag/rpm-4.17.0-alpha",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1476/default-remediation-status"
            }
        ]
    }
}