{
    "source": "BDSA",
    "name": "BDSA-2022-1838",
    "title": "GitLab Vulnerable to Information Exposure via Insufficient IP-based Restrictions for Gitlab Runners",
    "description": "GitLab contains improper IP-based restrictions that allow an attacker having appropriate access tokens to obtain CI variables in a group by running the Gitlab Runner from an IP address that is outside the allowed IP range. This could result in exposure of restricted data.",
    "technicalDescription": "This vulnerability exists because the application contains insufficient IP-based restrictions for Gitlab Runners that are trying to pick up IP restricted jobs. Exploitation of this vulnerability will result in CI variables in a group being exposed to a Gitlab Runner that is being run from an IP address outside the allowed range. This restricted information will be exposed to an attacker that has the appropriate access tokens.\n\nThis issue has been mitigated by ensuring that the build process for a job is dropped when the group IP restrictions are triggered by the Gitlab Runner that is trying to pick up the job .",
    "publishedDate": "2022-07-04T13:57:30.556Z",
    "updatedDate": "2022-07-04T13:57:30.546Z",
    "disclosureDate": "2022-06-30T00:00:00.000Z",
    "solution": "Fixed in:\n* **[14.10.5](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.10.5)** by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/0fad0cdde00b68c2a0f19ffa2681b438fcad4097) commit,\n* **[15.0.4](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v15.0.4)** by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/dcc830d14cc0ee616dc3ad263d66bd42f92b56a2) commit,\n* **[15.1.1](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v15.1.1)** by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/9d6f0da89f6d2e8f3c7fbccea0d22fc6b17e0305) commit.\n\nThe latest stable releases are available [here](https://gitlab.com/gitlab-org/gitlab-foss/-/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "GitLab team",
    "workaround": "",
    "vendorFixDate": "2022-06-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1838",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-2228",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1838/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2022/06/30/critical-security-release-gitlab-15-1-1-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.10.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v15.0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v15.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/0fad0cdde00b68c2a0f19ffa2681b438fcad4097",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/9d6f0da89f6d2e8f3c7fbccea0d22fc6b17e0305",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/dcc830d14cc0ee616dc3ad263d66bd42f92b56a2",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1838/default-remediation-status"
            }
        ]
    }
}