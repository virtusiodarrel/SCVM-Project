{
    "source": "BDSA",
    "name": "BDSA-2021-2431",
    "title": "Node.js Vulnerable to Remote Code Execution (RCE) via Improper Handling of Untypical Characters in Domain Names",
    "description": "Node.js is vulnerable to remote code execution (RCE), cross-site scripting (XSS) and application crashes due to missing input validation of hostnames returned by Domain Name Servers in the Node.js Domain Name System (DNS) library. This could also lead to domain hijacking and injection vulnerabilities due to the wrong hostnames being output by the Node.js DNS library.",
    "technicalDescription": "The vulnerability is caused by the improper handling of untypical characters in domain names in c-ares, a library for asynchronous DNS requests used by Node.js. \n\nThe vendor highlights the following security issues:\n* NodeJS passes NULL for `addr` and 0 for `addrlen` to `ares_parse_ptr_reply()` on systems where `malloc(0)` returns NULL. This would cause a crash. \n* When building c-ares with CMake, the `RANDOM_FILE` would not be set and therefore downgrade to the less secure random number generator\n* If `ares_getaddrinfo()` was terminated by an `ares_destroy()`, it would cause a crash\n* Crash in `sortaddrinfo()` if the list size equals 0 due to an unexpected DNS response\n* Expand number of escaped characters in DNS replies as per RFC1035 5.1 to prevent spoofing\n* Perform validation on hostnames to prevent possible XSS due to applications not performing validation themselves",
    "publishedDate": "2021-08-13T16:18:22.601Z",
    "updatedDate": "2022-03-08T14:52:07.638Z",
    "disclosureDate": "2021-08-11T00:00:00.000Z",
    "exploitPublishDate": "2021-09-10T00:00:00.000Z",
    "solution": "Fixed in:\n* **[12.22.5](https://github.com/nodejs/node/releases/tag/v12.22.5)** by [this](https://github.com/nodejs/node/commit/5f947db68c) commit\n* **[14.17.5](https://github.com/nodejs/node/releases/tag/v14.17.5)** by [this](https://github.com/nodejs/node/commit/4923b59e0b) commit\n* **[16.6.2](https://github.com/nodejs/node/releases/tag/v16.6.2)** by [this](https://github.com/nodejs/node/commit/054537cdc2) commit\n\nThe latest stable releases are available [here](https://nodejs.org/en/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Philipp Jeitner from Fraunhofer SIT",
    "workaround": "",
    "vendorFixDate": "2021-08-10T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2431",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-476"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-74"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22931",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2431/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/commit/054537cdc2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/commit/054537cdc2b24605df829b098660bc486626e88c",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/commit/4923b59e0b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/commit/5f947db68c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/releases/tag/v12.22.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/releases/tag/v14.17.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/releases/tag/v16.6.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1178337",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1178337",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://nodejs.org/en/blog/vulnerability/aug-2021-security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://nodejs.org/en/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2431/default-remediation-status"
            }
        ]
    }
}