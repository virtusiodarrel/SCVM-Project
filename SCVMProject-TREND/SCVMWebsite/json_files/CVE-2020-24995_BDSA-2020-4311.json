{
    "source": "BDSA",
    "name": "BDSA-2020-4311",
    "title": "ffmpeg Vulnerable to Remote Code Execution (RCE) via Buffer Overflow in 'sniff_channel_order' Function",
    "description": "ffmpeg contains a vulnerability that could lead to code execution. An attacker could exploit this by tricking a victim into processing a malicious file, or supply a file to a remote system that processes them automatically with ffmpegs libavcodec, resulting in a stack based buffer overflow condition occurring.",
    "technicalDescription": "This vulnerability exists within the `sniff_channel_order` function in the `aacdec_template.c` file. The vendor addressed the issue by validating the set channel layout as well as verifying that the received layout to the function matches the reference layout, so that it matches the implemented re-ordering logic.",
    "publishedDate": "2021-03-31T17:45:05.418Z",
    "updatedDate": "2021-04-15T14:11:26.410Z",
    "disclosureDate": "2020-08-18T00:00:00.000Z",
    "exploitPublishDate": "2020-08-18T00:00:00.000Z",
    "solution": "Fixed in [**4.4**](https://github.com/FFmpeg/FFmpeg/releases/tag/n4.4) by [this](http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=d6f293353c94c7ce200f6e0975ae3de49787f91f) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "UNCONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:UC)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "UNKNOWN",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:U"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-08-24T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4311",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-24995",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4311/ranges"
            },
            {
                "rel": "reference",
                "href": "http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=d6f293353c94c7ce200f6e0975ae3de49787f91f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FFmpeg/FFmpeg/releases/tag/n4.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://trac.ffmpeg.org/ticket/8845",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://trac.ffmpeg.org/ticket/8845",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4311/default-remediation-status"
            }
        ]
    }
}