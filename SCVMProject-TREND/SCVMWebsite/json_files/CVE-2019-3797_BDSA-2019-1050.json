{
    "source": "BDSA",
    "name": "BDSA-2019-1050",
    "title": "Spring Data JPA Vulnerable to Information Exposure via Wildcard Characters in Derived Queries",
    "description": "Spring Data JPA is vulnerable to information exposure due to improper validation of user-supplied input for certain derived queries. This could allow an attacker to obtain sensitive information by executing queries which return more results than intended.",
    "technicalDescription": "Spring Data JPA does not escape `_` or `%` characters in derived queries using the `startingWith`, `endingWith` or `containing` predicate. This can allow an attacker to supply malicious queries including these characters which will perform wildcard matching and return more results than expected. Additionally, there is improper handling of the escape character (for matching of actual wildcard characters) in manually defined `LIKE` expressions which could lead to unpredictable query results.",
    "publishedDate": "2019-04-15T10:20:11.043Z",
    "updatedDate": "2019-04-15T10:20:10.745Z",
    "disclosureDate": "2019-04-01T00:00:00.000Z",
    "exploitPublishDate": "2019-04-01T00:00:00.000Z",
    "solution": "Fixed in:\n* **[2.1.6](https://github.com/spring-projects/spring-data-jpa/releases/tag/2.1.6.RELEASE)**\n* **[2.0.14](https://github.com/spring-projects/spring-data-jpa/releases/tag/2.0.14.RELEASE)**\n* **[1.11.20](https://github.com/spring-projects/spring-data-jpa/releases/tag/1.11.20.RELEASE)**\n\nFixed by these commits:\n* [Commit 1](https://github.com/spring-projects/spring-data-jpa/commit/9b16fef6e9a1c8f4352cb979df8ef4a9336d6552)\n* [Commit 2](https://github.com/spring-projects/spring-data-jpa/commit/16661f7e7e28f8ea8585a0402bd91eb6721ce55b)\n* [Commit 3](https://github.com/spring-projects/spring-data-jpa/commit/ee39e8863bb43b63e34fe9ac6ec9b864cd8afca9)\n* [Commit 4](https://github.com/spring-projects/spring-data-jpa/commit/417202db8e1714bdca1bd57879634866934c6f54)\n* [Commit 5](https://github.com/spring-projects/spring-data-jpa/commit/170092f47ca3ad4b32eee3c9c6f81fe7762979ad)\n* [Commit 6](https://github.com/spring-projects/spring-data-jpa/commit/d15f5efc56bfb2738582ac2cccb320bfc5f390d0)\n\nThe latest stable releases are available [here](https://github.com/spring-projects/spring-data-jpa/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Maruthi Adithya G",
    "workaround": "",
    "vendorFixDate": "2019-04-01T00:00:00.000Z",
    "vendorNotifiedDate": "2019-03-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1050",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3797",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1050/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-jpa/commit/16661f7e7e28f8ea8585a0402bd91eb6721ce55b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-jpa/commit/170092f47ca3ad4b32eee3c9c6f81fe7762979ad",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-jpa/commit/417202db8e1714bdca1bd57879634866934c6f54",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-jpa/commit/9b16fef6e9a1c8f4352cb979df8ef4a9336d6552",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-jpa/commit/d15f5efc56bfb2738582ac2cccb320bfc5f390d0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-jpa/commit/ee39e8863bb43b63e34fe9ac6ec9b864cd8afca9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-jpa/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-jpa/releases/tag/1.11.20.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-jpa/releases/tag/2.0.14.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-jpa/releases/tag/2.1.6.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jira.spring.io/browse/DATAJPA-1519",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://jira.spring.io/browse/DATAJPA-1519",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://jira.spring.io/browse/DATAJPA-1522",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://pivotal.io/security/cve-2019-3797",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1050/default-remediation-status"
            }
        ]
    }
}