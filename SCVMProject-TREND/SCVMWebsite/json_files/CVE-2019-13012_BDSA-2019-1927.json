{
    "source": "BDSA",
    "name": "BDSA-2019-1927",
    "title": "GNOME GLib Vulnerable to Arbitrary File Access via Improper Access Control in 'g_file_make_directory_with_parents' Functionality",
    "description": "An improper access control vulnerability has been discovered in GNOME GLib. An attacker could exploit this vulnerability to access restricted directories that utilize default file permissions to read sensitive information or execute arbitrary code against the system.",
    "technicalDescription": "A weakness has been discovered in GNOME Glib which can lead to arbitrary file access. The `g_file_make_directory_with_parents` function located in the file `gio/gkeyfilesettingsbackend.c` utilizes NULL parameter values during the creation of directories. The `g_file_replace_contents` also utilizes static variables in the creation of system files. This can cause an issue as the default permission levels `0777` are assigned, granting unauthorized users to access the system structure which could aid in the execution of malicious code against the system.\n\nIt should be noted that the back-ported solution that was implemented in Ubuntu 16.04 LTS  was insufficient, and created a memory leak. This memory leak is due to the fact that his back-ported fix uses the `g_file_get_path()` function instead of `g_file_peek_path()`. Whenever `g_file_get_path()` is called, a new memory buffer is created. The fix neglects to free the memory contained in this buffer, which constitutes a memory leak. Users of the Ubuntu 16.04 LTS distribution should ensure that they have upgraded their version of the GLib package to that which is specified in the Solution field.",
    "publishedDate": "2019-07-01T09:22:09.510Z",
    "updatedDate": "2020-08-10T12:58:47.100Z",
    "disclosureDate": "2019-01-21T00:00:00.000Z",
    "solution": "Fixed in version [**2.60.0**](https://gitlab.gnome.org/GNOME/glib/-/tags/2.60.0) by [this](https://gitlab.gnome.org/GNOME/glib/commit/5e4da714f) commit.\n\nThe regression that was caused in the back-ported solution for the Ubuntu 16.04 LTS (Xenial Xerus) distribution was fixed in version [**2.48.2-0ubuntu4.4**](https://launchpad.net/ubuntu/+source/glib2.0/2.48.2-0ubuntu4.4) by [this](http://launchpadlibrarian.net/436086697/glib2.0_2.48.2-0ubuntu4.3_2.48.2-0ubuntu4.4.diff.gz) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-01-22T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1927",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-276"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13012",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1927/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/-/tags/2.60.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/commit/5e4da714f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/issues/1658",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1927/default-remediation-status"
            }
        ]
    }
}