{
    "source": "BDSA",
    "name": "BDSA-2019-4683",
    "title": "Istio Vulnerable to Denial-of-Service (DoS) via Envoy CPU Resource Consumption",
    "description": "Istio is vulnerable to a denial-of-service (DoS) condition due to how an infinite loop can be triggered in the Envoy component.\n\nAn attacker could trigger this issue in order to exhaust CPU resources which can impact the system's availability to legitimate users and their requests.",
    "technicalDescription": "Istio is vulnerable to a denial-of-service (DoS) condition because an infinite loop scenario can be induced in the Envoy proxy component if the `continue_of_listener_filters_timeout` option is set to True.\n\nThe vendor has stated that both Istio gateways and sidecars are vulnerable to this issue. If an affected release is being used, your cluster is vulnerable.",
    "publishedDate": "2020-09-22T15:17:53.040Z",
    "updatedDate": "2020-09-22T15:17:53.034Z",
    "disclosureDate": "2019-11-07T00:00:00.000Z",
    "solution": "Upstream fixes were made to Istio Envoy by [this](https://github.com/istio/envoy/commit/de61162e207b2ab3ea42ae72afa4b8f7fc346ec7) commit.\n\nThe fixes were included in the main Istio code repository in [**1.3.5**](https://github.com/istio/istio/releases/tag/1.3.5) by [this](https://github.com/istio/istio/commit/9c4f3fa302ac85a70ec5b03049c6a66a5b626f7a) commit.\n\nThe latest stable releases are available [here](https://github.com/istio/istio/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has suggested a workaround [here](https://istio.io/latest/news/security/istio-security-2019-006/):\n\nThe exploitation of that vulnerability can be prevented by customizing Istio installation (as described in installation options ), using Helm to override the following options:\n\n`--set pilot.env.PILOT_INBOUND_PROTOCOL_DETECTION_TIMEOUT=0s --set global.proxy.protocolDetectionTimeout=0s`",
    "vendorFixDate": "2019-11-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4683",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-18817",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4683/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/envoy/commit/de61162e207b2ab3ea42ae72afa4b8f7fc346ec7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/envoy/pull/118",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/commit/9c4f3fa302ac85a70ec5b03049c6a66a5b626f7a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/issues/18229",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/releases/tag/1.3.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/proxy/pull/2532",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://istio.io/latest/news/security/istio-security-2019-006/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://istio.io/latest/news/security/istio-security-2019-006/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4683/default-remediation-status"
            }
        ]
    }
}