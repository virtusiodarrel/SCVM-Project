{
    "source": "BDSA",
    "name": "BDSA-2018-5012",
    "title": "Python Vulnerable to Information Disclosure via 'domain_return_ok' Object",
    "description": "Python is vulnerable to information disclosure through the http library by failing to confirm the origin of cookies before sending them.",
    "technicalDescription": "The `http.cookiejar.DefaultPolicy.domain_return_ok` object returns `False` if cookies should not be returned, given the cookie domain. It checks the domain of the cookie and the domain of the http request being made and if they are matching it returns `True`. \nHowever, it also returns `True` when the domain is a suffix match of the domain compared to - e.g. `foo.bar` vs `fakefoo.bar`- due to a missing condition check. This issue can lead to leaking existing cookies of `foo.bar` to an attacker-controlled  server, `fakefoo.bar`, when the request is made via the vulnerable http client.",
    "publishedDate": "2019-07-16T09:41:49.835Z",
    "updatedDate": "2019-07-16T09:41:49.824Z",
    "disclosureDate": "2018-10-31T00:00:00.000Z",
    "exploitPublishDate": "2018-10-31T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/python/cpython/commit/ca7fe5063593958e5efdf90f068582837f07bd14) commit in:\n* [**3.5.7**](https://github.com/python/cpython/releases/tag/v3.5.7)\n* [**3.6.9rc1**](https://github.com/python/cpython/releases/tag/v3.6.9rc1)\n* [**3.7.3rc1**](https://github.com/python/cpython/releases/tag/v3.7.3rc1)\n* [**3.4.10**](https://github.com/python/cpython/releases/tag/v3.4.10)\n* [**2.7.16**](https://github.com/python/cpython/releases/tag/v2.7.16)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "\u897f\u7530\u96c4\u6cbb (\u897f\u7530\u96c4\u6cbb)",
    "workaround": "",
    "vendorFixDate": "2019-03-10T00:00:00.000Z",
    "vendorNotifiedDate": "2018-10-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-5012",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-20852",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-5012/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue35121",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue35121",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/ca7fe5063593958e5efdf90f068582837f07bd14",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v2.7.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.4.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.5.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.6.9rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.7.3rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://python-security.readthedocs.io/vuln/cookie-domain-check.html",
                "label": "ADVISORY"
            }
        ]
    }
}