{
    "source": "BDSA",
    "name": "BDSA-2020-0886",
    "title": "Squid Vulnerable to Remote Code Execution (RCE) and Authentication Bypass via Integer Overflow in Nonce Reference Counter",
    "description": "Squid is vulnerable to remote code execution (RCE) and authentication bypass due to the improper management of system memory resources. A remote attacker could execute arbitrary code on a vulnerable server, or gain access to restricted resources, by using maliciously crafted web requests.",
    "technicalDescription": "The variable `references` is defined within `Config.h` has a type `short` integer. This variable is used to store a nonce reference counter, which is used within Squid's digest authentication scheme. This variable is associated with the `nonce` data structure, and is used within the `authDigestNonceLink()` function of `Config.cc` as part of the authentication process. The small size of the `short` data type means that it is feasible for an attacker to overflow the `references` variable by replaying digest authentication nonces that they have sniffed. If memory pooling as been disabled on the target system, this could allow the attacker to access restricted resources on that system. If memory pooling is disabled, the attacker may be able to achieve remote code execution via  the nonce credentials, once those nonce credentials have been freed.",
    "publishedDate": "2020-04-23T16:00:45.850Z",
    "updatedDate": "2021-08-10T11:22:36.999Z",
    "disclosureDate": "2020-04-23T00:00:00.000Z",
    "solution": "Fixed in [**5.0.2**](https://github.com/squid-cache/squid/releases/tag/SQUID_5_0_2) by [this](https://github.com/squid-cache/squid/commit/e0c9a32e9133e1ddc95f4f84a9989d8146d27664) commit.\nFixed in [**4.11**](https://github.com/squid-cache/squid/releases/tag/SQUID_4_11) by [this](https://github.com/squid-cache/squid/commit/eeebf0f37a72a2de08348e85ae34b02c34e9a811) commit.\n\nThe latest stable releases are available [here](https://github.com/squid-cache/squid/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Cl\u00e9ment Berthaux,  Florian Guilbert (Synacktiv)",
    "workaround": "One of the following actions can be performed as a workaround:\n* Remove all `auth_param digest` lines from `squid.conf`.\n* Build Squid with `--disable-auth-digest`\n* Build Squid with `--disable-auth`",
    "vendorFixDate": "2020-04-13T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0886",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11945",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0886/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Advisories/SQUID-2020_4.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Advisories/SQUID-2020_4.txt",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/aba0474c1031f89ad9aae5b3e4973ef6a14292e3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/e0c9a32e9133e1ddc95f4f84a9989d8146d27664",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/eeebf0f37a72a2de08348e85ae34b02c34e9a811",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/pull/585",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/releases/tag/SQUID_4_11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/releases/tag/SQUID_5_0_2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0886/default-remediation-status"
            }
        ]
    }
}