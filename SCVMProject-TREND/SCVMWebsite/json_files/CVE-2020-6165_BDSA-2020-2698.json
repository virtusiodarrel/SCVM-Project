{
    "source": "BDSA",
    "name": "BDSA-2020-2698",
    "title": "silverstripe-graphql Vulnerable to Information Disclosure via 'CanViewPermissionChecker' Function",
    "description": "silverstripe-graphql is vulnerable to information disclosure via the `CanViewPermissionChecker` function. This could allow an attacker to read records that have been incorrectly placed into a result set.",
    "technicalDescription": "This issue occurs in the `CanViewPermissionChecker` function of the `src/Permission/CanViewPermissionChecker.php` file. The automatic permission checking fails to provide complete protection against lists that are limited. This can result in records which should have failed the permission check being added to the final set of results. This vulnerability is limited to users with access to the content management system (CMS), but still applies when those authenticated users have limited permissions such as where viewing records requires administrator permissions.\n\nThis vulnerability could be exploited through unauthenticated requests if custom GraphQL endpoints have been configured.",
    "publishedDate": "2020-10-09T13:32:34.620Z",
    "updatedDate": "2020-10-09T13:32:34.614Z",
    "disclosureDate": "2020-07-13T00:00:00.000Z",
    "solution": "Fixed in [**3.2.4**](https://github.com/silverstripe/silverstripe-graphql/releases/tag/3.2.4) by [this](https://github.com/silverstripe/silverstripe-graphql/commit/107e6c918bb6a6a536dd9e3d8f5c74b4acdfd852) commit and [**3.3.0**](https://github.com/silverstripe/silverstripe-graphql/releases/tag/3.3.0) by [this](https://github.com/silverstripe/silverstripe-graphql/commit/044eb43ad02428b17a881e47a0ff8aa8d159eb9c) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matthias Leutenegger, CEO, Syntro GmbH and Rob Ingram",
    "workaround": "",
    "vendorFixDate": "2020-07-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2698",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-276"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-6165",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2698/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-graphql/commit/044eb43ad02428b17a881e47a0ff8aa8d159eb9c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-graphql/commit/107e6c918bb6a6a536dd9e3d8f5c74b4acdfd852",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-graphql/releases/tag/3.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-graphql/releases/tag/3.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.silverstripe.org/download/security-releases/CVE-2020-6165",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2698/default-remediation-status"
            }
        ]
    }
}