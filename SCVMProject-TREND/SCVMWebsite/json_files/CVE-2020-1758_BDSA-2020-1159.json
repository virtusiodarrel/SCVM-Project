{
    "source": "BDSA",
    "name": "BDSA-2020-1159",
    "title": "Keycloak Vulnerable to Man-in-the-Middle (MitM) Attack via Improper Hostname Verification",
    "description": "It was discovered that Keycloak is vulnerable to man-in-the-middle (MitM) attacks. Due to insufficient hostname verification while sending emails using the SMTP server, an attacker could exploit this flaw to obtain sensitive information.",
    "technicalDescription": "The vulnerability occurs due to Keycloak failing to verify the TLS hostname while sending emails using the SMTP server. Successfully exploiting this vulnerability could allow an attacker to perform MitM attacks, to intercept and obtain sensitive information.",
    "publishedDate": "2020-05-19T15:15:10.613Z",
    "updatedDate": "2021-03-08T15:54:23.239Z",
    "disclosureDate": "2020-03-11T00:00:00.000Z",
    "solution": "Fixed in version [**10.0.0**](https://github.com/keycloak/keycloak/releases/tag/10.0.0) by [this](https://github.com/keycloak/keycloak/commit/97b565469058cacac6d2559b2cff37effcca2cfd) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Peter St\u00f6ckli",
    "workaround": "Disable email notifications including password reset mails.",
    "vendorFixDate": "2020-03-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1159",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-297"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-1758",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1159/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/cve-2020-1758",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-1758",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/97b565469058cacac6d2559b2cff37effcca2cfd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases/tag/10.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1159/default-remediation-status"
            }
        ]
    }
}