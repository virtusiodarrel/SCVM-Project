{
    "source": "BDSA",
    "name": "BDSA-2021-1301",
    "title": "OctoPrint Vulnerable to Reflected Cross-Site Scripting (XSS) via API Error Message Functionality",
    "description": "OctoPrint contains a reflected cross-site scripting (XSS) vulnerability due to lack of sanitization of user-supplied input. An attacker can then exploit this by executing malicious scripts in the context of the browser, allowing the theft of session tokens, cookies and sensitive information.",
    "technicalDescription": "This vulnerability exists within the APIs error messaging functionality at the `/api/files` endpoint,  when a non existing file was requested via a `HTTP DELETE` request. This would allow for the path to be echoed back with the decoded URL. Attackers could then exploit this vulnerability by injecting malicious scripts using any type of bracket within the document body to then be executed when rendered in the victim's browser. The vendor addressed this by preventing the returning of input parameters.",
    "publishedDate": "2021-05-12T10:30:14.501Z",
    "updatedDate": "2021-08-11T15:08:05.054Z",
    "disclosureDate": "2021-04-27T00:00:00.000Z",
    "exploitPublishDate": "2021-05-11T00:00:00.000Z",
    "solution": "Fixed in [**1.6.0rc1**](https://github.com/OctoPrint/OctoPrint/releases/tag/1.6.0rc1) by [this](https://github.com/OctoPrint/OctoPrint/commit/a441e489061b6b22eb1b048dcbc1d7f6fedfcfd0) commit.\n\nThe latest stable release are available [here](https://github.com/OctoPrint/OctoPrint/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1301",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32561",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1301/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OctoPrint/OctoPrint/commit/a441e489061b6b22eb1b048dcbc1d7f6fedfcfd0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OctoPrint/OctoPrint/releases/tag/1.6.0rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OctoPrint/OctoPrint/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.brzozowski.io/web-applications/2021/05/11/the-insecure-story-of-octoprint.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.brzozowski.io/web-applications/2021/05/11/the-insecure-story-of-octoprint.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1301/default-remediation-status"
            }
        ]
    }
}