{
    "source": "BDSA",
    "name": "BDSA-2018-5123",
    "title": "OpenPGP.js Vulnerable to Improper Verification of Cryptographic Signature in 'signature.js'",
    "description": "OpenPGP.js contains an improper verification of cryptographic signature vulnerability which could allow an attacker to convince a victim to use an obsolete key for encryption by modifying a key certification signature or revocation signature.",
    "technicalDescription": "The `Signature.prototype.read` function in `src/packet/signature.js` treats hashed and unhashed subpackets with the same trust level. The hashed subpackets are cryptographically signed for validity, whereas the unhashed subpackets are not secured at all. The function processes hashed subpackets first, followed by unhashed subpackets, when the unhashed subpackets are processed the content from the hashed subpackets is overwritten. This allows an attacker to arbitrarily change the content of values such as the key certification\nsignature or revocation signature which could cause the victim to use and trust an encryption key that is obsolete.",
    "publishedDate": "2020-03-11T19:07:57.817Z",
    "updatedDate": "2020-03-11T19:07:57.805Z",
    "disclosureDate": "2018-11-05T00:00:00.000Z",
    "exploitPublishDate": "2019-08-22T00:00:00.000Z",
    "solution": "Fixed in version [**4.2.0**](https://github.com/openpgpjs/openpgpjs/releases/tag/v4.2.0) by [this](https://github.com/openpgpjs/openpgpjs/commit/47138eed61473e13ee8f05931119d3e10542c5e1) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wolfgang Ettlinger - SEC Consult Vulnerability Lab",
    "workaround": "",
    "vendorFixDate": "2018-10-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5123",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-347"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9154",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5123/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openpgpjs/openpgpjs/commit/47138eed61473e13ee8f05931119d3e10542c5e1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openpgpjs/openpgpjs/releases/tag/v4.2.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openpgpjs/openpgpjs/releases/tag/v4.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/154191/OpenPGP.js-4.2.0-Signature-Bypass-Invalid-Curve-Attack.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/154191/OpenPGP.js-4.2.0-Signature-Bypass-Invalid-Curve-Attack.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5123/default-remediation-status"
            }
        ]
    }
}