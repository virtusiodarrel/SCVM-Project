{
    "source": "BDSA",
    "name": "BDSA-2022-1507",
    "title": "Smarty3 Vulnerable to Remote Code Execution (RCE) via 'static_classes' Security Policy Bypass",
    "description": "Smarty3 is vulnerable to remote code execution (RCE) due to the improper enforcement of restrictions on static PHP methods. A remote attacker with template authoring privileges could execute arbitrary PHP code on a vulnerable server by sending maliciously crafted math strings to that server.",
    "technicalDescription": "Smarty3 servers can implement the `static_classes` security policy, which is used to impose restrictions on static PHP methods. However, this policy can be bypassed through the use of dynamic static classes. This is possible due to insufficient checks being performed within Smarty3's template parser functionality, as implemented in the files `lexer/smarty_internal_templateparser.y` and `libs/sysplugins/smarty_internal_templateparser.php`. The vulnerability was fixed via the addition of extra validation logic.",
    "publishedDate": "2022-05-31T15:57:49.826Z",
    "updatedDate": "2022-08-23T11:38:34.549Z",
    "disclosureDate": "2022-01-10T00:00:00.000Z",
    "solution": "Fixed in version [**4.0.3**](https://github.com/smarty-php/smarty/releases/tag/v4.0.3) by [this](https://github.com/smarty-php/smarty/commit/19ae410bf56007a5ef24441cdc6414619cfaf664) commit, and in [**3.1.43**](https://github.com/smarty-php/smarty/releases/tag/v3.1.14) by [this](https://github.com/smarty-php/smarty/commit/28519ca00fe6890ef2d464f8400a16188c4b6f36) commit.\n\nThe latest stable releases can be found [here](https://github.com/smarty-php/smarty/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-01-10T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1507",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-693"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21408",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1507/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/commit/19ae410bf56007a5ef24441cdc6414619cfaf664",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/commit/28519ca00fe6890ef2d464f8400a16188c4b6f36",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/releases/tag/v3.1.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/releases/tag/v4.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/security/advisories/GHSA-4h9c-v5vg-5m6m",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1507/default-remediation-status"
            }
        ]
    }
}