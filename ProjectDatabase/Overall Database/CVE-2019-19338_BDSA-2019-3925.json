{
    "source": "BDSA",
    "name": "BDSA-2019-3925",
    "title": "Linux Kernel Vulnerable to CPU Side Channel Attack via Incomplete Fix for TSX Asynchronous Abort (TAA) Issue",
    "description": "The Linux Kernel is vulnerable to a side-channel information leak. An attacker running code locally on the machine could leak sensitive information across privilege boundaries such as process, user/kernel, virtual machine and secure enclaves (SGX). This vulnerability exists because of an incomplete fix for CVE-2019-11135.",
    "technicalDescription": "The current Kernel fixes for TAA (TSX Asynchronous Abort) don't completely fix the issue for guest VMs. If a guest is running on a host CPU affected by TAA (`TAA_NO=0`) but not affected by the MDS issue (`MDS_NO=1`) the guest was to clear the affected buffers using the `VERW` instruction mechanism. When the `MDS_NO=1` bit was exported to the guests, it did not correctly use the `VERW` mechanism to clear the affected buffers. \n\nThis issue affects guests running on Cascade Lake CPUs, which are affected by the TAA issue but not by the MDS issue. The host must have TSX enabled.",
    "publishedDate": "2019-12-17T13:04:19.730Z",
    "updatedDate": "2020-01-21T16:10:52.981Z",
    "disclosureDate": "2019-12-10T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.207**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b8911ed37d0b1de644ee6fc48547d2c6a1c8ae9c) commit\n* [**4.9.207**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0bc72dbb9dbc2dfa0f975f4b519ae91fa338aec8) commit\n* [**4.14.159**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=cd606fb8f575ec2eaca138d9b3ba3b5131d9a875) commit\n* [**4.19.89**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6a10f818a9adbe394eb36d223814e207e5121236) commit\n* [**5.3.16**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e2416da8c1ef201d3685442a0821f4ffb19727ad) commit\n* [**5.4.3**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=52c8b0c6e11e139f0e27ea41a7444bfbf17aa2e1) commit\n* [**5.5-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=cbbaa2727aa3ae9e0a844803da7cef7fd3b94f2b) commit\n\nFixed by the following commits:\n* [Patch 1](https://git.kernel.org/linus/cbbaa2727aa3ae9e0a844803da7cef7fd3b94f2b)\n* [Patch 2](https://git.kernel.org/linus/c11f83e0626bdc2b6c550fc8b9b6eeefbd8cefaa)\n* [Patch 3](https://git.kernel.org/linus/b07a5c53d42a8c87b208614129e947dd2338ff9c)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:L/AC:L/Au:N/C:C/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "TSX Asynchronous Abort (TAA)",
    "workaround": "Another option is to export `MDS_NO=0` to guests when TSX is enabled by applying the following [patch](https://git.kernel.org/linus/e1d38b63acd843cfdd4222bf19a26700fd5c699e).",
    "vendorFixDate": "2019-11-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-3925",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-385"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-19338",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-3925/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/linus/b07a5c53d42a8c87b208614129e947dd2338ff9c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/linus/c11f83e0626bdc2b6c550fc8b9b6eeefbd8cefaa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/linus/cbbaa2727aa3ae9e0a844803da7cef7fd3b94f2b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/linus/e1d38b63acd843cfdd4222bf19a26700fd5c699e",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2019/12/10/3",
                "label": "ADVISORY"
            }
        ]
    }
}