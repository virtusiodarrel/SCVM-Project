{
    "source": "BDSA",
    "name": "BDSA-2022-2093",
    "title": "OpenKM Vulnerable to XML External Entity (XXE) Attack via Unsafe Parsing in 'extractText()' Function",
    "description": "OpenKM is vulnerable to XML external entity (XXE) attacks. It does not parse XML input in a safe manner as it does not use the required security flags. An authenticated attacker could exploit this flaw by passing malicious input to the application which could result in the disclosure of confidential data or a denial-of-service (DoS).",
    "technicalDescription": "This vulnerability exists within the `src/main/java/com/openkm/extractor/OpenOfficeTextExtractor.java` and `src/main/java/com/openkm/extractor/XMLTextExtractor.java` files due to `XMLReader` parsing input without the required security flags. This flaw could allow an attacker to perform an XML External Entity (XXE) Attack.\n\nThis has been fixed in `OpenOfficeTextExtractor.java` by deleting the `http://xml.org/sax/features/validation` feature and adding:\n* `xmlReader.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false);`\n* `xmlReader.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);`\n* `xmlReader.setFeature(\"http://xml.org/sax/features/validation\", false);`.\n\nThis has also been fixed in `XMLTextExtractor.java` by adding the following features:\n* `reader.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);`\n* `reader.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false);`\n* `reader.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);`\n* `reader.setFeature(\"http://xml.org/sax/features/validation\", false);`.",
    "publishedDate": "2022-07-27T13:53:45.504Z",
    "updatedDate": "2022-07-27T13:53:45.493Z",
    "disclosureDate": "2022-07-15T00:00:00.000Z",
    "solution": "Fixed in version [**6.3.11**](https://github.com/openkm/document-management-system/releases/tag/v6.3.11) by [this](https://github.com/openkm/document-management-system/commit/ce1d82329615aea6aa9f2cc6508c1fe7891e34b5) commit.\n\nThe latest stable releases can be found [here](https://github.com/openkm/document-management-system/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.5,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 3.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Keval Shah",
    "workaround": "",
    "vendorFixDate": "2021-05-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2093",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-611"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-2131",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2093/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openkm/document-management-system/commit/1b4b5aad514afb5e941ca60a2cbd65d6fec151e3",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openkm/document-management-system/commit/ce1d82329615aea6aa9f2cc6508c1fe7891e34b5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openkm/document-management-system/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openkm/document-management-system/releases/tag/v6.3.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.incibe-cert.es/en/early-warning/security-advisories/openkm-xxe-injection",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2093/default-remediation-status"
            }
        ]
    }
}