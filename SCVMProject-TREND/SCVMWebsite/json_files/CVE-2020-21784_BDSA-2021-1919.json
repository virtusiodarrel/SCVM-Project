{
    "source": "BDSA",
    "name": "BDSA-2021-1919",
    "title": "phpwcms Vulnerable to Code Injection via Missing Quote Sanitization in 'setup.conf.inc.php' File",
    "description": "phpwcms is vulnerable to code injection due to missing sanitization on user input during the setup procedure. This allows to execute arbitrary OS commands on the host server by injecting code in one of the fields used during the setup.",
    "technicalDescription": "The code injection is possible due to missing quote sanitization in the function `write_conf_file()`, file `setup/inc/setup.func.inc.php`. The function takes the input that is supplied during the setup and writes it to the `setup.conf.inc.php` configuration file. Since there is no quote sanitization, it is possible to write OS commands to the configuration file. The commands would then get executed once `setup.conf.inc.php` is accessed directly.\n\nThis vulnerability was fixed by escaping single quotes in `write_conf_file()` and blocking direct access to `setup.conf.inc.php`.",
    "publishedDate": "2021-06-25T16:10:55.866Z",
    "updatedDate": "2021-06-25T16:10:55.862Z",
    "disclosureDate": "2020-01-16T00:00:00.000Z",
    "exploitPublishDate": "2020-01-16T00:00:00.000Z",
    "solution": "Fixed in **[1.9.15](https://github.com/slackero/phpwcms/releases/tag/v1.9.15)** by [this](https://github.com/slackero/phpwcms/commit/3f3ba14e) commit.\n\nThe latest stable releases are available [here](https://github.com/slackero/phpwcms/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "c0d1007 (GitHub)",
    "workaround": "",
    "vendorFixDate": "2020-01-23T00:00:00.000Z",
    "vendorNotifiedDate": "2020-01-16T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1919",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-149"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-21784",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1919/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/slackero/phpwcms/commit/3f3ba14e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/slackero/phpwcms/issues/286",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/slackero/phpwcms/issues/286",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/slackero/phpwcms/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/slackero/phpwcms/releases/tag/v1.9.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1919/default-remediation-status"
            }
        ]
    }
}