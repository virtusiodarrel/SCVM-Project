{
    "source": "BDSA",
    "name": "BDSA-2021-0252",
    "title": "Moodle Vulnerable to Cross-Site Scripting (XSS) via Insufficient Escaping of Search Queries",
    "description": "Moodle is vulnerable to cross-site scripting (XSS) via insufficient escaping of search queries. This could allow an attacker to inject arbitrary web scripts and steal sensitive information such as authentication tokens and user session cookies.",
    "technicalDescription": "This issue occurs in the `search_input.mustache` file due to insufficient escaping of search queries. It was mitigated by the addition of further escaping relating to the `search_input` template.",
    "publishedDate": "2021-01-29T16:34:10.132Z",
    "updatedDate": "2022-01-27T10:34:58.934Z",
    "disclosureDate": "2021-01-25T00:00:00.000Z",
    "solution": "Fixed in [**3.10.1**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=154e82366709df79be17aaa8b19fff890590b77a) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=dc9de7b0d487b73c23c221dc0b8b6e01654921f3) commit.\n\nThe latest stable releases are available [here](https://git.moodle.org/gw?p=moodle.git;a=tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "kstpt",
    "workaround": "",
    "vendorFixDate": "2021-01-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0252",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20183",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0252/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=a5cd815635c64ebd4b0bc46e88b26a76e4cad745",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=dc9de7b0d487b73c23c221dc0b8b6e01654921f3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=154e82366709df79be17aaa8b19fff890590b77a",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=417166",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0252/default-remediation-status"
            }
        ]
    }
}