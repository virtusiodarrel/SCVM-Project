{
    "source": "BDSA",
    "name": "BDSA-2022-2529",
    "title": "Moby Vulnerable to Authorization Bypass via Improper Supplementary Group Permission Handling",
    "description": "Moby is vulnerable to authorization bypass due to the improper handling of supplementary group permissions. An attacker could potentially leverage this issue in order to bypass the primary group restrictions that have been applied to a container. The outcome that the attacker can achieve will be dependent on the context of the container, but could potentially include the recovery of sensitive data, or the execution of arbitrary code within the container.",
    "technicalDescription": "",
    "publishedDate": "2022-09-13T08:38:39.701Z",
    "updatedDate": "2022-09-13T08:38:39.688Z",
    "disclosureDate": "2022-09-09T00:00:00.000Z",
    "solution": "Fixed in version [**20.10.18**](https://github.com/moby/moby/releases/tag/v20.10.18) by [this](https://github.com/moby/moby/commit/bb0197c829c58929d79f3a9b67f2c111bb751455) commit..\n\nThe latest stable releases can be found [here](https://github.com/moby/moby/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Steven Murdoch",
    "workaround": "The vendor has stated [here](https://github.com/moby/moby/security/advisories/GHSA-rc4r-wh2q-q6c4) that the following workaround can be implemented:\n\n> This problem can be worked around by not using the \"`USER $USERNAME`\" Dockerfile instruction. Instead by calling `ENTRYPOINT [\"su\", \"-\", \"user\"]` the supplementary groups will be set up properly.",
    "vendorFixDate": "2022-09-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2529",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-36109",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2529/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/commit/bb0197c829c58929d79f3a9b67f2c111bb751455",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/releases/tag/v20.10.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/security/advisories/GHSA-rc4r-wh2q-q6c4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/security/advisories/GHSA-rc4r-wh2q-q6c4",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2529/default-remediation-status"
            }
        ]
    }
}