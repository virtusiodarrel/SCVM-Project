{
    "source": "BDSA",
    "name": "BDSA-2019-1282",
    "title": "Heketi Vulnerable to Authentication Bypass via Improper Authentication in Heketi Default Configuration",
    "description": "The default configuration of Heketi contains an authentication bypass vulnerability. Due to missing authentication in the default configuration an attacker could exploit this to gain unauthorized access to the management interface.",
    "technicalDescription": "The vulnerability is caused by the default configuration of the Heketi not requiring any authentication.",
    "publishedDate": "2019-05-02T15:41:05.732Z",
    "updatedDate": "2020-03-19T13:03:19.783Z",
    "disclosureDate": "2019-04-18T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/heketi/heketi/commit/f9df38680d39d2898a0f84a22f7bdba5d5069537) commit in the Master branch which has not yet been included in any release.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Siddharth Sharma",
    "workaround": "After installation of Heketi:\n\nConfigure user and admin key in `/etc/heketi/heketi.json` file\n```\n{\n  \"_port_comment\": \"Heketi Server Port Number\",\n  \"port\": \"8080\",\n\n  \"_use_auth\": \"Enable JWT authorization. Please enable for deployment\",\n  \"use_auth\": true,\n\n  \"_jwt\": \"Private keys for access\",\n  \"jwt\": {\n    \"_admin\": \"Admin has access to all APIs\",\n    \"admin\": {\n      \"key\": \"My Secret\"\n    },\n    \"_user\": \"User only has access to /volumes endpoint\",\n    \"user\": {\n      \"key\": \"My Secret\"\n    }\n  },\n```\n\nRestart Heketi server",
    "vendorFixDate": "2019-04-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1282",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-306"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3899",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1282/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3899",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3899",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/heketi/heketi/commit/f9df38680d39d2898a0f84a22f7bdba5d5069537",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1282/default-remediation-status"
            }
        ]
    }
}