{
    "source": "BDSA",
    "name": "BDSA-2022-1222",
    "title": "xwiki-commons Velocity Scripts Vulnerable to Arbitrary File Read/Write via 'SecureIntrospector' Class",
    "description": "Xwiki-commons velocity scripts are vulnerable to an arbitrary file read and write access condition.  The condition is due to xwiki no blocking the Java File APIs from velocity scripts. This allows a remote attacker that can write velocity scripts to read and write to the filesystem.",
    "technicalDescription": "The arbitrary file access is due to velocity allowing scripts to access the Java File API and not blocking access in the `SecureIntrospector` (`xwiki-commons-core/xwiki-commons-velocity/src/main/java/org/xwiki/velocity/introspection/SecureIntrospector.java`).  This has been fixed by using an \"allow list\" for some File APIs in the velocity security introspector. Also permissions to write a velocity script have been added using \"Script rights\" in XWiki.",
    "publishedDate": "2022-05-03T11:05:30.829Z",
    "updatedDate": "2022-08-01T11:16:02.810Z",
    "disclosureDate": "2022-04-28T00:00:00.000Z",
    "exploitPublishDate": "2022-04-28T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**12.6.7**](https://github.com/xwiki/xwiki-commons/releases/tag/xwiki-commons-12.6.7) by [this](https://github.com/xwiki/xwiki-commons/commit/d6dc35da44c32f582d76fa0bbf096c8d0e1313d4) commit.\n* [**12.10.3**](https://github.com/xwiki/xwiki-commons/releases/tag/xwiki-commons-12.10.3) by [this](https://github.com/xwiki/xwiki-commons/commit/327fa15ba24c2152940f09e459d0fe934756dde4) commit.\n* [**13.0RC1**](https://github.com/xwiki/xwiki-commons/releases/tag/xwiki-commons-13.0) by [this](https://github.com/xwiki/xwiki-commons/commit/215951cfb0f808d0bf5b1097c9e7d1e503449ab8) commit.\n\nThe latest stable releases can be found [here](https://github.com/xwiki/xwiki-commons/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-01-06T00:00:00.000Z",
    "vendorNotifiedDate": "2010-05-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1222",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-648"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24897",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1222/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-commons/commit/215951cfb0f808d0bf5b1097c9e7d1e503449ab8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-commons/commit/327fa15ba24c2152940f09e459d0fe934756dde4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-commons/commit/d6dc35da44c32f582d76fa0bbf096c8d0e1313d4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-commons/releases/tag/xwiki-commons-12.10.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-commons/releases/tag/xwiki-commons-12.6.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-commons/releases/tag/xwiki-commons-13.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-commons/security/advisories/GHSA-cvx5-m8vg-vxgc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-commons/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jira.xwiki.org/browse/XWIKI-5168",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://jira.xwiki.org/browse/XWIKI-5168",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1222/default-remediation-status"
            }
        ]
    }
}