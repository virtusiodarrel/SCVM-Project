{
    "source": "BDSA",
    "name": "BDSA-2021-3984",
    "title": "Xen Vulnerable to Denial-of-Service (DoS) via 'netback' Driver Buffer Timeout Bypass",
    "description": "It was found that a Xen guest could exploit the Linux kernel's `netback` driver to cause an out of memory situation in the domain the backend is running in. This would cause a denial-of-service (DoS) condition.",
    "technicalDescription": "Incoming data packets for a guest in the Linux kernel's `netback` driver are buffered until the guest is ready to process them. In order to prevent too much data piling up, a timeout has been introduced that specifies how long the client side of an interface can consume new packets before it stalls. However, it was found that this timeout could be bypassed if the guest manages to have only one free slot in its RX queue ring page and the next package would\nrequire more than one free slot, which may be the case when using `GSO`, `XDP`, or software hashing.",
    "publishedDate": "2022-01-12T14:23:57.137Z",
    "updatedDate": "2022-01-12T14:23:57.116Z",
    "disclosureDate": "2021-12-20T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.9.294**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1f66dc775092e5a353e0155fc3aca5dabce77c63) commit\n* [**4.14.259**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=eae85b8c6e17d3e3888d9159205390e8dbcff6a8) commit\n* [**4.19.222**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1de7644eac41981817fb66b74e0f82ca4477dc9d) commit\n* [**5.4.168**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8bfcd0385211044627f93d170991da1ae5937245) commit\n* [**5.10.88**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=525875c410df5d876b9615c44885ca7640aed6f2) commit\n* [**5.15.11**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=88449dbe6203c3a91cf1c39ea3032ad61a297bd7) commit\n* [**5.16-rc7**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6032046ec4b70176d247a71836186d47b25d1684) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "J\u00fcrgen Gro\u00df",
    "workaround": "The vulnerability can be prevented by using another PV network backend (e.g. the qemu based `qnic` backend). Alternatively, using dedicated network driver domain per guest will mitigate the problem.",
    "vendorFixDate": "2021-12-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-3984",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-28714",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-3984/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1de7644eac41981817fb66b74e0f82ca4477dc9d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1f66dc775092e5a353e0155fc3aca5dabce77c63",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=525875c410df5d876b9615c44885ca7640aed6f2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6032046ec4b70176d247a71836186d47b25d1684",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=88449dbe6203c3a91cf1c39ea3032ad61a297bd7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8bfcd0385211044627f93d170991da1ae5937245",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=eae85b8c6e17d3e3888d9159205390e8dbcff6a8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1d5d48523900a4b",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-392.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-392.txt",
                "label": "WORKAROUND"
            }
        ]
    }
}