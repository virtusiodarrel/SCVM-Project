{
    "source": "BDSA",
    "name": "BDSA-2020-2010",
    "title": "Jenkins Script Security Plugin Vulnerable to Sandbox Protection Bypass via AST Transforming Annotations During Script Compilation",
    "description": "Jenkins Script Security Plugin contains a sandbox protection bypass vulnerability.  This allows an attacker with overall read permissions on Jenkins to bypass sandbox protections and potentially execute scripts on the Jenkins master.  This vulnerability exists due to an incomplete fix for CVE-2019-1003000.",
    "technicalDescription": "The sandbox protection bypass is due to an incomplete fix for CVE-2019-1003000.  During the script compilation phase an attacker can apply AST transforming annotations, such as Groovy `@grab` on imports, or nesting the annotation inside another annotation. \n\nThe vulnerability is in the `visitImports` and `visitAnnotations` methods of the `RejectASTTransformsVisitor` inner class in `src/main/java/org/jenkinsci/plugins/scriptsecurity/sandbox/groovy/RejectASTTransformsCustomizer.java`.  These methods do not sufficiently check parent nodes.  \n\nTo Fix this vulnerability, a call to the `super` method from [`ClassCodeVisitorSupport`](https://github.com/groovy/groovy-core/blob/master/src/main/org/codehaus/groovy/ast/ClassCodeVisitorSupport.java#L70) is implemented to efficiently traverse nested AST nodes.",
    "publishedDate": "2020-08-12T14:58:43.080Z",
    "updatedDate": "2021-02-17T10:44:01.689Z",
    "disclosureDate": "2020-02-12T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* [**1.70**](https://github.com/jenkinsci/script-security-plugin/releases/tag/script-security-1.70) by [this](https://github.com/jenkinsci/script-security-plugin/commit/1a09bdcf789b87c4e158aacebd40937c64398de3) commit.\n* [**1.66.2**](https://github.com/jenkinsci/script-security-plugin/releases/tag/script-security-1.66.2) by [this](https://github.com/jenkinsci/script-security-plugin/commit/1a09bdcf789b87c4e158aacebd40937c64398de3) commit.\n* [**1.57.5**](https://github.com/jenkinsci/script-security-plugin/releases/tag/script-security-1.57.5) by [this](https://github.com/jenkinsci/script-security-plugin/commit/1a09bdcf789b87c4e158aacebd40937c64398de3) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-02-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2010",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-2110",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2010/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/script-security-plugin/commit/1a09bdcf789b87c4e158aacebd40937c64398de3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/script-security-plugin/releases/tag/script-security-1.57.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/script-security-plugin/releases/tag/script-security-1.66.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/script-security-plugin/releases/tag/script-security-1.70",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/security/advisory/2020-02-12/#SECURITY-1713",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2010/default-remediation-status"
            }
        ]
    }
}