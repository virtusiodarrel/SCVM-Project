{
    "source": "BDSA",
    "name": "BDSA-2018-2189",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via SGID File Creation",
    "description": "Linux kernel is vulnerable to privilege escalation. A local attacker who can create files in a specially tagged directory can inherit the permissions of the group that the directory belongs to.",
    "technicalDescription": "When a file is created in a directory that has the `sgid` bit set it is not supposed to inherit that bit.  A local attacker who has the privileges to write into such a directory can create an executable file that will then run with the inherited group permissions of the directory.  These could be privileges that the attacker did not have, allowing them to write to specific configuration files, for example.",
    "publishedDate": "2018-07-11T14:02:44.567Z",
    "updatedDate": "2019-08-14T14:33:33.492Z",
    "disclosureDate": "2018-07-05T00:00:00.000Z",
    "exploitPublishDate": "2018-07-16T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.16.58**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0b3369840cd61c23e2b9241093737b4c395cb406) commit\n* [**3.18.116**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c5f2c5be9d1787a7bde81186d093be54c0caeb34) commit\n* [**4.4.141**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e71dbad7563db674f91af9e12ef592c107d0c2cd) commit\n* [**4.9.113**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=d2c7c52431819aa05d76fae77bb3f95dd0955da1) commit\n* [**4.14.56**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=298243a5fb640f018e2fae22c0c895f1b27f0963) commit\n* [**4.17.7**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3dcb24abc93cad1afb87b3f30fd5bf348b49d5a7) commit\n* [**4.18-rc4**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0fa3ecd87848c9c93c2c828ef4c3a8ca36ce46c7) commit",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.4,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn",
    "workaround": "",
    "vendorFixDate": "2018-07-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-2189",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-277"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2018-13405",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-2189/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0fa3ecd87848c9c93c2c828ef4c3a8ca36ce46c7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://twitter.com/grsecurity/status/1015082951204327425",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/45033/?rss",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-2189/default-remediation-status"
            }
        ]
    }
}