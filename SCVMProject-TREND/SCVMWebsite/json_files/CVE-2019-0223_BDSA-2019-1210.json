{
    "source": "BDSA",
    "name": "BDSA-2019-1210",
    "title": "Apache Qpid Proton Vulnerable to MiTM Attack via Anonymous OpenSSL TLS Connections",
    "description": "Apache Qpid Proton is vulnerable to MiTM attack due to how it allows anonymous peer connections on some versions of Open SSL. Anonymous connections can occur even when the application is configured to verify the peer certificate.",
    "technicalDescription": "Apache Qpid Proton has a flaw that allows a remote attacker to anonymously connect as a client to a TLS server or hostname that offers anonymous ciphers. \n\nThe flaw is due to a misconfiguration of the example broker within function `pn_ssl_domain_set_credentials()`. The example broker does not check the return value from this function. If the client is given a bad certificate, it will not display an error message and will allow anonymous ciphers. This can happen even when the client is configured to verify the peer certificate.\n\nThe Qpid Proton C library, and all language binding libraries using it, are vulnerable. \n\nA remote attacker can leverage this flaw to construct an undetectable MiTM attack and intercept TLS traffic.",
    "publishedDate": "2019-04-24T14:33:26.626Z",
    "updatedDate": "2019-05-03T15:08:31.099Z",
    "disclosureDate": "2019-03-06T00:00:00.000Z",
    "solution": "Fixed in [**0.27.1-rc1**](https://gitbox.apache.org/repos/asf?p=qpid-proton.git;a=tags) by [this](https://gitbox.apache.org/repos/asf?p=qpid-proton.git;h=4aea0fd8502f5e9af7f22fd60645eeec07bce0b2) commit and [this](https://gitbox.apache.org/repos/asf?p=qpid-proton.git;h=2d3ba8aadc6657410a9e9f020c4d371cb41cd41b) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Qpid developers",
    "workaround": "If client certificate authentication is in use, this attack will not work. Anonymous ciphers cannot be used in such cases.\nOnly installations using OpenSSL prior to 1.1.0 are affected.",
    "vendorFixDate": "2019-04-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1210",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-599"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-0223",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1210/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitbox.apache.org/repos/asf?p=qpid-proton.git;a=tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitbox.apache.org/repos/asf?p=qpid-proton.git;h=2d3ba8aadc6657410a9e9f020c4d371cb41cd41b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitbox.apache.org/repos/asf?p=qpid-proton.git;h=4aea0fd8502f5e9af7f22fd60645eeec07bce0b2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/PROTON-2014",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/d9c9a882a292e2defaed1f954528c916fb64497ce57db652727e39b0@%3Cannounce.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://qpid.apache.org/cves/CVE-2019-0223.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1210/default-remediation-status"
            }
        ]
    }
}