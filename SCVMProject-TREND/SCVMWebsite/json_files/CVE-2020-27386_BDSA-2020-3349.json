{
    "source": "BDSA",
    "name": "BDSA-2020-3349",
    "title": "FlexDotnetCMS Vulnerable to Remote Code Execution (RCE) via Unrestricted File Upload",
    "description": "FlexDotnetCMS is vulnerable to a remote code execution (RCE) issue due to how the 'FileManager' functionality and the 'FileEditor' functionality allows uploaded files to be renamed to use potentially malicious file types.\n\nAn authenticated attacker could use this issue by uploading an unrestricted file type, like a .txt. file, that contains executable code and renaming it to alter the file extension. This could allow the attacker to execute code on the server.",
    "technicalDescription": "In FlexDotnetCMS, the upload function present in the 'FileManager' functionality can block the upload of files with potentially malicious file extensions, however, the rename function in both the 'FileManager' and 'FileEditor' does not sufficiently validate the file extension when files are renamed.\n\nThis means a file can be uploaded using a benign file extension, such as .txt, and once uploaded, be renamed to use an executable file extension, like .asp for example.\n\nThis means authenticated attackers can place malicious files on the server and potentially execute the contents with the FlexDotnetCMS elevated privileges.\n\nThis issue's attack vectors: the 'FileManager' rename functionality, and 'FileEditor' functionality, have been remedied by the vendor in two separate releases: **1.5.8** and **1.5.9**.",
    "publishedDate": "2020-11-23T10:23:03.503Z",
    "updatedDate": "2021-01-15T11:22:54.131Z",
    "disclosureDate": "2020-11-11T00:00:00.000Z",
    "exploitPublishDate": "2020-11-11T00:00:00.000Z",
    "solution": "'FileEditor' rename vector fixed in [**1.5.9**](https://github.com/MacdonaldRobinson/FlexDotnetCMS/releases/tag/v1.5.9) by [this](https://github.com/MacdonaldRobinson/FlexDotnetCMS/commit/2873992aa4266502998edb757cc31f3f4867e423) commit.\n\n'FileManager' rename vector fixed in [**1.5.8**](https://github.com/MacdonaldRobinson/FlexDotnetCMS/releases/tag/v1.5.8) by [this](https://github.com/MacdonaldRobinson/FlexDotnetCMS/commit/3f9b30be73172f155da7383971b822b0033427c7) commit.\n\nThe latest stable releases are available [here](https://github.com/MacdonaldRobinson/FlexDotnetCMS/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-10-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3349",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-646"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27386",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3349/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.vonahi.io/whats-in-a-re-name/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.vonahi.io/whats-in-a-re-name/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MacdonaldRobinson/FlexDotnetCMS/commit/2873992aa4266502998edb757cc31f3f4867e423",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MacdonaldRobinson/FlexDotnetCMS/commit/3f9b30be73172f155da7383971b822b0033427c7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MacdonaldRobinson/FlexDotnetCMS/releases/tag/v1.5.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MacdonaldRobinson/FlexDotnetCMS/releases/tag/v1.5.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3349/default-remediation-status"
            }
        ]
    }
}