{
    "source": "BDSA",
    "name": "BDSA-2020-1967",
    "title": "Horde Data Library Module Vulnerable to Remote Code Execution (RCE) via Unescaped 'quote' Parameter in CSV Import Feature",
    "description": "The Horde Data library is vulnerable to processing unsanitized user input when generating certain code to deal with CSV importation. A remote attacker could leverage this flaw to execute arbitrary code on the system. Authentication is required for all the official horde applications utilizing this CSV import feature. Other applications utilizing this library feature may be vulnerable without authentication.",
    "technicalDescription": "In function `getCsv()` in file `lib/Horde/Data/Csv.php`, there is a call to `create_function()` with a partly unsanitized `quote` parameter. An attacker can supply specially crafted string data as this parameter that will terminate an intended `str_replace()` function definition early with a `)` character. By then appending PHP code, termination and quotation characters, the attacker can force the execution of arbitrary PHP code or system commands.",
    "publishedDate": "2020-08-07T11:13:43.517Z",
    "updatedDate": "2020-08-21T11:29:16.904Z",
    "disclosureDate": "2020-03-10T00:00:00.000Z",
    "exploitPublishDate": "2020-03-10T00:00:00.000Z",
    "solution": "Fixed in [**2.1.5**](https://pear.horde.org/) by [this](https://github.com/horde/Data/commit/78ad0c2390176cdde7260a271bc6ddd86f4c9c0e) commit. \n\nNote there is no tagged **2.1.5** release on github, although the version has been officially released elsewhere (as linked).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "HIGH",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:H/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "HIGH",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:H/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrea Cardaci",
    "workaround": "",
    "vendorFixDate": "2017-02-13T00:00:00.000Z",
    "discoveryDate": "2019-06-19T00:00:00.000Z",
    "vendorNotifiedDate": "2019-06-20T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1967",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-150"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8518",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1967/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cardaci.xyz/advisories/2020/03/10/horde-groupware-webmail-edition-5.2.22-rce-in-csv-data-import/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://cardaci.xyz/advisories/2020/03/10/horde-groupware-webmail-edition-5.2.22-rce-in-csv-data-import/",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/horde/Data/commit/78ad0c2390176cdde7260a271bc6ddd86f4c9c0e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://lists.horde.org/archives/announce/2020/001285.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/156872/Horde-5.2.22-CSV-Import-Code-Execution.html",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://pear.horde.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/48215",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1967/default-remediation-status"
            }
        ]
    }
}