{
    "source": "BDSA",
    "name": "BDSA-2022-1716",
    "title": "OpenSSL 'c_rehash' Script Vulnerable to Command Injection via Unsanitized Certificate File Names",
    "description": "The `c_rehash` script in OpenSSL is vulnerable to command injection due to how it does not sufficiently sanitize shell metacharacters.\n\nAn attacker could abuse this issue in order to execute arbitrary commands on the system.\n\n**Note**: This issue exists due to an incomplete fix for the previously disclosed `c_rehash` script command injection vulnerablility known as **CVE-2022-1292** (**BDSA-2022-1242**).",
    "technicalDescription": "The `c_rehash` script, defined in the `tools/c_rehash.in` file, contains instances where the file names of certificates that are being hashed can be passed to a command that is executed through the shell. On some operating systems, the script is distributed in a manner where it is automatically executed, meaning an attacker could abuse the script with crafted inputs in order to execute arbitrary commands with the privileges of the script.",
    "publishedDate": "2022-06-22T13:10:12.376Z",
    "updatedDate": "2022-06-22T13:10:12.363Z",
    "disclosureDate": "2022-06-21T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.1.1p**](https://git.openssl.org/gitweb/?p=openssl.git;a=tag;h=c8626540599e47f53bbc469aae90f821b9215d7d) by [this](https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=9639817dac8bbbaa64d09efad7464ccc405527c7) commit,\n* [**3.0.4**](https://git.openssl.org/gitweb/?p=openssl.git;a=tag;h=ad1d860850cd987cd2391b91c1268abe17035908) by [this](https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=2c9c35870601b4a44d86ddbf512b38df38285cfa) commit,\n* the **master** branch by [this](https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=ce60b13707add7e6b54c5817376234c4043506ed) commit.\n\nThe vendor has suggested [here](https://www.openssl.org/news/secadv/20220621.txt) that OpenSSL **1.0.2** users should upgrade to **1.0.2zf**. **Note**: This upgrade is for premium support customers only.\n\nThe latest stable releases are available [here](https://git.openssl.org/gitweb/?p=openssl.git;a=tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.7,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Chancen of Qingteng 73lab, Daniel Fiala of OpenSSL",
    "workaround": "The vendor has stated [here](https://www.openssl.org/news/secadv/20220621.txt) that the `c_rehash` script is now considered obsolete and recommends that users replace it with the OpenSSL `rehash` command line tool instead.",
    "vendorFixDate": "2022-06-20T00:00:00.000Z",
    "vendorNotifiedDate": "2022-05-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-1716",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2022-2068",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-1716/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=2c9c35870601b4a44d86ddbf512b38df38285cfa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=9639817dac8bbbaa64d09efad7464ccc405527c7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=ce60b13707add7e6b54c5817376234c4043506ed",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=tag;h=ad1d860850cd987cd2391b91c1268abe17035908",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=tag;h=c8626540599e47f53bbc469aae90f821b9215d7d",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openssl.org/news/secadv/20220621.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openssl.org/news/secadv/20220621.txt",
                "label": "WORKAROUND"
            }
        ]
    }
}