{
    "source": "BDSA",
    "name": "BDSA-2022-0655",
    "title": "Linux Kernel Vulnerable to Sensitive Information Disclosure via Branch Target Injection (Spectre Variant 2) Bypass on AMD Processors",
    "description": "The Linux Kernel is vulnerable to a bypass of fixes applied for **CVE-2017-5715** (**BDSA-2022-0009**) on some AMD processors. The speculative execution window of AMD `LFENCE`/`JMP` mitigation (**V2-2**) may be large enough to be exploited and allow an authorized user to leak arbitrary kernel memory via local access. Further details on mitigation **V2-2** can be found [here](https://www.amd.com/system/files/documents/software-techniques-for-managing-speculation.pdf).\n\n**Note**: AMD has provided a list of affected processors [here](https://www.amd.com/en/corporate/product-security/bulletin/amd-sb-1036).",
    "technicalDescription": "",
    "publishedDate": "2022-03-14T14:17:30.438Z",
    "updatedDate": "2022-07-12T13:56:05.796Z",
    "disclosureDate": "2022-03-08T00:00:00.000Z",
    "solution": "Mitigations for the Kernel were applied by a series of commits in:\n* [**4.9.306**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.9.306),\n* [**4.14.271**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.14.271),\n* [**4.19.234**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.19.234),\n* [**5.4.184**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.4.184),\n* [**5.10.105**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.10.105),\n* [**5.15.28**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.15.28),\n* [**5.16.14**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.16.14),\n* [**5.17-rc8**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.17-rc8).\n\n**5.17-rc8** received these mitigations in the form of a merge found [here](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4a01e748a51cdc0527fdc913546dd46e822aa00d). The other listed releases received mitigations as individual commits that have been omitted here due to their number.\n\nThe latest stable releases are available [here](https://www.kernel.org/).\n\nXen has made [patches](https://xenbits.xen.org/xsa/advisory-398.html) available for the following stable versions and branches:\n* [**4.16.1**](https://xenproject.org/downloads/xen-project-archives/xen-project-4-16-series/xen-project-4-16-1/)\n* [**4.15.3**](https://xenproject.org/downloads/xen-project-archives/xen-project-4-15-series/xen-project-4-15-3/)\n* [**4.14.5**](https://xenproject.org/downloads/xen-project-archives/xen-project-4-14-series/xen-project-4-14-5/)\n* **4.13.x**\n* **4.12.x**",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.7,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Ke Sun, Alyssa Milburn, Henrique Kawakami, Emma Benoit, Igor Chervatyuk, Lisa Aichele, Thais Moreira Hamasaki from Intel IPAS STORM",
    "workaround": "AMD recommends [here](https://www.amd.com/en/corporate/product-security/bulletin/amd-sb-1036) that users avail of one of the published mitigations (**V2-1** aka \u2018generic retpoline\u2019 or **V2-4** aka \u2018IBRS\u2019) for **CVE-2017-5715** (**BDSA-2018-0009**). Users can choose the generic `retpoline` at boot time by using the spectre_v2 Linux kernel command for turning on `retpoline`: `spectre_v2=retpoline,generic`.\n\nThe published mitigations are available [here](https://www.amd.com/system/files/documents/software-techniques-for-managing-speculation.pdf).",
    "vendorFixDate": "2022-03-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0655",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-226"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-26401",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0655/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2061700",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4a01e748a51cdc0527fdc913546dd46e822aa00d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.14.271",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.19.234",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.9.306",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.10.105",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.15.28",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.16.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.17-rc8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.4.184",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.amd.com/en/corporate/product-security/bulletin/amd-sb-1036",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.amd.com/en/corporate/product-security/bulletin/amd-sb-1036",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.amd.com/system/files/documents/software-techniques-for-managing-speculation.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.amd.com/system/files/documents/software-techniques-for-managing-speculation.pdf",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-398.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-398.html",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/xen-project-archives/xen-project-4-14-series/xen-project-4-14-5/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/xen-project-archives/xen-project-4-15-series/xen-project-4-15-3/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/xen-project-archives/xen-project-4-16-series/xen-project-4-16-1/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0655/default-remediation-status"
            }
        ]
    }
}