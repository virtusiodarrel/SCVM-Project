{
    "source": "BDSA",
    "name": "BDSA-2021-1038",
    "title": "Linux Kernel Vulnerable to Side-Channel Information Leak via Out-of-Bounds Speculation on Pointer Arithmetic in 'kernel/bpf/verifier.c'",
    "description": "The Linux kernel is vulnerable to a Spectre side-channel (BDSA-2018-0008) in the berkley packet filter (bpf) subsystem. A local attacker on the machine could leverage this to leak sensitive kernel memory.",
    "technicalDescription": "The flaw exists as a bypass for the other Spectre mitigations within the kernel. It occurs when protecting sequences of pointer arithmetic operations against speculatively out-of-bounds loads. The pointer modification performed by the first operation is not correctly accounted for when restricting subsequent operations. This opens up a Spectre side-channel that allows an unprivileged bpf program running on the system to leak the contents of kernel memory.\n\nThe researcher has provided a PoC to kernel developers that leaks a 31 KByte window within the kernel memory. This exploit is not yet in the public domain.\n\nThe Kernel developers significantly re-factored the bpf code to mitigate the issue.",
    "publishedDate": "2021-04-21T13:53:49.823Z",
    "updatedDate": "2021-08-20T13:31:16.542Z",
    "disclosureDate": "2021-04-18T00:00:00.000Z",
    "solution": "Fixed in version [**5.12-rc8**](https://www.kernel.org) by the following commits: \n* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9601148392520e2e134936e76788fc2a6371e7be)\n* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6f55b2f2a1178856c19bbce2f71449926e731914)\n* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=24c109bb1537c12c02aeed2d51a347b4d6a9b76e)\n* [Commit 4](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b658bbb844e28f1862867f37e8ca11a8e2aa94a3)\n* [Commit 5](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a6aaece00a57fa6f22575364b3903dfbccf5345d)\n* [Commit 6](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=073815b756c51ba9d8384d924c5d1c03ca3d1ae4)\n* [Commit 7](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f528819334881fd622fdadeddb3f7edaed8b7c9b)\n* [Commit 8](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7fedb63a8307dda0ec3b8969a3b233a1dd7ea8e0)\n\nFixed in version [**5.11.16**](https://www.kernel.org) by the following commits: \n* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4ccdc6c6cae38b91c871293fb0ed8c6845a61b51)\n* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=af2bb00759b8810ec652a57d73158baf5a7b3a59)\n* [Commit 3](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1611010fa388974b61cd6362c49d3fd1e31e2126)\n* [Commit 4](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4aa1f14c519b96c66b63fb16122d6c3a04680bc6)\n* [Commit 5](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=5cba7ca00dae28bec6e13684b7a0ec83c64cd72e)\n* [Commit 6](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2f5cfb7f36ea3ae0866c1bf0d1effa5b88366c28)\n* [Commit 7](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8a39972ed3cec42163abc71787d7fc11bf316c78)\n* [Commit 8](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=da63d034f87b637d81460fad3711e3c504206e9b)\n\nFixed in version [**5.10.32**](https://www.kernel.org) by the following commits: \n* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4f3ff11204eac0ee23acf64deecb3bad7b0db0c6)\n* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=480d875f12424a86fd710e8762ed1e23b7f02572)\n* [Commit 3](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=589fd9684dfafee37c60abde4ca3c0af723be3b3)\n* [Commit 4](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=55565c30790839b40311c270a8b1a437ae9b2769)\n* [Commit 5](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7723d3243857ab20f6450cfbbd765d8594e5e308)\n* [Commit 6](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2982ea926b5cb97ff79fbb27eba72521568811ff)\n* [Commit 7](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fbe6603e7cabad8a203a764300531e9ca811317a)\n* [Commit 8](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b642e493a9a0ed56be3b8cfcfb95fe3c7cea0b55)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Piotr Krysiuk, Benedict Schlueter",
    "workaround": "",
    "vendorFixDate": "2021-04-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1038",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-29155",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1038/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=073815b756c51ba9d8384d924c5d1c03ca3d1ae4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1611010fa388974b61cd6362c49d3fd1e31e2126",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=24c109bb1537c12c02aeed2d51a347b4d6a9b76e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2982ea926b5cb97ff79fbb27eba72521568811ff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2c78ee898d8f",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2f5cfb7f36ea3ae0866c1bf0d1effa5b88366c28",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=480d875f12424a86fd710e8762ed1e23b7f02572",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4aa1f14c519b96c66b63fb16122d6c3a04680bc6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4ccdc6c6cae38b91c871293fb0ed8c6845a61b51",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4f3ff11204eac0ee23acf64deecb3bad7b0db0c6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=55565c30790839b40311c270a8b1a437ae9b2769",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=589fd9684dfafee37c60abde4ca3c0af723be3b3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=5cba7ca00dae28bec6e13684b7a0ec83c64cd72e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6f55b2f2a1178856c19bbce2f71449926e731914",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7723d3243857ab20f6450cfbbd765d8594e5e308",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7fedb63a8307dda0ec3b8969a3b233a1dd7ea8e0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8a39972ed3cec42163abc71787d7fc11bf316c78",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9601148392520e2e134936e76788fc2a6371e7be",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a6aaece00a57fa6f22575364b3903dfbccf5345d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=af2bb00759b8810ec652a57d73158baf5a7b3a59",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b642e493a9a0ed56be3b8cfcfb95fe3c7cea0b55",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b658bbb844e28f1862867f37e8ca11a8e2aa94a3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=da63d034f87b637d81460fad3711e3c504206e9b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f528819334881fd622fdadeddb3f7edaed8b7c9b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fbe6603e7cabad8a203a764300531e9ca811317a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/04/18/4",
                "label": "ADVISORY"
            }
        ]
    }
}