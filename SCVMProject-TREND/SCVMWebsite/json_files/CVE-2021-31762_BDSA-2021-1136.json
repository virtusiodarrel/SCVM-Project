{
    "source": "BDSA",
    "name": "BDSA-2021-1136",
    "title": "Webmin Vulnerable to Privilege Escalation and Remote Code Execution (RCE) via Cross Site Request Forgery (CSRF) through 'Add users' Feature",
    "description": "Webmin is vulnerable to privilege escalation and remote code execution (RCE) via cross site request forgery (CSRF).  A remote attacker could exploit this in order to create a privileged user and achieve subsequent remote code execution.\n\n**Note:** this vulnerability only affects Webmin instances that were set up using the Perl installation script, which is mainly used on Windows systems. Although the Perl installation script is also available to Linux users, it is not used by default during regular installation procedures.",
    "technicalDescription": "The vulnerability exists due to the CSRF protection setting `referers_none` not being enabled if Perl-based (`setup.pl`) installation is used. This causes CSRF to be disabled site-wide, meaning multiple admin endpoints can be targeted to achieve RCE.\n\nSuccessful exploitation of this particular vulnerability (`CVE-2021-31762`) could allow an attacker to create a privileged user via the `add users` feature before utilizing the `running process` feature to get a reverse shell.\n\nThe issue was fixed by adding a statement in `setup.pl` that sets `referers_none=1` in the config file.",
    "publishedDate": "2021-04-26T15:01:03.798Z",
    "updatedDate": "2022-07-07T10:00:14.354Z",
    "disclosureDate": "2021-04-21T00:00:00.000Z",
    "exploitPublishDate": "2021-04-19T00:00:00.000Z",
    "solution": "Fixed in [**1.974**](https://github.com/webmin/webmin/releases/tag/1.974) by [this](https://github.com/webmin/webmin/commit/0c85e067df477fe4ace6e9447706ea488dc70a8d) commit.\n\nThe latest stable releases are available [here](https://www.webmin.com/download.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 9.3,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 8.6,
        "severity": "HIGH",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "(AV:N/AC:M/Au:N/C:C/I:C/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mesh3l_911 & Z0ldyck",
    "workaround": "The vulnerability can be mitigated by manually setting `referers_none=1` in the config.",
    "vendorFixDate": "2021-04-22T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1136",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-31762",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1136/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Mesh3l911/CVE-2021-31762",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Mesh3l911/CVE-2021-31762",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/electronicbots/CVE-2021-31762",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/electronicbots/CVE-2021-31762",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webmin/webmin/commit/0c85e067df477fe4ace6e9447706ea488dc70a8d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webmin/webmin/commit/0c85e067df477fe4ace6e9447706ea488dc70a8d",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webmin/webmin/releases/tag/1.974",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.webmin.com/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.youtube.com/watch?v=qCvEXwyaF5U",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1136/default-remediation-status"
            }
        ]
    }
}