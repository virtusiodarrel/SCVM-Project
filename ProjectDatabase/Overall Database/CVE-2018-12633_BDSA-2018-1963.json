{
    "source": "BDSA",
    "name": "BDSA-2018-1963",
    "title": "Linux Kernel VirtualBox Guest Driver Vulnerable to Denial-of-Service and Information Disclosure via Race Condition in Buffer Size Checks",
    "description": "A local attacker on a Linux system can crash the kernel resulting in a denial-o-service (*DoS*) by issuing  ioctls to the VirtualBox driver.  They can also disclose sensitive kernel memory such as kernel pointers and cryptographic key material.",
    "technicalDescription": "The function  `bg_misc_device_ioctl()` in `drivers/virt/vboxguest/vboxguest_linux.c` retrieves a userspace header variable twice with `copy_from_user`.  The kernel code only checks the validity of the buffer sizes contained in the structure on the first fetch.  This opens up a race condition whereby a local attacker can change the value of the buffer sizes between the two fetches.  The newly updated buffer sizes could be larger than the ones initially created on the first fetch, creating buffer over-read conditions that can leak sensitive kernel memory to the attacker.",
    "publishedDate": "2018-06-28T08:24:13.417Z",
    "updatedDate": "2019-01-15T14:59:08.668Z",
    "disclosureDate": "2018-06-19T00:00:00.000Z",
    "solution": "Fixed in versions [**4.17.4**](https://www.kernel.org), [**4.18-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bd23a7269834dc7c1f93e83535d16ebc44b75eba) git commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.2,
        "impactSubscore": 7.8,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-06-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-1963",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-126"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-367"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-12633",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-1963/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.kernel.org/show_bug.cgi?id=200131",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bd23a7269834dc7c1f93e83535d16ebc44b75eba",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}