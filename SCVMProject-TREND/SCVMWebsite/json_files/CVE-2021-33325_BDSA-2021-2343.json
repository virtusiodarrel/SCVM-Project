{
    "source": "BDSA",
    "name": "BDSA-2021-2343",
    "title": "Liferay Portal Vulnerable to Exposure of Sensitive Information via Plaintext Storage of User Passwords",
    "description": "Liferay Portal is vulnerable to exposure of sensitive information via plaintext storage of user passwords within the database if workflow is enabled for new users. An attacker with database access could exploit this in order to view user passwords.",
    "technicalDescription": "This issue occurs in the `addUserWithWorkflow()` and `completeUserRegistration()` functions of the `service/impl/UserLocalServiceImpl.java ` file due to how user passwords are handled within a workflow. It was mitigated by ensuring that the password is now stored as `StringPool.BLANK`.",
    "publishedDate": "2021-08-05T15:26:29.694Z",
    "updatedDate": "2021-08-05T15:26:29.686Z",
    "disclosureDate": "2021-05-10T00:00:00.000Z",
    "solution": "Fixed in [**7.3.3-ga4**](https://github.com/liferay/liferay-portal/releases/tag/7.3.3-ga4) by [this](https://github.com/liferay/liferay-portal/commit/50edb6227bdfd78640edb7dd6829606e86e02a5e) commit.\n\nThe vendor has stated [here](https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/id/120748389) that there is no patch available for Liferay Portal **7.1.3** and earlier. Users should upgrade to **7.2.1** and apply the vendor supplied source patch. The cumulative source patch is available [here](https://github.com/community-security-team/liferay-portal/compare/7.2.1-ga2...7.2.1-cumulative.patch).\n\nThe latest stable releases are available [here](https://www.liferay.com/downloads-community).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-06-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2343",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-256"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33325",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2343/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/community-security-team/liferay-portal/compare/7.2.1-ga2...7.2.1-cumulative.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/liferay/liferay-portal/commit/50edb6227bdfd78640edb7dd6829606e86e02a5e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/liferay/liferay-portal/releases/tag/7.3.3-ga4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.liferay.com/browse/LPE-17042",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/id/120748389",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.liferay.com/downloads-community",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2343/default-remediation-status"
            }
        ]
    }
}