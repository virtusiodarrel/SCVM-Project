{
    "source": "BDSA",
    "name": "BDSA-2020-4076",
    "title": "Chromium for iOS Vulnerable to Cross-Origin Script Injection from Child Frame into Parent Frame via 'WebFrameImpl::CallJavaScriptFunction'",
    "description": "Chromium on iOS is vulnerable to script injection from a a child frame into a parent frame. A remote attacker could leverage this by supplying specially crafted web content in order to execute arbitrary scripts in the context of the parent frame, from an iframe that they control. These frames can be cross-origin, allowing an attacker to execute JavaScript on any site where an iframe can be embedded.",
    "technicalDescription": "On iOS platforms the JavaScript generated by the `WebFrameImpl::CallJavaScriptFunction` method is unsafely created using the following format string:\n\n```\nstd::string script =\n      base::StringPrintf(\"__gCrWeb.message.routeMessage(%s, %s, '%s')\",\n                         encrypted_message_json.c_str(),\n                         encrypted_function_json.c_str(), frame_id_.c_str());\n```\n\nThe attacker is able to fully control the `frame_id_` parameter by creating a new `WebFrameImpl` through the `window.webkit.messageHandlers.FrameBecameAvailable.postMessage` method. `autofill` will then attempt to route a message to the new frame, triggering cross-site scripting (XSS) in the parent frame, which can be cross-origin in nature.",
    "publishedDate": "2021-01-15T14:58:44.417Z",
    "updatedDate": "2021-08-03T11:11:38.969Z",
    "disclosureDate": "2020-07-27T00:00:00.000Z",
    "exploitPublishDate": "2020-10-02T00:00:00.000Z",
    "solution": "Fixed in [**85.0.4183.0**](https://chromium.googlesource.com/chromium/src/+/refs/tags/85.0.4183.0) by [this](https://chromium.googlesource.com/chromium/src/+/37bccc228e1089bb07e37c9137bd03437b7c4de7) commit.\n\nFixed in [**84.0.4147.101**](https://chromium.googlesource.com/chromium/src/+/refs/tags/84.0.4147.101) by [this](https://chromium.googlesource.com/chromium/src/+/9c80a23e06c64a9c742a191f02b19eebf73a2aaf) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alison Huffman, Microsoft Browser Vulnerability Research",
    "workaround": "",
    "vendorFixDate": "2020-06-25T00:00:00.000Z",
    "vendorNotifiedDate": "2020-06-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4076",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-16046",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4076/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/chromium/issues/detail?id=1098606",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/chromium/issues/detail?id=1098606",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://chromereleases.googleblog.com/2020/07/stable-channel-update-for-desktop_27.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://chromium.googlesource.com/chromium/src/+/37bccc228e1089bb07e37c9137bd03437b7c4de7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://chromium.googlesource.com/chromium/src/+/9c80a23e06c64a9c742a191f02b19eebf73a2aaf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://chromium.googlesource.com/chromium/src/+/refs/tags/84.0.4147.101",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://chromium.googlesource.com/chromium/src/+/refs/tags/85.0.4183.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4076/default-remediation-status"
            }
        ]
    }
}