{
    "source": "BDSA",
    "name": "BDSA-2021-3666",
    "title": "Django Vulnerable to Authentication Bypass via Improper Newline Character Handling",
    "description": "Django is vulnerable to authentication bypass due to the improper handling of URLs which contain trailing newline characters. A remote attacker could leverage this issue in order to access restricted data.",
    "technicalDescription": "The `RegexPattern` class, which is defined in the file `django/urls/resolvers.py`, contains the method `match()`. The argument which is passed to this method, `path`, is passed to `self.regex.search()` in order to determine if it matches the relevant regular expression. This matching methodology is inadequate and can fail if trailing newline characters are found in the specified path. This can cause issues with upstream access control mechanisms which are based on URL paths and which use this matching functionality. An attacker could potentially leverage this issue in order to bypass such access control mechanisms.",
    "publishedDate": "2021-12-07T15:09:58.590Z",
    "updatedDate": "2021-12-07T15:09:58.579Z",
    "disclosureDate": "2021-12-07T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.2.10**](https://github.com/django/django/releases/tag/3.2.10) by [this](https://github.com/django/django/commit/333c65603032c377e682cdbd7388657a5463a05a) commit.\n* [**3.1.14**](https://github.com/django/django/releases/tag/3.1.14) by [this](https://github.com/django/django/commit/22bd17488159601bf0741b70ae7932bffea8eced) commit.\n* [**2.2.25**](https://github.com/django/django/releases/tag/2.2.25) by [this](https://github.com/django/django/commit/7cf7d74e8a754446eeb85cacf2fef1247e0cb6d7) commit.\n\nThe latest stable releases can be found [here](https://www.djangoproject.com/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sjoerd Job Postmus and TengMA",
    "workaround": "",
    "vendorFixDate": "2021-12-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3666",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-162"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-44420",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3666/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/22bd17488159601bf0741b70ae7932bffea8eced",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/333c65603032c377e682cdbd7388657a5463a05a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/7cf7d74e8a754446eeb85cacf2fef1247e0cb6d7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/2.2.25",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/3.1.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/3.2.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/weblog/2021/dec/07/security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3666/default-remediation-status"
            }
        ]
    }
}