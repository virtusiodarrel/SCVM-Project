{
    "source": "BDSA",
    "name": "BDSA-2022-0978",
    "title": "QEMU QXL Component Vulnerable to Arbitrary Code Execution and Denial-of-Service (DoS) via Race Condition in 'qxl_cursor' Function",
    "description": "The QEMU QXL video accelerator component is vulnerable to arbitrary code execution and denial-of-service (DoS) issues due to the presence of a race condition in the `qxl_cursor()` function.\n\nA high privileged malicious guest user could abuse this issue by manipulating the affected values before they are accessed. This could allow them to crash the QEMU process on the host system, or potentially to execute arbitrary code.\n\n**Note**: This issue only impacts virtual machines that use a QXL video device and VNC Server Graphics.",
    "technicalDescription": "This issue occurs because the `qxl_cursor()` function in the `hw/display/qxl-render.c` file fetches the user-controlled `cursor->header.width` and `cursor->header.height` values twice, first in the main body of the function and secondly in the `SPICE_CURSOR_TYPE_ALPHA` case. It is possible for a malicious guest to alter these values between fetches, which could cause a heap-based buffer overflow.",
    "publishedDate": "2022-04-11T14:14:30.116Z",
    "updatedDate": "2022-05-10T08:45:40.626Z",
    "disclosureDate": "2022-03-28T00:00:00.000Z",
    "exploitPublishDate": "2022-03-28T00:00:00.000Z",
    "solution": "Fixed in [**7.0.0-rc4**](https://github.com/qemu/qemu/releases/tag/v7.0.0-rc4) by [this](https://github.com/qemu/qemu/commit/9569f5cb5b4bffa9d3ebc8ba7da1e03830a9a895) commit.\n\nThe latest stable releases are available [here](https://github.com/qemu/qemu/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Billy Jheng Bing Jhong (STAR Labs)",
    "workaround": "",
    "vendorFixDate": "2022-04-07T00:00:00.000Z",
    "vendorNotifiedDate": "2021-12-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0978",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-4207",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0978/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/cve-2021-4207",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/qemu/qemu/commit/9569f5cb5b4bffa9d3ebc8ba7da1e03830a9a895",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/qemu/qemu/releases/tag/v7.0.0-rc4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/qemu/qemu/tags",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://starlabs.sg/advisories/22-4207/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://starlabs.sg/advisories/22-4207/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0978/default-remediation-status"
            }
        ]
    }
}