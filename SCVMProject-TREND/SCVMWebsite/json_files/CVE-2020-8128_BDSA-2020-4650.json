{
    "source": "BDSA",
    "name": "BDSA-2020-4650",
    "title": "jsreport Vulnerable to Remote Code Execution (RCE) via Server Side Request Forgery (SSRF) with Puppeteer Module",
    "description": "jsreport is vulnerable to server side request forgery (SSRF) due to the improper processing of HTML-to-PDF conversion in the Puppeteer module. This could allow an attacker to send requests as if they originated from the target server by supplying a crafted HTML file. This could be leveraged in conjunction with a user-controlled `require` in the script-manager package to achieve remote code execution (RCE).",
    "technicalDescription": "The `Puppeter` module of jsreport can be used to transform client-provided HTML content into a PDF file. Insufficient restrictions are placed on this module, such that it is possible for an attacker to provide HTML content that cause the server to submit arbitrary web requests. This constitutes an SSRF vulnerability. \n\nThere also exists a separate issue in the `Script-manager` component, which allows clients to execute arbitrary scripts that reside on the server provided they have identified another actively listening port. This is because the attacker can control content that is passed to a `require` statement, which allows them to incorporate the functionality of arbitrary scripts into the application. An attacker can combine the exploitation of the aforementioned SSRF vulnerability, the arbitrary script execution vulnerability, and the inherent file creation functionality of jsreport in order to create and execute arbitrary scripts on a vulnerable host.",
    "publishedDate": "2021-10-19T09:14:56.137Z",
    "updatedDate": "2022-02-22T15:14:54.767Z",
    "disclosureDate": "2020-02-14T00:00:00.000Z",
    "exploitPublishDate": "2020-02-07T00:00:00.000Z",
    "solution": "Fixed in [**2.6.0**](https://github.com/jsreport/jsreport/releases/tag/2.6.0).\n\nThe latest stable releases are available [here](https://github.com/jsreport/jsreport/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "UNCONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:UC)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "UNKNOWN",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:U"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-09-20T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4650",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8128",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4650/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jsreport/jsreport/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jsreport/jsreport/releases/tag/2.6.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/660565",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-JSREPORT-1245513",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4650/default-remediation-status"
            }
        ]
    }
}