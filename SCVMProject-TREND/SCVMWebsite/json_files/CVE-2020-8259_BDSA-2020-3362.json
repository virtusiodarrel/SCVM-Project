{
    "source": "BDSA",
    "name": "BDSA-2020-3362",
    "title": "Nextcloud Server Insufficient Protection of Server-Side Encryption Keys",
    "description": "Nextcloud server does not sufficiently protect server-side encryption keys.  This can lead to an attacker being able to replace public keys, leading to a complete loss of data integrity.",
    "technicalDescription": "The vulnerability is due to the server side encyption keys being insufficiently protected. An attacker with access to the Nextcloud server can use the key recovery feature to recover and replace the public keys with their own generated key.  This then allows the attacker to decrypt arbitrary files from the Nextcloud server.",
    "publishedDate": "2020-11-16T16:00:08.949Z",
    "updatedDate": "2020-11-16T16:49:33.422Z",
    "disclosureDate": "2020-10-03T00:00:00.000Z",
    "solution": "Fixed in [**20.0.0-RC1**](https://github.com/nextcloud/server/releases/tag/v20.0.0RC1) by [this](https://github.com/nextcloud/server/commit/65b5e651851ce0270de2b5087dc42fd3aa7cae31) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.8
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.9,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 0.6,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.0
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Kevin \"Kenny\" Niehage - SysEleven GmbH",
    "workaround": "",
    "vendorFixDate": "2020-08-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3362",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-522"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8259",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3362/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/65b5e651851ce0270de2b5087dc42fd3aa7cae31",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v20.0.0RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/732431",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://nextcloud.com/security/advisory/?id=NC-SA-2020-041",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3362/default-remediation-status"
            }
        ]
    }
}