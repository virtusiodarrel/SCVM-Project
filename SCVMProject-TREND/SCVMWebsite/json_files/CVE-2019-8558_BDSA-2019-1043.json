{
    "source": "BDSA",
    "name": "BDSA-2019-1043",
    "title": "WebKitGTK+ Vulnerable to Denial-of-Service (DoS) via Use After Free with 'CodeBlock' Objects",
    "description": "WebKitGTK+ is vulnerable to denial-of-service (DoS) due to a use after free issue in the JavaScriptCore component. An attacker could exploit this vulnerability by supplying a victim with maliciously crafted web content.",
    "technicalDescription": "WebKitGTK+ does not properly handle the freeing of `CodeBlock` objects after watchpoints are triggered. This could result in attempts to free a `CodeBlock` more than once and cause a use after free condition.\n\n\nIt appears that what is happening here is roughly the following:\n\n* The function v9 is called multiple times as callback during the string.replace operation\n* During the first invocation, the function v9 is JIT compiled at one of the inner loops and execution switches to the JIT code\n* The JIT compiled code has various dependencies on the outside environment in the form of Watchpoints\n* During the 2nd invocation, the LexicalEnvironment of v9 is recreated, triggering a Watchpoint (presumably because the function was originally compiled at one of the inner loops) and jettisoning the associated CodeBlock\n* At that point, there are no more references to the CodeBlock, and the following GC frees the object\n* Still during the 2nd invocation, after GC, another Watchpoint of the previous JIT code fires, again trying to jettison the CodeBlock that has already been freed\n\nThe freeing of the CodeBlock by the GC is possible because the Watchpoint itself only has a raw pointer to the CodeBlock and not any kind of GC reference that would keep it alive (or be set to nullptr)",
    "publishedDate": "2019-04-15T10:34:20.549Z",
    "updatedDate": "2020-07-23T15:20:04.863Z",
    "disclosureDate": "2019-04-10T00:00:00.000Z",
    "exploitPublishDate": "2019-04-03T00:00:00.000Z",
    "solution": "Fixed in version [**2.24.0**](https://webkitgtk.org/releases/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Samuel Gro\u00df of Google Project Zero",
    "workaround": "",
    "vendorFixDate": "2019-04-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1043",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-8558",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1043/ranges"
            },
            {
                "rel": "reference",
                "href": "https://webkitgtk.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://webkitgtk.org/security/WSA-2019-0002.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46650",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46650",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1043/default-remediation-status"
            }
        ]
    }
}