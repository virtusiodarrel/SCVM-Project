{
    "source": "BDSA",
    "name": "BDSA-2020-2699",
    "title": "SilverStripe Vulnerable to Information Disclosure via Incorrect Access Control via 'AssetControlExtension' Class",
    "description": "SilverStripe is vulnerable to an information disclosure vulnerability due to improper access controls. An attacker could exploit this to access files that should be protected from being viewed by the attacker.",
    "technicalDescription": "This vulnerability is due to the Upload PHP API setting protected folder's file visibility to public when a file is uploaded into it. This overrides the folder's access protected configuration that is set through either the `silverstripe/secureassets` module in 3.x versions, or through similar core functionality in 4.x versions.\n\nDue to an attacker accessing these files requiring knowledge of the exact filename they wish to access, the content hash which is added to every URL due to the `legacy_filenames=false` setting and the fact that file URLs are not listed by default, this attack is significantly harder for an attacker to carry out.",
    "publishedDate": "2020-10-09T13:15:56.963Z",
    "updatedDate": "2020-10-09T13:15:56.945Z",
    "disclosureDate": "2019-09-24T00:00:00.000Z",
    "solution": "Fixed in version [**4.4.4**](https://github.com/silverstripe/silverstripe-cms/tree/4.4.4), by [this](https://github.com/silverstripe/silverstripe-assets/commit/73e0cc69dc499c24aa706af9eddd8a2db2ac93e0) commit in the `silverstripe:assets` repo as stated in [this](https://docs.silverstripe.org/en/4/changelogs/4.4.4/) changelog.\n\n**Note:** In addition to applying the above version upgrade or patch, the vendor states that \"files which have already been uploaded to assumed protected folders through userforms will need to be re-protected. This can be achieved by saving the protected folder in admin/assets, which will re-sync files on the filesystem into the correct place (assets/.protected).\"\nThe above works for folders with small amounts of files, for large amounts of files, the vendor suggests writing a custom task which the vendor is including in an upcoming build.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nicolaas Thiemen",
    "workaround": "",
    "vendorFixDate": "2019-09-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2699",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12245",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2699/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.silverstripe.org/en/4/changelogs/4.4.4/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-assets/commit/73e0cc69dc499c24aa706af9eddd8a2db2ac93e0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-cms/tree/4.4.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.silverstripe.org/download/security-releases/CVE-2019-12245",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2699/default-remediation-status"
            }
        ]
    }
}