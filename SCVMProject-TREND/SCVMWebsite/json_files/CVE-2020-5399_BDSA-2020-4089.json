{
    "source": "BDSA",
    "name": "BDSA-2020-4089",
    "title": "Cloud Foundry CredHub Vulnerable to Man-in-the-Middle Attacks via Insecure Connection to MySQL Database",
    "description": "Cloud Foundry CredHub is vulnerable to man-in-the-middle attacks due to improper enforcement of secure connections to its MySQL database. This could allow an attacker to intercept sensitive information in order to gain access to components whose credentials are managed by CredHub.",
    "technicalDescription": "The issue exists within the files `spec/credhub/application_spring_yml_spec.rb` and `spec/credhub/application_spring_yml_spec.rb`. A secure connection to the database may not be established even if TLS has been configured.\n\nThe vendor addressed this issue by using `useSSL` and `requireSSL` in the connection URL to ensure TLS is enforced.",
    "publishedDate": "2021-01-20T17:01:09.465Z",
    "updatedDate": "2021-01-20T17:01:09.456Z",
    "disclosureDate": "2020-02-12T00:00:00.000Z",
    "solution": "Fixed in [**2.5.10**](https://github.com/pivotal/credhub-release/releases/tag/2.5.10) by [this](https://github.com/pivotal/credhub-release/commit/c5ab4691ab1c3958216b65422c747e7bc1de5d4d) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rob Greene",
    "workaround": "",
    "vendorFixDate": "2020-01-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4089",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-319"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5399",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4089/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pivotal/credhub-release/commit/c5ab4691ab1c3958216b65422c747e7bc1de5d4d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pivotal/credhub-release/releases/tag/2.5.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.cloudfoundry.org/blog/cve-2020-5399/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4089/default-remediation-status"
            }
        ]
    }
}