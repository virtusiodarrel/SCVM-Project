{
    "source": "BDSA",
    "name": "BDSA-2019-3227",
    "title": "Radare2 Vulnerable to OS Command Injection via Improper String Parsing in 'bin_symbols()' Function",
    "description": "Radare2 is vulnerable to command injection due to the improper interpretation of user-provided input. An attacker could execute arbitrary operating system commands by tricking a victim into executing a maliciously crafted file.",
    "technicalDescription": "The functions `__filterQuotedShell()` and `bin_symbols()` are defined within the script `cbin.c`. The first of these functions is used to filter out escape characters from a string that is derived from user input. It does so by using a blacklist of symbols that are to be removed. This blacklist is not comprehensive, such that special characters that are of use to an attacker can pass the filtering process. The function `bin_symbols()` manipulates a format string that will be used in the dynamic construction of commands. Certain command strings will cause commands to be executed on the OS that is running the Radare2 application. The string constructed by `bin_symbols()` can be derived from the contents of a user-specified input file. This means that an attacker could execute commands on a victim's OS by tricking them into running Radare2 using an input file that has been maliciously crafted.",
    "publishedDate": "2019-10-22T09:56:55.033Z",
    "updatedDate": "2019-10-22T09:56:55.017Z",
    "disclosureDate": "2019-09-09T00:00:00.000Z",
    "exploitPublishDate": "2019-09-09T00:00:00.000Z",
    "solution": "Fixed in version [**3.9.0**](https://github.com/radareorg/radare2/releases/tag/3.9.0) by [this](https://github.com/radareorg/radare2/commit/dd739f5a45b3af3d1f65f00fe19af1dbfec7aea7) commit.\n\nThe latest stable release can be found [here](https://github.com/radareorg/radare2/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-09-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3227",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-16718",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3227/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/radareorg/radare2/commit/dd739f5a45b3af3d1f65f00fe19af1dbfec7aea7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/radareorg/radare2/issues/14990",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/radareorg/radare2/issues/14990",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/radareorg/radare2/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/radareorg/radare2/releases/tag/3.9.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3227/default-remediation-status"
            }
        ]
    }
}