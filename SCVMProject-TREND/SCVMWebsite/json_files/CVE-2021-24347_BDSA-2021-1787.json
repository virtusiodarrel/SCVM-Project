{
    "source": "BDSA",
    "name": "BDSA-2021-1787",
    "title": "SP Project & Document Manager Vulnerable to Remote Code Execution (RCE) via Unrestricted File Upload",
    "description": "The SP Project & Document Manager WordPress plugin is vulnerable to remote code execution (RCE) due to a flaw in how file extension verification is performed.\n\nThis flaw could allow a remote attacker to upload a dangerous executable file to the server and potentially execute arbitrary code.",
    "technicalDescription": "The SP Project & Document Manager WordPress plugin is vulnerable to remote code execution (RCE) because the file extension verification functionality, while attempting to prevent uploads of .php and other similar files, does not sufficiently validate cases where the file extension has been tampered with. \n\nIt is possible for PHP files to still be uploaded by changing the file extension's case using the `dlg-upload-file[]` parameter, e.g. `php` to `pHP`.",
    "publishedDate": "2021-06-15T14:59:36.812Z",
    "updatedDate": "2021-06-15T14:59:36.805Z",
    "disclosureDate": "2021-05-25T00:00:00.000Z",
    "exploitPublishDate": "2021-05-25T00:00:00.000Z",
    "solution": "Fixed in [**4.22**](https://en-gb.wordpress.org/plugins/sp-client-document-manager/) by [this](https://plugins.trac.wordpress.org/changeset/2540811/sp-client-document-manager) changeset.\n\nThe latest stable releases are available [here](https://en-gb.wordpress.org/plugins/sp-client-document-manager/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Viktor Markopoulos",
    "workaround": "",
    "vendorFixDate": "2021-06-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1787",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-24347",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1787/ranges"
            },
            {
                "rel": "reference",
                "href": "https://en-gb.wordpress.org/plugins/sp-client-document-manager/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://plugins.trac.wordpress.org/changeset/2540811/sp-client-document-manager",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://wpscan.com/vulnerability/8f6e82d5-c0e9-468e-acb8-7cd549f6a45a",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://wpscan.com/vulnerability/8f6e82d5-c0e9-468e-acb8-7cd549f6a45a",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1787/default-remediation-status"
            }
        ]
    }
}