{
    "source": "BDSA",
    "name": "BDSA-2019-2113",
    "title": "ElectricFlow Plugin for Jenkins Vulnerable to Stored Cross-Site Scripting (XSS) via Un-escaped Meta Data in 'getSummaryHtml'",
    "description": "The ElectricFlow plugin for Jenkins is vulnerable to cross-site scripting (XSS). A remote attacker with low privileges can inject arbitrary HTML or JavaScript into metadata associated with builds.  This can result in the theft of credentials, session cookies, or other sensitive information.",
    "technicalDescription": "The cross-site scripting (XSS) vulnerability is due to a lack of sanitization of input supplied to the ElectricFlow plugin.  Some fields, such as the URL fields, and Protocol method field will be stored as meta data associated with a Job. This meta data will be rendered on the \"Builds Page\" on Jenkins UI.  A remote attacker with \"Job\" or \"Configure\" permissions, or an attacker that can man-in-the-middle an API response from ElectricFlow, can inject arbitrary JavaScript into attributes that will get stored server-side.  Successful exploitation requires an authenticated victim to view the \"builds Page\" containing the injected code.\n\nThe change to store unsanitized input in the \"Builds Page\" was introduced in [this](https://github.com/jenkinsci/electricflow-plugin/commit/e78f32ee6588cf6b78f23edbb1603cef0a5789e8) commit.",
    "publishedDate": "2019-07-15T12:12:58.439Z",
    "updatedDate": "2019-07-15T12:12:58.427Z",
    "disclosureDate": "2019-06-11T00:00:00.000Z",
    "solution": "Fixed in versions [**1.1.6**](https://github.com/jenkinsci/electricflow-plugin/releases/tag/electricflow-1.1.6) by [this](https://github.com/jenkinsci/electricflow-plugin/commit/1a90ee7727f8c6925df3e410837ddf6be28cce53) commit",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Daniel Beck, CloudBees, Inc",
    "workaround": "",
    "vendorFixDate": "2019-05-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2113",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10335",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2113/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/electricflow-plugin/commit/1a90ee7727f8c6925df3e410837ddf6be28cce53",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/electricflow-plugin/releases/tag/electricflow-1.1.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jenkins.io/security/advisory/2019-06-11/#SECURITY-1412",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2113/default-remediation-status"
            }
        ]
    }
}