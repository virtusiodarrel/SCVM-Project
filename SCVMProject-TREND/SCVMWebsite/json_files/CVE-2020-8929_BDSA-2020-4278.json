{
    "source": "BDSA",
    "name": "BDSA-2020-4278",
    "title": "Tink Vulnerable to Broken Ciphertext Integrity via Mis-handling of Invalid Unicode Characters",
    "description": "Tink is vulnerable to broken ciphertext integrity. An attacker can take advantage of this in order to create a mutated ciphertext that will still decrypt to the same plaintext as the original ciphertext.",
    "technicalDescription": "The principle of indistinguishability within cryptography is important, this is the idea that a cryptographic algorithm that possesses the property of indistinguishability, means that an attacker will be unable to distinguish pairs of ciphertexts based on the message they encrypt. This vulnerability exists due to the cryptography within Tink not possessing the property of indistinguishability.\n\nThe first 5 bytes of any given ciphertext in Tink will consist of a version byte and a `key ID` which is 4 bytes long. These prefixes are stored in a hash map which is indexed by unicode strings, which means that any invalid Unicode character will be replaced by the default `U+FFFD`. This could lead to multiple values for the 5 byte prefix resulting in the same hash key. This means that conditions exist which provide attackers with the ability to change the `key ID` part of a ciphertext, resulting in a mutated ciphertext that will still decrypt to the same plaintext as the original ciphertext. This issue breaks the principle of indistinguishability.",
    "publishedDate": "2021-03-17T17:11:55.524Z",
    "updatedDate": "2022-03-18T10:03:40.076Z",
    "disclosureDate": "2020-10-15T00:00:00.000Z",
    "solution": "Fixed in [**1.5.0**](https://github.com/google/tink/releases/tag/v1.5.0) by [this](https://github.com/google/tink/commit/93d839a5865b9d950dffdc9d0bc99b71280a8899) commit.\n\nThe latest releases are available [here](https://github.com/google/tink).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Peter Esbensen",
    "workaround": "",
    "vendorFixDate": "2020-10-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4278",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-327"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8929",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4278/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/tink",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/tink/commit/93d839a5865b9d950dffdc9d0bc99b71280a8899",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/tink/releases/tag/v1.5.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/tink/security/advisories/GHSA-g5vf-v6wf-7w2r",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4278/default-remediation-status"
            }
        ]
    }
}