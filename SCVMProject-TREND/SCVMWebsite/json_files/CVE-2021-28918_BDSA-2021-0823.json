{
    "source": "BDSA",
    "name": "BDSA-2021-0823",
    "title": "netmask npm Package Vulnerable to Multiple Attacks via Improper Input Validation of Octal Strings",
    "description": "netmask npm package is vulnerable to multiple remote attacks such as remote file inclusion (RFI) and server side request forgery (SSRF) via improper input validation of octal strings. A remote attacker could exploit this in order to bypass restrictions on any packages that rely on netmask to filter IP address blocks. Local file inclusion (LFI) may also be possible.",
    "technicalDescription": "This issue occurs in the `lib/netmask.coffee` file due to improper handling of IP addresses with less than four bytes. It was incorrectly treating them as left-stripped integers with a netmask of the size of the provided bytes e.g.  1 = 8, 2 = 16, 3 = 24. In doing so it completed the IP with `0`'s on the right hand side. \n\nAs the proof of concept (PoC)demonstrates, a remote unauthenticated attacker could request local resources using `0177.0.0.1 (127.0.0.1)`, which would be evaluated as public IP `177.0.0.1`. In contrast, a remote attacker, either authenticated or unauthenticated, could input `0127.0.0.01 (87.0.0.1)` as localhost, yet this is a public IP which could potentially permit local and remote file inclusion (LFI/RFI).\n\nIt was mitigated by the addition of extra parsing designed to interpret missing bytes as being `0`s on the left hand side. Additionally mask size is no longer calculated by the number of bytes provided.\n\n**Note** this issue was purported to be fixed by [this](https://github.com/rs/node-netmask/commit/9f9fc38c6db1a682d23289b5c9dc2009d957a00b) commit in version **2.0.0**. This was however found to be incomplete and a new CVE issued (**BDSA-2021-2591**, **CVE-2021-29418**).",
    "publishedDate": "2021-03-31T08:33:36.118Z",
    "updatedDate": "2022-02-23T17:06:35.517Z",
    "disclosureDate": "2021-03-28T00:00:00.000Z",
    "exploitPublishDate": "2021-03-28T00:00:00.000Z",
    "solution": "Fixed in version [**2.0.1**](https://github.com/rs/node-netmask/releases/tag/2.0.1) by [this](https://github.com/rs/node-netmask/commit/3f19a056c4eb808ea4a29f234274c67bc5a848f4) commit.\n\nThe latest releases can be found [here](https://github.com/rs/node-netmask/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "sickcodes",
    "workaround": "",
    "vendorFixDate": "2021-03-29T00:00:00.000Z",
    "discoveryDate": "2021-03-16T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0823",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28918",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0823/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rs/node-netmask/commit/3f19a056c4eb808ea4a29f234274c67bc5a848f4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rs/node-netmask/commit/9f9fc38c6db1a682d23289b5c9dc2009d957a00b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rs/node-netmask/releases/tag/2.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rs/node-netmask/releases/tag/2.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rs/node-netmask/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-011.md",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sick.codes/universal-netmask-npm-package-used-by-270000-projects-vulnerable-to-octal-input-data-server-side-request-forgery-remote-file-inclusion-local-file-inclusion-and-more-cve-2021-28918",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0823/default-remediation-status"
            }
        ]
    }
}