{
    "source": "BDSA",
    "name": "BDSA-2019-1918",
    "title": "FreeBSD Vulnerable to Denial-of-Service (DoS) via Uncontrolled RACK Link List Expansion",
    "description": "FreeBSD is vulnerable to denial-of-service (DoS) due to the uncontrolled allocation of resources whenever the RACK algorithm is being utilized. A remote attacker could degrade the performance of networking and CPU activities on a victim system by delivering crafted TCP traffic to that system.",
    "technicalDescription": "FreeBSD implements the Recent Acknowledgement (RACK) algorithm, which is used for TCP loss detection, using code contained in the script `rack.c`. This code constructs linked lists, the memory for which is allocated using code contained in the function `rack_alloc()`. These linked list are used for the send map, which is used to track data that is still to be sent over the TCP connection. The send map is fragmented in response to Selective Acknowledgement (SACK) packets; this will result in the creation of additional linked list elements. There are no limits imposed by the program on how much the send map can be fragmented. An attacker could therefore consume resources by sending crafted SACK traffic to a target system, impacting the performance of both CPU and networking activities.",
    "publishedDate": "2019-06-27T13:11:41.857Z",
    "updatedDate": "2020-05-26T16:06:13.176Z",
    "disclosureDate": "2019-06-19T00:00:00.000Z",
    "solution": "Fixed in [**12.1.0**](https://www.freebsd.org/where.html) by [this](https://svnweb.freebsd.org/base?view=revision&sortby=date&revision=349197) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jonathan Looney, Peter Lei",
    "workaround": "RACK can be disabled by unloading the relevant kernel module with the command `kldunload tcp_rack` (note that the `-f` flag may need to be used with the `kldunload` command).",
    "vendorFixDate": "2019-06-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1918",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-770"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5599",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1918/ranges"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=349197",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-19:08.rack.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-19:08.rack.asc",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/where.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1918/default-remediation-status"
            }
        ]
    }
}