{
    "source": "BDSA",
    "name": "BDSA-2020-0946",
    "title": "TeamPass Vulnerable to Local File Inclusion via Language Selection Functionality",
    "description": "TeamPass contains a local file inclusion vulnerability due to insufficient validation of user-controlled input. An attacker could exploit this vulnerability to trigger a file inclusion of any PHP file on the web server. If the attacker was able to upload their own PHP file to the web server, this could lead to arbitrary code execution.",
    "technicalDescription": "When the `newValue` parameter in `sources/users.queries.php` is used to identify the `userlanguage` specified by the user, it is not validated to ensure it is one of the expected options of language before being stored as the `user_language`. This value is later used in `sources/core.php` upon login to include the PHP file specified if it exists. \nIf an attacker included a value such as `../backups/script.backup` for their language preference, it is possible for the attacker to access arbitrary PHP files on the system. In the event that an attacker was able to upload their own files to the server, it may be possible to execute arbitrary code.",
    "publishedDate": "2020-04-30T13:59:19.323Z",
    "updatedDate": "2021-09-21T12:52:35.135Z",
    "disclosureDate": "2020-04-02T00:00:00.000Z",
    "exploitPublishDate": "2020-04-02T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "UNCONFIRMED",
            "score": 4.2
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:POC/RL:W/RC:UC)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "UNKNOWN",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:P/RL:W/RC:U"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": true,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "bstapes",
    "workaround": "A fix has been proposed via the following commits:\n* [Commit 1](https://github.com/nilsteampassnet/TeamPass/pull/2874/commits/1e36e25a1b0f0d321b6550cc3aaeceef57cdc804)\n* [Commit 2](https://github.com/nilsteampassnet/TeamPass/pull/2874/commits/3c805932f128fb5638340c3d60f074ab4fccc4ca)\n* [Commit 3](https://github.com/nilsteampassnet/TeamPass/pull/2874/commits/b849e249e0ab8e05ea3dc90036b8f062d004b580)\n\nHowever, these have not yet been merged into the main repository.",
    "vendorNotifiedDate": "2020-04-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0946",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-98"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12479",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0946/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nilsteampassnet/TeamPass/issues/2762",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nilsteampassnet/TeamPass/issues/2762",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nilsteampassnet/TeamPass/pull/2874/commits/1e36e25a1b0f0d321b6550cc3aaeceef57cdc804",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nilsteampassnet/TeamPass/pull/2874/commits/3c805932f128fb5638340c3d60f074ab4fccc4ca",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nilsteampassnet/TeamPass/pull/2874/commits/b849e249e0ab8e05ea3dc90036b8f062d004b580",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0946/default-remediation-status"
            }
        ]
    }
}