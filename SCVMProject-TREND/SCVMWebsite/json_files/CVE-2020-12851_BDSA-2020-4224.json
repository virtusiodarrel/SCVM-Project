{
    "source": "BDSA",
    "name": "BDSA-2020-4224",
    "title": "Pydio Cells Vulnerable to Arbitrary File Writes via Directory Traversal during Zip File Extraction",
    "description": "Pydio Cells contains a directory traversal vulnerability in its `.zip` file extraction process. An authenticated attacker could upload and extract a malicious `.zip` file on the server that could cause arbitrary file writes.",
    "technicalDescription": "This vulnerability exists because the `.zip` file extraction process allows files to be written and overwritten to arbitrary paths on the server. An authenticated attacker could exploit this flaw by causing arbitrary file writes in another user's designated directory. An attacker could upload a malicious `.zip` file and extract it. This causes an arbitrary file write in the victim's directory. \nThis issue was fixed in `common/views/archive-reader.go` by sanitizing the file names during extraction using the `path.Clean()` function.",
    "publishedDate": "2021-03-03T15:34:11.737Z",
    "updatedDate": "2021-03-03T15:34:11.732Z",
    "disclosureDate": "2020-05-20T00:00:00.000Z",
    "exploitPublishDate": "2020-05-20T00:00:00.000Z",
    "solution": "Fixed in [**2.0.7**](https://github.com/pydio/cells/releases/tag/v2.0.7) by [this](https://github.com/pydio/cells/commit/327acf08eb696bc0c6f5886539404c585b30b03a) commit.\n\nThe latest stable releases are available [here](https://github.com/pydio/cells/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Iv\u00e1n Koiffman and Ramiro Molina from Core Security Consulting Services",
    "workaround": "",
    "vendorFixDate": "2020-05-08T00:00:00.000Z",
    "discoveryDate": "2020-04-07T00:00:00.000Z",
    "vendorNotifiedDate": "2020-04-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4224",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12851",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4224/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pydio/cells/commit/327acf08eb696bc0c6f5886539404c585b30b03a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pydio/cells/releases/tag/v2.0.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pydio/cells/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.coresecurity.com/core-labs/advisories/pydio-cells-204-multiple-vulnerabilities",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.coresecurity.com/core-labs/advisories/pydio-cells-204-multiple-vulnerabilities",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4224/default-remediation-status"
            }
        ]
    }
}