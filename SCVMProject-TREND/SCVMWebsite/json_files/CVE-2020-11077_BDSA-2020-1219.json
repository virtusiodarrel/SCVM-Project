{
    "source": "BDSA",
    "name": "BDSA-2020-1219",
    "title": "Puma Vulnerable to HTTP Request Smuggling via 'Transfer-Encoding' Header",
    "description": "Puma contains an HTTP request smuggling vulnerability due to the improper processing of HTTP request headers. A client could smuggle a request through a proxy, causing the proxy to send a response back to another unknown user. This could be used by malicious actors to cause harm to the backend or other users .",
    "technicalDescription": "The vulnerability arises when Puma is connected to an HTTP proxy that uses persistent connections and a client adds another request to the original one via HTTP pipelining (using `Transfer-Encoding` header). In such case the proxy may mistake the pipelined request as the first request's body. Puma, however, would see it as two requests and, after processing the second request, send back a response that the proxy does not expect. Since the proxy is using a persistent connection to Puma to handle a request from another client, it will send the second response (originally addressed to the first client) to the second client. This allows the first client to influence what the second client sees as a response from the server and thus perform attacks on the second client which could eventually damage the server's integrity and confidentiality.",
    "publishedDate": "2020-05-27T11:53:46.290Z",
    "updatedDate": "2022-06-06T14:07:26.166Z",
    "disclosureDate": "2020-05-21T00:00:00.000Z",
    "solution": "Fixed in **[3.12.6](https://rubygems.org/gems/puma/versions/3.12.6)** by [this](https://github.com/puma/puma/commit/089df0727ffab1b3b69f2e6da40597c52e346013) commit.\nFixed in **[4.3.5](https://rubygems.org/gems/puma/versions/4.3.5)** by [this](https://github.com/puma/puma/commit/f3b409c565d67557c04ad37c10a42dd8cad0b655) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-05-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1219",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11077",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1219/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/puma/puma/blob/master/History.md#434435-and-31253126--2020-05-22",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/puma/puma/commit/089df0727ffab1b3b69f2e6da40597c52e346013",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/puma/puma/commit/f3b409c565d67557c04ad37c10a42dd8cad0b655",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/puma/puma/security/advisories/GHSA-w64w-qqph-5gxm",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://rubygems.org/gems/puma/versions/3.12.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://rubygems.org/gems/puma/versions/4.3.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1219/default-remediation-status"
            }
        ]
    }
}