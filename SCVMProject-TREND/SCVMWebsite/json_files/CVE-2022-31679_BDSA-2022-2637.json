{
    "source": "BDSA",
    "name": "BDSA-2022-2637",
    "title": "Spring Data REST Vulnerable to Information Exposure via HTTP Patch Access",
    "description": "Spring Data REST is vulnerable to information exposure when used with applications that allow HTTP PATCH access to resources. An attacker that knows the structure of the underlying domain model could craft HTTP requests that expose hidden entity attributes.",
    "technicalDescription": "The vulnerability exists in the JSON patch implementation due to improper property detection for which values are supposed to be set. It was mainly fixed by adding `BindContextFactory` instead of having direct `ObjectMapper` access in the `JsonPatchHandler()` method, of file `spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/config/JsonPatchHandler.java`.",
    "publishedDate": "2022-09-22T16:40:11.152Z",
    "updatedDate": "2022-09-22T16:40:11.139Z",
    "disclosureDate": "2022-09-19T00:00:00.000Z",
    "solution": "Fixed in:\n* **[3.6.7](https://github.com/spring-projects/spring-data-rest/releases/tag/3.6.7)** by [this](https://github.com/spring-projects/spring-data-rest/commit/bf37590b) commit\n* **[3.7.3](https://github.com/spring-projects/spring-data-rest/releases/tag/3.7.3)** by [this](https://github.com/spring-projects/spring-data-rest/commit/2ad081f7) commit\n* **[4.0.0-m6](https://github.com/spring-projects/spring-data-rest/releases/tag/4.0.0-M6)** by [this](https://github.com/spring-projects/spring-data-rest/commit/5d0687d1) commit\n\nThe latest stable releases can be found [here](https://github.com/spring-projects/spring-data-rest/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "\u767d\u5e3d\u9171 @burpheart",
    "workaround": "The vendor presents the following workaround: \n> If the resources exposed by Spring Data REST do not need to support HTTP PATCH requests, you can disable that support as described [here](https://docs.spring.io/spring-data/rest/docs/current/reference/html/#customizing-sdr.http-methods). Applications that have generally disabled HTTP PATCH support, either through the corresponding configuration of Spring Data REST, Spring Boot or through their runtime infrastructure, are not affected, either.",
    "vendorFixDate": "2022-09-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2637",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31679",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2637/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.spring.io/spring-data/rest/docs/current/reference/html/#customizing-sdr.http-methods",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-rest/commit/2ad081f7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-rest/commit/5d0687d1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-rest/commit/bf37590b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-rest/commit/ef3720be11f117bb691edbbf63e38ff72e0eb3dd",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-rest/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-rest/releases/tag/3.6.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-rest/releases/tag/3.7.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-data-rest/releases/tag/4.0.0-M6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://tanzu.vmware.com/security/cve-2022-31679",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://tanzu.vmware.com/security/cve-2022-31679",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2637/default-remediation-status"
            }
        ]
    }
}