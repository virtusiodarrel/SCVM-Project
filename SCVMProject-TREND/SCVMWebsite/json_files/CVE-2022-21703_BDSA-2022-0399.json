{
    "source": "BDSA",
    "name": "BDSA-2022-0399",
    "title": "Grafana Vulnerable to Cross-Site Request Forgery (CSRF) via Missing Login Cookie Origin Checks",
    "description": "Grafana is vulnerable to cross-site request forgery (CSRF) due to missing login cookie origin checks. Unauthenticated attackers could target high-privileged Grafana users with cross-origin attacks (such as crafted links) in order to elevate their privileges.",
    "technicalDescription": "",
    "publishedDate": "2022-02-11T10:34:10.355Z",
    "updatedDate": "2022-02-11T10:34:10.328Z",
    "disclosureDate": "2022-02-08T00:00:00.000Z",
    "solution": "Fixed in **[7.5.15](https://github.com/grafana/grafana/releases/v7.5.15)** by [this](https://github.com/grafana/grafana/commit/7dd69b2442fa97981a25b7696b51432218f086b4) commit and in **[8.3.5](https://github.com/grafana/grafana/releases/v8.3.5)** by [this](https://github.com/grafana/grafana/commit/405654b33f205b903caf04ff9d8ba13e6db7ee39) commit.\n\nThe vendor has also added the following note:\n> Note that if you are running Grafana behind any reverse proxy, you need to make sure that you are passing the original Host and Origin headers from the client request to Grafana.\n> \n> In the case of Apache Server, you need to add `ProxyPreserveHost` on in your proxy configuration. In case of `NGINX`, you can need to add `proxy_set_header Host $http_host;`in your configuration.\n\nThe latest stable releases can be found [here](https://grafana.com/grafana/download).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "jub0bs, abrahack (Twitter)",
    "workaround": "",
    "vendorFixDate": "2022-01-25T00:00:00.000Z",
    "vendorNotifiedDate": "2022-01-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0399",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-21703",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0399/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/405654b33f205b903caf04ff9d8ba13e6db7ee39",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/7dd69b2442fa97981a25b7696b51432218f086b4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/v7.5.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/v8.3.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/security/advisories/GHSA-cmf4-h3xc-jw8w",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://grafana.com/grafana/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0399/default-remediation-status"
            }
        ]
    }
}