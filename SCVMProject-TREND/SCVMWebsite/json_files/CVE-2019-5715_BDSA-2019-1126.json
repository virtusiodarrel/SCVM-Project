{
    "source": "BDSA",
    "name": "BDSA-2019-1126",
    "title": "Silverstripe Vulnerable to SQL Injection (SQLi) via Form and DataObject",
    "description": "Silverstripe  is vulnerable to SQL injection due to improper validation on user-supplied input. An attacker can execute malicious SQL queries to access sensitive information and modify the database.",
    "technicalDescription": "The vulnerability is caused by user supplied input being executed as SQL `SELECT` statement during the process of writing this input to the database record. This does not affect the database records database identifier, it only affects the record properties which are intended to be written to by this user input.\n\nBoth direct assignment and indirect assignment are affected \n* (Direct) `DataObject` (update() setters via method calls and setters via magic methods)  \n* (Indirect) e.g. Form->saveInto()\n\nThis vulnerability is associated with the `DBField` classes supporting the `DataObject` logic. In SilverStripe 3 most `DBField` types are affected In SilverStripe 4 only the `DBYear` field type is confirmed to be affected.\n\nThis vulnerability allows exposing of user credentials in certain circumstances however the credentials are secured by strong one-way cryptography (bcrypt hashed with individual salts). For an attacker to gain offline access against the user\u2019s password is unrealistic.\n\nSince the endpoints of user input accepted by the content management system (CMS) require authentication they are not affected.",
    "publishedDate": "2019-04-23T15:35:55.574Z",
    "updatedDate": "2019-04-23T15:35:55.558Z",
    "disclosureDate": "2019-02-19T00:00:00.000Z",
    "solution": "Fixed in [**3.6.7**](https://github.com/silverstripe/silverstripe-framework/releases/tag/3.6.7) and [**3.7.3**](https://github.com/silverstripe/silverstripe-framework/releases/tag/3.7.3) by [this](https://github.com/silverstripe/silverstripe-framework/commit/c44f06cdf10387a987e4efb096ff06b3bb4495ef) commit.\n\nFixed in version [**4.0.7**](https://github.com/silverstripe/silverstripe-framework/releases/tag/4.0.7) by [this](https://github.com/silverstripe/silverstripe-framework/commit/c44f06cdf10387a987e4efb096ff06b3bb4495ef) commit.\n\nFixed in version [**4.1.5**](https://github.com/silverstripe/silverstripe-framework/releases/tag/4.1.5) by [this](https://github.com/silverstripe/silverstripe-framework/commit/fd90cf6ceb346142eee6ba620599ab36c2d18cbb) commit.\n\nFixed in version [**4.2.4**](https://github.com/silverstripe/silverstripe-framework/releases/tag/4.2.4) by [this](https://github.com/silverstripe/silverstripe-framework/commit/7cc40fe392ed907be8fbfc73579b4888840c39e6) commit.  \n\nFixed in version [**4.3.1**](https://github.com/silverstripe/silverstripe-framework/releases/tag/4.3.1) by [this](https://github.com/silverstripe/silverstripe-framework/commit/692cc3fcff9f8db088beff51e1955146e8cffa6e) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.7,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "James Turner (plastyk studios)",
    "workaround": "",
    "vendorFixDate": "2019-02-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1126",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5715",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1126/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/commit/692cc3fcff9f8db088beff51e1955146e8cffa6e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/commit/7cc40fe392ed907be8fbfc73579b4888840c39e6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/commit/c44f06cdf10387a987e4efb096ff06b3bb4495ef",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/commit/fd90cf6ceb346142eee6ba620599ab36c2d18cbb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/3.6.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/3.7.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/4.0.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/4.1.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/4.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/4.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.silverstripe.org/download/security-releases/ss-2018-021",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1126/default-remediation-status"
            }
        ]
    }
}