{
    "source": "BDSA",
    "name": "BDSA-2021-4346",
    "title": "GoCD Vulnerable to Information Exposure via Arbitrary File Read in 'Business Continuity' Component",
    "description": "GoCD is vulnerable to information exposure due to the insufficient validation of an input parameter that is used in file read operations. A remote unauthenticated attacker could leverage this issue in order to retrieve the contents of arbitrary files on the server. The attacker can also retrieve the key that is used to encrypt sensitive information, as well as pipeline configuration information.",
    "technicalDescription": "GoCD's Business Continuity endpoint consists of a number of different endpoints. Several of these endpoints contain serious information exposure vulnerabilities. The `plugin` endpoint is powered by the `getPluginFile()` function, of file `com/thoughtworks/go/addon/businesscontinuity/primary/controller/PrimaryStatusProviderController.java`. This uses the client-controlled parameter `pluginName`, which is used to locate a file on the server. The contents of that file will be returned to the client. The value of `pluginName` is insufficiently sanitized, meaning that an attacker can use a maliciously crafted file name that contains a relative path in order to recover the contents of arbitrary files. The `cruise_config` and `cipher.aes` endpoints are powered by the `getLatestCruiseConfigXML()` and `getLatestAESCipher()` functions respectively. The `cipher.aes` endpoint can be used to leak the key that is used to encrypt sensitive information on the server, and the `cruise_config` endpoint can be used to leak server configuration information.\n\nA remote unauthenticated attacker can leverage these vulnerabilities in order to recover arbitrary sensitive data from the server, even if it has been encrypted.\n\nThe vendor addressed these vulnerabilities by disabling the Business Continuity component.",
    "publishedDate": "2022-04-19T14:08:17.028Z",
    "updatedDate": "2022-04-19T14:08:17.009Z",
    "disclosureDate": "2021-10-27T00:00:00.000Z",
    "exploitPublishDate": "2021-10-27T00:00:00.000Z",
    "solution": "Fixed in version [**21.3.0**](https://github.com/gocd/gocd/releases/tag/21.3.0) by [this](https://github.com/gocd/gocd/commit/41abc210ac4e8cfa184483c9ff1c0cc04fb3511c) commit.\n\nThe latest stable releases can be found [here](https://github.com/gocd/gocd/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Simon Scannell (SonarSource)",
    "workaround": "",
    "vendorFixDate": "2021-10-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4346",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-23"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43287",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4346/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.sonarsource.com/gocd-pre-auth-pipeline-takeover",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.sonarsource.com/gocd-pre-auth-pipeline-takeover",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gocd/gocd/commit/41abc210ac4e8cfa184483c9ff1c0cc04fb3511c",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gocd/gocd/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gocd/gocd/releases/tag/21.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4346/default-remediation-status"
            }
        ]
    }
}