{
    "source": "BDSA",
    "name": "BDSA-2021-1952",
    "title": "Go Vulnerable to Hop-by-Hop Header Abuse via ReverseProxy Forwarding",
    "description": "Go is vulnerable to hop-by-hop header abuse via `ReverseProxy` forwarding of connection headers in cases where the first one is empty. Successful exploitation of this vulnerability could lead to information disclosure, bypass of defensive mechanisms such as web application firewall's (WAF), or denial-of-service (DoS) issues.",
    "technicalDescription": "This issue occurs in the `ServeHTTP()` function of the `src/net/http/httputil/reverseproxy.go` file because connection header were not removed. This could be exploited if a reverse proxy was the target for `ReverseProxy` as it would allow an attacker to drop headers including those set by `ReverseProxy.Director`. It was mitigated by ensuring that hop-by-hop headers are always removed.",
    "publishedDate": "2021-06-29T12:15:29.718Z",
    "updatedDate": "2021-06-29T12:15:29.713Z",
    "disclosureDate": "2021-05-21T00:00:00.000Z",
    "solution": "Fixed in [**1.15.13**](https://github.com/golang/go/releases/tag/go1.15.13) by [this](https://github.com/golang/go/commit/cbd1ca84453fecf3825a6bb9f985823e8bc32b76) commit.\nFixed in [**1.16.5**](https://github.com/golang/go/releases/tag/go1.16.5) by [this](https://github.com/golang/go/commit/0410005dc458f23fb15f64354f9a24ca8f2fe044) commit.\n\nThe latest stable releases are available [here](https://github.com/golang/go/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mattias Grenfeldt (https://grenfeldt.dev) and Asta Olofsson",
    "workaround": "",
    "vendorFixDate": "2021-05-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1952",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33197",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1952/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/0410005dc458f23fb15f64354f9a24ca8f2fe044",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/cbd1ca84453fecf3825a6bb9f985823e8bc32b76",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/issues/46313",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases/tag/go1.15.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases/tag/go1.16.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/golang-announce/c/RgCMkAEQjSI",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1952/default-remediation-status"
            }
        ]
    }
}