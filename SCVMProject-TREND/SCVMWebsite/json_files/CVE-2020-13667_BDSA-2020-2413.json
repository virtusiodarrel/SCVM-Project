{
    "source": "BDSA",
    "name": "BDSA-2020-2413",
    "title": "Drupal Core Vulnerable to Access Bypass via Insufficient Permissions Checks in Workspaces Module",
    "description": "When using the experimental Workspaces module, Drupal Core is vulnerable to an access bypass issue due to a lack of sufficient permission checks when a user switches workspaces.\n\nAn attacker could use this issue to gain access to potentially sensitive content when they otherwise should not be able to, or before the site owners intends.",
    "technicalDescription": "Drupal Core is vulnerable to an access bypass issue when the experimental Workspaces module is being used because the `core/modules/workspaces/src/WorkspaceManager.php` file lacks sufficient `view` access checks when retrieving the current active workspace.\n\nAn attacker could use this issue to gain access to potentially sensitive draft content before it has been published to the live workspace.",
    "publishedDate": "2020-09-17T13:19:53.232Z",
    "updatedDate": "2020-09-17T13:19:53.227Z",
    "disclosureDate": "2020-09-16T00:00:00.000Z",
    "solution": "Fixed in:\n* [**9.0.6**](https://www.drupal.org/project/drupal/releases/9.0.6) by [this](https://git.drupalcode.org/project/drupal/-/commit/5411b01fdd9da2085cf174861b421b72d3e330b3) commit,\n* [**8.9.6**](https://www.drupal.org/project/drupal/releases/8.9.6) by [this](https://git.drupalcode.org/project/drupal/-/commit/509723e7aff95a0efff6bd6d6ef879fd57ebf8a4) commit,\n* [**8.8.10**](https://www.drupal.org/project/drupal/releases/8.8.10) by [this](https://git.drupalcode.org/project/drupal/-/commit/70ea77338d1634cd82bef68d425ef7ddf6fe10aa) commit.\n\nThe latest stable releases are available [here](https://www.drupal.org/project/drupal/releases).\n\nThe vendor has noted [here](https://www.drupal.org/sa-core-2020-008) that:\nOnce a site running Workspaces is upgraded, authenticated users may continue to see unauthorized workspace content that they accessed previously until they are logged out.\n\nIf it is important for the unintended access to stop immediately, you may wish to end all active user sessions on your site (for example, by truncating the sessions table). Be aware that this will immediately log all users out and can cause side effects like lost user input.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrei Mateescu",
    "workaround": "",
    "vendorFixDate": "2020-09-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2413",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13667",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2413/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.drupalcode.org/project/drupal/-/commit/509723e7aff95a0efff6bd6d6ef879fd57ebf8a4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.drupalcode.org/project/drupal/-/commit/5411b01fdd9da2085cf174861b421b72d3e330b3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.drupalcode.org/project/drupal/-/commit/70ea77338d1634cd82bef68d425ef7ddf6fe10aa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/drupal/releases/8.8.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/drupal/releases/8.9.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/drupal/releases/9.0.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-core-2020-008",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2413/default-remediation-status"
            }
        ]
    }
}