{
    "source": "BDSA",
    "name": "BDSA-2021-1748",
    "title": "Xen Vulnerable to Privilege Escalation, Denial-of-Service (DoS), and Information Disclosure via IOMMU Timeout Handling",
    "description": "Xen is vulnerable to privilege escalation, denial-of-service (DoS), and information disclosure via **IOMMU** timeout handling. A guest attack may be able to successfully exploit this issue. \n\n**Note:** Per the Vendor : \n\"\nOnly **x86** systems with in-use **IOMMU** hardware are vulnerable.  **x86** systems without any **IOMMU**s in use are not vulnerable.  On Arm systems **IOMMU** / **SMMU** use is not security supported. Only **x86** guests which have physical devices passed through to them can leverage the vulnerability.\n\"",
    "technicalDescription": "This issue was mitigated by ensuring that the queue ring is sized accordingly for the number of present CPU's and by removing timeout detection from all flush related code paths.",
    "publishedDate": "2021-06-11T14:19:22.474Z",
    "updatedDate": "2022-06-08T14:45:18.974Z",
    "disclosureDate": "2021-06-08T00:00:00.000Z",
    "solution": "Fixed by [this](https://xenbits.xen.org/xsa/advisory-373.html) patch set in:\n* **4.11.x** branch\n* **4.12.x** branch\n* **[4.13.4](https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.4)**\n* **[4.14.3](https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.3)**\n* **[4.15.1](https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.1)**\n* **[4.16.0-rc1](https://github.com/xen-project/xen/releases/tag/4.16.0-rc1)**",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Igor Druzhinin and Andrew Cooper of Citrix / Jan Beulich of SUSE",
    "workaround": "Per the vendor: \n\"\nNot passing through physical devices to untrusted guests will avoid the vulnerability.\n\"",
    "vendorFixDate": "2021-06-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1748",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28692",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1748/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/4.16.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-373.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-373.html",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-373.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1748/default-remediation-status"
            }
        ]
    }
}