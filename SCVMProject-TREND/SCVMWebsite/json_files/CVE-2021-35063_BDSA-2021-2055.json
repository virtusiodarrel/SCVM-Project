{
    "source": "BDSA",
    "name": "BDSA-2021-2055",
    "title": "Suricata Vulnerable to TCP Based Packet Evasion via ACK Handling",
    "description": "Suricata is vulnerable to TCP based packet evasion via ACK handling. An attacker could exploit this by sending a SYN packet with a non null ACK value which will subsequently open a TCP session to its target. This session will not have protocol discovery, TCP streaming, or application layer analysis.",
    "technicalDescription": "This issue occurs in the `StreamTcpPacket()` function of the `src/stream-tcp.c` file because TCP analysis is completely discarded for packets which don't have the ACK bit set but have a ACK value set. This is problematic as these kind of packets are legitimate for the RFC and the operating system. The consequence could be a complete evasion of the TCP stream. The packet will only appear in the flow log if one has been enabled, or as an alert on `tcp-pkt` signature if it is deemed uncommon. \n\nIt was mitigated by ensuring that packets are only discarded if they do not have the SYN flag set. This is designed to prevent the evasion while complying with the RFC which requires the ACK bit to be set once the TCP session has been established.",
    "publishedDate": "2021-07-08T15:20:45.510Z",
    "updatedDate": "2021-08-25T13:24:35.175Z",
    "disclosureDate": "2021-06-30T00:00:00.000Z",
    "solution": "Fixed in [**6.0.3**](https://github.com/OISF/suricata/releases/tag/suricata-6.0.3) by [this](https://github.com/OISF/suricata/commit/54ebee6f516f983a21d952ec6cf4292ed8ba9d8d) commit.\nFixed in [**5.0.7**](https://github.com/OISF/suricata/releases/tag/suricata-5.0.7) by [this](https://github.com/OISF/suricata/commit/f61ef79781605a5d1d75d8bf023da9552f781301) commit.\n\nThe latest stable releases are available [here](https://github.com/OISF/suricata/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-06-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2055",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-35063",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2055/ranges"
            },
            {
                "rel": "reference",
                "href": "https://forum.suricata.io/t/suricata-6-0-3-and-5-0-7-released/1489",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OISF/suricata/commit/54ebee6f516f983a21d952ec6cf4292ed8ba9d8d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OISF/suricata/commit/f61ef79781605a5d1d75d8bf023da9552f781301",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OISF/suricata/commit/fa692df37a796c3330c81988d15ef1a219afc006",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OISF/suricata/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OISF/suricata/releases/tag/suricata-5.0.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OISF/suricata/releases/tag/suricata-6.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2055/default-remediation-status"
            }
        ]
    }
}