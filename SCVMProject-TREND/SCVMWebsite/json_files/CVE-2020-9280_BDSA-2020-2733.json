{
    "source": "BDSA",
    "name": "BDSA-2020-2733",
    "title": "SilverStripe Vulnerable to Unrestricted File Upload via Forms Functionality",
    "description": "SilverStripe contains a vulnerability to unrestricted file upload due to missing validation on the upload of dangerous file types. Attackers could upload malicious files which could lead to  duplicated folders and unintended use of the default `assets/Uploads` folder.",
    "technicalDescription": "This vulnerability exists due to the `silverstripe/secureassets` module uploads folder protections. This allows files to be uploaded via forms to folders from the Silverstripe content management system (CMS) which are then placed in the default `assets/Uploads` folder. Unauthenticated attackers could exploit this by crafting malicious files via `HTTP` and the file name. The vendor addressed this by implementing a `FolderMigrationHelper` class to migrate Folder `dataobjects` to the new database format.",
    "publishedDate": "2020-10-14T12:31:27.588Z",
    "updatedDate": "2020-10-14T12:31:27.583Z",
    "disclosureDate": "2020-04-14T00:00:00.000Z",
    "solution": "Fixed in [Silverstripe Assets] version [**1.4.7**](https://github.com/silverstripe/silverstripe-assets/releases/tag/1.4.7) by [this](https://github.com/silverstripe/silverstripe-assets/commit/6779fd3c8c1c05a3db5035bf6e541c9483d161fc) commit.\nFixed in [Silverstripe Assets] version [**1.5.2**](https://github.com/silverstripe/silverstripe-assets/releases/tag/1.5.2) by [this](https://github.com/silverstripe/silverstripe-assets/commit/c4709b6c6af840ea618b36d8ffe76f1ed48a21b3) commit.\nFixed in [Silverstripe Userforms] version [**5.4.2**](https://github.com/silverstripe/silverstripe-userforms/releases/tag/5.4.2)by [this](https://github.com/silverstripe/silverstripe-userforms/commit/3bbad2044279ade5e5a5d0ae1822bafe479f8a26) commit.\nFixed in [Silverstripe Framework] version [**4.4.6**](https://github.com/silverstripe/silverstripe-framework/releases/tag/4.4.6) by [this](https://github.com/silverstripe/silverstripe-framework/commit/b269d874909cd70bb60c1a2974ea5446b43b0436) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-04-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2733",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-9280",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2733/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-assets/commit/6779fd3c8c1c05a3db5035bf6e541c9483d161fc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-assets/commit/c4709b6c6af840ea618b36d8ffe76f1ed48a21b3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-assets/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-assets/releases/tag/1.4.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-assets/releases/tag/1.5.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/commit/b269d874909cd70bb60c1a2974ea5446b43b0436",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-framework/releases/tag/4.4.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-userforms/commit/3bbad2044279ade5e5a5d0ae1822bafe479f8a26",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/silverstripe/silverstripe-userforms/releases/tag/5.4.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.silverstripe.org/download/security-releases/cve-2020-9280",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2733/default-remediation-status"
            }
        ]
    }
}