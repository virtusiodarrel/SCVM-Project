{
    "source": "BDSA",
    "name": "BDSA-2019-1174",
    "title": "Libarchive Vulnerable to Denial-of-Service (DoS) via Memory Leak in 'archive_read_format_zip_cleanup()' Function",
    "description": "Libarchive is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could exploit this vulnerability by supplying a victim with a maliciously crafted ZIP file.",
    "technicalDescription": "The function `archive_read_format_zip_cleanup()` within the file `libarchive/archive_read_support_format_zip.c` contains code that is used by Libarchive when a LZMA archive is being decoded. A portion of this code is used to free some of the memory that was allocated during the decoding process, and is intended to be called if the condition `HAVE_LZMA_H && HAVE_LIBLZMA` evaluates as true. The function `lzma_end()` is called in order to free the memory. \n\nHowever, a typo in the code causes this condition to refer to `HAVA_LZMA_H` instead of `HAVE_LZMA_H`. Consequently the function `lzma_end()` will never be called and the memory will not be deallocated. This could result in all memory available to the process being consumed, leading to an application crash. An attacker could exploit this by crafting a malicious ZIP file to be supplied to a victim. If processed, this could cause an application crash.\n\n**Note**: this vulnerability was introduced by [this](https://github.com/libarchive/libarchive/commit/121035c83e18b70d3128e9ac966109ebedb7e516) commit, after the release of **3.3.3** and prior to the release of **3.4.0**. Only snapshots of the [development branch](https://github.com/libarchive/libarchive) from **2018-12-15** to **2019-04-20** are vulnerable.",
    "publishedDate": "2019-05-07T12:37:39.466Z",
    "updatedDate": "2021-02-26T12:12:13.060Z",
    "disclosureDate": "2019-03-28T00:00:00.000Z",
    "exploitPublishDate": "2019-03-28T00:00:00.000Z",
    "solution": "Fixed in **[3.4.0](https://github.com/libarchive/libarchive/releases/tag/v3.4.0)** by [this](https://github.com/libarchive/libarchive/commit/ba641f73f3d758d9032b3f0e5597a9c6e593a505) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rohan Padhye",
    "workaround": "",
    "vendorFixDate": "2019-04-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.0,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1174",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-401"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-11463",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1174/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/commit/121035c83e18b70d3128e9ac966109ebedb7e516",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/commit/ba641f73f3d758d9032b3f0e5597a9c6e593a505",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/issues/1165",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/issues/1165",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libarchive/libarchive/releases/tag/v3.4.0",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}