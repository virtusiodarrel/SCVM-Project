{
    "source": "BDSA",
    "name": "BDSA-2018-1501",
    "title": "Linux Kernel KVM Vulnerable to Denial-of-Service and Privilege Escalation via Exception Handling",
    "description": "Linux Kernel KVM does not properly emulate the `ICEBP` instruction following a `MOV`/`POP` to `SS` instruction. A local attacker in a KVM virtual machine could use this to cause a denial of service (guest VM crash) or possibly escalate privileges inside of the virtual machine.",
    "technicalDescription": "Linux kernel's KVM hypervisor has a flaw in the way it handles exceptions delivered after a stack switch operation via` MOV SS` and `POP SS `instructions. \n\nDuring the stack switch operation, the processor does not deliver interrupts and exceptions, rather they are delivered once the first instruction after the stack switch is executed.  If this occurs in a KVM guest, KVM incorrectly thinks that a #DB instruction was caused by the undocumented ICEBP instruction.  This results in #DB being delivered to the guest kernel with an incorrect RIP on the stack. \n\nOn most guest kernels, this will allow a guest user to cause a denial-of-service (*DoS*) on the guest kernel or escalate privilege to that of the guest kernel.\n\nThis issue only affects the i386 and amd64 architectures.",
    "publishedDate": "2018-05-25T08:18:38.638Z",
    "updatedDate": "2018-10-03T07:02:17.505Z",
    "disclosureDate": "2018-05-08T00:00:00.000Z",
    "exploitPublishDate": "2018-05-08T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.18.103**](https://www.kernel.org)\n* [**4.4.125**](https://www.kernel.org)\n* [**4.9.91**](https://www.kernel.org)\n* [**4.14.31**](https://www.kernel.org)\n* [**4.15.14**](https://www.kernel.org)\n* [**4.16-rc7**](https://www.kernel.org)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=32d43cd391bacb5f0814c2624399a5dad3501d09) git commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.4,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andy Lutomirski",
    "workaround": "",
    "vendorFixDate": "2018-03-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-1501",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-755"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2018-1087",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-1501/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.openwall.com/lists/oss-security/2018/05/08/5",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=32d43cd391bacb5f0814c2624399a5dad3501d09",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://marc.info/?l=linux-kernel&m=152580052406931",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-1501/default-remediation-status"
            }
        ]
    }
}