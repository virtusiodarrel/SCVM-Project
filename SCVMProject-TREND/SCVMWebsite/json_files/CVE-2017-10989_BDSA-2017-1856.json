{
    "source": "BDSA",
    "name": "BDSA-2017-1856",
    "title": "SQLite3 Heap-Based Buffer Overflow in nodeAquire",
    "description": "A heap-based buffer overflow exists in SQLite3.  This can result in a denial-of-service condition when processing a malformed SQLite3 database.",
    "technicalDescription": "This vulnerability was [originally discovered](https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2405) by OSS-Fuzz when fuzzing the GDAL library which uses libsqlite3.  The vulnerability exists in the `getNodeSize()` function of `ext/rtree/rtree.c` in SQLite.  Richard Hipp of the SQLite3 stated that as of SQLite **3.17.0** the issue becomes hidden due to refactoring of the code around RTree.   Canonical [report](https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-10989.html) that the vulnerability exists in versions prior to **3.19.3-3**, which is backed up by [this Debian bug report](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=867618).\n\nResearch has shown that in past instances vulnerabilities such as this have eventually been exploited by attackers to gain remote code execution or privilege escalation. Development of such an exploit is often a lengthy process, and these exploits are often highly prized. While there is currently no evidence to suggest that a remote code execution exploit exists for this particular vulnerability, we cannot guarantee that one will not be developed in the future.",
    "publishedDate": "2017-11-16T16:45:17.162Z",
    "updatedDate": "2017-11-16T16:45:17.156Z",
    "disclosureDate": "2017-07-06T00:00:00.000Z",
    "solution": "Fixed in SQLite [3.19.3-3](https://www.sqlite.org/src/info/0ee482a1e0eae22e).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "OSS-Fuzz",
    "workaround": "",
    "vendorFixDate": "2017-07-01T00:00:00.000Z",
    "vendorNotifiedDate": "2017-06-28T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1856",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-10989",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1856/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2405",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=867618",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/ubuntu/+source/sqlite3/+bug/1700937",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-10989.html",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/src/info/0ee482a1e0eae22e",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}