{
    "source": "BDSA",
    "name": "BDSA-2020-1386",
    "title": "Spring Batch Vulnerable to Remote Code Execution (RCE) via Deserialization of Untrusted Data",
    "description": "Spring Batch contains a remote code execution (RCE) vulnerability due to unsafe deserialization of Java Objects. An attacker with write access to the data store used by the `JobRepository` could exploit this issue by supplying specially crafted input that could execute malicious code against the system.\n\nThis issue is a result of the implementation of Jackson-databind in Spring Batch which allows for the deserialization vulnerability in Jackson-databind to impact Spring batch. The Jackson-databind vulnerability is outlined in BDSA-2017-0836.",
    "technicalDescription": "The functionality in `spring-batch-core/src/main/java/org/springframework/batch/core/repository/dao/Jackson2ExecutionContextStringSerializer.java` does not ensure untrusted data is sufficiently validated to prevent arbitrary code execution. Spring Batch uses global default typing configuration of Jackson without sufficient validation in place to prevent the deserialization vulnerability in Jackson outlined in BDSA-2017-0836. \n\nThis issue occurs when Spring Batch uses Jackson to serialize a job's `ExecutionContext` and when an attacker can manipulate the data in the `JobRepository`.",
    "publishedDate": "2020-06-11T14:15:12.370Z",
    "updatedDate": "2021-09-08T11:57:27.127Z",
    "disclosureDate": "2020-06-10T00:00:00.000Z",
    "solution": "Fixed in **[4.2.3](https://github.com/spring-projects/spring-batch/releases/tag/4.2.3.RELEASE)** by [this](https://github.com/spring-projects/spring-batch/commit/6d7d2927d) commit.\n\nThe latest stable releases are available [here](https://github.com/spring-projects/spring-batch).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Srikanth Ramu",
    "workaround": "",
    "vendorFixDate": "2020-06-10T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1386",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5411",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1386/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-docs/wiki/JacksonPolymorphicDeserialization#11-global-default-typing",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-batch",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-batch/commit/6d7d2927d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-batch/issues/3729",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-batch/releases/tag/4.2.3.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://pivotal.io/security/cve-2020-5411",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1386/default-remediation-status"
            }
        ]
    }
}