{
    "source": "BDSA",
    "name": "BDSA-2018-5221",
    "title": "Libgcrypt Vulnerable to Sensitive Information Disclosure via Improper Implementation of ElGamal Encryption Algorithm",
    "description": "Libgcrypt is vulnerable to sensitive information disclosure. An attacker can take advantage of this by gaining access to the plaintext of data which has been improperly encrypted.",
    "technicalDescription": "This vulnerability exists due to an improper implementation of the ElGamal cryptographic algorithm in `libgcrypt/cipher/elgamal.c`.\n\nOnce data is encrypted with ElGamal, the resulting ciphertext should reveal no information about the original message. Such an encryption scheme should provide message indistinguishability, however this is not the case in Libgcrypt due to an improper implementation of the scheme.\n\nThe Libgcrypt implementation of ElGamal is not secure, and any data encrypted with this algorithm can be discovered by using a ciphertext-only attack. An attacker can take advantage of this to infer more information about messages sent and gain access to sensitive plaintext data.\n\nThis issue was mitigated by the addition of exponent blinding in `cipher/elgamal.c`.",
    "publishedDate": "2021-02-03T16:23:11.990Z",
    "updatedDate": "2021-09-17T09:17:51.060Z",
    "disclosureDate": "2018-02-07T00:00:00.000Z",
    "exploitPublishDate": "2018-02-08T00:00:00.000Z",
    "solution": "Fixed in [**1.9.3**](https://github.com/gpg/libgcrypt/releases/tag/libgcrypt-1.9.3) by [this](https://github.com/gpg/libgcrypt/commit/e8b7f10be275bcedb5fc05ed4837a89bfd605c61) commit.\n\nThe latest stable releases are available [here](https://github.com/gpg/libgcrypt/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Weikeng Chen, Erik-Oliver Blass",
    "workaround": "A third party workaround has been suggested that user only use ElGamal for hybrid encryption.",
    "vendorFixDate": "2021-04-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-5221",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-326"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-327"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-6829",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-5221/ranges"
            },
            {
                "rel": "reference",
                "href": "http://link-to-the-commit.com",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://link-to-the-new-version.com",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gpg/libgcrypt/commit/e8b7f10be275bcedb5fc05ed4837a89bfd605c61",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gpg/libgcrypt/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gpg/libgcrypt/releases/tag/libgcrypt-1.9.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/weikengchen/attack-on-libgcrypt-elgamal",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/weikengchen/attack-on-libgcrypt-elgamal/wiki/Attack-on-libgcrypt's-ElGamal-Encryption-with-Proof-of-Concept-(PoC)",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.gnupg.org/pipermail/gcrypt-devel/2018-February/004394.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.gnupg.org/pipermail/gcrypt-devel/2018-February/004394.html",
                "label": "WORKAROUND"
            }
        ]
    }
}