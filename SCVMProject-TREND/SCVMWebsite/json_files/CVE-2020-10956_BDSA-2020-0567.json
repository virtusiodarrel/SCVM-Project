{
    "source": "BDSA",
    "name": "BDSA-2020-0567",
    "title": "Gitlab Vulnerable to Server-Side Request Forgery (SSRF) via Project Import Note Feature",
    "description": "GitLab CE is vulnerable to server-side request forgery (SSRF) due to insufficient validation of user-controlled input in the project import note feature. An attacker could exploit this vulnerability by accessing internal resources that should not be available outside the network.",
    "technicalDescription": "When adding a note for a project issue it is possible to set an attached file URL via `remote_attachment_url` setting in `project.json` file. This setting is not sanitized during project imports, meaning that the file will be downloaded from any host on behalf of the server. The downloaded file is then included next to the note and can be viewed by everyone authenticated to view the issue. This could be abused by attackers to query locally available endpoints for the server and thus view resources that are normally forbidden outside the network.",
    "publishedDate": "2020-03-30T12:50:43.052Z",
    "updatedDate": "2020-06-29T15:38:48.731Z",
    "disclosureDate": "2020-03-26T00:00:00.000Z",
    "exploitPublishDate": "2020-06-07T00:00:00.000Z",
    "solution": "Fixed in [**12.9.1**](https://github.com/gitlabhq/gitlabhq/releases/tag/v12.9.1) by [this](https://github.com/gitlabhq/gitlabhq/commit/cc6190d962e3050b0b16b6d0958d9227187d93ce) commit.\n\nThe fix was cherry-picked and backported into [**12.8.8**](https://github.com/gitlabhq/gitlabhq/releases/tag/v12.8.8) and [**12.7.8**](https://github.com/gitlabhq/gitlabhq/releases/tag/v12.7.8).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "William Bowling",
    "workaround": "",
    "vendorFixDate": "2020-03-26T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0567",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10956",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0567/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2020/03/26/security-release-12-dot-9-dot-1-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gitlabhq/gitlabhq/commit/cc6190d962e3050b0b16b6d0958d9227187d93ce",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gitlabhq/gitlabhq/releases/tag/v12.7.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gitlabhq/gitlabhq/releases/tag/v12.8.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gitlabhq/gitlabhq/releases/tag/v12.9.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/212089",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/212089",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/826361",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0567/default-remediation-status"
            }
        ]
    }
}