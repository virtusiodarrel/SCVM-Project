{
    "source": "BDSA",
    "name": "BDSA-2019-4221",
    "title": "Pure-FTPd Vulnerable to Denial-of-Service (DoS) via Stack Exhaustion in 'ls.c'",
    "description": "Pure-FTPd is vulnerable  to denial-of-service (DoS) due to insufficient handling of buffer creation. An attacker could exploit this by supplying a specially crafter request which could abort a users session or cause an application to behave unexpectedly leading to a denial-of-service (DoS) condition.",
    "technicalDescription": "The `listdir` function in `src/ls.c` creates a new buffer on the stack for every filename that needs to be displayed. There are no checks on the number of buffers that have been created or how much space they take up on the stack. An attacker could abuse this functionality by ensuring there are more filename entries to be displayed than space on the stack for each buffer that gets created per filename. When the attacker makes the relevant request that calls the `listdir` function stack exhaustion could occur and this could lead to unexpected behavior from the application, including aborting a users session, therefore causing DoS.",
    "publishedDate": "2020-02-06T17:50:04.391Z",
    "updatedDate": "2021-07-19T14:18:40.622Z",
    "disclosureDate": "2019-12-30T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/jedisct1/pure-ftpd/commit/aea56f4bcb9948d456f3fae4d044fd3fa2e19706) commit in the **master** branch which is not yet included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Antonio Morales",
    "workaround": "",
    "vendorFixDate": "2019-12-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4221",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20176",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4221/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jedisct1/pure-ftpd/commit/aea56f4bcb9948d456f3fae4d044fd3fa2e19706",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jedisct1/pure-ftpd/commit/aea56f4bcb9948d456f3fae4d044fd3fa2e19706",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4221/default-remediation-status"
            }
        ]
    }
}