{
    "source": "BDSA",
    "name": "BDSA-2021-0160",
    "title": "Revive Adserver Vulnerable to Stored Cross-Site Scripting (XSS) via 'affiliate-preview.php'",
    "description": "Revive Adserver is vulnerable to stored cross-site scripting (XSS) due to a lack of sanitization of user-supplied input. An authenticated attacker with manager credentials could exploit this flaw to execute malicious scripts in the context of the browser, allowing the theft of cookies, and other sensitive information.",
    "technicalDescription": "This issue was found in the `selectElement()` function within the file `oxInvocationTags/spc.class.php`. It was mitigated by regeneration of the associated plugins and by the addition of HTML escaping. \n\nAs this issue requires manager credentials to exploit it is likely that the targeted users would also be those with access to managerial resources. In addition the session cookie in accessible via JavaScript.",
    "publishedDate": "2021-01-21T11:32:42.104Z",
    "updatedDate": "2021-01-21T11:32:42.098Z",
    "disclosureDate": "2021-01-19T00:00:00.000Z",
    "exploitPublishDate": "2021-01-20T00:00:00.000Z",
    "solution": "Fixed in [**5.1.0**](https://github.com/revive-adserver/revive-adserver/releases/tag/v5.1.0) by [this](https://github.com/revive-adserver/revive-adserver/commit/89b88ce26) commit and [this](https://github.com/revive-adserver/revive-adserver/commit/62a2a0439) commit.\n\nThe latest stable releases are available [here](https://github.com/revive-adserver/revive-adserver/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 1.7,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Keyur Vala (keyurvala)",
    "workaround": "",
    "vendorFixDate": "2021-01-19T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0160",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22871",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0160/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/revive-adserver/revive-adserver/commit/62a2a0439",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/revive-adserver/revive-adserver/commit/89b88ce26",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/revive-adserver/revive-adserver/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/revive-adserver/revive-adserver/releases/tag/v5.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/819362",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/819362",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.revive-adserver.com/security/revive-sa-2021-001/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0160/default-remediation-status"
            }
        ]
    }
}