{
    "source": "BDSA",
    "name": "BDSA-2019-3642",
    "title": "Symfony Vulnerable to Code Injection via Serialization of Cache Adapter Interfaces",
    "description": "Unsafe serialization and unserialization of cache adapters in Symfony can lead to the execution of malicious code. \n\nA remote attacker can supply specially crafted executables which will be called during the process of serialization, causing arbitrary code to execute on the vulnerable application.",
    "technicalDescription": "Symfony Cache component  is vulnerable to arbitrary code execution during serialization of data in `AbstractAdapter` and `TagAwareAdapter` instances. \nWhen an instance of `TagAwareAdapter`  is created through the deserialization of externally-provided data,  malicious executables can be stored as properties of the tag, then triggered when the tag is invalidated.",
    "publishedDate": "2019-11-25T14:07:29.914Z",
    "updatedDate": "2020-06-12T10:02:54.616Z",
    "disclosureDate": "2019-11-13T00:00:00.000Z",
    "exploitPublishDate": "2020-02-18T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/symfony/symfony/commit/8817d28fcaacb31fe01d267f6e19b44d8179395a) commit in:\n* **[v 3.4.35](https://github.com/symfony/symfony/releases/tag/v3.4.35)**\n* **[v 4.2.12](https://github.com/symfony/symfony/releases/tag/v4.2.12)**\n* [**v 4.3.8**](https://github.com/symfony/symfony/releases/tag/v4.3.8)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "wisdomtree",
    "workaround": "",
    "vendorFixDate": "2019-11-11T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3642",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-18889",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3642/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/alex700/phar_deserialization/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/commit/8817d28fcaacb31fe01d267f6e19b44d8179395a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases/tag/v3.4.35",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases/tag/v4.2.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases/tag/v4.3.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://symfony.com/blog/cve-2019-18889-forbid-serializing-abstractadapter-and-tagawareadapter-instances",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://symfony.com/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3642/default-remediation-status"
            }
        ]
    }
}