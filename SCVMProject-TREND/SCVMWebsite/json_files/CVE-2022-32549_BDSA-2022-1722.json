{
    "source": "BDSA",
    "name": "BDSA-2022-1722",
    "title": "Apache Sling API and Commons Log Vulnerable to Log Corruption via '\\r' and 'n' Character Abuse",
    "description": "Apache Sling Commons Log and Apache Sling API contain an issue which permits injection of fake log messages and corrupt log files. This could be exploited by attackers to hide malicious activity.",
    "technicalDescription": "The core cause of the vulnerability is missing `\\r` and `\\n` character escaping by the `LogConfig` class. These characters could be abused in both regular, and exception log messages in order to corrupt the log. In Apache Sling Commons Log this issue was fixed by creating a `MaskingMessageUtil` class (`src/main/java/org/apache/sling/commons/log/logback/internal/MaskingMessageUtil.java`) that properly masks the log configurations.",
    "publishedDate": "2022-06-23T13:17:07.602Z",
    "updatedDate": "2022-08-23T10:46:06.945Z",
    "disclosureDate": "2022-06-22T00:00:00.000Z",
    "solution": "Fixed in Apache Sling Commons Log [**5.4.2**](https://github.com/apache/sling-org-apache-sling-commons-log/releases/tag/org.apache.sling.commons.log-5.4.2) by [this](https://github.com/apache/sling-org-apache-sling-commons-log/commit/6b1e8372cc0ecfc4bec8b8749dc317533aeb2b2f) commit.\n\nFixed in Apache Sling API [**2.25.4**](https://github.com/apache/sling-org-apache-sling-api/releases/tag/org.apache.sling.api-2.25.4).\n\nThe latest stable releases can be found [here](https://sling.apache.org/downloads.cgi).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Alex Collignon",
    "workaround": "",
    "vendorFixDate": "2022-06-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1722",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-32549",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1722/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/sling-org-apache-sling-api/releases/tag/org.apache.sling.api-2.25.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/sling-org-apache-sling-commons-log/commit/6b1e8372cc0ecfc4bec8b8749dc317533aeb2b2f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/sling-org-apache-sling-commons-log/releases/tag/org.apache.sling.commons.log-5.4.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2022/q2/206",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sling.apache.org/downloads.cgi",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1722/default-remediation-status"
            }
        ]
    }
}