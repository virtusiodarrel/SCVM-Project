{
    "source": "BDSA",
    "name": "BDSA-2020-2697",
    "title": "osTicket Vulnerable to Reflected Cross-Site Scripting (XSS) via 'Knowledgebase' Function",
    "description": "osTicket contains a reflected cross-site scripting (XSS) vulnerability due to a lack of user input validation. A remote attacker could execute arbitrary code in the victim's browser which could be used to steal cookie-based session information or other credentials.",
    "technicalDescription": "The first part of this vulnerability occurs due to insufficient sanitization in the `description` and  `notes` parameters in the `include/staff/category.inc.php` file. The second part occurs due to an issue in a 3rd party editor 'Imperavi'. The payload executes immediately after pasting into the editor. An attacker with agent privileges could exploit this flaw to inject malicious scripts which will be reflected back to the victims browser, redirecting the victim to web content controlled by the attacker, or allow site actions to be performed.\n\nThis issue was addressed by sanitizing the return values on errors and by upgrading the 3rd party redactor to the latest version.",
    "publishedDate": "2020-10-09T09:52:28.661Z",
    "updatedDate": "2020-10-09T09:52:28.650Z",
    "disclosureDate": "2020-05-21T00:00:00.000Z",
    "exploitPublishDate": "2020-05-21T00:00:00.000Z",
    "solution": "Fixed in [**1.14.3**](https://github.com/osTicket/osTicket/releases/tag/v1.14.3) by [this](https://github.com/osTicket/osTicket/commit/292e7ddf7787300c2f686650e36fbc357d6fb527) commit and [this](https://github.com/osTicket/osTicket/commit/d8868112f876832e6ddaa704a009cb0dfa5cfa4b) commit.\n\n\nThe latest stable releases are available [here](https://github.com/osTicket/osTicket/tags)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "tranvannam186",
    "workaround": "",
    "vendorFixDate": "2020-05-21T00:00:00.000Z",
    "vendorNotifiedDate": "2020-05-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2697",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14012",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2697/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/commit/292e7ddf7787300c2f686650e36fbc357d6fb527",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/commit/d8868112f876832e6ddaa704a009cb0dfa5cfa4b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/issues/5514",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/issues/5514",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/releases/tag/v1.14.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2697/default-remediation-status"
            }
        ]
    }
}