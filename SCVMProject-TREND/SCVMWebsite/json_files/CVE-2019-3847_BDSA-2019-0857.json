{
    "source": "BDSA",
    "name": "BDSA-2019-0857",
    "title": "Moodle Vulnerable to Stored Cross-Site Scripting (XSS) via \"Login-as\" Functionality",
    "description": "Moodle is vulnerable to stored cross-site scripting (XSS) due to improper validation of user-added JavaScript when viewing dashboards using the \"login-as\" functionality. This could allow an attacker to inject arbitrary web scripts and steal a user's session cookies.",
    "technicalDescription": "Moodle allows high-privileged users (such as administrators and managers) to log in as another user and access their Dashboard. However, when this is performed Moodle does not sanitize any JavaScript included on the user's Dashboard before being viewed by the \"login-as\" user. An attacker could exploit this by including maliciously crafted JavaScript on their Dashboard and tricking a high-privileged user into logging in as them to view their Dashboard. This could result in included web scripts being executed on the victim's system.",
    "publishedDate": "2019-03-28T16:35:14.616Z",
    "updatedDate": "2019-03-28T16:35:14.601Z",
    "disclosureDate": "2019-03-19T00:00:00.000Z",
    "solution": "Fixed in:\n* **[3.6.3](https://github.com/moodle/moodle/releases/tag/v3.6.3)** by [this](https://github.com/moodle/moodle/commit/a37e26d2efe1ca0e4d8d69c611a748af35b33674) commit,\n* **[3.5.5](https://github.com/moodle/moodle/releases/tag/v3.5.5)** by [this](https://github.com/moodle/moodle/commit/070f24d006eab6b958eb083530de159b43c538ed) commit,\n* **[3.4.8](https://github.com/moodle/moodle/releases/tag/v3.4.8)** by [this](https://github.com/moodle/moodle/commit/e836242e1c04cd62d0afa4a790074fd245628e7a) commit,\n* **[3.1.17](https://github.com/moodle/moodle/releases/tag/v3.1.17)** by [this](https://github.com/moodle/moodle/commit/ec3b63c772d6448765c68268234cf36c1a91bcac) commit.\n\nThe latest stable releases are available [here](https://download.moodle.org/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Daniel Thatcher",
    "workaround": "",
    "vendorFixDate": "2019-03-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0857",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3847",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0857/ranges"
            },
            {
                "rel": "reference",
                "href": "https://download.moodle.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/070f24d006eab6b958eb083530de159b43c538ed",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/a37e26d2efe1ca0e4d8d69c611a748af35b33674",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/e836242e1c04cd62d0afa4a790074fd245628e7a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/ec3b63c772d6448765c68268234cf36c1a91bcac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.1.17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.4.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.5.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.6.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=384010#p1547742",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0857/default-remediation-status"
            }
        ]
    }
}