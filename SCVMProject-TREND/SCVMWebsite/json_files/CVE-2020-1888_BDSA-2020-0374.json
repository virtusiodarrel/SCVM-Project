{
    "source": "BDSA",
    "name": "BDSA-2020-0374",
    "title": "HHVM Vulnerable to Denial-of-service (DoS) via Out-of-Bounds Read in 'handleBackslash'",
    "description": "HHVM is vulnerable to a denial-of-service (DoS) condition.  This allows an attacker that is able to supply HHVM with crafted JSON data to cause the virtual machine to crash due to memory corruption.  It may also be possible to use this vulnerability to leak data from memory.",
    "technicalDescription": "The DoS is due to a OOB read in the `handleBackslash` function in `hphp/runtime/ext/json/JSON_parser.cpp` when attempting to decode JSON data.  \n\nThe vulnerability can occur when crafted JSON data containing unicode characters is parsed.  A pointer is incorrectly allocated to out-of-bounds memory due to the `handleBackslash` unicode case reading 4 chars before checking the Cstring.  Any one of the 4 chars that are being read can be the end of the Cstring.  This means only a maximim of 3 bytes could be read from memory.  This can result in a DoS or be used to read arbitrary memory.",
    "publishedDate": "2020-03-05T17:10:20.538Z",
    "updatedDate": "2020-03-05T17:10:20.523Z",
    "disclosureDate": "2020-02-20T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/facebook/hhvm/commit/b3679121bb3c7017ff04b4c08402ffff5cf59b13) commit in versions:\n\n* [4.8.7](https://github.com/facebook/hhvm/releases/tag/HHVM-4.8.7)\n* [4.32.1](https://github.com/facebook/hhvm/releases/tag/HHVM-4.32.1)\n* [4.38.1](https://github.com/facebook/hhvm/releases/tag/HHVM-4.38.1)\n* [4.39.1](https://github.com/facebook/hhvm/releases/tag/HHVM-4.39.1)\n* [4.40.1](https://github.com/facebook/hhvm/releases/tag/HHVM-4.40.1)\n* [4.41.1](https://github.com/facebook/hhvm/releases/tag/HHVM-4.41.1)\n* [4.42.1](https://github.com/facebook/hhvm/releases/tag/HHVM-4.42.1)\n* [4.43.1](https://github.com/facebook/hhvm/releases/tag/HHVM-4.43.1)\n* [4.44.1](https://github.com/facebook/hhvm/releases/tag/HHVM-4.44.1)\n* [4.45.1](https://github.com/facebook/hhvm/releases/tag/HHVM-4.45.1)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.5
        },
        "vector": "(AV:A/AC:L/Au:N/C:P/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-02-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0374",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-1888",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0374/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/hhvm/commit/b3679121bb3c7017ff04b4c08402ffff5cf59b13",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/hhvm/releases/tag/HHVM-4.32.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/hhvm/releases/tag/HHVM-4.38.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/hhvm/releases/tag/HHVM-4.39.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/hhvm/releases/tag/HHVM-4.40.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/hhvm/releases/tag/HHVM-4.41.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/hhvm/releases/tag/HHVM-4.42.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/hhvm/releases/tag/HHVM-4.43.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/hhvm/releases/tag/HHVM-4.44.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/hhvm/releases/tag/HHVM-4.45.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/facebook/hhvm/releases/tag/HHVM-4.8.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hhvm.com/blog/2020/02/20/security-update.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0374/default-remediation-status"
            }
        ]
    }
}