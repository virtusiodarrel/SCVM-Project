{
    "source": "BDSA",
    "name": "BDSA-2019-5118",
    "title": "Unbound Vulnerable to Configuration Injection via 'create_unbound_ad_servers.sh' File due to Improper Input Sanitization",
    "description": "Unbound allows attackers to modify the application configuration via the `create_unbound_ad_servers.sh` file using a man-in-the-middle attack. This could enable attackers to pass malicious statements to the main configuration file.",
    "technicalDescription": "This vulnerability primarily exists in the `contrib/create_unbound_ad_servers.sh` file. This file does not sanitize the contents received from the input before they are used to update the `unbound.conf` file. As the input to `create_unbound_ad_servers.sh` is retrieved using a cleartext HTTP connection, an attacker could use a man-in-the-middle attack to modify the contents of the main application configuration file. This issue was addressed by adding the appropriate input sanitization measures to filter out special characters. Also, the affected URL address was moved to HTTPS in order to encrypt the incoming network traffic.",
    "publishedDate": "2021-04-27T15:26:32.248Z",
    "updatedDate": "2021-11-30T15:07:24.481Z",
    "disclosureDate": "2019-12-11T00:00:00.000Z",
    "solution": "Fixed in [**1.9.6rc1**](https://github.com/NLnetLabs/unbound/releases/tag/release-1.9.6rc1) by [this](https://github.com/NLnetLabs/unbound/commit/f887552763477a606a9608b0f6b498685e0f6587) commit.\n\nThe latest stable releases are available [here](https://github.com/NLnetLabs/unbound/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "X41 D-Sec",
    "workaround": "",
    "vendorFixDate": "2019-11-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5118",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-25031",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5118/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NLnetLabs/unbound/commit/f887552763477a606a9608b0f6b498685e0f6587",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NLnetLabs/unbound/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NLnetLabs/unbound/releases/tag/release-1.9.6rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ostif.org/our-audit-of-unbound-dns-by-x41-d-sec-full-results/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5118/default-remediation-status"
            }
        ]
    }
}