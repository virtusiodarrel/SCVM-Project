{
    "source": "BDSA",
    "name": "BDSA-2020-2832",
    "title": "Okular Vulnerable to Arbitrary Code Execution via Arbitrary File Upload in  'document.cpp'",
    "description": "Okular contains an arbitrary code execution vulnerability because of improper restriction measures. An attacker could exploit this flaw to execute malicious code on the server.",
    "technicalDescription": "This vulnerability exists in `core/document.cpp`. When dealing with PDF files, the `Document::processAction()` function usually creates a new instance of the `KRun` object to open and execute other linked files. These linked files are usually relevant to the `realUrl` parameter of the `KRun` object constructor. However, there is no restriction on the kind of files being executed here. This could allow an attacker to craft a malicious PDF which contains a URL pointing to a malicious binary executable. The attacker can then entice a victim to open this crafted PDF, which will then result in arbitrary code execution on the server. \n\n**Note** The application is usually run by non-privileged users and it has been determined that a major impact will only be possible if the server has already been compromised because of some other independent vulnerability. Because of this, the impact of this vulnerability has been classified as low.",
    "publishedDate": "2020-10-19T15:25:06.938Z",
    "updatedDate": "2020-10-26T11:51:05.641Z",
    "disclosureDate": "2020-03-12T00:00:00.000Z",
    "exploitPublishDate": "2020-03-24T00:00:00.000Z",
    "solution": "Fixed in [**20.03.80**](https://github.com/KDE/okular/releases/tag/v20.03.80) by [this](https://github.com/KDE/okular/commit/6a93a033b4f9248b3cd4d04689b8391df754e244) commit.\n\nThe latest stable releases are available [here](https://github.com/KDE/okular/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mickael Karatekin",
    "workaround": "",
    "vendorFixDate": "2020-03-10T00:00:00.000Z",
    "discoveryDate": "2020-02-20T00:00:00.000Z",
    "vendorNotifiedDate": "2020-02-28T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2832",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-184"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-9359",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2832/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/cve-2020-9359",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1815651",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/KDE/okular/commit/6a93a033b4f9248b3cd4d04689b8391df754e244",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/KDE/okular/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/KDE/okular/releases/tag/v20.03.80",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://invent.kde.org/graphics/okular/-/merge_requests/137",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://kde.org/info/security/advisory-20200312-1.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.debian.org/debian-lts-announce/2020/03/msg00033.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2TY3O6UWX2XTP7PISPTZ6FYRDFU4UF66/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/158615/glsa-202007-47.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://security.gentoo.org/glsa/202007-47",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sysdream.com/news/lab/2020-03-24-cve-2020-9359-okular-command-execution/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sysdream.com/news/lab/2020-03-24-cve-2020-9359-okular-command-execution/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2832/default-remediation-status"
            }
        ]
    }
}