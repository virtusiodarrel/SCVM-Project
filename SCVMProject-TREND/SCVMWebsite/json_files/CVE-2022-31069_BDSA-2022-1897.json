{
    "source": "BDSA",
    "name": "BDSA-2022-1897",
    "title": "NestJS Proxy Vulnerable to Information Disclosure via Authorization Header Forwarding",
    "description": "NestJS Proxy is vulnerable to information disclosure as there is no way of controlling whether authorization header forwarding can be disabled or not. This could result in sensitive information being released to unauthorized resources and services.",
    "technicalDescription": "This vulnerability exists due to a lack of control on authorization header forwarding which could allow sensitive information such as Oauth tokens to be exposed to unwanted actors.\n\nTo mitigate this issue, an option has been introduced to opt-out of the token forwarding service and users are advised to read the README for this library on Github or NPM on how to enable/disable this feature. \n\nA `forwardToken` configuration setting has been introduced in `libs/proxy/src/interfaces/proxy.interface.ts`.  A check is then performed in `libs/proxy/src/services/proxy.service.ts` to see if `forwardToken` is enabled and if not, sensitive information will not be released.",
    "publishedDate": "2022-07-08T15:49:34.908Z",
    "updatedDate": "2022-07-13T08:02:36.527Z",
    "disclosureDate": "2022-06-15T00:00:00.000Z",
    "solution": "Fixed in version [**0.7.0**](https://github.com/Finastra/finastra-nodejs-libs/releases/tag/proxy-0.7.0) by [this](https://github.com/Finastra/finastra-nodejs-libs/commit/f27df7a553e11265e01277fcaf83350c73fa8b60) commit.\n\nThe latest stable releases can be found [here](https://github.com/Finastra/finastra-nodejs-libs/tags).\n\n**Note**: The vendor has highlighted in their [advisory](https://github.com/Finastra/finastra-nodejs-libs/security/advisories/GHSA-j562-c3cw-3p5g) that `@ffdc/nestjs-proxy` has been deprecated and is no longer being maintained or receiving updates and suggests that users update the `package.json` file to use `@finastra/nestjs-proxy` instead.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-05-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1897",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31069",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1897/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Finastra/finastra-nodejs-libs/commit/f27df7a553e11265e01277fcaf83350c73fa8b60",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Finastra/finastra-nodejs-libs/releases/tag/proxy-0.7.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Finastra/finastra-nodejs-libs/security/advisories/GHSA-j562-c3cw-3p5g",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Finastra/finastra-nodejs-libs/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1897/default-remediation-status"
            }
        ]
    }
}