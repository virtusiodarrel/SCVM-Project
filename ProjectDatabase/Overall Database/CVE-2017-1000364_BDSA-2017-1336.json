{
    "source": "BDSA",
    "name": "BDSA-2017-1336",
    "title": "Linux Kernel Stack Pointer aka Stack Clash Vulnerability Leads to Privilege Escalation and Corrupt Memory",
    "description": "The Linux Kernel contains a Stack Clash vulnerability related to the handling of memory allocation. A local user could exploit this vulnerability to execute arbitrary code or to corrupt memory. This vulnerability can also be exploited to obtain full root privileges.",
    "technicalDescription": "A flaw related to memory allocation for user space binaries within the stack allows an attacker to jump over the stack guard cap. This results in memory corruption on the process stack and increases the user's privileges. The heap and stack memory must be adjacent to each other to exploit successfully. \n\nExample:\n\n1. Clash the stack with another memory region by allocating memory until the start of the stack reaches the end of another memory region or vice versa.\n2. Run the stack-pointer to the start of the stack and consume the unused stack memory that separates the stack-pointer from the start of the stack.\n3. Jump over the stack guard-page into the other memory region.\n4. Smash the stack, or alternative memory region.\n\nAn example proof of concept can be found in the references section.",
    "publishedDate": "2018-01-31T12:05:13.578Z",
    "updatedDate": "2018-01-31T12:06:11.691Z",
    "disclosureDate": "2017-06-19T00:00:00.000Z",
    "exploitPublishDate": "2017-06-19T00:00:00.000Z",
    "solution": "Fixed in [this](https://github.com/torvalds/linux/commit/1be7107fbe18eed3e319a6c3e83c78254b693acb) commit.\n\n\nThe commit has been included in the following versions, available from [here](https://www.kernel.org/):\n\n* **3.2.90**, \n* **3.10.107**, \n* **3.16.45**, \n* **3.18.58**, \n* **4.1.42**, \n* **4.4.74**, \n* **4.9.34**, \n* **4.11.7**, \n* **4.12-rc6**, \n* **4.13-rc1**, \n* **4.14-rc1**, \n* **4.15-rc1**.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.6,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 2.7,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:L/AC:M/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Qualys Research Labs",
    "workaround": "An unofficial workaround is to set the values of `RLIMIT_STACK` and `RLIMIT_AS` to low values for all local users and remote services. \n\nNote: This workaround does not fix every issue related to the vulnerability and other forms of the attack may be possible.",
    "vendorFixDate": "2017-06-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1336",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-119"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-1000364",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1336/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/torvalds/linux/commit/1be7107fbe18eed3e319a6c3e83c78254b693acb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.qualys.com/research/security-advisories/?_ga=2.80872919.1301314393.1506517626-539344174.1506517626",
                "label": "POC"
            }
        ]
    }
}