{
    "source": "BDSA",
    "name": "BDSA-2018-2556",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) via 'btrfs' Image NULL Pointer Dereference",
    "description": "In Linux kernel, there is an NULL pointer dereference when mounting a crafted `btrfs` image where the crafted image has an empty root tree block. An attacker could leverage this flaw to crash the application by supplying a crafted `btrfs` image file to the kernel.",
    "technicalDescription": "This vulnerability exists in the `btrfs_root_node()` function in the `fs/btrfs/tree-checker.c` and `fs/btrfs/extent-tree.c` source files. There is a lack of chunk block group mapping validation in `btrfs_read_block_groups` in `fs/btrfs/extent-tree.c`, and a lack of empty-tree checks in the function`check_leaf` within the `fs/btrfs/tree-checker.c`file. There is no check to ensure each chunk has its corresponding block group.\n\nThe following trees should never be empty: \n1) Tree root. Must contain at least root items for extent tree, device tree and file system tree.\n2) Chunk tree. Otherwise bootstrapping is not possible.\n3) File system tree. At least `inode` item for top level `inode (.)`.\n4) Device tree. Dev extents for chunks.\n5) Extent tree. Must have corresponding extent for each chunk.\n\nIf any tree is empty, the file system is corrupted and the program should not attempt to mount it.\n\nAn attacker can leverage this flaw by tricking a user into downloading and compiling a crafted file to cause a crash via a NULL pointer dereference.",
    "publishedDate": "2018-08-07T10:22:08.261Z",
    "updatedDate": "2019-09-04T09:33:26.851Z",
    "disclosureDate": "2018-07-04T00:00:00.000Z",
    "exploitPublishDate": "2018-07-04T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.171**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ee5e37a26791f9c842b3298e594c6e3c93bb1355) commit\n* [**4.9.144**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7a72f918825ddece7a4ed79583836f6f1e06e478) commit\n* [**4.14.86**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=34407a175a59b668a1a2bbf0d0e495d87a7777d8) commit\n* [**4.19-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=514c7dca85a0bf40be984dab0b477403a6db901f) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "UNCORROBORATED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:UR)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "REASONABLE",
            "score": 5.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H/E:P/RL:O/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wen Xu and Po-Ning Tseng",
    "workaround": "",
    "vendorFixDate": "2018-08-01T00:00:00.000Z",
    "vendorNotifiedDate": "2018-05-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-2556",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-476"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-14612",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-2556/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.kernel.org/show_bug.cgi?id=199847",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.kernel.org/show_bug.cgi?id=199847",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=514c7dca85a0bf40be984dab0b477403a6db901f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://patchwork.kernel.org/patch/10503403/",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://patchwork.kernel.org/patch/10503413/",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}