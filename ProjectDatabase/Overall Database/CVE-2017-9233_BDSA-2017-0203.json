{
    "source": "BDSA",
    "name": "BDSA-2017-0203",
    "title": "Expat Vulnerable to Denial-of-Service(DoS) via External Entity Infinite Loop",
    "description": "A defect in the way in which Expat parses external parameter entities leads to an infinite loop and eventual Denial-of-Service (DoS) condition.",
    "technicalDescription": "We create an external entity definition as follows:\n\n```\n<!ELEMENT el EMPTY>\n<el/>\n```\n\nand create a reference to it in a DTD.  Once the parser hits this reference, it steps down into our external entity definition and begins to read through it.  The tokenizer recognises `<e` as the start of a valid ordinary element, and returns `XML_TOK_INSTANCE_START`.  The sequence `<el/>` is not a legal token for a DTD and the calling code should recognise this, but it does not.  Rather than stopping at this point, the logic continues as though the element is legal and attempts to tokenize the external element again.\n\nThe position from which it begins to tokenize is stored in a pointer.  Had the string read from the external entity actually been valid, the pointer would have been updated to the position of any unparsed text.  However, as the tokenizer is only continuing due to falling through without catching the error condition, this code was not exercised and so the value in the pointer remains unchanged.  Thus the tokenizer attempts sees `<e` again, returns `XML_TOK_INSTANCE_START` and the cycle begins again until finally a denial-of-service condition is reached.",
    "publishedDate": "2017-09-04T11:02:48.058Z",
    "updatedDate": "2022-07-18T14:49:17.236Z",
    "disclosureDate": "2017-06-25T00:00:00.000Z",
    "exploitPublishDate": "2017-06-25T00:00:00.000Z",
    "solution": "Fixed in version [**2.2.1**](https://github.com/libexpat/libexpat/releases/tag/R_2_2_1) by [this](https://github.com/libexpat/libexpat/commit/cc16ba0553ea218eab72460594a1e5daa79f25b7) commit.\n\nThe latest stable releases can be found [here](https://github.com/libexpat/libexpat/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.8,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rhodri James",
    "workaround": "",
    "vendorFixDate": "2017-06-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-0203",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-776"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-835"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-9233",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-0203/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libexpat/libexpat/commit/cc16ba0553ea218eab72460594a1e5daa79f25b7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libexpat/libexpat/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libexpat/libexpat/releases/tag/R_2_2_1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://libexpat.github.io/doc/cve-2017-9233/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.debian.org/security/2017/dsa-3898",
                "label": "ADVISORY"
            }
        ]
    }
}