{
    "source": "BDSA",
    "name": "BDSA-2020-3324",
    "title": "Collne Welcart e-Commerce Plugin for Wordpress Vulnerable to Object Injection via Insecure Deserialization in 'get_cookie()' function",
    "description": "Collne Welcart e-Commerce Plugin for Wordpress contains an insecure deserialization vulnerability in its cookie handling mechanism. An attacker could exploit this flaw by injecting malicious objects into the application via specially crafted requests.",
    "technicalDescription": "The `get_cookie()` function in this plugin uses the `usces_unserialize()` function to deserialize and decode the contents of cookies (`usces_cookie`) that are received with every incoming request. Because of a lack of sanitization measures, an attacker can inject malicious input into the `usces_cookie` parameter, which will then be deserialized into a PHP object. This is not particularly dangerous on its own. However, these objects can be used with magic methods (functions that are triggered when a certain event happens) for exploitation. \n\n**Note** This vulnerability requires a magic method for actual exploitation to occur. There is a magic method called `__destruct()` available in the `tcpdf` library, which is being used in the plugin. However, the vulnerability can't be exploited with this method because the class `TCPDF` is loaded after the cookie contents have been deserialized.",
    "publishedDate": "2020-11-12T14:57:43.283Z",
    "updatedDate": "2021-01-26T14:29:38.268Z",
    "disclosureDate": "2020-11-05T00:00:00.000Z",
    "solution": "Fixed in [**1.9.36**](https://plugins.trac.wordpress.org/browser/usc-e-shop/tags/1.9.36).\n\nThe latest stable releases are available [here](https://wordpress.org/plugins/usc-e-shop/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-10-20T00:00:00.000Z",
    "discoveryDate": "2020-10-06T00:00:00.000Z",
    "vendorNotifiedDate": "2020-10-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3324",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28339",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3324/ranges"
            },
            {
                "rel": "reference",
                "href": "https://plugins.svn.wordpress.org/usc-e-shop/tags/1.9.36/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://wordpress.org/plugins/usc-e-shop/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://wordpress.org/plugins/usc-e-shop/#developers",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.wordfence.com/blog/2020/08/newsletter-plugin-vulnerabilities-affect-over-300000-sites/#how-does-php-object-injection-work",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.wordfence.com/blog/2020/11/object-injection-vulnerability-in-welcart-e-commerce-plugin/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3324/default-remediation-status"
            }
        ]
    }
}