{
    "source": "BDSA",
    "name": "BDSA-2019-4615",
    "title": "Moonjit Vulnerable to Arbitrary Memory Read or Write Operations via Type Confusion in LuaJIT",
    "description": "Moonjit is vulnerable to arbitrary memory read or write operations due to a type confusion issue within LuaJIT. LuaJIT disputes the vulnerability.",
    "technicalDescription": "`debug.getinfo ` within LuaJIT has a type confusion issue that can lead to arbitrary read or write operations. This is because certain cases involving valid stack levels and > options are not handled correctly. \n\nLuaJIT disputes the vulnerability. The project owner states that the debug library is unsafe by definition and that this is not a vulnerability. They are of the view that upon original development of  LuaJIT the expectation was that the entire debug library had no security guarantees and thus it made no sense to assign CVEs. This is not a view that is shared by users of later LuaJIT derivatives.",
    "publishedDate": "2020-08-25T15:13:02.420Z",
    "updatedDate": "2020-09-23T13:52:47.385Z",
    "disclosureDate": "2019-11-29T00:00:00.000Z",
    "exploitPublishDate": "2019-11-13T00:00:00.000Z",
    "solution": "Fixed in LuaJIT by [this](https://github.com/LuaJIT/LuaJIT/commit/c017b2bafc24f71620de7225c5fdcd4a71ff2593) commit which is not yet included in any release.\n\nFixed in Moonjit version [**2.2.0**](https://github.com/moonjit/moonjit/releases/tag/2.2.0) by [this](https://github.com/moonjit/moonjit/commit/641cdbbb8f62c5c32de5388275211895313a86f1) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Badger9",
    "workaround": "",
    "vendorFixDate": "2019-11-16T00:00:00.000Z",
    "vendorNotifiedDate": "2019-11-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4615",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-843"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19391",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4615/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LuaJIT/LuaJIT/commit/c017b2bafc24f71620de7225c5fdcd4a71ff2593",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LuaJIT/LuaJIT/pull/526",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LuaJIT/LuaJIT/pull/526",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moonjit/moonjit/commit/641cdbbb8f62c5c32de5388275211895313a86f1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moonjit/moonjit/releases/tag/2.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4615/default-remediation-status"
            }
        ]
    }
}