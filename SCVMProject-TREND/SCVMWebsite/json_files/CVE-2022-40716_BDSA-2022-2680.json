{
    "source": "BDSA",
    "name": "BDSA-2022-2680",
    "title": "HashiCorp Consul Vulnerable to Access Control Bypass via Specially Crafted Certificate Signing Request (CSR)",
    "description": "HashiCorp Consul is vulnerable to access control bypass due to improper certificate signing request (CSR) validation. This could allow an authenticated attacker to send a specially crafted CSR to bypass ACL token restrictions in order to perform malicious actions within the Consul Connect service in the mesh.\n\n**Note:** To exploit this, an attacker requires permissions to access a client agent\u2019s mTLS certificate, and also possess valid ACL token for any service within the mesh.",
    "technicalDescription": "This vulnerability exists due to improper CSR checks on the number of SAN URIs and therefore allows for multiple to be specified. This can be leveraged by an attacker to bypass access controls in the service mesh.\n\nIt has been mitigated by introducing URI length checks to only allow a single SAN URI in the CSR within the RPC endpoint.",
    "publishedDate": "2022-09-26T12:01:33.375Z",
    "updatedDate": "2022-09-28T08:20:23.021Z",
    "disclosureDate": "2022-09-22T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**1.11.9**](https://github.com/hashicorp/consul/releases/tag/v1.11.9) by [this](https://github.com/hashicorp/consul/commit/ae822d752ad36007e353249691a0ef318cf55d08) commit.\n* [**1.12.5**](https://github.com/hashicorp/consul/releases/tag/v1.12.5) by [this](https://github.com/hashicorp/consul/commit/b4e3b52dcd002ce2d05b863cb7c21aeeade7d6fc) commit.\n* [**1.13.2**](https://github.com/hashicorp/consul/releases/tag/v1.13.2) by [this](https://github.com/hashicorp/consul/commit/765db9678d6500cc6fb8d0b1fcbc8a0e30fd0e28) commit.\n\nThe latest stable releases can be found [here](https://github.com/hashicorp/consul/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "HashiCorp\u2019s Solutions Engineering Team",
    "workaround": "",
    "vendorFixDate": "2022-09-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2680",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-295"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-40716",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2680/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.hashicorp.com/t/hcsec-2022-20-consul-service-mesh-intention-bypass-with-malicious-certificate-signing-request/44628",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/765db9678d6500cc6fb8d0b1fcbc8a0e30fd0e28",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/ae822d752ad36007e353249691a0ef318cf55d08",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/b4e3b52dcd002ce2d05b863cb7c21aeeade7d6fc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/pull/14579",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.11.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.12.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.13.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2680/default-remediation-status"
            }
        ]
    }
}