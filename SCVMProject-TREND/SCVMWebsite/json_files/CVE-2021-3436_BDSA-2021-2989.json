{
    "source": "BDSA",
    "name": "BDSA-2021-2989",
    "title": "Zephyr Vulnerable to Denial-of-Service (DoS) via Bluetooth Bond Overwrites During Keys Distribution",
    "description": "Zephyr is vulnerable to denial-of-service (DoS) due to improper handling of distributing identity address information in the Bluetooth module. An attacker could exploit this vulnerability by supplying a system with maliciously crafted requests.",
    "technicalDescription": "The issue exists in the function `smp_ident_addr_info()` within the file `subsys/bluetooth/host/smp.c`. A missing check for existing bonds with the same identity address could result in overwriting of bonds in storage and lead to disconnects due to failure to resolve peer resolvable private addresses (RPAs).",
    "publishedDate": "2021-10-08T12:27:05.360Z",
    "updatedDate": "2021-10-08T12:27:55.195Z",
    "disclosureDate": "2021-10-05T00:00:00.000Z",
    "exploitPublishDate": "2021-10-05T00:00:00.000Z",
    "solution": "Fixed in [**2.6.0-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.6.0-rc1) by [this](https://github.com/zephyrproject-rtos/zephyr/commit/e06bac0e4f2537ec1547c1c2cca80d5f25fdf0a3) commit and [**2.5.1-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.5.1-rc1) by [this](https://github.com/zephyrproject-rtos/zephyr/commit/1626b87d92378efcca4469623caab4f019da862b) commit.\n\nFixed in the **2.4** branch by [this](https://github.com/zephyrproject-rtos/zephyr/commit/da887af56826aa3e9702be65c53ae0d8a3d78d0a) commit which is not yet included in any release.\n\nFixed in the **1.14** branch by [this](https://github.com/zephyrproject-rtos/zephyr/commit/ef512f2a0e311a26770c30eae9677a4561c7a8c8) commit which is not yet included in any release.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:A/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-03-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2989",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3436",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2989/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/1626b87d92378efcca4469623caab4f019da862b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/da887af56826aa3e9702be65c53ae0d8a3d78d0a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/e06bac0e4f2537ec1547c1c2cca80d5f25fdf0a3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/ef512f2a0e311a26770c30eae9677a4561c7a8c8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.5.1-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.6.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-j76f-35mc-4h63",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-j76f-35mc-4h63",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2989/default-remediation-status"
            }
        ]
    }
}