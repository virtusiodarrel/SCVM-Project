{
    "source": "BDSA",
    "name": "BDSA-2019-0850",
    "title": "Moodle Vulnerable to Server-Side Request Forgery (SSRF) via Badge URLs",
    "description": "Moodle is vulnerable to server-side request forgery (SSRF) due to insufficient restrictions on URLs for badges. This could allow an attacker to perform malicious actions as if they originate from a target server.",
    "technicalDescription": "Moodle supports the awarding of badges which are compatible with Mozilla Open Badges, but incorrectly allows a badge URL to be set by a user within the file `badges/backpack_form.php`, instead of being fixed to the Mozilla Open Badges backpack URL. This could allow an attacker to submit requests as if they are being made by the server. This could enable them to perform malicious actions such as manipulate/cause a denial-of-service to services on internal networks, or perform port scanning by inferring open/closed ports from response times.",
    "publishedDate": "2019-03-28T15:59:04.953Z",
    "updatedDate": "2019-03-28T15:59:04.934Z",
    "disclosureDate": "2019-01-21T00:00:00.000Z",
    "solution": "Fixed in **[3.1.16](https://github.com/moodle/moodle/releases/tag/v3.1.16)** by [this](https://github.com/moodle/moodle/commit/502650a3e2c325141df6287e6e2e36e36d87874c) commit.\n\nThe latest stable releases are available [here](https://download.moodle.org/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alejandro Parodi",
    "workaround": "",
    "vendorFixDate": "2019-01-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0850",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3809",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0850/ranges"
            },
            {
                "rel": "reference",
                "href": "https://download.moodle.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/502650a3e2c325141df6287e6e2e36e36d87874c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.1.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=381229#p1536766",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0850/default-remediation-status"
            }
        ]
    }
}