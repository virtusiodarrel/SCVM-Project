{
    "source": "BDSA",
    "name": "BDSA-2019-4488",
    "title": "Mattermost Server Vulnerable to Account Loss via Logic Flaw in Change Email Functionality",
    "description": "Mattermost Server is vulnerable to account losses due to how emails are updated in the database when users change the email associated with their account.\n\nA user could update their account with an inaccessible email address meaning that they could potentially lose access.",
    "technicalDescription": "Mattermost Server is vulnerable to account losses because the change email functionality performs the change in the database directly after the change request, despite also sending a verification link/token to the new address.\n\nThis means that it is possible for users to mistype an address and have the email address changed without verifying that they have access to the new email address. \n\nAttackers could try and use this issue to deliberately lock users out of their account or obtain emails sent to the victim user.",
    "publishedDate": "2020-07-17T09:10:23.677Z",
    "updatedDate": "2020-07-17T09:10:23.672Z",
    "disclosureDate": "2019-03-16T00:00:00.000Z",
    "solution": "Fixed in [**5.9.0-rc1**](https://github.com/mattermost/mattermost-server/releases/tag/v5.9.0-rc1) by [this](https://github.com/mattermost/mattermost-server/commit/a96d30c1c46c1fd617647e2eaf62e4311df65e01) commit.\n\nThe latest stable releases are available [here](https://github.com/mattermost/mattermost-server/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.1,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rohitesh Gupta",
    "workaround": "",
    "vendorFixDate": "2019-03-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4488",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-283"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-345"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20878",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4488/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.mattermost.com/administration/changelog.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/commit/a96d30c1c46c1fd617647e2eaf62e4311df65e01",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/pull/10253",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/releases/tag/v5.9.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mattermost.com/security-updates/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4488/default-remediation-status"
            }
        ]
    }
}