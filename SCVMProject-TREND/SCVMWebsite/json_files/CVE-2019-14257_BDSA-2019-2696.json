{
    "source": "BDSA",
    "name": "BDSA-2019-2696",
    "title": "Zenoss Vulnerable to Remote Code Execution (RCE) Due to Privilege Escalation via 'pyraw' Utility",
    "description": "Zenoss is vulnerable to privilege escalation. This could allow an attacker to modify existing environment variables to redirect execution before privileges are dropped. This could lead to remote code execution with root privileges.",
    "technicalDescription": "This vulnerability is located in `/opt/zenoss/bin/pyraw` which is configured by `product-base/install_scripts/install_lib.sh` and `product-base/install_scripts/zenoss_component_install.sh`.\n\nThe installation of pyraw was introduced to its current location by [this](https://github.com/zenoss/product-assembly/commit/f7bddac713a1c06b2c4c1cf9d30dab5d862e0f53) commit.",
    "publishedDate": "2019-09-13T14:59:48.619Z",
    "updatedDate": "2019-09-13T14:59:48.603Z",
    "disclosureDate": "2019-08-21T00:00:00.000Z",
    "exploitPublishDate": "2019-08-21T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/zenoss/product-assembly/commit/7c246682c31cb2a969dcc83b76f347ee72e8eff7) commit in the Develop branch which is not yet included in any release.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Jakob Nelson",
    "workaround": "**4.2.5**: Disable the Zenoss Discovery feature and remove the pyraw binary.\n\n**5.0.0**: Remove pyraw as it is no longer used.\n\nPyraw can also be rendered unusable by running the command `chmod 000 /opt/zenoss/bin/pyraw`.\n\nNote: Upgrading Zenoss may reinstall pyraw or reset permissions.",
    "vendorFixDate": "2019-08-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2696",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-250"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14257",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2696/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zenoss/product-assembly/commit/7c246682c31cb2a969dcc83b76f347ee72e8eff7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.coalfire.com/The-Coalfire-Blog/August-2019/Getting-more-from-a-compliance-test",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.coalfire.com/The-Coalfire-Blog/August-2019/Getting-more-from-a-compliance-test",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2696/default-remediation-status"
            }
        ]
    }
}