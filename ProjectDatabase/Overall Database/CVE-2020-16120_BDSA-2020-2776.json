{
    "source": "BDSA",
    "name": "BDSA-2020-2776",
    "title": "Linux Kernel Vulnerable to Information Disclosure via Improper Permission Checks in overlayfs",
    "description": "It was found that in some situations the `overlay` file system in the Linux kernel does not properly perform permission checks. This could be exploited by local attackers to get read access to files without required permissions.",
    "technicalDescription": "This vulnerability was mainly fixed by verifying permissions in `ovl_path_open()` (file `fs/overlayfs/util.c`) and changing function `ovl_open_realfile()` in file `/fs/overlayfs/file.c` to call on a real inode before opening regular file on one of its underlying layers.\n\nThis vulnerability likely only has an impact on the Ubuntu kernel since it has unprivileged user namespaces enabled by default.",
    "publishedDate": "2020-10-14T15:53:14.944Z",
    "updatedDate": "2021-09-10T14:02:45.220Z",
    "disclosureDate": "2020-10-13T00:00:00.000Z",
    "solution": "Fixed in [**5.8-rc1**](https://www.kernel.org) by the following commits:\n* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=48bd024b8a40d73ad6b086de2615738da0c7004f)\n* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=56230d956739b9cb1cbde439d76227d77979a04d)\n* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=05acefb4872dae89e772729efb194af754c877e8)\n* [Commit 4](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=130fdbc3d1f9966dd4230709c30f3768bccd3065)\n* [Commit 5](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=292f902a40c11f043a5ca1305a114da0e523eaa3)\n\nThe latest stable releases are available [here](https://www.kernel.org/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Giuseppe Scrivano",
    "workaround": "A potential mitigation on systems where unprivileged user namespaces are enabled but not needed is to set the `kernel.unprivileged_userns_clone` `sysctl` to 0:\n\n`  $ sudo sysctl kernel.unprivileged_userns_clone=0`\n\nIn order to apply the workaround across reboots add a file to `/etc/sysctl.d/` that contains the following:\n\n`  kernel.unprivileged_userns_clone=0`",
    "vendorFixDate": "2020-06-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-2776",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-275"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2020-16120",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-2776/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=05acefb4872dae89e772729efb194af754c877e8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=130fdbc3d1f9966dd4230709c30f3768bccd3065",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=292f902a40c11f043a5ca1305a114da0e523eaa3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=48bd024b8a40d73ad6b086de2615738da0c7004f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=56230d956739b9cb1cbde439d76227d77979a04d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/10/13/6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/10/13/6",
                "label": "WORKAROUND"
            }
        ]
    }
}