{
    "source": "BDSA",
    "name": "BDSA-2017-3004",
    "title": "BusyBox Vulnerable to Command Injection via Autocomplete Function",
    "description": "BusyBox is vulnerable to command injection due to improper sanitization of escape sequences in terminal input. This could allow an attacker to execute arbitrary commands on a victim's machine.",
    "technicalDescription": "Functionality in the BusyBox shell for tab-completion of path names (in the file `libbb/lineedit.c` from version 1.1.0, and `cmdedit.c` previously) does not properly sanitize escape characters in filenames. An attacker could exploit this by providing a victim a file with a malicious filename. If the victim uses autocompletion in the directory containing the file, any escape sequences included in the filename will be processed. The extent to which this can be exploited depends on the terminal used and the vulnerabilities it contains. Therefore this issue can allow a range of attacks, such as clearing the victim's terminal, displaying false information, dumping potentially sensitive information to the screen, or executing arbitrary commands.",
    "publishedDate": "2018-03-29T13:35:36.464Z",
    "updatedDate": "2019-04-16T14:01:23.989Z",
    "disclosureDate": "2017-11-20T00:00:00.000Z",
    "exploitPublishDate": "2017-11-20T00:00:00.000Z",
    "solution": "Fixed in **[1.28.0](https://git.busybox.net/busybox/tag/?h=1_28_0)** by [this](https://git.busybox.net/busybox/commit/?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8) commit.\n\nFixed in Debian package **[1:1.27.2-2](https://packages.debian.org/search?keywords=busybox)** by [this](https://anonscm.debian.org/git/d-i/busybox.git/commit/?id=25b2525b0f49fc777342e8a543a4d1937ba321c8) commit.\n\nThe latest stable releases are available [here](https://www.busybox.net/downloads/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ariel Zelivansky",
    "workaround": "",
    "vendorFixDate": "2017-11-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-3004",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-150"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-16544",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-3004/ranges"
            },
            {
                "rel": "reference",
                "href": "https://anonscm.debian.org/git/d-i/busybox.git/commit/?id=25b2525b0f49fc777342e8a543a4d1937ba321c8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.busybox.net/busybox/commit/?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.busybox.net/busybox/tag/?h=1_28_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packages.debian.org/search?keywords=busybox",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.busybox.net/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.twistlock.com/2017/11/20/cve-2017-16544-busybox-autocompletion-vulnerability/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.twistlock.com/2017/11/20/cve-2017-16544-busybox-autocompletion-vulnerability/",
                "label": "POC"
            }
        ]
    }
}