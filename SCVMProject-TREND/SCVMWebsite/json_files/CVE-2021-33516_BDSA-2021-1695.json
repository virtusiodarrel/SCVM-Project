{
    "source": "BDSA",
    "name": "BDSA-2021-1695",
    "title": "GUPnP Vulnerable to DNS Rebinding via Insufficient Validation of 'Host' Header",
    "description": "GUPnP is vulnerable to DNS rebinding due to how the GUPnP server functionality does not sufficiently validate the value of the `Host` header.\n\nA malicious remote server could use this issue to trick the user browser into triggering actions on local UPnP services.",
    "technicalDescription": "GUPnP is vulnerable to DNS rebinding because the `control_server_handler()` function in the `libgupnp/gupnp-service.c` file does not validate the `Host` header for UPnP requests. An attacker could abuse this issue by tricking a victim user into accessing a malicious remote server and cause UPnP services implemented with GUPnP to react to requests coming from the malicious website.\n\nThe impacts of this issue depend on the affected service. In the issue report [here](https://gitlab.gnome.org/GNOME/gupnp/-/issues/24), it is suggested that the malicious server could perform directed data tampering or exfiltration attacks.",
    "publishedDate": "2021-06-08T10:38:08.113Z",
    "updatedDate": "2021-06-08T10:38:08.105Z",
    "disclosureDate": "2021-04-06T00:00:00.000Z",
    "exploitPublishDate": "2021-04-06T00:00:00.000Z",
    "solution": "Fixed in [**1.2.5**](https://gitlab.gnome.org/GNOME/gupnp/-/tags/gupnp-1.2.5) by [this](https://gitlab.gnome.org/GNOME/gupnp/-/commit/ca6ec9dcb26fd7a2a630eb6a68118659b589afac) commit.\n\nFixed in [**1.0.7**](https://gitlab.gnome.org/GNOME/gupnp/-/tags/gupnp-1.0.7) by [this](https://gitlab.gnome.org/GNOME/gupnp/-/commit/05e964d48322ff23a65c6026d656e4494ace6ff9) commit.\n\nThe latest stable releases are available [here](https://download.gnome.org/sources/gupnp/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Gabriel Corona",
    "workaround": "",
    "vendorFixDate": "2021-05-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1695",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33516",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1695/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discourse.gnome.org/t/security-relevant-releases-for-gupnp-issue-cve-2021-33516/6536",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://download.gnome.org/sources/gupnp/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/gupnp/-/commit/05e964d48322ff23a65c6026d656e4494ace6ff9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/gupnp/-/commit/ca6ec9dcb26fd7a2a630eb6a68118659b589afac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/gupnp/-/issues/24",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/gupnp/-/issues/24",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/gupnp/-/tags/gupnp-1.0.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/gupnp/-/tags/gupnp-1.2.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1695/default-remediation-status"
            }
        ]
    }
}