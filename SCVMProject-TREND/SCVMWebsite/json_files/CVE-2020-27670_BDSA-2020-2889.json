{
    "source": "BDSA",
    "name": "BDSA-2020-2889",
    "title": "Xen Vulnerable to Privilege Escalation and Denial-of-Service (DoS) via Unsafe AMD IOMMU Page Table Updates",
    "description": "Xen is vulnerable to a flaw whereby it handles AMD IOMMU page table updates in an unsafe manner. A local attacker on a guest operating system may cause privilege escalation or cause a denial-of-service (DoS) of the guest or host operating system.",
    "technicalDescription": "It is possible that the IOMMU would read and then use a half-updated page table entry. Additionally, updates to Device Table entries lacked suitable ordering enforcement for certain steps involved in these updates. The exact outcome of these flaws being exploited depends heavily on how the compiler translated the affected pieces of code.\n\nOnly x86 systems with AMD, Hygon, or compatible IOMMU hardware are vulnerable. In order to exploit this vulnerability the guest must have a physical device passed through to it.",
    "publishedDate": "2020-10-21T15:26:39.290Z",
    "updatedDate": "2021-10-20T13:42:19.346Z",
    "disclosureDate": "2020-10-20T00:00:00.000Z",
    "solution": "Fixed in [**4.12.4**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.12.4) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=97f9defe9610adc44dd65a2e21d788e053641183) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=14b0a080c19949a6af6e9c5af295427e98a2974b) commit.\n\nFixed in [**4.13.2**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.2) by these commits:\n*  [Commit 1](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=3009e4d6b46c365e553c67499c45459cf1955f51) \n*  [Commit 2](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e891c288ccf966a5822a6dd2dbf1342273a18d6e)\n*  [Commit 3](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1c86c830303fe18b8e2ca305ce44152147e8a8f9) \n\nFixed in [**4.14.1**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.1) by these commits:\n*  [Commit 1](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=f7ab0c1a8ce47d6362134cc99354874bcad2fc12) \n*  [Commit 2](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=a279fcbb4f1a9c623dcb0a8f5d86c6a4123cf741)\n*  [Commit 3](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7339975f552c99f74c73ee37073bac01a81825be) \n\nFixed in the following branches which have not yet been included in any release:\n* **4.10** branch by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=56f8da75e1d42047549da304afb20bd72d572c84) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=71da63bbb83af8c8c537f3731dda7dc2d2fd31ac) commit.\n* **4.11** branch by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7739ffda81784853ca6b0156331f5d1923303fa7) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=63199dfd3a0418f1677c6ccd7fe05b123af4610a) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:L/AC:L/Au:N/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Paul Durrant of Amazon and Jan Beulich of SUSE",
    "workaround": "If guests do not have physical devices passed through to them they are not vulnerable.",
    "vendorFixDate": "2020-10-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2889",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27670",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2889/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.12.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=14b0a080c19949a6af6e9c5af295427e98a2974b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1c86c830303fe18b8e2ca305ce44152147e8a8f9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=3009e4d6b46c365e553c67499c45459cf1955f51",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=56f8da75e1d42047549da304afb20bd72d572c84",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=63199dfd3a0418f1677c6ccd7fe05b123af4610a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=71da63bbb83af8c8c537f3731dda7dc2d2fd31ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7339975f552c99f74c73ee37073bac01a81825be",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7739ffda81784853ca6b0156331f5d1923303fa7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=97f9defe9610adc44dd65a2e21d788e053641183",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=a279fcbb4f1a9c623dcb0a8f5d86c6a4123cf741",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e891c288ccf966a5822a6dd2dbf1342273a18d6e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=f7ab0c1a8ce47d6362134cc99354874bcad2fc12",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-347.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-347.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2889/default-remediation-status"
            }
        ]
    }
}