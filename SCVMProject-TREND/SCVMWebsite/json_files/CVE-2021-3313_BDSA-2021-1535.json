{
    "source": "BDSA",
    "name": "BDSA-2021-1535",
    "title": "Plone CMS Vulnerable to Stored XSS via 'username' and 'filename' Parameters",
    "description": "PloneCMS contains a stored cross-site scripting (XSS) vulnerability.  This allows an authenticated remote attacker to insert Javascript into page content.  This will get executed when rendered in a victims browser.  XSS vulnerability may allow an attacker to steal session credentials that allow further attacks.\n\n**Note:** This vulnerability has also been disclosed as **CVE-2021-33508** (**BDSA-2021-1551**).",
    "technicalDescription": "The XSS vulnerability is due to a lack of sanitization of the `username` and `filename` parameters.\n\nAn authenticated attacker can injection Javascript into the full name field of the user details. On the ownership tab of a content item, a victim could search for the name, click on it, and then the script code would be executed.\n\nSVG files are also not sanitized, allowing an authenticated attacker to create SVG files containing executable Javascript.  When the SVG is supplied as a link, the payload will be executed.",
    "publishedDate": "2021-05-21T15:57:45.916Z",
    "updatedDate": "2021-08-24T14:40:03.444Z",
    "disclosureDate": "2021-05-18T00:00:00.000Z",
    "exploitPublishDate": "2021-01-26T00:00:00.000Z",
    "solution": "Fixed in [**5.2.5**](https://plone.org/news/2021/plone-5-2-5-released).\n\nThe vendor has made a hotfix available [here](https://plone.org/security/hotfix/20210518) that can be applied to the following versions:\n* **5.2.x** to **5.2.4**,\n* **5.1.x** to **5.1.7**,\n* **5.0.x** to **5.0.10**,\n* **4.x** to **4.3.20**.\n\nThe latest stable releases are available [here](https://plone.org/download).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tino Kautschke",
    "workaround": "",
    "vendorFixDate": "2021-08-06T00:00:00.000Z",
    "vendorNotifiedDate": "2021-01-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1535",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3313",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1535/ranges"
            },
            {
                "rel": "reference",
                "href": "https://plone.org/download",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://plone.org/news/2021/plone-5-2-5-released",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://plone.org/security/hotfix/20210518",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://plone.org/security/hotfix/20210518",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://plone.org/security/hotfix/20210518/stored-xss-from-file-upload-svg-html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://plone.org/security/hotfix/20210518/stored-xss-from-user-fullname",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.compass-security.com/fileadmin/Research/Advisories/2021-07_CSNC-2021-013_XSS_in_Plone_CMS.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.compass-security.com/fileadmin/Research/Advisories/2021-07_CSNC-2021-013_XSS_in_Plone_CMS.txt",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1535/default-remediation-status"
            }
        ]
    }
}