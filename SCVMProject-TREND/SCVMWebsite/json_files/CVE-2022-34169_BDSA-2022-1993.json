{
    "source": "BDSA",
    "name": "BDSA-2022-1993",
    "title": "Apache Xalan Java XSLT Library Vulnerable to Arbitrary Code Execution via Java Class File Corruption",
    "description": "The Apache Xalan Java XSLT library is vulnerable to arbitrary code execution due to improper handling of integer truncation when processing XSLT stylesheets. This could allow an attacker to corrupt Java class files and execute malicious bytecode by supplying a crafted stylesheet.\n\n**Note:** The vendor states that the Apache Xalan Java project is dormant and in the process of being retired. No future releases of Apache Xalan Java to address this issue are expected. The OpenJDK project, which includes a repackaged copy of Xalan, has addressed this issue.",
    "technicalDescription": "The vulnerability exists due to the problematic compilation of XSLT integer expressions. Larger integers (i.e. those that are larger than one byte in size) are stored within the constant pool, which consists of a Java array. The size of the constant pool is specified by a two-byte value in the relevant Java class file. At the end of the compilation process, the relevant Java class file will be serialized, which involves truncating the constant pool size to a type `short` value. However, the array itself will be written to the serialized output in full. This can cause the array fields to be interpreted as class fields whenever the serialized class file is being parsed. An attacker could leverage this issue to cause a malicious class file to be generated, which in turn will allow them to achieve arbitrary code execution.",
    "publishedDate": "2022-07-20T12:02:28.837Z",
    "updatedDate": "2022-09-14T10:22:22.244Z",
    "disclosureDate": "2022-07-19T00:00:00.000Z",
    "exploitPublishDate": "2022-08-26T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 7.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Felix Wilhelm, Google Project Zero",
    "workaround": "Fixed in OpenJDK versions:\n* [**18.0.1.1**](https://github.com/openjdk/jdk18u/releases/tag/jdk-18.0.1.1-ga)\n* [**17.0.4**](https://github.com/openjdk/jdk17u-dev/releases/tag/jdk-17.0.4-ga)\n* [**15.0.8**](https://github.com/openjdk/jdk15u-dev/releases/tag/jdk-15.0.8-ga)\n* [**13.0.12**](https://github.com/openjdk/jdk13u-dev/releases/tag/jdk-13.0.12-ga)\n* [**11.0.16**](https://github.com/openjdk/jdk11u-dev/releases/tag/jdk-11.0.16-ga)\n* [**8u342-ga**](https://github.com/openjdk/jdk8u-dev/releases/tag/jdk8u342-ga)\n* [**7u351-ga**](https://github.com/openjdk/jdk7u/releases/tag/jdk7u351-ga)",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1993",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-34169",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1993/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=2290&q=Xalan&can=1",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk11u-dev/releases/tag/jdk-11.0.16-ga",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk13u-dev/releases/tag/jdk-13.0.12-ga",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk15u-dev/releases/tag/jdk-15.0.8-ga",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk17u-dev/releases/tag/jdk-17.0.4-ga",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk18u/releases/tag/jdk-18.0.1.1-ga",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk7u/releases/tag/jdk7u351-ga",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk8u-dev/releases/tag/jdk8u342-ga",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/12pxy4phsry6c34x2ol4fft6xlho4kyw",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://openjdk.org/groups/vulnerability/advisories/2022-07-19",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/168186/GS20220826142700.tgz",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2022/07/20/2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.oracle.com/security-alerts/cpujul2022.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1993/default-remediation-status"
            }
        ]
    }
}