{
    "source": "BDSA",
    "name": "BDSA-2021-0283",
    "title": "Docker Vulnerable to Privilege Escalation via Improper Authorization for '--userns-remap' Module",
    "description": "Docker does not have a proper authorization mechanism for `--userns-remap` module. If an attacker having a root-level access to this module namespace, they can also access the host system, this can lead to a privilege escalation condition.",
    "technicalDescription": "This vulnerability exists in multiple files that handle permissions related to the `--userns-remap` module. The current mechanism implemented in these files allows `--userns-remap` root users to manipulate files within the `/var/lib/docker/<remapping>` directory with elevated privileges. This can lead to privilege escalation because of write operations with elevated privileges taking place. Thus, an attacker can obtain root privileges on the host system.\n\nThis issue was fixed in the affected files by changing the appropriate `chown` permission sets and preventing the `root` user from being involved. This has been achieved by changing the user from the real `root` user to the current user using elements like `current`, `currentID` and `CurrentIdentity`.",
    "publishedDate": "2021-02-03T14:47:12.832Z",
    "updatedDate": "2021-02-15T10:14:40.968Z",
    "disclosureDate": "2021-02-02T00:00:00.000Z",
    "solution": "Fixed in [**19.03.15**](https://github.com/moby/moby/releases/tag/v19.03.15) and [**20.10.3**](https://github.com/moby/moby/releases/tag/v20.10.3) by [this](https://github.com/moby/moby/commit/64bd4485b3a66a597c02c95f5776395e540b2c7c) commit.\n\nThe latest stable releases are available [here](https://github.com/moby/moby/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:L/AC:L/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.7,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alex Chapman",
    "workaround": "",
    "vendorFixDate": "2021-02-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0283",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21284",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0283/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/commit/64bd4485b3a66a597c02c95f5776395e540b2c7c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/releases/tag/v19.03.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/releases/tag/v20.10.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/security/advisories/GHSA-7452-xqpj-6rpc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0283/default-remediation-status"
            }
        ]
    }
}