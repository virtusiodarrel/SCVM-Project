{
    "source": "BDSA",
    "name": "BDSA-2022-2670",
    "title": "Parse Server Vulnerable to Authentication Bypass via Circumvention of Authentication Adapter 'App ID' Validation",
    "description": "Parse Server is vulnerable to an authentication bypass issue due to a flaw in how the authentication adapter app ID (`appIds`) for Facebook and Spotify is validated.\n\nAn attacker could submit a crafted authentication request supplying the `appIds` as a string rather than an array of strings in order to circumvent the authentication adapter app ID validation.\n\n**Note**: The vendor has stated in their [advisory](https://github.com/parse-community/parse-server/security/advisories/GHSA-r657-33vp-gp22) that both adapters validate the supplied access token with the respective authentication provider. An app ID is automatically assigned by the authentication provider meaning that the attacker would have to be assigned an app ID by the authentication provider which is a sub-set of the server-side configured app ID.",
    "technicalDescription": "This issue exists due to how the authentication adapter app ID validation for Facebook and Spotify does not account for an incoming `appIds` value being a string. The validation code expects the parameter to be an array of strings which causes the use of the JavaScript `Array.prototype.indexOf()` method to allow string `appIds` values that are a sub-string of the full server-side configured app ID.\n\nTo remedy this issue, the vendor has updated the validation code in the `src/Adapters/Auth/facebook.js` and `src/Adapters/Auth/spotify.js` files to check the type of the value set for `appIds` and to throw an error if the value is not an array.",
    "publishedDate": "2022-09-26T10:53:19.802Z",
    "updatedDate": "2022-09-26T10:53:19.788Z",
    "disclosureDate": "2022-09-20T00:00:00.000Z",
    "solution": "Fixed in:\n* **[4.10.16](https://github.com/parse-community/parse-server/releases/tag/4.10.16)** by [this](https://github.com/parse-community/parse-server/commit/b3e7939f) commit,\n* **[5.2.7](https://github.com/parse-community/parse-server/releases/tag/5.2.7)** by [this](https://github.com/parse-community/parse-server/commit/ecf08144) commit,\n* the **alpha** branch by [this](https://github.com/parse-community/parse-server/commit/8c8ec715) commit,\n* the **beta** branch by [this](https://github.com/parse-community/parse-server/commit/1a2b1b9b) commit.\n\nThe latest stable releases are available [here](https://github.com/parse-community/parse-server/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.7,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.2,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "KarolisBan",
    "workaround": "",
    "vendorFixDate": "2022-09-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2670",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-305"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-39231",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2670/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/1a2b1b9b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/8c8ec715",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/b3e7939f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/ecf08144",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/pull/8185",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases/tag/4.10.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases/tag/5.2.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/security/advisories/GHSA-r657-33vp-gp22",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2670/default-remediation-status"
            }
        ]
    }
}