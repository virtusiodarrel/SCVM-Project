{
    "source": "BDSA",
    "name": "BDSA-2020-1660",
    "title": "Bareos Director Vulnerable to Heap Buffer Overflow via Oversized Digest Strings Sent During Verify Job Initialization",
    "description": "Bareos Director is vulnerable to a heap buffer overflow. This occurs when a malicious client sends oversized digest messages during initialization of a Verify job. According to the vendor the malicious client may use this vulnerability to cause the program to crash. It has been suggested that code execution is a possible consequence, but this has not been demonstrated.",
    "technicalDescription": "The issue is due to missing buffer size checks when writing digests from the file deamon in the function `GetAttributesAndPutInCatalog()` (in file `core/src/dird/fd_cmds.cc`). This allows a malicious file deamon to send a digest with a length thats is greater than 512 bytes (the size of the target buffer), and thus overflow the buffer. This was fixed by resizing the target buffer so that it fits the message.",
    "publishedDate": "2020-07-14T21:20:50.900Z",
    "updatedDate": "2020-07-14T21:20:50.892Z",
    "disclosureDate": "2020-07-09T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/bareos/bareos/commit/86c6fa479) commit in:\n* **[19.2.8](https://github.com/bareos/bareos/releases/tag/Release/19.2.8)**\n* **[18.2.9](https://github.com/bareos/bareos/releases/tag/Release/18.2.9)**\n* **[17.2.10](https://github.com/bareos/bareos/releases/tag/Release/17.2.10)**.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Pasi Saarinen",
    "workaround": "The official workaround to this issue is disabling Verify jobs.",
    "vendorFixDate": "2020-07-09T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1660",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11061",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1660/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.bareos.org/view.php?id=1210",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bareos/bareos/commit/86c6fa479",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bareos/bareos/releases/tag/Release/17.2.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bareos/bareos/releases/tag/Release/18.2.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bareos/bareos/releases/tag/Release/19.2.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bareos/bareos/security/advisories/GHSA-mm45-cg35-54j4",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1660/default-remediation-status"
            }
        ]
    }
}