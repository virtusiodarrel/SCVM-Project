{
    "source": "BDSA",
    "name": "BDSA-2021-0832",
    "title": "curl Vulnerable to Man-in-the-Middle (MitM) Attacks via HTTPS Proxy Used with TLS 1.3",
    "description": "curl is vulnerable to man-in-the-middle (MitM) attacks due to insecure session restoration with HTTPS proxy servers that use TLS 1.3 protocol. An attacker that controls a malicious HTTPS proxy could make curl assume that a session is being restored with the original host while routing encrypted data through the proxy.",
    "technicalDescription": "The vulnerability appears due to curl supporting faster, but less secure session restorations for HTTPS proxies when TLS 1.3 is used. The problem is that curl can confuse HTTPS proxy session tickets with the ones coming from the remote server, allowing malicious HTTPS proxy connections to be mistakenly \"restored\" without performing the required TLS certificate check. A successful exploitation requires that the malicious HTTPS proxy provides curl an acceptable TLS certificate of the original server. \n\nNote that the HTTPS proxies have two TLS layers - one for communicating with curl, and the other is encrypted data. This particular attack is only related to the communication layer and does not reveal the encrypted data.",
    "publishedDate": "2021-04-01T08:46:47.910Z",
    "updatedDate": "2021-04-30T08:20:28.213Z",
    "disclosureDate": "2021-03-31T00:00:00.000Z",
    "exploitPublishDate": "2021-04-30T00:00:00.000Z",
    "solution": "Fixed in [**7.76.0**](https://github.com/curl/curl/releases/tag/curl-7_76_0) by [this](https://github.com/curl/curl/commit/b09c8ee15771c614c4bf3ddac893cdb12187c844) commit.\n\nThe latest stable releases are available [here](https://curl.se/download.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.6,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mingtao Yang, Facebook",
    "workaround": "If an upgrade is not possible, the vendor advises the following alternatives:\n* Apply the patch to your local version\n* Use another TLS backend\n* Avoid TLS 1.3 with HTTPS proxies",
    "vendorFixDate": "2021-03-28T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0832",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-290"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22890",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0832/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22890.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22890.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/549310e907e",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/b09c8ee15771c614c4bf3ddac893cdb12187c844",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_76_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1129529",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1129529",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0832/default-remediation-status"
            }
        ]
    }
}