{
    "source": "BDSA",
    "name": "BDSA-2022-2315",
    "title": "Undici Vulnerable to Server-Side Request Forgery (SSRF) via 'path/pathname' Option of 'undici.request'",
    "description": "Undici is vulnerable to server-side request forgery (SSRF) due to insufficient validation of user-supplied input to the `path/pathname`. This could allow an authenticated attacker to access internal resources that should not be available outside of the network by crafting a malicious request.",
    "technicalDescription": "This vulnerability can be triggered when an absolute URL is used within the `path` parameter.\n\nIt has been mitigated by introducing validation on the user-supplied `url` to check the parameters. If the first parameter is a relative URL then the second parameter is required, and will then be used as the base URL. If the first parameter is an absolute URL, the second parameter will be ignored.",
    "publishedDate": "2022-08-22T11:54:23.041Z",
    "updatedDate": "2022-08-22T11:55:04.056Z",
    "disclosureDate": "2022-08-09T00:00:00.000Z",
    "exploitPublishDate": "2022-08-09T00:00:00.000Z",
    "solution": "Fixed in version [**5.8.2**](https://github.com/nodejs/undici/releases/tag/v5.8.2) by [this](https://github.com/nodejs/undici/commit/124f7ebf705366b2e1844dff721928d270f87895) commit.\n\nThe latest stable releases can be found [here](https://github.com/nodejs/undici/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Haxatron",
    "workaround": "The vendor has advised to validate user input before passing it to the `undici.request` call as a workaround.",
    "vendorFixDate": "2022-08-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2315",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-35949",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2315/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/commit/124f7ebf705366b2e1844dff721928d270f87895",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/releases/tag/v5.8.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/security/advisories/GHSA-8qr4-xgw6-wmr3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/security/advisories/GHSA-8qr4-xgw6-wmr3",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/security/advisories/GHSA-8qr4-xgw6-wmr3",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2315/default-remediation-status"
            }
        ]
    }
}