{
    "source": "BDSA",
    "name": "BDSA-2020-2139",
    "title": "chrony Vulnerable to Privilege Escalation via '.pid' File Symlink Attack",
    "description": "chrony is vulnerable to privilege escalation due to improper handling of `.pid` file creation. An attacker in control of the chrony user account could exploit this vulnerability in order to perform unauthorized file writes, exfiltrate sensitive information and cause a denial-of-service (DoS).",
    "technicalDescription": "A call made to `write_pidfile()`, by chronyd with root privileges, is exposed to symlink attacks under the following conditions:\n* an attacker has control of the chrony user account\n* the chrony user is used to run chronyd as root\n* the chrony user has write permissions to the save location of the `.pid` file (e.g. `/run/chrony`)\n\nA successful symlink attack will enable the attacker to perform an unauthorized write as root using chronyd. This could allow data to be exfiltrated from other programs, or cause data corruption and a DoS condition.\n\nThis vulnerability is mitigated if chronyd is started via the systemd service with the `ProtectSystem=full` directive, which restricts writing to system file locations.",
    "publishedDate": "2020-08-21T16:05:52.994Z",
    "updatedDate": "2021-10-01T14:15:58.603Z",
    "disclosureDate": "2020-08-21T00:00:00.000Z",
    "exploitPublishDate": "2020-08-21T00:00:00.000Z",
    "solution": "Fixed in **[3.5.1](https://chrony.tuxfamily.org/download.html)** by [this](https://git.tuxfamily.org/chrony/chrony.git/commit/?id=f00fed20092b6a42283f29c6ee1f58244d74b545) commit.\n\nFixed in **[4.0-pre1](https://chrony.tuxfamily.org/download.html)** by these commits:\n* [Commit 1](https://git.tuxfamily.org/chrony/chrony.git/commit/?id=2fc8edacb810)\n* [Commit 2](https://git.tuxfamily.org/chrony/chrony.git/commit/?id=f4c6a00b2a11)\n* [Commit 3](https://git.tuxfamily.org/chrony/chrony.git/commit/?id=7a4c396bba8f)\n* [Commit 4](https://git.tuxfamily.org/chrony/chrony.git/commit/?id=e18903a6b563)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matthias Gerstner (SUSE)",
    "workaround": "",
    "vendorFixDate": "2020-08-06T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2139",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-61"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14367",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2139/ranges"
            },
            {
                "rel": "reference",
                "href": "https://chrony.tuxfamily.org/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://chrony.tuxfamily.org/news.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.tuxfamily.org/chrony/chrony.git/commit/?id=2fc8edacb810",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.tuxfamily.org/chrony/chrony.git/commit/?id=7a4c396bba8f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.tuxfamily.org/chrony/chrony.git/commit/?id=e18903a6b563",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.tuxfamily.org/chrony/chrony.git/commit/?id=f00fed20092b6a42283f29c6ee1f58244d74b545",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.tuxfamily.org/chrony/chrony.git/commit/?id=f4c6a00b2a11",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q3/130",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q3/130",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2139/default-remediation-status"
            }
        ]
    }
}