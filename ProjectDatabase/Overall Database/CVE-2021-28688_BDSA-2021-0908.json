{
    "source": "BDSA",
    "name": "BDSA-2021-0908",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) via 'blkback' Driver Persistent Grant Leak",
    "description": "The Linux Kernel, as used by Xen, is vulnerable to a denial-of-service (DoS) issue due to how specific pointers can be overwritten as a result of a fix for a previously reported DoS issue, [XSA-365](https://xenbits.xenproject.org/xsa/advisory-365.html).\n\nA privileged guest attacker, who is able to load a malicious driver, could cause resource leaks resulting in a host-wide DoS.",
    "technicalDescription": "The [XSA-365](https://xenbits.xenproject.org/xsa/advisory-365.html) fix initializes pointers in a way that cleanup code would not use uninitialized or stale values. This fix, however, can overwrite pointers which need to be cleaned up. This can result in the leaking of persistent grants, and prevent full clean up when a guest has died.",
    "publishedDate": "2021-04-09T15:45:11.938Z",
    "updatedDate": "2021-04-09T15:45:11.932Z",
    "disclosureDate": "2021-03-30T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.264**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=47b6b2742ee60334c40d75bfaab49028688f1510) commit\n* [**4.9.264**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3cb86952ce3c8b28a0c1f3ce82848618d8628015) commit\n* [**4.14.228**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=db108b67d81397cdbaf3f91aeca6e5eb5f71de1d) commit\n* [**4.19.184**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=16356ddb587867c2a5ab85407eeb75f2b8818207) commit\n* [**5.4.109**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=057dd3e6986b260f0bec68bd1f2cd23a5d9dbda3) commit\n* [**5.10.27**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3a1ca9bd4f5a647439e82e07b03d072781d9d180) commit\n* [**5.11.11**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=632b046bb6120afe1df1bfa06943bee338dd97db) commit\n* [**5.12-rc6**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a846738f8c3788d846ed1f587270d2f2e3d32432) commit\n\nThe latest stable releases are available [here](https://www.kernel.org).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.2,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 5.1,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:A/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.7,
        "severity": "HIGH",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nicolai Stange of SUSE",
    "workaround": "The vendor has suggested [here](https://xenbits.xenproject.org/xsa/advisory-371.html) that reconfiguring guests to use alternative (e.g. qemu-based) backends may avoid the vulnerability. Avoiding the use of persistent grants could also avoid the vulnerability. This can be achieved by passing the `feature_persistent=0` module option to the xen-blkback driver.",
    "vendorFixDate": "2021-03-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-0908",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-401"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-28688",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-0908/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=057dd3e6986b260f0bec68bd1f2cd23a5d9dbda3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=16356ddb587867c2a5ab85407eeb75f2b8818207",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3a1ca9bd4f5a647439e82e07b03d072781d9d180",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3cb86952ce3c8b28a0c1f3ce82848618d8628015",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=47b6b2742ee60334c40d75bfaab49028688f1510",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=632b046bb6120afe1df1bfa06943bee338dd97db",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a846738f8c3788d846ed1f587270d2f2e3d32432",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=db108b67d81397cdbaf3f91aeca6e5eb5f71de1d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-365.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-371.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-371.html",
                "label": "WORKAROUND"
            }
        ]
    }
}