{
    "source": "BDSA",
    "name": "BDSA-2019-0502",
    "title": "Systemd Vulnerable to Denial-of-Service (DoS) via Crafted D-Bus Message to 'bus_process_object()' Function",
    "description": "Systemd is vulnerable to denial-of-service (DoS) as it allocates memory on the stack based on the input provided in an attacker-controllable variable. A local attacker can leverage this flaw by sending a crafted D-Bus message on the system bus to cause a crash and kernel panic.",
    "technicalDescription": "This crash can be triggered from the `bus_process_object()` function of the `src/libsystemd/sd-bus/bus-objects.c` source file. The allocation of stack memory for the `prefix[pl+1]` buffer can be controlled by an attacker which can lead to problems. A local unprivileged attacker can send a crafted message which will effectively move the stack pointer outside of the bounds of currently mapped stack region. This will jump the stack guard page and make the pointer point to an unmapped page.\n\nThis can be done by sending a D-Bus message with an object path larger than roughly 32MB, which is not in line with the supposed limit of 128MB (`BUS_MESSAGE_SIZE_MAX`).\n\nReports indicate that it is not possible to make the stack pointer land in another mapped page which limits the practical impact to a denial-of-service (DoS).",
    "publishedDate": "2019-02-25T14:05:01.481Z",
    "updatedDate": "2019-05-14T15:39:04.916Z",
    "disclosureDate": "2019-02-18T00:00:00.000Z",
    "solution": "Fixed in [**242-rc1**](https://github.com/systemd/systemd/releases/tag/v242-rc1) by the following commits:\n\n* [Commit 1](https://github.com/systemd/systemd/commit/61397a60d98e368a5720b37e83f3169e3eb511c4)\n* [Commit 2](https://github.com/systemd/systemd/commit/f519a19bcd5afe674a9b8fc462cd77d8bad403c1)\n* [Commit 3](https://github.com/systemd/systemd/commit/6d586a13717ae057aa1b4127400c3de61cd5b9e7)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:N/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Chris Coulson (Ubuntu Security)",
    "workaround": "",
    "vendorFixDate": "2019-02-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0502",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-6454",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0502/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/commit/61397a60d98e368a5720b37e83f3169e3eb511c4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/commit/6d586a13717ae057aa1b4127400c3de61cd5b9e7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/commit/f519a19bcd5afe674a9b8fc462cd77d8bad403c1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/releases/tag/v242-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2019/02/18/3",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0502/default-remediation-status"
            }
        ]
    }
}