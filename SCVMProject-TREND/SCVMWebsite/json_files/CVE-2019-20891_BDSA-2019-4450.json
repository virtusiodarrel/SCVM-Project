{
    "source": "BDSA",
    "name": "BDSA-2019-4450",
    "title": "WordPress WooCommerce Plugin Vulnerable to Cross-Site Scripting (XSS) via Cross-Site Request Forgery (CSRF) in '.csv Product Import' Functionality",
    "description": "WooCommerce is vulnerable to cross-site scripting (XSS) due to a lack of cross-site request forgery (CSRF) checks during the import step of the product .csv import functionality.\n\nAn attacker could trick an admin user into viewing a malicious site and perform a CSRF attack to import the products or product updates contained in an uploaded .csv file into the WooCommerce shop.",
    "technicalDescription": "WooCommerce is vulnerable to cross-site scripting (XSS) because the .csv upload and import functionality used for creating new products or updating existing ones contains a cross-site request forgery (CSRF) flaw in the `import()` function within the `includes/admin/importers/class-wc-product-csv-importer-controller.php ` file.\n\nThe product import functionality checks the nonce for the initial upload of a file, but does not validate a nonce when the contents of the file are imported.\n\nWhen using a default WordPress installation, admins are able to insert unfiltered HTML into product descriptions. \n\nAttackers could take advantage of the lack of CSRF checks on the import step and the ability for admins to insert unfiltered HTML into descriptions to perform stored XSS attacks.\n\nTo perform a full attack, an attacker must first upload a malicious .csv file with a user role of author or higher. The attacker could then trick an admin user into viewing a malicious website to force the admin to submit the import request and inadvertently insert malicious HTML into the descriptions of new or existing products. \n\nThe stored XSS attack could execute in a victim's browser when they view an affected product, potentially stealing a victim's session tokens, cookies, or other sensitive information.",
    "publishedDate": "2020-06-25T11:41:10.800Z",
    "updatedDate": "2021-01-07T14:37:58.801Z",
    "disclosureDate": "2019-10-08T00:00:00.000Z",
    "solution": "Fixed in [**3.6.5**](https://github.com/woocommerce/woocommerce/releases/tag/3.6.5) by [this](https://github.com/woocommerce/woocommerce/commit/fd7feb778eb45a2eb92b45eb2b4ee96ea3ac6fe7) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dennis Brinkrolf",
    "workaround": "",
    "vendorFixDate": "2019-07-02T00:00:00.000Z",
    "vendorNotifiedDate": "2019-05-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4450",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20891",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4450/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.ripstech.com/2019/woocommerce-csrf-to-stored-xss/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/woocommerce/woocommerce/commit/fd7feb778eb45a2eb92b45eb2b4ee96ea3ac6fe7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/woocommerce/woocommerce/releases/tag/3.6.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://woocommerce.wordpress.com/2019/07/02/woocommerce-3-6-5-security-release/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4450/default-remediation-status"
            }
        ]
    }
}