{
    "source": "BDSA",
    "name": "BDSA-2019-0219",
    "title": "Spring Batch Vulnerable to XML External Entity (XXE) Injection via Unsafe 'XmlInputFactory' Defaults",
    "description": "Spring Batch is vulnerable to XML external entity (XXE) injection as it does not disable external entity expansion in the `XmlInputFactory` settings by default. An attacker can leverage this flaw by sending crafted XML input to the server which may trick the XML parser into performing arbitrary operations on local resources that the attacker should not be able to control. This can lead to several problems ranging from an attacker being able to run stealth scans by bypassing the firewall, through sensitive information disclosure and denial-of-service (DoS), to server side request forgery (SSRF).",
    "technicalDescription": "An attacker can send a crafted request with XML code that references the server's local resources via a `file://` URI to access resources beyond the intended sphere of control. This allows an attacker to access arbitrary files located on the server or induce a denial-of-service (DoS) condition.\n\nIt is also possible to use the vulnerable server as a pivot to bypass the firewall and reach into the internal network which is not normally accessible from the public internet. This can be leveraged to run reconnaissance on the internal systems or to perform other attacks that abuse the trust relationship with the server.",
    "publishedDate": "2019-01-25T15:43:45.380Z",
    "updatedDate": "2019-05-14T15:32:03.054Z",
    "disclosureDate": "2019-01-14T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.0.10**](https://github.com/spring-projects/spring-batch/releases) by [this](https://github.com/spring-projects/spring-batch/commit/c7930184ee4513d548940550c4eb5eeef028cb64) commit,\n* [**4.0.2**](https://github.com/spring-projects/spring-batch/releases) by [this](https://github.com/spring-projects/spring-batch/commit/8dc3bb7d3c3d0b1487e3ef3dcbdebda865d2b20e) commit, and\n* [**4.1.1**](https://github.com/spring-projects/spring-batch/releases) by [this](https://github.com/spring-projects/spring-batch/commit/a6d8ac1b44afeca1bb572718ceacac774a368422) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-01-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0219",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-611"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3774",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0219/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-batch/commit/8dc3bb7d3c3d0b1487e3ef3dcbdebda865d2b20e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-batch/commit/a6d8ac1b44afeca1bb572718ceacac774a368422",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-batch/commit/c7930184ee4513d548940550c4eb5eeef028cb64",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-batch/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://pivotal.io/security/cve-2019-3774",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0219/default-remediation-status"
            }
        ]
    }
}