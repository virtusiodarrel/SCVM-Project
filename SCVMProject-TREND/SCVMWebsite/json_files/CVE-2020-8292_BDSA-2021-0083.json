{
    "source": "BDSA",
    "name": "BDSA-2021-0083",
    "title": "Rocket.Chat Vulnerable to Session Hijack via Self-XSS",
    "description": "Rocket.Chat is vulnerable to self cross-site scripting (XSS) via drag and drop image functionality. An attacker could trick a victim user into carrying out a self-XSS in order to perform actions on the victim's behalf, or steal session tokens, cookies, or other sensitive information. Account lockout may also be possible via manipulation of two factor authentication (2FA) settings",
    "technicalDescription": "This issue occurs in the `dropzoneEvents` function within the `app/ui/client/views/app/room.js` file due to improper validation. It was mitigated by the addition of sanity checks relating to `imgURL` and strengthening of checks relating to `e.dataTransfer.types`.",
    "publishedDate": "2021-01-18T16:03:13.648Z",
    "updatedDate": "2021-01-27T11:13:51.432Z",
    "disclosureDate": "2021-01-17T00:00:00.000Z",
    "exploitPublishDate": "2021-01-17T00:00:00.000Z",
    "solution": "Fixed in [**3.9.0-rc.0**](https://github.com/RocketChat/Rocket.Chat/releases/tag/3.9.0-rc.0) by [this](https://github.com/RocketChat/Rocket.Chat/commit/c028b6b6f33b8f0aca2cf41041bebad01a6bbda7) commit.\n\nThe latest stable releases are available [here](https://github.com/RocketChat/Rocket.Chat/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jorge Cardona (jcardona)",
    "workaround": "",
    "vendorFixDate": "2020-11-20T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0083",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8292",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0083/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat/commit/c028b6b6f33b8f0aca2cf41041bebad01a6bbda7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat/releases/tag/3.9.0-rc.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/962902",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/962902",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0083/default-remediation-status"
            }
        ]
    }
}