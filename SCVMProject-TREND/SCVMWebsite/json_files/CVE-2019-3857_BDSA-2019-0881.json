{
    "source": "BDSA",
    "name": "BDSA-2019-0881",
    "title": "libssh2 Vulnerable to Denial-of-Service (DoS) via Integer Overflow in '_libssh2_packet_add()' Function",
    "description": "LibSSH2 is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause a victim's instance of the application to crash by tricking them into connecting to a malicious server.",
    "technicalDescription": "The function `_libssh2_packet_add()`, defined within `packet.c`, contains code that is used to construct a new packet. This function is called whenever the transport layer has received a packet, the data of which is pointed to by the `data` variable. A portion of the data is assigned to the unsigned integer variable `namelen`; the value of `namelen + 1` is then used to dynamically allocate a section of memory via the function `LIBSSH2_ALLOC`. If the value of `namelen` is the maximum value for an unsigned integer, the `namelen + 1` addition operation will cause an integer overflow. This could result in the allocation of zero bytes of memory, or an out of bounds write. This will raise an exception, halting program execution. An attacker could cause a DoS by tricking a victim into connecting to a malicious server that will supply packets in which the `namelen` data section will correspond to the maximum value of an unsigned integer.",
    "publishedDate": "2019-04-01T14:54:05.197Z",
    "updatedDate": "2019-04-01T14:54:05.178Z",
    "disclosureDate": "2019-03-11T00:00:00.000Z",
    "solution": "Fixed in version [**1.8.1**](https://github.com/libssh2/libssh2/releases/tag/libssh2-1.8.1) by [this](https://github.com/libssh2/libssh2/commit/c286e4d82f24def116d9679cb2453948f74e8183) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Chris Coulson",
    "workaround": "",
    "vendorFixDate": "2019-03-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0881",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3857",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0881/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libssh2/libssh2/commit/c286e4d82f24def116d9679cb2453948f74e8183",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libssh2/libssh2/releases/tag/libssh2-1.8.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.libssh2.org/CVE-2019-3857.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0881/default-remediation-status"
            }
        ]
    }
}