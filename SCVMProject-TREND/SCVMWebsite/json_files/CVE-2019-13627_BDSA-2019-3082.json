{
    "source": "BDSA",
    "name": "BDSA-2019-3082",
    "title": "libgcrypt Vulnerable to Information Disclosure via Timing Side Channel",
    "description": "libgcrypt is vulnerable to information disclosure due to the presence of a timing side channel. An attacker could discern potentially sensitive information relating to cryptographic processes involving elliptic curves by measuring the time taken to complete certain computations.",
    "technicalDescription": "The functions `_gcry_ecc_ecdsa_sign()` and `_gcry_mpi_ec_mul_point()` are used by libgcrypt for conducting cryptographic operations relating to elliptic curves. These functions are defined within the scripts `ecc-ecdsa.c ` and `ec.c`, respectively. The function `_gcry_ecc_ecdsa_sign()` uses the variable `k` to perform the elliptic curve digital signature signing process, which is calculated using the variable `skey->E.n`. A mathematical requirement of the algorithm used in the signing process is that `0  <  k  <  (skey->E.n)`. However, this is not properly enforced by the function. This can lead to measurable timing differences between subsequent evaluations of the algorithm, which can leak information about the values being used. \n\nThe function `_gcry_mpi_ec_mul_point()`calculates the value of the variable `nbits` by calling `mpi_get_nbits (scalar)`. However, `mpi_get_nbits ()` should only be called within an argument of `scalar` if the values of `scalar` and `ctx->p` are such that the result of `mpi_cmp (scalar, ctx->p)` is greater than, or equal to, zero. If this is not the case, `nbits` should be calculated by calling `mpi_get_nbits` with an argument of `ctx->p`. The application fails to make this distinction, and will always use `scalar` as the argument. This, again, can result in measurable differences in the time taken to complete certain mathematical operations.\n\nThe vulnerable function was introduced with [this](https://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=commitdiff;h=164eb8c85d773ef4f0939115ec45f5e4b47c1700) commit.\n\nAn attacker could therefore discern potentially sensitive information relating to cryptographic processes involving elliptic curves by measuring the time taken to complete certain computations.",
    "publishedDate": "2019-09-26T13:54:15.120Z",
    "updatedDate": "2019-09-26T13:54:15.094Z",
    "disclosureDate": "2019-09-03T00:00:00.000Z",
    "solution": "Fixed in version [**1.8.5**](https://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=tag;h=refs/tags/libgcrypt-1.8.5) by [this](https://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=commit;h=b9577f7c89b4327edc09f2231bc8b31521102c79) commit and [this](https://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=commit;h=7c2943309d14407b51c8166c4dcecb56a3628567) commit.\n\nThe latest stable release can be found [here](https://www.gnupg.org/download/index.html#libgcrypt).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.0,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.5,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.5
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-08-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3082",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13627",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3082/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/show_bug.cgi?id=1148987",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=commit;h=7c2943309d14407b51c8166c4dcecb56a3628567",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=commit;h=b9577f7c89b4327edc09f2231bc8b31521102c79",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=commitdiff;h=164eb8c85d773ef4f0939115ec45f5e4b47c1700",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=tag;h=refs/tags/libgcrypt-1.8.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.gnupg.org/download/index.html#libgcrypt",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3082/default-remediation-status"
            }
        ]
    }
}