{
    "source": "BDSA",
    "name": "BDSA-2021-4613",
    "title": "Nextcloud Vulnerable to Information Exposure via Path Traversal in 'getSvg' Function",
    "description": "Nextcloud is vulnerable to path traversal due to the insufficient validation of SVG file paths. A remote attacker could retrieve arbitrary SVG files from a vulnerable server by sending maliciously crafted requests to that server. An attacker could potentially leverage this issue to perform cross-site scripting (XSS) attacks, but only if Nextcloud's strict `Content-Security-Policy` enforcement (which is enabled by default) is disabled.",
    "technicalDescription": "The `getSvg()` function, of file `core/Controller/SvgController.php`, does not validate the value of its `$path` argument. This argument specifies the location of the SVG file that is to be retrieved. An attacker that is able to control the value of this argument could leverage this issue in order to retrieve arbitrary SVG files that reside on a vulnerable server. If Nextclouds default strict `Content-Security-Policy` settings are disabled, then the attacker could also leverage this issue to perform XSS attacks.",
    "publishedDate": "2022-09-13T15:45:10.538Z",
    "updatedDate": "2022-09-13T15:45:10.528Z",
    "disclosureDate": "2021-10-25T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**20.0.13-rc1**](https://github.com/nextcloud/server/releases/tag/v20.0.13rc1) by [this](https://github.com/nextcloud/server/commit/dd054b2ee84af84c4da6fb52a6f6b7311dd8bb72) commit and [this](https://github.com/nextcloud/server/commit/40f158503cda3ccc665eb7ab02593c6d42e0deb8) commit.\n* [**21.0.5-rc1**](https://github.com/nextcloud/server/releases/tag/v21.0.5rc1) by [this](https://github.com/nextcloud/server/commit/7dece11af05e7a2d41db919a8dee855f77ac915e) commit and [this](https://github.com/nextcloud/server/commit/39b15269c99a2b6d123ddb75b9c00c9356720dfd) commit.\n* [**22.2.0-rc2**](https://github.com/nextcloud/server/releases/tag/v22.2.0rc2) by [this](https://github.com/nextcloud/server/commit/3061f8a5299e872a88e4f35e9366cee84045d354) commit.\n\nThe latest stable releases can be found [here](https://github.com/nextcloud/server/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-09-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4613",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41178",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4613/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-jp9c-vpr3-m5rf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/3061f8a5299e872a88e4f35e9366cee84045d354",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/39b15269c99a2b6d123ddb75b9c00c9356720dfd",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/40f158503cda3ccc665eb7ab02593c6d42e0deb8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/7dece11af05e7a2d41db919a8dee855f77ac915e",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/dd054b2ee84af84c4da6fb52a6f6b7311dd8bb72",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v20.0.13rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v21.0.5rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v22.2.0rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4613/default-remediation-status"
            }
        ]
    }
}