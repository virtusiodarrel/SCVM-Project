{
    "source": "BDSA",
    "name": "BDSA-2021-4162",
    "title": "OpenProject Vulnerable to SQL Injection (SQLi) via 'reassign_to_id' Parameter",
    "description": "OpenProject is vulnerable to SQL injection (SQLi) due to improper validation of user supplied input. This could allow an attacker with the \"Edit budgets\" permission to run malicious or crafted SQL statements in order to obtain or modify information from application databases.",
    "technicalDescription": "This vulnerability exists in the file `modules/budgets/app/controllers/budgets_controller.rb` in the Ruby function `def update_belonging_work_packages` due to improper sanitization of user input through the `reassign_to_id` parameter. \n\nThis issue has been mitigated by applying a correct Rails finder to the method in order to automatically escape unwanted characters from the user input and prevent attempted SQL injection.",
    "publishedDate": "2022-03-02T13:37:20.571Z",
    "updatedDate": "2022-03-02T13:37:20.543Z",
    "disclosureDate": "2021-12-14T00:00:00.000Z",
    "solution": "Fixed in version [**12.0.4**](https://github.com/opf/openproject/releases/tag/v12.0.4) by [this](https://github.com/opf/openproject/commit/8fe86234263465c31ee40ed55f9e78d6034cf8c8) commit.\n\nThe latest stable releases can be found [here](https://github.com/opf/openproject/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Daniel Santos",
    "workaround": "",
    "vendorFixDate": "2021-12-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4162",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43830",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4162/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opf/openproject/commit/5008824622c19384ff48289b4552938405c82602",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opf/openproject/commit/8fe86234263465c31ee40ed55f9e78d6034cf8c8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opf/openproject/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opf/openproject/releases/tag/v12.0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opf/openproject/security/advisories/GHSA-f565-3whr-6m96",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4162/default-remediation-status"
            }
        ]
    }
}