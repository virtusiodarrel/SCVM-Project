{
    "source": "BDSA",
    "name": "BDSA-2022-0052",
    "title": "Node.js 'shelljs' Package Vulnerable to Privilege Escalation and Denial-of-Service (DoS) via 'shell.exec' Improper Privilege Management",
    "description": "ShellJS is vulnerable to privilege escalation and denial-of-service (DoS) issues due to how file permissions used by the internal implementation of `shell.exec()` are mishandled.\n\nIf ShellJS scripts running locally are using the ShellJS `exec()` function, an attacker with low-level privileges on the system could abuse the flaw in order to leak sensitive information, such as passwords, in order to perform local privilege escalation or shutdown privileged ShellJS processes.\n\nA vendor comment [here](https://github.com/shelljs/shelljs/issues/1058#issuecomment-1008657537) indicates that this issue only impacts the `synchronous` version of `shell.exec()`. All other ShellJS methods (including the `async` usage of `shell.exec()`) should not be impacted.",
    "technicalDescription": "ShellJS is vulnerable to privilege escalation and DoS conditions because the `stdout`, `stderr` and `paramsFile` files that are created when executing `execSync()` are not assigned sufficient read and write privileges, allowing local users on the filesystem access. \n\nAn attacker with low-level privileges could read the `stdout` of the running ShellJS process to disclose sensitive information, such as passwords (depending on the implementation). This could allow for local privilege escalation attacks. The attacker could also create these files before the `execSync()` process in order to trigger an `EACCESS` error and crash the ShellJS process.",
    "publishedDate": "2022-01-11T17:29:06.297Z",
    "updatedDate": "2022-01-11T17:29:06.283Z",
    "disclosureDate": "2022-01-07T00:00:00.000Z",
    "exploitPublishDate": "2022-01-07T00:00:00.000Z",
    "solution": "Fixed in [**0.8.5**](https://github.com/shelljs/shelljs/releases/tag/v0.8.5) by [this](https://github.com/shelljs/shelljs/commit/d919d22dd6de385edaa9d90313075a77f74b338c) commit.\n\nThe latest stable releases are available [here](https://www.npmjs.com/package/shelljs).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.3
        },
        "vector": "(AV:L/AC:M/Au:S/C:P/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "haxatron",
    "workaround": "",
    "vendorFixDate": "2022-01-07T00:00:00.000Z",
    "vendorNotifiedDate": "2021-12-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0052",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-0144",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0052/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shelljs/shelljs/commit/d919d22dd6de385edaa9d90313075a77f74b338c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shelljs/shelljs/issues/1058",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shelljs/shelljs/issues/1058#issuecomment-1008657537",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shelljs/shelljs/releases/tag/v0.8.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/50996581-c08e-4eed-a90e-c0bac082679c/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/50996581-c08e-4eed-a90e-c0bac082679c/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/shelljs",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0052/default-remediation-status"
            }
        ]
    }
}