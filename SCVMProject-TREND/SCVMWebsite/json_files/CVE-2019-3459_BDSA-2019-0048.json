{
    "source": "BDSA",
    "name": "BDSA-2019-0048",
    "title": "Linux Kernel Vulnerable to Information Disclosure via Type Confusion in 'l2cap_get_conf_opt' Function",
    "description": "Linux kernel's bluetooth implementation is vulnerable to information disclosure due to a missing type check when parsing configuration elements during an L2cap connection negotiation process. An attacker could leverage this flaw by sending a crafted response to the bluetooth adapter in order to obtain data from the lower bytes of a pointer to a buffer stored on the heap.",
    "technicalDescription": "This flaw lies in the `l2cap_get_conf_opt()` function of the `/net/bluetooth/l2cap_core.c` source file. The problem is that the `val` variable may be returned as two different value types, either a value or a pointer. If the length value received over bluetooth is 1, 2 or 4 then a value copied from an input buffer will be returned. If the length is different, the value will be returned as a pointer to the buffer by reference. The length value is dependent on the input received over bluetooth, and therefore attacker-controlled. The `val` parameter is subsequently used as either a value or a pointer depending on the `type` field. The problem is that `val` is assumed to match the type without an adequate check, allowing crafted input to cause type confusion.\n\nAn attacker can send a crafted response where e.g. the type is MTU (maximum transmission unit) and the length is 3 to trick the kernel into returning the 2 lower bytes of the pointer to the buffer as MTU value.\n\nSuch pointer information may be useful in exploiting other vulnerabilities in the kernel as it gives the attacker an insight into the memory layout.",
    "publishedDate": "2019-01-15T10:51:57.093Z",
    "updatedDate": "2019-08-07T14:14:56.078Z",
    "disclosureDate": "2019-01-11T00:00:00.000Z",
    "exploitPublishDate": "2019-01-11T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.16.66**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c5c6a5c7eb7e3d7859e7ec78a2872360e4bab6aa) commit,\n* [**3.18.138**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8f9c5ea93aa788302dddec8589aff079f9ac4bac) commit,\n* [**4.4.178**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d22036003893cbe479404e20fdae10addc6c18dd) commit,\n* [**4.9.167**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=def5c1fbee851e9c044ce9fa647238efc15458b4) commit,\n* [**4.14.110**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=82868814a87236b17ac588fbb779c87616e99345) commit,\n* [**4.19.33**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2318c0e4b87e590c9d8e88db185477cfac18abe2) commit,\n* [**5.0.6**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8dac9b8d27b504734429cb0be541425a216ccba2) commit, and\n* [**5.1-rc1**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=af3d5d1c87664a4f150fcf3534c6567cb19909b0) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:A/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ran Menscher, Shlomi Oberman, Yuli Shapiro and Karamba Security Ltd.",
    "workaround": "",
    "vendorFixDate": "2019-01-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0048",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-843"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3459",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0048/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2318c0e4b87e590c9d8e88db185477cfac18abe2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=82868814a87236b17ac588fbb779c87616e99345",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8dac9b8d27b504734429cb0be541425a216ccba2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8f9c5ea93aa788302dddec8589aff079f9ac4bac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=af3d5d1c87664a4f150fcf3534c6567cb19909b0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c5c6a5c7eb7e3d7859e7ec78a2872360e4bab6aa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d22036003893cbe479404e20fdae10addc6c18dd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=def5c1fbee851e9c044ce9fa647238efc15458b4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q1/58",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q1/58",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2018/10/31/6",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0048/default-remediation-status"
            }
        ]
    }
}