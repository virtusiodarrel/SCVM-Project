{
    "source": "BDSA",
    "name": "BDSA-2019-1198",
    "title": "Mercurial Vulnerable to Path Traversal via Improper Input Validation in Sub Repository Pathnames",
    "description": "An improper input validation vulnerability has been discovered in Mercurial. An attacker could exploit this vulnerability via path traversal techniques to bypass path logic validation and create new files outside the origin repository.",
    "technicalDescription": "A weakness has been discovered in Mercurial which can be manipulated by path traversal techniques. The functionality to create sub or clone parent repositories does not validate the user-supplied pathname values before proceeding. It is possible to inject arbitrary environment variables, such as `~` or `$foo` to force the application into creating repositories outside the intended root directory. \n\nThe functionality located in the file `mercurial/subrepo.py` did not do a sanity check against unsafe pathnames, before creating the sub-repository.",
    "publishedDate": "2019-04-25T10:34:56.114Z",
    "updatedDate": "2019-04-25T10:34:56.105Z",
    "disclosureDate": "2019-04-22T00:00:00.000Z",
    "solution": "Fixed in version [**4.9.0**](https://www.mercurial-scm.org/downloads) by the following commits:\n* [Commit 1](https://www.mercurial-scm.org/repo/hg/rev/31286c9282df)\n* [Commit 2](https://www.mercurial-scm.org/repo/hg/rev/6c10eba6b9cd)\n* [Commit 3](https://www.mercurial-scm.org/repo/hg/rev/83377b4b4ae0)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated: \n\"Users on older versions can either disable subrepositories with `[subrepos] allowed=false` in their configuration or by ensuring any cloned repositories don't contain malicious symlinks.\"",
    "vendorFixDate": "2019-01-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1198",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3902",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1198/ranges"
            },
            {
                "rel": "reference",
                "href": "https://www.mercurial-scm.org/downloads",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.mercurial-scm.org/repo/hg/rev/31286c9282df",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mercurial-scm.org/repo/hg/rev/6c10eba6b9cd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mercurial-scm.org/repo/hg/rev/83377b4b4ae0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mercurial-scm.org/wiki/WhatsNew#Mercurial_4.9_.282019-02-01.29",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mercurial-scm.org/wiki/WhatsNew#Mercurial_4.9_.282019-02-01.29",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1198/default-remediation-status"
            }
        ]
    }
}