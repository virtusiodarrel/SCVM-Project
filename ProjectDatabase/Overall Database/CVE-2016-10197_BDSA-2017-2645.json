{
    "source": "BDSA",
    "name": "BDSA-2017-2645",
    "title": "libevent Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Read with Empty Strings",
    "description": "libevent is vulnerable to denial-of-service (DoS) due to an out-of-bounds memory read issue in the DNS code. An attacker could exploit this vulnerability by supplying a system with maliciously crafted requests.",
    "technicalDescription": "libevent provides a mechanism to execute a callback function when a specific event occurs on a file descriptor or after a timeout has been reached. Furthermore, libevent also support callbacks due to signals or regular timeouts. libevent is meant to replace the event loop found in event driven network servers. An application just needs to call event_dispatch() and then add or remove events dynamically without having to change the event loop. libevent additionally provides a sophisticated framework for buffered network IO, with support for sockets, filters, rate-limiting, SSL, zero-copy file transmission, and IOCP. libevent includes support for several useful protocols, including DNS, HTTP, and a minimal RPC framework. libevent is used commonly in Mozilla products.\n\nSeaMonkey is an Internet suite offering a built in webbrowser, mail and other functionality. It is the continuation of the former Mozilla Application Suite, based on the same source code, which originated from Netscape Communicator and was the base for Netscape 6 and Netscape 7. Compared to Firefox, the SeaMonkey web browser keeps the far more traditional-looking interface of Netscape and the Mozilla Suite. Many Firefox and Thunderbird add-ons can be modified for compatiblity with SeaMonkey.\n* Firefox is a web browser, originally based on components that formed SeaMonkey.\n* Firefox Mobile is an Android-based browser, developed from the desktop Firefox webbrowser.\n* Thunderbird is a mail client, originally based on components that formed SeaMonkey.\n* Gecko is the HTML rendering engine used by Seamonkey, Firefox and Thunderbird.\n\nThe affected code will result in a denial-of-service when triggered if compiled with ASAN enabled:\n\n```\n3122 static char *\n3123 search_make_new(const struct search_state *const state, int n, const char *const base_name) {\n3124     const size_t base_len = strlen(base_name);\n3125     const char need_to_append_dot = base_name[base_len - 1] == '.' ? 0 : 1;\n```\n\nThis creates a zero-length string in poc.c:\n```\n    char* hostname = malloc(32);\n    memset(hostname, 0, 32);\n    //hostname[0] = 'x';\n```",
    "publishedDate": "2018-01-03T16:49:21.906Z",
    "updatedDate": "2020-09-15T10:29:23.669Z",
    "disclosureDate": "2017-04-19T00:00:00.000Z",
    "exploitPublishDate": "2017-04-19T00:00:00.000Z",
    "solution": "Fixed in:\n* Mozilla SeaMonkey [**2.49.1**](https://www.seamonkey-project.org/releases/)\n* Mozilla Firefox [**53**](https://www.getfirefox.com/)\n* Mozilla Thunderbird [**53**](https://www.getthunderbird.com/)\n* Mozilla Gecko [**52**](https://developer.mozilla.org/en-US/docs/Mozilla/Gecko/Gecko_SDK#Downloading)\n* libevent [**2.1.6**](https://github.com/libevent/libevent/)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Guido Vranken",
    "workaround": "",
    "vendorFixDate": "2017-04-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2645",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2016-10197",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2645/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1343453",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1343453",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://developer.mozilla.org/en-US/docs/Mozilla/Gecko/Gecko_SDK#Downloading",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libevent/libevent/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libevent/libevent/issues/332",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.getfirefox.com/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.getthunderbird.com/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.seamonkey-project.org/releases/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}