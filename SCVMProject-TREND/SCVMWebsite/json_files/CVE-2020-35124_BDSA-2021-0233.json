{
    "source": "BDSA",
    "name": "BDSA-2021-0233",
    "title": "Mautic Vulnerable to Stored Cross-Site Scripting (XSS) via Referrer Header in Asset Downloads",
    "description": "Mautic is vulnerable to stored cross-site scripting (XSS) due to a lack of sanitization of user supplied input. An attacker can exploit this to execute malicious scripts in the context of the browser, allowing the theft of session tokens, cookies and other sensitive information. This vulnerability also allows unauthorized creation of an account with elevated privileges.",
    "technicalDescription": "Scripts can be injected in the referrer header during asset downloads.",
    "publishedDate": "2021-01-28T14:24:37.275Z",
    "updatedDate": "2021-01-28T14:24:37.268Z",
    "disclosureDate": "2021-01-14T00:00:00.000Z",
    "solution": "Fixed in:\n* [**2.16.5**](https://github.com/mautic/mautic/releases/tag/2.16.5) by [this](https://github.com/mautic/mautic/compare/2.16.4...2.16.5.diff) patch\n* [**3.2.4**](https://github.com/mautic/mautic/releases/tag/3.2.4) by [this](https://github.com/mautic/mautic/compare/3.2.2...3.2.4.diff) patch",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Naveen Sunkavally, Horizon3.ai",
    "workaround": "Exploitation attempts can be detected by running the following database queries (replace `PREFIX` with your own):\n```\n> >select * from PREFIX_form_submissions where referer like '%<%' or referer like '%onerror%';\n> >select * from PREFIX_asset_downloads where referer like '%<%' or referer like '%onerror%';\n>select * from PREFIX_companies where companyname like '%<%' or companyname like '%onerror%';\n```\n\nDelete all entries that contain embedded HTML tags.",
    "vendorFixDate": "2021-01-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0233",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-35124",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0233/ranges"
            },
            {
                "rel": "reference",
                "href": "https://forum.mautic.org/t/security-release-for-all-versions-of-mautic-prior-to-2-16-5-and-3-2-4/17786",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/compare/2.16.4...2.16.5.diff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/compare/3.2.2...3.2.4.diff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/releases/tag/2.16.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/releases/tag/3.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mautic/mautic/security/advisories/GHSA-39wj-j3jc-858m",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mautic.org/blog/community/security-release-all-versions-mautic-prior-2-16-5-and-3-2-4",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0233/default-remediation-status"
            }
        ]
    }
}