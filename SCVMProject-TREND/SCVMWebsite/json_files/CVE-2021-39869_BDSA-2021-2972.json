{
    "source": "BDSA",
    "name": "BDSA-2021-2972",
    "title": "GitLab Vulnerable to Trigger Token Information Disclosure via Project Export Flaw",
    "description": "GitLab is vulnerable to an information disclosure issue due to how project export actions can export the pipeline triggers.\n\nThis issue could cause trigger tokens that have been configured on a project to be exposed to attackers.",
    "technicalDescription": "This vulnerability exists due to the ability for any user to configure a trigger token so that pipelines will be used to create CI/CD jobs on their own user context. This will allow an attacker with maintainer privileges to perform an export of the repository, which will subsequently leak all the trigger tokens created for all the other maintainers of the repository through the `project.json` file. \n\nTo remedy this issue, the vendor has removed the `:triggers` entry in the `lib/gitlab/import_export/project/import_export.yml ` file to disable the export of pipeline triggers during a project export.",
    "publishedDate": "2021-10-06T15:55:20.187Z",
    "updatedDate": "2022-09-30T09:29:15.162Z",
    "disclosureDate": "2021-09-30T00:00:00.000Z",
    "exploitPublishDate": "2021-12-21T00:00:00.000Z",
    "solution": "Fixed in:\n* [**14.3.1**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.3.1) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/e0ab280b774e34fcfd6fd031616247714230ca68) commit,\n* [**14.2.5**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.2.5) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/1f1c8394e03c3dab1e6505f221c662c2e4e47b69) commit,\n* [**14.1.7**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.1.7) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/3c992c78e972b8019ae49015d445524d654e4076) commit.\n\nThe latest stable releases are available [here](https://gitlab.com/gitlab-org/gitlab-foss/-/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "@mishre",
    "workaround": "",
    "vendorFixDate": "2021-09-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2972",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39869",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2972/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2021/09/30/security-release-gitlab-14-3-1-released/#exposure-of-trigger-tokens-on-project-exports",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-39869.json",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/1f1c8394e03c3dab1e6505f221c662c2e4e47b69",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/3c992c78e972b8019ae49015d445524d654e4076",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/e0ab280b774e34fcfd6fd031616247714230ca68",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.1.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.2.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/27044",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/27044",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2972/default-remediation-status"
            }
        ]
    }
}