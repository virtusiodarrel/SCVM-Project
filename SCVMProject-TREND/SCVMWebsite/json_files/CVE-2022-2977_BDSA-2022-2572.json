{
    "source": "BDSA",
    "name": "BDSA-2022-2572",
    "title": "Linux Kernel Vulnerable to Memory Corruption via Use-After-Free during Virtual Trusted Platform Module (TPM)  Device Handling",
    "description": "The Linux kernel is vulnerable to memory corruption due to the improper management of dynamically allocated memory resources. A local attacker could potentially modify, or disclose, sensitive data that resides in kernel memory by running a malicious binary on a vulnerable system. It should be noted that a non-default system configuration in which virtual TPM devices are enabled must be in place for this issue to be exploitable.",
    "technicalDescription": "The structure `struct tpm_chip` is used by the kernel to represent TPM chips. This structure is defined in the file `drivers/char/tpm/tpm.h`. One of the members of this structure is `dev`, which is a `struct device` instance. Another member is `cdev`, which is a `struct cdev` instance. The code which is used to implement virtualized TPM devices manages references to these members by calling functions such as `get_device()` and `cdev_device_del()`. This code also handles references to dynamically-allocated `struct tpm_chip` instances. The reference counting that is implemented by the virtualized TPM device handling code is flawed, such that live references to an object may exist even after that object has been freed. This can lead to a use-after-free event. An attacker could potentially leverage this in order to modify, or obtain, data that resides in kernel memory. This may allow the attacker to escalate their privileges to root.",
    "publishedDate": "2022-09-15T15:44:59.119Z",
    "updatedDate": "2022-09-15T15:45:19.897Z",
    "disclosureDate": "2022-03-21T00:00:00.000Z",
    "solution": "Fixed in version [**5.18-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9d8e7007dc7c4d7c8366739bbcd3f5e51dcd470f) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-03-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2572",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-2977",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2572/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9d8e7007dc7c4d7c8366739bbcd3f5e51dcd470f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9d8e7007dc7c4d7c8366739bbcd3f5e51dcd470f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2572/default-remediation-status"
            }
        ]
    }
}