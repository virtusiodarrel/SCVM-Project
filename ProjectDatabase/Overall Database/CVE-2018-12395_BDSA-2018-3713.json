{
    "source": "BDSA",
    "name": "BDSA-2018-3713",
    "title": "Firefox and Firefox ESR Vulnerable to Domain Restriction Bypass via Domain Fronting in WebExtension",
    "description": "Firefox and Firefox ESR are vulnerable to domain restrictions bypass due to an insufficient protection against header rewriting in the WebRequest API. An attacker could leverage this flaw to circumvent the intended domain restrictions and access blocked services via domain fronting technique.",
    "technicalDescription": "This flaw lies in the `/toolkit/modules/addons/WebRequest.jsm` source file due to insufficient validation of request headers. An attacker can set the `host` or `origin` headers to blocked domains to bypass the intended restrictions. This may allow them to access the domains that share a host that are otherwise restricted.",
    "publishedDate": "2018-10-25T10:32:55.707Z",
    "updatedDate": "2018-10-25T10:32:55.693Z",
    "disclosureDate": "2018-10-23T00:00:00.000Z",
    "solution": "Fixed in version [**63**](https://www.mozilla.org/en-GB/firefox/new/) of Firefox and version [**60.3**](https://www.mozilla.org/en-US/firefox/organizations/) of Firefox ESR by [this](https://hg.mozilla.org/mozilla-central/rev/72c957a8df54) and [this](https://hg.mozilla.org/mozilla-central/rev/203a8e58e64c) revision.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rob Wu, Andrew Swan",
    "workaround": "",
    "vendorFixDate": "2018-10-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3713",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-346"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-12395",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3713/ranges"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/203a8e58e64c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/72c957a8df54",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-GB/firefox/new/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/firefox/organizations/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2018-26/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2018-27/",
                "label": "ADVISORY"
            }
        ]
    }
}