{
    "source": "BDSA",
    "name": "BDSA-2021-2507",
    "title": "Bind Vulnerable to Denial-of-Service (DoS) via Reachable Assertion in Response Rate Limiting Functionality",
    "description": "Bind is vulnerable to denial-of-service (DoS) due to a reachable failure condition. A remote attacker could cause a vulnerable server to crash by sending a maliciously crafted request to that server, the response to which is larger than the MTU of the relevant interface.",
    "technicalDescription": "An ISC Bind server may attempt to send a DNS response using a packet that is larger than the MTU that is configured on the transmission interface. An assertion check is present with a condition that can detect this situation. The assertion check will fail in such cases if Response Rate Limiting (RRL) is enabled, halting program execution. The application may inadvertently attempt to send a packet with a size that exceeds the interface's MTU due to Path MTU discovery (PMTUD). This can cause the dynamic re-configuration of the MTU value for an IP interface. RRL is enabled by default for the `CHAOS` class view, but not for the `INTERNET` or for user-defined views. RRL must be enabled manually for these views in order for the vulnerability to manifest itself.\n\nAn attacker could potentially trigger the assertion failure, and cause a DoS, by sending maliciously crafted UDP traffic to a vulnerable server.\n\n**Note**: The original patch that was released for this vulnerability introduced an assertion failure issue. This issue only affects servers which use zones that are configured with the `masterfile-format map` option. This is a non-default configuration. Further information is available [here](https://kb.isc.org/docs/map-zone-format-incompatibility-in-bind-9-16-20-and-9-17-17).",
    "publishedDate": "2021-08-19T14:20:21.175Z",
    "updatedDate": "2021-08-26T11:13:50.226Z",
    "disclosureDate": "2021-08-18T00:00:00.000Z",
    "exploitPublishDate": "2021-08-18T00:00:00.000Z",
    "solution": "Fixed in version [**9.17.17**](https://gitlab.isc.org/isc-projects/bind9/-/tags/v9_17_17) by [this](https://gitlab.isc.org/isc-projects/bind9/-/commit/3b72aafd86afc2c17a13f2d966b022cf82452ca8) commit, and in [**9.16.20**](https://gitlab.isc.org/isc-projects/bind9/-/tags/v9_16_20) by [this](https://gitlab.isc.org/isc-projects/bind9/-/commit/82e0622e7d857383d50737588f3ec1d8d7232bb5) commit.\n\n**Note**: The aforementioned patches introduced an assertion failure for servers that use the `map` format for zone file storage. An additional patch for **9.17.17** which fixes that issue can be found [here](https://downloads.isc.org/isc/bind9/9.17.17/patches). An additional patch for **9.16.20** can be found [here](https://downloads.isc.org/isc/bind9/9.16.20/patches).\n\nThe latest stable releases can be found [here](https://gitlab.isc.org/isc-projects/bind9/-/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrey Blokhintsev",
    "workaround": "The vendor has stated that the following workaround is effective:\n\n> Disabling RRL in all views, including the built-in CHAOS class view \"_bind\", prevents the faulty assertion from being reached. This can be done by removing all existing `rate-limit` statements from `named.conf`, and defining a replacement for the default CHAOS view.",
    "vendorFixDate": "2021-08-10T00:00:00.000Z",
    "vendorNotifiedDate": "2021-07-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2507",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-617"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-25218",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2507/ranges"
            },
            {
                "rel": "reference",
                "href": "https://downloads.isc.org/isc/bind9/9.16.20/patches",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://downloads.isc.org/isc/bind9/9.17.17/patches",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/-/commit/3b72aafd86afc2c17a13f2d966b022cf82452ca8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/-/commit/82e0622e7d857383d50737588f3ec1d8d7232bb5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/-/issues/2839",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/-/issues/2839",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/-/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/-/tags/v9_16_20",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/-/tags/v9_17_17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://kb.isc.org/docs/map-zone-format-incompatibility-in-bind-9-16-20-and-9-17-17",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://kb.isc.org/v1/docs/cve-2021-25218",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://kb.isc.org/v1/docs/cve-2021-25218",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2507/default-remediation-status"
            }
        ]
    }
}