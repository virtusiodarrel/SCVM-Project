{
    "source": "BDSA",
    "name": "BDSA-2021-2857",
    "title": "PHP on Windows Vulnerable to Unauthorized Archive Extraction via 'php_zip_make_relative_path' Function",
    "description": "PHP on Windows systems is vulnerable to unauthorized archive extraction due to the improper processing of ZIP archives. This could allow an attacker to supply crafted ZIP archives containing files which are extracted to unintended locations outside of the destination directory.",
    "technicalDescription": "The issue exists in the function `php_zip_make_relative_path()` within the file `ext/zip/php_zip.c`, when called by `ZipArchive::extractTo()`. The function does not properly interpret file paths beginning with a slash, which on Windows systems are relative paths rather than absolute.",
    "publishedDate": "2021-09-27T14:12:47.637Z",
    "updatedDate": "2021-11-26T11:14:41.967Z",
    "disclosureDate": "2021-09-06T00:00:00.000Z",
    "solution": "Fixed in:\n* [**8.1.0RC3**](https://github.com/php/php-src/releases/tag/php-8.1.0RC3) and [**7.3.31**](https://github.com/php/php-src/releases/tag/php-7.3.31) by [this](https://github.com/php/php-src/commit/df2ceac25a43d72a0c25d3b415ae9eecc1ea195c) commit,\n* [**7.4.24**](https://github.com/php/php-src/releases/tag/php-7.4.24) by [this](https://github.com/php/php-src/commit/648dce9ea95b6d63685fe6efa88e7ef662a4819a) commit,\n* [**8.0.11**](https://github.com/php/php-src/releases/tag/php-8.0.11) by [this](https://github.com/php/php-src/commit/931bfc29ceb03265a45b4777992e9fc5ad7ee343) commit.\n\nThe latest stable releases are available [here](https://www.php.net/downloads).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-09-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2857",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21706",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2857/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=81420",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/648dce9ea95b6d63685fe6efa88e7ef662a4819a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/931bfc29ceb03265a45b4777992e9fc5ad7ee343",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/df2ceac25a43d72a0c25d3b415ae9eecc1ea195c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.3.31",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.4.24",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-8.0.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-8.1.0RC3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.php.net/downloads",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2857/default-remediation-status"
            }
        ]
    }
}