{
    "source": "BDSA",
    "name": "BDSA-2021-0416",
    "title": "Smarty Vulnerable to Remote Code Execution (RCE) via Insufficient Sanitization in Function Compilation Functionality",
    "description": "Smarty is vulnerable to a remote code execution (RCE) issue due to a lack of sufficient input sanitization on untrusted input in the function compilation functionality.\n\nAn attacker could use this issue by injecting crafted, executable commands in vulnerable fields in order to execute arbitrary code on the system.",
    "technicalDescription": "Smarty is vulnerable to remote code execution (RCE) because the `compile()` function in the `libs/sysplugins/smarty_internal_compile_function.php` file does not sufficiently sanitize the `name` attribute.\n\nAn attacker could use this flaw in cases where a function is called with `function name=` and allows unsanitized user data to be supplied in the `name` attribute.\n\nTo remedy this issue, the vendor has added validation to the `compile()` function to check if the supplied function name contains any invalid characters.",
    "publishedDate": "2021-02-22T12:39:17.332Z",
    "updatedDate": "2021-03-15T09:42:18.510Z",
    "disclosureDate": "2021-02-17T00:00:00.000Z",
    "exploitPublishDate": "2021-01-15T00:00:00.000Z",
    "solution": "Fixed in [**3.1.39**](https://github.com/smarty-php/smarty/releases/tag/v3.1.39) by [this](https://github.com/smarty-php/smarty/commit/165f1bd4d2eec328cfeaca517a725b46001de838) commit.\n\nThe latest stable releases are available [here](https://github.com/smarty-php/smarty/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-01-24T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0416",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-26120",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0416/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/blob/master/CHANGELOG.md#3139---2021-02-17",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/commit/165f1bd4d2eec328cfeaca517a725b46001de838",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smarty-php/smarty/releases/tag/v3.1.39",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://srcincite.io/pocs/cve-2021-26120.py.txt",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0416/default-remediation-status"
            }
        ]
    }
}