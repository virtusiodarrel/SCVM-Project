{
    "source": "BDSA",
    "name": "BDSA-2022-2657",
    "title": "Grafana Vulnerable to Privilege Escalation via Unpreserved Permissions with RBAC Re-Enabling",
    "description": "Grafana is vulnerable to privilege escalation due to the improper preservation of permissions during migrations that occur when RBAC is disabled then later re-enabled. This could allow an attacker to edit folders and dashboards that should be restricted to Admin users if they have Editor privileges, or view such content if they have Viewer privileges.",
    "technicalDescription": "",
    "publishedDate": "2022-09-23T14:18:24.594Z",
    "updatedDate": "2022-09-23T14:18:24.585Z",
    "disclosureDate": "2022-09-20T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**9.1.6**](https://github.com/grafana/grafana/releases/tag/v9.1.6) by [this](https://github.com/grafana/grafana/commit/c048378ad527edad1751166c1c247e63a1c9b989) commit,\n* [**9.0.9**](https://github.com/grafana/grafana/releases/tag/v9.0.9) by [this](https://github.com/grafana/grafana/commit/0a52f1bdf6a2329cebdcd634bdfb5aa2aa8d778c) commit,\n* [**8.5.13**](https://github.com/grafana/grafana/releases/tag/v8.5.13) by [this](https://github.com/grafana/grafana/commit/e258dde881bc820f836523a084ca8da45becf511) commit.\n\nThe latest stable releases are available [here](https://github.com/grafana/grafana/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.4,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "If upgrading to a fixed version cannot be performed immediately, the vendor recommends that if the impacted folder/dashboard is known, the additional permissions can be removed manually.",
    "vendorFixDate": "2022-09-20T00:00:00.000Z",
    "vendorNotifiedDate": "2022-08-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2657",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-281"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-36062",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2657/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/0a52f1bdf6a2329cebdcd634bdfb5aa2aa8d778c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/c048378ad527edad1751166c1c247e63a1c9b989",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/e258dde881bc820f836523a084ca8da45becf511",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/tag/v8.5.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/tag/v9.0.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/tag/v9.1.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/security/advisories/GHSA-p978-56hq-r492",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/security/advisories/GHSA-p978-56hq-r492",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2657/default-remediation-status"
            }
        ]
    }
}