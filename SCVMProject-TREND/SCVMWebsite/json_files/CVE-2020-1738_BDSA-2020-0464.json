{
    "source": "BDSA",
    "name": "BDSA-2020-0464",
    "title": "Ansible Vulnerable to Arbitrary Code Execution via Package or Service Modules",
    "description": "Ansible is vulnerable to remote code execution via an issue with the `package` and `service` modules.\n\nIt should be noted that in order to exploit this vulnerability, an attacker must be able to intercept communications with the target, or intercept what is executed on the target.",
    "technicalDescription": "The Ansible `package` and `service` modules use facts to determine the name of the module to run if the `use` parameter is not specified. An attacker could set the `ansible_facts['pkg_mgr']` and `ansible_facts['service_mgr']` facts to a different module name or to a malicious module installed in a collection which would allow them to perform arbitrary code execution.\n\nThe vendor does not intend to release a patch for this vulnerability, due to the exploitation requirements. An attacker must be able to intercept communications with the target, or intercept what is executed on the target. An attacker with this capability would already be able to alter payloads and control what is executed.",
    "publishedDate": "2020-03-19T12:24:54.370Z",
    "updatedDate": "2021-01-07T10:07:49.701Z",
    "disclosureDate": "2020-02-26T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 6.6
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Damien Aumaitre and Nicolas Surbayrole of Quarkslab",
    "workaround": "Specify the `use` parameter when possible if using the `package` and `service` modules. \n\nAvoid using Ansible collections on Ansible **2.8.8** or **2.7.17** or any prior versions as they don't reject python with no path (this is addressed in the **2.9.x** branch.)",
    "bdsaTags": [],
    "overallScore": 6.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0464",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-236"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-1738",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0464/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-1738",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-1738",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/issues/67796",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/pull/67808",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0464/default-remediation-status"
            }
        ]
    }
}