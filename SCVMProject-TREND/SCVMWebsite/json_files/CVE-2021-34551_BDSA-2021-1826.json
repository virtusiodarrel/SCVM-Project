{
    "source": "BDSA",
    "name": "BDSA-2021-1826",
    "title": "PHPMailer Vulnerable to Remote Code Execution (RCE) via Unsanitized 'lang_path'",
    "description": "PHPMailer, on systems that resolve UNC paths (typically Windows systems), is vulnerable to a remote code execution (RCE) issue due to a lack of sufficient sanitization of the `$lang_path` parameter in the `setLanguage()` function.\n\nAn attacker that is able to manipulate the `lang_path` value could set it to a UNC path in order to load a malicious script and execute arbitrary code.",
    "technicalDescription": "PHPMailer is vulnerable to remote code execution (RCE) because the `$lang_path` parameter used in the `setLanguage()` function within the `src/PHPMailer.php` file is not sufficiently sanitized. The issue stems from how translation files are treated as PHP code.\n\nTo remedy this issue, the vendor has made changes to process language files as plain text instead of PHP code to ensure that any code contained within will not be run.",
    "publishedDate": "2021-06-17T15:05:35.936Z",
    "updatedDate": "2022-06-16T13:21:12.726Z",
    "disclosureDate": "2021-06-16T00:00:00.000Z",
    "solution": "Fixed in [**6.5.0**](https://github.com/PHPMailer/PHPMailer/releases/tag/v6.5.0) by [this](https://github.com/PHPMailer/PHPMailer/commit/acd264bf17ff4ac5c915f0d4226dce8a9ea70bc3) commit.\n\nThe latest stable releases are available [here](https://github.com/PHPMailer/PHPMailer/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jilin Diting Information Technology Co., Ltd",
    "workaround": "",
    "vendorFixDate": "2021-06-16T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1826",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-34551",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1826/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPMailer/PHPMailer/blob/master/SECURITY.md",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPMailer/PHPMailer/commit/acd264bf17ff4ac5c915f0d4226dce8a9ea70bc3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPMailer/PHPMailer/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPMailer/PHPMailer/releases/tag/v6.5.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-7q44-r25x-wm4q",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1826/default-remediation-status"
            }
        ]
    }
}