{
    "source": "BDSA",
    "name": "BDSA-2021-2979",
    "title": "MediaWiki Loops Extension Vulnerable to Denial-of-Service (DoS) via Infinite Loop in 'maxLoopsPerformed' Function",
    "description": "The MediaWiki Loops Extension is vulnerable to denial-of-service (DoS) due to flaws within a parser function which allow an infinite loop to occur. An attacker could exploit this flaw to potentially cause excessive resource consumption, or to cause the application to become unresponsive. This will lead to a DoS.",
    "technicalDescription": "The vulnerability occurs in the `maxLoopsPerformed()` function within the `ExtLoops.php` file. The function mishandles the `egLoopsCountLimit` variable, which should limit a loop from executing more than 100 times. An attacker could exploit this flaw by creating a page containing `{{#while:|true|}}`, which will cause it to loop indefinitely, resulting in a php-fpm hang (DOS).",
    "publishedDate": "2022-01-28T10:49:26.828Z",
    "updatedDate": "2022-01-28T10:49:26.817Z",
    "disclosureDate": "2021-07-28T00:00:00.000Z",
    "solution": "Fixed by [this](https://gerrit.wikimedia.org/g/mediawiki/extensions/Loops/+/585b8ecdc708d60bb92fc7539f093dfcf4a7c477) commit in the **REL1_35** branch which has not yet been included in any release.\nFixed by [this](https://gerrit.wikimedia.org/g/mediawiki/extensions/Loops/+/8a4ab48ed6d464289c97d022998c8777fc68e7de) commit in the **REL1_36** branch which has not yet been included in any release.\nFixed by [this](https://gerrit.wikimedia.org/g/mediawiki/extensions/Loops/+/f68d05170bbab001d590387ddad957d5ca947bf2) commit in the **Master** branch which has not yet been included in any release.\n\nThe latest stable releases can be found [here](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-07-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2979",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-835"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-42040",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2979/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/g/mediawiki/extensions/Loops/+/585b8ecdc708d60bb92fc7539f093dfcf4a7c477",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/g/mediawiki/extensions/Loops/+/8a4ab48ed6d464289c97d022998c8777fc68e7de",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/g/mediawiki/extensions/Loops/+/f68d05170bbab001d590387ddad957d5ca947bf2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://phabricator.wikimedia.org/T287347",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2979/default-remediation-status"
            }
        ]
    }
}