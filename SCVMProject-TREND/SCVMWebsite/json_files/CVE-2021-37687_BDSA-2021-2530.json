{
    "source": "BDSA",
    "name": "BDSA-2021-2530",
    "title": "TensorFlow Vulnerable to Information Disclosure via Heap-Based Out-of-Bounds Read in Multiple Functions",
    "description": "TensorFlow is vulnerable to information disclosure due to the improper management of dynamic memory resources. A remote attacker could potentially recover sensitive information from heap memory by sending maliciously crafted requests to a vulnerable server. It may also be possible for an attacker to cause the application to crash.",
    "technicalDescription": "The function `GatherNdString()`, of file `tensorflow/lite/kernels/gather.cc`, has a parameter (`indices`) which is a pointer to an instance of the `TfLiteTensor` class. This tensor object references memory which stores a sequence of index values. These values are used to index into dynamically-allocated arrays. The values of the indices are insufficiently validated. If one or more of the values are negative, then an out-of-bounds access event could occur. A similar issue exists within the functions `Gather()` and `GatherStrings()` of file `tensorflow/lite/kernels/gather.cc`. This out-of-bounds array access could disclose the contents of heap memory, or could cause an exception to be raised. An attacker could therefore exploit this issue to obtain sensitive information or cause a denial-of-service (DoS).\n\nThe vulnerability was fixed by introducing code to each of the aforementioned functions which checks each of the index values and ensures that they are all positive.",
    "publishedDate": "2021-08-20T16:15:26.469Z",
    "updatedDate": "2021-08-20T16:15:26.454Z",
    "disclosureDate": "2021-08-11T00:00:00.000Z",
    "solution": "Fixed in versions: \n* [**2.6.0-rc2**](https://github.com/tensorflow/tensorflow/releases/tag/v2.6.0-rc2) by [this](https://github.com/tensorflow/tensorflow/commit/505138c3b77f60b0e3733f86073e767d5075799e) commit and [this](https://github.com/tensorflow/tensorflow/commit/ed68432912c300ef5d5fd988a1ead3d7ae045ad0) commit.\n* [**2.5.1**](https://github.com/tensorflow/tensorflow/releases/tag/v2.5.1) by [this](https://github.com/tensorflow/tensorflow/commit/c70494afa6987445d55065f083c9a9504989195a) commit and [this](https://github.com/tensorflow/tensorflow/commit/bdd8639efa25859acbd32609d9ea20dcda082058) commit.\n* [**2.4.3**](https://github.com/tensorflow/tensorflow/releases/tag/v2.4.3) by [this](https://github.com/tensorflow/tensorflow/commit/18b7471b8d6d2b116aa6cc92d7a360e386dad246) commit and [this](https://github.com/tensorflow/tensorflow/commit/eeea8946ef53294fb9047827d85f45313481e32f) commit.\n* [**2.3.4**](https://github.com/tensorflow/tensorflow/releases/tag/v2.3.4) by [this](https://github.com/tensorflow/tensorflow/commit/10c76c7a377586fcadf1e3d710425d940d57878a) commit and [this](https://github.com/tensorflow/tensorflow/commit/115ab14da6d342897b6bc290618dedb0ce341455) commit.\n\nThe latest stable releases can be found [here](https://github.com/tensorflow/tensorflow/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Yakun Zhang (Baidu Security)",
    "workaround": "",
    "vendorFixDate": "2021-07-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2530",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-37687",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2530/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/10c76c7a377586fcadf1e3d710425d940d57878a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/115ab14da6d342897b6bc290618dedb0ce341455",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/18b7471b8d6d2b116aa6cc92d7a360e386dad246",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/505138c3b77f60b0e3733f86073e767d5075799e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/bdd8639efa25859acbd32609d9ea20dcda082058",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/c70494afa6987445d55065f083c9a9504989195a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/ed68432912c300ef5d5fd988a1ead3d7ae045ad0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/eeea8946ef53294fb9047827d85f45313481e32f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.6.0-rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-jwf9-w5xm-f437",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2530/default-remediation-status"
            }
        ]
    }
}