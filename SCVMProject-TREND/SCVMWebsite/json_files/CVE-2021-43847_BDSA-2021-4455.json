{
    "source": "BDSA",
    "name": "BDSA-2021-4455",
    "title": "HumHub Vulnerable to Authorization Bypass via User-Controlled Key in 'Space Invite' Functionality",
    "description": "HumHub contains an authorization bypass vulnerability due to a lack of sufficient user key control. This could be exploited by an attacker with registered user privileges to gain access to private spaces, allowing for the potential disclosure of sensitive information held in private spaces.",
    "technicalDescription": "The URL endpoint generated by creating a private space is vulnerable to an insecure direct object reference (IDOR), allowing for the spaceId to be changed to any private space, regardless of permissions and ownership. \n\nThis was mitigated by adding a check in the following lines of code:\n\n```\n if (!$space->can(InviteUsers::class)) {\n            throw new HttpException(400, 'You are not allowed to invite users to the space!');\n        }\n```",
    "publishedDate": "2022-06-17T15:44:36.606Z",
    "updatedDate": "2022-06-17T15:44:36.590Z",
    "disclosureDate": "2021-12-14T00:00:00.000Z",
    "exploitPublishDate": "2021-12-14T00:00:00.000Z",
    "solution": "Fixed in version [**1.9.3**](https://github.com/humhub/humhub/releases/tag/v1.9.3) by [this](https://github.com/humhub/humhub/commit/2aae6542d1734688e836e1264c86683dc5fc9299) commit, and in version [**1.10.3**](https://github.com/humhub/humhub/releases/tag/v1.10.3) by [this](https://github.com/humhub/humhub/commit/46004a8670b5cbe1a6988d016a6f90b621422f7b) commit.\n\nThe latest stable releases can be found [here](https://github.com/humhub/humhub/tags).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Breno Vit\u00f3rio",
    "workaround": "",
    "vendorFixDate": "2021-12-14T00:00:00.000Z",
    "vendorNotifiedDate": "2021-12-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4455",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-639"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43847",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4455/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/humhub/humhub/commit/2aae6542d1734688e836e1264c86683dc5fc9299",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/humhub/humhub/commit/46004a8670b5cbe1a6988d016a6f90b621422f7b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/humhub/humhub/releases/tag/v1.10.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/humhub/humhub/releases/tag/v1.9.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/humhub/humhub/security/advisories/GHSA-f5hc-5wfr-7v74",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/humhub/humhub/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/943dad83-f0ed-4c74-ba81-7dfce7ca0ef2/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/943dad83-f0ed-4c74-ba81-7dfce7ca0ef2/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4455/default-remediation-status"
            }
        ]
    }
}