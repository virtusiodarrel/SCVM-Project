{
    "source": "BDSA",
    "name": "BDSA-2022-1983",
    "title": "RSSHub Vulnerable to Regular Expression Denial-of-Service (ReDoS) via Improper Input Validation for 'filter' and 'filterout' Parameters",
    "description": "RSSHub contains a vulnerability in its regular expression parsing process that can result in a denial-of-service (DoS). To exploit this flaw, an attacker can supply a crafted input that can cause excessive backtracking that will eventually exhaust the computing resources.",
    "technicalDescription": "This vulnerability exists because the application directly calls the `String.match()` method for checking user-supplied regular expressions received via the following parameters:`filter`, `filter_title`, `filter_description`, `filter_author`, `filterout`, `filterout_title`, `filterout_description`, and `filterout_author`. An attacker could exploit this flaw by supplying a malicious regular expression, like `([^<>'\"]+)*\"<`,  that will cause excessive backtracking when it's being parsed. This will subsequently result in a denial-of-service. This vulnerability will not be exploitable if additional access control has been applied. \n\nThis issue has been fixed in `lib/middleware/parameter.js` file by using `re2` library for safely parsing regular expressions instead of `RegExp()` function.\n\n**Note:** This vulnerability exists because no timeout has been enforced for this operation. However, the downtime for each attack can be limited by enforcing an external watchdog or timeout. In this case, the RSSHub will still need to be terminated first before it is resumed.\n\n**Note:** This vulnerability was originally introduced by [this](https://github.com/DIYgod/RSSHub/commit/4671720f4c5e1aaaad8fcc1dce684b6546baf2ff) commit back in February 2020. After being fixed, it was subsequently reintroduced with the addition of [this](https://github.com/DIYgod/RSSHub/commit/e4478a366ce179671c4f1bd2f0cff95985da44ea) and [this](https://github.com/DIYgod/RSSHub/commit/dc64debaf77f57b593f7b2a451298f350a084a97) commits. These commits were introduced for backward compatibility and they allow instance maintainers to switch back to the vulnerable regular expression engine. Since they were approved by the repository maintainer, the reporter has chosen not to consider this a vulnerability.",
    "publishedDate": "2022-07-21T13:41:35.647Z",
    "updatedDate": "2022-07-21T13:41:35.635Z",
    "disclosureDate": "2022-06-22T00:00:00.000Z",
    "exploitPublishDate": "2022-06-26T00:00:00.000Z",
    "solution": "Fixed in [**1.0.0-master.5c41774**](https://www.npmjs.com/package/rsshub/v/1.0.0-master.5c41774) by [this](https://github.com/DIYgod/RSSHub/commit/5c4177441417b44a6e45c3c63e9eac2504abeb5b) commit.\n\nThe latest stable releases are available [here](https://www.npmjs.com/package/rsshub).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rongronggg9",
    "workaround": "The following workarounds have been suggested:\n* Drop the regular expression match feature completely and roll back to string match.\n* Enforce additional permission check when accepting user-supplied regular expressions.\n* Migrate to a backtracking-free regular expression engine.\n* Enforce a timeout when performing a regular expression match (although this won't necessarily fix the problem).\n* Disable the feature by default and require each instance maintainer to manually enable it (although this won't necessarily fix the problem).",
    "vendorFixDate": "2022-06-21T00:00:00.000Z",
    "discoveryDate": "2022-06-21T00:00:00.000Z",
    "vendorNotifiedDate": "2022-06-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1983",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31110",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1983/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DIYgod/RSSHub/commit/4671720f4c5e1aaaad8fcc1dce684b6546baf2ff",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DIYgod/RSSHub/commit/5c4177441417b44a6e45c3c63e9eac2504abeb5b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DIYgod/RSSHub/commit/dc64debaf77f57b593f7b2a451298f350a084a97",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DIYgod/RSSHub/commit/e4478a366ce179671c4f1bd2f0cff95985da44ea",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DIYgod/RSSHub/issues/10045",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DIYgod/RSSHub/issues/10045",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DIYgod/RSSHub/issues/10045",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DIYgod/RSSHub/security/advisories/GHSA-jvxx-v45p-v5vf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/rsshub",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/rsshub/v/1.0.0-master.5c41774",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1983/default-remediation-status"
            }
        ]
    }
}