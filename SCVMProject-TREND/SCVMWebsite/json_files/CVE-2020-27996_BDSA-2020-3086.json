{
    "source": "BDSA",
    "name": "BDSA-2020-3086",
    "title": "SmartStoreNET Vulnerable to Remote Code Execution (RCE) via Deserialization of Untrusted Data",
    "description": "SmartStoreNET is vulnerable to a remote code execution (RCE) issue due to how the custom deserialization process that is performed on untrusted data can mishandle specific forged object types.\n\nAn attacker could abuse this issue by first uploading a crafted .NET assembly, and then in submitting a crafted request using a forged object type, request the uploaded file to execute its payload.",
    "technicalDescription": "SmartStoreNet is vulnerable to remote code execution (RCE) because the `CustomProperties` deserialization process that is performed on user-supplied request data does not sufficiently protect against the deserialization of forged objects. This process is intended to be run in order to build the `CustomProperties` dictionary from a supplied object.\n\nWhile an attacker may try to send forged requests containing different object types, there are limitations set in place by the custom deserialization process. In a forged request:\n1. only the root object type can be specified. The deserialization function does not support the handling of custom types for properties,\n2. the type must have a public parameterless constructor, and\n3. the constructor should not demand 'Single-Threaded-Apartment' (STA).\n\nThe type `System.Configuration.Install.AssemblyInstaller` can be used to avoid the restrictions, but this attack method requires a crafted .NET assembly to be uploaded beforehand. The file could potentially be uploaded using the avatar image functionality, given that it is enabled.",
    "publishedDate": "2020-10-30T17:01:57.500Z",
    "updatedDate": "2021-01-28T14:22:48.970Z",
    "disclosureDate": "2020-11-17T00:00:00.000Z",
    "exploitPublishDate": "2020-11-17T00:00:00.000Z",
    "solution": "Fixed in [**4.1.0**](https://github.com/smartstore/SmartStoreNET/releases/tag/4.1.0) by [this](https://github.com/smartstore/SmartStoreNET/commit/8702c6140f4fc91956ef35dba12d24492fb3f768) commit.\n\nThe latest stable releases are available [here](https://github.com/smartstore/SmartStoreNET/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "JarLob",
    "workaround": "A workaround is suggested [here](https://github.com/smartstore/SmartStoreNET/security/advisories/GHSA-r582-pv79-8f8v):\n* Disable all user upload possibilities > avatar uploads & attribute uploads.",
    "vendorFixDate": "2020-08-26T00:00:00.000Z",
    "vendorNotifiedDate": "2020-07-27T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3086",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27996",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3086/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smartstore/SmartStoreNET/commit/8702c6140f4fc91956ef35dba12d24492fb3f768",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smartstore/SmartStoreNET/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smartstore/SmartStoreNET/releases/tag/4.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smartstore/SmartStoreNET/security/advisories/GHSA-r582-pv79-8f8v",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/smartstore/SmartStoreNET/security/advisories/GHSA-r582-pv79-8f8v",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://securitylab.github.com/advisories/GHSL-2020-138-139-SmartstoreAG-SmartStoreNET",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://securitylab.github.com/advisories/GHSL-2020-138-139-SmartstoreAG-SmartStoreNET",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3086/default-remediation-status"
            }
        ]
    }
}