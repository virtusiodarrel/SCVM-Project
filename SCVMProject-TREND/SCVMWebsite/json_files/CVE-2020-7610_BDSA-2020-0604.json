{
    "source": "BDSA",
    "name": "BDSA-2020-0604",
    "title": "Bson Vulnerable to Deserialization of Untrusted Data via '_bsotype' Value",
    "description": "Bson contains a deserialization of untrusted data vulnerability due to improper handling of user input. An attacker could exploit this vulnerability through specially crafted input which could lead to the application treating the input in a way it was not intended, such as data disclosure.",
    "technicalDescription": "The `serializeInto` function in `lib/bson/parser/serializer.js` allows objects which have an unknown `_bsontype` value to be serialized as a document instead of the intended BSON type. An attacker could exploit this vulnerability by sending a specially crafted object that will be serialized in an unintended way and result in unexpected behavior such as data disclosure.\n\nMultiple CVEs have been assigned for this vulnerability.",
    "publishedDate": "2020-04-01T15:36:50.134Z",
    "updatedDate": "2020-04-01T15:36:50.125Z",
    "disclosureDate": "2020-03-24T00:00:00.000Z",
    "solution": "Fixed in version [**1.1.4**](https://github.com/mongodb/js-bson/releases/tag/v1.1.4) by [this](https://github.com/mongodb/js-bson/commit/3809c1313a7b2a8001065f0271199df9fa3d16a8) commit.\n\nFixed in version [**4.0.2**](https://github.com/mongodb/js-bson/releases/tag/v4.0.2) by [this](https://github.com/mongodb/js-bson/commit/f4b16d91e969508c6b77b7e1f7b62bc2bc37b126) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Feng Xiao (xiaofen9)",
    "workaround": "",
    "vendorFixDate": "2019-11-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0604",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7610",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0604/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/js-bson/commit/3809c1313a7b2a8001065f0271199df9fa3d16a8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/js-bson/commit/f4b16d91e969508c6b77b7e1f7b62bc2bc37b126",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/js-bson/releases/tag/v1.1.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/js-bson/releases/tag/v4.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jira.mongodb.org/browse/NODE-2514",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-BSON-561052",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0604/default-remediation-status"
            }
        ]
    }
}