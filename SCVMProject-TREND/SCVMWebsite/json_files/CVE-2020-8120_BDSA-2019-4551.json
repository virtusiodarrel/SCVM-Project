{
    "source": "BDSA",
    "name": "BDSA-2019-4551",
    "title": "Nextcloud Vulnerable to Reflected Cross-Site Scripting (XSS) via 'colorizeSvg' function",
    "description": "Nextcloud contains a reflected cross-site scripting (XSS) vulnerability due to the insufficient escaping of values during Scalable Vector Graphics (SVG) image generation. This can allow an attacker to execute malicious scripts in the context of the browser, allowing the theft of session tokens, cookies or other sensitive information. The attacker can also spoof web content.\n\nIt should be noted that an attacker can only conduct a XSS attack if they are able to bypass the target browser's Content Security Policy (CSP).",
    "technicalDescription": "This vulnerability is present in the `colorizeSvg()` function of the `lib/private/Template/IconsCacher.php` file in Nextcloud Server. The `color` parameter supplied by the user is neither validated or escaped, and so an attacker can use it to inject malicious scripts.\n\nThe vendor has mitigated against this by adding a regular expression filter for the `color` parameter, and including a fall back in case of error.",
    "publishedDate": "2020-08-11T11:02:17.049Z",
    "updatedDate": "2021-10-19T09:59:51.122Z",
    "disclosureDate": "2019-08-29T00:00:00.000Z",
    "solution": "Fixed in: \n* [**16.0.2RC1**](https://github.com/nextcloud/server/releases/tag/v16.0.2RC1) by [this](https://github.com/nextcloud/server/pull/16089/commits/1066e4a95224fb334b2c1efe555e6586621173bc) commit,\n* [**15.0.9RC1**](https://github.com/nextcloud/server/releases/tag/v15.0.9RC1) by [this](https://github.com/nextcloud/server/pull/16090/commits/fdc532f75307fa494acccf23ba2c781062d1178a) commit,\n* [**14.0.13RC1**](https://github.com/nextcloud/server/releases/tag/v14.0.13RC1) by [this](https://github.com/nextcloud/server/pull/16096/commits/5cb0d4a75b84803e8694358edaf9c036a7c82b70) commit.\n\nThe latest stable releases are also available [https://nextcloud.com/install/#].",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.0,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 1.0,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Frederik Braun",
    "workaround": "",
    "vendorFixDate": "2019-06-25T00:00:00.000Z",
    "vendorNotifiedDate": "2019-06-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4551",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8120",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4551/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/pull/16021/commits/05381f00d25e380c557a3a1100dd83e75298f130",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/pull/16089/commits/1066e4a95224fb334b2c1efe555e6586621173bc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/pull/16090/commits/fdc532f75307fa494acccf23ba2c781062d1178a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/pull/16096/commits/5cb0d4a75b84803e8694358edaf9c036a7c82b70",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v14.0.13RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v15.0.9RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v16.0.2RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v17.0.0beta1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/605915",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://nextcloud.com/install/#",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4551/default-remediation-status"
            }
        ]
    }
}