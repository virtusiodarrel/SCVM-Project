{
    "source": "BDSA",
    "name": "BDSA-2019-5092",
    "title": "Singularity Vulnerable to Malicious Container Execution and Information Disclosure via Insecure Permissions",
    "description": "Singularity is vulnerable to an insecure file permissions issue due to how user configurations and cache directories are created.\n\nThis issue could allow an attacker with login access to the host system to read potentially sensitive information from cached containers. For Singularity **>=3.3.0**, an attacker could also abuse the permissions flaw to inject a configuration file in order to execute malicious container images.",
    "technicalDescription": "The container execution and information disclosure issues are present because Singularity incorrectly creates the `$HOME/.singularity` directory with insecure permissions. This directory holds user configurations and caches.\n\nIn Singularity **>=2.4.0** (on all OS / Kernels), the `$HOME/.singularity` directory and any explicit `SINGULARITY_CACHEDIR` directories are incorrectly created with `755`, or `umask` dependent permissions. If a user's `$HOME` directory or the directory containing an explicitly set `SINGULARITY_CACHEDIR` has group/any executable permissions set, then an attacker with login access to the host system could read the content of a user's cached containers.\n\nIn Singularity **>=3.3.0** (on all OS / Kernels), the `$HOME/.singularity` directory is incorrectly created with `777` permissions. In addition to accessing cached container content, an attacker could inject a `remote.yaml` configuration file that can direct interactions with Sylabs cloud services to a malicious server in order to execute malicious container images.\n\n**Note**: If no user `$HOME` directories have group/any `x` bits set, and `SINGULARITY_CACHEDIR` has never been set to a location open to shared access, the exploits are not possible. If Singularity is configured to only run containers signed with keys specified in an execution control list, arbitrary malicious containers cannot be run with a `remote.yaml` exploit.",
    "publishedDate": "2021-03-26T10:22:25.360Z",
    "updatedDate": "2021-03-26T10:22:25.353Z",
    "disclosureDate": "2019-12-17T00:00:00.000Z",
    "solution": "Fixed in [**3.5.2**](https://github.com/hpcng/singularity/releases/tag/v3.5.2) by [this](https://github.com/hpcng/singularity/commit/2cda4981812c29f0fb11d3ea6aaf6139f665a631) commit. \n\n**Note**: The vendor has [stated](https://github.com/hpcng/singularity/releases/tag/v3.5.2) that in addition to installing the latest version, `chmod 700` should be run against the `.singularity` directory within all user `$HOME` directories, especially if `$HOME` directories may have group/any `x` bits set.\n\nThe latest stable releases are available [here](https://github.com/hpcng/singularity/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Stuart Barkley",
    "workaround": "The vendor has made available patches that can be applied to the **3.1**, **2.6**, **2.5** and **2.4** series:\n* [**3.1**](https://repo.sylabs.io/security/2019/CVE-2019-19724-31.diff)\n* [**2.6 / 2.5 / 2.4**]( https://repo.sylabs.io/security/2019/CVE-2019-19724-2x.diff)\n\nThe vendor has [stated](https://github.com/hpcng/singularity/releases/tag/v3.5.2) that prior versions of Singularity may be subject to additional security issues that were addressed by further patches released previously. Users will need to review the release history carefully before using a deprecated version of Singularity.",
    "vendorFixDate": "2019-12-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5092",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-276"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19724",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5092/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/blob/master/CHANGELOG.md#v352---20191217",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/commit/2cda4981812c29f0fb11d3ea6aaf6139f665a631",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases/tag/v3.5.2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases/tag/v3.5.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases/tag/v3.5.2",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://repo.sylabs.io/security/2019/CVE-2019-19724-2x.diff",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://repo.sylabs.io/security/2019/CVE-2019-19724-31.diff",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5092/default-remediation-status"
            }
        ]
    }
}