{
    "source": "BDSA",
    "name": "BDSA-2021-0825",
    "title": "curl Vulnerable to Information Disclosure via Automatic Population of Referer Header",
    "description": "If configured in a certain way, curl does not strip off user credentials from the URL when automatically populating the Referer header in outgoing HTTP requests. This means that sensitive information could be leaked to the server that is the target of the second HTTP request.",
    "technicalDescription": "If `CURLOPT_AUTOREFERER` is enabled, curl automatically includes the `username:password` part of the URL scheme in the Referer header. The option is turned off by default.",
    "publishedDate": "2021-03-31T11:20:49.307Z",
    "updatedDate": "2021-04-30T08:18:40.492Z",
    "disclosureDate": "2021-03-31T00:00:00.000Z",
    "exploitPublishDate": "2021-04-30T00:00:00.000Z",
    "solution": "Fixed in [**7.76.0**](https://github.com/curl/curl/releases/tag/curl-7_76_0) by [this](https://github.com/curl/curl/commit/7214288898f5625a6cc196e22a74232eada7861c) commit.\n\nThe latest stable releases are available [here](https://curl.se/download.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Viktor Szakats",
    "workaround": "if an upgrade is not possible, the vendor advises the following alternatives:\n* Apply the patch to your local version\n* Provide the credentials with `-u` or `CURLOPT_USERPWD`\n* Avoid `CURLOPT_AUTOREFERER` and `--referer \";auto\"`",
    "vendorFixDate": "2021-03-28T00:00:00.000Z",
    "vendorNotifiedDate": "2021-02-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-0825",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-359"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-22876",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-0825/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22876.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22876.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/7214288898f5625a6cc196e22a74232eada7861c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/f30ffef477",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_76_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1101882",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1101882",
                "label": "POC"
            }
        ]
    }
}