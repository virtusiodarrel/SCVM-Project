{
    "source": "BDSA",
    "name": "BDSA-2019-0323",
    "title": "ImageMagick Vulnerable to Denial-of-Service (DoS) via Memory Leak in 'WriteDIBImage' and 'WriteBMPImage' Functions",
    "description": "ImageMagick is vulnerable to denial-of-service (DoS) as it fails to sufficiently track and release memory during DIB and BMP image parsing. An attacker could leverage this flaw by supplying a crafted image to an application that makes use of ImageMagick or by tricking a user into doing so. Parsing malformed images can lead to excessive memory allocation and a crash.",
    "technicalDescription": "The flaws lie in the `WriteDIBImage()` function in `dib.c` and `WriteBMPImage()` function in `bmp.c`. The `WriteDIBImage()` function does not release memory allocated for the `pixels` variable if an allocation fails. Similarly, `WriteBMPImage()` will not release memory allocated for the `pixel_info` variable in case of allocation failure. These two memory leaks can be leveraged by an attacker to allocate excessive amounts of memory which may degrade the performance of the underlying host or cause application crash.",
    "publishedDate": "2019-02-05T16:04:19.018Z",
    "updatedDate": "2019-05-13T13:45:59.100Z",
    "disclosureDate": "2019-01-17T00:00:00.000Z",
    "solution": "Fixed in [**6.9.10-25**](https://github.com/ImageMagick/ImageMagick6/releases/tag/6.9.10-25) by [this](https://github.com/ImageMagick/ImageMagick6/commit/20c360e14cd5d70b5bbd0b54afa241eae4aec45d) and [this](https://github.com/ImageMagick/ImageMagick6/commit/dfa1e752bce7b6994765897fb6606d6069345442) commit.\n\nFixed in [**7.0.8-25**](https://github.com/ImageMagick/ImageMagick/releases/tag/7.0.8-25) by [this](https://github.com/ImageMagick/ImageMagick/commit/f14f66d2a2cca4d43faa2b181af9f6f4037621d9) and [this](https://github.com/ImageMagick/ImageMagick/commit/9cf2f738f714eba6d47be1127ed255acd2b51750) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Bingchang Liu at VARAS of IIE",
    "workaround": "",
    "vendorFixDate": "2019-01-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0323",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-401"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-7398",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0323/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick/commit/9cf2f738f714eba6d47be1127ed255acd2b51750",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick/commit/f14f66d2a2cca4d43faa2b181af9f6f4037621d9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick/issues/1453",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick/releases/tag/7.0.8-25",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick6/commit/20c360e14cd5d70b5bbd0b54afa241eae4aec45d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick6/commit/dfa1e752bce7b6994765897fb6606d6069345442",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick6/releases/tag/6.9.10-25",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0323/default-remediation-status"
            }
        ]
    }
}