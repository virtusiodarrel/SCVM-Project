{
    "source": "BDSA",
    "name": "BDSA-2020-4696",
    "title": "EyesOfNetwork Vulnerable to Arbitrary Command Execution via Privilege Escalation via nmap NSE Script",
    "description": "EyesOfNetwork contains a privilege escalation vulnerability. This can allow an apache user to utilize a specially crafted NSE script to elevate their permissions to root, and execute arbitrary commands.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "This vulnerability exists due to the insufficient escaping of arguments in the `autodiscovery.php` file of EyesOfNetwork lilac repository. This can allow an attacker who is an apache user to utilize a specially crafted NSE script to run nmap with root privileges, which will subsequently allow then to execute arbitrary commands with root privileges. \n\nThe vendor has mitigated against this by including additional `escapeshellarg` functionality to ensure it is impossible to use arbitrary commands as root.",
    "publishedDate": "2021-11-30T11:21:54.127Z",
    "updatedDate": "2022-05-05T15:16:27.556Z",
    "disclosureDate": "2020-02-05T00:00:00.000Z",
    "exploitPublishDate": "2020-02-05T00:00:00.000Z",
    "solution": "Fixed in lilac repository [**3.1-3**](https://github.com/EyesOfNetworkCommunity/lilac/releases/tag/3.1-3) by [this](https://github.com/EyesOfNetworkCommunity/lilac/commit/1c27cc6faad301eaa8f79b10d43bf4982ef5eb41) commit. \n\nThe latest stable releases are available [here](https://github.com/EyesOfNetworkCommunity/lilac/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "h4knet",
    "workaround": "",
    "vendorFixDate": "2020-02-28T00:00:00.000Z",
    "vendorNotifiedDate": "2020-02-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4696",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8655",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4696/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EyesOfNetworkCommunity/eonconf/issues/8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EyesOfNetworkCommunity/eonconf/issues/8",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EyesOfNetworkCommunity/lilac/commit/1c27cc6faad301eaa8f79b10d43bf4982ef5eb41",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EyesOfNetworkCommunity/lilac/releases/tag/3.1-3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EyesOfNetworkCommunity/lilac/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/156266/EyesOfNetwork-5.3-Remote-Code-Execution.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/156266/EyesOfNetwork-5.3-Remote-Code-Execution.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4696/default-remediation-status"
            }
        ]
    }
}