{
    "source": "BDSA",
    "name": "BDSA-2021-1896",
    "title": "Shopware Vulnerable to Authorization Bypass via Insufficient Access Control List Validation",
    "description": "Shopware is vulnerable to authorization bypass due to missing access control list (ACL) enforcement whenever order credits are being created. An authenticated attacker with administrator credentials could create order credits which they are not permitted to make.",
    "technicalDescription": "The script `src/Core/Framework/Api/Acl/AclWriteValidator.php` contains code that is used by Shopware in order to perform ACL-based validation for various actions. The validation that is performed by this code is insufficient, such that the creation of order credits is not validated for orders that are made by an administrator. An authenticated attacker with administrator credentials could use this issue to create unauthorized order credits.",
    "publishedDate": "2021-06-25T15:47:33.981Z",
    "updatedDate": "2021-06-25T15:47:33.976Z",
    "disclosureDate": "2021-06-24T00:00:00.000Z",
    "solution": "Fixed in [**6.4.1.1**](https://github.com/shopware/platform/releases/tag/v6.4.1.1) by [this](https://github.com/shopware/platform/commit/a482c366e4e9c86f650080dd9322c5339bf4e5ac) commit.\n\nThe latest stable releases are available [here](https://github.com/shopware/platform/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "If an upgrade to a patched version cannot be performed, the [Shopware Security Plugin](https://store.shopware.com/en/swag575294366635f/shopware-security-plugin.html) can be used instead.",
    "vendorFixDate": "2021-06-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1896",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32709",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1896/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/commit/a482c366e4e9c86f650080dd9322c5339bf4e5ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/releases/tag/v6.4.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/security/advisories/GHSA-g7w8-pp9w-7p32",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/security/advisories/GHSA-g7w8-pp9w-7p32",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://store.shopware.com/en/swag575294366635f/shopware-security-plugin.html",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1896/default-remediation-status"
            }
        ]
    }
}