{
    "source": "BDSA",
    "name": "BDSA-2021-3296",
    "title": "Schema-Inspector Vulnerable to Regular Expression Denial-of-Service (ReDoS) via Crafted Email Addresses",
    "description": "Schema-Inspector is vulnerable to regular expression denial-of-service (ReDoS) due to improper validation of email addresses. An attacker could exploit this vulnerability by supplying an application with maliciously crafted input.",
    "technicalDescription": "The issue exists within the file `lib/schema-inspector.js`. An improperly defined `email` expression for address validation could result in exponential backtracking and a denial-of-service (DoS) condition when matching addresses of the form `a@0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.`.",
    "publishedDate": "2021-11-02T14:32:05.792Z",
    "updatedDate": "2021-11-02T14:32:05.783Z",
    "disclosureDate": "2021-03-14T00:00:00.000Z",
    "exploitPublishDate": "2021-03-25T00:00:00.000Z",
    "solution": "Fixed in [**2.0.0**](https://github.com/schema-inspector/schema-inspector/releases/tag/2.0.0) by [this](https://github.com/schema-inspector/schema-inspector/commit/49fa4b7f081880f1d741a164c663caa8e2c6d129) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Erik Krogh Kristensen",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, the vendor states the following:\n> the only known workaround would be to stop using the email validation feature in the library. The user could, for example, accept the email address into their system but save it in a \"not yet validated\" state in their system until a verification email is sent to it (to determine whether the email is valid and belongs to the form submitter). Note that this is the preferred way of validating email addresses anyways.",
    "vendorFixDate": "2021-03-14T00:00:00.000Z",
    "vendorNotifiedDate": "2020-12-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3296",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-185"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21267",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3296/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/schema-inspector/schema-inspector/commit/49fa4b7f081880f1d741a164c663caa8e2c6d129",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/schema-inspector/schema-inspector/releases/tag/2.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/schema-inspector/schema-inspector/security/advisories/GHSA-f38p-c2gq-4pmr",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/schema-inspector/schema-inspector/security/advisories/GHSA-f38p-c2gq-4pmr",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://securitylab.github.com/advisories/GHSL-2020-358-redos-Schema-Inspector/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://securitylab.github.com/advisories/GHSL-2020-358-redos-Schema-Inspector/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3296/default-remediation-status"
            }
        ]
    }
}