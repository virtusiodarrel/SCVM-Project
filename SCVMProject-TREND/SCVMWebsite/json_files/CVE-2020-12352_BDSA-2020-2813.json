{
    "source": "BDSA",
    "name": "BDSA-2020-2813",
    "title": "Linux Kernel Vulnerable to Information Disclosure via Stack-Based Information Leak in 'net/bluetooth/a2mp.c'",
    "description": "The Linux kernel is vulnerable to information disclosure due to an information leak in the Bluetooth module. A remote attacker within a short distance could send a crafted Bluetooth packet and exploit this vulnerability in order to gain valuable information such as encryption keys.",
    "technicalDescription": "The issue is in function `a2mp_getinfo_req()` in file `net/bluetooth/a2mp.c`. If the `A2MP_GETINFO_REQ` request contains an invalid `hci` device ID, or the device ID is not of type `HCI_AMP`, an error response is sent back with uninitialized members of the `a2mp_info_rsp` structure. Since the structure is allocated on the stack, and only `id` and `status` fields are initialized, the remaining fields (16 bytes in total) contain information from the previous stack frame. Such information disclosure could let an attacker figure out the kernel's memory structure and defeat the KASLR.\n\nThe issue was fixed by initializing all unset fields to 0.",
    "publishedDate": "2020-10-16T16:19:10.350Z",
    "updatedDate": "2021-04-30T16:19:33.695Z",
    "disclosureDate": "2020-10-13T00:00:00.000Z",
    "exploitPublishDate": "2020-10-13T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.240**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e7b465bda9b90bec5427775bcbbfc47fe7a6012b) commit\n* [**4.9.240**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1a8da94d1c6ecc2a8db2a2477bef6945c0ba9c3e) commit\n* [**4.14.202**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=d53b1e94d08c032754a9aabeb3df309209c00347) commit\n* [**4.19.152**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=128278f444ab3a0d38759c4935092d256edc77d0) commit\n* [**5.4.72**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0d9e9b6e1a26bb248c0afee754d5a577abd4376b) commit\n* [**5.8.16**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a350bfd9a93fd1b3d1707bf1d1db3cfb823a8d10) commit\n* [**5.9.1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=122414e2d2cba74dc154263cabca9560ff8011ac) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:A/AC:L/Au:N/C:P/I:N/A:N/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.0
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andy Nguyen, Google Security Research",
    "workaround": "",
    "vendorFixDate": "2020-09-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2813",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-824"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12352",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2813/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=122414e2d2cba74dc154263cabca9560ff8011ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/net/bluetooth/a2mp.c?id=47f2d97d38816aaca94c9b6961c6eff1cfcd0bd6",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/security-research/security/advisories/GHSA-7mh3-gq28-gfrq",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/security-research/security/advisories/GHSA-7mh3-gq28-gfrq",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/49754",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2813/default-remediation-status"
            }
        ]
    }
}