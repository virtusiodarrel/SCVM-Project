{
    "source": "BDSA",
    "name": "BDSA-2021-4121",
    "title": "Linux Kernel Vulnerable to Information Exposure via EBPF Verifier Data Leak",
    "description": "The Linux kernel is vulnerable to information exposure due to the possibility of leaking internal kernel data from the EBPF verifier component. An attacker could potentially use the leaked information to bypass kernel memory protection mechanisms, such as KASLR.",
    "technicalDescription": "The function `adjust_scalar_min_max_vals()`, of file `kernel/bpf/verifier.c`, fails to call `__update_reg_bounds()` after having called `coerce_reg_to_size()`. This can cause registers to enter into an uncertain state, which can in turn cause a pointer leak following a call to `__mark_reg_unknown()`. An attacker could potentially leverage this issue in order to bypass memory protection mechanisms such as KASLR.",
    "publishedDate": "2022-02-16T09:57:23.869Z",
    "updatedDate": "2022-06-17T12:23:28.502Z",
    "disclosureDate": "2021-12-29T00:00:00.000Z",
    "exploitPublishDate": "2022-01-03T00:00:00.000Z",
    "solution": "Fixed in version [**5.7-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=294f2fc6da27620a506e6c050241655459ccd6bd) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-03-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4121",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-4159",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4121/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/show_bug.cgi?id=1194227",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=294f2fc6da27620a506e6c050241655459ccd6bd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bf5ee24e87e39548bf30d4e18e479e61a5a98336",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=294f2fc6da27620a506e6c050241655459ccd6bd",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/bpf/158507151689.15666.566796274289413203.stgit@john-Precision-5820-Tower/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4121/default-remediation-status"
            }
        ]
    }
}