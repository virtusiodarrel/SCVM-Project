{
    "source": "BDSA",
    "name": "BDSA-2019-4033",
    "title": "PHP Vulnerable to Authorization Bypass via Improper Null Termination in 'DirectoryIterator' Class Constructor",
    "description": "PHP is vulnerable to authorization bypass due to improper processing of termination characters. This could be leveraged by an attacker to expose vulnerabilities such as the bypassing of path validation checks in targeted applications.",
    "technicalDescription": "The issue exists in the `DirectoryIterator` class constructor function `spl_filesystem_object_construct` within the file `ext/spl/spl_directory.c`. The function incorrectly truncates paths containing the termination character `\\0`. This could lead to incorrect validation and allow unauthorized path access in vulnerable applications.",
    "publishedDate": "2019-12-23T20:02:17.052Z",
    "updatedDate": "2019-12-24T09:17:41.345Z",
    "disclosureDate": "2019-11-23T00:00:00.000Z",
    "exploitPublishDate": "2019-11-23T00:00:00.000Z",
    "solution": "Fixed in:\n* **[7.4.1](https://github.com/php/php-src/releases/tag/php-7.4.1)** by [this](https://github.com/php/php-src/commit/aa3bb910721cc7e08079e20b9f914a7d684832ee) commit,\n* **[7.3.13](https://github.com/php/php-src/releases/tag/php-7.3.13)** by [this](https://github.com/php/php-src/commit/63d0fa4a92a2c0ce3e4e31cda2e9291e12055c77) commit,\n* **[7.2.26](https://github.com/php/php-src/releases/tag/php-7.2.26)** by [this](https://github.com/php/php-src/commit/d74907b8575e6edb83b728c2a94df434c23e1f79) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-11-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4033",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-170"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11045",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4033/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=78863",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=78863",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/63d0fa4a92a2c0ce3e4e31cda2e9291e12055c77",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/aa3bb910721cc7e08079e20b9f914a7d684832ee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/d74907b8575e6edb83b728c2a94df434c23e1f79",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.2.26",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.3.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.4.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4033/default-remediation-status"
            }
        ]
    }
}