{
    "source": "BDSA",
    "name": "BDSA-2022-1626",
    "title": "PJSIP Vulnerable to Memory Corruption via Stack-Based Buffer Overflow in Hashed Digest Credentials Functionality",
    "description": "PJSIP is vulnerable to a stack buffer overflow flaw in the hashed digest credentials functionality. A remote attacker could leverage this to corrupt program memory, leading to data confidentiality, integrity and availability impacts.",
    "technicalDescription": "The flaw exists in multiple parts of the codebase because of insufficient checks on the length of certain remotely provided message digests. The issue was resolved by checking the return value of `pjsip_auth_create_digest()`.",
    "publishedDate": "2022-06-10T13:27:05.248Z",
    "updatedDate": "2022-09-08T06:20:32.502Z",
    "disclosureDate": "2022-03-11T00:00:00.000Z",
    "solution": "Fixed in [**2.12.1**](https://github.com/pjsip/pjproject/releases/tag/2.12.1) by [this](https://github.com/pjsip/pjproject/commit/03890531c56835b71a006c21faa6e0a5a899b191) commit.\n\nThe latest stable releases can be found [here](https://github.com/pjsip/pjproject/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor supplies the following workaround:\n> Users need to check that the hashed digest data length must be equal to PJSIP_MD5STRLEN before passing to PJSIP.",
    "vendorFixDate": "2022-03-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1626",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24754",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1626/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pjsip/pjproject/commit/03890531c56835b71a006c21faa6e0a5a899b191",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pjsip/pjproject/releases/tag/2.12.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pjsip/pjproject/security/advisories/GHSA-73f7-48m9-w662",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pjsip/pjproject/security/advisories/GHSA-73f7-48m9-w662",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pjsip/pjproject/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1626/default-remediation-status"
            }
        ]
    }
}