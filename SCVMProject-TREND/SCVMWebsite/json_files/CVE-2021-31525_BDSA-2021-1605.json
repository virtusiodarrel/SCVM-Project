{
    "source": "BDSA",
    "name": "BDSA-2021-1605",
    "title": "Go Vulnerable to Denial-of-Service (DoS) via Uncontrolled Recursion in 'ReadRequest' and 'ReadResponse' Functions",
    "description": "Go is vulnerable to denial-of-service (DoS) due to improper request parsing by its HTTP client and server network library. Both clients and servers that use the Go network library could be forced to crash by receiving requests or responses with large headers.",
    "technicalDescription": "The functions `ReadRequest` and `ReadResponse` in the `net/http` package can result in an uncontrolled recursion and stack overflow when parsing requests with large headers (over 7MB on 64-bit architectures, or over 4MB on 32-bit ones). Although `Transport` and `Client` objects can be crashed by a malicious server, the `Server` object is not vulnerable by default since its default max header value is 1MB. However, `Server` may become vulnerable if the max header `Server.MaxHeaderBytes` is overridden to a higher value. The vulnerability was fixed in Go by pulling in the fix (removal of recursion in the `httpguts.HeaderValuesContainsToken` function) from the `x/net` repository.",
    "publishedDate": "2021-05-28T14:04:50.555Z",
    "updatedDate": "2021-07-29T09:22:30.443Z",
    "disclosureDate": "2021-05-06T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.15.12**](https://github.com/golang/go/releases/tag/go1.15.12) by [this](https://github.com/golang/go/commit/5aed4ce3c854bdbbb6dd5c1ccfa15c23d4b6c989) commit.\n* [**1.16.4**](https://github.com/golang/go/releases/tag/go1.16.4) by [this](https://github.com/golang/go/commit/d4adea20f01627098936e050d3a73922f7ebe08f) commit.\n* [**1.17-beta1**](https://github.com/golang/go/releases/tag/go1.17beta1) by [this](https://github.com/golang/go/commit/791854700d) commit.\n\nThe latest releases are available [here](https://golang.org/dl/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Guido Vranken",
    "workaround": "",
    "vendorFixDate": "2021-04-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1605",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-674"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-31525",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1605/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/5aed4ce3c854bdbbb6dd5c1ccfa15c23d4b6c989",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/791854700d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/d4adea20f01627098936e050d3a73922f7ebe08f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/issues/45710",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases/tag/go1.15.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases/tag/go1.16.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases/tag/go1.17beta1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/net/commit/89ef3d95e781148a0951956029c92a211477f7f9",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/net/commit/89ef3d95e781148a0951956029c92a211477f7f9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://golang.org/dl/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/golang-announce/c/cu9SP4eSXMc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1605/default-remediation-status"
            }
        ]
    }
}