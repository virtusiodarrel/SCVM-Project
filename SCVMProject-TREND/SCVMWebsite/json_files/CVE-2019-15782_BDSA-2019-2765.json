{
    "source": "BDSA",
    "name": "BDSA-2019-2765",
    "title": "Webtorrent Vulnerable to Cross-site Scripting (XSS) via Torrents in 'server.js' File",
    "description": "Webtorrent is vulnerable to cross-site scripting (XSS) due to improper sanitization of torrents in `lib/server.js`. An attacker could insert JavaScript code and steal a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "An attacker could insert a torrent file with a title or file name containing malicious Javascript. For a successful attack, a victim would need to start the HTTP server via `createServer()` and then open the HTTP server index page. At this point the payload would be executed. This could allow an attacker to view what content the victim has downloaded and other sensitive information.\n\nThis has been addressed by escaping HTML for metadata including `file.name`, `file.path`, `file.length` and `torrent.name` and also implementing a Content Security Policy (CSP).",
    "publishedDate": "2019-09-02T11:01:11.401Z",
    "updatedDate": "2019-09-02T11:01:11.393Z",
    "disclosureDate": "2019-08-27T00:00:00.000Z",
    "solution": "Fixed in version [**0.107.6**](https://github.com/webtorrent/webtorrent/releases/tag/v0.107.6) by [this](https://github.com/webtorrent/webtorrent/commit/22546df6d9ba9ca4523142d98b5e70f6db213f3e) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Feross Aboukhadijeh",
    "workaround": "",
    "vendorFixDate": "2019-08-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2765",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15782",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2765/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webtorrent/webtorrent/commit/22546df6d9ba9ca4523142d98b5e70f6db213f3e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webtorrent/webtorrent/pull/1714",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webtorrent/webtorrent/releases/tag/v0.107.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2765/default-remediation-status"
            }
        ]
    }
}