{
    "source": "BDSA",
    "name": "BDSA-2022-0170",
    "title": "OpenJDK Vulnerable to Denial-of-Service (DoS) via  Excessive Memory Allocation in TIFF*Decompressor",
    "description": "OpenJDK contains a denial-of-service (DoS) vulnerability. This allows an unauthenticated attacker to to degrade service of applications using the ImageIO component to read TIFF image files.  An attacker can craft a TIFF file that can cause applications to allocate excessive memory and crash of degrade the applications service. \n\n**Note:** This vulnerability applies to Java deployments, typically in clients running sandboxed Java Web Start applications or sandboxed Java applets, that load and run untrusted code (e.g., code that comes from the internet) and rely on the Java sandbox for security. This vulnerability can also be exploited by using APIs in the specified Component, e.g., through a web service which supplies data to the APIs.",
    "technicalDescription": "The DoS is due to the `decodeRaw` method in the `TIFFFaxDecompressor`, `TIFFLZWDecompressor`, and `TIFFPackBitsDecompressor` classes in `src/java.desktop/share/classes/com/sun/imageio/plugins/tiff/` allocating an array size based on a value read from a header.  This allows a very small TIFF file to be created with a large value in the header denoting certain data size.  This value will be used to allocate a very large array buffer and consume memory. Since the TIFF file is actually small in size, an attacker requires very little effort to create multiple crafted files to completely degrade or crash an application using the ImageIO library in this way.",
    "publishedDate": "2022-01-20T10:17:58.211Z",
    "updatedDate": "2022-04-22T12:21:31.637Z",
    "disclosureDate": "2022-01-19T00:00:00.000Z",
    "solution": "Fixed in:\n* [**jdk-17.0.2-ga**](https://github.com/openjdk/jdk17u/releases/tag/jdk-17.0.2-ga) by [this](https://github.com/openjdk/jdk17u/commit/b76b89eca55f61979d4596d085a1f21fe15df82f) commit,\n* [**jdk-11.0.14-ga**](https://github.com/openjdk/jdk11u-dev/releases/tag/jdk-11.0.14-ga) by [this](https://github.com/openjdk/jdk11u-dev/commit/129fa0eaa0daff03db6bfc4ecf42101ae74c8db4) commit,\n\nThe latest stable releases are available [here](https://openjdk.java.net/projects/jdk-updates/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Fabian Meumertzheim of Code Intelligence",
    "workaround": "",
    "vendorFixDate": "2022-01-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0170",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-21366",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0170/ranges"
            },
            {
                "rel": "reference",
                "href": "http://hg.openjdk.java.net/jdk8u/monojdk8u/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.oracle.com/security-alerts/cpujan2022.html?505601",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk11u-dev/commit/129fa0eaa0daff03db6bfc4ecf42101ae74c8db4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk11u-dev/releases/tag/jdk-11.0.14-ga",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk17u/commit/b76b89eca55f61979d4596d085a1f21fe15df82f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openjdk/jdk17u/releases/tag/jdk-17.0.2-ga",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://openjdk.java.net/groups/vulnerability/advisories/2022-01-18",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://openjdk.java.net/projects/jdk-updates/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0170/default-remediation-status"
            }
        ]
    }
}