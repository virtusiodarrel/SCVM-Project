{
    "source": "BDSA",
    "name": "BDSA-2021-3778",
    "title": "OpenSSL Vulnerable to Unexpected Behaviour via Unexpected 'SSL_get_error()' Return Value",
    "description": "OpenSSL clients are vulnerable to unexpected behaviour due to an incorrect value returned by the certificate verification function. Depending on the application this could result in crashes, infinite loops or other similar incorrect responses.",
    "technicalDescription": "The vulnerability is caused by the `X509_verify_cert()` function. The function may return a negative return value to indicate an internal error, which would subsequently cause IO functions to result in `SSL_get_error()` returning `SSL_ERROR_WANT_RETRY_VERIFY`. This return value would be unexpected for most applications since it requires `SSL_CTX_set_cert_verify_callback()` function to be called beforehand. This could cause unexpected behaviour which depends on how the application uses OpenSSL.\n\nThe vulnerability was fixed by ensuring that any returned value of `X509_verify_cert()` that is less than 0 is equally treated as a failure to verify in `ssl_verify_cert_chain` within the file `ssl/ssl_cert.c`.",
    "publishedDate": "2021-12-15T11:36:35.124Z",
    "updatedDate": "2021-12-15T11:36:35.106Z",
    "disclosureDate": "2021-12-14T00:00:00.000Z",
    "solution": "Fixed in version [**3.0.1**](https://github.com/openssl/openssl/releases/tag/openssl-3.0.1) by [this](https://github.com/openssl/openssl/commit/c1c1bb7c5e) commit.\n\nThe latest stable releases can be found [here](https://github.com/openssl/openssl/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tobias Nie\u00dfen",
    "workaround": "",
    "vendorFixDate": "2021-12-14T00:00:00.000Z",
    "vendorNotifiedDate": "2021-11-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3778",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-394"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-4044",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3778/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/commit/c1c1bb7c5e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/releases/tag/openssl-3.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openssl.org/news/secadv/20211214.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3778/default-remediation-status"
            }
        ]
    }
}