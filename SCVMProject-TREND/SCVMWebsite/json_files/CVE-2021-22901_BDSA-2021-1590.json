{
    "source": "BDSA",
    "name": "BDSA-2021-1590",
    "title": "curl Vulnerable to Remote Code Execution (RCE) via 'TLS Session Caching Disaster'",
    "description": "curl is vulnerable to a remote code execution (RCE) issue due to how a use-after-free flaw exists during TLS session negotiation or when client certificates are requested during an existing connection.\n\nIf a malicious server can manage to get crafted content into client memory, this issue could be abused in order to execute remote code.",
    "technicalDescription": "curl is vulnerable to remote code execution (RCE) because a flaw exists where curl can be tricked into using already freed memory when a new TLS session is negotiated or a client certificate is requested on an existing connection.\n\nSupport for session ID caching on connections using OpenSSL is set up at run-time. During this time, pointers to the transfer in-memory object are stored for later retrieval when OpenSSL considers a new session to be established. If the connection is used by multiple transfers, the first transfer object could be freed before the new session is established on that connection, where it is then possible that the function will access a memory buffer that has been freed or call a function pointer in the object.\n\n**Note**: The vendor has stated [here](https://curl.se/docs/CVE-2021-22901.html) that the flaw can only happen in curl built to use OpenSSL (or one of its forks).",
    "publishedDate": "2021-05-27T08:56:05.182Z",
    "updatedDate": "2021-05-27T10:53:09.407Z",
    "disclosureDate": "2021-05-26T00:00:00.000Z",
    "exploitPublishDate": "2021-05-26T00:00:00.000Z",
    "solution": "Fixed in [**7.77.0**](https://github.com/curl/curl/releases/tag/curl-7_77_0) by [this](https://github.com/curl/curl/commit/7f4a9a9b2a49547eae24d2e19bc5c346e9026479) commit.\n\nThe latest stable releases are available [here](https://curl.se/download.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.6,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Harry Sintonen",
    "workaround": "The vendor has suggested [here](https://curl.se/docs/CVE-2021-22901.html) that apart from upgrading or applying a patch, users can make sure to build curl to use another TLS backend.",
    "vendorFixDate": "2021-05-24T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-29T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1590",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22901",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1590/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22901.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22901.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22901.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/download.html",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/7f4a9a9b2a49547eae24d2e19bc5c346e9026479",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/a304051620b92e12b6b1b4e19edc57b34ea332b6",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_77_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1180380",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1180380",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2021/q2/166",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1590/default-remediation-status"
            }
        ]
    }
}