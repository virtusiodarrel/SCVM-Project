{
    "source": "BDSA",
    "name": "BDSA-2018-2155",
    "title": "Linux Kernel KVM L1 VM Vulnerable to Privilege Escalation via Specially Crafted VMX Instructions",
    "description": "A local attacker on a L2 guest system can execute VMX instructions to cause privilege escalation on a L1 guest  if they can break out of their emulation process (QEMU).",
    "technicalDescription": "KVM L1 guests do not check whether VMX instructions come from the kernel or an unprivileged userland process. The code checks for the guests `CR4.VMXE` value so this only works if a L2 guest is running.  An attacker who can control a emulation process such as QEMU can then execute VMX instructions on the L1 guest, which in turn is emulated by the L0 KVM.  These instructions could be used for privilege escalation on the L1 guest and the leaking of kernel memory addresses.",
    "publishedDate": "2018-07-10T11:08:57.719Z",
    "updatedDate": "2018-07-10T11:08:57.702Z",
    "disclosureDate": "2018-06-08T00:00:00.000Z",
    "exploitPublishDate": "2018-06-08T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**4.14.50**](https://www.kernel.org)\n* [**4.16.16**](https://www.kernel.org)\n* [**4.17.2**](https://www.kernel.org)\n* [**4.18-rc1**](https://www.kernel.org)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=727ba748e110b4de50d142edca9d6a9b7e6111d8) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.4,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "fwilhelm",
    "workaround": "",
    "vendorFixDate": "2018-06-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-2155",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-250"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-12904",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-2155/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=727ba748e110b4de50d142edca9d6a9b7e6111d8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/44944/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}