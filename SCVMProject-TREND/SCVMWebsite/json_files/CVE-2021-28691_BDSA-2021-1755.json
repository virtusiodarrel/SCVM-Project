{
    "source": "BDSA",
    "name": "BDSA-2021-1755",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) via Use After Free in xen-netback",
    "description": "The Linux Kernel, as used by Xen, contains a use-after-free vulnerability. An authenticated attacker can take advantage of this to terminate the receive kernel thread associated with queue 0, and trigger a denial-of-service (DoS) condition.",
    "technicalDescription": "This vulnerability exists in function `xenvif_disconnect_queue()` of file `drivers/net/xen-netback/interface.c`.  An authenticated attacker can send a crafted malformed packet in order to terminate the receive kernel thread associated with queue 0, triggering a use-after-free in Linux netback. This happens because the kernel thread associated with queue 0 will have already exited, therefore the `kthread_stop` call will be performed against a stale pointer, causing a DoS condition.",
    "publishedDate": "2021-06-11T15:23:26.595Z",
    "updatedDate": "2021-12-08T11:50:07.041Z",
    "disclosureDate": "2021-06-08T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.10.43**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6b53db8c4c14b4e7256f058d202908b54a7b85b4) commit\n* [**5.12.10**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=caec9bcaeb1a5f03f2d406305355c853af10c13e) commit\n* [**5.13-rc6**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=107866a8eb0b664675a260f1ba0655010fac1e08) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Michael Brown, Olivier Benjamin, Michael Kurth and Martin Mazein",
    "workaround": "The vendor has suggested [here](https://xenbits.xenproject.org/xsa/advisory-374.html) that on x86 then running only HVM guests with emulated network cards will avoid the issue.  However there isno option in the upstream toolstack to offer only emulated network cards to guests.",
    "vendorFixDate": "2021-06-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1755",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28691",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1755/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=107866a8eb0b664675a260f1ba0655010fac1e08",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6b53db8c4c14b4e7256f058d202908b54a7b85b4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=caec9bcaeb1a5f03f2d406305355c853af10c13e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2ac061ce97f4",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-374.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-374.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1755/default-remediation-status"
            }
        ]
    }
}