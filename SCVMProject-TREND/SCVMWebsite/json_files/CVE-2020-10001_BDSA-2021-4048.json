{
    "source": "BDSA",
    "name": "BDSA-2021-4048",
    "title": "CUPS Vulnerable to Buffer Over-Read via Flawed Validation in 'ippReadIO' Function",
    "description": "CUPS is vulnerable to a buffer over-read issue due to a flaw that exists in validation checks within the `ippReadIO()` function.\n\nA victim user could be tricked into using CUPS with crafted input (or a crafted file) which will disclose information by copying uninitialized areas of memory into an IPP string value, or cause a denial-of-service (DoS) by supplying/using invalid string values when strict validation has been disabled by the system administrator.",
    "technicalDescription": "CUPS is vulnerable to a buffer over-read because the `ippReadIO()` function in the `cups/ipp.c` file contains flawed validation checks that allow access to an uninitialized buffer. \n\nWhen the `ippReadIO()` function reads the tagged string values `nameWithLanguage` and `textWithLanguage`, the length of the sub-strings (language identifier and name/text value) are verified to not exceed the size of the allocated buffer (1 byte larger than the maximum IPP value size of 32767 bytes). However, the validation in place does not check against the length of the actual IPP value.",
    "publishedDate": "2022-01-21T12:06:39.366Z",
    "updatedDate": "2022-01-25T10:35:30.505Z",
    "disclosureDate": "2021-01-28T00:00:00.000Z",
    "exploitPublishDate": "2021-01-29T00:00:00.000Z",
    "solution": "Fixed in OpenPrinting CUPS [**2.3.3-op2**](https://github.com/OpenPrinting/cups/releases/tag/v2.3.3op2) by [this](https://github.com/OpenPrinting/cups/commit/efbea1742bd30f842fbbfb87a473e5c84f4162f9) commit.\n\nFixed in the **master** branch of Apple CUPS by [this](https://github.com/apple/cups/commit/ab83aeec841831b8b17b2efb9004f77c32027bc6) commit which is not yet available in any release.\n\nThe latest stable releases of OpenPrinting CUPS are available [here](https://github.com/openprinting/cups/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Niky <kittymore83@gmail.com> of China Mobile",
    "workaround": "",
    "vendorFixDate": "2021-02-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4048",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-126"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10001",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4048/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1752147",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1752147",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1752759",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1921680",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenPrinting/cups/commit/a41f09e265d6451d22585430ca176ff406d59f9b",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenPrinting/cups/commit/efbea1742bd30f842fbbfb87a473e5c84f4162f9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenPrinting/cups/releases/tag/v2.3.3op2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apple/cups/commit/ab83aeec841831b8b17b2efb9004f77c32027bc6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openprinting/cups/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://openprinting.github.io/cups-2.3.3op2/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://support.apple.com/en-us/HT212011",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4048/default-remediation-status"
            }
        ]
    }
}