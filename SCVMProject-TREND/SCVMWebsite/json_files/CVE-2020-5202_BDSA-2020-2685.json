{
    "source": "BDSA",
    "name": "BDSA-2020-2685",
    "title": "apt-cacher-ng Vulnerable to Credentials Leak when 'AdminAuth' is Enabled",
    "description": "apt-cacher-ng is a vulnerable to a credentials leak when `AdminAuth` is enabled. A local user can obtain sensitive information by hijacking the hardcoded TCP port.",
    "technicalDescription": "The `/usr/lib/apt-cacher-ng/acngtool` program tries to connect to the apt-cacher-ng daemon via TCP on port 3142, even if the `SocketPath=/var/run/apt-cacher-ng/socket` option is passed via the command line. 3142 is an unprivileged port so any local user can bind to it and receive this request from acngtool. When `AdminAuth` is enabled in `/etc/apt-cacher-ng/security.conf` requests could contain sensitive information. An unprivileged user who can bind to the port before the daemon does will be able to access this information.  \n\nThis issue is more serious in the openSUSE packaging since the apt-cacher-ng daemon is only started by explicit Administrator configuration which results in the attack surface being exposed by default. When the daemon crashes or is crashed by a local attacker the information leak will also happen.",
    "publishedDate": "2020-10-08T16:07:41.976Z",
    "updatedDate": "2020-10-08T16:07:41.970Z",
    "disclosureDate": "2020-01-20T00:00:00.000Z",
    "exploitPublishDate": "2020-01-20T00:00:00.000Z",
    "solution": "Fixed in [**3.4**](https://salsa.debian.org/blade/apt-cacher-ng/-/tags/upstream%2F3.4) by [this](https://salsa.debian.org/blade/apt-cacher-ng/commit/3b91874b0c099b0ded1a94f1784fe1265082efbc) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matthias Gerstner",
    "workaround": "",
    "vendorFixDate": "2020-01-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2685",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-201"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5202",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2685/ranges"
            },
            {
                "rel": "reference",
                "href": "https://salsa.debian.org/blade/apt-cacher-ng/-/tags/upstream%2F3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://salsa.debian.org/blade/apt-cacher-ng/commit/3b91874b0c099b0ded1a94f1784fe1265082efbc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q1/21",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q1/21",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2685/default-remediation-status"
            }
        ]
    }
}