{
    "source": "BDSA",
    "name": "BDSA-2019-2164",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via Improper Handling of 'PTRACE_TRACEME'",
    "description": "The Linux kernel is vulnerable to mishandling of credentials when dealing with certain sequences of ptrace operations. A local attacker could escalate their privileges or cause a denial-of-service (DoS) of the host.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "Two flaws were found in the handling of `PTRACE_TRACEME` operations. The first is that the reference to a `struct cred` is obtained under a RCU reference. This can cause a crash and denial-of-service (DoS).\n\nThe second flaw is that `PTRACE_TRACEME` records the parent's credentials as if the parent was acting as the subject. If the parent process becomes attacker controlled the attacker will end up with two processes under their control and a privileged ptrace relationship. They can then use this to ptrace a privileged suid binary and elevate their privileges.",
    "publishedDate": "2019-07-22T09:26:19.008Z",
    "updatedDate": "2022-05-06T11:37:27.008Z",
    "disclosureDate": "2019-07-16T00:00:00.000Z",
    "exploitPublishDate": "2019-07-16T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.16.71**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=d5d5bd909a4f03f132ee3fd3f6f0568c8344eee5) commit\n* [**4.4.185**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=54562d2b0be5c120b01c8bb94baef1aca37fd329) commit\n* [**4.9.185**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=d8b99303da935228a33fa7656a964adfb33e271b) commit\n* [**4.14.133**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bf71ef9655d25e8b275ec6ed649b6bd719231ddc) commit\n* [**4.19.58**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=54435b7fff7bfb9515cc457b71c3734c1c3fff76) commit\n* [**5.1.17**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=49887fc3f2a7e6185777af3a9c96095aeb2bce1b) commit\n* [**5.2**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6994eefb0053799d2e07cd140df6c2ea106c41ee) commit\n* [**5.3-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6994eefb0053799d2e07cd140df6c2ea106c41ee) commit",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.9,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.4,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "(AV:L/AC:M/Au:N/C:C/I:C/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn, Google Security Research",
    "workaround": "",
    "vendorFixDate": "2019-07-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2164",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-255"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13272",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2164/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1903",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6994eefb0053799d2e07cd140df6c2ea106c41ee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/153663/GS20190716202055.tgz",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/153663/GS20190716202055.tgz",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/47163",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/47543",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2164/default-remediation-status"
            }
        ]
    }
}