{
    "source": "BDSA",
    "name": "BDSA-2020-4494",
    "title": "node-forge Package Vulnerable to Prototype Pollution via 'util.setPath' Function",
    "description": "node-forge package is vulnerable to prototype pollution. This can allow an attacker to inject malicious properties into prototypes, which will then be inherited by all objects in that prototype chain. This could lead to a denial-of-service (DoS) and remote code execution (RCE).\n\n**Note:** Version **0.10.0** is a breaking change from removing the vulnerable functions. If these functions are required, there are other suitable libraries for this.",
    "technicalDescription": "This vulnerability exists in the `util.setPath` function in the file  `lib/util.js` due to  improper validation of input for prototype keywords `__proto__`, `constructor` and `prototype` which can be passed into object path functions.\n\nThis was addressed by removing  the object path functions `util.getPath`, `util.setPath`, and `util.deletePath` from `lib/util.js` file.",
    "publishedDate": "2021-06-30T11:03:26.149Z",
    "updatedDate": "2021-06-30T11:03:26.144Z",
    "disclosureDate": "2020-09-01T00:00:00.000Z",
    "exploitPublishDate": "2020-09-01T00:00:00.000Z",
    "solution": "Fixed in [**0.10.0**](https://github.com/digitalbazaar/forge/releases/tag/0.10.0) by [this](https://github.com/digitalbazaar/forge/commit/6a1e3ef74f6eb345bcff1b82184201d1e28b6756) commit.\n\nThe latest stable releases are available [here](https://www.npmjs.com/package/node-forge).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "NerdJS",
    "workaround": "",
    "vendorFixDate": "2020-09-01T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-14T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4494",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7720",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4494/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/digitalbazaar/forge/blob/master/CHANGELOG.md#removed",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/digitalbazaar/forge/commit/521fd6018d350a54c5f3b5ab5258a145bcc613e0",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/digitalbazaar/forge/commit/6a1e3ef74f6eb345bcff1b82184201d1e28b6756",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/digitalbazaar/forge/releases/tag/0.10.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-NODEFORGE-598677",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-NODEFORGE-598677",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/node-forge",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4494/default-remediation-status"
            }
        ]
    }
}