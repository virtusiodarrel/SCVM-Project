{
    "source": "BDSA",
    "name": "BDSA-2021-1157",
    "title": "Apache Tapestry Vulnerable to Information Exposure via WEB-INF Directory",
    "description": "Apache Tapestry is vulnerable information disclosure. An attacker could manipulate URLs to download Java webapp files from a folder that is supposed to protect them.\n\n**Note**: this issue exists due to an incomplete fix for **CVE-2020-13953** (**BDSA-2020-2546**).",
    "technicalDescription": "The vulnerable folder is `WEB-INF`. The issue is due to slashes in context URLs not being handled properly. It was fixed by improving illegal URL pattern matching.\n\nThe initial fix for this issue did not properly account for backslashes in the filtering regex, thus an additional patch was required.",
    "publishedDate": "2021-04-28T08:25:58.843Z",
    "updatedDate": "2021-04-28T08:25:58.835Z",
    "disclosureDate": "2021-04-27T00:00:00.000Z",
    "solution": "Fixed in [**5.6.4**](https://github.com/apache/tapestry-5/releases/tag/5.6.4) by these commits:\n* [Commit 1](https://github.com/apache/tapestry-5/commit/cf1912291)\n* [Commit 2](https://github.com/apache/tapestry-5/commit/abdd3d3a2)\n* [Commit 3](https://github.com/apache/tapestry-5/commit/4d2f9cf94f547cfd5be7f56dc3ab142d299a1b6c)\n\nFixed in [**5.7.2**](https://github.com/apache/tapestry-5/releases/tag/5.7.2) by these commits:\n* [Commit 1](https://github.com/apache/tapestry-5/commit/cf1912291)\n* [Commit 2](https://github.com/apache/tapestry-5/commit/abdd3d3a2)\n* [Commit 3](https://github.com/apache/tapestry-5/commit/30ab433d9acdb45346edbaab425cc0ef02219308)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1157",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-30638",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1157/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/commit/30ab433d9acdb45346edbaab425cc0ef02219308",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/commit/4d2f9cf94f547cfd5be7f56dc3ab142d299a1b6c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/commit/abdd3d3a2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/commit/cf1912291",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/releases/tag/5.6.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/releases/tag/5.7.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/TAP5-2632",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/r37dab61fc7f7088d4311e7f995ef4117d58d86a675f0256caa6991eb%40%3Cusers.tapestry.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q3/197",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://tapestry.apache.org/security.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1157/default-remediation-status"
            }
        ]
    }
}