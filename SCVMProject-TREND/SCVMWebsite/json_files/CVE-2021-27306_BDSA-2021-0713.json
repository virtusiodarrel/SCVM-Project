{
    "source": "BDSA",
    "name": "BDSA-2021-0713",
    "title": "Kong Vulnerable to Authentication Bypass via Improper URI Normalization",
    "description": "Kong is vulnerable to authentication bypass due to the improper normalization of URIs. An attacker could access an authenticated route via an unauthenticated route by using a maliciously crafted URI, in which an authenticated route is the sub-route of a non-authenticated route.\n\n**Note:** An attacker can only exploit this vulnerability if a service exists between the Kong router and the target application that will normalize the crafted URI. It should also be noted that only instances of Kong which use the JWT plugin to secure routes are vulnerable.",
    "technicalDescription": "Kong routers are capable of implementing both authenticated and unauthenticated routes. Requests sent via authenticated routes require valid JWT tokens. A route's configuration can be inherited by sub-routes, which have URIs that are prepended with the parent route URI (e.g. `/api/v1/customers/admin` will be a sub-route of `/api/v1/customers`). Sub-routes have the authentication requirements of their parent routes. Kong does not normalize the raw URI from a user's request, and so it is possible to specify a crafted URI that has an authenticated route as the sub-route of an unauthenticated route. This URI will inherit the configuration of the unauthenticated route, but requests associated with the URI will be forwarded along the authenticated route. An attacker could exploit this to forward requests along authenticated routes despite not being in possession of a valid JWT token. This could allow an attacker to access the destination application in an unauthorized manner.\n\nIt should be noted that an attacker can only exploit this vulnerability if a service exists between the Kong router and the target application which will normalize the crafted URI. It should also be noted that only instances of Kong which use the JWT plugin to secure routes are vulnerable.\n\nThe vulnerability was fixed by ensuring that request URIs are normalized prior to route matching.",
    "publishedDate": "2021-04-22T15:39:46.755Z",
    "updatedDate": "2021-04-22T15:39:46.747Z",
    "disclosureDate": "2021-03-18T00:00:00.000Z",
    "exploitPublishDate": "2021-03-18T00:00:00.000Z",
    "solution": "Fixed in [**2.3.2**](https://github.com/Kong/kong/releases/tag/2.3.2) by [this](https://github.com/Kong/kong/commit/bc07af536f9fbd4873ca3f97b79ec269d4399265) commit and [this](https://github.com/Kong/kong/commit/faa4b6db01e2a47bb6bf1b3b5cf6dcfb25c40887) commit.\n\nThe latest stable releases are available [here](https://github.com/Kong/kong/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.7,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.2,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-02-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0713",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-228"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-27306",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0713/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Kong/kong/blob/2.3.2/CHANGELOG.md#232",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Kong/kong/commit/bc07af536f9fbd4873ca3f97b79ec269d4399265",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Kong/kong/commit/faa4b6db01e2a47bb6bf1b3b5cf6dcfb25c40887",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Kong/kong/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Kong/kong/releases/tag/2.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://sewan.medium.com/cve-2021-27306-access-an-authenticated-route-on-kong-api-gateway-6ae3d81968a3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sewan.medium.com/cve-2021-27306-access-an-authenticated-route-on-kong-api-gateway-6ae3d81968a3",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0713/default-remediation-status"
            }
        ]
    }
}