{
    "source": "BDSA",
    "name": "BDSA-2022-1296",
    "title": "PostgreSQL Vulnerable to SQL Injection (SQLi) via Failure to Correctly Utilize 'Security Restricted Operation' Protection Mechanism",
    "description": "PostgreSQL is vulnerable to an SQL injection (SQLi) issue due to how certain operations do not correctly use the security restricted operation protection mechanism during processing.\n\nThis could allow an attacker that has the ability to create non-temporary objects in a database to define an object that could execute arbitrary SQL code with superuser permissions when `autovaccum` processes it. The code could also be executed if a superuser runs one of the other affected commands against it.",
    "technicalDescription": "This issue occurs because the  `Autovacuum`, `CLUSTER`, `CREATE INDEX`, `REINDEX`, `REFRESH MATERIALIZED VIEW`, and `pg_amcheck` operations activate the security restricted operation protection mechanism too late, or even not at all in some code paths.",
    "publishedDate": "2022-05-10T13:25:45.699Z",
    "updatedDate": "2022-06-08T09:47:22.693Z",
    "disclosureDate": "2022-05-09T00:00:00.000Z",
    "solution": "Fixed in:\n*  [**10.21**](https://github.com/postgres/postgres/releases/tag/REL_10_21) by [this](https://github.com/postgres/postgres/commit/f26d570285) commit and [this](https://github.com/postgres/postgres/commit/ef792f7856) commit,\n*  [**11.16**](https://github.com/postgres/postgres/releases/tag/REL_11_16) by [this](https://github.com/postgres/postgres/commit/48ca2904c1) commit and [this](https://github.com/postgres/postgres/commit/34ff15660b) commit,\n*  [**12.11**](https://github.com/postgres/postgres/releases/tag/REL_12_11) by [this](https://github.com/postgres/postgres/commit/880511cb0b) commit and [this](https://github.com/postgres/postgres/commit/7f098f7b53) commit,\n*  [**13.7**](https://github.com/postgres/postgres/releases/tag/REL_13_7) by [this](https://github.com/postgres/postgres/commit/88743d581e) commit and [this](https://github.com/postgres/postgres/commit/35edcc0cee) commit,\n* [**14.3**](https://github.com/postgres/postgres/releases/tag/REL_14_3) by [this](https://github.com/postgres/postgres/commit/677a494789) commit and [this](https://github.com/postgres/postgres/commit/ab49ce7c34) commit,\n* [**15 Beta 1**](https://github.com/postgres/postgres/releases/tag/REL_15_BETA1) by [this](https://github.com/postgres/postgres/commit/0abc1a059e) commit and [this](https://github.com/postgres/postgres/commit/a117cebd63) commit.\n\nThe latest stable releases are available [here](https://www.postgresql.org/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alexander Lakhin, Alvaro Herrera",
    "workaround": "",
    "vendorFixDate": "2022-05-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1296",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-1552",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1296/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/0abc1a059e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/34ff15660b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/35edcc0cee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/48ca2904c1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/677a494789",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/7f098f7b53",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/880511cb0b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/88743d581e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/a117cebd63",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/ab49ce7c34",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/ef792f7856",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/f26d570285",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_10_21",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_11_16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_12_11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_13_7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_14_3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_15_BETA1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.postgresql.org/docs/14/release-14-3.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.postgresql.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1296/default-remediation-status"
            }
        ]
    }
}