{
    "source": "BDSA",
    "name": "BDSA-2018-3169",
    "title": "Linux Kernel Vulnerable to Data Leakage via Use-After-Free in 'vhost_transport_send_pkt'",
    "description": "Linux kernel is vulnerable to data leakage due to an existing race condition in the current implementation of the AF_VSOCK protocol. This flaw can be leveraged to read arbitrary data from the underlying host's kernel's memory, outside the intended scope of the virtual machine guest. It is also possible to intercept or corrupt AF_VSOCK messages intended for other clients.",
    "technicalDescription": "A race condition between `connect()` and `close()` functions can be leveraged by an attacker to trigger a use-after-free bug in the `vhost_transport_send_pkt()` function. This can allow them to read 4 bytes of arbitrary memory from the kernel of the underlying host when running inside a guest VM. The flaw can be further exploited to intercept or corrupt AF_VSOCK messages intended for other clients.",
    "publishedDate": "2018-09-14T10:07:58.706Z",
    "updatedDate": "2019-02-05T13:11:16.667Z",
    "disclosureDate": "2018-07-30T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.9.145**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=569fc4ffb5de8f12fe01759f0b85098b7b9bba8e) commit,\n* [**4.14.88**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f15c072d6576c5e2b693c22e39ccc9103c952078) commit,\n* [**4.19.9**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f9cd25b1e5e575a5f18547bdc04ea40a23ad511a) commit, and\n* [**4.20-rc6**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=834e772c8db0c6a275d75315d90aba4ebbb1e249) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.5,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 1.4,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "syzbot",
    "workaround": "",
    "vendorFixDate": "2018-11-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-3169",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2018-14625",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-3169/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=569fc4ffb5de8f12fe01759f0b85098b7b9bba8e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=834e772c8db0c6a275d75315d90aba4ebbb1e249",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f15c072d6576c5e2b693c22e39ccc9103c952078",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f9cd25b1e5e575a5f18547bdc04ea40a23ad511a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://syzkaller.appspot.com/bug?extid=bd391451452fb0b93039",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-3169/default-remediation-status"
            }
        ]
    }
}