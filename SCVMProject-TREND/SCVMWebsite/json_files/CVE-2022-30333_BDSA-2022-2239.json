{
    "source": "BDSA",
    "name": "BDSA-2022-2239",
    "title": "RARLAB UnRAR Vulnerable to Malicious File Writes via Path Traversal with Normalized Symbolic Links",
    "description": "RARLAB UnRAR on Linux/UNIX systems is vulnerable to malicious file writes due to improper handling of symbolic links allowing path traversal. This could allow an attacker to write arbitrary files to a target system within the privileges of the UnRAR-running user. Depending on the operation of the system/application using UnRAR, this could be leveraged to supply maliciously crafted code which can be subsequently executed.\n\nWinRAR and Android RAR are unaffected by this issue.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "The issue exists within the file `ulinks.cpp`. The component improperly checks for UNIX path traversal payloads in symbolic links before the links are normalized (to accommodate archives which have been created on a Windows system but are then extracted on a UNIX system). This can allow an attacker to supply an archive to a Linux/UNIX system with symbolic links containing a Windows-formatted traversal payload, which will bypass validation and then be converted to an exploitable UNIX-formatted payload.",
    "publishedDate": "2022-08-11T13:40:05.089Z",
    "updatedDate": "2022-08-11T13:40:05.076Z",
    "disclosureDate": "2022-06-28T00:00:00.000Z",
    "exploitPublishDate": "2022-08-05T00:00:00.000Z",
    "solution": "Fixed in version [**6.12**](https://www.rarlab.com/download.htm) by [this](https://github.com/pmachapman/unrar/commit/22b52431a0581ab5d687747b65662f825ec03946) changeset.\n\nThe latest stable releases are available [here](https://www.rarlab.com/download.htm).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Simon Scannell (SonarSource)",
    "workaround": "",
    "vendorFixDate": "2022-05-06T00:00:00.000Z",
    "vendorNotifiedDate": "2022-05-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2239",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-30333",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2239/ranges"
            },
            {
                "rel": "reference",
                "href": "https://attackerkb.com/topics/RCa4EIZdbZ/cve-2022-30333/rapid7-analysis",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.sonarsource.com/zimbra-pre-auth-rce-via-unrar-0day/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pmachapman/unrar/commit/22b52431a0581ab5d687747b65662f825ec03946",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/167989/Zimbra-UnRAR-Path-Traversal.html",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://thehackernews.com/2022/08/cisa-issues-warning-on-active.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.rarlab.com/download.htm",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2239/default-remediation-status"
            }
        ]
    }
}