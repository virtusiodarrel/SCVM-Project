{
    "source": "BDSA",
    "name": "BDSA-2017-3097",
    "title": "Perl Vulnerable to Stack-Based Buffer Overflow via 'CPerlHost::Add' Function",
    "description": "Perl is vulnerable to a stack-based buffer overflow due to improper validation of environment variables. This could allow an attacker to create a denial-of-service (*DoS*), local code execution, and potentially remote code execution.",
    "technicalDescription": "Within the `CPerlHost::Add` function in `win32/perlhost.h`, the size of `lpStr`, the key passed in when indexing into `$ENV`, is not checked before it is copied into the fixed stack buffer `szBuffer`. An attacker can exploit this by crafting a malicious script file with a long environment variable, to be supplied to a victim running a Win32 build of Perl. When processed by the compiler this could result in an application crash, or allow arbitrary code execution on the victim's system. If environment variables can be remotely sourced, such as through custom headers on CGI scripts, then remote code execution may also be possible.",
    "publishedDate": "2018-05-04T14:34:56.846Z",
    "updatedDate": "2019-01-15T16:41:40.567Z",
    "disclosureDate": "2017-09-25T00:00:00.000Z",
    "exploitPublishDate": "2017-09-25T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* **[5.27.4](https://github.com/Perl/perl5/releases/tag/v5.27.4)**,\n* **[5.26.1-RC1](https://github.com/Perl/perl5/releases/tag/v5.26.1-RC1)**,\n* **[5.24.3-RC1](https://github.com/Perl/perl5/releases/tag/v5.24.3-RC1)** with [this](https://github.com/Perl/perl5/commit/8586647e338e8eb42c00fe6f687105c9b8a36d44) commit.\n\nThe latest stable releases are available [here](https://www.perl.org/get.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "John Leitch",
    "workaround": "",
    "vendorFixDate": "2017-07-27T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-3097",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-12814",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-3097/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Perl/perl5/commit/205f8363fb14aa2b2995fd16da66583bd6b47f4f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Perl/perl5/commit/8586647e338e8eb42c00fe6f687105c9b8a36d44",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Perl/perl5/commit/ac0e1777b3dc4b535bd7a4d64ce5076ad5007ac4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Perl/perl5/releases/tag/v5.24.3-RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Perl/perl5/releases/tag/v5.26.1-RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Perl/perl5/releases/tag/v5.27.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://rt.perl.org/Public/Bug/Display.html?id=131665",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://rt.perl.org/Public/Bug/Display.html?id=131665",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.perl.org/get.html",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}