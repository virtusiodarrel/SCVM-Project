{
    "source": "BDSA",
    "name": "BDSA-2020-2784",
    "title": "Linux Kernel Vulnerable to Man-in-the-Middle (MitM) Attacks via Geneve Used with IPsec",
    "description": "The Linux kernel is vulnerable to man-in-the-middle (MitM) attacks due to the traffic between two Generic Network Virtualization Encapsulation (Geneve) endpoints being unencrypted even though the underlying protocol is set to encrypt. This allows anyone between the two endpoints to read the unencrypted traffic, which may contain confidential information.",
    "technicalDescription": "This vulnerability applies to Geneve setups that use IPsec which is configured to encrypt traffic for the specific UDP port used by the Geneve tunnel.\n\nThe issue was fixed by adding transport port information for route lookups so that IPsec can select Geneve tunnel traffic to encrypt.",
    "publishedDate": "2020-10-15T11:01:33.937Z",
    "updatedDate": "2020-10-15T11:01:33.931Z",
    "disclosureDate": "2020-10-08T00:00:00.000Z",
    "exploitPublishDate": "2020-10-01T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.14.200**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=494648fc5286830b149bc1c1a059a827a45df3c8) commit\n* [**4.19.148**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c797110d97c48054d1491251fd713900ff51615c) commit\n* [**5.4.68**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=745c24fd1d79b588a951d3c5beca43575907f881) commit\n* [**5.8.12**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e76c0f41d7b1951ef4161e079c832c2e904fd29f) commit\n* [**5.9-rc7**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=34beb21594519ce64a55a498c2fe7d567bc1ca20) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mark Gray (Red Hat), Sabrina Dubroca (Red Hat)",
    "workaround": "To work around the issue it is suggested to configure IPsec for all traffic between the endpoints instead of the UDP port used by the Geneve tunnels only. This vulnerability will not be triggered if Geneve tunnels are not used, in which case the `geneve` kernel module can be unloaded and blacklisted.",
    "vendorFixDate": "2020-10-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2784",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-311"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25645",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2784/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1883988",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1883988",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=34beb21594519ce64a55a498c2fe7d567bc1ca20",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=494648fc5286830b149bc1c1a059a827a45df3c8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=745c24fd1d79b588a951d3c5beca43575907f881",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c797110d97c48054d1491251fd713900ff51615c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e76c0f41d7b1951ef4161e079c832c2e904fd29f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=494648fc5286830b149bc1c1a059a827a45df3c8",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2784/default-remediation-status"
            }
        ]
    }
}