{
    "source": "BDSA",
    "name": "BDSA-2019-0630",
    "title": "Spring Security OAuth Vulnerable to Authorization Code Disclosure via 'redirect_uri' Parameter",
    "description": "Spring Security OAuth is vulnerable to an open redirect attack that can leak an authorization code. A remote attacker can craft a malicious request to an authorization endpoint that redirects via the `redirect_uri` parameter, to an attacker controlled URI. The attacker can then steal a user's authorization code, create an account at the legitimate client and initiate the authorization flow.",
    "technicalDescription": "This flaw lies in the `/security/oauth2/provider/endpoint/DefaultRedirectResolver.java` source file. When OAuth acts in the role of an Authorization Server and uses the class `DefaultRedirectResolver` in the class `AuthorizationEndpoint`, it does not validate the value of the redirection URI in the `redirect_uri` parameter that a client can specify. \n\nThe `DefaultRedirectResolver` class fails to match the userinfo and query parts of requested URI to the registered URI of the client making the request.\n\nA remote attacker can craft a link that tricks a victim into believing they are going to authorize access to the legitimate client. When clicked, the authorization endpoint uses the authorization code grant type to cause the authorization server to redirect the resource owner user-agent to a URI under the control of the attacker with the leaked authorization code. An attacker can then create an account at a legitimate client and initiate the authorization flow.  \n\nThis vulnerability only exposes applications that meet all of the following requirements:\n* Act in the role of an Authorization Server (e.g. `@EnableAuthorizationServer`)\n* Uses the `DefaultRedirectResolver` in the `AuthorizationEndpoint`\n\nThis vulnerability does not expose applications that:\n* Act in the role of an Authorization Server and that use a `RedirectResolver` implementation other than `DefaultRedirectResolver`\n* Act in the role of a Resource Server only (e.g. `@EnableResourceServer`)\n* Act in the role of a Client only (e.g. `@EnableOAuthClient`)",
    "publishedDate": "2019-03-08T14:35:16.132Z",
    "updatedDate": "2022-07-18T09:10:37.218Z",
    "disclosureDate": "2019-02-21T00:00:00.000Z",
    "solution": "Fixed in:\n* [**2.0.17**](https://github.com/spring-projects/spring-security-oauth/releases/tag/2.0.17.RELEASE) by [this](https://github.com/spring-projects/spring-security-oauth/commit/da157a89402eeb2d5d071db3558c3b417bfc3ed0) commit,\n* [**2.1.4**](https://github.com/spring-projects/spring-security-oauth/releases/tag/2.1.4.RELEASE) by [this](https://github.com/spring-projects/spring-security-oauth/commit/16d39adbc04bb0cdf217226803d05d6956595d85) commit,\n* [**2.2.4**](https://github.com/spring-projects/spring-security-oauth/releases/tag/2.2.4.RELEASE) by [this](https://github.com/spring-projects/spring-security-oauth/commit/b436f745af2be24924ecc68524fd2582bcdfdc38) commit,\n* [**2.3.5**](https://github.com/spring-projects/spring-security-oauth/releases/tag/2.3.5.RELEASE) by [this](https://github.com/spring-projects/spring-security-oauth/commit/97e0b4ab282acbed3588e05be03d5a0c4dbf3367) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dirk Koehler",
    "workaround": "",
    "vendorFixDate": "2019-01-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0630",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-601"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3778",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0630/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-attic/spring-security-oauth/commit/03d924d84706ba262add59fc88b98c917d581f2f",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-attic/spring-security-oauth/commit/ba4956313a58cf3412682ea244c38268c223d7a1",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/commit/16d39adbc04bb0cdf217226803d05d6956595d85",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/commit/97e0b4ab282acbed3588e05be03d5a0c4dbf3367",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/commit/b436f745af2be24924ecc68524fd2582bcdfdc38",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/commit/da157a89402eeb2d5d071db3558c3b417bfc3ed0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/issues/1585",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/releases/tag/2.0.17.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/releases/tag/2.1.4.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/releases/tag/2.2.4.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security-oauth/releases/tag/2.3.5.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://pivotal.io/security/cve-2019-3778",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0630/default-remediation-status"
            }
        ]
    }
}