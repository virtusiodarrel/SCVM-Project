{
    "source": "BDSA",
    "name": "BDSA-2019-1948",
    "title": "Chamilo LMS Vulnerable to Remote Code Execution (RCE) via Malicious PHP File Upload Within Zip Archive",
    "description": "Chamilio LMS is vulnerable to a malicious PHP file upload through unsanitized ZIP input. A remote attacker could leverage this vulnerability to execute arbitrary code.",
    "technicalDescription": "The \"scorn\" file type is a ZIP archive containing a `imsmanifest.xml` file.  If a file of this type is uploaded to the `main/lp/lp_upload.php` endpoint, the server will accept this file and check the content of the zip file. If it finds any php files, it will set an error message but continue the process regardless. Chamilo LMS will then attempt to delete any files with the .php extension, but only in the first level of the zip archive. A directory containing php files will not have the contents deleted.\n\nKnowing the path and filename of the uploaded php file means the attacker can visit the appropriate URL to have arbitrary, unauthenticated code execution.",
    "publishedDate": "2019-07-01T15:52:53.821Z",
    "updatedDate": "2022-05-24T11:17:46.940Z",
    "disclosureDate": "2019-02-19T00:00:00.000Z",
    "solution": "Fixed in version [**1.11.10-beta.1**](https://github.com/chamilo/chamilo-lms/releases/tag/v1.11.10-beta.1) by [this](https://github.com/chamilo/chamilo-lms/commit/1c82459f142e67636b9241cef1d46b2b927547dd) commit.\n\nThe latest stable releases can be found [here](https://github.com/chamilo/chamilo-lms/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "0xecute",
    "workaround": "",
    "vendorFixDate": "2019-02-23T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1948",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13082",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1948/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/commit/1c82459f142e67636b9241cef1d46b2b927547dd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/pull/2821/files",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/releases/tag/v1.11.10-beta.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://support.chamilo.org/projects/1/wiki/Security_issues#Issue-39-2019-02-25-High-risk-high-impact-RCE-File-upload",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1948/default-remediation-status"
            }
        ]
    }
}