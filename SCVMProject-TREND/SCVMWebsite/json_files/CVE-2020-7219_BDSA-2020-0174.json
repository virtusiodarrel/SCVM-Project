{
    "source": "BDSA",
    "name": "BDSA-2020-0174",
    "title": "HashiCorp Consul Vulnerable to Unbounded Resource Usage via HTTP/RPC Services",
    "description": "HashiCorp Consul is vulnerable to denial-of-service (DoS) via large numbers of unauthenticated HTTP or RPC connections. An attacker can take advantage of this to generate excessive load on the server or crash it.",
    "technicalDescription": "Consul makes use of HTTP to allow communication between cluster members and control/administration of Consul servers. It also uses RPC so that Consul agents can make a request of a server. Both protocols support end-to-end TLS with optional client authentication.  \n\nBy establishing large numbers of unauthenticated HTTP or RPC connection an attacker can consume excessive resources on the server or potentially crash it. Authentication via mutual TLS isn't required to launch an attack.",
    "publishedDate": "2020-02-10T14:39:57.911Z",
    "updatedDate": "2021-12-28T13:14:06.943Z",
    "disclosureDate": "2020-01-29T00:00:00.000Z",
    "solution": "Fixed in [**1.6.3**](https://github.com/hashicorp/consul/releases/tag/v1.6.3) by [this](https://github.com/hashicorp/consul/commit/b788f729e9653d4a81691cbccedca2a2ac06f5ea) commit.\n\nFixed in [**API/1.4.0**](https://github.com/hashicorp/consul/releases/tag/api%2Fv1.4.0) by [this](https://github.com/hashicorp/consul/commit/5531678e9eb7c5548df8fa86e9e77a573c233e46) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "i0rek",
    "workaround": "The vendor has given the following advice for mitigation:\n\nRestrict connectivity to Consul servers to trusted sources/networks only. TCP ports used by Consul for HTTP, HTTPS, and RPC default to 8500, 8501, and 8300.\n\nRestrict resource usage on Consul servers by enforcing network connection limits. For example,\n`iptables -A INPUT -p tcp --syn --dport 8300 -m connlimit --connlimit-above 100 -j REJECT --reject-with tcp-reset`.\n\nEnabling TLS for RPC between agents as a defense-in-depth mechanism for Consul clusters, per documentation, remains strongly recommended.",
    "vendorFixDate": "2020-01-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0174",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-770"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7219",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0174/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/5531678e9eb7c5548df8fa86e9e77a573c233e46",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/b788f729e9653d4a81691cbccedca2a2ac06f5ea",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/issues/7159",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/issues/7159",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/api%2Fv1.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.6.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0174/default-remediation-status"
            }
        ]
    }
}