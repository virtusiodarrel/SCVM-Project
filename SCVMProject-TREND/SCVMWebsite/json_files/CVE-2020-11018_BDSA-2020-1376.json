{
    "source": "BDSA",
    "name": "BDSA-2020-1376",
    "title": "FreeRDP Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Read in 'cliprdr_server_receive_capabilities'",
    "description": "FreeRDP is vulnerable to an out-of-bounds read that could result in resource exhaustion due to memory allocation of random size given malicious input. An attacker could exploit this issue by sending specially crafted input to the application which could cause denial-of-service (DoS).",
    "technicalDescription": "The `cliprdr_server_receive_capabilities` function in `channels/cliprdr/server/cliprdr_main.c` does not check if there are enough bytes remaining (at least 4) in the stream `s` before reading from it. As well as this, there are no checks on the variable`cap_sets_size` before memory is reallocated which could result in various memory sizes being used and potentially lead to resource exhaustion. When an attacker supplies malicious input these issues could result in an out-of-bounds buffer read or resource exhaustion resulting in denial-of-service (DoS).",
    "publishedDate": "2020-06-11T10:41:41.054Z",
    "updatedDate": "2020-06-11T10:41:41.047Z",
    "disclosureDate": "2020-05-29T00:00:00.000Z",
    "solution": "Fixed in **[2.1.0](https://github.com/FreeRDP/FreeRDP/releases/tag/2.1.0)** by [this](https://github.com/FreeRDP/FreeRDP/commit/495cb2e31) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "hac425",
    "workaround": "The vendor supplied the following workaround:\n> Deactivate FreeRDP clipboard support on your server",
    "vendorFixDate": "2020-04-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1376",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11018",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1376/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FreeRDP/FreeRDP/commit/495cb2e31",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FreeRDP/FreeRDP/releases/tag/2.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FreeRDP/FreeRDP/security/advisories/GHSA-8cvc-vcw7-6mfw",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FreeRDP/FreeRDP/security/advisories/GHSA-8cvc-vcw7-6mfw",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1376/default-remediation-status"
            }
        ]
    }
}