{
    "source": "BDSA",
    "name": "BDSA-2020-4242",
    "title": "QEMU Vulnerable to Privilege Escalation in 'xattrmap' Functionality",
    "description": "QEMU is vulnerable to privilege escalation due to the `xattrmap`option. Attackers could exploit this allowing them to create privileged executables or potentially elevate their privileges.",
    "technicalDescription": "This vulnerability exists within the `tools/virtiofsd/passthrough_ll.c` file. This is due to the  `xattrmap` option, `xattrmap` allows for `security.capability` xattr to not drop on a file write, creating a privileged executable, as the permissions are incorrectly preserved. This allows for `security.capability`to give a limited form of privilege escalation to programs predefined by the file writer. To be vulnerable to this attack, unprivileged users must have the ability to write to privileged executables. An authenticated local attacker without admin credentials could exploit this by crafting a malicious request to cause a modified privileged executable in most cases. In rare cases attackers could exploit this further to elevate their privileges, as a result from them having less restrictive permissions than intended.\n\n**Note:** The vendor has stated for this issue to be exploited `security.capability`  xattrs is being renamed,and `virtiofsd` needs to be running with `-o xattr` and `-o xattrmap` for this to be achievable.",
    "publishedDate": "2021-03-11T11:50:39.858Z",
    "updatedDate": "2021-04-12T11:22:58.876Z",
    "disclosureDate": "2021-03-08T00:00:00.000Z",
    "solution": "Fixed in [**6.0.0-rc0**](https://git.qemu.org/?p=qemu.git;a=tag;h=refs/tags/v6.0.0-rc0) by [this](https://github.com/qemu/qemu/commit/e586edcb410543768ef009eaa22a2d9dd4a53846) commit.\n\nThe latest stable releases are available [here](https://www.qemu.org/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.1,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "David Alan Gilbert",
    "workaround": "",
    "vendorFixDate": "2020-10-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4242",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-281"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20263",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4242/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.qemu.org/?p=qemu.git;a=tag;h=refs/tags/v6.0.0-rc0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/qemu/qemu/commit/6084633dff3a05d6317",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/qemu/qemu/commit/e586edcb410543768ef009eaa22a2d9dd4a53846",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/03/08/1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.qemu.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4242/default-remediation-status"
            }
        ]
    }
}