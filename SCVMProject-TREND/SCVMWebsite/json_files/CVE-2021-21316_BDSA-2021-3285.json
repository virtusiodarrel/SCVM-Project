{
    "source": "BDSA",
    "name": "BDSA-2021-3285",
    "title": "Node.js 'less-openui5' Package Vulnerable to Arbitrary Code Execution via Untrusted Theming Resources",
    "description": "less-openui5 is vulnerable to arbitrary code execution due to how JavaScript code contained in theming resources is executed in the context of the build process.\n\nThis issue could allow an attacker to hide malicious JavaScript code in a resource for it to then be executed when the build process is commenced.\n\n**Note**: This is a feature of the `Less.js` library, however, it is unexpected behavior in the context of OpenUI5 and poses this security issue.",
    "technicalDescription": "less-openui5 is vulnerable to arbitrary code execution because theming resources (`.less` files) that contain JavaScript are processed in such a way that the JavaScript is executed during the build process. An attacker could create a `library` or `theme-library` that contains a custom control or theme and hide malicious JavaScript code in one of the `.less` files in order to execute malicious code in the context of the build process.\n\nIn order to remedy this issue, the vendor has disabled the inline JavaScript evaluation feature completely by removing the `javascriptEnabled` parser option.",
    "publishedDate": "2021-11-01T15:54:04.882Z",
    "updatedDate": "2021-11-01T15:54:04.867Z",
    "disclosureDate": "2021-01-29T00:00:00.000Z",
    "exploitPublishDate": "2021-01-29T00:00:00.000Z",
    "solution": "Fixed in [**0.10.0**](https://github.com/SAP/less-openui5/releases/tag/v0.10.0) by [this](https://github.com/SAP/less-openui5/commit/c0d3a8572974a20ea6cee42da11c614a54f100e8) commit.\n\nThe latest stable releases are available [here](https://www.npmjs.com/package/less-openui5).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.4,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has suggested [here](https://github.com/SAP/less-openui5/security/advisories/GHSA-3crj-w4f5-gwh4) that apart from upgrading, users can ensure to only process trusted theming resources in order to avoid this issue.",
    "vendorFixDate": "2021-01-29T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3285",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21316",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3285/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/SAP/less-openui5/commit/c0d3a8572974a20ea6cee42da11c614a54f100e8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/SAP/less-openui5/releases/tag/v0.10.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/SAP/less-openui5/security/advisories/GHSA-3crj-w4f5-gwh4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/SAP/less-openui5/security/advisories/GHSA-3crj-w4f5-gwh4",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/SAP/less-openui5/security/advisories/GHSA-3crj-w4f5-gwh4",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-3crj-w4f5-gwh4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/less-openui5",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3285/default-remediation-status"
            }
        ]
    }
}