{
    "source": "BDSA",
    "name": "BDSA-2021-3501",
    "title": "aws-sdk Vulnerable to Prototype Pollution via 'loadSharedConfigFiles' Function",
    "description": "aws-sdk is vulnerable to prototype pollution due to the improper validation of files that are to be processed by the application. An attacker could modify the prototypes of objects in memory by causing a vulnerable endpoint to process a maliciously crafted INI file. The exact impact that the attacker can achieve will depend on how the affected object is used, but could potentially include cross-site scripting (XSS) and remote code execution (RCE).",
    "technicalDescription": "aws-sdk contains the `shared-ini-file-loader` module, which can be used to process INI files. INI files are processed using the function `loadSharedConfigFiles()`, which is defined in the file `packages/shared-ini-file-loader/src/index.ts`. `loadSharedConfigFiles()` invokes `parseIni()` in order to carry out the parsing of the INI file. This involves processing each of the INI file sections. The INI file sections are used to derive the attributes of objects which are to be created or modified in memory. The names of the sections are insufficiently validated, such that an attacker could use a maliciously crafted INI file which contains a profile name of `__proto__` in order to perform prototype pollution attacks. The exact impact that the attacker can achieve will depend on how the affected object is used, but could potentially include cross-site scripting (XSS) and remote code execution (RCE).\n\nThe vulnerability was fixed via the addition of code which ensures that sections with a name of `__proto__` will be rejected.",
    "publishedDate": "2021-11-19T16:53:57.339Z",
    "updatedDate": "2022-01-14T11:12:57.533Z",
    "disclosureDate": "2021-01-14T00:00:00.000Z",
    "exploitPublishDate": "2021-01-14T00:00:00.000Z",
    "solution": "Fixed in AWS SDK v2 version [**2.814.0**](https://github.com/aws/aws-sdk-js/releases/tag/v2.814.0) by [this](https://github.com/aws/aws-sdk-js/commit/dd83d672170e8cc0c52a20df29a43e7663e5336a) commit.\n\nThe latest stable releases can be found [here](https://github.com/aws/aws-sdk-js/releases).\n\nFixed in AWS SDK v3 version [**1.0.0-rc9**](https://github.com/aws/aws-sdk-js-v3/releases/tag/v1.0.0-rc.9) by [this](https://github.com/aws/aws-sdk-js-v3/commit/a209082dff913939672bb069964b33aa4c5409a9) commit.\n\nThe latest stable releases can be found [here](https://github.com/aws/aws-sdk-js-v3/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Eugene Lim (Government Technology Agency Cyber Security Group)",
    "workaround": "",
    "vendorFixDate": "2020-12-11T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3501",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-915"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28472",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3501/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-sdk-js-v3/commit/a209082dff913939672bb069964b33aa4c5409a9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-sdk-js-v3/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-sdk-js-v3/releases/tag/v1.0.0-rc.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-sdk-js/commit/dd83d672170e8cc0c52a20df29a43e7663e5336a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-sdk-js/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-sdk-js/releases/tag/v2.814.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-AWSSDK-1059424",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-AWSSDK-1059424",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-AWSSDKSHAREDINIFILELOADER-1049304",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-AWSSDKSHAREDINIFILELOADER-1049304",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3501/default-remediation-status"
            }
        ]
    }
}