{
    "source": "BDSA",
    "name": "BDSA-2019-3142",
    "title": "GLPI Vulnerable to Account Takeover via Information Disclosure in Autocompletion Feature",
    "description": "GLPI is vulnerable to account takeover due to information disclosure within the autocomplete feature in the forgotten password form.\n\nAn attacker is able to exploit this feature to extract both emails and forgotten password tokens and use this information to takeover any user's account including super-admin.",
    "technicalDescription": "A list of email addresses can be extracted from `/glpi/ajax/autocompletion.php?itemtype=UserEmail&field=email&term=`. A list of generated tokens in cleartext can also be extracted via `/glpi/ajax/autocompletion.php?itemtype=User&field=password_forget_token&term=`.\n\nAn attacker can use the email address within the forgotten password form. This will invoke a newly generated token. By getting a second list of generated tokens, the newly generated token can be identified by comparing both lists. \n\nA new password can be set for this user using ` /glpi/front/lostpassword.php?password_forget_token=[new_token]` and inputting the new token, resulting in account takeover. \n\nThis can only be exploited if \"lost password\" feature is enabled.",
    "publishedDate": "2019-10-09T14:12:42.474Z",
    "updatedDate": "2019-10-09T14:12:42.457Z",
    "disclosureDate": "2019-09-04T00:00:00.000Z",
    "exploitPublishDate": "2019-09-04T00:00:00.000Z",
    "solution": "Fixed in [**9.4.4**](https://github.com/glpi-project/glpi/releases/tag/9.4.4) by [this](https://github.com/glpi-project/glpi/commit/339b856273f2cf5cb409e6db1a2689a418c5a051) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Pablo Martinez",
    "workaround": "",
    "vendorFixDate": "2019-07-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3142",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-525"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-640"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14666",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3142/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/commit/339b856273f2cf5cb409e6db1a2689a418c5a051",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/releases/tag/9.4.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/security/advisories/GHSA-47hq-pfrr-jh5q",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.tarlogic.com/advisories/Tarlogic-2019-GPLI-Account-Takeover.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.tarlogic.com/advisories/Tarlogic-2019-GPLI-Account-Takeover.txt",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3142/default-remediation-status"
            }
        ]
    }
}