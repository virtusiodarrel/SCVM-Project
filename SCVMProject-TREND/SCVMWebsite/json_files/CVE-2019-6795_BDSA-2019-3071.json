{
    "source": "BDSA",
    "name": "BDSA-2019-3071",
    "title": "Gitlab Vulnerable to Homograph and Right-to-Life Override (RTLO) Attacks via Improper Handling of Unicode Encoding",
    "description": "Gitlab is vulnerable to internationalized domain name (IDN) homograph and right to left override (RTLO) attacks due to an improper handling of unicode encoding. An attacker can create URLs that users would struggle to distinguish if the URL is malicious. These could be exploited to conduct phishing attacks.",
    "technicalDescription": "RTLO character is used for languages that are read and written from right to left. This character can be used in constructing malicious URLs. IDN's are currently being encoded using Unicode and not in Punycode, allowing misinterpretation of homographs. Both of these flaws allow attackers to form URLs that look safe for a user to navigate to, however are actually linking to an attacker-controlled domain.\n\nFor the IDN homographs, it was addressed for Banzai pipelines by displaying tooltips in URLs to display the punycode to make it more visible that links may be dangerous. For auto-linked URLs, RTLO characters are now escaped.",
    "publishedDate": "2019-09-26T15:02:38.450Z",
    "updatedDate": "2019-09-26T15:02:38.435Z",
    "disclosureDate": "2019-03-13T00:00:00.000Z",
    "exploitPublishDate": "2019-03-13T00:00:00.000Z",
    "solution": "Fixed  in the following versions:\n* [**11.5.8**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags) by [this](https://github.com/gitlabhq/gitlabhq/commit/7d847369f9e5486e6539de73ed693f16d9ae3715) commit.\n*  [**11.6.6**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags) by [this](https://github.com/gitlabhq/gitlabhq/commit/b8c23dbb8e75918bad6dddada4c21212936bba56) commit.\n*  [**11.7.1**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags) by [this](https://github.com/gitlabhq/gitlabhq/commit/a3dfd6acb94465b566800c3669decbe384caf478) commit.\n* [**11.8.0-rc1**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags) by [this](https://github.com/gitlabhq/gitlabhq/commit/08cc2ab8210d9ebfc8ade99eb3c7fc5f6039854f) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "edoverflow",
    "workaround": "",
    "vendorFixDate": "2019-01-24T00:00:00.000Z",
    "vendorNotifiedDate": "2017-03-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3071",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-1007"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-176"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-451"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-6795",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3071/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/2019/01/31/security-release-gitlab-11-dot-7-dot-3-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gitlabhq/gitlabhq/commit/08cc2ab8210d9ebfc8ade99eb3c7fc5f6039854f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/issues/29365",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/issues/29365",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3071/default-remediation-status"
            }
        ]
    }
}