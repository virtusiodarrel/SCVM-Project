{
    "source": "BDSA",
    "name": "BDSA-2022-0003",
    "title": "Django Vulnerable to Information Disclosure via Insufficient Restrictions for 'dictsort' Functionality",
    "description": "Django is vulnerable to information disclosure due to insufficient restrictions being placed on the resolution logic of the `dictsort` template filter. An attacker could potentially recover sensitive information from a vulnerable application by invoking the `dictsort` functionality with a maliciously crafted key. The attacker could also potentially leverage this issue in order to trigger unintended method calls.",
    "technicalDescription": "Django's `dictsort` template filter functionality makes use of code that is contained in the file `django/template/defaultfilters.py`. The `_property_resolver()` method can be used to obtain the value which is associated with the key being processed by `dictsort`. If the argument that is passed to this function (`arg`) cannot be converted to a `float` type value, then a `TypeError` is raised. The exception handler for this error invokes `Variable(arg).resolve`. This implementation is unsafe, such that sensitive information that is being stored in a dictionary or dictionary-like object, and which is not intended to be available to end-users, can be recovered if certain values are being resolved by `dictsort`. An attacker may also be able to leverage this issue to trigger unintended method calls.\n\nThe vulnerability was patched via the addition of validation logic to the exception handler which ensures that private variables cannot be resolved.",
    "publishedDate": "2022-01-06T10:05:10.943Z",
    "updatedDate": "2022-06-28T13:40:15.998Z",
    "disclosureDate": "2022-01-04T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**4.0.1**](https://github.com/django/django/releases/tag/4.0.1) by [this](https://github.com/django/django/commit/2a8ec7f546d6d5806e221ec948c5146b55bd7489) commit.\n* [**3.2.11**](https://github.com/django/django/releases/tag/3.2.11) by [this](https://github.com/django/django/commit/c7fe895bca06daf12cc1670b56eaf72a1ef27a16) commit.\n* [**2.2.26**](https://github.com/django/django/releases/tag/2.2.26) by [this](https://github.com/django/django/commit/c9f648ccfac5ab90fb2829a66da4f77e68c7f93a) commit.\n\nThe latest stable releases can be found [here](https://www.djangoproject.com/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dennis Brinkrolf",
    "workaround": "",
    "vendorFixDate": "2022-01-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0003",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-749"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-45116",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0003/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/2a8ec7f546d6d5806e221ec948c5146b55bd7489",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/c7fe895bca06daf12cc1670b56eaf72a1ef27a16",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/c9f648ccfac5ab90fb2829a66da4f77e68c7f93a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/e81d1c995c0cc5573d3627de0fe6b803b2f43fb2",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/2.2.26",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/3.2.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/4.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/weblog/2022/jan/04/security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0003/default-remediation-status"
            }
        ]
    }
}