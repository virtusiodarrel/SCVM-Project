{
    "source": "BDSA",
    "name": "BDSA-2021-0380",
    "title": "Python Vulnerable to Web Cache Poisoning via 'urllib.parse.parse_qsl()' and 'urllib.parse.parse_qs()' Functions",
    "description": "Python is vulnerable to web cache poisoning due to discrepancies in how proxies and servers view parameter separators. A remote attacker could cause victims to be served malicious content by sending crafted HTTP requests to a vulnerable server.",
    "technicalDescription": "Python's URL library processes HTTP query strings using a variety of functions, such as `parse_qs()` and `parse_qsl()` of file `parse.py`. Different parameters are identified using a separator character, which is typically referred to via the `separator` variable in the code. Separator characters are not viewed consistently between proxy instances and server instances, which will cause proxies and servers to process requests differently. This can lead to malicious requests being cached as if they were safe, which in turn can lead to clients being served malicious content.",
    "publishedDate": "2021-02-16T16:14:18.042Z",
    "updatedDate": "2021-03-18T17:05:27.517Z",
    "disclosureDate": "2021-01-18T00:00:00.000Z",
    "exploitPublishDate": "2021-01-18T00:00:00.000Z",
    "solution": "Fixed in: \n * [**3.6.13**](https://github.com/python/cpython/releases/tag/v3.6.13) by [this](https://github.com/python/cpython/commit/5c17dfc5d70ce88be99bc5769b91ce79d7a90d61) commit,\n * [**3.7.10**](https://github.com/python/cpython/releases/tag/v3.7.10) by [this](https://github.com/python/cpython/commit/d0d4d30882fe3ab9b1badbecf5d15d94326fd13e) commit,\n* [**3.8.8-RC1**](https://github.com/python/cpython/releases/tag/v3.8.8rc1) by  [this](https://github.com/python/cpython/commit/e3110c3cfbb7daa690d54d0eff6c264c870a71bf) commit,\n* [**3.9.2-RC1**](https://github.com/python/cpython/releases/tag/v3.9.2rc1) by [this](https://github.com/python/cpython/commit/c9f07813ab8e664d8c34413c4fc2d4f86c061a92) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-02-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0380",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23336",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0380/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue42967",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue42967",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/5c17dfc5d70ce88be99bc5769b91ce79d7a90d61",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/c9f07813ab8e664d8c34413c4fc2d4f86c061a92",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/d0d4d30882fe3ab9b1badbecf5d15d94326fd13e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/e3110c3cfbb7daa690d54d0eff6c264c870a71bf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/pull/24297",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.6.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.7.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.8.8rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.9.2rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0380/default-remediation-status"
            }
        ]
    }
}