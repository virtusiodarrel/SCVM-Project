{
    "source": "BDSA",
    "name": "BDSA-2021-1225",
    "title": "handlebars.js Vulnerable to Prototype Pollution via 'compat' Compilation Mode on Untrusted Templates",
    "description": "handlebars.js, an extension to the Mustache templating language, is vulnerable to Prototype Pollution when compiling templates that come from untrusted sources. Although successful exploitation could result in remote code execution (RCE), it also requires that a certain compilation option is used.",
    "technicalDescription": "Prototype pollution is possible in `compat` compilation mode.\n\nThe vulnerability was fixed by escaping property names in `compat` mode.",
    "publishedDate": "2021-05-05T08:28:34.879Z",
    "updatedDate": "2021-06-16T08:50:33.172Z",
    "disclosureDate": "2021-05-04T00:00:00.000Z",
    "exploitPublishDate": "2021-05-04T00:00:00.000Z",
    "solution": "Fixed in [**4.7.7**](https://github.com/handlebars-lang/handlebars.js/releases/tag/v4.7.7) by [this](https://github.com/handlebars-lang/handlebars.js/commit/f0589701698268578199be25285b2ebea1c1e427) commit.\n\nThe latest stable releases are available [here](https://github.com/handlebars-lang/handlebars.js/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Francois Lajeunesse-Robert",
    "workaround": "",
    "vendorFixDate": "2021-02-13T00:00:00.000Z",
    "vendorNotifiedDate": "2021-01-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1225",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23383",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1225/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/commit/f0589701698268578199be25285b2ebea1c1e427",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/commit/f0589701698268578199be25285b2ebea1c1e427",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/releases/tag/v4.7.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-HANDLEBARS-1279029",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-HANDLEBARS-1279029",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1225/default-remediation-status"
            }
        ]
    }
}