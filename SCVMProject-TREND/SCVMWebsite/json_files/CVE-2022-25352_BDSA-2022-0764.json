{
    "source": "BDSA",
    "name": "BDSA-2022-0764",
    "title": "libnested Vulnerable to Prototype Pollution via Insufficient Input Validation in 'set' Function",
    "description": "The libnested NPM package is vulnerable to prototype pollution due to the insufficient validation of untrusted input. An attacker could modify the prototypes of objects in memory if they can control the input to the `set()` function. The exact impact that the attacker can achieve will depend on how an affected object is used, but could potentially include denial-of-service (DoS) and remote code execution (RCE).\n\nNote: This vulnerability exists due to an incomplete fix for **CVE-2020-28283** (**BDSA-2020-4753**).",
    "technicalDescription": "The `set()` method, of file `index.js`, has three parameters (`obj`, `path` and `value`). This function is used to set a given property of the `obj` object to the value which is specified in the `value` parameter. The property which is to be modified is derived from the `path` parameter. Validation is performed on the value of `path` in order to detect attempts to modify the `__proto__`, `constructor` or `prototype` properties. However, the validation that is performed is insufficient. An attacker could leverage this issue in order to conduct a prototype pollution attack. The exact impact that the attacker can achieve will depend on how the object is used, but could potentially include denial-of-service (DoS) and remote code execution (RCE).",
    "publishedDate": "2022-03-21T17:06:11.617Z",
    "updatedDate": "2022-03-21T17:06:11.602Z",
    "disclosureDate": "2022-03-07T00:00:00.000Z",
    "exploitPublishDate": "2022-03-07T00:00:00.000Z",
    "solution": "Fixed in version [**1.5.2**](https://github.com/dominictarr/libnested/releases/tag/v1.5.2) by [this](https://github.com/dominictarr/libnested/commit/c1129865d75fbe52b5a4f755ad3110ca5420f2e1) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/libnested).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Idan Digmi (Snyk Security)",
    "workaround": "",
    "vendorFixDate": "2022-03-07T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0764",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-915"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-25352",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0764/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-x5m8-2r8v-8f97",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dominictarr/libnested/commit/c1129865d75fbe52b5a4f755ad3110ca5420f2e1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dominictarr/libnested/releases/tag/v1.5.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-LIBNESTED-2342117",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-LIBNESTED-2342117",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/libnested",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0764/default-remediation-status"
            }
        ]
    }
}