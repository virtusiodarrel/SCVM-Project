{
    "source": "BDSA",
    "name": "BDSA-2021-2382",
    "title": "OpenStack Keystone Vulnerable to Information Disclosure and Account Lockout via 'AccountLocked' Exception",
    "description": "OpenStack Keystone is vulnerable to information disclosure on user accounts. This could allow an attacker to call authorization tokens on behalf another users account and lock out users indefinitely.",
    "technicalDescription": "This vulnerability exists due to the `AccountLocked` exception from `keystone/notifications.py` being returned to the end user. An attacker can take advantage of this by repeatedly trying to login with another users username, and a random password, after `lockout_failure_attempts` attempts the account will be locked and the server will return the `AccountLocked` exception to the attacker saying the account is locked and stating the user's ID. The attacker can then use this user ID to call authorization tokens on behalf of that account and lock out the user indefinitely.\n\nThe vendor has mitigated against this by only displaying the `AccountLocked` exception to an end user if the password used in a login attempt was correct.",
    "publishedDate": "2021-08-10T10:41:02.851Z",
    "updatedDate": "2022-06-06T16:03:29.121Z",
    "disclosureDate": "2021-08-06T00:00:00.000Z",
    "exploitPublishDate": "2021-08-06T00:00:00.000Z",
    "solution": "Fixed in:\n* **[16.0.2](https://github.com/openstack/keystone/releases/tag/16.0.2)** by [this](https://github.com/openstack/keystone/commit/c65455965) commit\n* **[17.0.1](https://github.com/openstack/keystone/releases/tag/17.0.1)** by [this](https://github.com/openstack/keystone/commit/2cf2912fd) commit\n* **[18.1.0](https://github.com/openstack/keystone/releases/tag/18.1.0)** by [this](https://github.com/openstack/keystone/commit/4649fe6bf) commit\n* **[20.0.0.0-rc1](https://github.com/openstack/keystone/releases/tag/20.0.0.0rc1)** by [this](https://github.com/openstack/keystone/commit/63ef8f81f) commit\n\nThe latest stable releases are available [here](https://github.com/openstack/keystone/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Samuel de Medeiros Queiroz",
    "workaround": "",
    "vendorFixDate": "2021-05-10T00:00:00.000Z",
    "vendorNotifiedDate": "2017-05-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2382",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-645"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-38155",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2382/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/keystone/+bug/1688137",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/keystone/+bug/1688137",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/2cf2912fd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/4649fe6bf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/63ef8f81f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/c65455965",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/releases/tag/16.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/releases/tag/17.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/releases/tag/18.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/releases/tag/20.0.0.0rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2382/default-remediation-status"
            }
        ]
    }
}