{
    "source": "BDSA",
    "name": "BDSA-2020-1245",
    "title": "Apache Kylin Vulnerable to OS Command Injection via Insufficient Validation in Cube Restful API",
    "description": "Apache Kylin is vulnerable to OS command injection due to insufficient validation of user controlled data in Cube restful API. An attacker with access to the cube migration functionality could exploit this vulnerability to execute arbitrary OS commands.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "The Cube restful API contains an OS command injection due to how the command `cmd` concatenates user controlled input into the command with no validation. The command is then executed within the `execute` function. The vulnerable `cmd` can be found in the `migrateCube` function in `server-base/src/main/java/org/apache/kylin/rest/service/CubeService.java`.",
    "publishedDate": "2020-05-28T14:23:13.375Z",
    "updatedDate": "2022-05-06T14:47:55.840Z",
    "disclosureDate": "2020-05-20T00:00:00.000Z",
    "exploitPublishDate": "2021-07-08T00:00:00.000Z",
    "solution": "Fixed in **[3.0.2](https://github.com/apache/kylin/releases/tag/kylin-3.0.2)** by [this](https://github.com/apache/kylin/commit/58fad56ac) commit and [this](https://github.com/apache/kylin/commit/c5dda34f6) and in **[2.6.6](https://github.com/apache/kylin/releases/tag/kylin-2.6.6)** by [this](https://github.com/apache/kylin/commit/0888c867a) commit and [this](https://github.com/apache/kylin/commit/9c87a299d) commit.\n\nThe latest stable releases are available [here](https://kylin.apache.org/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Johannes Dahse",
    "workaround": "The vendor recommends to set `kylin.tool.auto-migrate-cube.enabled` to `false` to prevent this issue.",
    "vendorFixDate": "2020-05-06T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1245",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-1956",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1245/ranges"
            },
            {
                "rel": "reference",
                "href": "https://community.sonarsource.com/t/tech-story-apache-kylin-3-0-1-command-injection-vulnerability/25706",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/kylin/commit/0888c867a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/kylin/commit/58fad56ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/kylin/commit/9c87a299d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/kylin/commit/a41a7e7d3a97197a16360ab41e94d9ee5c77ebc6",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/kylin/commit/c5dda34f6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/kylin/releases/tag/kylin-2.6.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/kylin/releases/tag/kylin-3.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/b510/CVE-2020-1956",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://kylin.apache.org/docs/security.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://kylin.apache.org/docs/security.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://kylin.apache.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/r1332ef34cf8e2c0589cf44ad269fb1fb4c06addec6297f0320f5111d%40%3Cuser.kylin.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/r1332ef34cf8e2c0589cf44ad269fb1fb4c06addec6297f0320f5111d%40%3Cuser.kylin.apache.org%3E",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1245/default-remediation-status"
            }
        ]
    }
}