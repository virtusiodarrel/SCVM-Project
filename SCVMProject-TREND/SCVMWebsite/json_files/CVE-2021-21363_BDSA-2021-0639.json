{
    "source": "BDSA",
    "name": "BDSA-2021-0639",
    "title": "swagger-codegen Vulnerable to Privilege Escalation via Race Condition During Temporary Subdirectory Creation",
    "description": "swagger-codegen is vulnerable to privilege escalation due to a race condition that arises during temporary subdirectory creation. A local user could leverage the race condition to create the temporary subdirectory with their own generated code before swagger does. This would elevate the attacker's privileges once the generated code is executed.",
    "technicalDescription": "The race condition appears in the method `getTmpFolder()`, of file `modules/swagger-generator/src/main/java/io/swagger/generator/online/Generator.java`. The attacker could detect when a temporary file is created via the call to `File.createTempFile(\"codegen-\", \"-tmp\");`. The purpose of the call is to create a `File` object that is configured to reside in the system's default temporary directory. Since the new temporary subdirectory is created right after the call (using the `File` object), there is a time window where the attacker could create the subdirectory before swagger does. This would allow the attacker to gain control of the generated code in the directory.\n\nThe vulnerability was fixed by replacing `File.createTempFile` with a straight call to `Files.createTempDirectory(\"codegen-\").toFile()`. This eliminates the race condition and sets the correct file permissions.",
    "publishedDate": "2021-03-12T17:02:52.888Z",
    "updatedDate": "2021-03-12T17:02:52.884Z",
    "disclosureDate": "2021-03-09T00:00:00.000Z",
    "solution": "Fixed in **[2.4.19](https://github.com/swagger-api/swagger-codegen/releases/tag/v2.4.19)** by [this](https://github.com/swagger-api/swagger-codegen/commit/987ea7a30) commit.\n\nThe latest stable releases are available [here](https://github.com/swagger-api/swagger-codegen/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.9,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jonathan Leitschuh",
    "workaround": "",
    "vendorFixDate": "2021-03-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0639",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-378"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21363",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0639/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/swagger-api/swagger-codegen/commit/987ea7a30",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/swagger-api/swagger-codegen/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/swagger-api/swagger-codegen/releases/tag/v2.4.19",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/swagger-api/swagger-codegen/security/advisories/GHSA-pc22-3g76-gm6j",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0639/default-remediation-status"
            }
        ]
    }
}