{
    "source": "BDSA",
    "name": "BDSA-2019-0735",
    "title": "Jenkins Script Security Plugin Vulnerable to Sandbox Bypass and Remote Code Execution via Crafted Groovy Script",
    "description": "Jenkins Script Security plugin is vulnerable to sandbox bypass due to a flaw in how it parses, compiles, and instantiates Groovy scripts. A remote attacker with Overall/Read permissions can supply a malicious Groovy script that bypasses the sandbox protection and allows the execution of arbitrary code on the Jenkins master and agents.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "Jenkins features a Groovy script console which allows a user to run arbitrary Groovy scripts within the Jenkins master runtime or in the runtime on agents.  The Script Security plugin does not properly validate Groovy scripts in this console and allows a remote attacker to invoke a Constructor to execute arbitrary code. The sandbox protection can be circumvented during parsing, compilation, and script instantiation.\n\nThis flaw is present in source files `src/main/java/org/jenkinsci/plugins/scriptsecurity/sandbox/groovy/SecureGroovyScript.java` and `src/main/java/org/jenkinsci/plugins/scriptsecurity/sandbox/groovy/GroovySandbox.java` and affects both script execution (typically invoked from other plugins) and any HTTP endpoint providing script validation. A remote attacker with Overall/Read permission can bypass the sandbox protection and execute arbitrary code on the Jenkins master and agents.\n\nThe API `GroovySandbox#run(Script, Whitelist)` has been deprecated and replaced by `GroovySandbox#run(GroovyShell, String, Whitelist)`. The deprecated API now emits a warning to the system log about potential security problems. \n\n`GroovySandbox#checkScriptForCompilationErrors(String, GroovyClassLoader)` has been added as a safer method to implement script validation.",
    "publishedDate": "2019-03-14T15:46:36.298Z",
    "updatedDate": "2022-05-09T13:36:35.641Z",
    "disclosureDate": "2019-02-19T00:00:00.000Z",
    "exploitPublishDate": "2019-02-19T00:00:00.000Z",
    "solution": "Fixed in [**1.54**](https://github.com/jenkinsci/script-security-plugin/releases/tag/script-security-1.54) by [this](https://github.com/jenkinsci/script-security-plugin/commit/f2649a7c0757aad0f6b4642c7ef0dd44c8fea434) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Georgy Noseevich (@webpentest), SolidLab",
    "workaround": "",
    "vendorFixDate": "2019-03-06T00:00:00.000Z",
    "vendorNotifiedDate": "2019-02-19T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0735",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-1003029",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0735/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/script-security-plugin/commit/f2649a7c0757aad0f6b4642c7ef0dd44c8fea434",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/script-security-plugin/releases/tag/script-security-1.54",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jenkins.io/security/advisory/2019-03-06/#SECURITY-1338",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/151764/jenkins-exec.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/151764/jenkins-exec.txt",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0735/default-remediation-status"
            }
        ]
    }
}