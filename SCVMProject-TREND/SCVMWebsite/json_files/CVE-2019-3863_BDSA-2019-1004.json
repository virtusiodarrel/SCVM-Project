{
    "source": "BDSA",
    "name": "BDSA-2019-1004",
    "title": "libssh2 Vulnerable to Denial-of-Service (DoS) via Integer Overflow in 'userauth_keyboard_interactive()' Function",
    "description": "libssh2 is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause a victim's instance of the application to crash by tricking them into connecting to a malicious server.",
    "technicalDescription": "The function `userauth_keyboard_interactive()`, defined within `userauth.c`, contains code that is used to conduct challenge-response authentication between a client and server. The `session` structure is used to store data relating to the authentication process. This structure contains a number of components relating to the length of data fields that are received from the client. These include `userauth_list_data` and `userauth_pswd_data_len`. These values are assigned to variables which are then added to the variable `userauth_kybd_packet_len`;  this sum is then used to allocate memory via the `LIBSSH2_ALLOC()` function . This memory is intended to store client-provided input strings. However, no validation is performed on the sizes of the variables that are involved in this sum. An attacker could exploit this to cause an integer overflow to occur, which will cause memory buffers to be allocated that are too small to store the attacker-provided strings in their entirety. Thus whenever the strings are written to this buffer, a out-of-bounds write will occur. This could cause an exception to be generated, halting program execution and causing a DoS.",
    "publishedDate": "2019-04-11T15:41:30.213Z",
    "updatedDate": "2019-04-11T15:41:30.195Z",
    "disclosureDate": "2019-03-11T00:00:00.000Z",
    "solution": "Fixed in version [**1.8.1**](https://github.com/libssh2/libssh2/releases/tag/libssh2-1.8.1) by [this](https://github.com/libssh2/libssh2/commit/c286e4d82f24def116d9679cb2453948f74e8183) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Chris Coulson",
    "workaround": "",
    "vendorFixDate": "2019-03-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1004",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3863",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1004/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libssh2/libssh2/commit/c286e4d82f24def116d9679cb2453948f74e8183",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libssh2/libssh2/releases/tag/libssh2-1.8.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.libssh2.org/CVE-2019-3863.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1004/default-remediation-status"
            }
        ]
    }
}