{
    "source": "BDSA",
    "name": "BDSA-2020-1445",
    "title": "HashiCorp Consul Vulnerable to Security Bypass due to Legacy ACL Tokens",
    "description": "It was discovered that HashiCorp Consul contains a security bypass vulnerability. Due to non propagation of Legacy ACL updates to secondary data centers, an attacker could take advantage of this flaw to bypass security restrictions and achieve privilege escalation.",
    "technicalDescription": "The vulnerability occurs due to the failure of an internal process to compute a necessary field when replicating legacy ACL token updates from the primary data center. This results in the updated ACLs not being propagated to secondary data centers so the new changes aren't enforced. An attacker could exploit this flaw to bypass security restrictions and achieve privilege escalation.",
    "publishedDate": "2020-06-18T15:07:21.956Z",
    "updatedDate": "2020-06-18T15:07:21.947Z",
    "disclosureDate": "2020-06-08T00:00:00.000Z",
    "solution": "Fixed in version [**1.6.6**](https://github.com/hashicorp/consul/releases/tag/v1.6.6) by [this](https://github.com/hashicorp/consul/commit/7e57bb2b88ff70058b0091465d85d181f9f16ef5) commit, \nFixed in version [**1.7.4**](https://github.com/hashicorp/consul/releases/tag/v1.7.4) by [this](https://github.com/hashicorp/consul/commit/a18e052878de621a4ed89cbb4a8a2e5a93f2fa16) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-06-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1445",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12797",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1445/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/7e57bb2b88ff70058b0091465d85d181f9f16ef5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/a18e052878de621a4ed89cbb4a8a2e5a93f2fa16",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/pull/8047",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.6.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.7.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1445/default-remediation-status"
            }
        ]
    }
}