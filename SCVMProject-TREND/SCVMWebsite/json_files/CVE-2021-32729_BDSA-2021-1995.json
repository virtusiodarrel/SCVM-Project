{
    "source": "BDSA",
    "name": "BDSA-2021-1995",
    "title": "XWiki Vulnerable to Brute Force Attacks via Improper Access Control for 'Authentication Failure Record' Reset Script",
    "description": "XWiki is vulnerable to brute force style attacks because users with `Script` rights can reset the authentication failures record. This issue could allow an attacker with `Script` rights to reset the record in order to perform brute force authentication attacks.",
    "technicalDescription": "XWiki is vulnerable to brute force style attacks because the `resetAuthenticationFailureCounter()` method in the `xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authentication/xwiki-platform-security-authentication-script/src/main/java/org/xwiki/security/authentication/script/AuthenticationScriptService.java` file insufficiently validates the calling user's rights. This inadvertently allows users with `Script` rights to reset the failure record and execute brute force attacks against the authentication system.\n\nTo remedy this issue, the vendor has updated the affected method so that it ensures that the calling user has `Programming` (`PROGRAM`) rights.",
    "publishedDate": "2021-07-02T15:59:33.468Z",
    "updatedDate": "2021-07-02T15:59:33.461Z",
    "disclosureDate": "2021-07-01T00:00:00.000Z",
    "solution": "Fixed in:\n* [**13.0**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.0) by [this](https://github.com/xwiki/xwiki-platform/commit/b5b26e35da2232c91a549268a1b7890326f7e600) commit and [this](https://github.com/xwiki/xwiki-platform/commit/4c3ee3373d602066b2dc780c8ef1e9523402bdb5) commit,\n* [**12.10.4**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.10.4) by [this](https://github.com/xwiki/xwiki-platform/commit/0ad11dbd5f20b2c7016be2c0d29a105103090490) commit,\n* [**12.6.8**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.6.8) by [this](https://github.com/xwiki/xwiki-platform/commit/64090b9062d59d02ed53e724735754da88ac157e) commit.\n\nThe latest stable releases are available [here](https://www.xwiki.org/xwiki/bin/view/Download/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-01-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1995",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-693"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32729",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1995/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/0ad11dbd5f20b2c7016be2c0d29a105103090490",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/3aeaeda0c3d32b5dc8735e346d6ce1b1fd49bf96",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/4c3ee3373d602066b2dc780c8ef1e9523402bdb5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/64090b9062d59d02ed53e724735754da88ac157e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/b5b26e35da2232c91a549268a1b7890326f7e600",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.10.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.6.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-m738-3rc4-5xv3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://jira.xwiki.org/browse/XWIKI-18276",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.xwiki.org/xwiki/bin/view/Download/",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1995/default-remediation-status"
            }
        ]
    }
}