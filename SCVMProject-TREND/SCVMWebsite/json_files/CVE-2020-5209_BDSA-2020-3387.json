{
    "source": "BDSA",
    "name": "BDSA-2020-3387",
    "title": "Nethack Vulnerable to Remote Code Execution (RCE) and Privilege Escalation via Buffer Overflow with Unknown Options Starting With '-de' and '-i'",
    "description": "Nethack is vulnerable to a buffer overflow through unspecified command line/configuration options starting with `-de` and `-i`.  This could allow a remote or local attacker to cause code execution, with potentially elevated privileges, depending on how Nethack is installed on the system.",
    "technicalDescription": "A buffer overflow exists with specially crafted input to the `raw_printf()` function in `src/windows.c` and `sys/unix/unixmain.c`. It can manifest from excessively large input over the command line, or through user provided configuration files to the `-de` and `-i` options. Systems on which Nethack is installed to raise it's privileges upon execution (installed suid/sgid) are vulnerable to privilege escalation through this flaw. On systems where Nethack is supplied with remote user configuration files through an external measure, remote code execution is possible, although fundamentally this remains a local vulnerability.",
    "publishedDate": "2020-11-17T15:26:52.692Z",
    "updatedDate": "2021-11-02T15:56:10.317Z",
    "disclosureDate": "2020-01-27T00:00:00.000Z",
    "solution": "Fixed in [**3.6.5**](https://github.com/NetHack/NetHack/releases/tag/NetHack-3.6.5_Released) by [this](https://github.com/NetHack/NetHack/commit/f3def5c0b999478da2d0a8f0b6a7c370a2065f77) commit.\n\nThe latest stable releases are available [here](https://github.com/NetHack/NetHack/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "David Mendenhall",
    "workaround": "",
    "vendorFixDate": "2020-01-27T00:00:00.000Z",
    "vendorNotifiedDate": "2020-01-15T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3387",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-120"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5209",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3387/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NetHack/NetHack/commit/f3def5c0b999478da2d0a8f0b6a7c370a2065f77",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NetHack/NetHack/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NetHack/NetHack/releases/tag/NetHack-3.6.5_Released",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NetHack/NetHack/security/advisories/GHSA-fw72-r8xm-45p8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://nethack.org/security/CVE-2020-5209.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3387/default-remediation-status"
            }
        ]
    }
}