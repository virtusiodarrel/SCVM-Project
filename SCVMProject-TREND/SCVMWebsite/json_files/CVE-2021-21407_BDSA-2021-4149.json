{
    "source": "BDSA",
    "name": "BDSA-2021-4149",
    "title": "Combodo iTop Vulnerable to Cross-Site Request Forgery (CSRF) via Unvalidated CRSF Tokens",
    "description": "Combodo iTop is vulnerable to cross-site request forgery (CSRF) due to improper validation of CSRF tokens. This could allow an attacker to reuse previous CSRF tokens and craft malicious links to trick users into performing actions on their behalf.",
    "technicalDescription": "The issue has been mitigated in the file `ObjectFormManager.php` where a new function `CheckTransaction()` has been introduced to check if the CSRF token has been already created or updated. This prevents the same token from being reused.",
    "publishedDate": "2022-02-25T13:01:33.225Z",
    "updatedDate": "2022-02-25T13:01:33.172Z",
    "disclosureDate": "2021-07-20T00:00:00.000Z",
    "solution": "Fixed in versions [**2.7.4**](https://github.com/Combodo/iTop/releases/tag/2.7.4) and [**3.0.0**](https://github.com/Combodo/iTop/releases/tag/3.0.0) by [this](https://github.com/Combodo/iTop/commit/dcd4abe72b603954bc8a6eb66d47363bdc446508) commit.\n\nThe latest stable releases can be found [here](https://github.com/Combodo/iTop/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.3,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mushrraf Baig Ashraf",
    "workaround": "",
    "vendorFixDate": "2021-02-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4149",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21407",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4149/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Combodo/iTop/commit/dcd4abe72b603954bc8a6eb66d47363bdc446508",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Combodo/iTop/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Combodo/iTop/releases/tag/2.7.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Combodo/iTop/releases/tag/3.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Combodo/iTop/security/advisories/GHSA-9wq8-4qm9-3j6f",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4149/default-remediation-status"
            }
        ]
    }
}