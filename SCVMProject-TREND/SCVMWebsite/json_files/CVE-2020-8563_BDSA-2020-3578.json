{
    "source": "BDSA",
    "name": "BDSA-2020-3578",
    "title": "Kubernetes Vulnerable to Sensitive Information Disclosure via Insecure Logging Mechanism in 'Cloud Controller Manager' Module",
    "description": "Kubernetes incorrectly logs sensitive information like passwords and secrets in its `cloud-controller-manager` module. An attacker who can access the Kubernetes cluster logs can gain access to this sensitive information.",
    "technicalDescription": "When a Kubernetes cluster is being run with vSphere as a cloud provider, the vSphere user credentials will be insecurely logged via the `cloud-control-manager` logs. In the file `k8s.io/legacy-cloud-providers/vsphere/vsphere.go`, the function `SetInformers()`  handles `if` conditions for the following: \n* `vs.isSecretInfoProvided`\n* `vs.isSecretManaged`\n\nBecause the condition for `vs.isSecretManaged` always evaluate to true, there will always be a `secret informer` which can handle events like adding secrets and updating secrets. For adding secrets, there is a function called `SecretAdded()`. This function contains a variable `obj` which will eventually contain all information about a matched secret from the `vsphere.conf` file. This will happen when a valid vSphere secret name and namespace information is provided. Thus, when a secret is added successfully, it will be insecurely logged as shown [here](https://sysdig.com/blog/cve-2020-8563-vsphere-credentials-cloud-controller-manager/). This also happens when the `SecretUpdated()` function is called. \nThe impact of this vulnerability is credential leakage via logging. An attacker who can access the server cluster logs can see these credentials/secrets and possibly use them for privilege escalation. \n\n**Note** This vulnerability only affects installations where vSphere is being used as a cloud provider and verbose logging has been enabled by the setting `logLevel >= 4`.",
    "publishedDate": "2020-11-30T14:54:28.251Z",
    "updatedDate": "2020-11-30T14:56:26.512Z",
    "disclosureDate": "2020-11-14T00:00:00.000Z",
    "exploitPublishDate": "2020-11-29T00:00:00.000Z",
    "solution": "Fixed in [**1.20.0-alpha.2**](https://github.com/kubernetes/kubernetes/releases/tag/v1.20.0-alpha.2) by [this](https://github.com/kubernetes/kubernetes/commit/247f6dd09299bc7893c1e0affea11c0255025b96) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Kaizhe Huang",
    "workaround": "The vendor states that:\n\n\"All four vulnerabilities are only exposed when verbose logging levels are enabled for the respective component, which is not done by default. These vulnerabilities can all therefore be mitigated by ensuring that the log level is below 4.\n\nAll four vulnerabilities can additionally be mitigated by preventing untrusted access to log files. An attacker can only recover the sensitive information exposed by these vulnerabilities if they can access the target logs.\".",
    "vendorFixDate": "2020-10-01T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3578",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-117"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-533"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8563",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3578/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/cve-2020-8563",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1886635",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/commit/247f6dd09299bc7893c1e0affea11c0255025b96",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/commit/9e0555446238b2dfe45805babc2b6982565c293d",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/issues/95621",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/pull/95236",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/releases/tag/v1.20.0-alpha.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/kubernetes-announce/c/ScdmyORnPDk",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/kubernetes-announce/c/ScdmyORnPDk",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/966383",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/966383",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://sysdig.com/blog/cve-2020-8563-vsphere-credentials-cloud-controller-manager/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3578/default-remediation-status"
            }
        ]
    }
}