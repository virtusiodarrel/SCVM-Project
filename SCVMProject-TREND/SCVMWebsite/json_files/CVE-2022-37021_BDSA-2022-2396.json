{
    "source": "BDSA",
    "name": "BDSA-2022-2396",
    "title": "Apache Geode Vulnerable to Remote Code Execution (RCE) via Deserialization of Untrusted Data through JMX over RMI on Java 8",
    "description": "Apache Geode is vulnerable to remote code execution (RCE) which is caused by deserialization of untrusted data when using JMX (Java Management Extensions) over RMI (Remote Method Invocation) protocol on Java 8.",
    "technicalDescription": "The vulnerability was fixed by adding an internal serial filter API - `ObjectInputStreamFilterWrapper` was expanded to be an internal API that supports all of Geode's uses of Java's `ObjectInputFilter`. A new system property `geode.enableGlobalSerialFilter` was introduced, which enables a process-wide filter with all serializable Geode classes on the classpath and the value of serializable-object-filter accept-listed. The new changes restrict the scope of the serialized data that can be provided by untrusted input.",
    "publishedDate": "2022-08-31T16:26:38.162Z",
    "updatedDate": "2022-09-29T10:56:08.140Z",
    "disclosureDate": "2022-08-30T00:00:00.000Z",
    "solution": "Fixed in [**1.15.0-RC1**](https://github.com/apache/geode/releases/tag/rel%2Fv1.15.0.RC1) by the following commits:\n* [Commit 1](https://github.com/apache/geode/commit/7978abf34707d11da45cff0b7cb7445f18d21438)\n* [Commit 2](https://github.com/apache/geode/commit/b6fca291378a1bc334b0f9927c899a1892442939)\n* [Commit 3](https://github.com/apache/geode/commit/db64b4948e790d61e82f95ae6163a62adc4c67fb)\n\nFixed by these commits in **support/1.14** branch:\n* [Commit 1](https://github.com/apache/geode/commit/cc227bc894324d3e65cf06f085c645f063df8635)\n* [Commit 2](https://github.com/apache/geode/commit/6d0a4f10a5d75811d064726f57e19c15c47ad0b5)\n* [Commit 3](https://github.com/apache/geode/commit/f0809e411d561226f736adca9d40cbbe27033e53)\n* [Commit 4](https://github.com/apache/geode/commit/e821d6eff4541ae478a0eb67217bcb456abae97a)\n* [Commit 5](https://github.com/apache/geode/commit/3f66ab05e5683edb4bcb43e52304d8e5f58ac707)\n* [Commit 6](https://github.com/apache/geode/commit/8f3186cb74ccd2eb1ec8ba648c7a11b08d575962)\n* [Commit 7](https://github.com/apache/geode/commit/92e0e89c982ef4ed53e0a7be0194aea45adb8726)\n\nThe commits above are not yet included in any release.\n\nThe latest stable releases can be found [here](https://geode.apache.org/releases/).\n\nNote: in addition to upgrading to **1.15**, an upgrade from from Java 8 to Java 11 is required. If upgrading to Java 11 is not possible, then upgrade to Apache Geode **1.15** and specify `--J=-Dgeode.enableGlobalSerialFilter=true` when starting any Locators or Servers.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "Disable affected services such as JMX over RMI unless they are required. JMX over RMI can be disabled by setting Geode property `jmx-manager` to `false`; this property defaults to `false` on Servers and `true` on Locators.",
    "vendorFixDate": "2022-01-18T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2396",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-37021",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2396/ranges"
            },
            {
                "rel": "reference",
                "href": "https://geode.apache.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/geode/commit/3f66ab05e5683edb4bcb43e52304d8e5f58ac707",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/geode/commit/6d0a4f10a5d75811d064726f57e19c15c47ad0b5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/geode/commit/7978abf34707d11da45cff0b7cb7445f18d21438",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/geode/commit/8f3186cb74ccd2eb1ec8ba648c7a11b08d575962",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/geode/commit/92e0e89c982ef4ed53e0a7be0194aea45adb8726",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/geode/commit/b6fca291378a1bc334b0f9927c899a1892442939",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/geode/commit/cc227bc894324d3e65cf06f085c645f063df8635",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/geode/commit/db64b4948e790d61e82f95ae6163a62adc4c67fb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/geode/commit/e821d6eff4541ae478a0eb67217bcb456abae97a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/geode/commit/f0809e411d561226f736adca9d40cbbe27033e53",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/geode/releases/tag/rel%2Fv1.15.0.RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/qrvhmytsshsk5xcb68pwccw3y6m8o8nr",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/qrvhmytsshsk5xcb68pwccw3y6m8o8nr",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2396/default-remediation-status"
            }
        ]
    }
}