{
    "source": "BDSA",
    "name": "BDSA-2019-0931",
    "title": "Teclib GLPI Vulnerable to SQL Injection via 'cycle' HTTP GET Request Parameter",
    "description": "Teclib GLPI is vulnerable to SQL injection due to insufficient validation of client-provided parameters. A remote attacker could execute arbitrary queries against back-end databases by submitting crafted HTTP requests.",
    "technicalDescription": "The script `unlock_tasks.php` extracts the `cycle` parameter from an HTTP GET request, and assigns its value to the variable `$cycle`. This variable is then used to dynamically construct a SQL select statement. The variable is used as part of the `WHERE` clause, in which it is included as part of an arithmetic operation. Although the variable's value is intended to be an integer, no sanitization or validation is performed on it. An attacker could therefore pass the application a crafted GET request, in which the value of `cycle` constitutes valid SQL code that will modify the generated statement in order to extract information from the back-end database. Although the complete query response is not returned to the user, an attacker could use inference techniques in order to determine the output.\n\nIt should be noted that `unlock_tasks.php` is not utilized in 9.4.x releases of GLPI.",
    "publishedDate": "2019-04-04T10:26:28.760Z",
    "updatedDate": "2019-04-04T10:26:28.742Z",
    "disclosureDate": "2019-03-27T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/glpi-project/glpi/commit/684d4fc423652ec7dde21cac4d41c2df53f56b3c) commit in the `9.3/bugfixes` branch which is not yet included in any release.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-02-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0931",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10232",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0931/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/commit/684d4fc423652ec7dde21cac4d41c2df53f56b3c",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/commit/684d4fc423652ec7dde21cac4d41c2df53f56b3c",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0931/default-remediation-status"
            }
        ]
    }
}