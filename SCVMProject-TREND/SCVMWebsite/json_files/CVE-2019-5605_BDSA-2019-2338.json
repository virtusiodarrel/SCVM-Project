{
    "source": "BDSA",
    "name": "BDSA-2019-2338",
    "title": "FreeBSD Vulnerable to Information Disclosure via Kernel Memory Exposure due to 'ioctl' System Call",
    "description": "FreeBSD is vulnerable to information disclosure, and possibly privilege escalation, due to the exposure of memory used by the operating system. A local attacker could obtain sensitive memory fragments by executing the 32-bit version of the `ioctl` system call and then probing its response.",
    "technicalDescription": "The function `freebsd32_ioctl_pciocgetconf()`, which is defined within the script `freebsd32_ioctl.c`, is called by the 32-bit version of FreeBSD during the invocation of the `ioctl` system call. This system call utilizes the memory buffers `pmc` and `pc32`. The memory associated with these two buffers is located within the kernel, with their contents eventually being delivered to user space. The initial contents of the buffers is not cleared prior to this, meaning that potentially sensitive information from the kernel will be exposed to the user space process that invoked the system call. This information could be of use to an attacker, and could even potentially be used to obtain the credentials of other users. For example, this would be possible if the memory returned from the kernel included a terminal buffer containing the root user password. In order to exploit this vulnerability, an attacker must be able to call the 32-bit version of `ioctl` system call on the target system, and then be able to examine the calling application's memory in order to recover the sensitive information.",
    "publishedDate": "2019-07-26T14:09:06.502Z",
    "updatedDate": "2019-07-26T14:12:37.940Z",
    "disclosureDate": "2019-07-24T00:00:00.000Z",
    "solution": "Fixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=350217) commit in the `stable/11/` branch which is not yet included in any release.\n\nFixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=350283) commit in the `releng/11.2/` branch which is not yet included in any release.\n\nFixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=350283) commit in the `releng/11.3/` branch which is not yet included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.7,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ilja van Sprundel of IOActive",
    "workaround": "",
    "vendorFixDate": "2019-07-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2338",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-453"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5605",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2338/ranges"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=350217",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=350283",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-19:14.freebsd32.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2338/default-remediation-status"
            }
        ]
    }
}