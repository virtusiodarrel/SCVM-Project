{
    "source": "BDSA",
    "name": "BDSA-2019-1096",
    "title": "hostapd Vulnerable to Denial-of-Service (DoS) via NULL Pointer Dereference during 'CONFIRM' Message in SAE Validation Process",
    "description": "A null pointer dereference has been discovered in hostapd utilized by the WPA3 protocol. An attacker could exploit this vulnerability to trigger a denial-of-service (DoS) condition.\n\nThis issue affects devices running hostapd with SAE enabled.",
    "technicalDescription": "A weakness has been discovered in hostpd utilized by the WPA3 protocol which could lead to a crash. WPA3 utilizes a key agreement method called simultaneous authentication of equals (SAE) which is a variant of the Dragonfly Key Exchange. The attack works by first initiating a connection to the target. The target attempts to authenticate the attacker by sending a challenge. The attacker opens up a second connection to the target, using the challenge they just obtained as their own challenge. The result that the server sent back can be sent as the response of the initial challenge. This is due to the same protocol being used on both sides of the authentication mechanism.\n\nThe `sae_check_confirm` function located in the file `src/common/sae.c` did not validate if the scalar/element values utilized in the peer COMMIT frame existed before validating against the CONFIRM message. This could cause a NULL pointer dereference error if the peer element could not be parsed, triggering a denial-of-service (DoS) condition.\n\nAn attacker could exploit this vulnerability through a maliciously forged COMMIT frame to cause the `hostapd` process to crash.",
    "publishedDate": "2019-04-17T12:46:31.432Z",
    "updatedDate": "2019-04-17T12:46:31.399Z",
    "disclosureDate": "2019-04-10T00:00:00.000Z",
    "solution": "Fixed by [this](https://w1.fi/cgit/hostap/commit/?id=ac8fa9ef198640086cf2ce7c94673be2b6a018a0) commit in the Master branch which is not yet included in a release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:A/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mathy Vanhoef (NYUAD), Eyal Ronen (Tel Aviv University & KU Leuven)",
    "workaround": "",
    "vendorFixDate": "2019-03-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1096",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-476"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-9496",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1096/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1699153",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=ac8fa9ef198640086cf2ce7c94673be2b6a018a0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/security/2019-3/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/security/2019-3/sae-confirm-missing-state-validation.txt",
                "label": "ADVISORY"
            }
        ]
    }
}