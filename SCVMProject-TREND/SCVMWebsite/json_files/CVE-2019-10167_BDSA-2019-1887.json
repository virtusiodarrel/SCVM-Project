{
    "source": "BDSA",
    "name": "BDSA-2019-1887",
    "title": "Libvirt Vulnerable to Arbitrary Command Execution via Improper Access Control in 'virConnectGetDomainCapabilities' API",
    "description": "An improper access control vulnerability has been discovered in Libvirt. An attacker could exploit this vulnerability via an arbitrary path to execute arbitrary commands with application level permissions.",
    "technicalDescription": "A weakness has been discovered in Libvirt which could be manipulated to execute arbitrary commands. The `virConnectGetDomainCapabilities` emulation API can contain user-supplied input to point to specified system files. The process is located in the file `src/libvirt-domain.c` and does not implement sufficient validation to prevent read-only connections. A malicious actor can craft an injected file path, forcing the application to execute malicious code against the host system. \n\nExploitation of this vulnerability requires access to the socket located in the file `var/run/libvirt/libvirt_sock_ro`.",
    "publishedDate": "2019-06-25T14:58:31.627Z",
    "updatedDate": "2019-06-25T14:58:31.614Z",
    "disclosureDate": "2019-06-20T00:00:00.000Z",
    "solution": "Fixed by [this](https://libvirt.org/git/?p=libvirt.git;a=commit;h=8afa68bac0cf99d1f8aaa6566685c43c22622f26) commit in the **master** branch which is not yet included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.6,
        "impactSubscore": 3.7,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jan Tomko (Red Hat)",
    "workaround": "In Unix systems, the libvirt's read-only socket permissions can be modified via the `/etc/libvirt/libvirtd.conf` to restrict access to members who have management access to the virtual machine.",
    "vendorFixDate": "2019-06-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1887",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-250"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10167",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1887/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1720117",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://libvirt.org/git/?p=libvirt.git;a=commit;h=8afa68bac0cf99d1f8aaa6566685c43c22622f26",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1887/default-remediation-status"
            }
        ]
    }
}