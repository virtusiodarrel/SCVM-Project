{
    "source": "BDSA",
    "name": "BDSA-2021-3094",
    "title": "Auth0 Next.js SDK Vulnerable to Reflected Cross-Site Scripting (XSS) via Error Query Parameter",
    "description": "Auth0 Next.js contains a reflected cross-site scripting (XSS) vulnerability due to unsanitized user input in the error query parameter. An attacker could exploit this vulnerability by executing arbitrary code or scripts by passing an XSS payload in the error parameter. This would then reflect back the malicious code as an error message, once processed by the callback handler. This could lead to theft of a victim's sensitive information, such as session tokens or cookies.",
    "technicalDescription": "This issue occurs due to lack of HTML escaping used within the error query parameter, allowing an attacker to inject an XSS payload into the web page's error messages. This was mitigated by adding the implementation of basic HTML escaping where error messages are used.",
    "publishedDate": "2021-10-19T10:26:41.198Z",
    "updatedDate": "2022-08-01T11:23:45.983Z",
    "disclosureDate": "2021-06-25T00:00:00.000Z",
    "solution": "Fixed in version [**1.4.1**](https://github.com/auth0/nextjs-auth0/releases/tag/v1.4.1) by [this](https://github.com/auth0/nextjs-auth0/commit/6996e2528ceed98627caa28abafbc09e90163ccf) commit.\n\nThe latest stable releases can be found [here](https://github.com/auth0/nextjs-auth0/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Inian, Ishan Patel",
    "workaround": "As per the vendor, the user is not affected by this vulnerability if they are \"using custom error handling that does not return the error message in an HTML response.\"",
    "vendorFixDate": "2021-06-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3094",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32702",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3094/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/auth0/nextjs-auth0/commit/6996e2528ceed98627caa28abafbc09e90163ccf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/auth0/nextjs-auth0/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/auth0/nextjs-auth0/releases/tag/v1.4.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/auth0/nextjs-auth0/security/advisories/GHSA-954c-jjx6-cxv7",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/auth0/nextjs-auth0/security/advisories/GHSA-954c-jjx6-cxv7",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3094/default-remediation-status"
            }
        ]
    }
}