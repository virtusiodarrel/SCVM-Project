{
    "source": "BDSA",
    "name": "BDSA-2022-1757",
    "title": "curl Vulnerable to Man-in-the-Middle (MitM) Attacks via Improper FTP-KRB Message Verification",
    "description": "curl is vulnerable to man-in-the-middle attacks (MitM) due to the improper processing of FTP transfers secured by krb5. This could allow an attacker to leak the potentially sensitive contents of local heap memory, or to inject arbitrary FTP control channel responses.",
    "technicalDescription": "The issue exists within the file `lib/krb5.c`. During FTP-KRB message verification, curl does not perform proper buffer clearing operations when handling `GSS_S_BAD_SIG` errors. It also fails to ensure that the proper limits are imposed on heap buffer read operations. This can allow server responses to be forged and processed without the GSSAPI protected FTP connection being terminated, or local heap memory to be exposed.",
    "publishedDate": "2022-06-27T15:19:20.832Z",
    "updatedDate": "2022-06-27T15:19:20.821Z",
    "disclosureDate": "2022-06-27T00:00:00.000Z",
    "solution": "Fixed in version [**7.84.0**](https://github.com/curl/curl/releases/tag/curl-7_84_0) by [this](https://github.com/curl/curl/commit/6ecdf5136b52af747e7bda08db9a748256b1cd09) commit.\n\nThe latest stable releases can be found [here](https://curl.se/download.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.5
        },
        "vector": "(AV:A/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Harry Sintonen",
    "workaround": "",
    "vendorFixDate": "2022-06-25T00:00:00.000Z",
    "vendorNotifiedDate": "2022-06-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1757",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-924"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-32208",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1757/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2022-32208.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/6ecdf5136b52af747e7bda08db9a748256b1cd09",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_84_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1590071",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1757/default-remediation-status"
            }
        ]
    }
}