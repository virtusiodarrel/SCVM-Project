{
    "source": "BDSA",
    "name": "BDSA-2018-3570",
    "title": "Libssh Vulnerable to Authentication Bypass via Forged 'SSH2_MSG_USERAUTH_SUCCESS' Message",
    "description": "Libssh is vulnerable to authentication bypass due to a flaw in the server code which could allow attackers to authenticate without any credentials. It is possible to use this flaw to set the internal state machine maintained by the library to authenticated effectively enabling the (normally prohibited) creation of channels.",
    "technicalDescription": "The vulnerability exists because libssh does not adequately track the various states of the authentication process and does not reject packets with a wrong state. This flaw can be exploited by sending a `SSH2_MSG_USERAUTH_SUCCESS` message to the server instead of the expected `SSH2_MSG_USERAUTH_REQUEST` message meant to initiate the authentication. This tricks the server into authenticating the attacker without any credentials. If an application using a vulnerable version of the library permits root logins, this can lead to a complete system compromise.",
    "publishedDate": "2018-10-16T15:45:19.971Z",
    "updatedDate": "2018-12-19T16:29:50.150Z",
    "disclosureDate": "2018-10-16T00:00:00.000Z",
    "exploitPublishDate": "2018-10-17T00:00:00.000Z",
    "solution": "Fixed in [**0.7.6**](https://www.libssh.org/get-it/) by the following commits:\n* [Commit 1](https://git.libssh.org/projects/libssh.git/commit/?id=b9033ad56a498d0642f3258a54a32251278a319e)\n* [Commit 2](https://git.libssh.org/projects/libssh.git/commit/?id=e5ff7aa410c23954a2963b52e7b721a2d41536f3)\n* [Commit 3](https://git.libssh.org/projects/libssh.git/commit/?id=3837a0547f08b160749fed7496316a62d6c11dea)\n* [Commit 4](https://git.libssh.org/projects/libssh.git/commit/?id=7985acb76842ebf27e32e4afddfef55555209e8e)\n* [Commit 5](https://git.libssh.org/projects/libssh.git/commit/?id=acd6a1ca8a332a204b616ab6bef413bee5d3409d)\n* [Commit 6](https://git.libssh.org/projects/libssh.git/commit/?id=ddea46f890bd5d87669f23b26d676adedaa5f610)\n* [Commit 7](https://git.libssh.org/projects/libssh.git/commit/?id=e5f0e711b05c2ec4c2d016a6abaedae2959ddba2)\n\nFixed in [**0.8.4**](https://www.libssh.org/get-it/) by the following commits:\n* [Commit 1](https://git.libssh.org/projects/libssh.git/commit/?id=203818608ac8a83d68098f008306c3a568ac4cac)\n* [Commit 2](https://git.libssh.org/projects/libssh.git/commit/?id=f8c452cbef228b105dcb757d7554c3388a4dbea5)\n* [Commit 3](https://git.libssh.org/projects/libssh.git/commit/?id=adeaa69cc535827ec8acfbaf3ff91224b5a595a7)\n* [Commit 4](https://git.libssh.org/projects/libssh.git/commit/?id=72bce5ece7edc2fd8023185f9d47b9fc86ef4663)\n* [Commit 5](https://git.libssh.org/projects/libssh.git/commit/?id=7819621fc2a07d2d4649b36ca77850610741cfec)\n* [Commit 6](https://git.libssh.org/projects/libssh.git/commit/?id=fcfba0d8aa15a0142e57513f271eb7fa4bbabc9a)\n* [Commit 7](https://git.libssh.org/projects/libssh.git/commit/?id=b166ac4749c78f475b1708f0345e6ca2749c5d6d)",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 10.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 10.0,
        "severity": "HIGH",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.3
        },
        "vector": "(AV:N/AC:L/Au:N/C:C/I:C/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Peter Winter-Smith of NCC Group",
    "workaround": "",
    "vendorFixDate": "2018-10-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-3570",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-302"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2018-10933",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-3570/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.libssh.org/projects/libssh.git/log/?h=libssh-0.8.4&qt=grep&q=CVE-2018-10933",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2018/q4/65",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/45638/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.libssh.org/2018/10/16/libssh-0-8-4-and-0-7-6-security-and-bugfix-release/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.libssh.org/get-it/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.libssh.org/security/advisories/CVE-2018-10933.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.rapid7.com//db/modules/auxiliary/scanner/ssh/libssh_auth_bypass",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-3570/default-remediation-status"
            }
        ]
    }
}