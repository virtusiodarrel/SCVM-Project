{
    "source": "BDSA",
    "name": "BDSA-2020-3213",
    "title": "tmux Vulnerable to Remote Code Execution (RCE) via Colon-Separated SGR Sequences",
    "description": "tmux is vulnerable to code execution due to the improper processing of Select Graphic Rendition (SGR) sequences separated by colon characters. This vulnerability may be exploited by printing malicious output to the terminal. Note that in standard Linux configurations exploitation attempts are more likely to result in crashes and denial-of-service (DoS) rather than arbitrary code execution.",
    "technicalDescription": "The issue is due to a stack buffer overflow in function `input_csi_dispatch_sgr_colon` in the file `input.c`. The bound check for the array `p` (allocated on the stack) is bypassed if 8th chunk of input buffer is empty. This allows for colon-separated SGR sequences to be used to overwrite arbitrary 4-byte stack locations, as well as skip chosen offsets in order to bypass the stack canary. Note that although the stack smashing protection can be bypassed, the ASLR still reliably protects from successful code execution attempts, which is why this vulnerability is more likely to result in a crash and DoS.",
    "publishedDate": "2020-11-06T15:54:21.805Z",
    "updatedDate": "2020-11-06T15:54:21.796Z",
    "disclosureDate": "2020-11-05T00:00:00.000Z",
    "exploitPublishDate": "2020-11-05T00:00:00.000Z",
    "solution": "Fixed in [**3.2-rc**](https://github.com/tmux/tmux/releases/tag/3.2-rc) by [this](https://github.com/tmux/tmux/commit/a868bacb46e3c900530bed47a1c6f85b0fbe701c) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sergey Nizovtsev",
    "workaround": "",
    "vendorFixDate": "2020-10-29T00:00:00.000Z",
    "vendorNotifiedDate": "2020-10-29T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3213",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27347",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3213/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tmux/tmux/commit/a868bacb46e3c900530bed47a1c6f85b0fbe701c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tmux/tmux/releases/tag/3.2-rc",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/11/05/3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/11/05/3",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3213/default-remediation-status"
            }
        ]
    }
}