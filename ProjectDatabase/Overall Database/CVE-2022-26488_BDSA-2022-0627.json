{
    "source": "BDSA",
    "name": "BDSA-2022-0627",
    "title": "Python Vulnerable to Privilege Escalation via Search Path Hijacking with Windows Installer",
    "description": "Python on Windows is vulnerable to local privilege escalation due to improper handling of search paths. This could allow an attacker to add user-writable directories to system search paths and hijack user/system services.",
    "technicalDescription": "The issue exists within the Windows MSI installer, on systems where Python is installed for all users and \"Add Python to PATH\" is set. Missing checks for the validity of the install path can allow an attacker to add crafted paths to the system PATH by performing repair operations.",
    "publishedDate": "2022-03-08T13:21:48.872Z",
    "updatedDate": "2022-07-08T13:52:22.658Z",
    "disclosureDate": "2022-03-07T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.7.13**](https://github.com/python/cpython/releases/tag/v3.7.13) by [this](https://github.com/python/cpython/commit/9747627127) commit,\n* [**3.8.13**](https://github.com/python/cpython/releases/tag/v3.8.13) by [this](https://github.com/python/cpython/commit/cff1b78c) commit,\n* [**3.9.11**](https://github.com/python/cpython/releases/tag/v3.9.11) by [this](https://github.com/python/cpython/commit/101a1bee19) commit,\n* [**3.10.3**](https://github.com/python/cpython/releases/tag/v3.10.3) by [this](https://github.com/python/cpython/commit/136842c91b) commit,\n* [**3.11.0a7**](https://github.com/python/cpython/releases/tag/v3.11.0a7) by [this](https://github.com/python/cpython/commit/77446d2aa5) commit.\n\nThe latest stable releases are available [here](https://github.com/python/cpython/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Lockheed Martin Red Team",
    "workaround": "The vendor states that:\n> Besides updating, this vulnerability may be mitigated by modifying an \nexisting install to disable the \"Add Python to PATH\" or \"Add Python to \nenvironment variables\" option.",
    "vendorFixDate": "2022-03-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-0627",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2022-26488",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-0627/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue46948",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/101a1bee19",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/136842c91b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/77446d2aa5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/9747627127",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/cff1b78c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.10.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.11.0a7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.7.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.8.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.9.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mail.python.org/archives/list/security-announce@python.org/thread/657Z4XULWZNIY5FRP3OWXHYKUSIH6DMN/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://mail.python.org/archives/list/security-announce@python.org/thread/657Z4XULWZNIY5FRP3OWXHYKUSIH6DMN/",
                "label": "WORKAROUND"
            }
        ]
    }
}