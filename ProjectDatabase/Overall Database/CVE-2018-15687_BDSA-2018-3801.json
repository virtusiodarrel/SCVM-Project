{
    "source": "BDSA",
    "name": "BDSA-2018-3801",
    "title": "Systemd Vulnerable to Privilege Escalation via Race Condition in 'chown_one()' Function",
    "description": "A race condition vulnerability has been discovered in systemd. An attacker with local access could exploit this vulnerability to modify file permissions of arbitrary files.",
    "technicalDescription": "The function `chown_one` located in the file `src/core/chown-recursive.c`  is opening the directories on each recursion process instead of referencing the directory path with `O_PATH`.  \n\nThe recursive logic utilized by systemd allows local users to bypass a symlink check and modify permissions of arbitrary files. This can occur when the \n`CacheDirectory`, `LogsDirectory` or `StateDirectory` features are executed with the `DynamicUser` feature and need to recursively change ownership of the directories.  The file mode will be reset to ensure the kernel does not change it between each recursion.  The file mode state can be manipulated through a Time-of-check Time-of-use (TOCTOU) race condition causing the application to perform invalid actions. An attacker could exploit this vulnerability via services with certain configurations to modify permissions of arbitrary files.",
    "publishedDate": "2018-10-30T17:01:46.270Z",
    "updatedDate": "2019-01-23T10:36:33.378Z",
    "disclosureDate": "2018-10-14T00:00:00.000Z",
    "solution": "Fixed by the following commits in the Master branch with have not yet been included in any release:\n* [commit1](https://github.com/systemd/systemd/pull/10517/commits/5de6cce58b3e8b79239b6e83653459d91af6e57c)\n* [commit2](https://github.com/systemd/systemd/pull/10517/commits/f89bc84f3242449cbc308892c87573b131f121df)\n* [commit3](https://github.com/systemd/systemd/pull/10517/commits/cb9e44db36caefcbb8ee7a12e14217305ed69ff2)\n* [commit4](https://github.com/systemd/systemd/pull/10517/commits/cd6b7d50c337b3676a3d5fc2188ff298dcbdb939)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.8
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.3,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Jann Horn",
    "workaround": "",
    "vendorFixDate": "2018-10-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3801",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-367"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-15687",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3801/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1639076",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/pull/10517",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/pull/10517/commits/5de6cce58b3e8b79239b6e83653459d91af6e57c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/pull/10517/commits/cb9e44db36caefcbb8ee7a12e14217305ed69ff2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/pull/10517/commits/cd6b7d50c337b3676a3d5fc2188ff298dcbdb939",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/pull/10517/commits/f89bc84f3242449cbc308892c87573b131f121df",
                "label": "PATCH"
            }
        ]
    }
}