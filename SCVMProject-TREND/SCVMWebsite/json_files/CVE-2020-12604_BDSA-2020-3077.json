{
    "source": "BDSA",
    "name": "BDSA-2020-3077",
    "title": "Envoy Proxy Vulnerable to Denial-of-Service (DoS) due to Mishandling of Large HTTP/2 Payloads",
    "description": "Envoy Proxy is vulnerable to uncontrolled resource consumption, an attacker could exploit this to cause a denial-of-service (DoS) to the component.",
    "technicalDescription": "This vulnerability is due to a lack of a timeout on streams, causing memory not to be freed by the application. This can be exploited by the attacker opening up streams to the `max_concurrent_streams` limit, and then request a resource which the attacker knows will generate a large response. Envoy will then allocate an appropriate amount of memory to that stream. \nA case exists where Envoy receives the final upstream data, but not have enough open window to pass the data downstream. As a result, the memory allocated would be stored in the buffer forever.\n\nThis issue was fixed by ensuring that `stream_idle_timeout ` properly resets the stream and releases the buffered data if a downstream window is not opened. \n\nThis issue is very difficult for an attacker to exploit as it requires knowledge of the backend configuration of Envoy.",
    "publishedDate": "2020-10-30T14:51:33.828Z",
    "updatedDate": "2020-10-30T14:51:33.818Z",
    "disclosureDate": "2020-06-30T00:00:00.000Z",
    "solution": "Fixed in\n* [**1.14.3**](https://github.com/envoyproxy/envoy/releases/tag/v1.14.3) by [this](https://github.com/envoyproxy/envoy/commit/1025ea3c4eca6b85419f11ba712457cdb7436240) commit\n* [**1.13.3**](https://github.com/envoyproxy/envoy/releases/tag/v1.13.3) by [this](https://github.com/envoyproxy/envoy/commit/ea2d62e582929ab980687f51447642b61c6675e1) commit\n* [**1.12.5**](https://github.com/envoyproxy/envoy/releases/tag/v1.12.5) by [this](https://github.com/envoyproxy/envoy/commit/15bff64faf92318d4fba1463980ab0550791aa5c) commit\n\nThe latest stable releases can be found [here](https://github.com/envoyproxy/envoy/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.7,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.2,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-06-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3077",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12604",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3077/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/1025ea3c4eca6b85419f11ba712457cdb7436240",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/15bff64faf92318d4fba1463980ab0550791aa5c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/ea2d62e582929ab980687f51447642b61c6675e1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.12.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.13.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.14.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-8hf8-8gvw-ggvx",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3077/default-remediation-status"
            }
        ]
    }
}