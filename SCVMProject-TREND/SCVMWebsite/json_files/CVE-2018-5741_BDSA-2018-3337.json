{
    "source": "BDSA",
    "name": "BDSA-2018-3337",
    "title": "BIND Vulnerable to Authorization Bypass via Improper Documentation of 'krb5-subdomain' and 'ms-subdomain' Rule Types",
    "description": "BIND may allow unauthorized zone record updates due to incorrect documentation of the `update-policy` feature. The feature is intended to provide fine-grained controls over the ability to use Dynamic DNS (DDNS) to update records in a zone. Two of the rules designed to limit the types of updates that can be performed by a client, `krb5-subdomain` and `ms-subdomain`,  were initially undocumented. When the documentation was added to the Administrator Reference Manual (ARM), the behavior of these two rules has been incorrectly described.\n\nThis issue affects all versions of BIND 9 which contain the `krb5-subdomain` and `ms-subdomain` update policies . However, the misleading documentation is not present in all versions.",
    "technicalDescription": "When using the `krb5-subdomain` and `ms-subdomain` update policy rule types, any authenticated client is allowed to modify all records in the zone at or below the name specified in the name field. This is the actual behavior for clients authenticated with a valid Kerberos or Windows machine principal from the REALM specified in the identity field.\n\nThis is not in line with documented behavior which specifies that the policy will be restricted to names at or below the machine's name as encoded in the Windows or Kebreros principal. The failure to properly document the behavior of the rules might have led to policy configurations that are more permissive than intended.\n\nThe change of wording in the documentation can be seen in the \"ruletype\" table  under the \"Dynamic Update Policies\" section [here](https://ftp.isc.org/isc/bind9/9.13.2/doc/arm/Bv9ARM.ch05.html#dynamic_update_policies) (**9.13.2**) and [here](https://ftp.isc.org/isc/bind9/9.13.3/doc/arm/Bv9ARM.ch05.html#dynamic_update_policies) (**9.13.3**).\n\nThe descriptions of the `krb5-subdomain` and `ms-subdomain` rules have been updated to reflect the actual behavior in:\n\n* [**9.13.3**](http://www.isc.org/downloads) by [this](https://gitlab.isc.org/isc-projects/bind9/commit/0370d136673052dbe18e830182e73278bbba9c21) commit\n* [**9.12.2-P2**](http://www.isc.org/downloads) by [this](https://gitlab.isc.org/isc-projects/bind9/commit/c8581bb03a6ef0342f8d0914bcbf042b5dfe5ba4) commit\n* [**9.11.4-P2**](http://www.isc.org/downloads) by [this](https://gitlab.isc.org/isc-projects/bind9/commit/61e40c11922fb9d8b8d663f513d4f8ec4b19a271) commit\n\nPlease note that upgrading BIND to these versions is not enough to remedy the issue. The changes have only amended the existing documentation to reflect the actual behavior and DID NOT fix any code. Therefore, it is CRUCIAL to update the configuration using new documentation to achieve the desired behavior.",
    "publishedDate": "2018-10-04T11:53:00.361Z",
    "updatedDate": "2018-12-19T13:46:25.677Z",
    "disclosureDate": "2018-09-19T00:00:00.000Z",
    "exploitPublishDate": "2018-09-19T00:00:00.000Z",
    "solution": "Changes that implement the new rule types (`krb5-selfsub` and `ms-selfsub`), matching the previously documented behavior more accurately, have been included in the release candidate versions. The configuration should still be reviewed to ensure intended behavior.\n\nFixed in [**9.11.5rc1**](https://gitlab.isc.org/isc-projects/bind9/tags/v9_11_5rc1) by [this](https://gitlab.isc.org/isc-projects/bind9/commit/3b4eaa712aa7c68cc3f8486ddbbdbfd8b010c127) commit.\n\nFixed in [**9.12.3rc1**](https://gitlab.isc.org/isc-projects/bind9/tags/v9_12_3rc1) by [this](https://gitlab.isc.org/isc-projects/bind9/commit/64aa3dcc3d3dd68041c7a3880adef9087c7ac6a2) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dominik George",
    "workaround": "The vendor has provided the following instructions for a workaround:\n* To limit updates to a subset of a zone -- for example, `sub.example.com` -- create a new `sub.example.com` child zone beneath `example.com`, and set the desired update-policy in the child zone rather than the parent.",
    "vendorFixDate": "2018-08-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3337",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-5741",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3337/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.isc.org/downloads",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=908595",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://ftp.isc.org/isc/bind9/9.13.2/doc/arm/Bv9ARM.ch05.html#dynamic_update_policies",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://ftp.isc.org/isc/bind9/9.13.3/doc/arm/Bv9ARM.ch05.html#dynamic_update_policies",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/commit/3b4eaa712aa7c68cc3f8486ddbbdbfd8b010c127",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/commit/64aa3dcc3d3dd68041c7a3880adef9087c7ac6a2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/issues/511",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/tags/v9_11_5rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.isc.org/isc-projects/bind9/tags/v9_12_3rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://kb.isc.org/docs/cve-2018-5741",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://kb.isc.org/docs/cve-2018-5741",
                "label": "WORKAROUND"
            }
        ]
    }
}