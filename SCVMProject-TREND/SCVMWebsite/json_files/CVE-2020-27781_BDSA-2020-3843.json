{
    "source": "BDSA",
    "name": "BDSA-2020-3843",
    "title": "Ceph Vulnerable to Credential Theft via Improperly Protected Credentials with OpenStack Manila Use of 'ceph_volume_client.py' Library",
    "description": "Ceph is vulnerable to a flaw whereby native CephFS consumers of OpenStack Manila can steal user credentials, including those of the administrator. A remote attacker could leverage these credentials to elevate their privileges and affect the integrity and confidentiality of the system.",
    "technicalDescription": "OpenStack Manila's use of the `ceph_volume_client.py` library allowed access to any Ceph credential\u2019s secret. Users of Open Stack Manila can request access to a share of an arbitrary cephx user, including administrator users. All users of the OpenStack project can view the access key that is retrieved through the interface drivers. The attacker can then target any resource that the user has access to.",
    "publishedDate": "2020-12-21T13:53:57.148Z",
    "updatedDate": "2021-11-03T10:04:56.815Z",
    "disclosureDate": "2020-12-16T00:00:00.000Z",
    "solution": "Fixed in:\n* **remotes/origin/luminous** branch by [this](https://github.com/ceph/ceph/commit/956ceb853a58f6b6847b31fac34f2f0228a70579) commit. It is not yet included in a stable release.\n* **[14.2.16](https://github.com/ceph/ceph/releases/tag/v14.2.16)** by [this](https://github.com/ceph/ceph/commit/7e3e4e73783a98bb07ab399438eb3aab41a6fc8b) commit.\n* **[15.2.8](https://github.com/ceph/ceph/releases/tag/v15.2.8)** by [this](https://github.com/ceph/ceph/commit/1b8a634fdcd94dfb3ba650793fb1b6d09af65e05) commit.\n* **[v16.1.0](https://github.com/ceph/ceph/releases/tag/v16.1.0)** by [this](https://github.com/ceph/ceph/commit/c6121e48ecb7224e5addf4b5fdeb64907a8d8683) commit\n\nThe latest stable releases can be found [here](https://github.com/ceph/ceph/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.2,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Goutham Pacha Ravi (Red Hat), Jahson Babel (Centre de Calcul de l'IN2P3), John Garbutt (StackHPC)",
    "workaround": "",
    "vendorFixDate": "2020-12-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3843",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-522"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27781",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3843/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/CVE-2020-27781",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ceph.io/releases/v15-2-8-octopus-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/commit/1b8a634fdcd94dfb3ba650793fb1b6d09af65e05",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/commit/7e3e4e73783a98bb07ab399438eb3aab41a6fc8b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/commit/956ceb853a58f6b6847b31fac34f2f0228a70579",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/commit/c6121e48ecb7224e5addf4b5fdeb64907a8d8683",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases/tag/v14.2.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases/tag/v15.2.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases/tag/v16.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3843/default-remediation-status"
            }
        ]
    }
}