{
    "source": "BDSA",
    "name": "BDSA-2019-1433",
    "title": "doorGets Vulnerable to Remote Code Execution (RCE) via Arbitrary File Upload in File Upload Functionality",
    "description": "An arbitrary file upload vulnerability has been discovered in doorGets. An attacker could exploit this vulnerability by uploading arbitrary file types which can aid in the execution of other malicious attacks, such as information exposure, data modification or trigger a denial-of-service (DoS) condition.",
    "technicalDescription": "A weakness has been discovered in doorGets can lead to arbitrary file upload. This functionality is handled in the file `\\fileman\\php\\upload.php` and contains multiple issues which can be bypassed. The `getFilesPath` function does not implement sufficient validation to determine which account type can utilize this functionality. The `CanUploadFile()` function is called to check which file types can be uploaded to the application.\n\nThe `FORBIDDEN_UPLOADS` parameter stores which file types are restricted by the application. This parameter is populated from the `doorGets_CMS_V7.0\\fileman\\conf.json` file which is cloned from the `doorGets_CMS_V7.0\\fileman\\admin.json` file on initial configuration. This functionality can be manipulated via vulnerability `CVE-2019-11612` to delete or modify which file types will be restricted by the application. \n\nDue to the insufficient restrictions on which account types can utilize the upload functionality, this allows a malicious actor to upload dangerous files. An attacker could, for example, upload a PHP file which will spawn a web shell on the target host once accessed.",
    "publishedDate": "2019-05-08T15:17:05.162Z",
    "updatedDate": "2019-05-08T15:17:05.151Z",
    "disclosureDate": "2019-05-02T00:00:00.000Z",
    "exploitPublishDate": "2019-05-02T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNCORROBORATED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:U/RC:UR)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "REASONABLE",
            "score": 8.0
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:U/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "itodaro",
    "workaround": "",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1433",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11615",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1433/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/itodaro/doorGets_cve",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/itodaro/doorGets_cve",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1433/default-remediation-status"
            }
        ]
    }
}