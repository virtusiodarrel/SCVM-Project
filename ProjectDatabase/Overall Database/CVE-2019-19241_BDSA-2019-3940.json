{
    "source": "BDSA",
    "name": "BDSA-2019-3940",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via 'sendmsg()' Kernel Thread Offload Functionality",
    "description": "The Linux kernel is vulnerable to privilege escalation due to the unsafe handing of messages that are sent to the operating system. A local attacker could execute code with root privileges by running a crafted executable.",
    "technicalDescription": "The Linux kernel's `io_uring` functionality allows user space processes to communicate with the kernel. If a user space process submits a `IORING_OP_SENDMSG` type message to the `io_uring` submission queue, the `sendmsg()` function will be called in order to send the request through to the kernel. The request can be executed in several contexts, depending on what current state of the system. If the message cannot be sent without exhibiting blocking, a kernel worker thread can be used to evaluate the request. The system will attempt to conduct credentials checks in order to ensure that certain requests are not evaluated unless the invoking process has the correct privileges. However, if a kernel thread is servicing the request, then the credentials checks will always pass successfully, as the kernel thread will be executing in association with UID 0. A local attacker could therefore execute code with root privileges by submitting crafted `io_uring` requests in a manner that ensures that they will always be evaluated by a kernel worker thread. One such way an attacker could achieve this is by chaining multiple crafted requests, one that is of type `IORING_OP_RECVMSG` which is followed by a type of `IRONG_OP_SENDMSG`.",
    "publishedDate": "2019-12-19T12:30:49.492Z",
    "updatedDate": "2019-12-19T12:30:49.468Z",
    "disclosureDate": "2019-12-16T00:00:00.000Z",
    "exploitPublishDate": "2019-12-16T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.3.15**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=39f13d4e91c7274fe34b9b9fde7077eb40ad8c7a) commit and [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ad700a7eb17dc3fc1f96152b4291532e5ba5a7ad) commit.\n* [**5.4.2**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=d6245944452ce4592ea975491f5e90e75b346bef) commit [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8387e3688aa9e06a12b58abbcfe2cbfd0cf0f589) commit.\n* [**5.5-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=d69e07793f891524c6bbf1e75b9ae69db4450953) commit [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=181e448d8709e517c9c7b523fcd209f24eb38ca7) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn (Google Security Research)",
    "workaround": "",
    "vendorFixDate": "2019-11-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-3940",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-250"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-19241",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-3940/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=181e448d8709e517c9c7b523fcd209f24eb38ca7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=39f13d4e91c7274fe34b9b9fde7077eb40ad8c7a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8387e3688aa9e06a12b58abbcfe2cbfd0cf0f589",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ad700a7eb17dc3fc1f96152b4291532e5ba5a7ad",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=d6245944452ce4592ea975491f5e90e75b346bef",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=d69e07793f891524c6bbf1e75b9ae69db4450953",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0fa03c624d8f",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/155669/GS20191216153944.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/155669/GS20191216153944.txt",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}