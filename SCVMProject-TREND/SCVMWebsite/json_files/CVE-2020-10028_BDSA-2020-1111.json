{
    "source": "BDSA",
    "name": "BDSA-2020-1111",
    "title": "Zephyr Vulnerable to Code Execution and Privilege Escalation via Insufficient Argument Validation in Multiple Syscalls in GPIO Subsystem",
    "description": "Zephyr contains a code execution vulnerability which could result in privilege escalation due to insufficient argument validation in multiple syscalls in GPIO subsystem. An attacker with access to the GPIO subsystem API could execute malicious code in userspace and potentially gain elevated privileges.",
    "technicalDescription": "The `z_vrfy_gpio_enable_callback`, `z_vrfy_gpio_disable_callback` and `z_vrfy_gpio_get_pending_int` functions in `drivers/gpio/gpio_handlers.c` fail to validate the driver object before performing the corresponding API actions. This could allow an attacker with access to the GPIO subsystem API to perform code execution in user space and potentially gain elevated privileges.",
    "publishedDate": "2020-05-14T14:07:09.321Z",
    "updatedDate": "2021-07-26T11:16:33.773Z",
    "disclosureDate": "2020-05-05T00:00:00.000Z",
    "solution": "Fixed in **[v2.2.0](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.2.0)** by [this](https://github.com/zephyrproject-rtos/zephyr/commit/d6d42bef97) commit.\n\nFixed in **[v1.14.2](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v1.14.2)** by [this](https://github.com/zephyrproject-rtos/zephyr/commit/8c49afac8d) commit.\n\nFixed by [this](https://github.com/zephyrproject-rtos/zephyr/commit/7722736184fc4d96e11f656d59eac82e6f71f5da) commit in the **v2.1** branch which is not yet included in any release.\n\nThe latest stable releases are available [here](https://github.com/zephyrproject-rtos/zephyr/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-03-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1111",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10028",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1111/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.zephyrproject.org/latest/security/vulnerabilities.html#cve-2020-10028",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/04d9d57a63a88a4df3a87bd63ca65c3596b493d0",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/7722736184fc4d96e11f656d59eac82e6f71f5da",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/8c49afac8d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/d6d42bef97",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v1.14.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-32",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1111/default-remediation-status"
            }
        ]
    }
}