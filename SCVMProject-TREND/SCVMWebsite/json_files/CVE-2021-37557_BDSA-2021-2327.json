{
    "source": "BDSA",
    "name": "BDSA-2021-2327",
    "title": "Centreon Vulnerable to SQL Injection (SQLi) via Insufficient Input Sanitization in 'generateImage.php' File",
    "description": "Centreon is vulnerable to an SQL Injection (SQLi) issue due to a lack of sufficient input sanitization in the `generateImage.php` file for values that are included in a database query.\n\nAn attacker with standard user privileges could abuse this issue in order to execute arbitrary SQL commands against the database to read or modify information. This issue could potentially be used to enable further attacks, such as privilege escalation.",
    "technicalDescription": "Centreon is vulnerable to an SQL Injection (SQLi) issue because multiple user controlled parameters that are used within a database query in the `www/include/views/graphs/generateGraphs/generateImage.php` file are not sufficiently sanitized.\n\nAn authenticated attacker that is considered 'unprivileged' could call the affected file and include malicious content in the affected parameters to execute arbitrary SQL commands. It is suggested in the third-party vulnerability [report](https://www.synacktiv.com/sites/default/files/2021-07/Centreon_Multiple_vulnerabilities_0.pdf) that the vulnerable parameter is `index`. In remedying the issue, the vendor has updated the validation for multiple parameters in the `generateImage.php` file to ensure that they are of the expected type.",
    "publishedDate": "2021-08-04T11:23:15.513Z",
    "updatedDate": "2021-08-04T11:23:15.506Z",
    "disclosureDate": "2021-07-28T00:00:00.000Z",
    "exploitPublishDate": "2021-07-28T00:00:00.000Z",
    "solution": "Fixed in:\n* [**21.04.2**](https://github.com/centreon/centreon/releases/tag/21.04.2) by [this](https://github.com/centreon/centreon/commit/0726ef967316b5cb95e910530004ccdbc6870480) commit,\n* [**20.10.8**](https://github.com/centreon/centreon/releases/tag/20.10.8) by [this](https://github.com/centreon/centreon/commit/c31e1931ccf14c304fbc3d8be7569124a90f2f2c) commit,\n* [**20.04.14**](https://github.com/centreon/centreon/releases/tag/20.04.14) by [this](https://github.com/centreon/centreon/commit/879ef102d3abb70aaddb33d849ea3a93013e825d) commit,\n* [**2.8.38**](https://github.com/centreon/centreon/releases/tag/2.8.38) by [this](https://github.com/centreon/centreon/commit/773fe295eff15b6e95715173f6c3d4379372d262) commit.\n\nThe latest stable releases are available [here](https://github.com/centreon/centreon/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Guillaume Andr\u00e9 & Th\u00e9o Louis-Tisserand from Synacktiv",
    "workaround": "",
    "vendorFixDate": "2021-05-05T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2327",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-37557",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2327/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/0726ef967316b5cb95e910530004ccdbc6870480",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/773fe295eff15b6e95715173f6c3d4379372d262",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/879ef102d3abb70aaddb33d849ea3a93013e825d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/c31e1931ccf14c304fbc3d8be7569124a90f2f2c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/2.8.38",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/20.04.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/20.10.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/21.04.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synacktiv.com/sites/default/files/2021-07/Centreon_Multiple_vulnerabilities_0.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.synacktiv.com/sites/default/files/2021-07/Centreon_Multiple_vulnerabilities_0.pdf",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2327/default-remediation-status"
            }
        ]
    }
}