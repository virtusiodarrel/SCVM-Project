{
    "source": "BDSA",
    "name": "BDSA-2022-1586",
    "title": "Apache NiFi Vulnerable to Information Disclosure via Insufficiently Protected Credentials",
    "description": "Apache NiFi contains an information disclosure vulnerability. A local attacker could exploit this issue to gain access to credential data, such as usernames and the `bcrypt` hashes of passwords.",
    "technicalDescription": "This issue exists in the `Login Identity Providers` configuration file, where sensitive information relating to credentials is held. When creating or updating credentials, NiFi would write a copy of the file to the OS temporary directory, which on most systems has global read permissions as default. This would allow an attacker to view the information in the file.",
    "publishedDate": "2022-06-08T13:20:21.514Z",
    "updatedDate": "2022-06-08T13:20:21.505Z",
    "disclosureDate": "2022-03-27T00:00:00.000Z",
    "exploitPublishDate": "2022-04-06T00:00:00.000Z",
    "solution": "Fixed in version [**1.16.0**](https://github.com/apache/nifi/releases/tag/rel%2Fnifi-1.16.0) by [this](https://github.com/apache/nifi/commit/859d5fe8cfe05ad24600b021f0ebf15753a8105c) commit.\n\nThe latest stable releases can be found [here](https://github.com/apache/nifi/tags).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.7
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.0,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.5,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jonathan Leitschuh",
    "workaround": "The original reporter has suggested the following as a sufficient workaround:\n\n> Setting the java.io.tmpdir system environment variable to a directory that is exclusively owned by the executing user will fix this vulnerability for all operating systems.",
    "vendorFixDate": "2022-03-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1586",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-522"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-26850",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1586/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/JLLeitschuh/security-research/security/advisories/GHSA-rvp4-r3g6-8hxq",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/JLLeitschuh/security-research/security/advisories/GHSA-rvp4-r3g6-8hxq",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/nifi/commit/859d5fe8cfe05ad24600b021f0ebf15753a8105c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/nifi/releases/tag/rel%2Fnifi-1.16.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/nifi/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://nifi.apache.org/security.html#CVE-2022-26850",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1586/default-remediation-status"
            }
        ]
    }
}