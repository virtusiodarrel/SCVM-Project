{
    "source": "BDSA",
    "name": "BDSA-2019-1856",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) via Use-After-Free due to Race Condition Between 'modify_ldt()' and '#BR' Exception",
    "description": "The Linux kernel is vulnerable to a race condition between certain X86 MPX exception handling and LDT routines. A local attacker could leverage this flaw to cause a denial-of-service (DoS) of the entire system.",
    "technicalDescription": "Linux will raise a `#BR` exception with an MPX bounds violation and will subsequently parse the faulting instruction and compute the linear address of the operand.  For 32 bit code, it will also look up the segment descriptor and add the segment offset to the address.  The `get_desc()`function in `arch/x86/lib/insn-eval.c` will lock the `mm` context but drop the lock before returning the pointer. This opens up a use-after-free race window, because the pointer may be free'd before the caller actually accesses it.\n\nNote that this only affects X86 hardware that supports the MPX instruction set. Such flaws have been used previously for privilege escalation and denial-of-service.",
    "publishedDate": "2019-06-21T14:55:47.661Z",
    "updatedDate": "2019-07-05T10:58:13.949Z",
    "disclosureDate": "2019-06-20T00:00:00.000Z",
    "exploitPublishDate": "2019-06-20T00:00:00.000Z",
    "solution": "Fixed in versions [**4.19.50**](https://www.kernel.org), [**5.1.9**](https://www.kernel.org), [**5.2-rc4**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b598ddc7b9fc87b09bdadb63abf92b4ba46cd385) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.7,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:L/AC:M/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn",
    "workaround": "",
    "vendorFixDate": "2019-06-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1856",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-13233",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1856/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1879",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1879",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b598ddc7b9fc87b09bdadb63abf92b4ba46cd385",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}