{
    "source": "BDSA",
    "name": "BDSA-2021-0395",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) via Grant Mapping Error Handling Issues",
    "description": "The Linux kernel is vulnerable to improperly handling certain error conditions in its grant mapping functionality for Xen. A privileged guest attacker able to load a malicious frontend driver could cause a system wide (entire domain) denial-of-service (DoS).",
    "technicalDescription": "The grant mapping operations can occur as batched hypercalls. Their success or failure is each reported to the backend driver. In para virtualization (PV) mode the Linux backend drivers mishandle these batched operations by ignoring some errors, and not inspecting some operations that follow a previous error. This can lead to a crash in the backend driver, or memory resource leaks that could cause a denial-of-service (DoS) of the entire backend domain.\n\nOnly versions running in PV mode on x86, or ARM systems, are vulnerable.",
    "publishedDate": "2021-02-17T11:52:19.778Z",
    "updatedDate": "2021-11-10T08:49:36.859Z",
    "disclosureDate": "2021-02-16T00:00:00.000Z",
    "solution": "Fixed by commits:\n\n* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a35f2ef3b7376bfd0a57f7844bd7454389aae1fc).\n* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b512e1b077e5ccdbd6e225b15d934ab12453b70a).\n* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=dbe5283605b3bc12ca45def09cc721a0a5c853a2).\n* [Commit 4](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ebee0eab08594b2bd5db716288a4f1ae5936e9bc).\n* [Commit 5](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=36bf1dfb8b266e089afa9b7b984217f17027bf35).\n\nIn versions:\n* [**4.4.258**](https://www.kernel.org).\n* [**4.9.258**](https://www.kernel.org).\n* [**4.14.222**](https://www.kernel.org).\n* [**4.19.177**](https://www.kernel.org).\n* [**5.4.100**](https://www.kernel.org).\n* [**5.10.18**](https://www.kernel.org).\n* [**5.11.1**](https://www.kernel.org).\n* [**5.12-rc2**](https://www.kernel.org).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 5.1,
        "severity": "MEDIUM",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "(AV:A/AC:L/Au:S/C:N/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 1.7,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jan Beulich of SUSE",
    "workaround": "Applying the patches listed in [this](http://xenbits.xen.org/xsa/advisory-361.html) advisory mitigates the vulnerability. \n**Note:** These are official patches from the Xen maintainers, but are not yet part of any stable kernel release.\n\nThe vendor supplies the following workaround:\n \"On x86, running the backends in HVM or PVH domains will avoid the vulnerability. For protocols where other, e.g. non-kernel-based backends are available, reconfiguring guests to use alternative (e.g. qemu-based) backends may allow to avoid the vulnerability as long as these backends don't rely on similar functionality provided by the xen-gntdev (`/dev/gntdev`) driver.\"",
    "vendorFixDate": "2021-02-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0395",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-26932",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0395/ranges"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-361.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-361.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=36bf1dfb8b266e089afa9b7b984217f17027bf35",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a35f2ef3b7376bfd0a57f7844bd7454389aae1fc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b512e1b077e5ccdbd6e225b15d934ab12453b70a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=dbe5283605b3bc12ca45def09cc721a0a5c853a2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ebee0eab08594b2bd5db716288a4f1ae5936e9bc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0395/default-remediation-status"
            }
        ]
    }
}