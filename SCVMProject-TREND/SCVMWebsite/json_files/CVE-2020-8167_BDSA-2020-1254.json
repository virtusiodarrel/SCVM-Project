{
    "source": "BDSA",
    "name": "BDSA-2020-1254",
    "title": "Ruby on Rails Vulnerable to Cross-Site Request Forgery (CSRF) via 'data-remote' Form Manipulation",
    "description": "Ruby on Rails is vulnerable to cross-site request forgery (CSRF) token disclosure due to forms not checking the origin domain before adding CSRF headers to requests. An attacker who is able to influence the domain that certain forms are being sent to could steal the CSRF token from legitimate users and execute actions on the web application on their behalf.",
    "technicalDescription": "The vulnerability is present when an attacker is able to control the `href` attribute of an anchor tag or the action attribute of a `data-remote` form tag that will trigger a POST action. The CSRF header will automatically be included and sent to the attacker's controlled domain.",
    "publishedDate": "2020-05-29T11:00:06.452Z",
    "updatedDate": "2020-05-29T11:00:06.441Z",
    "disclosureDate": "2020-05-18T00:00:00.000Z",
    "exploitPublishDate": "2020-05-26T00:00:00.000Z",
    "solution": "Fixed in [**5.2.4.3**](https://github.com/rails/rails/releases/tag/v5.2.4.3) by [this](https://github.com/rails/rails/commit/fbc7bec074b5ef9ae22f79ca5d9bafec7b276dd3) commit.\n\nFixed in [**6.0.3.1**](https://github.com/rails/rails/releases/tag/v6.0.3.1) by [this](https://github.com/rails/rails/commit/47a8dc340d63684e4c32f224aa166339f1abfce1) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.3,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ben Toews of GitHub",
    "workaround": "If an upgrade is not possible, the vendor recommends filtering user parameters that control the `href` attribute of an anchor tag or the action attribute of a form tag.\n\nFor example, code like this:\n\n    link_to params\n\nShould be changed to:\n\n    link_to filtered_params\n\n    def filtered_params\n      # Filter just the parameters that you trust\n    end",
    "vendorFixDate": "2020-05-06T00:00:00.000Z",
    "vendorNotifiedDate": "2016-12-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1254",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8167",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1254/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/47a8dc340d63684e4c32f224aa166339f1abfce1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/fbc7bec074b5ef9ae22f79ca5d9bafec7b276dd3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v5.2.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v6.0.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/forum/#!topic/rubyonrails-security/x9DixQDG9a0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/forum/#!topic/rubyonrails-security/x9DixQDG9a0",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/189878",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1254/default-remediation-status"
            }
        ]
    }
}