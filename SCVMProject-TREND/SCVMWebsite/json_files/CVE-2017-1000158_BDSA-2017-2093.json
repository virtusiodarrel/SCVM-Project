{
    "source": "BDSA",
    "name": "BDSA-2017-2093",
    "title": "Python Vulnerable to Heap Based Buffer-Overflow via 'PyString_DecodeEscape'",
    "description": "Python is vulnerable to a denial-of-service (DoS) due to a heap based buffer-overflow.",
    "technicalDescription": "An integer overflow can occur in pythons `PyString_DecodeEscape()` function in `stringobject.c`.  This is due to an unchecked multiplication of values defining a buffer size.  This will cause a heap based buffer-overflow, resulting in a denial-of-service due to an application crash.\n\nResearch has shown that in past instances vulnerabilities such as this have eventually been exploited by attackers to gain remote code execution or privilege escalation. Development of such an exploit is often a lengthy process, and these exploits are often highly prized.\u2002While there is currently no evidence to suggest that a remote code execution exploit exists for this particular vulnerability, we cannot guarantee that one will not be developed in the future.",
    "publishedDate": "2017-12-05T11:11:53.090Z",
    "updatedDate": "2019-10-29T14:40:21.380Z",
    "disclosureDate": "2017-11-17T00:00:00.000Z",
    "exploitPublishDate": "2017-06-13T00:00:00.000Z",
    "solution": "Fixed in version  [**2.7.14**](https://www.python.org/downloads/release/python-2714/) by [this](https://github.com/python/cpython/commit/c3c9db89273fabc62ea1b48389d9a3000c1c03ae) commit.\nFixed in version [**3.4.10**](https://github.com/python/cpython/commits/v3.4.10) by [this](https://github.com/python/cpython/commit/6c004b40f9d51872d848981ef1a18bb08c2dfc42) commit.\nFixed in version [**3.5.8**](https://github.com/python/cpython/tree/v3.5.8) by [this](https://github.com/python/cpython/commit/fd8614c5c5466a14a945db5b059c10c0fb8f76d9) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.7
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jay Bosamiya",
    "workaround": "",
    "vendorFixDate": "2017-09-17T00:00:00.000Z",
    "vendorNotifiedDate": "2017-06-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2093",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-680"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-1000158",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2093/ranges"
            },
            {
                "rel": "reference",
                "href": "http://python-security.readthedocs.io/vuln/cve-2017-1000158_pystring_decodeescape_integer_overflow.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/file46950/poc-gen.py",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue30657",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/6c004b40f9d51872d848981ef1a18bb08c2dfc42",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/c3c9db89273fabc62ea1b48389d9a3000c1c03ae",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/fd8614c5c5466a14a945db5b059c10c0fb8f76d9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commits/v3.4.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/tree/v3.5.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/145136/USN-3496-3.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.python.org/downloads/release/python-2714/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}