{
    "source": "BDSA",
    "name": "BDSA-2021-4158",
    "title": "Express-Handlebars Vulnerable to File Disclosure via 'layout' Parameter",
    "description": "Express-Handlebars contains a file disclosure vulnerability due to express engine API templates. An attacker could exploit this issue by passing maliciously crafted engine configuration parameters to the template, potentially causing file disclosure. This may also result in potential impacts in downstream application code, with impact specific to the engine used.\n\n**Note:** The vendor was unable to produce an effective fix, and has instead adding documentation in `README.md` warning of the dangers of the vulnerability.",
    "technicalDescription": "The express render API mixes pure template data with engine configuration options, such as the layout parameter. Only files with existing extensions can be included, with extension-lacking files being assigned the `.handlebars` extension. Downstream vulnerabilities can be caused by applications passing user-controlled objects directly into a render engine which accepts config options.",
    "publishedDate": "2022-03-02T10:18:54.685Z",
    "updatedDate": "2022-08-30T17:31:42.639Z",
    "disclosureDate": "2021-01-28T00:00:00.000Z",
    "exploitPublishDate": "2021-01-28T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:U/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:U/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Augustin Gianni",
    "workaround": "",
    "vendorNotifiedDate": "2021-01-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4158",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32820",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4158/ranges"
            },
            {
                "rel": "reference",
                "href": "https://securitylab.github.com/advisories/GHSL-2021-018-express-handlebars/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://securitylab.github.com/advisories/GHSL-2021-018-express-handlebars/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4158/default-remediation-status"
            }
        ]
    }
}