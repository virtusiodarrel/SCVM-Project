{
    "source": "BDSA",
    "name": "BDSA-2022-1240",
    "title": "OpenSSL Vulnerable to Adversary-in-the-Middle (AitM) via Incorrect MAC Key in 'RC4-MD5' Ciphersuite",
    "description": "OpenSSL is vulnerable to an Adversary-in-the-Middle (AitM) attack. An attacker is able to modify data being sent from one endpoint to an OpenSSL 3.0 recipient which can still pass integrity checks during transport due to an incorrect implementation of MAC keys in the `RC4-MD5` Ciphersuite.\n\n**Note:** Both endpoints must both use the `RC4-MD5` ciphersuite in order to exploit this vulnerability.",
    "technicalDescription": "The `RC4-MD5` ciphersuite uses 'AAD' data as the MAC key which makes the MAC key predictable. This means an attacker will be able to modify data being sent from one endpoint to an OpenSSL 3.0 recipient successfully without going noticed as integrity checks will be passed due to insufficient implementation of MAC keys. The confidentiality of the data is not impacted as the data is encrypted and cannot be decrypted, however the integrity is impacted due to the ability to modify the data.\n\nIf an attacker is present and both endpoints are OpenSSL 3.0, both servers could be compromised as data can be modified in both directions. If an attacker is not present, the handshake communication with this particular ciphersuite will fail. \n\nThe vendor has stated that the following condition must be met if OpenSSL 3.0 is to use the compromised ciphersuite:\n\n\"1) OpenSSL must have been compiled with the (non-default) compile time option\n   `enable-weak-ssl-ciphers`.\n\n2) OpenSSL must have had the legacy provider explicitly loaded (either through\n   application code or via configuration).\n\n3) The ciphersuite must have been explicitly added to the ciphersuite list.\n\n4) The libssl security level must have been set to 0 (default is 1).\n\n5) A version of SSL/TLS below TLSv1.3 must have been negotiated.\n\n6) Both endpoints must negotiate the RC4-MD5 ciphersuite in preference to any\n   others that both endpoints have in common.\"\n\t \nThis has been mitigated by using `OSSL_CIPHER_PARAM_AEAD_MAC_KEY` data as the MAC key as opposed to using the 'AAD' data `OSSL_CIPHER_PARAM_AEAD_TLS1_AAD` as the MAC key.",
    "publishedDate": "2022-05-04T14:05:03.346Z",
    "updatedDate": "2022-05-04T14:05:03.314Z",
    "disclosureDate": "2022-05-03T00:00:00.000Z",
    "solution": "Fixed in version [**3.0.3**](https://github.com/openssl/openssl/releases/tag/openssl-3.0.3) by [this](https://github.com/openssl/openssl/commit/7d56a74a96828985db7354a55227a511615f732b) commit.\n\nThe latest stable releases can be found [here](https://github.com/openssl/openssl/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tom Colley",
    "workaround": "",
    "vendorFixDate": "2022-05-03T00:00:00.000Z",
    "vendorNotifiedDate": "2022-04-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1240",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-345"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-1434",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1240/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/commit/7d56a74a96828985db7354a55227a511615f732b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/commit/8fece3355a76bf9c82d13b5389f88a3649c1e547",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/releases/tag/openssl-3.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openssl.org/news/secadv/20220503.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1240/default-remediation-status"
            }
        ]
    }
}