{
    "source": "BDSA",
    "name": "BDSA-2020-3243",
    "title": "axios Vulnerable to Server Side Request Forgery (SSRF) via Proxy Bypass with Redirect URLs",
    "description": "It was found that axios could allow for server side request forgery (SSRF) attacks if it is used to pass user-supplied URL requests via a proxy. This vulnerability could be used to bypass the proxy that protects internal networks from SSRF attacks and submit requests to restricted local IP addresses.",
    "technicalDescription": "URLs that respond with a redirect will not go through the proxy that axios points to - only the first request will go as intended, but the rest will bypass the proxy. If the URL is supplied by the user, this could be used to perform SSRF attacks on the internal network that the proxy protects.",
    "publishedDate": "2020-11-11T14:01:21.044Z",
    "updatedDate": "2021-02-01T16:40:04.456Z",
    "disclosureDate": "2020-10-29T00:00:00.000Z",
    "exploitPublishDate": "2020-10-29T00:00:00.000Z",
    "solution": "Fixed in [**0.21.1**](https://github.com/axios/axios/releases/tag/v0.21.1) by [this](https://github.com/axios/axios/commit/c7329fefc890050edd51e40e469a154d0117fc55) commit.\n\nThe latest stable releases are available [here](https://github.com/axios/axios/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dima Ryskin",
    "workaround": "A proposed workaround is to execute the request again with the URL of the redirected request set in the old configuration:\n```\naxios.request(myConfig).catch(error => {\n  if (error.request._isRedirect) {\n    return axios.request({\n      ...myConfig,\n      url: error.request._options.path\n    });\n  }\n});\n```",
    "vendorFixDate": "2020-11-24T00:00:00.000Z",
    "vendorNotifiedDate": "2020-10-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3243",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-440"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28168",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3243/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/axios/axios/commit/c7329fefc890050edd51e40e469a154d0117fc55",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/axios/axios/issues/3369",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/axios/axios/issues/3369",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/axios/axios/issues/3369",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/axios/axios/releases/tag/v0.21.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/axios/axios/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3243/default-remediation-status"
            }
        ]
    }
}