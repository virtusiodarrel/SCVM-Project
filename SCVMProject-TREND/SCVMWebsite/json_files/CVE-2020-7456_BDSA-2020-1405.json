{
    "source": "BDSA",
    "name": "BDSA-2020-1405",
    "title": "FreeBSD Vulnerable to Local Code Execution via USB Human Interface Device (HID) Descriptors",
    "description": "FreeBSD contains a flaw in Human Interface Device (HID) descriptors. This allows attackers with physical access to a USB port to use a specially crafted USB device to gain kernel or user-space code execution.",
    "technicalDescription": "The issue is due to HID descriptors pushing/popping the current state, changing their pop level. If the level is not restored later, an invalid memory location may be used to process the next HID item. This could be leveraged by a local attacker to execute code at user or kernel level.",
    "publishedDate": "2020-06-12T15:17:32.549Z",
    "updatedDate": "2020-10-04T21:42:53.816Z",
    "disclosureDate": "2020-06-09T00:00:00.000Z",
    "solution": "Fixed in:\n* **[11.3-RELEASE-p10](https://www.freebsd.org/where.html)** by [this](https://svnweb.freebsd.org/base?view=revision&revision=361972) revision,\n* **[12.1-RELEASE-p6](https://www.freebsd.org/where.html)** by [this](https://svnweb.freebsd.org/base?view=revision&revision=361972) revision,\n* **[11.4-RC2-p1](https://www.freebsd.org/where.html)** by [this](https://svnweb.freebsd.org/base?view=revision&revision=361972) revision.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:L/AC:L/Au:N/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.9,
        "severity": "MEDIUM",
        "attackVector": "PHYSICAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andy Nguyen",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, the vendor recommends setting `sysctl hw.usb.disable_enumeration=1` to disable USB device enumeration.",
    "vendorFixDate": "2020-06-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1405",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-119"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7456",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1405/ranges"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=361918",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=361919",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=361972",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-20:17.usb.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-20:17.usb.asc",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/where.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.usb.org/sites/default/files/documents/hid1_11.pdf",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1405/default-remediation-status"
            }
        ]
    }
}