{
    "source": "BDSA",
    "name": "BDSA-2021-1972",
    "title": "PrismJS Vulnerable to Regular Expression Denial-of-Service (ReDoS) via Crafted ASCIIDoc or ERB Strings",
    "description": "PrismJS is vulnerable to a denial-of-service (DoS) issue due to a regular expression processing flaw for ASCIIDoc and ERB strings.\n\nIn cases where Prism is used to highlight user-supplied content, an attacker could submit a crafted input that takes an excessive amount of time to highlight.\n\n**Note**: The vendor has stated [here](https://github.com/PrismJS/prism/security/advisories/GHSA-gj77-59wh-66hg) that the only affected languages are ASCIIDoc and ERB. Other languages are unaffected.",
    "technicalDescription": "PrismJS is vulnerable to regular expression denial-of-service (ReDoS) conditions because the highlighting functionality for the ASCIIDoc and ERB languages contains an exponential backtracking flaw that causes the parsing of such languages to take an excessive amount of time.\n\nAn attacker could submit a crafted input using one of the affected languages and trick a victim user into viewing the affected content in order to trigger the flaw and cause sluggish behavior in the victim's browser where the crafted string can take a very long time to highlight.",
    "publishedDate": "2021-06-30T13:50:34.464Z",
    "updatedDate": "2021-06-30T13:50:34.454Z",
    "disclosureDate": "2021-06-28T00:00:00.000Z",
    "solution": "Fixed in [**1.24.0**](https://github.com/PrismJS/prism/releases/tag/v1.24.0) by [this](https://github.com/PrismJS/prism/commit/d85e30da6755fdbe7f8559f8e75d122297167018) commit.\n\nThe latest stable releases are available [here](https://github.com/PrismJS/prism/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-03-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1972",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32723",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1972/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrismJS/prism/commit/d85e30da6755fdbe7f8559f8e75d122297167018",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrismJS/prism/pull/2688",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrismJS/prism/pull/2774",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrismJS/prism/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrismJS/prism/releases/tag/v1.24.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrismJS/prism/security/advisories/GHSA-gj77-59wh-66hg",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1972/default-remediation-status"
            }
        ]
    }
}