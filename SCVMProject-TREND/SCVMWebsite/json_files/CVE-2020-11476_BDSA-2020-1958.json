{
    "source": "BDSA",
    "name": "BDSA-2020-1958",
    "title": "Concrete5 Vulnerable to Remote Code Execution (RCE) via Improper Restrictions on PHP File Uploads",
    "description": "Concrete5 is vulnerable to remote code execution (RCE) due to functionality that allows the administrator to upload dangerous file types. Once the uploaded files are accessed from the browser, the server will interpret them as PHP code and run it. Note that for successful exploitation the administrator must first add the malicious file extension to the `Allowed file types` list.",
    "technicalDescription": "The following extensions could be used to exploit this vulnerability:  `phar`, `php8`, `shtml`, `cgi`, `pl`, `phpsh`, `pht` and `.htaccess`. Once they are added in the `Allowed file types` section in `/index.php/dashboard/system/files/filetypes`, the server will allow them to be uploaded and run as PHP scripts.",
    "publishedDate": "2020-08-10T10:22:54.105Z",
    "updatedDate": "2020-08-10T10:22:54.101Z",
    "disclosureDate": "2020-07-15T00:00:00.000Z",
    "exploitPublishDate": "2020-07-15T00:00:00.000Z",
    "solution": "Fixed in [**8.5.3**](https://github.com/concrete5/concrete5/releases/tag/8.5.3) by [this](https://github.com/concrete5/concrete5/commit/1873c237a2083e7c8fe7166013661479bd052c6d) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Gerbert Roitburd of usd AG",
    "workaround": "To work around the issue the credited researcher suggests adding the dangerous file types to `concrete.upload.extensions_blacklist`. However, this is not always a foolproof solution since it is difficult to cover all of PHP file types.",
    "vendorFixDate": "2020-06-03T00:00:00.000Z",
    "discoveryDate": "2020-03-31T00:00:00.000Z",
    "vendorNotifiedDate": "2020-04-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1958",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-641"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11476",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1958/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/concrete5/concrete5/commit/1873c237a2083e7c8fe7166013661479bd052c6d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/concrete5/concrete5/releases/tag/8.5.3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/concrete5/concrete5/releases/tag/8.5.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://herolab.usd.de/security-advisories/usd-2020-0041/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://herolab.usd.de/security-advisories/usd-2020-0041/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1958/default-remediation-status"
            }
        ]
    }
}