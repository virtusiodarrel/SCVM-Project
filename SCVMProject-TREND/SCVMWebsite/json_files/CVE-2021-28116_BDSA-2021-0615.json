{
    "source": "BDSA",
    "name": "BDSA-2021-0615",
    "title": "Squid Vulnerable to Information Disclosure via Out-of-Bounds Read During WCCP Processing",
    "description": "Squid is vulnerable to information disclosure due to the improper management of system memory resources. A remote unauthenticated attacker could potentially recover sensitive data from memory by sending maliciously crafted requests to a WCCP endpoint. The attack will only succeed if the requests specify and I.P. address that is configured as being trusted within `squid.conf`. If this vulnerability is exploited alongside other Squid vulnerabilities, then it may be possible for an attacker to execute arbitrary code on the underlying machine as the `nobody` user.\n\nWCCPv2 must be enabled within the Squid proxy endpoint in order for the vulnerability to manifest. This requires Squid to have been built with the `--enable-wccpv2` option, and to have been configured with the `wccp2_router` option within the `squid.conf` file. This feature is not enabled by default.",
    "technicalDescription": "Squid stores WCCP router information within `router_identity_info_t` structures. Such structures are stored in arrays so that Squid can keep track of known WCCP routers. These arrays can then be accessed during the processing of client requests. Flaws exist within the array access operations that are performed by Squid. These flaws can be leveraged by an attacker in order to modify the router information, which can cause a client's traffic to be diverted to routers that the attacker controls. This can lead to information disclosure. If this vulnerability is exploited alongside other Squid vulnerabilities, then it may be possible for an attacker to execute arbitrary code on the underlying machine as the `nobody` user.\n\nWCCPv2 must be enabled within the Squid proxy endpoint in order for the vulnerability to manifest. This requires Squid to have been built with the `--enable-wccpv2` option, and to have been configured with the `wccp2_router` option within the `squid.conf` file. This feature is not enabled by default.",
    "publishedDate": "2021-03-11T15:33:24.363Z",
    "updatedDate": "2021-10-11T16:34:50.560Z",
    "disclosureDate": "2021-02-09T00:00:00.000Z",
    "solution": "Fixed in [**5.2**](http://www.squid-cache.org/Versions/v5/) by [this](https://github.com/squid-cache/squid/commit/7a73a54cefff6bb83c03de219a73276e42d183d0) commit, and in [**4.17**](http://www.squid-cache.org/Versions/v4/) by [this](https://github.com/squid-cache/squid/commit/b003a0da7865caa25b5d1e70c79329b32409b02a ) commit.\n\nThe latest stable releases are available [here](http://www.squid-cache.org/Versions/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.7,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.2,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Lyu (Zero Day Initiative)",
    "workaround": "The vendor has stated [here](https://github.com/squid-cache/squid/security/advisories/GHSA-rgf3-9v3p-qp82) that the following measures can be used to greatly restrict an attacker's ability to exploit this vulnerability, and hence constitute a workaround:\n\n> Use Private IP address for control communications (eg WCCPv2) with routers.\n> Firewall restriction of UDP traffic on port 2048 and any other UDP ports used for WCCP(v2) control messages to only permit known devices to communicate with WCCP(v2). Note that ports used by clients and diverted by WCCP (eg 80\nor 443) are not relevant.\n> Ensure the network implements BCP 38 spoofing protection. Include protection against LAN traffic spoofing as much as\npossible.\n> Or, build Squid with `--disable-wccpv2`.\n> Remove all lines for `wccp2_*` directives from`squid.conf`. The default configuration is not to enable WCCPv2.",
    "vendorFixDate": "2021-09-29T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0615",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28116",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0615/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v5/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/7a73a54cefff6bb83c03de219a73276e42d183d0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/b003a0da7865caa25b5d1e70c79329b32409b02a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-rgf3-9v3p-qp82",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-rgf3-9v3p-qp82",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.mail-archive.com/squid-announce@lists.squid-cache.org/msg00132.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.zerodayinitiative.com/advisories/ZDI-21-157/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0615/default-remediation-status"
            }
        ]
    }
}