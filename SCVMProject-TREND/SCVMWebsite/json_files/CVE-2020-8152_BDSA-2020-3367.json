{
    "source": "BDSA",
    "name": "BDSA-2020-3367",
    "title": "Nextcloud Server Vulnerable to Insufficient Protection of Server-Side Encryption Keys",
    "description": "Nextcloud server does not sufficiently protect the confidentiality of server-side encryption keys.  This can lead to an attacker being able to replace encrypted files, leading to a complete loss of data integrity.",
    "technicalDescription": "The vulnerability is due to the server-side encryption keys being insufficiently protected and the Nextcloud server-side encryption not being able to distinguish between a file that has been encrypted by the server itself and a file that has been encrypted by a malicious attacker with access to the Nextcloud data directory. An attacker with access to the Nextcloud server as well as the encrypted files and the public keys of the users can replace the encrypted files with their own crafted files. This  affects the integrity of the encrypted files on the server.",
    "publishedDate": "2020-11-16T17:00:58.138Z",
    "updatedDate": "2020-11-16T17:00:58.124Z",
    "disclosureDate": "2020-10-03T00:00:00.000Z",
    "exploitPublishDate": "2020-11-13T00:00:00.000Z",
    "solution": "Fixed in [**20.0.0-RC1**](https://github.com/nextcloud/server/releases/tag/v20.0.0RC1) by [this](https://github.com/nextcloud/server/commit/5340ab3a75d58651e3cc65688d94444b38570cfc) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Kevin \"Kenny\" Niehage - SysEleven GmbH",
    "workaround": "",
    "vendorFixDate": "2020-09-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3367",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-522"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8152",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3367/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/5340ab3a75d58651e3cc65688d94444b38570cfc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v20.0.0RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/743505",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/743505",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://nextcloud.com/security/advisory/?id=NC-SA-2020-040",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3367/default-remediation-status"
            }
        ]
    }
}