{
    "source": "BDSA",
    "name": "BDSA-2021-2184",
    "title": "Elasticsearch Vulnerable to Denial-of-Service (DoS) via Uncontrolled Recursion in Grok Parser",
    "description": "Elasticsearch is vulnerable to a denial-of-service (DoS) condition due to a lack of sufficient input validation in the Grok parser functionality that allows for uncontrolled recursion to occur.\n\nAn attacker with sufficient privileges to submit arbitrary queries could abuse this flaw and cause Elasticsearch to excessively consume resources which could eventually result in a crash.",
    "technicalDescription": "Elasticsearch is vulnerable to a denial-of-service (DoS) condition because the Grok parser does not sufficiently validate input which means certain combinations of patterns that could result in circular references are not properly detected. When processed, these references can lead to uncontrolled recursion which impacts the stability of Elasticsearch and could crash the node.",
    "publishedDate": "2021-07-22T11:34:29.154Z",
    "updatedDate": "2021-07-22T11:34:29.148Z",
    "disclosureDate": "2021-07-07T00:00:00.000Z",
    "solution": "Fixed in [**7.13.3**](https://github.com/elastic/elasticsearch/releases/tag/v7.13.3) by [this](https://github.com/elastic/elasticsearch/commit/eec9eefc636460fdc3132ff103581b81a5edd5d3) commit and [this](https://github.com/elastic/elasticsearch/commit/e6f3f694bf335623beaf112c5e7780604a8bf2c5) commit.\n\nFixed in [**6.8.17**](https://github.com/elastic/elasticsearch/releases/tag/v6.8.17) by [this](https://github.com/elastic/elasticsearch/commit/fc90c8878877aae38cec24ee1c4cb15966951b08) commit and [this](https://github.com/elastic/elasticsearch/commit/206f6a2512f2ca690999b77a5c759ab214536b82) commit.\n\nThe latest stable releases are available [here](https://www.elastic.co/downloads/elasticsearch).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 5.1,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:A/AC:L/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.7,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.1,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-07-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2184",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-674"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22144",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2184/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.elastic.co/t/elasticsearch-7-13-3-and-6-8-17-security-update/278100",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/commit/206f6a2512f2ca690999b77a5c759ab214536b82",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/commit/e6f3f694bf335623beaf112c5e7780604a8bf2c5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/commit/eec9eefc636460fdc3132ff103581b81a5edd5d3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/commit/fc90c8878877aae38cec24ee1c4cb15966951b08",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/releases/tag/v6.8.17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/releases/tag/v7.13.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.elastic.co/downloads/elasticsearch",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2184/default-remediation-status"
            }
        ]
    }
}