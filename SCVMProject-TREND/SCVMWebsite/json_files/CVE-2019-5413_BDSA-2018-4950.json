{
    "source": "BDSA",
    "name": "BDSA-2018-4950",
    "title": "Morgan for Node.js Vulnerable to Code Injection via Unsanitized Input in compile Function",
    "description": "Morgan contains a code injection flaw.  This is due to certain characters not being escaped when the packages compile function is used.  In most situation an application will not be supplying user input to compile strings used for logging HTTP requests. But in instances where this is present, an attacker could inject arbitrary javaScript. \n\nNote: If this vulnerability is chained with a prototype pollution vulnerability, the impact of this becomes more  severe.",
    "technicalDescription": "The code injection vulnerability is due to insufficient sanitization of the `format` string supplied to the `compile` function in `index.js`. When using a format string of predefined tokens it is trivial to escape the context of the string to inject arbitrary javaScript. \n\nAlthough this is an unlikely way in which the package will be used, it maybe possible to exploit this vulnerability to achieve full remote code injection in chained with a prototype pollution vulnerability in another package.  This situation also depends on the environment of the deployed modules and how input is passed to them.",
    "publishedDate": "2019-06-24T12:07:51.147Z",
    "updatedDate": "2019-07-02T08:47:01.345Z",
    "disclosureDate": "2018-10-28T00:00:00.000Z",
    "exploitPublishDate": "2018-10-28T00:00:00.000Z",
    "solution": "Fixed in version [**1.9.1**](https://github.com/expressjs/morgan/releases/tag/1.9.1) by [this](https://github.com/expressjs/morgan/commit/e329663836809de4be557b200a5b983ab8b4e6c2) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.0,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.2
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-09-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-4950",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5413",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-4950/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/expressjs/morgan/commit/e329663836809de4be557b200a5b983ab8b4e6c2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/expressjs/morgan/releases/tag/1.9.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/390881",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/390881",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-4950/default-remediation-status"
            }
        ]
    }
}