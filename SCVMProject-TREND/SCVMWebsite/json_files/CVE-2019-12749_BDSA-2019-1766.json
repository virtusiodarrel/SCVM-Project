{
    "source": "BDSA",
    "name": "BDSA-2019-1766",
    "title": "DBus Vulnerable to Privilege Escalation via Improper Authentication in 'DBUS_COOKIE_SHA1' Cookie",
    "description": "An improper authentication vulnerability has been discovered in DBus. An attacker could exploit this vulnerability to spoof authentication values and gain unauthorized access and escalated privileges.",
    "technicalDescription": "The `DBUS_COOKIE_SHA1` authentication mechanism implemented by the application is utilized to determine permission rights to shared home directories through a hidden cookie value. The value is written into the `dbus-keyrings` directory by the server and requests the client to read the cookie value to evaluate permission access. It was discovered that this mechanism was flawed if the server didn't have write access to the file directories to store the initial cookie value.\n\nA malicious client with write access can manipulate the `.dbus-keyrings` symlink to cause the `DBusServer` to read and write in an unintended location. This can force the server to reuse previously stored cookie values which is known by the malicious client granting authentication and gaining escalated privileges.\n\nThe authentication functionality is handled in the file `dbus/dbus-auth.c`.",
    "publishedDate": "2019-06-12T13:03:45.250Z",
    "updatedDate": "2019-09-24T10:02:29.723Z",
    "disclosureDate": "2019-05-30T00:00:00.000Z",
    "solution": "Fixed in version [**1.10.28**](https://github.com/freedesktop/dbus/releases/tag/dbus-1.10.28) by [this](https://github.com/freedesktop/dbus/commit/525c2314c56504fb232f9ec7f25cf7dda4d4a1c4) commit.\nFixed in version [**1.12.16**](https://github.com/freedesktop/dbus/releases/tag/dbus-1.12.16) by [this](https://github.com/freedesktop/dbus/commit/47b1a4c41004bf494b87370987b222c934b19016) commit.\nFixed in version [**1.13.12**](https://github.com/freedesktop/dbus/releases/tag/dbus-1.13.12) by [this](https://github.com/freedesktop/dbus/commit/2a11ab9bbd21066b1508c8673821ba5c6d627321) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-05-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1766",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-290"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12749",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1766/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/freedesktop/dbus/commit/2a11ab9bbd21066b1508c8673821ba5c6d627321",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/freedesktop/dbus/commit/47b1a4c41004bf494b87370987b222c934b19016",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/freedesktop/dbus/commit/525c2314c56504fb232f9ec7f25cf7dda4d4a1c4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/freedesktop/dbus/releases/tag/dbus-1.10.28",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/freedesktop/dbus/releases/tag/dbus-1.12.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/freedesktop/dbus/releases/tag/dbus-1.13.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://usn.ubuntu.com/4015-1/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2019/06/11/2",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1766/default-remediation-status"
            }
        ]
    }
}