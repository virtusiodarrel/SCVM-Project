{
    "source": "BDSA",
    "name": "BDSA-2020-1359",
    "title": "Nextcloud Vulnerable to Reflected Cross-Site Scripting (XSS) via Updater Redirect",
    "description": "Nextcloud contains a reflected cross-site scripting (XSS) vulnerability in the updater redirect. This is due to insufficient escaping of user controlled input. This can allow an attacker to execute malicious scripts in the context of the browser, allowing the theft of session tokens, cookies or other sensitive information.",
    "technicalDescription": "Nextcloud does not properly escape the `$updaterUrl` parameter in the`index.php` file. An attacker knowing the secret phrase can exploit this to include malicious scripts, when running the updater from an attacker controlled location. These scripts can then be executed when rendered in the victim's browser. This could allow the attacker to obtain sensitive information, such as browser cookies.",
    "publishedDate": "2020-06-10T11:10:04.094Z",
    "updatedDate": "2020-06-10T11:10:04.083Z",
    "disclosureDate": "2020-03-01T00:00:00.000Z",
    "exploitPublishDate": "2020-03-01T00:00:00.000Z",
    "solution": "Fixed in:\n* [**16.0.0-beta2**](https://github.com/nextcloud/updater/releases/tag/v16.0.0beta2) by [this](https://github.com/nextcloud/updater/commit/4ad55327be514506f81af76e713f7c6386e7529a) commit,\n* [**15.0.6-RC1**](https://github.com/nextcloud/updater/releases/tag/v15.0.6RC1) by [this](https://github.com/nextcloud/updater/commit/cdb80059c211fa865b321031306f4e4a0d3f7d9e) commit,\n* [**14.0.9-RC1**](https://github.com/nextcloud/updater/releases/tag/v14.0.9RC1) by [this](https://github.com/nextcloud/updater/commit/7ac1419fc22a2200084fbf3c4ba1141c8f6f97b5) commit.\n\n The latest stable releases are also available [https://nextcloud.com/install/#].",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:C/C:L/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nikita Tikhomirov (Pentest Generation)",
    "workaround": "",
    "vendorFixDate": "2019-03-26T00:00:00.000Z",
    "vendorNotifiedDate": "2019-03-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1359",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15618",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1359/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/updater/commit/4ad55327be514506f81af76e713f7c6386e7529a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/updater/commit/7ac1419fc22a2200084fbf3c4ba1141c8f6f97b5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/updater/commit/cdb80059c211fa865b321031306f4e4a0d3f7d9e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/updater/releases/tag/v14.0.9RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/updater/releases/tag/v15.0.6RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/updater/releases/tag/v16.0.0beta2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/515484",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/515484",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://nextcloud.com/install/#",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://nextcloud.com/security/advisory/?id=NC-SA-2020-007",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1359/default-remediation-status"
            }
        ]
    }
}