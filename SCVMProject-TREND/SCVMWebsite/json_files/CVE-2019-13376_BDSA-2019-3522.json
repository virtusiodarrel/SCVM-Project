{
    "source": "BDSA",
    "name": "BDSA-2019-3522",
    "title": "phpBB Vulnerable to Cross-Site Request Forgery (CSRF) via Remote Avatar URL",
    "description": "phpBB contains a cross-site request forgery (CSRF) vulnerability that can be leveraged to achieve stored cross-site scripting (XSS). An authenticated attacker could use this to take over user accounts or perform administrator-level actions such as downloading database backups.",
    "technicalDescription": "This vulnerability uses the fact that administrator's session ID(`SID`) variable remains attached as a GET parameter after they finish using the forum's backend. An authenticated attacker could exploit this by setting his avatar's image location to his own server containing malicous code. Whenever a new request by the administrator is made, instead of serving the image the attacker's server would parse the HTTP referrer header which contains the `SID` parameter and use it construct a new redirect. The redirect would actually be a CSRF attack that creates a custom bbCode on behalf of the administrator. The bbCode itself may contain an arbitrary script that could be used by the attacker to take over user accounts as well as perform administrator-level actions such as downloading database backups.\n\nIn order for the online administrator to make an image request to the attacker's server the attacker must first message them. A notification about the message will appear on administrator's panel and the attack will be complete as the administrator's browser tries to get the attacker's remote avatar image.\n\nThis was fixed by properly checking the form key for bbCode creation.",
    "publishedDate": "2019-11-19T09:30:18.788Z",
    "updatedDate": "2019-11-19T09:30:18.765Z",
    "disclosureDate": "2019-09-26T00:00:00.000Z",
    "exploitPublishDate": "2019-09-26T00:00:00.000Z",
    "solution": "Fixed in [**3.2.8**](https://github.com/phpbb/phpbb/releases/tag/release-3.2.8) by [this](https://github.com/phpbb/phpbb/commit/cdf4f5ef85f05c0f94eae1a9edb1c28d4ac3515f) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.6,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 2.1,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-09-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3522",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13376",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3522/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/phpbb/phpbb/commit/cdf4f5ef85f05c0f94eae1a9edb1c28d4ac3515f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/phpbb/phpbb/releases/tag/release-3.2.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ssd-disclosure.com/archives/4007/ssd-advisory-phpbb-csrf-token-hijacking-leading-to-stored-xss",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ssd-disclosure.com/archives/4007/ssd-advisory-phpbb-csrf-token-hijacking-leading-to-stored-xss",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3522/default-remediation-status"
            }
        ]
    }
}