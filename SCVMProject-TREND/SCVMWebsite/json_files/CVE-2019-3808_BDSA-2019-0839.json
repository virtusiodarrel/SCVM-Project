{
    "source": "BDSA",
    "name": "BDSA-2019-0839",
    "title": "Moodle Vulnerable to Stored Cross-Site Scripting (XSS) via Insecure 'Manage Groups' Configuration",
    "description": "Moodle is vulnerable to stored cross-site scripting (XSS) due to improper configuration of the 'manage groups' functionality. This could allow an attacker to inject arbitrary web scripts and steal a user's session cookies.",
    "technicalDescription": "Moodle by design allows certain forms of content which can enable XSS attacks, but mitigates against this by using an `RISK_XSS` flag for any capabilities which do so, restricting access to that capability to trusted users. However, the 'manage groups' capability does not have this flag assigned despite exposing an XSS risk. By default, this capability is only assigned to teachers and managers - but in a misconfigured deployment of Moodle where this capability is available to untrusted users such as students, this could allow them to submit malicious content enabling them to perform stored XSS attacks.",
    "publishedDate": "2019-03-27T15:14:42.632Z",
    "updatedDate": "2019-03-27T15:31:07.732Z",
    "disclosureDate": "2019-01-21T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/moodle/moodle/commit/6360f87cdca744a6a71c315853f6d811a3e54e26) commit in:\n* **[3.6.2](https://github.com/moodle/moodle/releases/tag/v3.6.2)**\n* **[3.5.4](https://github.com/moodle/moodle/releases/tag/v3.5.4)**\n* **[3.4.7](https://github.com/moodle/moodle/releases/tag/v3.4.7)**\n* **[3.1.16](https://github.com/moodle/moodle/releases/tag/v3.1.16)**\n\nThe latest stable releases are available [here](https://download.moodle.org/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.9
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Fariskhi Vidyan",
    "workaround": "",
    "vendorFixDate": "2019-01-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0839",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3808",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0839/ranges"
            },
            {
                "rel": "reference",
                "href": "https://download.moodle.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/6360f87cdca744a6a71c315853f6d811a3e54e26",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.1.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.4.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.5.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.6.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=381228#p1536765",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0839/default-remediation-status"
            }
        ]
    }
}