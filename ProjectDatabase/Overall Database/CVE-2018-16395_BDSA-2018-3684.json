{
    "source": "BDSA",
    "name": "BDSA-2018-3684",
    "title": "Ruby OpenSSL Library Vulnerable to Improper Certificate Validation in 'ossl_x509name_cmp' Function",
    "description": "Ruby's OpenSSL library contains a certificate validation flaw. This could be exploited by an attacker to pose as an authenticated user to the component.",
    "technicalDescription": "The component's equity check of `OpenSSL::X509::Name` fails to handle malicious X.509 certificates submitted after an existing valid certificate. This could be exploited by an attacker to incorrectly pass the malicious certificate as valid. The vulnerable function is `ossl_x509name_cmp` located in `ossl_x509name.cmp`. Successfully exploiting could allow an attacker to execute actions, including signing or encrypting operations, as a legitimate user.",
    "publishedDate": "2018-10-23T10:21:45.344Z",
    "updatedDate": "2018-10-23T10:21:45.332Z",
    "disclosureDate": "2018-10-17T00:00:00.000Z",
    "exploitPublishDate": "2018-10-19T00:00:00.000Z",
    "solution": "Fixed in\n\n* **[2.5.2](https://github.com/ruby/ruby/releases/tag/v2_5_2)** by [this](https://github.com/ruby/ruby/commit/0ca511ef0d16ae8d765313e1f19dfc9f38afa5e5) commit,\n* **[2.4.5](https://github.com/ruby/ruby/releases/tag/v2_4_5)** by [this](https://github.com/ruby/ruby/commit/53f3f02bb2bf16c3426da3fbd0ea9e3783c81bc6) commit,\n* **[2.3.8](https://github.com/ruby/ruby/releases/tag/v2_3_8)** by [this](https://github.com/ruby/ruby/commit/556e9f726e2b80f6088982c6b43abfe68bfad591) commit.\n\nAdditionally, manually upgrading the OpenSSL gem to **2.1.2** or later, via `gem install openssl -v \">= 2.1.2\"`, works as an alternative fix.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tyler Eckstein",
    "workaround": "",
    "vendorFixDate": "2018-10-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3684",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-295"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-599"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-16395",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3684/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/0ca511ef0d16ae8d765313e1f19dfc9f38afa5e5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/53f3f02bb2bf16c3426da3fbd0ea9e3783c81bc6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/556e9f726e2b80f6088982c6b43abfe68bfad591",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/93bc10272734cbbb9197470ca629cc4ea019f6f0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/releases/tag/v2_3_8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/releases/tag/v2_4_5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/releases/tag/v2_5_2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/387250",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2018/10/17/openssl-x509-name-equality-check-does-not-work-correctly-cve-2018-16395/",
                "label": "ADVISORY"
            }
        ]
    }
}