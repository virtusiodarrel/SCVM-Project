{
    "source": "BDSA",
    "name": "BDSA-2021-1774",
    "title": "Nextcloud Server Vulnerable to Brute Forcing via Insufficient IPv6 Rate-Limiting",
    "description": "Nextcloud Server is vulnerable to brute force attacks due to how IPv6 subnets are not considered by the ratelimiting functionality.\n\nThis issue could allow an attacker to bypass ratelimit controls like Nextcloud bruteforce protection and gain access to the Nextcloud instance.",
    "technicalDescription": "Nextcloud Server is vulnerable to brute force protection and ratelimiting bypass issues because IPv6 subnets are hard-coded to `/128`. End users can use at least a `/64` subnet, meaning an attacker could generate a random address in this range in order to bypass the restrictions.\n\nTo remedy this issue, the vendor has increased the value used by the subnet matcher functionality from `128` to `64`.",
    "publishedDate": "2021-06-14T15:30:57.590Z",
    "updatedDate": "2021-07-02T10:25:32.027Z",
    "disclosureDate": "2021-06-01T00:00:00.000Z",
    "solution": "Fixed in:\n* [**22.0.0-beta1**](https://github.com/nextcloud/server/releases/tag/v22.0.0beta1) by [this](https://github.com/nextcloud/server/commit/2bedbc1793d65be0b688c5131a43c74a9f483012) commit,\n* [**21.0.2-rc1**](https://github.com/nextcloud/server/releases/tag/v21.0.2RC1) by [this](https://github.com/nextcloud/server/commit/87212ab0972fe32c367cb2be90451fb71dde57fd) commit,\n* [**20.0.10-rc1**](https://github.com/nextcloud/server/releases/tag/v20.0.10RC1) by [this](https://github.com/nextcloud/server/commit/e5f30d010dec3f3e4e162c63d5de46b14b71bee4) commit,\n* [**19.0.11-rc1**](https://github.com/nextcloud/server/releases/tag/v19.0.11RC1) by [this](https://github.com/nextcloud/server/commit/248efed7fa52f479b50a0ce926c3c96f73bc6ecb) commit.\n\nThe latest stable releases are available [here](https://nextcloud.com/install/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has suggested [here](https://github.com/nextcloud/security-advisories/security/advisories/GHSA-2967-6mrp-gg3p) that users can disable IPv6 access to their Nextcloud instances in order to avoid this issue.",
    "vendorFixDate": "2021-04-12T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1774",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-307"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22915",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1774/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-2967-6mrp-gg3p",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-2967-6mrp-gg3p",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/248efed7fa52f479b50a0ce926c3c96f73bc6ecb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/2bedbc1793d65be0b688c5131a43c74a9f483012",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/87212ab0972fe32c367cb2be90451fb71dde57fd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/e5f30d010dec3f3e4e162c63d5de46b14b71bee4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/pull/26439",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v19.0.11RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v20.0.10RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v21.0.2RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v22.0.0beta1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1154003",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://nextcloud.com/install/",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1774/default-remediation-status"
            }
        ]
    }
}