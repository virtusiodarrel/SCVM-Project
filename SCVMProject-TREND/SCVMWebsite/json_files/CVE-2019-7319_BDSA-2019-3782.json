{
    "source": "BDSA",
    "name": "BDSA-2019-3782",
    "title": "Cloudera CDH Vulnerable to Incorrect Privilege Assignment via Code Defect",
    "description": "Cloudera CDH is vulnerable to incorrect privilege assignment when using certain authentication backends. This could result in users having privileges not intended by administrators.",
    "technicalDescription": "Cloudera CDH with Hue is vulnerable when using LDAP or SAML authentication.  If either of these backends are in use, and the `create_users_on_login` property is set to true in `hue_safety_valve.ini`, a user that logs on for the first time will be granted superuser privileges. \n\nWhen SAML2Backend is used, users created in this way can create or delete users and groups, assign users to groups, or alter group permissions.\n\nWhen LdapBackend is used, users created in this way can synchronize Hue users with the LDAP server, create local users and groups, assign users to groups or alter group permissions. Note that the users created by these superusers can only log in if the mode of multi-backend authentication is set up as LdapBackend and AllowFirstUserDjangoBackend.\n\nLocal users created as 'hive', 'hdfs' or 'solr' are able to access protected data and alter permissions.",
    "publishedDate": "2019-12-02T15:20:42.121Z",
    "updatedDate": "2020-07-24T09:27:35.481Z",
    "disclosureDate": "2019-11-26T00:00:00.000Z",
    "solution": "Fixed in **6.1.1** and **6.2.0**.\n\nInstallation instructions for the latest version can be found [here](https://www.cloudera.com/downloads.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-02-20T00:00:00.000Z",
    "discoveryDate": "2018-12-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3782",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-266"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-7319",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3782/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.cloudera.com/documentation/other/security-bulletins/topics/Security-Bulletin.html#concept_o2p_hjm_33b",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cloudera.com/downloads.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3782/default-remediation-status"
            }
        ]
    }
}