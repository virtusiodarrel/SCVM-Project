{
    "source": "BDSA",
    "name": "BDSA-2019-4491",
    "title": "Mattermost Vulnerable to Authentication Bypass via Insufficient Sanitization in 'createUser()' Function",
    "description": "Mattermost contains an authentication bypass vulnerability. An attacker can exploit a flaw in the access control mechanism to gain unauthorized access via a specially crafted input at login.",
    "technicalDescription": "This vulnerability is due to the lack of input sanitization in the `createUser()` function of `api4/user.go`. An attacker can take advantage of this by utilizing specially crafted input during the login process in order to bypass the login functionality entirely and gain unauthorized access to the system. \n\nThis was mitigated by the vendor by adding additional input sanitization via the `SanitizeInput()` function, which is defined within the file `model/user.go`.",
    "publishedDate": "2020-07-14T09:11:51.675Z",
    "updatedDate": "2020-07-14T09:11:51.669Z",
    "disclosureDate": "2019-08-27T00:00:00.000Z",
    "solution": "Fixed in [**5.15.0-rc1**](https://github.com/mattermost/mattermost-server/releases/tag/v5.15.0-rc1) by [this](https://github.com/mattermost/mattermost-server/commit/23dc5ed0a7d2c74d2fa1f05dcdf7c37c276886e1) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Roman Shchekin",
    "workaround": "",
    "vendorFixDate": "2019-08-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4491",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20859",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4491/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/commit/23dc5ed0a7d2c74d2fa1f05dcdf7c37c276886e1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/releases/tag/v5.15.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mattermost.com/security-updates/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4491/default-remediation-status"
            }
        ]
    }
}