{
    "source": "BDSA",
    "name": "BDSA-2020-3505",
    "title": "Opencart Vulnerable to Stored Cross-Site Scripting (XSS) via Profile Image Filename",
    "description": "Opencart contains a stored cross-site scripting (XSS) vulnerability. Due to insufficient sanitization of user-supplied input, a privileged attacker could exploit this flaw using a malicious image as a profile picture in the user profile page. The malicious code will then be executed within the victim's browser anytime the profile picture is rendered on the page. Exploiting this flaw could lead to the theft of cookie-based session information or other credentials.",
    "technicalDescription": "This is due to insufficient sanitisation within  the `upload/admin/controller/common/filemanager.php` file. An attacker with admin permissions is able to upload a file with a malicious filename using the profile picture upload functionality. Once uploaded, the script will execute in the 'Image Manager' section.",
    "publishedDate": "2020-11-25T13:44:23.908Z",
    "updatedDate": "2021-11-24T11:39:25.262Z",
    "disclosureDate": "2020-11-24T00:00:00.000Z",
    "exploitPublishDate": "2020-11-24T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "A fix is proposed in [this](https://github.com/ADDCreative/opencart/commit/37595efc72bc35527c679902665de9a36c471766) older repository  which has not yet been merged to the official repository.",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3505",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-29471",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3505/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ADDCreative/opencart/commit/37595efc72bc35527c679902665de9a36c471766",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencart/opencart/issues/7810",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencart/opencart/issues/7810",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/49098",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/49098",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3505/default-remediation-status"
            }
        ]
    }
}