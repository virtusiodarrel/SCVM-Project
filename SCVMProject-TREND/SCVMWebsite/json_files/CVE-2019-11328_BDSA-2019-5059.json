{
    "source": "BDSA",
    "name": "BDSA-2019-5059",
    "title": "Singularity Vulnerable to Privilege Escalation via 'Instance' File Manipulation",
    "description": "Singularity on Linux kernels supporting namespace requirements for creating and joining instances, is vulnerable to a privilege escalation issue due to how instance files can be edited via an insecure permissions issue.\n\nAn attacker could edit the Singularity instance files to alter the behavior of the `starter-suid` program and gain escalated privileges on the host.",
    "technicalDescription": "Singularity is vulnerable to privilege escalation because files within `/run/singularity/instances/sing/<user>/<instance>` can be edited by users with access to the host system. This issue is present on Linux systems that support namespace requirements (`pid` namespace) for creating and joining instances.\n\nTo remedy this issue, the vendor has made changes to store instance files in user's home directories. Checks have also been added to ensure that these files cannot be altered to change `starter-suid` behavior when instances are joined.",
    "publishedDate": "2021-03-08T16:13:16.617Z",
    "updatedDate": "2021-03-08T16:13:16.608Z",
    "disclosureDate": "2019-05-14T00:00:00.000Z",
    "exploitPublishDate": "2019-05-16T00:00:00.000Z",
    "solution": "Fixed in [**3.2.0**](https://github.com/hpcng/singularity/releases/tag/v3.2.0) by [this](https://github.com/hpcng/singularity/commit/618c9d56802399adb329c23ea2b70598eaff4a31) commit and [this](https://github.com/hpcng/singularity/commit/f9d8461460f5b380a607fcdf9bbef223475111d6) commit.\n\nThe latest stable releases are available [here](https://github.com/hpcng/singularity/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matthias Gerstner",
    "workaround": "The vendor has stated [here](https://github.com/hpcng/singularity/releases/tag/v3.2.0), that if you are unable to upgrade immediately you should disable the suid workflow on your system by setting the following in the `singularity.conf` file: \n* `allow setuid = no `\n\nThe vendor has also made a patch available for **3.1.x** versions [here](https://repo.sylabs.io/security/2019/CVE-2019-11328.diff).",
    "vendorFixDate": "2019-05-14T00:00:00.000Z",
    "vendorNotifiedDate": "2019-04-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5059",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11328",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5059/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/commit/618c9d56802399adb329c23ea2b70598eaff4a31",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/commit/b4dcb0e4d77baa1c7647a4a5705ea824bb4e0dca",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/commit/f9d8461460f5b380a607fcdf9bbef223475111d6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases/tag/v3.2.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases/tag/v3.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases/tag/v3.2.0",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://repo.sylabs.io/security/2019/CVE-2019-11328.diff",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q2/112",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q2/112",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5059/default-remediation-status"
            }
        ]
    }
}