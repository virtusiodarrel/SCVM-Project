{
    "source": "BDSA",
    "name": "BDSA-2019-3185",
    "title": "WebKitGTK Vulnerable to Same-Origin Policy Bypass via Race Condition in 'FrameLoader::clear()' Function",
    "description": "WebKit GTK is vulnerable to the bypassing of same-origin policy due to a race condition that exists during the document loading process. A remote attacker could partially leak the contents of a document that is loaded by a victim's browser by tricking them into loading maliciously crafted web content.",
    "technicalDescription": "The function `FrameLoader::clear()` is called by WebKit GTK whenever new documents are being loaded. One of the tasks performed by this function is to update the active global object of the page by calling the function `setDOMWindow()`. The global object is used to determine the context, in terms of origin, that JavaScript code will be executed within. \n\nUnder certain conditions, the execution flow that occurs during document loading can be influenced by an attacker to ensure that the `setDOMWindow()` function is not called. They can do so by tricking the victim into loading crafted web content, which will cause the `readystatechanged` event handler to fire. If this happens, the `m_needsClear` variable within `FrameLoader::clear()` can be set to `false`. If this is the case, an `if` statement within `FrameLoader::clear()` will trigger a `return` event before `setDOMWindow` can be evaluated. The new document will therefore use the same global object that was being used by the attacker controlled resource. The attacker can potentially leverage this to leak the contents of the new document.",
    "publishedDate": "2019-10-14T09:27:01.261Z",
    "updatedDate": "2022-07-07T14:15:42.943Z",
    "disclosureDate": "2019-10-08T00:00:00.000Z",
    "exploitPublishDate": "2019-10-08T00:00:00.000Z",
    "solution": "Fixed in version [**2.24.4**](https://webkitgtk.org/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sergei Glazunov of Google Project Zero",
    "workaround": "",
    "vendorFixDate": "2019-08-27T00:00:00.000Z",
    "vendorNotifiedDate": "2019-07-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3185",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-8763",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3185/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1902",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1902",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://webkitgtk.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3185/default-remediation-status"
            }
        ]
    }
}