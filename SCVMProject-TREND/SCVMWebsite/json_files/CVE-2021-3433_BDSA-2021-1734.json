{
    "source": "BDSA",
    "name": "BDSA-2021-1734",
    "title": "Zephyr OS Bluetooth LE Controller Vulnerable to Connection Disablement via  Invalid CONNECT_IND",
    "description": "Synopsys Cybersecurity Research Center (CyRC) has discovered that Zephyr's Bluetooth Low Energy Controller (LE Link Layer) is vulnerable to partial denial-of-service (DoS) caused by insufficient error handling in the code. An attacker can trigger this vulnerability by sending an invalid interval value in a CONNECT_IND packet, rending the device unable to connect until the target device is rebooted and returned to normal state.\n\nTriggering this vulnerability does not require authentication or encryption. The only requirement is that the device is in advertising mode and accepting connections, and that the attacker is within range of the Bluetooth device.",
    "technicalDescription": "This vulnerability occurs in `ull_slave_setup()` function in`ull_slave.c` where error handling is incomplete. A previous vulnerability fix in the code, addressing the detection of an invalid channel map value of  0x0000 in CONNECT_IND connection request, was found to be insufficient. \n\nOnce the connection request was rejected, the error handling did not restart the device in advertising mode,  rendering it unable to connect to other devices until it is rebooted to allow the device to re-establish normal BLE communication.\n\nAn attacker is able to trigger this vulnerability by sending an invalid channel map value in CONNECT_IND packet to any Zephyr based Bluetooth LE device which is advertising and open to connection.",
    "publishedDate": "2021-06-22T14:56:12.337Z",
    "updatedDate": "2022-08-03T14:40:51.832Z",
    "disclosureDate": "2021-06-11T00:00:00.000Z",
    "solution": "Fixed in [**2.6.0-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.6.0-rc1) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/4e7985e9d8e4f64b80fb58065e629f3274a8b644) commit.\nInstructions for manual backport of fix to [**1.14-branch**](https://github.com/zephyrproject-rtos/zephyr/tree/v1.14-branch) can be found [here](https://github.com/zephyrproject-rtos/zephyr/pull/33278).\nFix backported to [**2.5-branch**](https://github.com/zephyrproject-rtos/zephyr/tree/v2.5-branch) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/d87cc6f51aa809ed12d8e5df41677dee92605726) commit.\n\nThe most recent release can be found [here](https://www.zephyrproject.org/developer-resources/#current-release).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:A/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matias Karhumaa  (Synopsys Cybersecurity Research Center   (CyRC))",
    "workaround": "",
    "vendorFixDate": "2021-03-06T00:00:00.000Z",
    "discoveryDate": "2021-02-02T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1734",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-369"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3433",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1734/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/4a5f263e5a658bb35c1dd9215fe62939f175c859",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/4e7985e9d8e4f64b80fb58065e629f3274a8b644",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/94d5f0854e491e594c2040fe0f061850848081fc",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/d87cc6f51aa809ed12d8e5df41677dee92605726",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/pull/33278",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.6.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/policy",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v1.14-branch",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v2.5-branch",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synopsys.com/blogs/software-security/cyrc-advisory-zephyr-vulnerability/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.zephyrproject.org/developer-resources/#current",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.zephyrproject.org/developer-resources/#current-release",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-135",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1734/default-remediation-status"
            }
        ]
    }
}