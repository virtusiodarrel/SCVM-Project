{
    "source": "BDSA",
    "name": "BDSA-2019-3921",
    "title": "GitLab Vulnerable to Email Verification Bypass via Salesforce Login Integration Functionality",
    "description": "GitLab is vulnerable to the bypassing of email address verification checks due to the unsafe implementation of Salesforce's login functionality. A remote attacker who has access to a valid Salesforce administrator account could bypass GitLab's email domain restriction functionality by crafting an email address.",
    "technicalDescription": "GitLab has integrated Salesforce login functionality so that a user can log in with their Salesforce account's credentials. GitLab also contains functionality that attempts to restrict the email address domains that are associated with user accounts. However, GitLab fails to implement these checks for Salesforce accounts. The logic that is necessary to enforce these checks are missing from the code contained in a variety of authentication scripts, such as `omniauth_callbacks_controller.rb` and `login_helpers.rb`. This allows any remote attacker with access to a Salesforce admistrator account to bypass GitLab's email domain restrictions by using that account to create a GitLab user with an arbitrary email address.",
    "publishedDate": "2019-12-18T13:11:17.745Z",
    "updatedDate": "2019-12-18T13:11:17.733Z",
    "disclosureDate": "2019-09-30T00:00:00.000Z",
    "exploitPublishDate": "2019-06-18T00:00:00.000Z",
    "solution": "Fixed in:\n* [**12.4.0-rc42**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.4.0-rc42) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/fe4ffa44e42ad2538ffbd275c3764d00404e8576) commit,\n* [**12.3.2**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.3.2) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/8f2372d5bebaf724df96a4dda0f1e37d7ad23bff) commit,\n* [**12.2.6**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.2.6) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/f1de42f52d29e2abf326eaee05246d4173d4c466) commit,\n* [**12.1.12**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.1.12) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/116fb15b456214f63b77c03e4c644c3c5965a7c2) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ngalog",
    "workaround": "",
    "vendorFixDate": "2019-09-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3921",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5486",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3921/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/blog/2019/09/30/security-release-gitlab-12-dot-3-dot-2-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.1.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.2.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.4.0-rc42",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/116fb15b456214f63b77c03e4c644c3c5965a7c2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/8f2372d5bebaf724df96a4dda0f1e37d7ad23bff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/f1de42f52d29e2abf326eaee05246d4173d4c466",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/fe4ffa44e42ad2538ffbd275c3764d00404e8576",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/617896",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/617896",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3921/default-remediation-status"
            }
        ]
    }
}