{
    "source": "BDSA",
    "name": "BDSA-2020-1959",
    "title": "GitLab Vulnerable to Cross-Site Scripting (XSS) via Blob Viewer Functionality",
    "description": "GitLab is vulnerable to cross-site scripting (XSS) due to how the blob viewer handles the rendering of OpenAPI files.\n\nAn attacker could trick a victim user into viewing a crafted OpenAPI file on GitLab in order to perform actions on the victim's behalf or steal session tokens, cookies, or other sensitive information.",
    "technicalDescription": "GitLab is vulnerable to cross-site scripting (XSS) because the `SwaggerUIBundle` module, used to render OpenAPI files in the blob viewer functionality, does not sanitize all potentially malicious tags in an OpenAPI file. \n\n`SwaggerUIBundle` allows HTML tags and attributes to be included in the description of the OpenAPI file in order to apply styling to the content.\n\nAn attacker can manipulate the rendered content and inject scripts using the `class`, `style` and `data-*` attributes, meaning that stored cross-site scripting (XSS) attacks can be triggered when viewing a crafted file by intercepting a user click.\n\nTo remedy this issue, swagger-ui was upgraded to the fixed `3.26.2` version.",
    "publishedDate": "2020-08-06T14:34:53.620Z",
    "updatedDate": "2020-09-30T13:53:22.111Z",
    "disclosureDate": "2020-08-04T00:00:00.000Z",
    "exploitPublishDate": "2020-08-04T00:00:00.000Z",
    "solution": "Fixed in:\n* [**13.1.2**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.1.2) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/11e9b7b58837da351f08c18e6f0f4faba4d7d301) commit,\n* [**13.0.8**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.0.8) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/fea2147c567fe2b1c0a642f1ecc5c5bf49bf859f) commit,\n* [**12.10.13**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.10.13) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/5b4f92ef7a4e402bb59834dfea7aa1b043b78017) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "yvvdwf",
    "workaround": "",
    "vendorFixDate": "2020-07-01T00:00:00.000Z",
    "vendorNotifiedDate": "2020-02-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1959",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13329",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1959/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/11e9b7b58837da351f08c18e6f0f4faba4d7d301",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/5b4f92ef7a4e402bb59834dfea7aa1b043b78017",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/7881eb30eaa8b01dbcfe87faa09927c75c7d6e45",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/fea2147c567fe2b1c0a642f1ecc5c5bf49bf859f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.10.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.0.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.1.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/208685",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/806571",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/806571",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1959/default-remediation-status"
            }
        ]
    }
}