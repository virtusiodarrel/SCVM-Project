{
    "source": "BDSA",
    "name": "BDSA-2020-1860",
    "title": "Kibana Vulnerable to Stored Cross-Site Scripting (XSS) via Region Map Visualization",
    "description": "Kibana is vulnerable to a stored cross-site scripting (XSS) flaw. A remote authenticated attacker could leverage this to run arbitrary JavaScript code on the browsers of other users of the site. This could enable them to steal site information such as cookies, or perform site actions on the behalf of the victim.",
    "technicalDescription": "An authenticated attacker who is able to edit or create a region map visualization could leverage an XSS flaw in that functionality to inject arbitrary HTML and JavaScript code into the browser of other users of the site.",
    "publishedDate": "2020-07-28T09:41:26.276Z",
    "updatedDate": "2020-07-28T09:41:26.270Z",
    "disclosureDate": "2020-07-27T00:00:00.000Z",
    "solution": "Fixed in [**6.8.11**](https://github.com/elastic/kibana/releases/tag/v6.8.11) and [**7.8.1**](https://github.com/elastic/kibana/releases/tag/v7.8.1).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor supplies the following workaround and mitigation advice:\n\n> Users unable to upgrade can set `xpack.maps.enabled: false`, `region_map.enabled: false`, and `tile_map.enabled: false` in kibana.yml to disable map visualizations.\n\n> Users running version 6.7.0 or later have a reduced risk from this XSS vulnerability when Kibana is configured to use the default Content Security Policy with a modern browser. While the CSP prevents XSS, it does not mitigate the underlying HTML injection vulnerability.",
    "vendorFixDate": "2020-07-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1860",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7017",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1860/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.elastic.co/t/elastic-stack-6-8-11-and-7-8-1-security-update/242786",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/releases/tag/v6.8.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/releases/tag/v7.8.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.elastic.co/community/security/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1860/default-remediation-status"
            }
        ]
    }
}