{
    "source": "BDSA",
    "name": "BDSA-2021-4228",
    "title": "Linux Kernel Vulnerable to Memory Corruption via Insufficient Quota File Validation",
    "description": "The Linux kernel is vulnerable to memory corruption due to the insufficient validation of quota file data. A local attacker could cause a vulnerable system to crash by running a maliciously crafted binary on that system. It may also be possible for the attacker to modify, or disclose, data that resides in the kernel.",
    "technicalDescription": "The file `fs/quota/quota_tree.c` contains code that is used to parse quota tree files. This code fails to validate the block numbers that are specified within quota trees that are being processed. Invalid block numbers can lead to heap-based memory corruption issues, such as use-after-free events. An attacker could potentially leverage this issue in order to corrupt kernel memory. This could allow the attacker to crash a vulnerable system, or potentially to extract or modify data that resides in kernel space.",
    "publishedDate": "2022-03-18T15:35:46.146Z",
    "updatedDate": "2022-03-18T15:35:46.131Z",
    "disclosureDate": "2021-10-09T00:00:00.000Z",
    "exploitPublishDate": "2021-10-09T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.293**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7a40f3e53f5de1d6876df8a9e8025b50616b8818) commit\n* [**4.9.291**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f7dd331a896700728492e02c20a69e53221cd7a4) commit\n* [**4.14.256**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1d0606dc3e27e6c281a2684cb8bdf47134051114) commit\n* [**4.19.218**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e5222c87dc441dcc8a66e93cb3fd34dfff03d3ec) commit\n* [**5.4.160**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=10b808307d37d09b132fc086002bc1aa9910d315) commit\n* [**5.10.80**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ceeb0a8a8716a1c72af3fa4d4f98c3aced32b037) commit\n* [**5.14.19**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b2d7d18457990ad15ee9f9f40da538fa58dae6b5) commit\n* [**5.15.3**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=332db0909293f3f4d853ee2ea695272c75082d87) commit\n* [**5.16-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9bf3d20331295b1ecb81f4ed9ef358c51699a050) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.6,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-10-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-4228",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-229"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-45868",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-4228/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.kernel.org/show_bug.cgi?id=214655",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.kernel.org/show_bug.cgi?id=214655",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=10b808307d37d09b132fc086002bc1aa9910d315",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1d0606dc3e27e6c281a2684cb8bdf47134051114",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=332db0909293f3f4d853ee2ea695272c75082d87",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7a40f3e53f5de1d6876df8a9e8025b50616b8818",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9bf3d20331295b1ecb81f4ed9ef358c51699a050",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b2d7d18457990ad15ee9f9f40da538fa58dae6b5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ceeb0a8a8716a1c72af3fa4d4f98c3aced32b037",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e5222c87dc441dcc8a66e93cb3fd34dfff03d3ec",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f7dd331a896700728492e02c20a69e53221cd7a4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}