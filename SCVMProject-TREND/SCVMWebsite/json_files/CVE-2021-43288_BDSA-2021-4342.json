{
    "source": "BDSA",
    "name": "BDSA-2021-4342",
    "title": "GoCD Vulnerable to Stored Cross-Site Scripting (XSS) via Insufficient Job Report Validation",
    "description": "GoCD is vulnerable to cross-site scripting (XSS) due to the improper validation of client-provided input. An attacker could inject malicious JavaScript into a failed job report, which will then be executed within the browser of a victim who views the report.",
    "technicalDescription": "The GoCD job status page contains an artifacts list, which documents files and folders which reside on the server. The HTML list elements are generated dynamically using the names of the artifacts, which are retrieved in the `htmlBody()` method, of file `common/src/main/java/com/thoughtworks/go/domain/FileDirectoryEntry.java`. The names of the artifacts are not sanitized prior to their inclusion in the dynamically generated web content. An attacker could use maliciously crafted artifact names in order to inject malicious scripts into the job status page. This could potentially allow the attacker to extract sensitive information from a victim's browser, such as session cookies.",
    "publishedDate": "2022-04-19T15:49:46.331Z",
    "updatedDate": "2022-04-19T15:49:46.316Z",
    "disclosureDate": "2021-11-11T00:00:00.000Z",
    "exploitPublishDate": "2021-11-11T00:00:00.000Z",
    "solution": "Fixed in version [**21.3.0**](https://github.com/gocd/gocd/releases/tag/21.3.0) by [this](https://github.com/gocd/gocd/commit/f5c1d2aa9ab302a97898a6e4b16218e64fe8e9e4) commit.\n\nThe latest stable releases can be found [here](https://github.com/gocd/gocd/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "SonarSource R&D Team",
    "workaround": "",
    "vendorFixDate": "2021-10-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4342",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43288",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4342/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.sonarsource.com/gocd-vulnerability-chain",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://blog.sonarsource.com/gocd-vulnerability-chain/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gocd/gocd/commit/f5c1d2aa9ab302a97898a6e4b16218e64fe8e9e4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gocd/gocd/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gocd/gocd/releases/tag/21.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4342/default-remediation-status"
            }
        ]
    }
}