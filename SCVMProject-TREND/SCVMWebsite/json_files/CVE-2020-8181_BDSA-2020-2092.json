{
    "source": "BDSA",
    "name": "BDSA-2020-2092",
    "title": "Nextcloud Contacts Vulnerable to Malicious File Upload via Missing File Type Check",
    "description": "Nextcloud Contacts contains a vulnerability that allows any file to be uploaded as an avatar. A remote attacker could upload malicious files in order to to execute arbitrary code on a vulnerable server.",
    "technicalDescription": "The issue exists in the `src/components/ContactDetails/ContactDetailsAvatar.vue` file. An attacker could exploit this by uploading a crafted SVG file as an avatar that contains executable code.\n\nThis vulnerability occurs because Nextcloud Server allows dangerous files to be uploaded, while Nextcloud Contacts fails to sanitize SVG files.\n\nFixed in Nextcloud Contacts by using [this](https://github.com/mattkrick/sanitize-svg) `sanitize svg` script.",
    "publishedDate": "2020-08-19T14:02:32.506Z",
    "updatedDate": "2020-10-05T14:49:49.620Z",
    "disclosureDate": "2020-07-08T00:00:00.000Z",
    "exploitPublishDate": "2020-07-08T00:00:00.000Z",
    "solution": "Fixed in Nextcloud Contacts version [**3.3.0**](https://github.com/nextcloud/contacts/releases/tag/v3.3.0) by [this](https://github.com/nextcloud/contacts/commit/1d9d5bf5dfa6b1c7090786c47f3c045b786e9d69) commit and [this](https://github.com/nextcloud/contacts/commit/d0707e3b2b78b3a2a4e239108a72b3def7b0a37e) commit.\n\nFixed in Nextcloud Server version  [**19.0.0rc1**](https://github.com/nextcloud/server/releases/tag/v19.0.0RC1) by the following commits:\n* (https://github.com/nextcloud/server/commit/2e9f105786e99ac163ec3dcb3a6b89f0c2261097) \n* (https://github.com/nextcloud/server/commit/bb754cb363ef4a7b5f0fd4a8a9c9baf1c699b571) \n* (https://github.com/nextcloud/server/commit/648c8df51645147f99fd687511003062ae01978c) \n* (https://github.com/nextcloud/server/commit/fe4527a8e2275de51ea86715931e4df254b4fe23)",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tommy Suriel",
    "workaround": "",
    "vendorFixDate": "2020-03-12T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2092",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8181",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2092/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattkrick/sanitize-svg",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/contacts/commit/1d9d5bf5dfa6b1c7090786c47f3c045b786e9d69",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/contacts/commit/d0707e3b2b78b3a2a4e239108a72b3def7b0a37",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/contacts/releases/tag/v3.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/2e9f105786e99ac163ec3dcb3a6b89f0c2261097",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/648c8df51645147f99fd687511003062ae01978c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/bb754cb363ef4a7b5f0fd4a8a9c9baf1c699b571",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/fe4527a8e2275de51ea86715931e4df254b4fe23",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v19.0.0RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/808287",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://nextcloud.com/security/advisory/?id=NC-SA-2020-024",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2092/default-remediation-status"
            }
        ]
    }
}