{
    "source": "BDSA",
    "name": "BDSA-2020-3790",
    "title": "Icinga 2 Vulnerable to Certificate Revocation Bypass via Automatic Renewal",
    "description": "Icinga 2 is vulnerable to certificate revocation bypass due to improper processing of certificate revocation lists (CRLs). This could allow an attacker to successfully establish a connection with a certificate that should have been revoked.\n\n**Note:** Per the vendor this issue only affects configurations that utilize external certificate signing and revoked certificates that expire in less then 30 days.",
    "technicalDescription": "This issue occurs if a CRL has been specified in the configuration of the `ApiListener`. This is because this configuration is only used by Icinga upon establishing connections and not when a certificate is requested. Therefore a node can automatically renew a revoked certificate so long as it meets the other requirements needed for auto renewal. The requirements that need to be met are that the certificate expires in less than 30 days,  or it has been issue before 2017. \n\nIt was mitigated by ensuring that when CRL's are loaded it's certificates are appended to the specified **OpenSSL X509** store and by checking a certificate against the CRL list whilst verifying it against a Certificate Authority.",
    "publishedDate": "2020-12-16T16:38:09.898Z",
    "updatedDate": "2020-12-16T16:38:09.893Z",
    "disclosureDate": "2020-12-15T00:00:00.000Z",
    "solution": "Fixed in [**2.12.3**](https://github.com/Icinga/icinga2/releases/tag/v2.12.3) by [this](https://github.com/Icinga/icinga2/commit/2cb995e93714ab82914e8cace050749ba6359213) commit.\nFixed in [**2.11.8**](https://github.com/Icinga/icinga2/releases/tag/v2.11.8) by [this](https://github.com/Icinga/icinga2/commit/1cf1e3f6ab9d20b7e0ccaf7202918a13f72ab2a2) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-12-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3790",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-299"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-29663",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3790/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/1cf1e3f6ab9d20b7e0ccaf7202918a13f72ab2a2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/2cb995e93714ab82914e8cace050749ba6359213",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/releases/tag/v2.11.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/releases/tag/v2.12.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/security/advisories/GHSA-pcmr-2p2f-r7j6",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3790/default-remediation-status"
            }
        ]
    }
}