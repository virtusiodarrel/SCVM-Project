{
    "source": "BDSA",
    "name": "BDSA-2019-0324",
    "title": "ImageMagick Vulnerable to Denial-of-Service (DoS) via Memory Leaks in 'WritePDFImage' Function",
    "description": "ImageMagick is vulnerable to denial- of-service (DoS) as it fails to sufficiently track and release memory during PDFImage parsing. An attacker could leverage this flaw by supplying a crafted image to an application that makes use of ImageMagick or by tricking a user into doing so. Parsing malformed images can lead to excessive memory allocation and a crash.",
    "technicalDescription": "The flaws lie in the `WritePDFImage()` function of the `coders/pdf.c` source file. The vulnerable function does not sufficiently track the usage of the `xref` variable. Whenever the function returns with `MagickFalse` (which is possible via multiple execution branches), `xref` is not passed to any caller function or released. These memory leaks can be leveraged by an attacker to allocate excessive amounts of memory which may degrade the performance of the underlying host or cause application crash.",
    "publishedDate": "2019-02-05T16:36:24.832Z",
    "updatedDate": "2019-05-13T13:46:32.625Z",
    "disclosureDate": "2019-01-17T00:00:00.000Z",
    "solution": "Fixed in [**6.9.10-25**](https://github.com/ImageMagick/ImageMagick6/releases/tag/6.9.10-25) by [this](https://github.com/ImageMagick/ImageMagick6/commit/3b28c8d93aa469f6d90c8b3c05fe3d88c2584e32) commit.\n\nFixed in [**7.0.8-25**](https://github.com/ImageMagick/ImageMagick/releases/tag/7.0.8-25) by [this](https://github.com/ImageMagick/ImageMagick/commit/306c1f0fa5754ca78efd16ab752f0e981d4f6b82) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Bingchang Liu at VARAS of IIE",
    "workaround": "",
    "vendorFixDate": "2019-01-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0324",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-401"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-7397",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0324/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick/commit/306c1f0fa5754ca78efd16ab752f0e981d4f6b82",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick/issues/1454",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick/releases/tag/7.0.8-25",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick6/commit/3b28c8d93aa469f6d90c8b3c05fe3d88c2584e32",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick6/releases/tag/6.9.10-25",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0324/default-remediation-status"
            }
        ]
    }
}