{
    "source": "BDSA",
    "name": "BDSA-2018-4217",
    "title": "Perl Vulnerable to Remote Code Execution via Heap-based Buffer Overflow in 'S_regatom' Function",
    "description": "Perl is vulnerable to arbitrary code execution because it may incorrectly increment a parse pointer during compilation when handling crafted regular expressions. An attacker can leverage this flaw by passing a malicious string to the Perl compiler. The attack also requires knowledge of certain dynamic memory addresses making it very difficult to implement. An attacker would need a way of getting the addresses (possibly via a memory leak) and then retrieving them from the target host.",
    "technicalDescription": "This flaw lies in the `regcomp.c` source file which incorrectly increments the `RExC_parse` pointer. This can make a certain execution branch to position the pointer a single byte too far triggering a chain of problems. Subsequently a backslash will be skipped during pass 2 and cause the `]` character to be interpreted as a metacharacter instead of a literal. Ultimately this leads to an arbitrary write to the heap and may allow an attacker to inject arbitrary shellcode into the memory.\n\nIn order to execute the injected code the attacker would have to:\n* craft the payload to call `Perl_eval_sv` with crafted `sv_u.svu_pv('system sh')` instead of calling the shellcode on the heap to bypass the NX (no-execution) memory protection, and\n* somehow retrieve the exact address of the overwritten heap.\n\nThis scenario is quite unlikely. A local malicious user would be best positioned to exploit this flaw however this wouldn't yield any additional benefits since they can already execute commands on the system.",
    "publishedDate": "2018-12-05T16:21:48.776Z",
    "updatedDate": "2022-05-20T15:54:30.224Z",
    "disclosureDate": "2018-11-29T00:00:00.000Z",
    "exploitPublishDate": "2018-11-29T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.26.3-RC1**](https://www.perl.org/get.html) by [this](https://perl5.git.perl.org/perl.git/commit/5dfd9842f2802803604cf517016d4d0518226006) commit,\n* [**5.28.1-RC1**](https://www.perl.org/get.html) by [this](https://perl5.git.perl.org/perl.git/commit/9b0464aa670d0a59bda5b75d54f2a6b6f9d1288a) commit, and\n* [**5.29.6**](https://www.perl.org/get.html) by [this](https://perl5.git.perl.org/perl.git/commit/4db502b8711307951dfadc62a8f2c2eda922ca22) commit.\n\nNOTE: According to the vendor the bug is not a security concern from version **5.29.4** onwards, after a separate \"[sizing pass removal](https://www.nntp.perl.org/group/perl.perl5.porters/2018/10/msg252576.html)\" patch in [this](https://perl5.git.perl.org/perl.git/commit/7c932d07cab18751bfc7515b4320436273a459e2) commit. It should (in theory) remove this entire class of errors. However, customers are advised to upgrade to one of the fixed maintenance releases.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Eiichi Tsukata",
    "workaround": "",
    "vendorFixDate": "2018-11-05T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4217",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-18312",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4217/ranges"
            },
            {
                "rel": "reference",
                "href": "https://metacpan.org/pod/release/SHAY/perl-5.28.1-RC1/pod/perldelta.pod",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://perl5.git.perl.org/perl.git/commit/4db502b8711307951dfadc62a8f2c2eda922ca22",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://perl5.git.perl.org/perl.git/commit/5dfd9842f2802803604cf517016d4d0518226006",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://perl5.git.perl.org/perl.git/commit/7c932d07cab18751bfc7515b4320436273a459e2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://perl5.git.perl.org/perl.git/commit/9b0464aa670d0a59bda5b75d54f2a6b6f9d1288a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://rt.perl.org/Public/Bug/Display.html?id=133423",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.nntp.perl.org/group/perl.perl5.porters/2018/10/msg252576.html",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.perl.org/get.html",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}