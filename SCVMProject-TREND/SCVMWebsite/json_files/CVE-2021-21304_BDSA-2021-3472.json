{
    "source": "BDSA",
    "name": "BDSA-2021-3472",
    "title": "Dynamoose Vulnerable to Prototype Pollution via 'set' Utility Method",
    "description": "Dynamoose is vulnerable to prototype pollution due to insufficient validation being performed in its `set` method. An attacker that is able to control the input to this method could leverage this issue in order to modify the prototypes of objects in memory. The exact impact that the attacker can achieve will depend on how the object is used, but can potentially include cross-site scripting (XSS) and remote code execution (RCE).",
    "technicalDescription": "The `set` utility within Dynamoose is implemented using code that is contained in the file `lib/utils/object/set.ts`. This code modifies the properties of the object that is denoted by the `objectRef` variable. The exact property that will be modified is obtained from the `keyParts` variable. The value that this property will be set to is denoted by the `value` variable. The property that is to be modified is not validated. An attacker than can control the input to this method could potentially modify the `__proto__` or `constructor` properties of an object in order to perform a prototype pollution attack. The exact impact that the attacker can achieve will depend on how the object is used, but can potentially include XSS and RCE.\n\nThe vulnerability was fixed via the addition of code which ensures that the property to be modified is not `__proto__` or `constructor`.",
    "publishedDate": "2021-11-16T16:53:09.629Z",
    "updatedDate": "2022-02-10T11:46:31.774Z",
    "disclosureDate": "2021-02-06T00:00:00.000Z",
    "solution": "Fixed in version [**2.7.0**](https://github.com/dynamoose/dynamoose/releases/tag/v2.7.0) by [this](https://github.com/dynamoose/dynamoose/commit/324c62b4709204955931a187362f8999805b1d8e) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/dynamoose).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "GitHub CodeQL Code Scanning",
    "workaround": "",
    "vendorFixDate": "2021-02-06T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3472",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-915"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21304",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3472/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dynamoose/dynamoose/commit/324c62b4709204955931a187362f8999805b1d8e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dynamoose/dynamoose/releases/tag/v2.7.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/dynamoose/dynamoose/security/advisories/GHSA-rrqm-p222-8ph2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/dynamoose",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3472/default-remediation-status"
            }
        ]
    }
}