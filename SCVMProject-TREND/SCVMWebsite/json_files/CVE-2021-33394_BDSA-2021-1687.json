{
    "source": "BDSA",
    "name": "BDSA-2021-1687",
    "title": "CubeCart Vulnerable to Session Fixation via Improper Session Cookie Handling",
    "description": "CubeCart contains a session fixation vulnerability. An attacker could exploit this by creating a new session value and injecting it to the victim's login so that when the victim logs in as normal the session value is validated and the attacker now has access to the user's account.",
    "technicalDescription": "This issue occurs in the `classes/admin.class.php`, `classes/session.class.php`, and `classes/user.class.php` files due to a failure to generate new session cookies for each session. It was mitigated by the introduction of `regenerateSessionId()` which should ensure that the `sessionId` is regenerated for each new session.",
    "publishedDate": "2021-06-07T11:39:49.872Z",
    "updatedDate": "2021-08-25T13:27:41.995Z",
    "disclosureDate": "2021-05-20T00:00:00.000Z",
    "exploitPublishDate": "2021-05-20T00:00:00.000Z",
    "solution": "Fixed in [**6.4.3**](https://github.com/cubecart/v6/releases/tag/v6.4.3) by [this](https://github.com/cubecart/v6/commit/aac7b3a13a43e302d91f94a120417b2fda737d0f) commit.\n\nThe latest stable releases are available [here](https://github.com/cubecart/v6/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rafal Lykowski & Piyush Patil",
    "workaround": "",
    "vendorFixDate": "2021-05-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1687",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-384"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33394",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1687/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cubecart/v6/commit/aac7b3a13a43e302d91f94a120417b2fda737d0f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cubecart/v6/issues/2870",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cubecart/v6/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cubecart/v6/releases/tag/v6.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xoffense/POC/blob/main/Session%20Fixation%20in%20Cubecart%206.4.2.md",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1687/default-remediation-status"
            }
        ]
    }
}