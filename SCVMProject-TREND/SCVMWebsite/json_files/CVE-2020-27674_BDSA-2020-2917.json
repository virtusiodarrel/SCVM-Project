{
    "source": "BDSA",
    "name": "BDSA-2020-2917",
    "title": "Xen Vulnerable to Privilege Escalation via Stale TLB Entries",
    "description": "Xen is vulnerable to privilege escalation.  This vulnerability allows an attacker with a guest machine to modify address mappings, which could potentially be used as memory for a privileged process.",
    "technicalDescription": "The privilege escalation vulnerability is due to how x86 paravirtulized Xen guests handle hypercalls similarly to `INVLPG` to invalidate TLB entries even after changes to non-leaf page tables. This can cause stale TLB entries, which are not sufficiently invalidated.  This allows subsequent guest requests to change address mappings for one process to potentially modify memory used by a privileged process.\n\n\nThe vulnerability is exposed to x86 PV guests only.  x86 HVM/PVH guests as well as ARM ones are not vulnerable.",
    "publishedDate": "2020-10-22T09:15:01.751Z",
    "updatedDate": "2021-04-15T10:52:26.536Z",
    "disclosureDate": "2020-10-20T00:00:00.000Z",
    "solution": "Fixed in:\n\n* [**4.12.4**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b1d6f37aa5aa9f3fc5a269b9dd21b7feb7444be0) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=4100d463dbdd95d85fabe387dd5676bed75f65f7) commit.\n* [**4.13.2**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=c10b2931bf63a444e0917115aad348b911caa82e) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=28b78171271dbbce88bbd4cb2de3d828a51fb169) commit.\n* [**4.14.1**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=10bb63c203f42d931fa1fa7dbbae7ce1765cecf2) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=941f69a428cd989144300519e548e346c681a1b3) commit.\n* **remotes/origin/stable-4.10** branch by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=2012db463b8b8e502f69a46dd9f3aa47b31c937f) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=78d903e95efc5b0166b393d289a687c64016e8ef) commit.\n* **remotes/origin/stable-4.11** branch by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1d021db3c8712d25e25f078833baa160c90f260f) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e274c8bdc12eb596e55233040e8b49da27150f31) commit.\n* **master** branch by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=055e1c3a3d95b1e753148369fbc4ba48782dd602) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=16a20963b3209788f2c0d3a3eebb7d92f03f5883) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.2,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:A/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn of Google Project Zero",
    "workaround": "",
    "vendorFixDate": "2020-10-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2917",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-188"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27674",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2917/ranges"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=055e1c3a3d95b1e753148369fbc4ba48782dd602",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=10bb63c203f42d931fa1fa7dbbae7ce1765cecf2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=16a20963b3209788f2c0d3a3eebb7d92f03f5883",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1d021db3c8712d25e25f078833baa160c90f260f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1d021db3c8712d25e25f078833baa160c90f260f)",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=28b78171271dbbce88bbd4cb2de3d828a51fb169",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=4100d463dbdd95d85fabe387dd5676bed75f65f7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=941f69a428cd989144300519e548e346c681a1b3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b1d6f37aa5aa9f3fc5a269b9dd21b7feb7444be0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=c10b2931bf63a444e0917115aad348b911caa82e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e274c8bdc12eb596e55233040e8b49da27150f31",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e274c8bdc12eb596e55233040e8b49da27150f31)",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-286.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/)",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2917/default-remediation-status"
            }
        ]
    }
}