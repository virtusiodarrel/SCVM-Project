{
    "source": "BDSA",
    "name": "BDSA-2014-0081",
    "title": "hapi Vulnerable to Rosetta-Flash JSONP Vulnerability",
    "description": "Hapi is vulnerable to a \"rosetta-flash\" attack which makes it possible for an attacker to bypass the same origin policy and send data between domains. A victim must be tricked into visiting an attacker-controlled site for the vulnerability to be triggered.",
    "technicalDescription": "The `JSONP` format is used to request data from a server residing in a different domain than the client.\n\nRosetta Flash is a vulnerability which affects servers with a vulnerable `JSONP` endpoint. This is achieved by tricking Adobe Flash Player into believing that an attacker-specified Flash applet originated on the vulnerable server. The applet can then send the data it has retrieved back to the attacker. An exploit is available which makes use of an `ActionScript` payload compiled to an `SWF` file made up of alphanumeric characters. This file is then used as the callback parameter of a `JSONP` call.  \n\nThis is a form of cross-site request forgery (*CSRF*) bypassing the same origin policy.",
    "publishedDate": "2018-06-06T12:31:56.314Z",
    "updatedDate": "2020-04-19T12:42:58.219Z",
    "disclosureDate": "2014-07-08T00:00:00.000Z",
    "exploitPublishDate": "2014-07-08T00:00:00.000Z",
    "solution": "Fixed in [**6.1.0**](https://github.com/hapijs/hapi/releases/tag/v6.2.0) by [this](https://github.com/hapijs/hapi/pull/1766/commits/94c6f0f223c3c2c915ba80adec58b153f435b2d1) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Michele Spagnuolo",
    "workaround": "",
    "vendorFixDate": "2014-07-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2014-0081",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2014-4671",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2014-0081/ranges"
            },
            {
                "rel": "reference",
                "href": "http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hapijs/hapi/pull/1766/commits/94c6f0f223c3c2c915ba80adec58b153f435b2d1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hapijs/hapi/releases/tag/v6.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spumko/hapi/pull/1766",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://nodesecurity.io/advisories/12",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://npmjs.org/package/hapi",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2014-0081/default-remediation-status"
            }
        ]
    }
}