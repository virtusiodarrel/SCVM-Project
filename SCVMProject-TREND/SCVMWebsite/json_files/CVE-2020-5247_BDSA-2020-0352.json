{
    "source": "BDSA",
    "name": "BDSA-2020-0352",
    "title": "Puma RubyGem Vulnerable to HTTP Response Splitting via Specially Crafted Response Header With Newline Characters",
    "description": "The Puma RubyGem is vulnerable to HTTP response splitting. This attack vector could allow cross-site scripting (XSS) and other problems in downstream components.",
    "technicalDescription": "Puma does not reject headers with newline embedded characters. This can lead to HTTP response splitting whereby an attacker could end the header and inject malicious content, such as additional headers or an entirely new response body. This could allow for attacks such as XSS.\n\nThe original fix in **3.12.3** and **4.3.2** was found to be incomplete and an additional fix was applied to versions **3.12.4** and **4.3.3**.",
    "publishedDate": "2020-03-03T09:57:31.947Z",
    "updatedDate": "2022-06-06T14:09:27.360Z",
    "disclosureDate": "2020-02-27T00:00:00.000Z",
    "solution": "Fixed in [**3.12.4**](https://github.com/puma/puma/releases/tag/v3.12.4) by [this](https://github.com/puma/puma/commit/e79a5b28f618fa04b7060c87f0da34d299462416) commit and [**4.3.3**](https://github.com/puma/puma/releases/tag/v4.3.3) by [this](https://github.com/puma/puma/commit/45b4cc94cf87bd5be14bd0452fc2421457cf7a0a) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 3.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor supplies the following workaround:\n\n> Add a Rack middleware to your application which accomplishes the same header check:\n> \n> ```\n> class HTTPResponseSplittingMiddleware\n>   CRLF_REGEX = /[\\r\\n]/.freeze\n> \n>   def initialize(app)\n>     @app = app\n>   end\n> \n>   def call(env)\n>     status, headers, body = @app.call(env)\n>     headers.reject! { |_k, v| CRLF_REGEX =~ v.to_s }\n>     [status, headers, body]\n>   end\n> end\n> ```",
    "vendorFixDate": "2020-02-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0352",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-113"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5247",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0352/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/puma/puma/commit/45b4cc94cf87bd5be14bd0452fc2421457cf7a0a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/puma/puma/commit/e79a5b28f618fa04b7060c87f0da34d299462416",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/puma/puma/releases/tag/v3.12.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/puma/puma/releases/tag/v4.3.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/puma/puma/security/advisories/GHSA-84j7-475p-hp8v",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/puma/puma/security/advisories/GHSA-84j7-475p-hp8v",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0352/default-remediation-status"
            }
        ]
    }
}