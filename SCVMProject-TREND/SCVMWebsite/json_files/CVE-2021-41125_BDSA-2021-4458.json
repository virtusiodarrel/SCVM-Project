{
    "source": "BDSA",
    "name": "BDSA-2021-4458",
    "title": "Scrapy Vulnerable to Information Disclosure via HTTP Credentials Leak in 'HttpAuthMiddleware'",
    "description": "Scrapy contains an information disclosure vulnerability. An attacker could exploit this issue by setting a specified request target, which would result in Scrapy disclosing HTTP authentication information and user credentials to the defined target.",
    "technicalDescription": "This issue occurs when `HttpAuthMiddleware` is being used for HTTP Authentication. A user's credentials are exposed to the request target when requests are made via the middleware. This also includes requests made through redirects or automatic requests from scripts or bots.\n\nMitigation for this issue came in the form of the introduction of the `http_auth_domain` spider attribute which controls which domains are allowed to receive the configured HTTP authentication credentials.",
    "publishedDate": "2022-06-21T11:18:36.519Z",
    "updatedDate": "2022-06-21T11:18:36.505Z",
    "disclosureDate": "2021-10-06T00:00:00.000Z",
    "solution": "Fixed in version [**1.8.1**](https://github.com/scrapy/scrapy/releases/tag/1.8.1) by [this](https://github.com/scrapy/scrapy/commit/b01d69a1bf48060daec8f751368622352d8b85a6) commit.\n\nFixed in version [**2.5.1**](https://github.com/scrapy/scrapy/releases/tag/2.5.1) by [this](https://github.com/scrapy/scrapy/commit/a1728449712c8df68ad636a7abb9e715a13e1bd0) commit.\n\nThe latest stable releases can be found [here](https://github.com/scrapy/scrapy/tags).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Gallaecio",
    "workaround": "Per the Vendor,\n\n> If you cannot upgrade, set your HTTP authentication credentials on a per-request basis, using for example the `w3lib.http.basic_auth_header` function to convert your credentials into a value that you can assign to the Authorization header of your request, instead of defining your credentials globally using `HttpAuthMiddleware`.",
    "vendorFixDate": "2021-10-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4458",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41125",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4458/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/scrapy/scrapy/commit/a1728449712c8df68ad636a7abb9e715a13e1bd0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/scrapy/scrapy/commit/b01d69a1bf48060daec8f751368622352d8b85a6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/scrapy/scrapy/releases/tag/1.8.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/scrapy/scrapy/releases/tag/2.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/scrapy/scrapy/security/advisories/GHSA-jwqp-28gf-p498",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/scrapy/scrapy/security/advisories/GHSA-jwqp-28gf-p498",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/scrapy/scrapy/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4458/default-remediation-status"
            }
        ]
    }
}