{
    "source": "BDSA",
    "name": "BDSA-2021-1125",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via Race Condition in 'sctp_destroy_sock()' Function",
    "description": "The Linux kernel is vulnerable to privilege escalation due to a race condition that exists in the SCTP socket handling code. A local attacker could leverage this race condition to achieve root privileges.",
    "technicalDescription": "The SCTP socket handling functionality within the Linux kernel manages a linked list, `auto_asconf_splist`. The `sock_net(sk)->sctp.addr_wq_lock` lock is used to manage access to this linked list. Elements should only be added to, or removed from, this list if the lock is held. However, it is possible for elements to be removed from this list without the correct locking being in place. This can occur if `sp->do_auto_asconf` is true. Such a condition can exist if the function `sctp_accept()` is evaluated with the function `sctp_sock_migrate()` having failed. It can also occur during the evaluation of `inet_create()` or `inet6_create()`, if a SCTP socket cannot be created due to a BPF program having attached to `BPF_CGROUP_INET_SOCK_CREATE`. The unmanaged concurrent access to `auto_asconf_splist` can lead to privilege escalation. A local attacker with network service privileges could exploit this to obtain root privileges. They could also exploit this without having network service privileges, provided there is a BPF program attached to `BPF_CGROUP_INET_SOCK_CREATE`.",
    "publishedDate": "2021-04-23T13:01:53.772Z",
    "updatedDate": "2021-08-23T14:11:22.378Z",
    "disclosureDate": "2021-04-13T00:00:00.000Z",
    "exploitPublishDate": "2021-04-18T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.268**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e2fe67b243806f06e498f69d7c62a2d5497fc15e) commit.\n* [**4.9.268**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a75f80fd4fbdeb62cdc7feb9b2002e4ef12ee3c1) commit.\n* [**4.14.232**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=54b63c76b9bb95fba20cd268086ee448f87208c6) commit.\n* [**4.19.189**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=301084de76eb5bfedddda41ec33e2913e90c99e7) commit.\n* [**5.4.114**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6180d2274b17fc0473fb0764d3417c0bddb99b2e) commit.\n* [**5.10.32**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=5a627026be4a17e5b9db23558cd28e62b2cbc66e) commit.\n* [**5.11.16**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=59b5f3e478dbcb4c384cf0888d6cc9f5cad79f2f) commit.\n* [**5.12-rc8**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b166a20b07382b8bc1dcee2a448715c9c2c81b5b) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-13T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1125",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23133",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1125/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=301084de76eb5bfedddda41ec33e2913e90c99e7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=54b63c76b9bb95fba20cd268086ee448f87208c6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=59b5f3e478dbcb4c384cf0888d6cc9f5cad79f2f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=5a627026be4a17e5b9db23558cd28e62b2cbc66e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6180d2274b17fc0473fb0764d3417c0bddb99b2e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a75f80fd4fbdeb62cdc7feb9b2002e4ef12ee3c1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b166a20b07382b8bc1dcee2a448715c9c2c81b5b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e2fe67b243806f06e498f69d7c62a2d5497fc15e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=61023658760032e97869b07d54be9681d2529e77",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b166a20b07382b8bc1dcee2a448715c9c2c81b5b",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/04/18/2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/04/18/2",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1125/default-remediation-status"
            }
        ]
    }
}