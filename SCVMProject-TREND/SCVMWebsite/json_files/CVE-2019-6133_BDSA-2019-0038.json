{
    "source": "BDSA",
    "name": "BDSA-2019-0038",
    "title": "Polkit Vulnerable to Authentication Bypass via PID Start Time Check",
    "description": "Polkit is vulnerable to authentication bypass. The component fails to clear an authorization decision from the cache. This could allow an authenticated attacker to masquerade as the target's process. If successfully exploited, the attacker could execute actions as the vulnerable user.",
    "technicalDescription": "Polkit uses `auth_admin_keep` to manage authentication for its access policy. After a user successfully authenticates using the administrator password, the authentication decision is stored in the cache for up to five minutes. To authenticate, Polkit requires the `PID` of the client, alongside the start time of the client's PID, which is located in `/proc/$pid/stat`. The start time check is recorded in the `ktime_get_boot_ns()` call and the PID is allocated via `alloc_pid()`. Due to a delay between both calls, an attacker can exploit the `copy_thread_tls()` flaw, which accesses userspace memory when `sys_clone()` is invoked by calling the function when the target user's process is created. If timed correctly, both the attacker and target's process will have the same start time. As a result, the attacker could delay the `alloc_pid()` call until the target's process has died and when the PID assignment has cycled around. If successfully exploited, Polkit will be unable to distinguish the attacker's process from the victim's.",
    "publishedDate": "2019-01-11T14:57:45.414Z",
    "updatedDate": "2019-10-08T15:00:32.593Z",
    "disclosureDate": "2019-01-08T00:00:00.000Z",
    "exploitPublishDate": "2019-01-09T00:00:00.000Z",
    "solution": "Fixed in [**0.116**](https://gitlab.freedesktop.org/polkit/polkit/-/tags/0.116) by [this](https://gitlab.freedesktop.org/polkit/polkit/commit/c898fdf4b1aafaa04f8ada9d73d77c8bb76e2f81) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.8
        },
        "vector": "(AV:L/AC:H/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.4,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn",
    "workaround": "",
    "vendorFixDate": "2019-01-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0038",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-290"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-6133",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0038/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1692",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1692",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/polkit/polkit/-/tags/0.116",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/polkit/polkit/commit/c898fdf4b1aafaa04f8ada9d73d77c8bb76e2f81",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/polkit/polkit/issues/75",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0038/default-remediation-status"
            }
        ]
    }
}