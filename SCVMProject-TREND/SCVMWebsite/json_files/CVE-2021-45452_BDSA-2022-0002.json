{
    "source": "BDSA",
    "name": "BDSA-2022-0002",
    "title": "Django Vulnerable to Path Traversal via Insufficient Filename Validation in Storage Subsystem",
    "description": "Django is vulnerable to path traversal due to the insufficient validation of file names within the storage subsystem. An attacker could potentially write arbitrary data to the file system, or extract sensitive information, by invoking the storage system's functionality with a maliciously crafted file name.",
    "technicalDescription": "The file `django/core/files/storage.py` contains multiple methods that are used to perform operations on the local file system. The `get_available_name()` method can be used to determine if a file already exists on the file system. The `generate_filename()` method is used to produce a filename that can later be used in file saving (or possibly file retrieval) operations. The `_save()` method is used in order to write files to the file system. These methods perform some validation on the user-provided file name in order to prevent directory traversal attacks. However, they fail to detect certain character sequences, such as `\\\\`. An attacker could use a maliciously crafted file name that contains such characters in order to perform path traversal attacks. This could potentially allow the attacker to obtain sensitive information from, or to write data to, the file system.\n\nThe vulnerability was fixed via the addition of more comprehensive validation logic.",
    "publishedDate": "2022-01-05T16:32:44.607Z",
    "updatedDate": "2022-01-05T16:32:44.593Z",
    "disclosureDate": "2022-01-04T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**4.0.1**](https://github.com/django/django/releases/tag/4.0.1) by [this](https://github.com/django/django/commit/e1592e0f26302e79856cc7f2218ae848ae19b0f6) commit.\n* [**3.2.11**](https://github.com/django/django/releases/tag/3.2.11) by [this](https://github.com/django/django/commit/8d2f7cff76200cbd2337b2cf1707e383eb1fb54b) commit.\n* [**2.2.26**](https://github.com/django/django/releases/tag/2.2.26) by [this](https://github.com/django/django/commit/4cb35b384ceef52123fc66411a73c36a706825e1) commit.\n\nThe latest stable releases can be found [here](https://www.djangoproject.com/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dennis Brinkrolf",
    "workaround": "",
    "vendorFixDate": "2022-01-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0002",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-45452",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0002/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/4cb35b384ceef52123fc66411a73c36a706825e1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/8d2f7cff76200cbd2337b2cf1707e383eb1fb54b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/e1592e0f26302e79856cc7f2218ae848ae19b0f6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/2.2.26",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/3.2.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/4.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/weblog/2022/jan/04/security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0002/default-remediation-status"
            }
        ]
    }
}