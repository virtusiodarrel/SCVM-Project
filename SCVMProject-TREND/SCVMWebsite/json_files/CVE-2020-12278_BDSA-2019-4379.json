{
    "source": "BDSA",
    "name": "BDSA-2019-4379",
    "title": "libgit2 Vulnerable to Arbitrary File Overwrite leading to Remote Code Execution (RCE) via NTFS Alternate Data Streams",
    "description": "libgit2 contains an arbitrary file overwrite vulnerability which could lead to remote code execution (RCE) due to use of New Technology File System (NTFS) Alternate Data Streams. This could allow an attacker to overwrite files in a repository's directory during a clone, which could lead to the execution of arbitrary code.",
    "technicalDescription": "The `verify_dotgit_ntfs` and `only_spaces_and_dots` functions in `src/path.c` could allow an attacker to use NTFS Alternate Data Stream attacks to overwrite files in a git repository through a `.git` directory or through `.gitmodules`. This could lead to remote code execution during cloning of a repository.",
    "publishedDate": "2020-04-28T15:45:38.347Z",
    "updatedDate": "2021-08-03T14:22:23.611Z",
    "disclosureDate": "2019-09-18T00:00:00.000Z",
    "solution": "Fixed in versions:\n* **[v0.27.10](https://github.com/libgit2/libgit2/releases/tag/v0.27.10)** by [this](https://github.com/libgit2/libgit2/commit/3595e237c) commit and [this](https://github.com/libgit2/libgit2/commit/4bae85c5b) commit,\n* **[v0.28.4](https://github.com/libgit2/libgit2/releases/tag/v0.28.4)** by [this](https://github.com/libgit2/libgit2/commit/460a9fdce) commit and [this](https://github.com/libgit2/libgit2/commit/ac0b2ef1f) commit,\n* **[v0.99.0](https://github.com/libgit2/libgit2/releases/tag/v0.99.0)** by [this](https://github.com/libgit2/libgit2/commit/3f7851ead) commit and [this](https://github.com/libgit2/libgit2/commit/e1832eb20) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-09-18T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4379",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12278",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4379/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/commit/3595e237c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/commit/3f7851ead",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/commit/460a9fdce",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/commit/4bae85c5b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/commit/ac0b2ef1f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/commit/e1832eb20",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/releases/tag/v0.27.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/releases/tag/v0.28.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/releases/tag/v0.99.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/releases/tag/v0.99.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4379/default-remediation-status"
            }
        ]
    }
}