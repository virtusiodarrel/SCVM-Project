{
    "source": "BDSA",
    "name": "BDSA-2020-2244",
    "title": "WSO2 Carbon-Kernel Vulnerable to Reflected Cross-Site Scripting (XSS) via 'Try it' Tool Functionality",
    "description": "WSO2 Carbon-Kernel contains a reflected cross-site scripting (XSS) vulnerability due to the insufficient validation of user-controlled data. Attackers could craft a malicious URL that could execute arbitrary JavaScript code in the victim's browser, which could allow the attacker to steal cookie based session tokens or credentials.",
    "technicalDescription": "This vulnerability occurs due to insufficient validation of user-controlled data within the SOAP service `Try it` tool. Attackers could exploit this by crafting requests to the `Try it` tool which contain a malicious JavaScript payload, resulting in a redirect to another website where the valid Carbon Management console session cookie could be sent to an attacker. These session cookies can be used to access the Carbon Management console, resulting in session hijacking. The vendor has addressed this by encoding the HTML to avoid content within the URI being executed, and by disabling the sending of session data as the part of the request.",
    "publishedDate": "2020-09-01T15:55:28.216Z",
    "updatedDate": "2020-09-01T15:55:28.210Z",
    "disclosureDate": "2020-08-17T00:00:00.000Z",
    "solution": "Fixed in Carbon-Kernel version **[4.6.1-m4](https://github.com/wso2/carbon-kernel/releases/tag/v4.6.1-m4)** by [this](https://github.com/wso2/carbon-kernel/commit/a59ffd99d6b206a3532801e4c00a17325b8d35fa) commit and [this](https://github.com/wso2/carbon-kernel/commit/448e1cf7ed04684eddbbb900dc1d80e38949454d) commit.\n\nFixed in the following repositories:\n* `product-is` version **[5.11.0-m17](https://github.com/wso2/product-is/releases/tag/v5.11.0-m17)**\n* `product-apim` version **[3.2.0-m1](https://github.com/wso2/product-apim/releases/tag/v3.2.0-m1)**\n* `analytics-apim` version **[3.2.0-m1](https://github.com/wso2/analytics-apim/releases/tag/v3.2.0-m1)**\n* `product-is` version **[5.11.0-m17](https://github.com/wso2/product-is/releases/tag/v5.11.0-m17)**\n* `analytics-is` version **[5.8.0](https://github.com/wso2/analytics-is/releases/tag/v5.8.0-beta5)**\n* `iot` version **[3.3.0](https://wso2.com/iot/install/download/?type=downloader)**",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Krzysztof Przybylsk",
    "workaround": "",
    "vendorFixDate": "2020-04-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2244",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-24706",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2244/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2020-0718",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/analytics-apim/releases/tag/v3.2.0-m1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/analytics-is/releases/tag/v5.8.0-beta5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/carbon-kernel/commit/448e1cf7ed04684eddbbb900dc1d80e38949454d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/carbon-kernel/commit/a59ffd99d6b206a3532801e4c00a17325b8d35fa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/carbon-kernel/releases/tag/v4.6.1-m4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/product-apim/releases/tag/v3.2.0-m1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/product-is/releases/tag/v5.11.0-m17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://wso2.com/iot/install/download/?type=downloader",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2244/default-remediation-status"
            }
        ]
    }
}