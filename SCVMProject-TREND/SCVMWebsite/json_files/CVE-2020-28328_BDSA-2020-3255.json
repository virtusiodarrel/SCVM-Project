{
    "source": "BDSA",
    "name": "BDSA-2020-3255",
    "title": "SuiteCRM Vulnerable to Remote Code Execution (RCE) via Cross-Site Scripting (XSS) in 'Create Documents' File Upload and Log File Poisoning",
    "description": "SuiteCRM is vulnerable to remote code execution (RCE) via log file poisoning which can only be done by the administrator. This could also be exploited by a low privileged user if they use a cross-site scripting (XSS) flaw in order to perform malicious actions on the administrator's behalf.",
    "technicalDescription": "There is an XSS vulnerability in the `Create Documents` file upload functionality - a low privileged user could upload arbitrary JavaScript code and send the file link to the administrator. Once the link is opened, the JavaScript code inside will get executed. The script would then update the log file name (found in `Admin \u2192 System Settings`) to end with the `.php` extension. The log file itself could be populated with arbitrary PHP code by updating user properties, such as first or last name. Finally, a GET request to the poisoned log file would trigger the RCE.\n\nAn initial fix was released to address this vulnerability, the fix was to check the value of `Extension` parameter was not empty when uploading a file using the `Create Documents` functionality. This forbids the user from setting the `.php` extension in the file name and leaving the designated extension field empty. However this was an incomplete fix, it was possible to bypass the check using a case insensitive String. \n\nNote:  See **CVE-2021-42840**, assigned for incomplete fix.",
    "publishedDate": "2020-11-10T14:30:23.165Z",
    "updatedDate": "2021-10-25T15:11:44.697Z",
    "disclosureDate": "2020-11-06T00:00:00.000Z",
    "exploitPublishDate": "2020-11-09T00:00:00.000Z",
    "solution": "Fixed in:\n* **[7.10.30](https://github.com/salesagility/SuiteCRM/releases/tag/v7.10.30)** by [this](https://github.com/salesagility/SuiteCRM/commit/001cebbc800149c1489d639a1fc3263a4e23d79b) commit.\n* **[7.11.19](https://github.com/salesagility/SuiteCRM/releases/tag/v7.11.19)** by [this](https://github.com/salesagility/SuiteCRM/commit/9cb957e4f41562eb44f6ce8c982e2a3c169fc951) commit.\n\nThe latest stable releases are available [here](https://suitecrm.com/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "mcorybillington (GitHub)",
    "workaround": "To mitigate the XSS vulnerability, the credited researcher advises to ensure you have the `AllowOveride` option set to `All` (Apache servers only). There is no guidance for nginx servers as they do not have this option.",
    "vendorFixDate": "2020-10-28T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-06T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3255",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28328",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3255/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcorybillington/SuiteCRM-RCE",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcorybillington/SuiteCRM-RCE",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcorybillington/SuiteCRM-RCE",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/salesagility/SuiteCRM/commit/001cebbc800149c1489d639a1fc3263a4e23d79b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/salesagility/SuiteCRM/commit/9cb957e4f41562eb44f6ce8c982e2a3c169fc951",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/salesagility/SuiteCRM/releases/tag/v7.10.30",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/salesagility/SuiteCRM/releases/tag/v7.11.19",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://suitecrm.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/49001",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3255/default-remediation-status"
            }
        ]
    }
}