{
    "source": "BDSA",
    "name": "BDSA-2019-3224",
    "title": "Sudo Vulnerable to Privilege Escalation via 'Runas' Specification with 'ALL' Keyword",
    "description": "Sudo contains a privilege escalation vulnerability which could allow a local attacker to escalate their privileges to root. To exploit this issue a user must have sudo privileges to allow them to run commands with an arbitrary user ID. Typically this means that the user's sudoers file has the value `ALL` listed first in the `RUNAS` specification.",
    "technicalDescription": "In order to change user ID sudo uses two system calls: `setresuid` and `setreuid`. Supplying a value of -1 (or its unsigned equivalent 4294967295) as an argument to either of these functions will force the system to leave the user ID in question unchanged. Since the sudo process itself is running as 0 the uid of the process will not change after calling these functions. \n\nSudo log entries for this commands will list the target user as 4294967295  and not root. In addition because the user ID specified via the -u option doesn't exist in the password database PAM session modules aren't run for this command.",
    "publishedDate": "2019-10-15T14:43:36.622Z",
    "updatedDate": "2019-10-15T14:43:36.606Z",
    "disclosureDate": "2019-08-14T00:00:00.000Z",
    "exploitPublishDate": "2019-08-14T00:00:00.000Z",
    "solution": "Fixed in [**1.8.28**](https://www.sudo.ws/download.html) by [this](https://www.sudo.ws/repos/sudo/rev/83db8dba09e7) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.6,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 2.7,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:L/AC:M/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Joe Vennix",
    "workaround": "",
    "vendorFixDate": "2019-08-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3224",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-266"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14287",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3224/ranges"
            },
            {
                "rel": "reference",
                "href": "https://www.sudo.ws/alerts/minus_1_uid.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.sudo.ws/alerts/minus_1_uid.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.sudo.ws/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.sudo.ws/repos/sudo/rev/83db8dba09e7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.sudo.ws/stable.html",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3224/default-remediation-status"
            }
        ]
    }
}