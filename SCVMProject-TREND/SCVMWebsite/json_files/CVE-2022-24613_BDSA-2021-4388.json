{
    "source": "BDSA",
    "name": "BDSA-2021-4388",
    "title": "metadata-extractor Vulnerable to Denial-of-Service (DoS) via Improper Handling of Exceptional Conditions",
    "description": "metadata-extractor is vulnerable to denial-of-service (DoS) issues due to how various exceptional conditions are mishandled.\n\nAn attacker could submit a crafted file in order to trigger one of these uncaught exceptions which in turn could result in an application crash.",
    "technicalDescription": "There are 30 individual exception related issues covered by **CVE-2022-24613**. They are as follows:\n* `java.lang.ArithmeticException` in\n\t* `com.drew.metadata.exif.PanasonicRawDistortionDescriptor.getDistortionScaleDescription--PanasonicRawDistortionDescriptor.java-97`\n* `java.lang.ArrayIndexOutOfBoundsException` in\n\t* `com.drew.metadata.exif.ExifDescriptorBase.formatCFAPattern--ExifDescriptorBase.java-586`\n\t* `com.drew.metadata.mp3.Mp3Reader.extract--Mp3Reader.java-96`\n* `java.lang.IllegalArgumentException` in\n\t* `com.drew.lang.StreamReader.skip--StreamReader.java-95`\n\t* `com.drew.metadata.mov.atoms.FileTypeCompatibilityAtom.--FileTypeCompatibilityAtom.java-46`\n\t* `com.drew.metadata.mov.atoms.SampleDescriptionAtom.--SampleDescriptionAtom.java-44`\n\t* `com.drew.metadata.mov.atoms.TimeToSampleAtom.--TimeToSampleAtom.java-44`\n* `java.lang.IndexOutOfBoundsException` in\n\t* `com.drew.metadata.mov.atoms.SoundSampleDescriptionAtom.addMetadata--SoundSampleDescriptionAtom.java-49`\n\t* `com.drew.metadata.mov.atoms.SubtitleSampleDescriptionAtom.addMetadata--SubtitleSampleDescriptionAtom.java-75`\n\t* `com.drew.metadata.mov.atoms.TextSampleDescriptionAtom.addMetadata--TextSampleDescriptionAtom.java-48`\n\t* `com.drew.metadata.mov.atoms.TimecodeSampleDescriptionAtom.addMetadata--TimecodeSampleDescriptionAtom.java-48`\n\t* `com.drew.metadata.mov.atoms.TimeToSampleAtom.addMetadata--TimeToSampleAtom.java-64`\n\t* `com.drew.metadata.mov.atoms.VideoSampleDescriptionAtom.addMetadata--VideoSampleDescriptionAtom.java-49`\n\t* `com.drew.metadata.mov.metadata.QuickTimeDataHandler.processData--QuickTimeDataHandler.java-105`\n* `java.lang.NegativeArraySizeException` in\n\t* `com.drew.lang.SequentialByteArrayReader.getBytes--SequentialByteArrayReader.java-77`\n\t* `com.drew.lang.SequentialReader.getNullTerminatedBytes--SequentialReader.java-374`\n\t* `com.drew.lang.StreamReader.getBytes--StreamReader.java-71`\n* `java.lang.NullPointerException` in\n\t* `com.drew.imaging.quicktime.QuickTimeHandler.addError--QuickTimeHandler.java-63`\n\t* `com.drew.metadata.Directory.setString--Directory.java-287`\n\t* `com.drew.metadata.Metadata.getFirstDirectoryOfType--Metadata.java-101`\n\t* `com.drew.metadata.mov.atoms.SubtitleSampleDescriptionAtom.addMetadata--SubtitleSampleDescriptionAtom.java-77`\n\t* `com.drew.metadata.mov.atoms.TimeToSampleAtom.addMetadata--TimeToSampleAtom.java-64`\n\t* `com.drew.metadata.mov.media.QuickTimeSoundHandler.processTimeToSample--QuickTimeSoundHandler.java-73`\n\t* `com.drew.metadata.mov.metadata.QuickTimeDirectoryHandler.processData--QuickTimeDirectoryHandler.java-88`\n\t* `com.drew.metadata.mov.QuickTimeMediaHandler.--QuickTimeMediaHandler.java-48`\n\t* `com.drew.metadata.mp4.boxes.TimeToSampleBox.addMetadata--TimeToSampleBox.java-58`\n\t* `com.drew.metadata.mp4.boxes.TimeToSampleBox.addMetadata--TimeToSampleBox.java-65`\n* `java.lang.StringIndexOutOfBoundsException` in\n\t* `com.drew.metadata.exif.ExifTiffHandler.processPrintIM--ExifTiffHandler.java-733`\n\t* `com.drew.metadata.icc.IccDescriptor.getTagDataString--IccDescriptor.java-196`\n\t* `com.drew.metadata.icc.IccDescriptor.getTagDataString--IccDescriptor.java-94`",
    "publishedDate": "2022-05-13T15:32:27.408Z",
    "updatedDate": "2022-05-13T15:32:27.383Z",
    "disclosureDate": "2021-12-10T00:00:00.000Z",
    "exploitPublishDate": "2021-12-10T00:00:00.000Z",
    "solution": "Fixed in [**2.18.0**](https://github.com/drewnoakes/metadata-extractor/releases/tag/2.18.0) by the following commits:\n* [Commit 1](https://github.com/drewnoakes/metadata-extractor/commit/ddc17c0723ec51d4a54e7dc7633a3b65e00d7db1)\n* [Commit 2](https://github.com/drewnoakes/metadata-extractor/commit/d723003d129721aad4bf9c04c503e9d1cc0f5fe6)\n* [Commit 3](https://github.com/drewnoakes/metadata-extractor/commit/b2e2dcaef30c3c9609e92ea56fc39e341fc0d193)\n* [Commit 4](https://github.com/drewnoakes/metadata-extractor/commit/e61968a6032b3853575ae0381ea63e53be478a65)\n* [Commit 5](https://github.com/drewnoakes/metadata-extractor/commit/6215a8d0e0764b7a975aca9f6ce7ca55bdb59b94)\n* [Commit 6](https://github.com/drewnoakes/metadata-extractor/commit/998e0529f68f0c0890c282627b29e45acfc11b95)\n* [Commit 7](https://github.com/drewnoakes/metadata-extractor/commit/7ae0389af90c6a22707d743fabf8dcceb8b94415)\n* [Commit 8](https://github.com/drewnoakes/metadata-extractor/commit/537132e57aeac02e9a108cbca0c61dc1cca2237f)\n* [Commit 9](https://github.com/drewnoakes/metadata-extractor/commit/71b6b3500c9423a8e0286a78c65b0363c5e00bf9)\n* [Commit 10](https://github.com/drewnoakes/metadata-extractor/commit/085d36cfa32cb7703b4a5fdd3accbfc51036c637)\n* [Commit 11](https://github.com/drewnoakes/metadata-extractor/commit/09f0cd3931cfbe5ee379fcd8c271a2b7b249d458)\n* [Commit 12](https://github.com/drewnoakes/metadata-extractor/commit/4bce37bb70845fd509d04c7fee5f123d891c287f)\n* [Commit 13](https://github.com/drewnoakes/metadata-extractor/commit/ca0cb0502aaaa668af8242e0e23bcbb1efc752a4)\n* [Commit 14](https://github.com/drewnoakes/metadata-extractor/commit/511ab1469f450c351a43a8f13a5f87f5c42b502f)\n* [Commit 15](https://github.com/drewnoakes/metadata-extractor/commit/35710efd6af1553addc373a20ab058e0adb908ce)\n* [Commit 16](https://github.com/drewnoakes/metadata-extractor/commit/3b83ae6ff942be6c97053664e2b13e99dc53d66d)\n* [Commit 17](https://github.com/drewnoakes/metadata-extractor/commit/65934b64cab95d623e798792a1357aa98ae3ad0d)\n* [Commit 18](https://github.com/drewnoakes/metadata-extractor/commit/b30691e5b445b903746dbe1ceb0e4188ae494701)\n* [Commit 19](https://github.com/drewnoakes/metadata-extractor/commit/d54596ba7d9621dd6553bbf230afb82c11a9c554)\n* [Commit 20](https://github.com/drewnoakes/metadata-extractor/commit/cde596dbf7f66c47a741646b32a0179c3b34b8c5)\n* [Commit 21](https://github.com/drewnoakes/metadata-extractor/commit/3402b42468f362af932fe2e9ad14ee91f586237b)\n* [Commit 22](https://github.com/drewnoakes/metadata-extractor/commit/053d23d0be38f9e52a1423373792cb012883bfb9)\n* [Commit 23](https://github.com/drewnoakes/metadata-extractor/commit/47095a46c9533104e572860c1aae3ee8ec788a85)\n* [Commit 24](https://github.com/drewnoakes/metadata-extractor/commit/70ae244c7e5aacf5804f9ed3990ee5c26533c983)\n\nThe latest stable releases are available [here](https://github.com/drewnoakes/metadata-extractor/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Zhang Cen, Huang Wenjie and Zhang Xiaohan",
    "workaround": "",
    "vendorFixDate": "2022-04-04T00:00:00.000Z",
    "vendorNotifiedDate": "2021-12-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4388",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-755"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24613",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4388/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-p5pg-wm9q-8v6r",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/053d23d0be38f9e52a1423373792cb012883bfb9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/085d36cfa32cb7703b4a5fdd3accbfc51036c637",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/09f0cd3931cfbe5ee379fcd8c271a2b7b249d458",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/3402b42468f362af932fe2e9ad14ee91f586237b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/35710efd6af1553addc373a20ab058e0adb908ce",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/3b83ae6ff942be6c97053664e2b13e99dc53d66d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/47095a46c9533104e572860c1aae3ee8ec788a85",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/4bce37bb70845fd509d04c7fee5f123d891c287f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/511ab1469f450c351a43a8f13a5f87f5c42b502f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/537132e57aeac02e9a108cbca0c61dc1cca2237f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/6215a8d0e0764b7a975aca9f6ce7ca55bdb59b94",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/65934b64cab95d623e798792a1357aa98ae3ad0d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/70ae244c7e5aacf5804f9ed3990ee5c26533c983",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/71b6b3500c9423a8e0286a78c65b0363c5e00bf9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/7ae0389af90c6a22707d743fabf8dcceb8b94415",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/998e0529f68f0c0890c282627b29e45acfc11b95",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/b2e2dcaef30c3c9609e92ea56fc39e341fc0d193",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/b30691e5b445b903746dbe1ceb0e4188ae494701",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/ca0cb0502aaaa668af8242e0e23bcbb1efc752a4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/cde596dbf7f66c47a741646b32a0179c3b34b8c5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/d54596ba7d9621dd6553bbf230afb82c11a9c554",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/d723003d129721aad4bf9c04c503e9d1cc0f5fe6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/ddc17c0723ec51d4a54e7dc7633a3b65e00d7db1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/commit/e61968a6032b3853575ae0381ea63e53be478a65",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/issues/561",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/issues/561",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drewnoakes/metadata-extractor/releases/tag/2.18.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4388/default-remediation-status"
            }
        ]
    }
}