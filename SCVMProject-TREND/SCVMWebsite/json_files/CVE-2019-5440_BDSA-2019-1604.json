{
    "source": "BDSA",
    "name": "BDSA-2019-1604",
    "title": "Revive Adserver Vulnerable to Authentication Bypass via Password Recovery Functionality",
    "description": "Revive Adserver is vulnerable to authentication bypass. A flaw in the component's password recovery feature could allow an attacker to reset a user's password without knowing the previous login credentials. If successfully exploited, the remote attacker could authenticate as the administrator or an existing user.",
    "technicalDescription": "The vulnerable file is `lib/OA/Dal/PasswordRecovery.php`. Due to the sole use of `uniqd` to generate tokens for changing a user's password, it is possible for a remote attacker to exploit a race condition to calculate the recovery token for a specific user. The attacker must set their system's timezone to match the vulnerable server to exploit. By sending a flood of generated tokens, the attacker can successfully authenticate as another user.\n\n`uniqd` is an insecure method of generating a unique identifier. It does not generate cryptographically secure values.\n\nThe attacker must know the user's email who they wish to authenticate as, this can be determined via enumeration. For example, an administrator's email can be determined via flaws in `admin/password-recovery.php` by sending a flood of emails until the message `Email Password Reset sent` is received.\n\nFixed by replacing `uniqd` with the PHP `random_bytes` function.",
    "publishedDate": "2019-05-22T15:45:24.137Z",
    "updatedDate": "2019-11-04T16:53:39.456Z",
    "disclosureDate": "2019-05-21T00:00:00.000Z",
    "exploitPublishDate": "2019-05-21T00:00:00.000Z",
    "solution": "Fixed in **[4.2.1](https://github.com/revive-adserver/revive-adserver/releases/tag/v4.2.1)** by [this](https://github.com/revive-adserver/revive-adserver/commit/51fef40) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "paulos_",
    "workaround": "",
    "vendorFixDate": "2019-05-20T00:00:00.000Z",
    "vendorNotifiedDate": "2019-05-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1604",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-338"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5440",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1604/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/revive-adserver/revive-adserver/commit/51fef40",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/revive-adserver/revive-adserver/releases/tag/v4.2.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/576504",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/576504",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/152987/REVIVE-SA-2019-002.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1604/default-remediation-status"
            }
        ]
    }
}