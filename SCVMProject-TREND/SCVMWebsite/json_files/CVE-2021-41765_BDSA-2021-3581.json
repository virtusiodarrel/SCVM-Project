{
    "source": "BDSA",
    "name": "BDSA-2021-3581",
    "title": "ResourceSpace Vulnerable to SQL Injection (SQLi) via 'add_keyword.php'",
    "description": "ResourceSpace is vulnerable to SQL injection (SQLi) due to the insufficient sanitization of user input. This may allow a remote unauthenticated attacker to extract, modify and delete information stored on the ResourceSpace database.",
    "technicalDescription": "This vulnerability exists within the `pages/edit_fields/9_ajax/add_keyword.php` file and involves the ResourceSpace database. This vulnerability was introduced with the inclusion of an 'upload external files' feature in version 9.5, allowing unauthenticated users to upload files to the ResourceSpace database. As such, changes were made to the authentication and authorization logic that in turn introduced flaws in input sanitization. It specifically occurs due to the insufficient sanitization of the `k` parameter, allowing for crafted malicious statements to be provided to the `check_access_key_collection()` function, which takes the value of k and passes it directly to an SQL query.",
    "publishedDate": "2021-11-26T17:10:42.937Z",
    "updatedDate": "2021-11-26T17:10:42.926Z",
    "disclosureDate": "2021-09-25T00:00:00.000Z",
    "exploitPublishDate": "2021-09-25T00:00:00.000Z",
    "solution": "Fixed in version [**9.7**](https://www.resourcespace.com/versions).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "UNCORROBORATED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:UR)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "REASONABLE",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "horizon3ai",
    "workaround": "",
    "vendorFixDate": "2021-09-27T00:00:00.000Z",
    "vendorNotifiedDate": "2021-09-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3581",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41765",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3581/ranges"
            },
            {
                "rel": "reference",
                "href": "https://www.horizon3.ai/multiple-vulnerabilities-in-resourcespace/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.horizon3.ai/multiple-vulnerabilities-in-resourcespace/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.resourcespace.com/versions",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3581/default-remediation-status"
            }
        ]
    }
}