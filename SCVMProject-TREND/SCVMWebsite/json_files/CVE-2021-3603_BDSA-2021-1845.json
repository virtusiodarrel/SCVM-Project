{
    "source": "BDSA",
    "name": "BDSA-2021-1845",
    "title": "PHPMailer Vulnerable to Local Code Inclusion via 'validateAddress' Function",
    "description": "PHPMailer is vulnerable to local code inclusion via the `validateAddress` function. If malicious code can be first injected into the host project's scope, this issue will enable that code to be called.",
    "technicalDescription": "The `validateAddress` function is used by PHPMailer to validate email addresses. If the `$patternselect` parameter to this function is set to `php` (the default value) and a function named `php` is defined in the global namespace, it will be called in preference to the built-in 'php' validator function. If malicious code exists in the hosts project's scope it can be called through this mechanism.  \n\nThis issue was addressed by denying the use of simple strings as validator function names.",
    "publishedDate": "2021-06-18T15:09:53.996Z",
    "updatedDate": "2021-06-18T15:09:53.991Z",
    "disclosureDate": "2021-06-10T00:00:00.000Z",
    "exploitPublishDate": "2021-06-10T00:00:00.000Z",
    "solution": "Fixed in [**6.5.0**](https://github.com/PHPMailer/PHPMailer/releases/tag/v6.5.0) by [this](https://github.com/PHPMailer/PHPMailer/commit/45f3c18dc6a2de1cb1bf49b9b249a9ee36a5f7f3) commit.\n\nThe latest stable releases are available [here](https://github.com/PHPMailer/PHPMailer/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "0xcrypto",
    "workaround": "",
    "vendorFixDate": "2021-06-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1845",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-829"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3603",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1845/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPMailer/PHPMailer/commit/45f3c18dc6a2de1cb1bf49b9b249a9ee36a5f7f3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPMailer/PHPMailer/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPMailer/PHPMailer/releases/tag/v6.5.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.huntr.dev/bounties/1-PHPMailer/PHPMailer/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.huntr.dev/bounties/1-PHPMailer/PHPMailer/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1845/default-remediation-status"
            }
        ]
    }
}