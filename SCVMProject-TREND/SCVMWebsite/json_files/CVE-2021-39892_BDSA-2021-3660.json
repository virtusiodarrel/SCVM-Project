{
    "source": "BDSA",
    "name": "BDSA-2021-3660",
    "title": "Gitlab Vulnerable to Email Address Disclosure via Flawed Permissions Validation in User Import Functionality",
    "description": "Gitlab is vulnerable to an information disclosure issue due to how the user import functionality does not sufficiently validate project member permissions.\n\nAn attacker with `Guest` privileges on a project could abuse this flaw in order to disclose the email addresses of members by inviting the project members to join another project. The attacker can then see all pending members' email addresses even if they have not yet joined the new project.",
    "technicalDescription": "In order to remedy this issue, the vendor has updated the user import code in the `app/controllers/projects/project_members_controller.rb` file to validate if the requesting project member has `Maintainer` privileges to match the documentation for this functionality.",
    "publishedDate": "2021-12-07T15:05:39.553Z",
    "updatedDate": "2022-09-30T15:07:03.958Z",
    "disclosureDate": "2021-09-30T00:00:00.000Z",
    "exploitPublishDate": "2021-11-02T00:00:00.000Z",
    "solution": "Fixed in:\n* [**14.1.7**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.1.7) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/24749dc434b999798b2323882a4adcaf05158af7) commit,\n* [**14.2.5**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.2.5) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/d8811450e870f6bbd7b7d7990aa51e35b0c607ce) commit,\n* [**14.3.1**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.3.1) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/77e5b153659e884a5fa8442d675f2b88e9de2dd2) commit.\n\nThe latest stable releases are available [here](https://gitlab.com/gitlab-org/gitlab-foss/-/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "@ashish_r_padelkar",
    "workaround": "",
    "vendorFixDate": "2021-09-29T00:00:00.000Z",
    "vendorNotifiedDate": "2019-04-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3660",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39892",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3660/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2021/09/30/security-release-gitlab-14-3-1-released/#low-privileged-users-can-import-users-from-projects-that-they-they-are-not-a-maintainer-on",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-39892.json",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/24749dc434b999798b2323882a4adcaf05158af7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/77e5b153659e884a5fa8442d675f2b88e9de2dd2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/d8811450e870f6bbd7b7d7990aa51e35b0c607ce",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.1.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.2.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/28440",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/28440",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3660/default-remediation-status"
            }
        ]
    }
}