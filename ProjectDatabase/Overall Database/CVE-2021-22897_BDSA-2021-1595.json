{
    "source": "BDSA",
    "name": "BDSA-2021-1595",
    "title": "curl Vulnerable to Weakened Transport Security via 'Schannel Cipher Selection Surprise'",
    "description": "curl, when using Schannel, is vulnerable to a weakened transport security issue due to a flaw in how ciphers are selected and used for multiple concurrent transfers.\n\nThis issue means that the last transfer to set the ciphers will control the set used by all transfers, potentially making these transfers more vulnerable to attack.",
    "technicalDescription": "curl is vulnerable to weakened transport security because the selected TLS cipher set (set using the `CURLOPT_SSL_CIPHER_LIST` option) which is to be used in transfers is stored in a single static variable. If multiple concurrent transfers are set up, the last transfer to set the ciphers will control the set used by all of the transfers.\n\nThe cipher selection is performed when a transfer is performed using any of the TLS-based transfer protocols that libcurl supports, such as HTTPS, FTPS, IMAPS, POP3S, SMTPS etc.\n\n**Note**: The vendor has stated [here](https://curl.se/docs/CVE-2021-22897.html) that this issue only exists when curl is built to use Schannel.",
    "publishedDate": "2021-05-27T13:16:06.519Z",
    "updatedDate": "2021-05-27T13:16:06.513Z",
    "disclosureDate": "2021-05-26T00:00:00.000Z",
    "exploitPublishDate": "2021-05-26T00:00:00.000Z",
    "solution": "Fixed in [**7.77.0**](https://github.com/curl/curl/releases/tag/curl-7_77_0) by [this](https://github.com/curl/curl/commit/bbb71507b7bab52002f9b1e0880bed6a32834511) commit.\n\nThe latest stable releases are available [here](https://curl.se/download.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.2,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.9
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.1,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Harry Sintonen",
    "workaround": "The vendor has suggested [here](https://curl.se/docs/CVE-2021-22897.html) that apart from upgrading or applying a patch, users can make sure to avoid using `CURLOPT_SSL_CIPHER_LIST`.",
    "vendorFixDate": "2021-05-24T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1595",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-488"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-22897",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1595/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22897.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22897.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/download.html",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/9aefbff30d280c60fc9d8cc3e0b2f19fc70a2f28",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/bbb71507b7bab52002f9b1e0880bed6a32834511",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_77_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1172857",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1172857",
                "label": "POC"
            }
        ]
    }
}