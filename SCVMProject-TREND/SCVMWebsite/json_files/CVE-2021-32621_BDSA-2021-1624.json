{
    "source": "BDSA",
    "name": "BDSA-2021-1624",
    "title": "XWiki Vulnerable to Privilege Escalation via Code Injection in Titles Editing Functionality",
    "description": "XWiki is vulnerable to privilege escalation due to a code injection flaw. An attacker could execute scripts with elevated privileges by editing gadget titles.",
    "technicalDescription": "This vulnerability exists within the `xwiki-platform-core/xwiki-platform-dashboard/xwiki-platform-dashboard-macro/src/main/java/org/xwiki/rendering/internal/macro/dashboard/DefaultGadgetSource.java` file.  Attackers without scripting or programming rights could exploit this issue by editing the gadget titles within the application's dashboard. This will allow them to run scripts that will execute in the context of a privileged user. The vendor addressed this by implementing velocity in gadget titles.",
    "publishedDate": "2021-06-07T11:45:14.893Z",
    "updatedDate": "2021-06-07T11:45:14.886Z",
    "disclosureDate": "2021-05-18T00:00:00.000Z",
    "solution": "Fixed in: \n* **[13.1-RC1](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.1-rc-1)** by [this](https://github.com/xwiki/xwiki-platform/commit/bb7068bd911f91e5511f3cfb03276c7ac81100bc) commit\n* **[12.10.3](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.10.3)** by [this](https://github.com/xwiki/xwiki-platform/commit/0940149439d9d7610c1d4357a618ccbe2c126d80) commit\n* **[12.6.7](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.6.7)** by [this](https://github.com/xwiki/xwiki-platform/commit/1287f7eb84c9a6a5e81ef06cad378cebd95cfb9e) commit. \n\nThe latest stable releases are available [here](https://github.com/xwiki/xwiki-platform/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 3.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-01-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1624",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32621",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1624/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/0940149439d9d7610c1d4357a618ccbe2c126d80",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/1287f7eb84c9a6a5e81ef06cad378cebd95cfb9e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/bb7068bd911f91e5511f3cfb03276c7ac81100bc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.10.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.6.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.1-rc-1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-h353-hc43-95vc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1624/default-remediation-status"
            }
        ]
    }
}