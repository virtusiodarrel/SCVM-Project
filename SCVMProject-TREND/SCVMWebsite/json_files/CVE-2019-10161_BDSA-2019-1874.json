{
    "source": "BDSA",
    "name": "BDSA-2019-1874",
    "title": "Libvirt Vulnerable to Arbitrary File Access via Improper Access Control in 'virDomainSaveImageGetXMLDesc' API",
    "description": "An improper access control vulnerability has been discovered in Libvirt. An attacker could exploit this vulnerability via malicious input to discover arbitrary files, cause a denial-of-service (DoS) condition or cause the libvirtd process to execute arbitrary programs.",
    "technicalDescription": "A weakness has been discovered in Libvirt which can lead to arbitrary file read/execution or trigger an application crash. The `virDomainSaveImageGetXMLDesc` API implemented by the application utilizes user-supplied input to point to specified files on the system. The functionality located in the file `src/libvirt-domain.c` does not restrict the process for read-only connections, which allows malicious actors to inject crafted input to read or execute specified files with the application level privileges.\n\nIn order to exploit this vulnerability requires access to the socket located in the file `var/run/libvirt/libvirt_sock_ro`.",
    "publishedDate": "2019-06-24T13:09:28.073Z",
    "updatedDate": "2020-07-20T10:12:59.029Z",
    "disclosureDate": "2019-06-20T00:00:00.000Z",
    "solution": "Fixed in [**5.5.0-rc1**](https://libvirt.org/git/?p=libvirt.git;a=commit;h=cf146eb042ffd222a54d1ffb0a4c9aa32eada0a7) by [this](https://libvirt.org/git/?p=libvirt.git;a=commit;h=aed6a032cead4386472afb24b16196579e239580) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.4,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matthias Gerstner",
    "workaround": "In Unix systems, the libvirt's read-only socket permissions can be modified via the `/etc/libvirt/libvirtd.conf` to restrict access to members who have management access to the virtual machine.",
    "vendorFixDate": "2019-06-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1874",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10161",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1874/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1720115",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://libvirt.org/git/?p=libvirt.git;a=commit;h=aed6a032cead4386472afb24b16196579e239580",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://libvirt.org/git/?p=libvirt.git;a=commit;h=cf146eb042ffd222a54d1ffb0a4c9aa32eada0a7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1874/default-remediation-status"
            }
        ]
    }
}