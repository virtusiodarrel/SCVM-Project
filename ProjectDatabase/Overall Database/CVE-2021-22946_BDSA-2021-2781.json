{
    "source": "BDSA",
    "name": "BDSA-2021-2781",
    "title": "Curl Vulnerable to Sensitive Information Exposure via TLS Bypass",
    "description": "Curl is vulnerable to sensitive information exposure due to a bypass of necessary cryptography. This can allow an attacker to ensure operations are performed without the use of TLS, which can expose sensitive data in clear text over the network.",
    "technicalDescription": "This vulnerability exists when a user makes a request for it to be a requirement for Curl to use TLS to speak to an IMAP, POP3 or FTP server. However an attacker could ensure that this requirement is bypassed if they ensure the server returns a properly crafted but perfectly legitimate response. This can result in operations being performed without the use of TLS, which can expose sensitive data in clear text over the network.\n\nThe vendor has mitigated against this but including additional checks In IMAP (`lib/imap.c`), POP3 (`lib/pop3.c`), and FTP (`lib/ftp.c`) to ensure that TLS used when it is required.",
    "publishedDate": "2021-09-15T12:10:07.455Z",
    "updatedDate": "2021-10-04T15:03:53.421Z",
    "disclosureDate": "2021-09-15T00:00:00.000Z",
    "exploitPublishDate": "2021-09-24T00:00:00.000Z",
    "solution": "Fixed in [**7.79.0**](https://github.com/curl/curl/releases/tag/curl-7_79_0) by [this](https://github.com/curl/curl/commit/364f1747) commit.\n\nThe latest stable releases are available [here](https://curl.se/download.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Patrick Monnerat",
    "workaround": "The vendor has [suggested ](https://curl.se/docs/CVE-2021-22946.html) that a recommendation to mitigate this is to not use IMAP, POP3 or FTP.",
    "vendorFixDate": "2021-09-13T00:00:00.000Z",
    "vendorNotifiedDate": "2021-09-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2781",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-325"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-22946",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2781/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22946.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22946.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/364f1747",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/c5ba0c2f544653",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/ec3bb8f727405",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_79_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1334111",
                "label": "POC"
            }
        ]
    }
}