{
    "source": "BDSA",
    "name": "BDSA-2019-2034",
    "title": "Keycloak NodeJS Connect Vulnerable to Denial-of-Service (DoS) via Improper Web Token Verification",
    "description": "Keycloak is vulnerable to denial-of-service (DoS) due to missing token signature verification. A local attacker could prevent users from successfully conducting the login process by supplying the application with a crafted Java Web Token (JWT).",
    "technicalDescription": "The function `adminLogout()`, which is defined within `admin.js`, contains code that is used by the NodeJS Connect component of Keycloak to conduct the backchannel logout process. This involves the exchange of a token in JSON format. This is stored in the `Buffer` variable, and is parsed in order to process the various parameters that it contains. These parameters can also be used to control the login process. If they possess certain values, the user will be prevented from logging in. As the application does not correctly verify the token, a local attacker could potentially construct a token that, when exchanged, will indefinitely suspend the user's access to their account.",
    "publishedDate": "2019-07-16T14:52:24.709Z",
    "updatedDate": "2019-10-02T12:39:17.337Z",
    "disclosureDate": "2019-06-11T00:00:00.000Z",
    "solution": "Fixed in version [**4.4.0**](https://github.com/keycloak/keycloak-nodejs-connect/releases/tag/v4.4.0) by [this](https://github.com/keycloak/keycloak-nodejs-connect/commit/55e54b55d05ba636bc125a8f3d39f0052d13f8f6) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 1.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 2.5,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.0,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.2
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-08-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2034",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-345"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10157",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2034/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10157",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak-nodejs-connect/commit/55e54b55d05ba636bc125a8f3d39f0052d13f8f6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak-nodejs-connect/releases/tag/v4.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2034/default-remediation-status"
            }
        ]
    }
}