{
    "source": "BDSA",
    "name": "BDSA-2021-1666",
    "title": "Django Vulnerable to Directory Traversal via 'TemplateDetailView' View",
    "description": "Django contains a directory traversal vulnerability. Successfully exploiting this could provide an attacker with knowledge of the existence of files which they do not have permission to view. In some circumstances this could also allow the attacker to view the contents of the exposed files.",
    "technicalDescription": "This vulnerability occurs in the `TemplateDetailView` defined in file `django/contrib/admindocs/views.py`. An authenticated attacker can use this view to determine if arbitrary files exist or not. In addition to this, if the `admindocs` templates have been customized to display the content of files, then an attacker will also have access to this information. \n\nThe vendor has mitigated this vulnerability by applying path sanitation.",
    "publishedDate": "2021-06-04T09:09:08.178Z",
    "updatedDate": "2021-06-04T09:43:06.189Z",
    "disclosureDate": "2021-06-02T00:00:00.000Z",
    "solution": "Fixed in:\n* The **main** branch by [this](https://github.com/django/django/commit/46572de2e92fdeaf047f80c44d52269e54ad68db) commit,\n* [**3.2.4**](https://github.com/django/django/releases/tag/3.2.4) by [this](https://github.com/django/django/commit/dfaba12cda060b8b292ae1d271b44bf810b1c5b9) commit,\n* [**3.1.12**](https://github.com/django/django/releases/tag/3.1.12) by [this](https://github.com/django/django/commit/20c67a0693c4ede2b09af02574823485e82e4c8f) commit,\n* [**2.2.24**](https://github.com/django/django/releases/tag/2.2.24) by [this](https://github.com/django/django/commit/053cc9534d174dc89daba36724ed2dcb36755b90) commit.\n\nThe latest stable releases are available [here](https://www.djangoproject.com/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rasmus Lerchedahl Petersen and Rasmus Wriedt Larsen",
    "workaround": "",
    "vendorFixDate": "2021-06-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1666",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33203",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1666/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/053cc9534d174dc89daba36724ed2dcb36755b90",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/20c67a0693c4ede2b09af02574823485e82e4c8f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/46572de2e92fdeaf047f80c44d52269e54ad68db",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/dfaba12cda060b8b292ae1d271b44bf810b1c5b9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/2.2.24",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/3.1.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/3.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/weblog/2021/jun/02/security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1666/default-remediation-status"
            }
        ]
    }
}