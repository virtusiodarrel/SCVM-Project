{
    "source": "BDSA",
    "name": "BDSA-2019-2585",
    "title": "YOURLS Vulnerable to Login Bypass via Type Juggling in API",
    "description": "YOURLS is vulnerable to login bypass and privilege escalation due to a type juggling vulnerability. An attacker could use this to bypass any check that asks for a user password, cookie, signature or time limited token.",
    "technicalDescription": "In YOURLS, non strict comparisons are used to compare important pieces of data to data provided by the user. This can allow an attacker to trick the program into thinking that the attacker has provided a correct password by forcing the program to juggle the password into another data type (for instance into an integer) and comparing it against an attacker provided integer. \n\nIn this case php would decide that 0e123456 should be juggled to an integer, which would then match if an attacker supplied a password of 0e987654 due to only comparing the values of the data as if they were both integers, rather than the value and the type. ie. \"0e123456\" would be juggled to \"0\" , and \"0e987654\" would also be juggled to 0, therefore causing \"0e123456\" == \"0e987654\" to evaluate as true.\n\nAs a result, given enough time an attacker could much more easily brute force user accounts, allowing them to potentially login as an admin.\n\nThis vulnerability is fixed by changing `==` which only compares variable values, to `===` which compares value and type.",
    "publishedDate": "2019-08-14T14:10:57.749Z",
    "updatedDate": "2019-08-14T14:10:57.737Z",
    "disclosureDate": "2019-08-02T00:00:00.000Z",
    "exploitPublishDate": "2019-08-02T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/YOURLS/YOURLS/commit/9e36c67b01b932a41f0834d7896c7ba8383e9f07) commit which is not yet included in any major release.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Wocanilo",
    "workaround": "",
    "vendorFixDate": "2019-08-02T00:00:00.000Z",
    "vendorNotifiedDate": "2019-08-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2585",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-681"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14537",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2585/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Wocanilo/CVE-2019-14537",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/YOURLS/YOURLS/commit/9e36c67b01b932a41f0834d7896c7ba8383e9f07",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/YOURLS/YOURLS/pull/2542",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2585/default-remediation-status"
            }
        ]
    }
}