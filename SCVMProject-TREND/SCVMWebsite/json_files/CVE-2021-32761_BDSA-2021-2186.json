{
    "source": "BDSA",
    "name": "BDSA-2021-2186",
    "title": "Redis Vulnerable to Denial-of-Service (DoS) or Remote Code Execution (RCE) via Integer Overflow in 'BITFIELD' Command",
    "description": "Redis is vulnerable to a denial-of-service (DoS) condition and possibly remote code execution (RCE).  This is due to a memory corruption issue in the `BITFIELD` command.  An attacker that has access to the Redis instance can pass malicious input to the command that will corrupt memory. In some instances the vendor states that this may lead to the execution of code.\n\nThis vulnerability only affects 32-bit versions of Redis.",
    "technicalDescription": "The DoS / RCE vulnerability occurs due to `size_t` being used to store a value. On 32bit systems `size_t` is insufficient.",
    "publishedDate": "2021-07-22T13:56:00.305Z",
    "updatedDate": "2022-07-21T08:45:18.949Z",
    "disclosureDate": "2021-07-21T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.0.13**](https://github.com/redis/redis/releases/tag/5.0.13) by [this](https://github.com/redis/redis/commit/449af2cd7a6646de0d4c0a3500fe72d8f18b7453) commit.\n* [**6.0.15**](https://github.com/redis/redis/releases/tag/6.0.15) by [this](https://github.com/redis/redis/commit/5f49f4fb40531e9157b801694c94eba9f5571da4) commit.\n* [**6.2.5**](https://github.com/redis/redis/releases/tag/6.2.5) by [this](https://github.com/redis/redis/commit/835d15b5360e277e6f95529c4d8685946a977ddd) commit.\n\nThe latest stable releases are available [here](https://github.com/redis/redis/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Huang Zhw",
    "workaround": "Prevent users from modifying the `proto-max-bulk-len` configuration parameter. This can be done using ACL to restrict unprivileged users from using the `CONFIG SET` command.",
    "vendorFixDate": "2021-07-21T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2186",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-680"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32761",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2186/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/449af2cd7a6646de0d4c0a3500fe72d8f18b7453",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/5f49f4fb40531e9157b801694c94eba9f5571da4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/835d15b5360e277e6f95529c4d8685946a977ddd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/5.0.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/6.0.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/6.2.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/security/advisories/GHSA-8wxq-j7rp-g8wj",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/security/advisories/GHSA-8wxq-j7rp-g8wj",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2186/default-remediation-status"
            }
        ]
    }
}