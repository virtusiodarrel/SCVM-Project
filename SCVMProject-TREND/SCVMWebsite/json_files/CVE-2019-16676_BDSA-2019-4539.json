{
    "source": "BDSA",
    "name": "BDSA-2019-4539",
    "title": "Plataformatec Simple Form Vulnerable to Remote Code Execution (RCE) Incorrect Access Control in 'file_method' Function",
    "description": "Plataformatec Simple Form is vulnerable to remote code execution (RCE) due to incorrect access control. This could allow an attacker to call maliciously crafted methods, expose user information or cause a denial-of-service (DoS).",
    "technicalDescription": "The issue exists in the function `file_method()` within the file `lib/simple_form/form_builder.rb`. On pages with forms built with user-supplied input, the function calls the `.send()` method to discover file input types. Improper restrictions on the discovery process could allow an attacker to invoke methods using maliciously crafted form input. Methods invoked could modify application data (such as `#destory`), check used methods to expose user information, or cause a DoS condition through excessive resource consumption.",
    "publishedDate": "2020-08-07T12:06:17.732Z",
    "updatedDate": "2020-08-21T12:12:44.748Z",
    "disclosureDate": "2019-09-27T00:00:00.000Z",
    "exploitPublishDate": "2019-09-27T00:00:00.000Z",
    "solution": "Fixed in **[5.0.0](https://github.com/heartcombo/simple_form/releases/tag/v5.0.0)** by [this](https://github.com/heartcombo/simple_form/commit/8c91bd76a5052ddf3e3ab9fd8333f9aa7b2e2dd6) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Philipp Tessenow",
    "workaround": "",
    "vendorFixDate": "2019-09-27T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4539",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-16676",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4539/ranges"
            },
            {
                "rel": "reference",
                "href": "http://blog.plataformatec.com.br/2019/09/incorrect-access-control-in-simple-form-cve-2019-16676/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/heartcombo/simple_form/commit/8c91bd76a5052ddf3e3ab9fd8333f9aa7b2e2dd6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/heartcombo/simple_form/releases/tag/v5.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/heartcombo/simple_form/security/advisories/GHSA-r74q-gxcg-73hx",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/heartcombo/simple_form/security/advisories/GHSA-r74q-gxcg-73hx",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4539/default-remediation-status"
            }
        ]
    }
}