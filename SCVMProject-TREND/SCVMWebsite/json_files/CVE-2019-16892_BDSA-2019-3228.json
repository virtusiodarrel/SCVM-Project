{
    "source": "BDSA",
    "name": "BDSA-2019-3228",
    "title": "Rubyzip Vulnerable to Denial-of-service (DoS) via Disk Space Exhaustion due to Missing Size Validation",
    "description": "Rubyzip is vulnerable to denial-of-service due to a lack of validation of the disk space that is required by output files. An attacker could cause a victim's system to crash by tricking them into running the application using a crafted ZIP file as input.",
    "technicalDescription": "The function `create_file()` is defined within the script `entry.rb`, and is used by RubyZip to write extracted data to disk. Whenever Ruby is extracting the contents of a ZIP file, it will attempt to validate the field within the ZIP file that specifies how large the uncompressed data file will be. This field is easily spoofed. Once the extraction process has started, there is no validation performed on the amount of data that has actually been extracted. A maliciously crafted ZIP file can lead to a  recursive extraction process that will generate output files that are extremely large. These files are known as ZIP Bombs. If an attacker can trick a user into extracting a ZIP bomb via the Rubyzip application, they can cause the victim's operating system to crash due to disk space exhaustion whenever RubyZip attempts to write the extracted data to disk.",
    "publishedDate": "2019-10-16T15:57:25.566Z",
    "updatedDate": "2019-10-16T15:57:25.556Z",
    "disclosureDate": "2019-09-12T00:00:00.000Z",
    "solution": "Fixed in version [**1.3.0**](https://github.com/rubyzip/rubyzip/releases/tag/v1.3.0) by the following commits:\n* [Commit 1](https://github.com/rubyzip/rubyzip/commit/4167f0ce67e42b082605bca75c7bdfd01eb23804)\n* [Commit 2](https://github.com/rubyzip/rubyzip/commit/7849f7362ab0cd23d5730ef8b6f2c39252da2285)\n* [Commit 3](https://github.com/rubyzip/rubyzip/commit/97cb6aefe6d12bd2429d7a2e119ccb26f259d71d)\n\nThe latest stable release can be found [here](https://github.com/rubyzip/rubyzip/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.1,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-09-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3228",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-16892",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3228/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rubyzip/rubyzip/commit/4167f0ce67e42b082605bca75c7bdfd01eb23804",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rubyzip/rubyzip/commit/7849f7362ab0cd23d5730ef8b6f2c39252da2285",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rubyzip/rubyzip/commit/97cb6aefe6d12bd2429d7a2e119ccb26f259d71d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rubyzip/rubyzip/pull/403",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rubyzip/rubyzip/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rubyzip/rubyzip/releases/tag/v1.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3228/default-remediation-status"
            }
        ]
    }
}