{
    "source": "BDSA",
    "name": "BDSA-2021-1888",
    "title": "Moodle Vulnerable to Command Injection via 'aspellPath' Parameter",
    "description": "Moodle is vulnerable to command injection via the `aspellPath` parameter. A series of crafted HTTP requests can lead to command execution. An attacker must have administrator privileges to exploit the vulnerability.\n\nThis vulnerability does not require that the spellchecker plugin is enabled",
    "technicalDescription": "Lack of validation on the  `aspellpath` parameter allows an attacker to perform backtick shell injection. To exploit this an administrator can send a crafted HTTP request which will update the system path to the legacy server-side spellcheck binary (`aspellpath`) and set `PSpellShell` as the spellchecking engine. When the client requests a server-side spellcheck `lib/editor/tinymce/plugins/spellchecker/classes/PSpellShell.php` this parameter is used to construct a `shell_exec` command.",
    "publishedDate": "2021-06-24T15:18:25.516Z",
    "updatedDate": "2022-05-10T15:39:40.597Z",
    "disclosureDate": "2021-06-22T00:00:00.000Z",
    "exploitPublishDate": "2021-06-22T00:00:00.000Z",
    "solution": "The vendor addressed this by updating their [documentation](https://docs.moodle.org/311/en/Installation) to suggest best practices after installation.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Adam Reiser (Cisco ASIG)",
    "workaround": "",
    "vendorFixDate": "2021-04-21T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-26T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1888",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21809",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1888/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.moodle.org/311/en/Installation",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2021-1277",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2021-1277",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1888/default-remediation-status"
            }
        ]
    }
}