{
    "source": "BDSA",
    "name": "BDSA-2019-2033",
    "title": "Spacewalk Vulnerable to Path Traversal via Improper Input Validation in 'X-RHN-Server-ID' Header",
    "description": "An improper input validation vulnerability has been discovered in Spacewalk. An attacker could exploit this vulnerability via path traversal techniques to access hidden directories which could lead to information exposure or be manipulated to execute arbitrary code against the system.",
    "technicalDescription": "A weakness has been discovered in Spacewalk which can be manipulated to execute path traversal attacks against the system. The `__checkAuthSessionTokenCache` function located in the file `roxy/proxy/broker/rhnBroker.py` does not sanitize the `X-RHN-Server-ID` parameter value before processing.  This can cause an issue if the `CFG.USE_LOCAL_AUTH` option is enabled by default, as the parameter is utilized directory as part of a path name. The data is passed into the function `_compute_key` located in the file `proxy/proxy/rhnProxyAuth.py`. \n\nAn attacker could exploit this vulnerability to achieve arbitrary file read, or if they have write permissions execute arbitrary code against the target system.",
    "publishedDate": "2019-07-09T09:45:24.871Z",
    "updatedDate": "2019-07-09T09:45:24.847Z",
    "disclosureDate": "2019-04-24T00:00:00.000Z",
    "exploitPublishDate": "2019-04-24T00:00:00.000Z",
    "solution": "Fixed by the following commits in the **Master** branch which are not yet included in a release:\n[commit1](https://github.com/spacewalkproject/spacewalk/commit/468a8f69c71c86af955e6767696b8cacc399c01b).\n[commit2](https://github.com/spacewalkproject/spacewalk/commit/cbbe5fbe71661fd84eec0991e55ff8f9dec4ad9e).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Malte Kraus (SUSE)",
    "workaround": "SELinux in enforcing mode will prevent the proxy to access files that have an incompatible SELinux context.",
    "vendorFixDate": "2019-06-12T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2033",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10137",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2033/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10137",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10137",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spacewalkproject/spacewalk/commit/468a8f69c71c86af955e6767696b8cacc399c01b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spacewalkproject/spacewalk/commit/cbbe5fbe71661fd84eec0991e55ff8f9dec4ad9e",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2033/default-remediation-status"
            }
        ]
    }
}