{
    "source": "BDSA",
    "name": "BDSA-2021-1757",
    "title": "Zephyr L2CAP Implementation Vulnerable to Information Disclosure via L2CAP_CREDIT_BASED_CONNECTION_REQ",
    "description": "Synopsys Cybersecurity Research Center (CyRC) has discovered a vulnerability in zephyr's L2CAP Implementation that can lead to the leaking of information from memory.  An attacker can trigger this vulnerability by sending crafted `L2CAP_CREDIT_BASED_CONNECTION_REQ` PDUs to the target device.\n\nTriggering this vulnerability does not require authentication or encryption. The only requirement is that the device is in advertising mode and accepting connections, and that the attacker is within range of the Bluetooth device.",
    "technicalDescription": "This vulnerability occurs in  `le_ecred_conn_req()` function in `subsys/bluetooth/host/l2cap.c`  where no check is carried out on buffer size. Up to 6 bytes of unitialized memory can be accessed by sending a single malformed `L2CAP_CREDIT_BASED_CONNECTION_REQ` connection request. The request can be repeated for further data leading to the exposure of confidential information such as encryption keys or information about memory layout which can be leveraged to carry out further attacks.\n\nAn attacker can send a very small connection request that results in unitialised memory contents to be returned.",
    "publishedDate": "2021-06-22T15:51:30.317Z",
    "updatedDate": "2021-06-22T15:51:30.311Z",
    "disclosureDate": "2021-06-12T00:00:00.000Z",
    "solution": "Fixed in [**2.6.0-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.6.0-rc1) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/168389cccda30fc70605bc6a9fc8b498168ba197) commit.\nFix backported to [**2.4-branch**](https://github.com/zephyrproject-rtos/zephyr/tree/v2.4-branch) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/de142e438de543692ca7ece7285d6c9a363d072d) commit.\nFix backported to [**2.5-branch**](https://github.com/zephyrproject-rtos/zephyr/tree/v2.5-branch) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/56c712d2ca823f0780b609cc6b8315c092a7c63e) commit.\nThe most recent release can be found [here](https://www.zephyrproject.org/developer-resources/#current-release).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:A/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matias Karhumaa  (Synopsys Cybersecurity Research Center  (CyRC))",
    "workaround": "",
    "vendorFixDate": "2021-03-17T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1757",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-131"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3435",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1757/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/168389cccda30fc70605bc6a9fc8b498168ba197",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/56c712d2ca823f0780b609cc6b8315c092a7c63e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/de142e438de543692ca7ece7285d6c9a363d072d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/pull/33305",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.6.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/policy",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v2.4-branch",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v2.5-branch",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synopsys.com/blogs/software-security/cyrc-advisory-zephyr-vulnerability/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.zephyrproject.org/developer-resources/#current",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-137",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1757/default-remediation-status"
            }
        ]
    }
}