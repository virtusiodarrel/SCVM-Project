{
    "source": "BDSA",
    "name": "BDSA-2021-3229",
    "title": "Keypair Vulnerable to Cryptanalytic Attacks via Insecure Random Number Generation",
    "description": "Keypair contains a bug in the psudo-random number generator that may allow cryptanalytic attacks. This bug can cause Keypair to create cryptographically weak RSA keys. Depending on how Keypair is used, successful attacks may lead to an attacker decrypting information or possibly gaining access to systems.",
    "technicalDescription": "The bug in the random number generation occurs in `prng.create = function(plugin)`  within `index.js`. The bug is where the function `putByte`is called with `String.fromCharCode` as the supplied parameter, which contains a mask value of `0xFF`.   This results in each byte of the RNG seed having a 97% chance of being a zero value.",
    "publishedDate": "2021-10-26T18:24:16.050Z",
    "updatedDate": "2021-10-26T18:24:16.027Z",
    "disclosureDate": "2021-10-11T00:00:00.000Z",
    "solution": "Fixed in version [**1.0.4**](https://github.com/juliangruber/keypair/releases/tag/v1.0.4) by [this](https://github.com/juliangruber/keypair/commit/9596418d3363d3e757676c0b6a8f2d35a9d1cb18) commit.\n\nThe latest stable releases can be found [here](https://github.com/juliangruber/keypair/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-10-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3229",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-330"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-338"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41117",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3229/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/juliangruber/keypair/commit/9596418d3363d3e757676c0b6a8f2d35a9d1cb18",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/juliangruber/keypair/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/juliangruber/keypair/releases/tag/v1.0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/juliangruber/keypair/security/advisories/GHSA-3f99-hvg4-qjwj",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://securitylab.github.com/advisories/GHSL-2021-1012-keypair/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3229/default-remediation-status"
            }
        ]
    }
}