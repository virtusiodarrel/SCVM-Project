{
    "source": "BDSA",
    "name": "BDSA-2021-2946",
    "title": "Redis Vulnerable to Remote Code Execution (RCE) via Heap-Based Overflow with Crafted Lua Scripts",
    "description": "Redis is vulnerable to remote code execution (RCE) due to the improper processing of Lua scripts. An attacker could exploit this vulnerability by supplying a system with maliciously crafted input.",
    "technicalDescription": "The issue exists within the file `src/scripting.c`. When processing Lua scripts there are multiple missing checks of the Lua stack size before elements are pushed. This could allow deeply nested replies, or commands with large numbers of arguments to cause an overflow of the heap-based stack.",
    "publishedDate": "2021-10-05T15:11:14.148Z",
    "updatedDate": "2022-08-26T09:33:53.195Z",
    "disclosureDate": "2021-10-04T00:00:00.000Z",
    "solution": "Fixed in:\n* [**6.2.6**](https://github.com/redis/redis/releases/tag/6.2.6) by [this](https://github.com/redis/redis/commit/8f241ab3b) commit,\n* [**6.0.16**](https://github.com/redis/redis/releases/tag/6.0.16) by [this](https://github.com/redis/redis/commit/666ed7facf4524bf6d19b11b20faa2cf93fdf591) commit,\n* [**5.0.14**](https://github.com/redis/redis/releases/tag/5.0.14) by [this](https://github.com/redis/redis/commit/a4b813d8b) commit.\n\nThe latest stable releases are available [here](https://redis.io/download).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Meir Shpilraien",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, the vendor recommends to prevent users from executing Lua scripts. This can be done using ACL to restrict `EVAL` and `EVALSHA` commands.",
    "vendorFixDate": "2021-10-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2946",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32626",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2946/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/666ed7facf4524bf6d19b11b20faa2cf93fdf591",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/8f241ab3b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/a4b813d8b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/5.0.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/6.0.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/6.2.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/security/advisories/GHSA-p486-xggp-782c",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/security/advisories/GHSA-p486-xggp-782c",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://redis.io/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2946/default-remediation-status"
            }
        ]
    }
}