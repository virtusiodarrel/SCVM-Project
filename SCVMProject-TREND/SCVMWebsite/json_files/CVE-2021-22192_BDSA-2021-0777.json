{
    "source": "BDSA",
    "name": "BDSA-2021-0777",
    "title": "GitLab Vulnerable to Remote Code Execution (RCE) via Unsafe User-Controlled Markdown Rendering Options for Wikis",
    "description": "GitLab is vulnerable to remote code execution (RCE) via unsafe user-controlled markdown rendering options. Successful exploitation of this issue could allow authenticated attackers to execute arbitrary code on the server.",
    "technicalDescription": "GitLab is vulnerable to a remote code execution (RCE) issue because the wiki content rendering functionality can unsafely render files with certain extensions such as `.rmd`. Files of such a type can be uploaded by checking out the wiki with git, committing the files and pushing the changes back.\n\nThe Kramdown markdown parser that is used to render such files can allow for options to be set inline, meaning an attacker with push access to a wiki could upload Ruby files, use dangerous classes and execute malicious Ruby code on the server.",
    "publishedDate": "2021-03-25T14:01:16.842Z",
    "updatedDate": "2021-06-21T15:43:05.753Z",
    "disclosureDate": "2021-03-17T00:00:00.000Z",
    "exploitPublishDate": "2021-04-20T00:00:00.000Z",
    "solution": "Fixed in:\n[**13.9.4**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.9.4),\n[**13.8.6**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.8.6),\n[**13.7.9**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.7.9).\n\nThe latest stable releases are available [here](https://gitlab.com/gitlab-org/gitlab-foss/-/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "William Bowling (vakzz)",
    "workaround": "",
    "vendorFixDate": "2021-03-17T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0777",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22192",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0777/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2021/03/17/security-release-gitlab-13-9-4-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.7.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.8.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.9.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/issues/324452",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1125425",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1125425",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/162950/gitlab1393-exec.txt",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0777/default-remediation-status"
            }
        ]
    }
}