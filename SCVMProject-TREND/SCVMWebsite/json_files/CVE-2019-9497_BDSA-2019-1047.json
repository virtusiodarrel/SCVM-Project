{
    "source": "BDSA",
    "name": "BDSA-2019-1047",
    "title": "wpa_supplicant Vulnerable to Reflection Attacks via Improper Authentication in 'EAP-PWD' Method Validation",
    "description": "An improper authentication vulnerability has been discovered in wpa_supplicant utilized by the WPA3 protocol. An attacker could exploit this vulnerability to execute reflection attacks against the target network.",
    "technicalDescription": "A weakness in the WPA3 protocol design could lead to reflection attacks against the system. WPA3 utilizes a key agreement method called simultaneous authentication of equals (SAE) which is a variant of the Dragonfly Key Exchange. The attack works by first initiating a connection to the target. The target attempts to authenticate the attacker by sending a challenge. The attacker opens up a second connection to the target, using the challenge they just obtained as their own challenge. The result that the server sent back can be sent as the response of the initial challenge. This is due to the same protocol being used on both sides of the authentication mechanism.\n\nIt was discovered the extensible authentication protocol (EAP) utilized by `wpa_supplicant` contained insufficient verification. The EAP server did not verify that the scalar or elliptic curve element values from a received COMMIT frame were different from those original values sent by the server. This could cause the EAP-PWD authentication method to be completed without knowledge of the utilized password, but still prevent the RSN/WPA 4-way handshake.  \n\nThe `eap_pwd_process_commit_resp` function located in the file `src/eap_server/eap_server_pwd.c` did not implement processes to prevent against reflection attacks.",
    "publishedDate": "2019-04-15T14:04:32.417Z",
    "updatedDate": "2019-04-15T14:04:32.373Z",
    "disclosureDate": "2019-04-10T00:00:00.000Z",
    "solution": "Fixed by [this](https://w1.fi/cgit/hostap/commit/?id=d63edfa90243e9a7de6ae5c275032f2cc79fef95) commit in the Master branch which is not yet included in a release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mathy Vanhoef (NYUAD)",
    "workaround": "",
    "vendorFixDate": "2019-03-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1047",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-301"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9497",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1047/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1699164",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=d63edfa90243e9a7de6ae5c275032f2cc79fef95",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/security/2019-4/eap-pwd-missing-commit-validation.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://wpa3.mathyvanhoef.com/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1047/default-remediation-status"
            }
        ]
    }
}