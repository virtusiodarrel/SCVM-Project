{
    "source": "BDSA",
    "name": "BDSA-2019-2333",
    "title": "Android System Security Vulnerable to Information Disclosure via Improper Locking in 'key_store_service.cpp' File",
    "description": "Android System Security contains an information disclosure vulnerability due to improper locking. A local attacker could exploit this to disclose sensitive information. No user interaction is required.",
    "technicalDescription": "This exists in multiple functions of the `key_store_service.cpp` file. It was previously assumed that the keystore service was single threaded. However with the WiFi keystore service, this assumption does not hold, leading to the hwbinder service thread making multiple functions calls to keystore concurrently. A local attacker could exploit this to disclose sensitive information from keystore. \n\nIt was addressed by adding a new `recursive_mutex` class called `keystoreServiceMutex_` to lock keystore operations from being simultaneously accessed by multiple threads. This ensures that all dispatcher executions are serialized, even though they are called from both the binder and hwbinder service threads.",
    "publishedDate": "2019-07-26T14:49:01.919Z",
    "updatedDate": "2019-07-26T14:49:01.908Z",
    "disclosureDate": "2019-07-02T00:00:00.000Z",
    "solution": "Fixed in [**9.0.0-r43**](https://android.googlesource.com/platform/system/security/+/refs/tags/android-9.0.0_r43) by [this](https://android.googlesource.com/platform/system/security/+/12370c8b5ee9e80c548ff5294790bafd2363cde0) commit.\n\nFixed in **8.0.0** and **8.1.0** via over-the-air updates. The patches are not publicly available.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-05-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2333",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-667"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-2119",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2333/ranges"
            },
            {
                "rel": "reference",
                "href": "https://android.googlesource.com/platform/system/security/+/12370c8b5ee9e80c548ff5294790bafd2363cde0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://android.googlesource.com/platform/system/security/+/refs/tags/android-9.0.0_r43",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://source.android.com/security/bulletin/2019-07-01",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2333/default-remediation-status"
            }
        ]
    }
}