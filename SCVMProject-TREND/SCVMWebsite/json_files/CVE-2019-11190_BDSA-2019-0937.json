{
    "source": "BDSA",
    "name": "BDSA-2019-0937",
    "title": "Linux Kernel Vulnerable to SUID Binary ASLR Bypass via install_exec_creds() Race in 'load_elf_binary()'",
    "description": "A local attacker is able to leak sensitive data from a SUID binary by racing specially crafted ptrace system calls or proc filesystem reads.  This could allow the attacker to bypass ASLR, enabling further exploitation of the SUID application.",
    "technicalDescription": "The function `install_exec_creds()` is called after an executable is mapped into it's address space in `load_elf_binary()`.  This opens up a race where `ptrace_may_access()` will pass during an early read to `/proc/pid/stat`, for example.  This allows an attacker to leak sensitive memory layout details from the executable.  This information can bypass ASLR, allowing the attacker further easier exploitation with another vulnerability. \n\nThis has been fixed for the elf binary format, however other binary formats remain vulnerable.",
    "publishedDate": "2019-04-05T12:57:46.498Z",
    "updatedDate": "2019-05-14T08:45:30.392Z",
    "disclosureDate": "2019-04-03T00:00:00.000Z",
    "exploitPublishDate": "2019-04-03T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.16.66**](https://www.kernel.org)\n* [**3.18.139**](https://www.kernel.org)\n* [**4.4.179**](https://www.kernel.org)\n* [**4.8-rc5**](https://www.kernel.org)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9f834ec18defc369d73ccf9e87a2790bfa05bf46) git commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.7
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2016-08-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0937",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-689"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11190",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0937/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=807",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9f834ec18defc369d73ccf9e87a2790bfa05bf46",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q2/9",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q2/9",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0937/default-remediation-status"
            }
        ]
    }
}