{
    "source": "BDSA",
    "name": "BDSA-2022-2113",
    "title": "SDL 1.2 Vulnerable to Memory Corruption via Use-After-Free in Function 'X11_CreateYUVOverlay()'",
    "description": "SDL 1.2 series contains a use-after-free flaw in the handling of certain overlay creation. An attacker able to exercise the X11 YUV overlay creation functionality, could potentially leverage this flaw to cause incorrect image width calculations that could result in unspecified impacts.",
    "technicalDescription": "The issue occurs in the `X11_CreateYUVOverlay()` function of file `src/video/x11/SDL_x11yuv.c`. If the compile time defined `PITCH_WORKAROUND` configuration option is enabled,  `hwdata->image` is free'd immediately before it is dereferenced to obtain `hwdata->image->pitches[0]` data for a width calculation. The free'd memory area could have been re-allocated by another thread of the application and contain data which might alter the intended output of the program through an incorrect image width. The potential memory corruption in this particular case has a very narrow race window and the impacts are likely benign.",
    "publishedDate": "2022-07-29T10:18:58.017Z",
    "updatedDate": "2022-09-27T13:30:06.522Z",
    "disclosureDate": "2022-06-18T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/libsdl-org/SDL-1.2/commit/d7e00208738a0bc6af302723fe64908ac35b777b) commit which is not yet included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.6,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-07-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2113",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-34568",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2113/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libsdl-org/SDL-1.2/commit/d7e00208738a0bc6af302723fe64908ac35b777b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libsdl-org/SDL-1.2/issues/863",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2113/default-remediation-status"
            }
        ]
    }
}