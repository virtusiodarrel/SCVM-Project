{
    "source": "BDSA",
    "name": "BDSA-2020-0931",
    "title": "Samba Vulnerable to Denial-of-Service (DoS) via Use After Free with Paged Results LDAP Feature",
    "description": "Samba is vulnerable to denial-of-service (DoS) due to improper implementation of controls with the paged results LDAP feature. An attacker could exploit this vulnerability by supplying a system with maliciously crafted queries.",
    "technicalDescription": "Samba does not properly implement a control in the paged results LDAP feature which is designed to prevent DoS attacks from large numbers of client requests. This can result in a use after free condition if an attacker can supply maliciously crafted queries using the ASQ control. Successful exploitation depends on the chain of child and grandchild links being queried, and an attacker will have to find an exploitable chain in the existing directory layout if they do not have write access.",
    "publishedDate": "2020-04-30T08:54:26.772Z",
    "updatedDate": "2020-04-30T08:54:26.766Z",
    "disclosureDate": "2020-04-28T00:00:00.000Z",
    "solution": "Fixed in:\n* **[4.12.2](https://github.com/samba-team/samba/releases/tag/samba-4.12.2)**\n* **[4.11.8](https://github.com/samba-team/samba/releases/tag/samba-4.11.8)**\n* **[4.10.15](https://github.com/samba-team/samba/releases/tag/samba-4.10.15)**\n\nFixed by these commits:\n* [Commit 1](https://github.com/samba-team/samba/commit/b824444544f8b970ed93c914cb96de3b54c6e282)\n* [Commit 2](https://github.com/samba-team/samba/commit/fb3e51020ab589cf76306b36548eda8a2de8f6ce)\n* [Commit 3](https://github.com/samba-team/samba/commit/8e597aa1b9b1fa3483250907579ec4a9dea3c4c9)\n* [Commit 4](https://github.com/samba-team/samba/commit/fecb05c8980100e32ab5812cc97d15edd5b83b50)\n\nThe latest stable releases are available [here](https://www.samba.org/samba/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrei Popa",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, patches for **4.12.1**, **4.11.7** and **4.10.14** are available [here](https://www.samba.org/samba/history/security.html).",
    "vendorFixDate": "2020-04-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0931",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10700",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0931/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.samba.org/show_bug.cgi?id=14331",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/8e597aa1b9b1fa3483250907579ec4a9dea3c4c9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/b824444544f8b970ed93c914cb96de3b54c6e282",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/fb3e51020ab589cf76306b36548eda8a2de8f6ce",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/fecb05c8980100e32ab5812cc97d15edd5b83b50",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.10.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.11.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.12.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/security/CVE-2020-10700.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/security/CVE-2020-10700.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0931/default-remediation-status"
            }
        ]
    }
}