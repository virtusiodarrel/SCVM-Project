{
    "source": "BDSA",
    "name": "BDSA-2020-0902",
    "title": "Squid Vulnerable to Cache Poisoning via 'userInfo' URL Decoding",
    "description": "Squid is vulnerable to cache poisoning. An attacker could send a crafted request within one domain that will be recorded in the cache as a different domain. When an unsuspecting user requests for that domain, the poisoned cache entry will be served, meaning that the attacker's malicious HTML will be shown instead of the original one.",
    "technicalDescription": "The issue exists due to decoded `userInfo` being appended to URLs so that the request could be considered for caching. `userInfo` may contain special characters, such as `/`(`%2F`) or `?`(`%3F`), which means that their decoding can be used to trick Squid into perceiving the request as coming from a different domain. For example, `https://squid-cache.org%2F%3F@192.168.1.23:8080/` would be decoded as `https://squid-cache.org/?@192.168.1.23:8080`, which results in a poisoned cache for the latter domain. \n\nThe vendor warns that this vulnerability can also be leveraged to access code paths that were originally unreachable by a user of the Squid server, such as the Edge Side Includes (ESI) code base for reverse proxy servers.\n\nNote that Squid versions **4.x** up to and including **4.7** without HTTPS support are not vulnerable.",
    "publishedDate": "2020-04-27T13:34:35.256Z",
    "updatedDate": "2021-11-05T10:56:50.004Z",
    "disclosureDate": "2020-04-14T00:00:00.000Z",
    "exploitPublishDate": "2020-04-14T00:00:00.000Z",
    "solution": "Fixed in:\n* **[4.8](https://github.com/squid-cache/squid/releases/tag/SQUID_4_8)** by [this](https://github.com/squid-cache/squid/commit/e1e861eb9) and [this](https://github.com/squid-cache/squid/commit/2d3a615ea) commit\n* **[5.0.1](https://github.com/squid-cache/squid/releases/tag/SQUID_5_0_1)** by [this](https://github.com/squid-cache/squid/commit/196c524a6) and [this](https://github.com/squid-cache/squid/commit/0d0f51610) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.6,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jeriko One",
    "workaround": "While there is no workaround for **3.5.x** versions, this vulnerability can be mitigated in **4.x** by building with `--without-openssl --without-gnutls` options.",
    "vendorFixDate": "2019-06-23T00:00:00.000Z",
    "vendorNotifiedDate": "2019-03-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0902",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-177"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12520",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0902/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Advisories/SQUID-2019_4.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Advisories/SQUID-2019_4.txt",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/0d0f51610",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/196c524a6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/2d3a615ea",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/e1e861eb9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/releases/tag/SQUID_4_8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/releases/tag/SQUID_5_0_1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/jeriko.one/security/-/blob/master/squid/CVEs/CVE-2019-12520.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/jeriko.one/security/-/blob/master/squid/CVEs/CVE-2019-12520.txt",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/824753",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0902/default-remediation-status"
            }
        ]
    }
}