{
    "source": "BDSA",
    "name": "BDSA-2022-0614",
    "title": "xrdp Vulnerable to Privilege Escalation and Denial-of-Service (DoS) via Integer Underflow in 'sesman_data_in()' Function",
    "description": "xrdp is vulnerable to privilege escalation and denial-of-service (DoS) due to the mismanagement of system memory resources leading to an integer underflow. An attacker could perform local code execution. Remote code execution may be possible if the sesman servers are configured in a way that they can be accessed remotely.",
    "technicalDescription": "The vulnerability exists in the file `sesman.c` within the `sesman_data_in()` function. This function does not have sufficient lower bounds checks for input which could cause an integer underflow by allowing a negative integer as input leading to a heap-based overflow. An attacker could exploit this vulnerability on the sesman servers to execute code as the `root` user.\n\nThis has been mitigated by implementing lower bounds checks to the input in the code `size < HEADER_SIZE || size > self->in_s->size`. This ensures that `size` is not less than the `HEADER_SIZE` variable (that has been initiated to a fixed length of 8 bytes) or the `size` variable is not greater than `self->in_s->size`.",
    "publishedDate": "2022-03-10T14:14:11.979Z",
    "updatedDate": "2022-09-05T10:52:54.887Z",
    "disclosureDate": "2022-02-07T00:00:00.000Z",
    "solution": "Fixed in version [**0.9.18.1**](https://github.com/neutrinolabs/xrdp/releases/tag/v0.9.18.1) by [this](https://github.com/neutrinolabs/xrdp/commit/7e6194504e2b3c9708f28b30a890b498c22b3091) commit.\n\nThe latest stable releases can be found [here](https://github.com/neutrinolabs/xrdp/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 9.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "(AV:N/AC:L/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Gilad Kleinman",
    "workaround": "",
    "vendorFixDate": "2022-02-07T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0614",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-191"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23613",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0614/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/neutrinolabs/xrdp/commit/7e6194504e2b3c9708f28b30a890b498c22b3091",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/neutrinolabs/xrdp/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/neutrinolabs/xrdp/releases/tag/v0.9.18.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/neutrinolabs/xrdp/security/advisories/GHSA-8h98-h426-xf32",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0614/default-remediation-status"
            }
        ]
    }
}