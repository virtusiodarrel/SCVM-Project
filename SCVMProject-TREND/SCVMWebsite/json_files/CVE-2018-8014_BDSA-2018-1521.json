{
    "source": "BDSA",
    "name": "BDSA-2018-1521",
    "title": "Apache Tomcat Insecure Default Configuration of Cross-Origin Resource Sharing Filter",
    "description": "Apache Tomcat contains a default configuration vulnerability where the cross-origin resource sharing (*CORS*) filter is insecure. The setting has `supportsCredentials` enabled by default. An attacker could exploit this to bypass this security restriction and could result in cross-origin attacks.",
    "technicalDescription": "There exists a insecure setting within Apache Tomcat due to the way the cross-origin resource sharing (*CORS*) filter is configured. The setting has `supportsCredentials` enabled by default. The CORS policy is configured to `Origin:*` and `Credentials:true`, meaning it will reflect any `Origin` header value. This can result in loose permissions. The wildcard `*` value means that any domain is allowed. An attacker is able to exploit this vulnerability to bypass the CORS security protocol.\n\nUsers who have properly configured it for their environment and not using the default configuration are not impacted by this vulnerability.",
    "publishedDate": "2018-05-23T12:54:17.079Z",
    "updatedDate": "2020-10-07T15:34:08.401Z",
    "disclosureDate": "2018-05-15T00:00:00.000Z",
    "solution": "* Fixed in [**9.0.9**](https://archive.apache.org/dist/tomcat/tomcat-9/) by [this](https://svn.apache.org/viewvc?view=revision&revision=1831726) commit.\n* Fixed in [**8.5.32**](https://archive.apache.org/dist/tomcat/tomcat-8/) by [this](http://svn.apache.org/viewvc?view=revision&revision=1831728) commit.\n* Fixed in [**8.0.53**](https://archive.apache.org/dist/tomcat/tomcat-8/) by [this](http://svn.apache.org/viewvc?view=revision&revision=1831729) commit.\n* Fixed in [**7.0.89**](https://archive.apache.org/dist/tomcat/tomcat-7/) by [this](http://svn.apache.org/viewvc?view=revision&revision=1831730) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "If a user configures both `Origin:*` and `Credentials: true` ,  display a warning that this is a misconfiguration, instead of return any `Origin` header value.",
    "vendorFixDate": "2018-05-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-1521",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-16"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2018-8014",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-1521/ranges"
            },
            {
                "rel": "reference",
                "href": "http://tomcat.apache.org/security-7.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://tomcat.apache.org/security-8.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://tomcat.apache.org/security-9.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://archive.apache.org/dist/tomcat/tomcat-7/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://archive.apache.org/dist/tomcat/tomcat-8/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://archive.apache.org/dist/tomcat/tomcat-9/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://bz.apache.org/bugzilla/show_bug.cgi?id=62343",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://svn.apache.org/viewvc?view=revision&revision=1831726",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svn.apache.org/viewvc?view=revision&revision=1831728",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svn.apache.org/viewvc?view=revision&revision=1831729",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svn.apache.org/viewvc?view=revision&revision=1831730",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-1521/default-remediation-status"
            }
        ]
    }
}