{
    "source": "BDSA",
    "name": "BDSA-2021-1315",
    "title": "Keycloak Vulnerable to Information Exposure via Directory Creation",
    "description": "It was discovered that Keycloak contains a flaw relating to creation of directories in advance of the Java process creating them in the temporary directory. This results in wiser user permissions which could allow an attacker to access the contents of the directory resulting in confidentiality and integrity issues.",
    "technicalDescription": "This issue occurs in multiple files due to how the temp directory operates. It was mitigated by a number of fixed which moves the temp directory inside the `auth-server` home directory. This includes robust checks within the `addDeferredException()` folder of the `keycloak/provider/quarkus/QuarkusPlatform.java ` file.",
    "publishedDate": "2021-05-13T10:11:12.976Z",
    "updatedDate": "2021-05-13T10:11:12.963Z",
    "disclosureDate": "2021-03-16T00:00:00.000Z",
    "solution": "Fixed in [**13.0.0**](https://github.com/keycloak/keycloak/releases/tag/13.0.0) by [this](https://github.com/keycloak/keycloak/commit/853a6d73276849877819f2dc23133557f6e1e601) commit.\n\nThe latest stable releases are available [here](https://github.com/keycloak/keycloak/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jonathan Leitschuh",
    "workaround": "The Vendor has proposed the following workaround : \n\"\nBy switching to the `Files` API, you are allowed to exclusively set the file permissions when creating directories or creating temporary directories.\n\"",
    "vendorFixDate": "2021-03-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1315",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-377"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20202",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1315/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/cve-2021-20202",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/cve-2021-20202",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1922128",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/853a6d73276849877819f2dc23133557f6e1e601",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases/tag/13.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1315/default-remediation-status"
            }
        ]
    }
}