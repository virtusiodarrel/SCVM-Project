{
    "source": "BDSA",
    "name": "BDSA-2021-2873",
    "title": "Arborist Vulnerable to Arbitrary File Writes via Improper Dependency Handling",
    "description": "Arborist is vulnerable to arbitrary file writes due to the unsafe handling of dependency specifiers. An attacker could  write data to arbitrary locations on the file system by tricking a victim into installing a malicious package.\n\nIt should be noted that this issue can only be exploited on case-insensitive file systems.",
    "technicalDescription": "Arborist is capable of resolving dependency specifiers that are contained in `package.json` manifests. This process involves using the dependency specifiers to derive values for the `children` member of the `Node` class, which is defined within the file `lib/node.js`. This member is a case sensitive `Map` instance. As a consequence of this case sensitivity, dependency names that only differ in terms of case will be treated as separate dependencies. However, if the underlying file system is case insensitive, then the files associated with the separate dependencies may end up being written to the same file system location. An attacker could leverage this issue in order to use symlinks on the file system in order to write files to arbitrary locations. The attacker could try to leverage a symlink that already exists, or try to create one (e.g. via an installation hook).\n\nThe vulnerability was fixed by changing `children` to be an instance of `CaseInsensitiveMap()` and including additional dependency name validation logic.",
    "publishedDate": "2021-09-28T15:04:35.591Z",
    "updatedDate": "2021-09-28T15:04:35.581Z",
    "disclosureDate": "2021-08-31T00:00:00.000Z",
    "exploitPublishDate": "2021-08-31T00:00:00.000Z",
    "solution": "Fixed in version [**2.8.2**](https://github.com/npm/arborist/releases/tag/v2.8.2) by [this](https://github.com/npm/arborist/commit/cddfe03467ce1db3a8ac92ed8a334f905e8661ba) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/@npmcli/arborist).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.9,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:L/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Robert Chen",
    "workaround": "",
    "vendorFixDate": "2021-08-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2873",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-61"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39134",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2873/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/arborist/commit/cddfe03467ce1db3a8ac92ed8a334f905e8661ba",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/arborist/releases/tag/v2.8.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/arborist/security/advisories/GHSA-2h3h-q99f-3fhc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/arborist/security/advisories/GHSA-2h3h-q99f-3fhc",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/@npmcli/arborist",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2873/default-remediation-status"
            }
        ]
    }
}