{
    "source": "BDSA",
    "name": "BDSA-2019-1805",
    "title": "Linux Kernel Vulnerable to Remote Denial-of-Service via Specially Crafted Sequence of SACK Segments on TCP Connection",
    "description": "The Linux kernel is vulnerable to a remote assertion failure with a specially crafted sequence of SACK segments on a TCP connection.  A remote attacker could leverage this flaw to crash the system, resulting in a denial-of-service (DoS).",
    "technicalDescription": "There is a reachable assertion (`BUG_ON(tcp_skb_pcount(skb) < pcount)`) in `tcp_shifted_skb()` in the `net/ipv4/tcp_input.c` file.  This can occur because there is a u16 sized integer overflow of `TCP_SKB_CB(skb)->tcp_gso_segs` when the number of segments exceed the 16bit width.  \n\nA remote attacker would exploit this by advertising the smallest MSS that Linux TCP accepts, 48.  This vulnerability can only be exploited if a TCP port is listening on the host system with TCP SACK enabled (the default).",
    "publishedDate": "2019-06-18T09:29:40.974Z",
    "updatedDate": "2019-06-18T09:29:40.967Z",
    "disclosureDate": "2019-06-15T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**4.4.182**](https://www.kernel.org)\n* [**4.9.182**](https://www.kernel.org)\n* [**4.14.127**](https://www.kernel.org)\n* [**4.19.52**](https://www.kernel.org)\n* [**5.1.11**](https://www.kernel.org)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4657ee0fe05e15ab572b157f13a82e080d4b7d73) git commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.8,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jonathan Looney (Netflix Information Security)",
    "workaround": "1) Block connections with a low MSS using network filters.\n2) Disable SACK processing (/proc/sys/net/ipv4/tcp_sack set to 0).",
    "vendorFixDate": "2019-06-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1805",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-617"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11477",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1805/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4657ee0fe05e15ab572b157f13a82e080d4b7d73",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q2/182",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1805/default-remediation-status"
            }
        ]
    }
}