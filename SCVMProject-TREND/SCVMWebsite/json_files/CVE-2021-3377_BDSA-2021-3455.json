{
    "source": "BDSA",
    "name": "BDSA-2021-3455",
    "title": "ansi_up Vulnerable to Cross-Site Scripting (XSS) via Insufficient URL Sanitization",
    "description": "ansi_up is vulnerable to cross-site scripting (XSS) due to the insufficient sanitization of URL content that are generated from ANSI escape codes. A remote attacker than can trick a victim into interacting with crafted web content could execute malicious JavaScript within the browser of that victim. This could potentially allow the attacker to obtain sensitive information, such as browser cookies.",
    "technicalDescription": "The `process_hyperlink()` function, of file `ansi_up.ts`, is use by ansi_up in order to generate URLs from content that contains ANSI escape codes. Although this function does perform some sanitization (via the `escape_txt_for_html()` function), it does not handle certain problematic characters, such as backslashes and double quotes. The sanitization process can therefore be bypassed, which can lead to the generation of URLs which contain malicious JavaScript payloads. An attacker could potentially leverage this issue in order to carry out XSS attacks.",
    "publishedDate": "2021-11-16T10:25:51.552Z",
    "updatedDate": "2021-11-16T10:25:51.536Z",
    "disclosureDate": "2021-02-01T00:00:00.000Z",
    "exploitPublishDate": "2021-02-01T00:00:00.000Z",
    "solution": "Fixed in version [**5.0.0**](https://github.com/drudru/ansi_up/releases/tag/v5.0.0) by [this](https://github.com/drudru/ansi_up/commit/c8c726ed1db979bae4f257b7fa41775155ba2e27) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/ansi_up).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ben Caller (Doyensec)",
    "workaround": "",
    "vendorFixDate": "2021-01-29T00:00:00.000Z",
    "vendorNotifiedDate": "2020-12-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3455",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3377",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3455/ranges"
            },
            {
                "rel": "reference",
                "href": "https://doyensec.com/resources/Doyensec_Advisory_ansi_up4_XSS.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://doyensec.com/resources/Doyensec_Advisory_ansi_up4_XSS.pdf",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drudru/ansi_up/commit/c8c726ed1db979bae4f257b7fa41775155ba2e27",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drudru/ansi_up/releases/tag/v5.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/ansi_up",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3455/default-remediation-status"
            }
        ]
    }
}