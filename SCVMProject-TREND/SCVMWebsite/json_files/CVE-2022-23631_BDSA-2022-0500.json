{
    "source": "BDSA",
    "name": "BDSA-2022-0500",
    "title": "Node.js 'superjson' Package Vulnerable to Remote Code Execution (RCE) via Prototype Pollution",
    "description": "SuperJSON is vulnerable to a prototype pollution issue that, if exploited, could lead to remote code execution (RCE). This issue also impacts Blitz.js servers that use vulnerable versions of SuperJSON.",
    "technicalDescription": "SuperJSON is vulnerable to remote code execution (RCE) because user input is not sufficiently sanitized before attempting to set properties in the target object. On servers using SuperJSON input, an attacker could gain control without prior authentication or knowledge by submitting a crafted input containing a malicious key.\n\n**Note**: The vendor has stated [here](https://github.com/blitz-js/superjson/security/advisories/GHSA-5888-ffcr-r425) that the only requirement is that the target server implements at least one endpoint which uses SuperJSON during request processing. In the case of Blitz.js, it would be at least one RPC call.",
    "publishedDate": "2022-02-21T12:43:41.091Z",
    "updatedDate": "2022-08-22T13:54:55.220Z",
    "disclosureDate": "2022-02-09T00:00:00.000Z",
    "solution": "Fixed in SuperJSON version [**1.8.1**](https://github.com/blitz-js/superjson/releases/tag/v1.8.1) by [this](https://github.com/blitz-js/superjson/commit/0d68cd51a430999b848f6da7af528ee02560c883) commit.\n\nFixed in Blitz version [**0.45.3**](https://github.com/blitz-js/blitz/releases/tag/v0.45.3) by [this](https://github.com/blitz-js/blitz/commit/0f8f15f31c2fdddbb43d7427a2ad5ad2a7a41f2e) commit.\n\nThe latest stable releases of superjson are available [here](https://www.npmjs.com/package/superjson), and the latest stable releases of Blitz are available [here](https://www.npmjs.com/package/blitz).\n\n**Note**: If you are unable to upgrade to Blitz.js **0.45.3** in a timely manner, you can instead upgrade only SuperJSON to version **1.8.1** using yarn resolutions or similar. Blitz versions < **0.45.3** are only affected because they used SuperJSON versions < **1.8.1**.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Paul Gerste",
    "workaround": "",
    "vendorFixDate": "2022-02-09T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0500",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-471"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23631",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0500/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/blitz-js/blitz/commit/0f8f15f31c2fdddbb43d7427a2ad5ad2a7a41f2e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/blitz-js/blitz/pull/3162",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/blitz-js/blitz/releases/tag/v0.45.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/blitz-js/superjson/commit/0d68cd51a430999b848f6da7af528ee02560c883",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/blitz-js/superjson/releases/tag/v1.8.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/blitz-js/superjson/security/advisories/GHSA-5888-ffcr-r425",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/blitz",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/superjson",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0500/default-remediation-status"
            }
        ]
    }
}