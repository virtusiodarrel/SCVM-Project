{
    "source": "BDSA",
    "name": "BDSA-2019-2771",
    "title": "Ghostscript Vulnerable to Arbitrary Code Execution via 'setsystemparams()' Function",
    "description": "Ghostscript is vulnerable to arbitrary code execution and authorization bypass, due to the exposure of an unsafe function. An attacker could execute arbitrary commands on the underlying operating system, or access areas of the file system that are supposed to be restricted, by tricking a victim into running the program using a crafted script as input.",
    "technicalDescription": "Ghostscript uses 'Safer Mode' in order to restrict the files that are accessible to the application to those that lie within a permitted path. This can be enabled using the `-dSAFER` flag at runtime. However, this functionality can potentially be overridden by the `.forceput()` function. The function `setsystemparams()` exposes `.forceput()` in a manner that means it can be called in a controlled manner, using a crafted input file. If an attacker can trick a user into running the application using such a crafted file, they could potentially bypass the `-dSAFER` flag and access files outside of permitted paths. This can also be leveraged in order to execute arbitrary commands on the underlying operating system.",
    "publishedDate": "2019-09-06T14:32:10.397Z",
    "updatedDate": "2020-12-10T10:12:44.481Z",
    "disclosureDate": "2019-08-28T00:00:00.000Z",
    "exploitPublishDate": "2019-12-21T00:00:00.000Z",
    "solution": "Fixed in [**9.50**](https://www.ghostscript.com/download.html) by [this](http://git.ghostscript.com/?p=ghostpdl.git;a=commitdiff;h=885444fcbe10dc42787ecb76686c8ee4dd33bf33) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Hiroki MATSUKUMA (Cyber Defense Institute, Inc)",
    "workaround": "",
    "vendorFixDate": "2019-08-20T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2771",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-749"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14813",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2771/ranges"
            },
            {
                "rel": "reference",
                "href": "http://git.ghostscript.com/?p=ghostpdl.git;a=commitdiff;h=885444fcbe10dc42787ecb76686c8ee4dd33bf33",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hhc0null/GhostRule",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.ghostscript.com/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2019/08/28/2",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2771/default-remediation-status"
            }
        ]
    }
}