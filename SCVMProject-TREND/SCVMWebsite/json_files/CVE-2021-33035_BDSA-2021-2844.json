{
    "source": "BDSA",
    "name": "BDSA-2021-2844",
    "title": "Apache OpenOffice Vulnerable to Arbitrary Code Execution via Stack-Based Buffer Overflow in 'DTable.cxx'",
    "description": "Apache OpenOffice contains an arbitrary code execution vulnerability.  This is due to how DBF files are parsed when opened.  A crafted DBF file can be used to overwrite data and potentially lead to the execution of code.",
    "technicalDescription": "The arbitrary code execution vulnerability is due to missing length checks in fields when a `.dbf` file is opened. The `fetchRow` and `updateBuffer` functions in `main/connectivity/source/drivers/dbase/DTable.cxx` will read and write data beyond the buffer size.  A crafted file can be used to overwrite data on the stack and achieve code execution.\n\nThis has been mitigated by checking the length of data in certain fields before reading and writing.",
    "publishedDate": "2021-09-24T14:42:26.374Z",
    "updatedDate": "2021-09-24T14:42:26.361Z",
    "disclosureDate": "2021-06-26T00:00:00.000Z",
    "solution": "Fixed in version [**4.2.0-dev3-m3**](https://github.com/apache/openoffice/releases/tag/AOO420-Dev3-m3) by [this](https://github.com/apache/openoffice/commit/efddaef0151af3be16078cc4d88c6bae0f911e56) commit.\n\nThe latest stable releases can be found [here](https://www.openoffice.org/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.4,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-06-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2844",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33035",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2844/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/openoffice/commit/efddaef0151af3be16078cc4d88c6bae0f911e56",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/openoffice/commit/efddaef0151af3be16078cc4d88c6bae0f911e56",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/openoffice/releases/tag/AOO420-Dev3-m3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openoffice.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2844/default-remediation-status"
            }
        ]
    }
}