{
    "source": "BDSA",
    "name": "BDSA-2021-3519",
    "title": "mongodb-client-encryption Vulnerable to Man-in-the-Middle (MitM) Attacks via Improper KMS Certificate Checks",
    "description": "The client side of mongodb-client-encryption NPM module does not properly validate the Key Management Service's (KMS) certificate. A man-in-the-middle attacker could intercept the traffic between the Node.js driver and the KMS service. The attack would render the client-side field level encryption (CSFLE) ineffective.",
    "technicalDescription": "The vendor notes that this vulnerability does not impact driver traffic payloads with CSFLE-supported key services from applications residing inside the AWS, GCP, and Azure network fabrics due to compensating controls in these environments. This issue does not impact driver workloads that do not use Field Level Encryption.\n\nThe vulnerability was fixed by adding `servername` parameter in requests to KMS (in `bindings/node/lib/stateMachine.js`) so that the endpoint can serve the correct TLS certificate.",
    "publishedDate": "2021-11-18T15:56:30.648Z",
    "updatedDate": "2021-11-18T15:56:57.417Z",
    "disclosureDate": "2021-02-21T00:00:00.000Z",
    "solution": "Fixed in **[1.2.1](https://github.com/mongodb/libmongocrypt/releases/tag/1.2.1)** by [this](https://github.com/mongodb/libmongocrypt/commit/7636551) commit.\n\nThe latest stable releases can be found [here](https://github.com/mongodb/libmongocrypt/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.2,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.2,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:A/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.4,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-02-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3519",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-295"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20327",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3519/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/libmongocrypt/commit/7636551",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/libmongocrypt/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/libmongocrypt/releases/tag/1.2.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jira.mongodb.org/browse/NODE-3125",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3519/default-remediation-status"
            }
        ]
    }
}