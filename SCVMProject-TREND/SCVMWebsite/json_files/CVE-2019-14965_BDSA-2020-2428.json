{
    "source": "BDSA",
    "name": "BDSA-2020-2428",
    "title": "Frappe Vulnerable to Server-Side Template Injection (SSTI)",
    "description": "Frappe is vulnerable to server-side template injection (SSTI). Attackers could use the template syntax to inject a malicious payload to be executed server-side.",
    "technicalDescription": "This vulnerability exists within the`frappe/utils/jinja.py`,`frappe/desk/reportview.py` and`frappe/desk/search.py `files. Attackers could exploit this by injecting maliciously crafted payloads to the template. The vendor addressed this by using Jinja sandbox to evaluate untrusted code, and reducing restrictions on field contents.",
    "publishedDate": "2020-09-18T15:33:52.640Z",
    "updatedDate": "2020-09-18T15:33:52.635Z",
    "disclosureDate": "2020-07-30T00:00:00.000Z",
    "solution": "Fixed in [**12.0.4**](https://github.com/frappe/frappe/releases/tag/v11.1.63) by [this](https://github.com/frappe/frappe/pull/8044/commits/472d33f3da5e9410d9fc4d2e50e154d0794a4885) commit and [this](https://github.com/frappe/frappe/pull/8044/commits/5d04fb4eb791cac5ae7a33f15577b2d42aa6ed2f) commit.\n\nThe latest stable releases also available [here](https://github.com/frappe/frappe/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-07-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2428",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14965",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2428/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/frappe/frappe/pull/8044",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/frappe/frappe/pull/8044/commits/472d33f3da5e9410d9fc4d2e50e154d0794a4885",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/frappe/frappe/pull/8044/commits/5d04fb4eb791cac5ae7a33f15577b2d42aa6ed2f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/frappe/frappe/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/frappe/frappe/releases/tag/v12.0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2428/default-remediation-status"
            }
        ]
    }
}