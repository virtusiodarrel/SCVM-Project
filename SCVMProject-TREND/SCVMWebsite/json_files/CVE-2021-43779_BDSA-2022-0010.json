{
    "source": "BDSA",
    "name": "BDSA-2022-0010",
    "title": "GLPI Addressing Plugin Vulnerable to Remote Code Execution (RCE) via 'ip' Parameter in 'ping.php'",
    "description": "GLPI Addressing plugin is vulnerable to remote code execution (RCE) due to missing IP address validation in the ping functionality. An authenticated user could inject OS commands in the IP address and have them executed on the host.",
    "technicalDescription": "The vulnerable parameter is `ip` in `ping.php`. OS commands appended to the IP address will be executed on the host and the output will be returned alongside the ping command's results. The issue was fixed by validating the IP address using PHP's built-in `filter_var` functionality (`filter_var($_POST[\"ip\"], FILTER_VALIDATE_IP))`).",
    "publishedDate": "2022-06-22T09:15:08.803Z",
    "updatedDate": "2022-06-22T09:15:08.791Z",
    "disclosureDate": "2022-01-05T00:00:00.000Z",
    "exploitPublishDate": "2022-01-06T00:00:00.000Z",
    "solution": "Fixed in [**2.9.1**](https://github.com/pluginsGLPI/addressing/releases/tag/2.9.1) by [this](https://github.com/pluginsglpi/addressing/commit/d29394a81a08e8ba4dd511e93b62e6a53e1c0a34) commit.\n\nThe latest stable releases are available [here](https://github.com/pluginsglpi/addressing/glpi/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mateo Han\u017eek",
    "workaround": "The GLPI Addressing plugin can be disabled to mitigate the issue.",
    "vendorFixDate": "2021-11-24T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0010",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43779",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0010/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hansmach1ne/MyExploits/tree/main/RCE_GLPI_addressing_plugin",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluginsGLPI/addressing/releases/tag/2.9.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluginsGLPI/addressing/security/advisories/GHSA-q5fp-xpr8-77jh",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluginsGLPI/addressing/security/advisories/GHSA-q5fp-xpr8-77jh",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluginsglpi/addressing/commit/d29394a81a08e8ba4dd511e93b62e6a53e1c0a34",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pluginsglpi/addressing/glpi/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0010/default-remediation-status"
            }
        ]
    }
}