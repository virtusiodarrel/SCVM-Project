{
    "source": "BDSA",
    "name": "BDSA-2021-1782",
    "title": "Xen Vulnerable to Information Exposure via Spectre v2 Attacks with Bare (Non-Shim) 32-bit PV Guests",
    "description": "Xen is vulnerable to information exposure due to insufficient protections against speculative execution attacks with 32-bit x86 PV guest kernels. On x86 systems with CPUs vulnerable to Spectre v2 attacks, this could allow a guest attacker to infer information from arbitrary host memory, even if the Indirect Branch Restricted Speculation (IBRS) protection is active.\n\nThe vendor states that there is no resolution available, and none is ever expected. A documentation patch is provided [here](https://github.com/xen-project/xen/commit/ec4b43107f8663b4a3cf6b9605e1d80152a89f49) which updates the security support statement.",
    "technicalDescription": "Indirect Branch Restricted Speculation, an x86 extension designed to protect against speculative execution attacks, does not protect ring 0 from predictions learned in ring 1. As 32-bit x86 PV guest kernels run in ring 1, this can allow an attacker to conduct Spectre v2 attacks even if this protection is enabled.",
    "publishedDate": "2021-06-15T14:01:33.230Z",
    "updatedDate": "2021-10-20T10:22:37.496Z",
    "disclosureDate": "2021-05-04T00:00:00.000Z",
    "solution": "Fixed in [**4.15.1**](https://github.com/xen-project/xen/tree/RELEASE-4.15.1) by [this](https://github.com/xen-project/xen/commit/280d472f4fca070a10377e318d90cabfc2540810) commit.\n\nThe vendor addressed this vulnerability via documentation update stating \"Due to architectural limitations, 32-bit PV guests must be assumed to be able to read arbitrary host memory using speculative execution attacks\".",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.2,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.9
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn (Google Project Zero)",
    "workaround": "The vendor states that:\n* not running 32-bit PV guests avoids the vulnerability,\n* running 32-bit PV guests under PV-Shim avoids the vulnerability when Spectre v2 protections are otherwise enabled on the system.",
    "vendorFixDate": "2021-05-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1782",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28689",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1782/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/280d472f4fca070a10377e318d90cabfc2540810",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/ec4b43107f8663b4a3cf6b9605e1d80152a89f49",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/tree/RELEASE-4.15.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-370.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-370.txt",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1782/default-remediation-status"
            }
        ]
    }
}