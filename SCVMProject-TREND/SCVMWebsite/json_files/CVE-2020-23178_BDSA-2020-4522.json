{
    "source": "BDSA",
    "name": "BDSA-2020-4522",
    "title": "PHPFusion Vulnerable to Authentication Bypass via Improper Session Management",
    "description": "PHPFusion is vulnerable to authentication bypass due to the improper handling of session tokens. A remote attacker could impersonate a valid user by re-using a session token that they have obtained.",
    "technicalDescription": "The file `includes/classes/PHPFusion/Authenticate.inc` contains code that is used by PHPFusion for authentication and session management purposes. The session management code incorrectly handles user logout events, such that session tokens are not invalidated. A valid session token that an attacker has obtained will continue to be usable after the legitimate user has logged out. An attacker can use the token in order to impersonate the user and access the application.",
    "publishedDate": "2021-07-06T16:03:29.400Z",
    "updatedDate": "2021-07-06T16:03:45.491Z",
    "disclosureDate": "2020-05-11T00:00:00.000Z",
    "exploitPublishDate": "2020-05-11T00:00:00.000Z",
    "solution": "Fixed in [**9.0.70**](https://www.php-fusion.co.uk/infusions/downloads/downloads.php?cat_id=30&download_id=610) by the following commits:\n* [Commit 1](https://github.com/PHPFusion/PHPFusion/commit/6a659a71c862018f0115aca648f0e11f5d30d9eb)\n* [Commit 2](https://github.com/PHPFusion/PHPFusion/commit/450d47aebdac23462130ff1e3c523a9f12f94c8a)\n* [Commit 3](https://github.com/PHPFusion/PHPFusion/commit/6447836a50986e81cafd108d4b9a8ab9a270b9a8)\n* [Commit 4](https://github.com/PHPFusion/PHPFusion/commit/0f80a6831018800d5f55d5e9068531c277e8c0b3)\n\nThe latest stable releases are available [here](https://www.php-fusion.co.uk/phpfusion_9_downloads.php).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "UraSec Team",
    "workaround": "",
    "vendorFixDate": "2020-05-15T00:00:00.000Z",
    "vendorNotifiedDate": "2020-05-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4522",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-613"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-23178",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4522/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPFusion/PHPFusion/commit/0f80a6831018800d5f55d5e9068531c277e8c0b3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPFusion/PHPFusion/commit/450d47aebdac23462130ff1e3c523a9f12f94c8a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPFusion/PHPFusion/commit/6447836a50986e81cafd108d4b9a8ab9a270b9a8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPFusion/PHPFusion/commit/6a659a71c862018f0115aca648f0e11f5d30d9eb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPFusion/PHPFusion/issues/2314",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PHPFusion/PHPFusion/issues/2314",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.php-fusion.co.uk/infusions/downloads/downloads.php?cat_id=30&download_id=610",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.php-fusion.co.uk/phpfusion_9_downloads.php",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4522/default-remediation-status"
            }
        ]
    }
}