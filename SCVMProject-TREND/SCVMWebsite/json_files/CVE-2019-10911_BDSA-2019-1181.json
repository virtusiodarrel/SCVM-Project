{
    "source": "BDSA",
    "name": "BDSA-2019-1181",
    "title": "Symfony Security Component Vulnerable to Authentication Abuse via 'Remember Me' Cookies",
    "description": "Symfony is vulnerable to authentication abuse due to improper handling of usernames and expiry times in 'remember me' cookies by the Security component. This could allow an attacker to authenticate as a different user.",
    "technicalDescription": "Symfony does not properly delimit parameters in 'remember me' cookies, which can result in part of the expiry time ,`$expires`, being confused for part of the `$username`, and vice versa. A registered attacker could exploit this if their user shares a password hash with a targeted user, or if password hashes are `null` for all users (as would be the case if authentication is handled by a single-sign on solution). This will allow the attacker to modify their 'remember me' cookie in order to authenticate as the targeted user.",
    "publishedDate": "2019-04-24T14:54:32.135Z",
    "updatedDate": "2019-04-25T08:29:03.542Z",
    "disclosureDate": "2019-04-17T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/symfony/symfony/commit/0a4ed67b0dcc65b87c03b4c57b925612c4d1f8e2) commit in Symfony versions:\n* **[4.2.7](https://github.com/symfony/symfony/releases/tag/v4.2.7)**\n* **[4.1.12](https://github.com/symfony/symfony/releases/tag/v4.1.12)**\n* **[3.4.26](https://github.com/symfony/symfony/releases/tag/v3.4.26)**\n* **[2.8.50](https://github.com/symfony/symfony/releases/tag/v2.8.50)**\n* **[2.7.51](https://github.com/symfony/symfony/releases/tag/v2.7.51)**\n\nFixed by [this](https://github.com/symfony/security/commit/f5bf68f6f61c76a53cb56f971ddad371432e7de3) commit in Symfony Security versions:\n* **[4.2.7](https://github.com/symfony/security/releases/tag/v4.2.7)**\n* **[4.1.12](https://github.com/symfony/security/releases/tag/v4.1.12)**\n* **[3.4.26](https://github.com/symfony/security/releases/tag/v3.4.26)**\n* **[2.8.50](https://github.com/symfony/security/releases/tag/v2.8.50)**\n* **[2.7.51](https://github.com/symfony/security/releases/tag/v2.7.51)**\n\nThe latest stable releases for Symfony are available [here](https://symfony.com/download).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jon Cave",
    "workaround": "",
    "vendorFixDate": "2019-04-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1181",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-565"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10911",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1181/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/security/commit/f5bf68f6f61c76a53cb56f971ddad371432e7de3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/security/releases/tag/v2.7.51",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/security/releases/tag/v2.8.50",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/security/releases/tag/v3.4.26",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/security/releases/tag/v4.1.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/security/releases/tag/v4.2.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/commit/0a4ed67b0dcc65b87c03b4c57b925612c4d1f8e2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases/tag/v2.7.51",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases/tag/v2.8.50",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases/tag/v3.4.26",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases/tag/v4.1.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases/tag/v4.2.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://symfony.com/blog/cve-2019-10911-add-a-separator-in-the-remember-me-cookie-hash",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://symfony.com/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1181/default-remediation-status"
            }
        ]
    }
}