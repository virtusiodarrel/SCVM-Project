{
    "source": "BDSA",
    "name": "BDSA-2022-1285",
    "title": "pgjdbc Vulnerable to Remote Code Execution via Insufficient Plugin Class Validation",
    "description": "pgjdbc is vulnerable to remote code execution (RCE) due to the insufficient validation of classes that are to be instantiated. An attacker could potentially execute arbitrary code on a vulnerable server by causing that server to load a dangerous class.",
    "technicalDescription": "pgjdbc instantiates plugin class instances using the `ObjectFactory.instantiate()` method. The first argument to this method specifies the name of the class that is to be instantiated. The name of the class can be specified via a user-controlled variable. The named class is insufficiently validated to ensure that it actually implements the required interface. An attacker that is able to control the class name could therefore create instances of arbitrary classes, which may in turn allow them to achieve arbitrary code execution on a vulnerable host.",
    "publishedDate": "2022-05-09T15:04:54.634Z",
    "updatedDate": "2022-08-18T05:59:05.939Z",
    "disclosureDate": "2022-02-01T00:00:00.000Z",
    "exploitPublishDate": "2022-02-01T00:00:00.000Z",
    "solution": "Fixed in version [**42.3.2-rc2**](https://github.com/pgjdbc/pgjdbc/releases/tag/REL42.3.2-rc2) by [this](https://github.com/pgjdbc/pgjdbc/commit/f4d0ed69c0b3aae8531d83d6af4c57f22312c813) commit, and in [**42.2.25-rc1**](https://github.com/pgjdbc/pgjdbc/releases/tag/REL42.2.25-rc1) by [this](https://github.com/pgjdbc/pgjdbc/commit/8a363a7c0989ef8a8f45bb055b4003f758ceabd5) commit.\n\nThe latest stable releases can be found [here](https://github.com/pgjdbc/pgjdbc/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "iSafeBlue",
    "workaround": "",
    "vendorFixDate": "2022-02-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1285",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-665"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-21724",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1285/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/commit/8a363a7c0989ef8a8f45bb055b4003f758ceabd5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/commit/f4d0ed69c0b3aae8531d83d6af4c57f22312c813",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/releases/tag/REL42.2.25-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/releases/tag/REL42.3.2-rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-v7wg-cpwc-24m4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-v7wg-cpwc-24m4",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1285/default-remediation-status"
            }
        ]
    }
}