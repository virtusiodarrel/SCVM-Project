{
    "source": "BDSA",
    "name": "BDSA-2022-2217",
    "title": "OpenEMR Vulnerable to DOM-Based Cross-Site Scripting (XSS) via Custom MIME White List Functionality",
    "description": "OpenEMR is vulnerable to a DOM-based cross-site scripting (XSS) issue due to a lack of sufficient input sanitization in its custom MIME white list functionality.\n\nAn attacker with administrative privileges could exploit this issue to inject malicious scripts into web content that is dynamically generated by the application. They could achieve this by accessing the `Admin>System>Files` page and then injecting the scripts via the `add-manually-input` parameter. These scripts will be executed within the browser of a victim user who views the relevant dynamically generated content.",
    "technicalDescription": "This issue occurs because the `add-manually()` function of the `interface/super/manage_site_files.php` file does not sufficiently sanitize user-supplied input.",
    "publishedDate": "2022-08-09T15:52:49.793Z",
    "updatedDate": "2022-08-09T15:52:49.783Z",
    "disclosureDate": "2022-08-09T00:00:00.000Z",
    "exploitPublishDate": "2022-08-09T00:00:00.000Z",
    "solution": "Fixed in [**7.0.0.1**](https://github.com/openemr/openemr/releases/tag/v7_0_0_1) by [this](https://github.com/openemr/openemr/commit/74d21039aec641b2c406e3baf238ae4602a968b6) commit.\n\nThe latest stable releases are available [here](https://github.com/openemr/openemr/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 1.7,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ammarit Thongthua, Rattapon Jitprajong and Nattakit Intarasorn from Secure D Center Research Team",
    "workaround": "",
    "vendorFixDate": "2022-07-28T00:00:00.000Z",
    "vendorNotifiedDate": "2022-07-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2217",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-2729",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2217/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/commit/74d21039aec641b2c406e3baf238ae4602a968b6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/releases/tag/v7_0_0_1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/13b58e74-2dd0-4eec-9f3a-554485701540/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/13b58e74-2dd0-4eec-9f3a-554485701540/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2217/default-remediation-status"
            }
        ]
    }
}