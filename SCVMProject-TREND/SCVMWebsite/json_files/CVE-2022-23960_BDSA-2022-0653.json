{
    "source": "BDSA",
    "name": "BDSA-2022-0653",
    "title": "Linux Kernel Vulnerable to Sensitive Information Disclosure via 'Spectre-BHB' Attacks on Arm Processors",
    "description": "The Linux Kernel is vulnerable to a sensitive information disclosure issue on some Arm processors due to the presence of a cache speculation vulnerability that abuses globally shared branch history to inform predictions. This issue may allow an authorized user to leak arbitrary kernel memory via local access.\n\nThe vulnerability researchers consider this issue to be an extension of Branch Target Injection (BTI, Spectre Variant 2, **CVE-2017-5715** (**BDSA-2018-0009**)). See their [advisory](https://www.vusec.net/projects/bhi-spectre-bhb/) for more information.\n\n**Note**: Arm has provided a list of affected processors [here](https://developer.arm.com/support/arm-security-updates/speculative-processor-vulnerability/spectre-bhb).",
    "technicalDescription": "In reports detailing the extension to Branch Target Injection (BTI, Spectre Variant 2, **CVE-2017-5715** (**BDSA-2018-0009**)), Arm has elected to rely on the naming convention provided by the vulnerability researchers: **Spectre-BHB** (Spectre-v2 aided by the Branch History Buffer (BHB), **CVE-2022-23960**). This extension is similar to the previously reported Spectre-v2 issue except that malicious code uses the shared branch history (stored in the CPU Branch History Buffer, or BHB) to influence mispredicted branches within the victim's own hardware context. Once that occurs, speculation caused by mispredicted branches can be used to cause cache allocation, which can then be used to infer information that should not be accessible.",
    "publishedDate": "2022-03-11T15:40:04.175Z",
    "updatedDate": "2022-09-08T15:21:44.476Z",
    "disclosureDate": "2022-03-08T00:00:00.000Z",
    "exploitPublishDate": "2022-03-08T00:00:00.000Z",
    "solution": "A series of patches for the Linux Kernel have been made available [here](https://git.kernel.org/pub/scm/linux/kernel/git/morse/linux.git/log/?h=spectre-bhb/v5.17). Fixes for maintained branches are currently being rolled out.\n\nFixed in Xen versions:\n\n* [**4.16.1**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.16.1)\n* [**4.15.2**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.2)\n* [**4.14.5**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.5)\n\nXen has also made [patches](https://xenbits.xen.org/xsa/advisory-398.html) available for the following stable branches:\n* **4.13.x**\n* **4.12.x**\n\nFixed in Trusted Firmware version [**2.7-rc0**](https://git.trustedfirmware.org/TF-A/trusted-firmware-a.git/tag/?h=v2.7-rc0) by [these](https://review.trustedfirmware.org/q/topic:%22spectre_bhb%22+(status:open%20OR%20status:merged)) patches. The patches fix CPUs listed by the vendor [here](https://trustedfirmware-a.readthedocs.io/en/latest/security_advisories/security-advisory-tfv-9.html#cve-2022-23960).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.8
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:N/A:N/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.7,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Systems and Network Security Group at Vrije Universiteit Amsterdam",
    "workaround": "In the \"Spectre-BHB whitepaper\", available [here](https://developer.arm.com/support/arm-security-updates/speculative-processor-vulnerability/spectre-bhb), \nArm has stated that mitigation will depend on the CPU and will either be based on implementing a loop to discard the branch history on entry to higher exception levels, or will involve flushing all branch predictions via an implementation specific route. Please see the paper for details and further mitigations.",
    "vendorFixDate": "2022-03-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0653",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-226"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23960",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0653/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2062284",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://developer.arm.com/support/arm-security-updates/speculative-processor-vulnerability/spectre-bhb",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://developer.arm.com/support/arm-security-updates/speculative-processor-vulnerability/spectre-bhb",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://download.vusec.net/papers/bhi-spectre-bhb_sec22.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/morse/linux.git/log/?h=spectre-bhb/v5.17",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.trustedfirmware.org/TF-A/trusted-firmware-a.git/tag/?h=v2.7-rc0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vusec/bhi-spectre-bhb",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.16.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://review.trustedfirmware.org/q/topic:%22spectre_bhb%22+(status:open%20OR%20status:merged)",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://trustedfirmware-a.readthedocs.io/en/latest/security_advisories/security-advisory-tfv-9.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://trustedfirmware-a.readthedocs.io/en/latest/security_advisories/security-advisory-tfv-9.html#cve-2022-23960",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.vusec.net/projects/bhi-spectre-bhb/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.vusec.net/projects/bhi-spectre-bhb/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-398.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-398.html",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0653/default-remediation-status"
            }
        ]
    }
}