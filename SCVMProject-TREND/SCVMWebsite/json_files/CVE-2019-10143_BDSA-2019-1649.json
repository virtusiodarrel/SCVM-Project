{
    "source": "BDSA",
    "name": "BDSA-2019-1649",
    "title": "Freeradius Vulnerable to Privilege Escalation via Insecure 'logrotate' Configuration",
    "description": "Freeradius contains a privilege escalation vulnerability due an insecure configuration of `logrotate`. An attacker, who is authenticated as a `radiusd` user, is able to exploit a race condition as result of this misconfiguration which will lead to the ability to write files to directories which are only writable by root. Malicious content can be inserted to these files, that when executed, will allow escalation of privileges.",
    "technicalDescription": "Freeradius contains a misconfiguration of `logrotate` where log rotation runs as `root:root` by default, instead of under the owner of the logs. This insecure configuration is vulnerable to a race condition which allows a high privileged (radiusd) local attacker to escalate to root by manipulating  `logrotate` into writing files to a directory normally inaccessible by a radiusd user. This can occur by leveraging the use of symbolic links to write files to any given directory. An attacker can insert malicious content, such as a reverse shell, via this symbolic link to result in privilege escalation to root.\n\nFor this attack to be successful, `logrotate` must be executed as root, the `logpath` must be controlled by the attacker and the ability to create files must be set within the `logrotate` configuration.",
    "publishedDate": "2019-06-20T14:55:37.136Z",
    "updatedDate": "2020-10-23T14:22:25.499Z",
    "disclosureDate": "2019-04-28T00:00:00.000Z",
    "exploitPublishDate": "2019-04-28T00:00:00.000Z",
    "solution": "Fixed in **[3.0.20](https://github.com/FreeRADIUS/freeradius-server/releases/tag/release_3_0_20)** by [this](https://github.com/freeradius/freeradius-server/commit/1f233773962bf1a9c2d228a180eacddb9db2d574) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wolfgang Hotwagner",
    "workaround": "Within `/etc/logrotate.d/radiusd` file, include `su radiusd:radiusd` to all the log sections.",
    "vendorFixDate": "2019-05-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1649",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-16"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-363"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10143",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1649/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1705143",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10143",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10143",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FreeRADIUS/freeradius-server/commit/3576d9c0e148486b4531e8e0f66aae3170edd23d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FreeRADIUS/freeradius-server/pull/2666",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FreeRADIUS/freeradius-server/releases/tag/release_3_0_20",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/whotwagner/logrotten",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1649/default-remediation-status"
            }
        ]
    }
}