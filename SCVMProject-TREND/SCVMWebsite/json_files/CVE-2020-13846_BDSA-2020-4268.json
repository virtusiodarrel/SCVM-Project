{
    "source": "BDSA",
    "name": "BDSA-2020-4268",
    "title": "Singularity Vulnerable to Malicious SIF Container Execution via Status Code Reporting Flaw",
    "description": "Singularity workflows that use the `--all / -a` option to verify containers are vulnerable to running malicious SIF containers due to how errors in status codes may not be reported.\n\nAn attacker could use this issue in order to introduce malicious behavior via crafted or compromised SIF containers.",
    "technicalDescription": "Workflows in Singularity that use the `--all / -a` option are vulnerable to running potentially dangerous SIF containers because `singularity verify` can return successful exit codes even when some objects in the container are unsigned, modified or otherwise cannot be verified.\n\nThese objects that are not verified are reported in `WARNING` log messages, but a `Container Verified` message and `0` exit code are returned. The objects that have been tampered with could potentially be used in order to introduce malicious behavior.",
    "publishedDate": "2021-03-18T12:15:26.512Z",
    "updatedDate": "2021-03-18T12:15:26.507Z",
    "disclosureDate": "2020-07-14T00:00:00.000Z",
    "solution": "Fixed in [**3.6.0**](https://github.com/hpcng/singularity/releases/tag/v3.6.0) by [this](https://github.com/hpcng/singularity/commit/c229acdc7a1851bc86e93b862e98009ab675b4ae) commit.\n\nThe latest stable releases are available [here](https://github.com/hpcng/singularity/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tru Huynh",
    "workaround": "The vendor has stated [here](https://github.com/hpcng/singularity/security/advisories/GHSA-6w7g-p4jh-rf92) that the return code of `singularity verify` `--all / -a` must not be relied upon as an indicator of trust in a container if you are unable to upgrade to **3.6.0**.",
    "vendorFixDate": "2020-07-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4268",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13846",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4268/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/commit/c229acdc7a1851bc86e93b862e98009ab675b4ae",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases/tag/v3.6.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/security/advisories/GHSA-6w7g-p4jh-rf92",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/security/advisories/GHSA-6w7g-p4jh-rf92",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4268/default-remediation-status"
            }
        ]
    }
}