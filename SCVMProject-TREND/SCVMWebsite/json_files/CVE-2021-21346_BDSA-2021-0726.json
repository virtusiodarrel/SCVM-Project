{
    "source": "BDSA",
    "name": "BDSA-2021-0726",
    "title": "XStream Vulnerable to Arbitrary Code Execution via Deserialization of 'sun.swing.SwingLazyValue' Type",
    "description": "XStream, when in its default configuration or operating without a sufficient blacklist / whitelist configuration, is vulnerable to an arbitrary code execution issue. This is due to how XStream can potentially create new instances of dangerous objects that are not blocked based on the contents of the input stream. The potentially dangerous type in this case is `sun.swing.SwingLazyValue`.\n\nAn attacker could supply a crafted input to XStream in order execute arbitrary code stored on a remote host.",
    "technicalDescription": "XStream is vulnerable to arbitrary code execution when running without a sufficient blacklist / whitelist configuration because dangerous type information can be processed. At unmarshalling time, the processed stream contains type information to recreate the formerly written objects. New instances are created based on the provided type information, meaning that potentially dangerous types that are not blocked can have new instances created.\n\nAn attacker could cause XStream to unmarshal some XML containing a malicious `sun.swing.SwingLazyValue` type. This type could be abused to load and execute arbitrary code from a remote host.\n\n**Note**: The vendor has stated that XStream users who have set up the XStream security framework with a sufficient whitelist limited to the minimal required types are unaffected by this issue.",
    "publishedDate": "2021-03-24T14:40:28.289Z",
    "updatedDate": "2021-05-20T10:14:41.437Z",
    "disclosureDate": "2021-03-13T00:00:00.000Z",
    "exploitPublishDate": "2021-03-13T00:00:00.000Z",
    "solution": "Fixed in [**1.4.16**](https://github.com/x-stream/xstream/releases/tag/XSTREAM_1_4_16) by [this](https://github.com/x-stream/xstream/commit/d5e51177634afea7213b9dc2d21f101d2e258db9) commit.\n\nThe latest stable releases are available [here](http://x-stream.github.io/download.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "wh1t3p1g",
    "workaround": "The vendor recommends the use of XStream's security framework to implement a whitelist for allowed types. \n\nThe vendor has made available a set of [workarounds](https://x-stream.github.io/security.html#workaround) detailing this feature.",
    "vendorFixDate": "2021-03-09T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0726",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21346",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0726/ranges"
            },
            {
                "rel": "reference",
                "href": "http://x-stream.github.io/changes.html#1.4.16",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://x-stream.github.io/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/commit/d5e51177634afea7213b9dc2d21f101d2e258db9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/releases/tag/XSTREAM_1_4_16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/security/advisories/GHSA-4hrm-m67v-5cxr",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/CVE-2021-21346.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/CVE-2021-21346.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/security.html#workaround",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0726/default-remediation-status"
            }
        ]
    }
}