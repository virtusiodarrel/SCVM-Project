{
    "source": "BDSA",
    "name": "BDSA-2021-1614",
    "title": "Kubernetes Vulnerable to Authentication Bypass via API Server Proxy Filter Functionality",
    "description": "Kubernetes contains a vulnerability to a time-of-check race condition. Authenticated attackers that successfully exploit this could achieve an authentication bypass via the APR server proxy filters functionality.",
    "technicalDescription": "This vulnerability exists due to a time-of-check race condition in API Server. Attackers could exploit this by setting the `hostname` of the address type used to a custom DNS server that is able return different values with zero TTL. Attackers with cluster-admin privileges could exploit this vulnerability by bypassing the authentication in place within the application resulting in access to private networks on the Kubernetes control plane components.\n\n**Note:** The vendor states that Kubernetes clusters are only affected if an untrusted user can create or modify Node objects and proxy to them, or an untrusted user can create or modify 'StorageClass' objects and access 'KubeControllerManager' logs.",
    "publishedDate": "2021-06-03T10:07:58.204Z",
    "updatedDate": "2022-05-27T14:14:50.559Z",
    "disclosureDate": "2021-05-27T00:00:00.000Z",
    "exploitPublishDate": "2021-05-27T00:00:00.000Z",
    "solution": "",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.1,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 0.7,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:P/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Javier Provecho Fernandez",
    "workaround": "The vendor states: `If this issue affects your clusters\u2019 control planes, you can use dnsmasq for name resolution and configure the min-cache-ttl and neg-ttl parameters to a low non-zero value to enforce cached replies for proxied connections.`",
    "vendorNotifiedDate": "2020-04-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1614",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-367"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8562",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1614/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/issues/101493",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/issues/101493",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/859962",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/859962",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1614/default-remediation-status"
            }
        ]
    }
}