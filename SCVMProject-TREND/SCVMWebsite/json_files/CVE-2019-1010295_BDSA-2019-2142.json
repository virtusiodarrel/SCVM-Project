{
    "source": "BDSA",
    "name": "BDSA-2019-2142",
    "title": "OP-TEE Vulnerable to Denial-of-Service via Buffer Overflow in 'utee_param_to_param' Function",
    "description": "OP-TEE contains a buffer overflow vulnerability. This could be exploited by an attacker to expose sensitive memory addresses. In addition the component will also crash resulting in a denial-of-service (DoS).",
    "technicalDescription": "This vulnerability is due to missing checks for user-supplied TA parameters via the `utee_param_to_param` function located in `core/tee/tee_svc.c`. To ensure that the newly loaded TA is not able to observe any data belonging to a TA previously stored on this exact location in memory, the memory block is set to zero. The size used to memset the block to zero is the sum of the size of the segments, not the rounded size of the actual allocation. As a result the remaining space at the end of the allocation is not cleared, resulting in code or data from the previous TA being leaked. Successfully exploiting results in a crash due to memory corruption and the disclosure of memory content in the `optee_os` component. This attack is limited by the memory layout of the compromised TA performing the attack. \n\n`utee_param_to_param` was introduced by [this](https://github.com/OP-TEE/optee_os/commit/e86f1266afb6871795921b1eeb2bcbe5b1928cb5) commit.",
    "publishedDate": "2019-07-16T14:38:07.158Z",
    "updatedDate": "2019-07-16T15:50:56.140Z",
    "disclosureDate": "2019-05-01T00:00:00.000Z",
    "solution": "Fixed in **[3.4.0](https://github.com/OP-TEE/optee_os/releases/tag/3.4.0)** by [this](https://github.com/OP-TEE/optee_os/commit/d5c5b0b77b2b589666024d219a8007b3f5b6faeb) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.6,
        "impactSubscore": 7.8,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Riscure",
    "workaround": "",
    "vendorFixDate": "2018-11-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2142",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-120"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-1010295",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2142/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OP-TEE/optee_os/commit/d5c5b0b77b2b589666024d219a8007b3f5b6faeb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OP-TEE/optee_os/commit/e86f1266afb6871795921b1eeb2bcbe5b1928cb5",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OP-TEE/optee_os/releases/tag/3.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.op-tee.org/security-advisories/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2142/default-remediation-status"
            }
        ]
    }
}