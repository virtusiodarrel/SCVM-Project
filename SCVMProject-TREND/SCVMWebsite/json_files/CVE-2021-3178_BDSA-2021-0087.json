{
    "source": "BDSA",
    "name": "BDSA-2021-0087",
    "title": "Linux Vulnerable to Information Disclosure via NFS Subdirectory Exports",
    "description": "It was found that an NFS export of a subdirectory of a filesystem on Linux could allow remote attackers to traverse to other parts of the filesystem. \n\nNote that the CVE associated with this vulnerability is disputed because there is an argument that subdirectory exports are not intended to prevent such attacks.",
    "technicalDescription": "If a subdirectory of a filesystem is exported, a `READDIRPLUS` operation on the root of that export returns the file handle of the parent with the `..` entry. This file handle could be used to guess file handles to other parts of the filesystem, essentially giving access to the entire filesystem. In order to fix the issue it is proposed to not return the `..` file handle entry in `fs/nfsd/nfs3xdr.c`.",
    "publishedDate": "2021-01-19T14:02:13.211Z",
    "updatedDate": "2021-02-16T13:03:54.192Z",
    "disclosureDate": "2021-01-11T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.253**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c89b2b56fc536d4fd41745bcbf394aa21162e277) commit.\n* [**4.9.253**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2174b2cf3960b9091c2516feeb9e345fe24f8906) commit.\n* [**4.14.217**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0f60f9d1e6182d9440614c13cdf6106e2d470f89) commit.\n* [**4.19.170**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a08c2e586ad047fcea3f75664cca0915c77934fe) commit.\n* [**5.4.92**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4aef760c28e8bd1860a27fd78067b4ea77124987) commit.\n* [**5.10.10**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fdcaa4af5e70e2d984c9620a09e9dade067f2620) commit.\n* [**5.11-rc5**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=51b2ee7d006a736a9126e8111d1f24e4fd0afaa6) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:C/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "J. Bruce Fields",
    "workaround": "",
    "vendorFixDate": "2021-01-12T00:00:00.000Z",
    "vendorNotifiedDate": "2021-01-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0087",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-201"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3178",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0087/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=51b2ee7d006a736a9126e8111d1f24e4fd0afaa6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=51b2ee7d006a736a9126e8111d1f24e4fd0afaa6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0087/default-remediation-status"
            }
        ]
    }
}