{
    "source": "BDSA",
    "name": "BDSA-2020-4693",
    "title": "NATS.io Packages Vulnerable to Information Disclosure via TLS Client Certificates",
    "description": "The NATS.io packages nats.js, nats.ws, and nats.deno contain an information disclosure vulnerability. Successfully exploiting this could allow an attacker to leak options to the NATS server; including TLS private credentials.",
    "technicalDescription": "This vulnerability occurs when using TLS client certificates for mutual TLS. The `_connection_ configuration` options are fully serialized and sent to the server in a client's `CONNECT` message, immediately after TLS establishment during which time private key material for TLS is leaked from the client application to the server. This could allow an attacker access to authentication credentials. It is important to note that NATS account NKey authentication is NOT affected by this vulnerability. \n\n**Note:** The vendor has stated that neither the nats.ws nor the nats.deno clients support Mutual TLS so the affected version range listed are for those versions where the logic flaw causing this vulnerability is present. In nats.js the mainline is unaffected and so the affected version range listed is only in the beta branch.",
    "publishedDate": "2021-11-19T16:48:54.449Z",
    "updatedDate": "2022-01-21T14:20:23.772Z",
    "disclosureDate": "2020-09-29T00:00:00.000Z",
    "solution": "Fixed in nats.js [**2.0.0-209**](https://www.npmjs.com/package/nats/v/2.0.0-209).\n\nThe latest stable nats.js releases are available [here](https://github.com/nats-io/nats.js/releases).\n\nFixed in nats.ws [**1.0.0-111**](https://www.npmjs.com/package/nats.ws/v/1.0.0-111).\n\nThe latest stable nats.ws releases are available [here](https://github.com/nats-io/nats.ws/releases).\n\nFixed in nats.deno [**1.0.0-9**](https://github.com/nats-io/nats.deno/releases/tag/v1.0.0-9).\n\nThe latest stable nats.deno release are available [here](https://github.com/nats-io/nats.deno/releases).\n\n**Note:** The vendor has stated that after you upgrade your package dependencies to fixed versions, users need to reissue any TLS client credentials (with new keys, not just new certificates) and revoke the old ones.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-09-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4693",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-26149",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4693/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nats-io/nats.deno/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nats-io/nats.deno/releases/tag/v1.0.0-9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nats-io/nats.js/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nats-io/nats.ws/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/nats.ws/v/1.0.0-111",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/nats/v/2.0.0-209",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/09/30/3",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4693/default-remediation-status"
            }
        ]
    }
}