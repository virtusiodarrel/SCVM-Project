{
    "source": "BDSA",
    "name": "BDSA-2020-0372",
    "title": "Ansible Vulnerable to Remote Code Execution (RCE) via 'pipe' Lookup Plugin",
    "description": "It was discovered that the Ansible contains a privilege escalation vulnerability. A local attacker could exploit this to potentially execute remote code.\n\nIt should be noted that this vulnerability has been disputed by the vendor, who state that the functionality is intended and that \"it is up to the playbook author to ensure that they use the `|quote` filter where appropriate\".",
    "technicalDescription": "The vulnerability occurs in the `ansible/lib/ansible/plugins/lookup/pipe.py` file. The pipe lookup component  uses the `subprocess.Popen()` function with the default setting  `shell=false`. This could allow a user supplied variable to override Ansible facts, as the quote plugin does not properly escape values, potentially leading to an attacker being able to run arbitrary commands.\n\nIt should be noted that this vulnerability has been disputed by the vendor, who state that the functionality is intended and that \"it is up to the playbook author to ensure that they use the `|quote` filter where appropriate\".",
    "publishedDate": "2020-03-05T13:23:34.550Z",
    "updatedDate": "2021-04-09T08:46:13.867Z",
    "disclosureDate": "2020-02-11T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:M/Au:S/C:P/I:P/A:P/E:U/RL:U/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 6.9
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H/E:U/RL:U/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Borja Tarraso",
    "workaround": "",
    "vendorNotifiedDate": "2020-02-11T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0372",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-1734",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0372/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-1734",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/issues/67792",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0372/default-remediation-status"
            }
        ]
    }
}