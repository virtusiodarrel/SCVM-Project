{
    "source": "BDSA",
    "name": "BDSA-2019-2959",
    "title": "Apache OFBiz Vulnerable to Remote Code Execution (RCE) via Template Injection in Form Widget",
    "description": "Apache OFBiz is vulnerable to remote code execution (RCE) due to improper validation of form widget data. A remote attacker could exploit this vulnerability by supplying maliciously crafted input.",
    "technicalDescription": "OFBiz does not sanitize the `story` field of the Customer Request form widget in the Order Manager app, within the file `applications/order/widget/ordermgr/CustRequestForms.xml`. An attacker could exploit this by supplying maliciously crafted input to this field which includes Freemarker markup text. If processed this could allow them to execute code on the target system within the privileges of the application.",
    "publishedDate": "2019-09-13T16:14:20.328Z",
    "updatedDate": "2022-08-08T15:12:46.390Z",
    "disclosureDate": "2019-09-10T00:00:00.000Z",
    "solution": "Fixed in **[16.11.06](https://ofbiz.apache.org/download.html)** by [this](https://svn.apache.org/viewvc?view=revision&revision=1858533) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Niels Heinen (Google security team)",
    "workaround": "",
    "vendorFixDate": "2019-05-02T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2959",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10074",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2959/ranges"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/a0b0e576d4e2c957136c88a04a4de9a9bc19b7365f54576ba6a6fbc3@%3Cdev.ofbiz.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ofbiz.apache.org/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ofbiz.apache.org/security.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://svn.apache.org/viewvc?view=revision&revision=1858533",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2959/default-remediation-status"
            }
        ]
    }
}