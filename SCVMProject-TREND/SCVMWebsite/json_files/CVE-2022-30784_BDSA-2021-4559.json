{
    "source": "BDSA",
    "name": "BDSA-2021-4559",
    "title": "Tuxera NTFS-3G Vulnerable to Local Code Execution via Heap Exhaustion in 'ntfs_get_attribute_value'",
    "description": "Tuxera NTFS-3G is vulnerable to local code execution via a heap exhaustion in the `ntfs_get_attribute_value()` function. An authenticated attacker could exploit this via a crafted NTFS image.",
    "technicalDescription": "This issue occurs due to incorrect validation of NTFS metadata. An attacker could achieve arbitrary code execution if they either have local access while the `ntfs-3g` binary is `setuid` root, or if they have physical access to an external port that has been configured to run the `ntfs-3g` binary or `ntfsprog` tools when the external storage is plugged in.\n\nIt was mitigated by avoiding the allocation and reading of an attribute beyond its full size by restricting the size of the last run to read to the required length.",
    "publishedDate": "2022-08-16T11:09:05.550Z",
    "updatedDate": "2022-08-16T11:09:05.541Z",
    "disclosureDate": "2022-05-26T00:00:00.000Z",
    "solution": "Fixed in [**2022.5.17**](https://github.com/tuxera/ntfs-3g/releases/tag/2022.5.17) by [this](https://github.com/tuxera/ntfs-3g/commit/60717a846deaaea47e50ce58872869f7bd1103b5) commit.\n\nThe latest stable releases can be found [here](https://github.com/tuxera/ntfs-3g/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jeremy Galindo, Akshay Ajayan, Kyle Zeng and Fish Wang",
    "workaround": "",
    "vendorFixDate": "2021-09-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4559",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-30784",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4559/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tuxera/ntfs-3g/commit/60717a846deaaea47e50ce58872869f7bd1103b5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tuxera/ntfs-3g/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tuxera/ntfs-3g/releases/tag/2022.5.17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tuxera/ntfs-3g/security/advisories/GHSA-xchm-ph5h-hw4x",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://security-tracker.debian.org/tracker/CVE-2022-30784",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4559/default-remediation-status"
            }
        ]
    }
}