{
    "source": "BDSA",
    "name": "BDSA-2021-2100",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via Heap Buffer Overflow in HID Subsystem",
    "description": "The Linux kernel is vulnerable to privilege escalation due to memory mismanagement in the Human Interface Devices (HID) subsystem. This could be exploited by a local attacker manipulating the input to certain HID functions and overflowing the allocated heap memory buffer.",
    "technicalDescription": "The HID report field allows to have a different number of `values` and `usages` when it is allocated. The size of the usage array is guaranteed to be at least as large as the values array, but it may be larger. The difference of the array sizes results in out-of-bounds write in the functions `__hidinput_change_resolution_multipliers` and an out-of-bounds read in `hidinput_count_leds`. The overflows could theoretically be used to achieve local privilege escalation.\n\nThe vulnerability was fixed by making sure that both `values` and `usages` array are the same size. The `hid_register_field` function in `drivers/hid/hid-core.c` now only takes the size parameter for `usages` and assigns it to `values`.",
    "publishedDate": "2021-07-16T14:03:48.891Z",
    "updatedDate": "2021-07-16T14:03:48.877Z",
    "disclosureDate": "2021-06-21T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.259**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=795a8c31cabf1a452b0b63bb3f8d9159b353e5ce) commit\n* [**4.9.259**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b12d39309ecf08cdcab716a5063f9ec23cb9f001) commit\n* [**4.14.223**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=00022873fdc1a304fd89016d227e3781f413dfbd) commit\n* [**4.19.178**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ffca531f71d078c6caf752d64bc2a592f420f7c6) commit\n* [**5.4.101**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fce3654c648d8f92882d0dae117c20231b8b224f) commit\n* [**5.10.19**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=77344e18cf84b37548292f2adfdb22f89079e0a6) commit\n* [**5.11.2**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=018cbb2b4472f741eef20b790b13900146ccf224) commit\n* [**5.12-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ed9be64eefe26d7d8b0b5b9fa3ffdf425d87a01f) commit",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-03-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2100",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-0512",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2100/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=00022873fdc1a304fd89016d227e3781f413dfbd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=018cbb2b4472f741eef20b790b13900146ccf224",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=77344e18cf84b37548292f2adfdb22f89079e0a6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=795a8c31cabf1a452b0b63bb3f8d9159b353e5ce",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b12d39309ecf08cdcab716a5063f9ec23cb9f001",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ed9be64eefe26d7d8b0b5b9fa3ffdf425d87a01f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fce3654c648d8f92882d0dae117c20231b8b224f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ffca531f71d078c6caf752d64bc2a592f420f7c6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ed9be64eefe26d7d8b0b5b9fa3ffdf425d87a01f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://security-tracker.debian.org/tracker/CVE-2021-0512",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2100/default-remediation-status"
            }
        ]
    }
}