{
    "source": "BDSA",
    "name": "BDSA-2021-2805",
    "title": "OpenZepplin Vulnerable to Privilege Escalation via TimeLockController",
    "description": "OpenZepplin contains a privilege escalation vulnerability.  This allows an attacker with the executor role to take immediate control of the timelock component in OpenZepplin. This vulnerability gives unrestricted access to assets held in the contract to a remote attacker.",
    "technicalDescription": "The privilege escalation vulnerability occurs when an attacker resets the timelock delay to 0. This vulnerability has been mitigated by adding the `isOperationReady` function to the `_beforeCall` and `afterCall` functions in `contracts/governance/TimelockController.sol`.",
    "publishedDate": "2021-09-17T10:45:59.835Z",
    "updatedDate": "2021-09-17T10:45:59.822Z",
    "disclosureDate": "2021-08-26T00:00:00.000Z",
    "solution": "Fixed in versions: \n\n* [**4.3.1**](https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.3.1) by [this](https://github.com/OpenZeppelin/openzeppelin-contracts/commit/0ec7f4c25d60437e0ae5bb72cb4549a58e53a387) commit.\n* [**3.4.2**](https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v3.4.2) by [this](https://github.com/OpenZeppelin/openzeppelin-contracts/commit/c8188c0bbd091a4992148e5f92d8c79ee6acdba6) commit.\n* [**3.4.2-solc-0.7**](https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v3.4.2-solc-0.7) by [this](https://github.com/OpenZeppelin/openzeppelin-contracts/commit/6753d0123e230d3d9f67520c6d5d540bb63273a6) commit.\n\nThe latest stable releases can be found [here](https://github.com/OpenZeppelin/openzeppelin-contracts/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor states following as a workaround:\n\n> Revoke the executor role from accounts not strictly under the team's control. We recommend revoking all executors that are not also proposers. When applying this mitigation, ensure there is at least one proposer and executor remaining.",
    "vendorFixDate": "2021-08-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2805",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-266"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39168",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2805/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/security/advisories/GHSA-vrw4-w73r-6mm8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/security/advisories/GHSA-vrw4-w73r-6mm8",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/0ec7f4c25d60437e0ae5bb72cb4549a58e53a387",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/6753d0123e230d3d9f67520c6d5d540bb63273a6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/c8188c0bbd091a4992148e5f92d8c79ee6acdba6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v3.4.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v3.4.2-solc-0.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2805/default-remediation-status"
            }
        ]
    }
}