{
    "source": "BDSA",
    "name": "BDSA-2022-1387",
    "title": "Golang Vulnerable to Improper TLS Ticket Age Obfuscation via Constant 'ticket_age_add' Value",
    "description": "Golang `crypto/tls` module does not properly obfuscate the TLS ticket age due to RFC 8446 standard violation. If the connection is operating under [0-RTT](https://blog.cloudflare.com/introducing-0-rtt/) conditions, an observer on the network could view the ticket age and link a re-connection attempt with the previous connection. However, Golang TLS1.3 module [does not support 0-RTT](https://github.com/golang/go/blob/1ce7fcf139417d618c2730010ede2afb41664211/src/crypto/tls/handshake_server_tls13.go#L273) and does not check the obfuscated ticket's age during its normal operation anyways. This means that the only issue is Golang TLS1.3 not abiding by the RFC 8446 standard and sending a constant (0) age addition field instead of a random one, even though the field is not being used.",
    "technicalDescription": "[RFC 8446 section 4.6.1](https://datatracker.ietf.org/doc/html/rfc8446#section-4.6.1) requires that `ticket_age_add` holds a random 32-bit value when sending ticket data in order to obfuscate the ticket's age. However, Golang's `sendSessionTickets` function in `src/crypto/tls/handshake_server_tls13.go` always uses 0. This was fixed by sending a random value instead.",
    "publishedDate": "2022-05-19T15:46:26.130Z",
    "updatedDate": "2022-08-30T14:04:28.832Z",
    "disclosureDate": "2022-05-10T00:00:00.000Z",
    "exploitPublishDate": "2022-05-10T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.17.11**](https://github.com/golang/go/releases/tag/go1.17.11) by [this](https://github.com/golang/go/commit/c15a8e2dbb) commit,\n* [**1.18.3**](https://github.com/golang/go/releases/tag/go1.18.3) by [this](https://github.com/golang/go/commit/c838098c32) commit,\n* [**1.19-beta1**](https://github.com/golang/go/releases/tag/go1.19beta1) by [this](https://github.com/golang/go/commit/fe4de36198) commit.\n\nThe latest stable releases can be found [here](https://github.com/golang/go/tags).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 1.8,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.2,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:A/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.1,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.6,
        "severity": "LOW",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.8
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "nervuri (GitHub)",
    "workaround": "",
    "vendorFixDate": "2022-05-27T00:00:00.000Z",
    "vendorNotifiedDate": "2022-05-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1387",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-358"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-30629",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1387/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.cloudflare.com/introducing-0-rtt/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://datatracker.ietf.org/doc/html/rfc8446#section-4.6.1",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/blob/1ce7fcf139417d618c2730010ede2afb41664211/src/crypto/tls/handshake_server_tls13.go#L273",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/c15a8e2dbb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/c838098c32",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/fe4de36198",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/issues/52814",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/issues/52814",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases/tag/go1.17.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases/tag/go1.18.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases/tag/go1.19beta1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1387/default-remediation-status"
            }
        ]
    }
}