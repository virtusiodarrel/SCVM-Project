{
    "source": "BDSA",
    "name": "BDSA-2021-2891",
    "title": "Passport-SAML Vulnerable to Denial-of-Service (DoS) via Insufficient Transform Restrictions",
    "description": "Passport-SAML is vulnerable to denial-of-service (DoS) due to insufficient restrictions being placed on transformations for signed nodes. A remote attacker could impact the performance of the application, or cause a crash, by passing the application a malicious SAML payload as input.",
    "technicalDescription": "The function `validateSignature()`, of file `src/node-saml/saml.ts`, ensures that the signatures of signed nodes are valid. The nodes that are contained in a given document can specify transforms that are to be performed by the application. However, the application fails to impose restrictions on the number of transforms that are to be performed. An attacker could provide the application with a malicious SAML payload which contains signed nodes that specify an excessive number of transforms. The evaluation of these transforms will consume an excessive amount of resources, which will impact the performance of the application. It may also be possible for the attacker to cause the application to crash, which will result in a DoS.\n\nThe vulnerability was fixed via the addition of code to `validateSignature()` which ensures that no more than two transforms are to be performed for a signed node.",
    "publishedDate": "2021-09-29T12:24:17.334Z",
    "updatedDate": "2021-09-29T12:24:17.321Z",
    "disclosureDate": "2021-08-27T00:00:00.000Z",
    "solution": "Fixed in version [**3.1.0**](https://github.com/node-saml/passport-saml/releases/tag/v3.1.0) by [this](https://github.com/node-saml/passport-saml/commit/f1e00b64c21a725f545e675cd810bbaa435a3972) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/passport-saml).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-05-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2891",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39171",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2891/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/node-saml/passport-saml/commit/f1e00b64c21a725f545e675cd810bbaa435a3972",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/node-saml/passport-saml/pull/595",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/node-saml/passport-saml/releases/tag/v3.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/node-saml/passport-saml/security/advisories/GHSA-5379-r78w-42h2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/passport-saml",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2891/default-remediation-status"
            }
        ]
    }
}