{
    "source": "BDSA",
    "name": "BDSA-2022-1270",
    "title": "Rsyslog Vulnerable to Remote Code Execution (RCE) via Heap-Based Buffer Overflow in TCP syslog Server",
    "description": "Rsyslog is vulnerable to remote code execution (RCE) due to improper validation of input data when octet-counted framing is used. An attacker could exploit this vulnerability by supplying a system with maliciously crafted messages.\n\nThe vendor states that RCE \"is unlikely to happen but not impossible\".",
    "technicalDescription": "The issue exists within the files `contrib/imhttp/imhttp.c`, `plugins/imptcp/imptcp.c` and `runtime/tcps_sess.c`. Insufficient bounds checking when reading octet counts before writing digits to a heap buffer can allow an overflow of the buffer to be performed up to the end of the input digit sequence.\n\nThe vendor states the following regarding their assessed likelihood of exploitation:\n> Once the sequence of digits stop, no additional characters can be added to the buffer. In our opinion, this makes remote exploits impossible or at least highly complex.\n\nThis vulnerability affects the following modules:\n* `imtcp`\n* `imptcp`\n* `imhttp`\n* `imgssapi`\n* `imdiag`",
    "publishedDate": "2022-05-06T12:19:30.292Z",
    "updatedDate": "2022-08-23T10:45:14.774Z",
    "disclosureDate": "2022-05-05T00:00:00.000Z",
    "solution": "Fixed in version [**8.2204.1**](https://github.com/rsyslog/rsyslog/releases/tag/v8.2204.1) by [this](https://github.com/rsyslog/rsyslog/commit/89955b0bcb1ff105e1374aad7e0e993faa6a038f) commit.\n\nThe latest stable releases can be found [here](https://www.rsyslog.com/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Pieter Agten",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, the vendor recommends turning off octet-counted framing for the most important modules:\n> * For imtcp. imptcp, add `SupportOctetCountedFraming=\"off\"` to the input() definition.\nDocs: https://www.rsyslog.com/doc/v8-stable/configuration/modules/imtcp.html, https://www.rsyslog.com/doc/v8-stable/configuration/modules/imptcp.html, https://www.rsyslog.com/doc/v8-stable/configuration/modules/imhttp.html\n> * For imgssapioctet.-counted framing cannot be turned off.\n> * For imdiag octect-counted framing cannot be turned off. However, imdiag should never be present on production systems.\n> \n> Note that while octet-counted framing can be disabled sending systems have to explicitly enable it, but by default receiving systems autodetect if it's in use. The 'normal' reason to enable it is if you are sending logs with embedded newlines.",
    "vendorFixDate": "2022-05-05T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1270",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24903",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1270/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rsyslog/rsyslog/commit/89955b0bcb1ff105e1374aad7e0e993faa6a038f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rsyslog/rsyslog/releases/tag/v8.2204.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rsyslog/rsyslog/security/advisories/GHSA-ggw7-xr6h-mmr8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rsyslog/rsyslog/security/advisories/GHSA-ggw7-xr6h-mmr8",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.rsyslog.com/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1270/default-remediation-status"
            }
        ]
    }
}