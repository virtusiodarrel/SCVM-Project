{
    "source": "BDSA",
    "name": "BDSA-2022-1579",
    "title": "Gitlab Vulnerable to Project Deploy Token Misuse via Improper Authorization due to Insufficient IP Restrictions",
    "description": "Gitlab does not have sufficient IP restrictions in place for the use of project deploy tokens. This can allow an attacker to misuse a valid project deploy token from arbitrary locations.",
    "technicalDescription": "Exploiting this flaw will require an attacker to possess a valid project deploy token. Because of insufficient IP restrictions in place, the attacker can misuse this token from arbitrary locations.\n\nThe vendor addressed this flaw by tightening the IP restrictions to ensure that the deploy token does not work outside these restrictions.",
    "publishedDate": "2022-06-07T10:57:07.807Z",
    "updatedDate": "2022-06-07T10:57:07.784Z",
    "disclosureDate": "2022-06-03T00:00:00.000Z",
    "solution": "Fixed in:\n* **[14.9.5](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.9.5)** by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/b429997e253110ea5eb4d20a8b90e9879be97300) commit,\n* **[14.10.4](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.10.4)** by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/8866d00e50f1d2857d54130239851f21404d7432) commit,\n* **[15.0.1](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v15.0.1)** by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/3af76bc31e2d141e2262d65eb08fcab7f34844bf) commit.\n\nThe latest stable releases can be found [here](https://gitlab.com/gitlab-org/gitlab-foss/-/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "",
    "workaround": "",
    "vendorFixDate": "2022-06-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1579",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-1936",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1579/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2022/06/01/critical-security-release-gitlab-15-0-1-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.10.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.9.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v15.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/3af76bc31e2d141e2262d65eb08fcab7f34844bf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/8866d00e50f1d2857d54130239851f21404d7432",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/b429997e253110ea5eb4d20a8b90e9879be97300",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1579/default-remediation-status"
            }
        ]
    }
}