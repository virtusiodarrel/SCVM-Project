{
    "source": "BDSA",
    "name": "BDSA-2019-3966",
    "title": "Xen vulnerable to Privilege Escalation via Race Condition in Pagetable Promotion and Demotion Operations due to Incomplete Fix",
    "description": "Due to an incomplete fix for CVE-2019-18421 Xen is prone to a local privilege-escalation vulnerability allowing a local attacker to gain elevated privileges on affected computers.",
    "technicalDescription": "CVE-2019-18421 identifies a vulnerability in restartable PV type change operations which were addressed in [**XSA-299**](https://xenbits.xen.org/xsa/advisory-299.html).  As a result of untested edge cases in the fix for CVE-2019-18421, an x86 paravisualisation (PV) guest with guest administration access could leverage this vulnerability to acquire privileges on the affected system.\n\nOnly x86 systems are affected.",
    "publishedDate": "2019-12-24T14:55:52.950Z",
    "updatedDate": "2019-12-24T14:56:05.144Z",
    "disclosureDate": "2019-12-11T00:00:00.000Z",
    "solution": "Fixed in [**4.13.0-rc5**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/tags/4.13.0-rc5) with the following commits:\n* [**x86/mm: Set-old_guest_table-when-destroying-vcpu-page**](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ececa12b2c4c8e4433e4f9be83f5c668ae36fe08)\n* [**x86/mm: alloc-free_lN_table-Retain-partial_flags-on-E**](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=4e70f4476c0c543559f971faecdd5f1300cddb0a)\n* [**x86/mm: relinquish_memory-Grab-an-extra-type-ref-when**](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=66bdc16aeed8ddb2ae724adc5ea6bde0dea78c3d)\n\nand also in the following branches awaiting release:\n* [**4.12.x**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.12)\n* [**4.11.x**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.11)\n* [**4.10.x**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.10)\n* [**4.9.x**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.9) \n* [**4.8.x**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.8)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Sarah Newman",
    "workaround": "The vendor recommends to limit local access to trusted individuals and use restricted environments and restricted shells.\n\nRunning only HVM or PVH guests will avoid this vulnerability.\n\nRunning PV guests in \"shim\" mode will also avoid this vulnerability.",
    "vendorFixDate": "2019-12-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3966",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19580",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3966/ranges"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=4e70f4476c0c543559f971faecdd5f1300cddb0a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=66bdc16aeed8ddb2ae724adc5ea6bde0dea78c3d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ececa12b2c4c8e4433e4f9be83f5c668ae36fe08",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-310.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-310.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/xen-project-archives/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3966/default-remediation-status"
            }
        ]
    }
}