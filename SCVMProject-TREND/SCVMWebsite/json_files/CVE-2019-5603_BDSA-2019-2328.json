{
    "source": "BDSA",
    "name": "BDSA-2019-2328",
    "title": "FreeBSD Vulnerable to Information Exposure and Privilege Escalation via Reference Count Overflow in 'mqueue' Filesystem",
    "description": "FreeBSD is vulnerable to information exposure and privilege escalation due to improper reference management in the message queue file system `mqueuefs`. This could allow a local attacker to obtain sensitive information opened by processes owned by other users on a target system, and beyond any jailed access. In the worst case this could allow an attacker with jailed root privileges to escalate to full root privileges on the system.",
    "technicalDescription": "The non-default `mqueuefs` does not always properly release references to data structures such as open files, directories and sockets obtained by system calls operating on file descriptors for the data, which can lead to an overflow of the reference count. This could allow an attacker to access such data opened by processes owned by other users. If the attacker's access to the system is jailed and the targeted data represents a directory outside their jail, this could allow them to access files also outside their jail. Furthermore, if they have jailed root access on the system this could also allow them to escalate to root privileges.",
    "publishedDate": "2019-07-26T13:49:09.443Z",
    "updatedDate": "2020-01-02T12:20:55.895Z",
    "disclosureDate": "2019-07-24T00:00:00.000Z",
    "exploitPublishDate": "2019-12-30T00:00:00.000Z",
    "solution": "Fixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=350284) commit in:\n* **[12.0-RELEASE-p8](https://www.freebsd.org/releases/)**\n* **[11.3-RELEASE-p1](https://www.freebsd.org/releases/)**\n* **[11.2-RELEASE-p12](https://www.freebsd.org/releases/)**",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:L/AC:H/Au:N/C:C/I:C/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.9
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mateusz Guzik",
    "workaround": "",
    "vendorFixDate": "2019-07-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2328",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-911"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5603",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2328/ranges"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=350284",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/47830",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-19:15.mqueuefs.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2328/default-remediation-status"
            }
        ]
    }
}