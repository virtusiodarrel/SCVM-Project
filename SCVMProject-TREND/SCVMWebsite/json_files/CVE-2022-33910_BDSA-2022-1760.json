{
    "source": "BDSA",
    "name": "BDSA-2022-1760",
    "title": "MantisBT Vulnerable to Stored Cross-Site Scripting (XSS) via Malicious SVG File Upload",
    "description": "MantisBT has a stored cross-site scripting (XSS) vulnerability due to insufficient input file validation. A remote attacker could inject JavaScript code into dynamically generated web content in order to steal a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "This vulnerability exists because the application insufficiently validates SVG files that have been uploaded alongside an issue/bug report. To exploit this flaw, an attacker could craft an SVG file containing malicious JavaScript code and upload this file as an attachment on the server. When a victim accesses the corresponding issue/bug report, the JavaScript code will execute in the victim's browser. This can lead to theft of session tokens and cookies.\n\nThis issue was fixed by disallowing SVG file uploads as well as forcing the download of files which have the `image/svg+xml` MIME type.",
    "publishedDate": "2022-06-27T10:49:04.404Z",
    "updatedDate": "2022-06-27T10:49:04.387Z",
    "disclosureDate": "2022-06-24T00:00:00.000Z",
    "exploitPublishDate": "2022-05-25T00:00:00.000Z",
    "solution": "Fixed in version [**2.25.5**](https://github.com/mantisbt/mantisbt/releases/tag/release-2.25.5) by [this](https://github.com/mantisbt/mantisbt/commit/266762193fc6c09ffc6b14f5a34c86eae3ebee20) and [this](https://github.com/mantisbt/mantisbt/commit/262ecdde3b361639cbd7df2c8de23d44706010aa) commit.\n\nThe latest stable releases can be found [here](https://github.com/mantisbt/mantisbt/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Devendra Bhatla and Febin Mon Saji",
    "workaround": "",
    "vendorFixDate": "2022-06-23T00:00:00.000Z",
    "vendorNotifiedDate": "2021-10-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1760",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-33910",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1760/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mantisbt/mantisbt/commit/262ecdde3b361639cbd7df2c8de23d44706010aa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mantisbt/mantisbt/commit/266762193fc6c09ffc6b14f5a34c86eae3ebee20",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mantisbt/mantisbt/releases/tag/release-2.25.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mantisbt/mantisbt/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mantisbt.org/blog/archives/mantisbt/719",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://mantisbt.org/bugs/view.php?id=29135",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://mantisbt.org/bugs/view.php?id=30384",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1760/default-remediation-status"
            }
        ]
    }
}