{
    "source": "BDSA",
    "name": "BDSA-2020-0932",
    "title": "Samba Vulnerable to Denial-of-Service (DoS) via Stack Overflow with Deeply Nested Search Filters",
    "description": "Samba is vulnerable to denial-of-service (DoS) due to insufficient restrictions on LDAP search queries. An unauthenticated attacker could exploit this vulnerability by supplying a system with maliciously crafted LDAP requests.",
    "technicalDescription": "Samba does not sufficiently restrict LDAP search filters from using deeply nested expressions. The recursive definition of the search filter structure, which is mirrored in Samba's recursive parser, can result in excessive memory consumption for each search request sent. This could allow unauthenticated, maliciously crafted search requests to overflow the stack of the LDAP server and cause a DoS condition.\n\nThe vendor addresses this issue by implementing pre-parse limits on LDAP searches, all unauthenticated packets, other authenticated packets and CLDAP packets. Parameters are introduced in `smb.conf` which enforce maximum packet size limits for authenticated connections, anonymous connections and searches.",
    "publishedDate": "2020-04-30T09:00:51.350Z",
    "updatedDate": "2020-04-30T09:00:51.335Z",
    "disclosureDate": "2020-04-28T00:00:00.000Z",
    "solution": "Fixed in:\n* **[4.12.2](https://github.com/samba-team/samba/releases/tag/samba-4.12.2)**\n* **[4.11.8](https://github.com/samba-team/samba/releases/tag/samba-4.11.8)**\n* **[4.10.15](https://github.com/samba-team/samba/releases/tag/samba-4.10.15)**\n\nFixed by these commits:\n* [Commit 1](https://github.com/samba-team/samba/commit/74986c179ea66d1cefda3ff6bb6338b618da451f)\n* [Commit 2](https://github.com/samba-team/samba/commit/109b128ec1db7ffc90c43c075d86b1c3de344cba)\n* [Commit 3](https://github.com/samba-team/samba/commit/48a3bdd7703ad3952f45e04c4f0a8d289ae74190)\n* [Commit 4](https://github.com/samba-team/samba/commit/db78f2667eb51c106c66edebcf66914ea580bfc6)\n* [Commit 5](https://github.com/samba-team/samba/commit/71b92c9554d2e92281c6ce7f0340def2e6c0623c)\n* [Commit 6](https://github.com/samba-team/samba/commit/16da9c6e3d87d11e358441804dc7ff842eb5a9e7)\n* [Commit 7](https://github.com/samba-team/samba/commit/8729c05b1cd6a63d9f8e163b2e438007db3eb4f8)\n* [Commit 8](https://github.com/samba-team/samba/commit/4aeb07ef49e4e8734fc5f5cd092bbf165e9cc9f3)\n\nThe latest stable releases are available [here](https://www.samba.org/samba/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "OSS-Fuzz",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, patches for **4.12.1**, **4.11.7** and **4.10.14** are available [here](https://www.samba.org/samba/history/security.html).\n\nThe vendor states that as a mitigation for LDAP only, the `-M standard` parameter to the Samba binary should be used - however this will use more memory, may allow resource exhaustion, and will still leave the CLDAP server vulnerable. Samba versions from **4.10** run using this parameter by default.",
    "vendorFixDate": "2020-04-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0932",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-674"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10704",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0932/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.samba.org/show_bug.cgi?id=14334",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/109b128ec1db7ffc90c43c075d86b1c3de344cba",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/16da9c6e3d87d11e358441804dc7ff842eb5a9e7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/48a3bdd7703ad3952f45e04c4f0a8d289ae74190",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/4aeb07ef49e4e8734fc5f5cd092bbf165e9cc9f3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/71b92c9554d2e92281c6ce7f0340def2e6c0623c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/74986c179ea66d1cefda3ff6bb6338b618da451f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/8729c05b1cd6a63d9f8e163b2e438007db3eb4f8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/db78f2667eb51c106c66edebcf66914ea580bfc6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.10.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.11.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.12.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/security/CVE-2020-10704.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/security/CVE-2020-10704.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0932/default-remediation-status"
            }
        ]
    }
}