{
    "source": "BDSA",
    "name": "BDSA-2020-1987",
    "title": "Mahara Vulnerable to Persistent Cross-Site Scripting (XSS) via Crafted File or Folder Name",
    "description": "Mahara is vulnerable to persistent cross-site scripting (XSS) attacks.  An attacker with the ability to upload files or create folders is able to inject and store Javascript on the Mahara backend.  The malicious code will execute when any user views the file or folder in their browser.",
    "technicalDescription": "The XSS is due to a lack of sanitization within the `.append()` function used for filenames, descriptions, and folder names in `htdocs/artefact/file/js/filebrowser.js` and `htdocs/theme/raw/js/filebrowser.js`.  \n\nThis has been fixed by replacing the unsafe `.append()` function with `.text()`.  This removes HTML markup from the uploaded content.",
    "publishedDate": "2020-08-10T13:02:11.504Z",
    "updatedDate": "2020-08-10T13:02:11.496Z",
    "disclosureDate": "2020-08-04T00:00:00.000Z",
    "exploitPublishDate": "2020-08-04T00:00:00.000Z",
    "solution": "Fixed in:\n\n* [**19.4.6**](https://github.com/MaharaProject/mahara/releases/tag/19.04.6_RELEASE) by [this](https://github.com/MaharaProject/mahara/commit/4c75eff27e1edd45c094861081253fe39bba994f) commit.\n* [**19.10.4**](https://github.com/MaharaProject/mahara/releases/tag/19.10.4_RELEASE) by [this](https://github.com/MaharaProject/mahara/commit/a66daef5403a5da54c8409f9900580928b899bdb) commit\n* [**20.04.1**](https://github.com/MaharaProject/mahara/releases/tag/20.04.1_RELEASE) by [this](https://github.com/MaharaProject/mahara/commit/1a3a8fe673eb0205c7912f9a6fdd564b67196be8) commit\n\nThe latest stable releases are available [here](https://mahara.org/view/view.php?id=135849).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Adesh Nandkishor Kolte",
    "workaround": "",
    "vendorFixDate": "2020-08-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1987",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15907",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1987/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/mahara/+bug/1888163",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/mahara/+bug/1888163",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/commit/1a3a8fe673eb0205c7912f9a6fdd564b67196be8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/commit/4c75eff27e1edd45c094861081253fe39bba994f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/commit/a1c71626ef32b527ab652fb374fd77c55bf1b15a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/commit/a66daef5403a5da54c8409f9900580928b899bdb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/releases/tag/19.04.6_RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/releases/tag/19.10.4_RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/releases/tag/20.04.1_RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mahara.org/view/view.php?id=135849",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1987/default-remediation-status"
            }
        ]
    }
}