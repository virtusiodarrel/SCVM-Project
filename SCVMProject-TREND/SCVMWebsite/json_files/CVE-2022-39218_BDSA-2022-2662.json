{
    "source": "BDSA",
    "name": "BDSA-2022-2662",
    "title": "Fastly 'js-compute' Vulnerable to Security Bypass via Predictable Random Number Generation",
    "description": "js-compute is vulnerable to a security bypass issue due to how the initial seed for the CSPRNG (cryptographically secure pseudorandom number generator) is baked into the final `WebAssembly` module. This means that the sequence of numbers generated is predictable for that specific `WebAssembly` module.\n\nAn attacker with access to the same `WebAssembly` module that calls the `Math.random()` or `crypto.getRandomValues()` methods could use the fixed seed to predict the generated numbers which in turn could be used to decrypt potentially sensitive information.",
    "technicalDescription": "To remedy this issue, the vendor has updated the implementations of both `Math.random` and `crypto.getRandomValues` to not rely on Wizer and the flawed seed to the CSPRNG, and instead to make use of WASI (WebAssembly System Interface) libc\u2019s `random_get()` function which the vendor has determined provides a sufficiently random value.",
    "publishedDate": "2022-09-23T16:30:24.064Z",
    "updatedDate": "2022-09-23T16:30:24.053Z",
    "disclosureDate": "2022-09-16T00:00:00.000Z",
    "solution": "Fixed in [**0.5.3**](https://www.npmjs.com/package/@fastly/js-compute/v/0.5.3) by the following commits:\n* [Commit 1](https://github.com/fastly/js-compute-runtime/commit/65524ffc962644e9fc39f4b368a326b6253912a9)\n* [Commit 2](https://github.com/fastly/js-compute-runtime/commit/1912b10ca849d6d49591e122007ace453756e492)\n* [Commit 3](https://github.com/fastly/js-compute-runtime/commit/6c351a0571db8658d70c31c713ab232b3b2ec267)\n* [Commit 4](https://github.com/fastly/js-compute-runtime/commit/753a1e72b94a46943c6c567a701ee2207e8a5798)\n* [Commit 5](https://github.com/fastly/js-compute-runtime/commit/4445618e37471c1e550993be2c49bbc803964cf2)\n* [Commit 6](https://github.com/fastly/js-compute-runtime/commit/4fbbb849f95b94720f53a634417198e064f15666)\n* [Commit 7](https://github.com/fastly/js-compute-runtime/commit/26ccd4c7830219835bcf8c847297ef02381f08a0)\n* [Commit 8](https://github.com/fastly/js-compute-runtime/commit/648bd2a7bed6bd16cda461ba643207ebb6e695a7)\n* [Commit 9](https://github.com/fastly/js-compute-runtime/commit/fde55b08f69c1a8cbf7a3de4edccb9cabd9cb712)\n* [Commit 10](https://github.com/fastly/js-compute-runtime/commit/01bde6294057b704ead324d80ab666acf47e8c75)\n\nThe latest stable releases are available [here](https://www.npmjs.com/package/@fastly/js-compute).\n\n**Note**: The vendor has stated the following in the **0.5.3** [changelog](https://unpkg.com/@fastly/js-compute@0.5.3/CHANGELOG.md):\n> Developers should update affected modules after applying this patch. Any secrets generated using affected versions should be rotated. Any sensitive ciphertext generated using affected versions should be considered unsafe, e.g. and be deleted or re-generated.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "JakeChampion",
    "workaround": "",
    "vendorFixDate": "2022-09-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2662",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-335"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-39218",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2662/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/fastly/js-compute-runtime/commit/01bde6294057b704ead324d80ab666acf47e8c75",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/fastly/js-compute-runtime/commit/1912b10ca849d6d49591e122007ace453756e492",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/fastly/js-compute-runtime/commit/26ccd4c7830219835bcf8c847297ef02381f08a0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/fastly/js-compute-runtime/commit/4445618e37471c1e550993be2c49bbc803964cf2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/fastly/js-compute-runtime/commit/4fbbb849f95b94720f53a634417198e064f15666",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/fastly/js-compute-runtime/commit/648bd2a7bed6bd16cda461ba643207ebb6e695a7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/fastly/js-compute-runtime/commit/65524ffc962644e9fc39f4b368a326b6253912a9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/fastly/js-compute-runtime/commit/6c351a0571db8658d70c31c713ab232b3b2ec267",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/fastly/js-compute-runtime/commit/753a1e72b94a46943c6c567a701ee2207e8a5798",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/fastly/js-compute-runtime/commit/fde55b08f69c1a8cbf7a3de4edccb9cabd9cb712",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/fastly/js-compute-runtime/security/advisories/GHSA-cmr8-5w4c-44v8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://unpkg.com/@fastly/js-compute@0.5.3/CHANGELOG.md",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/@fastly/js-compute",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/@fastly/js-compute/v/0.5.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2662/default-remediation-status"
            }
        ]
    }
}