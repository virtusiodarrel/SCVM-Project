{
    "source": "BDSA",
    "name": "BDSA-2021-2456",
    "title": "Concrete5 Vulnerable to Remote Code Execution (RCE) via PHP Object Injection in 'logFile' Parameter",
    "description": "Concrete5 contains a remote code execution (RCE) vulneability.  This vulnerability requires an attacker to have administrative privileges on a system.  Successful exploitation can result in the execution of PHP code on a system running Concrete5.",
    "technicalDescription": "The RCE vulnerability is due to possible PHP object injection occurring in the `update_logging` function in `/concrete/controllers/single_page/dashboard/system/environment/logging.php`.   The function will check for a valid `.log` file that is supplied by a user using the `logFile` parameter. The `file_exists` function is used for this. This function is deemed unsafe when supplied with untrusted input since it will call unserialize on the file meta data. \n\nIf an attacker has administrative access on a system they can use the `phar://` stream wrapper to inject arbitrary PHP.",
    "publishedDate": "2021-08-16T13:17:54.759Z",
    "updatedDate": "2021-11-18T13:28:42.738Z",
    "disclosureDate": "2021-07-19T00:00:00.000Z",
    "exploitPublishDate": "2021-09-24T00:00:00.000Z",
    "solution": "Fixed in version [**9.0.0RC1**](https://github.com/concrete5/concrete5/releases/tag/9.0.0RC1) by [this](https://github.com/concrete5/concrete5/commit/2a729dcb8a682fb3c71bdfe813dcffc28896bcb1) commit.\n\nThe latest stable releases can be found [here](https://github.com/concrete5/concrete5/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Egidio Romano",
    "workaround": "",
    "vendorFixDate": "2021-07-27T00:00:00.000Z",
    "vendorNotifiedDate": "2020-12-20T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2456",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-36766",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2456/ranges"
            },
            {
                "rel": "reference",
                "href": "http://karmainsecurity.com/KIS-2021-05",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/concrete5/concrete5/commit/2a729dcb8a682fb3c71bdfe813dcffc28896bcb1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/concrete5/concrete5/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/concrete5/concrete5/releases/tag/9.0.0RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1063039",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/fulldisclosure/2021/Jul/36",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2456/default-remediation-status"
            }
        ]
    }
}