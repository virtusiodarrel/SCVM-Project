{
    "source": "BDSA",
    "name": "BDSA-2020-3912",
    "title": "Joomla! Vulnerable to SQL Injection (SQLi) via Improper Blacklist Configuration in 'users.php'",
    "description": "Joomla! contains a SQL injection (SQLi) vulnerability because of improper implementation of a blacklist. This could allow a remote attacker to extract, modify, and delete information from the database associated with the application.",
    "technicalDescription": "Usually, a variable `filter[excluded]` can be sent using GET and POST requests to the server which will then use it to construct a model state. The input from this variable is directly included in a SQL query without proper sanitization.  Subsequently, a model will be constructed in the following way `state := [ excluded => user_input ]`, where `user_input` could be any malicious code.\nEven though certain security measures like converting values from the state as integers have been implemented, the vulnerability still exists. This is because the value for the `excluded` variable will be overwritten later with the contents from the browser query. Thus, `excluded` will contain unsanitized user input which will be used in a SQL query. An attacker could exploit this flaw by injecting malicious queries via this variable.\nThis vulnerability has been fixed in `administrator/components/com_users/models/users.php` by the implementation of `$filterBlacklist` that prevents malicious values from merging into the model state.\n\n**Note** This vulnerability can only be exploited by attackers having access to the admin panel and having the ACL authorization to view the list of registered users.",
    "publishedDate": "2020-12-29T13:15:50.715Z",
    "updatedDate": "2021-01-18T11:31:07.860Z",
    "disclosureDate": "2020-11-30T00:00:00.000Z",
    "exploitPublishDate": "2020-11-30T00:00:00.000Z",
    "solution": "Fixed in [**3.9.23**](https://github.com/joomla/joomla-cms/releases/tag/3.9.23) by [this](https://github.com/joomla/joomla-cms/commit/435d780d9a87504267256033c5f6fb984f713ff9) commit.\n\nThe latest stable releases are available [here](https://downloads.joomla.org/cms).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ka1n4t",
    "workaround": "",
    "vendorFixDate": "2020-11-24T00:00:00.000Z",
    "vendorNotifiedDate": "2020-10-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3912",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-35613",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3912/ranges"
            },
            {
                "rel": "reference",
                "href": "https://developer.joomla.org/security-centre/831-20201104-core-sql-injection-in-com-users-list-view.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://downloads.joomla.org/cms",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/HoangKien1020/Joomla-SQLinjection",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/joomla/joomla-cms/commit/435d780d9a87504267256033c5f6fb984f713ff9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/joomla/joomla-cms/releases/tag/3.9.23",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.empressia.pl/blog/184-analiza-podatnosci-sql-injection-w-cms-joomla",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3912/default-remediation-status"
            }
        ]
    }
}