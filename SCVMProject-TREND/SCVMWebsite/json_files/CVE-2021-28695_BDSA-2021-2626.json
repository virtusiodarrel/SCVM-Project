{
    "source": "BDSA",
    "name": "BDSA-2021-2626",
    "title": "Xen Vulnerable to Privilege Escalation via IOMMU Discontinuous Memory Range Flaw on AMD Systems",
    "description": "Xen, on AMD systems, is vulnerable to privilege escalation, information exposure and denial-of-service (DoS) issues due to how specific memory ranges can be identity-mapped where a discontinuous range is specified.\n\n A local attacker could abuse this flaw in order to elevate their privileges, recover sensitive data from the application's memory, or cause the application to crash.\n \n **Note**: Only x86 AMD systems with IOMMUs and firmware specifying memory regions to be identity mapped are affected by this issue. The vulnerability is only exploitable by guests with access to physical devices (ie, via PCI passthrough).",
    "technicalDescription": "",
    "publishedDate": "2021-09-01T14:00:35.586Z",
    "updatedDate": "2022-08-25T10:41:39.021Z",
    "disclosureDate": "2021-08-25T00:00:00.000Z",
    "solution": "Fixed in:\n* the **staging-4.11** branch by [this](https://github.com/xen-project/xen/commit/c18e200eb657fd37b970aabbdae637878d055801) commit and [this](https://github.com/xen-project/xen/commit/3da2f2b0fce27a5de8d875671588580f210ec37c) commit,\n* the **staging-4.12** branch by [this](https://github.com/xen-project/xen/commit/724eebcaeb6663915ef5cff7ccffe2301e47f7c6) commit and [this](https://github.com/xen-project/xen/commit/dd59be6857707a61f73612ce73e0192921b58427) commit,\n* Fixed in [**4.13.4**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.4) by [this](https://github.com/xen-project/xen/commit/0ed0cdd17ffabd8aeb5a8db06bd21b0f0130a9f0) commit and [this](https://github.com/xen-project/xen/commit/ecb4697c50a00c29c8bfc784be7a308862b1c8a9) commit,\n* Fixed in [**4.14.3**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.3) by [this](https://github.com/xen-project/xen/commit/100b2e2d5ee0ea5549113ad6b15f4b532c13bcd7) commit and [this](https://github.com/xen-project/xen/commit/8da14912d229eeef969f0738ec98c61a29946d07) commit,\n* Fixed in [**4.15.1**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.1) by [this](https://github.com/xen-project/xen/commit/29a6cf118ce82afea292e23d8bbe329dc1e7bcb9) commit and [this](https://github.com/xen-project/xen/commit/92c8b9274db6b0c4e22ed0dff19b2611cf057921) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.6,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.7,
        "severity": "MEDIUM",
        "attackVector": "PHYSICAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.1/AV:P/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jan Beulich (SUSE)",
    "workaround": "The vendor has suggested [here](http://xenbits.xen.org/xsa/advisory-378.html) that the vulnerability can be mitigated by preventing guests from accessing physical devices. \n\nAn alternative workaround is to only allow untrusted guests to access physical devices \"whose firmware-provided ACPI tables declare identity mappings ... (Provided that there are no identity mapped regions which are specified by the ACPI tables to apply globally.)\".",
    "vendorFixDate": "2021-08-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2626",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28695",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2626/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/0ed0cdd17ffabd8aeb5a8db06bd21b0f0130a9f0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/100b2e2d5ee0ea5549113ad6b15f4b532c13bcd7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/29a6cf118ce82afea292e23d8bbe329dc1e7bcb9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/34750a3eb022462cdd1c36e8ef9049d3d73c824c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/3da2f2b0fce27a5de8d875671588580f210ec37c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/724eebcaeb6663915ef5cff7ccffe2301e47f7c6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/8da14912d229eeef969f0738ec98c61a29946d07",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/92c8b9274db6b0c4e22ed0dff19b2611cf057921",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/b02c5c88982411be11e3413159862f255f1f39dc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/c18e200eb657fd37b970aabbdae637878d055801",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/dd59be6857707a61f73612ce73e0192921b58427",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/ecb4697c50a00c29c8bfc784be7a308862b1c8a9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-378.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-378.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2626/default-remediation-status"
            }
        ]
    }
}