{
    "source": "BDSA",
    "name": "BDSA-2019-1105",
    "title": "Kubernetes Vulnerable to Firewall Rule Bypass by Incorrectly Prepended Rules via CNI Portmap Plugin",
    "description": "The firewall rules in front of a Kubernetes system may not work as intended because the CNI Portmap Plugin prepends rather than appends it's own firewall rules.",
    "technicalDescription": "The 'portmap' plugin is used to setup HostPorts for CNI. It mistakenly inserted the rules at the front of the iptables NAT chains, making them take precedence over the KUBE- SERVICES chain. The HostPort/portmap rule could therefore match incoming traffic even if there were more specific rules like  NodePorts.",
    "publishedDate": "2019-04-18T14:56:22.961Z",
    "updatedDate": "2019-04-18T14:56:22.900Z",
    "disclosureDate": "2019-03-28T00:00:00.000Z",
    "solution": "Fixed in CNI plugin version [**0.75**](https://github.com/containernetworking/plugins/releases/tag/v0.7.5) with [this](https://github.com/containernetworking/plugins/commit/f8fcb3525fc5c4a2bdc1a791b5c7b46a29ef4f04) commit.\n\nFixed in Kubernetes versions:\n* [**1.11.9**](https://github.com/kubernetes/kubernetes/releases/tag/v1.11.9). Fixed by [this](https://github.com/kubernetes/kubernetes/commit/8ec7cc4ac6343c85d5b5403855cbb698acb71dc6) commit.\n* [**1.12.7**](https://github.com/kubernetes/kubernetes/releases/tag/v1.12.7). Fixed by [this](https://github.com/kubernetes/kubernetes/commit/2e7d0997b3a8af662a7f7b9937ae177ac37e3698) commit.\n* [**1.13.5**](https://github.com/kubernetes/kubernetes/releases/tag/v1.13.5). Fixed by [this](https://github.com/kubernetes/kubernetes/commit/c3dde5d703dd7fb28b1eb2e9f6df545d1d51bccb) commit.\n* [**1.14.0**](https://github.com/kubernetes/kubernetes/releases/tag/v1.14.0). Fixed by [this](https://github.com/kubernetes/kubernetes/commit/bfd8ad32689c5054c5dc825d51f5be14df543119) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Etienne Champetier",
    "workaround": "",
    "vendorFixDate": "2019-02-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1105",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-684"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9946",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1105/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/containernetworking/plugins/commit/f8fcb3525fc5c4a2bdc1a791b5c7b46a29ef4f04",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/containernetworking/plugins/pull/269#issuecomment-477683272",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/containernetworking/plugins/releases/tag/v0.7.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/commit/2e7d0997b3a8af662a7f7b9937ae177ac37e3698",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/commit/8ec7cc4ac6343c85d5b5403855cbb698acb71dc6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/commit/bfd8ad32689c5054c5dc825d51f5be14df543119",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/commit/c3dde5d703dd7fb28b1eb2e9f6df545d1d51bccb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/releases/tag/v1.11.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/releases/tag/v1.12.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/releases/tag/v1.13.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/releases/tag/v1.14.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1105/default-remediation-status"
            }
        ]
    }
}