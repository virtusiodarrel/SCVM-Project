{
    "source": "BDSA",
    "name": "BDSA-2019-1260",
    "title": "Horde Form Vulnerable to Remote Code Execution (RCE) via PHP File Upload Using Relative Path Traversal with Image Uploads",
    "description": "Horde Form, as used in Horde Groupware Webmail Edition, is vulnerable to remote code execution (RCE) due to improper validation of image uploads allowing the upload of dangerous PHP files. This could allow an authenticated attacker to execute arbitrary commands on a victim's system.",
    "technicalDescription": "Functionality for uploading images in forms, within the file `Horde/Form/Type.php`, does not restrict the uploaded file type or sanitize the upload path. The POST parameter `object[photo][img][file]` can be manipulated using relative path traversal to insert a malicious PHP file into the web root directory (e.g. `../usr/share/horde/static/bd.php`). An authenticated attacker could exploit this using the default Turba address book, by adding a new contact and uploading a PHP webshell with a malicious POST request using the `Photo` file upload field. If uploaded successfully this will allow them to execute commands on the targeted system within the privileges of the application.",
    "publishedDate": "2019-04-26T14:07:54.864Z",
    "updatedDate": "2019-04-26T15:38:45.461Z",
    "disclosureDate": "2019-03-24T00:00:00.000Z",
    "exploitPublishDate": "2019-03-24T00:00:00.000Z",
    "solution": "Fixed in Horde Form version **[2.0.19](https://github.com/horde/Form/releases/tag/v2.0.19)** by [this](https://github.com/horde/Form/commit/c916ba979ad1613d76a9407dd0b67968a9594c0e) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "RatioSec Research",
    "workaround": "",
    "vendorFixDate": "2019-01-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1260",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-23"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9858",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1260/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/horde/Form/commit/c916ba979ad1613d76a9407dd0b67968a9594c0e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/horde/Form/commit/d4f19f689d5de5297742c19eca0f77137185adcb",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/horde/Form/releases/tag/v2.0.19",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.rapid7.com//db/modules/exploit/multi/http/horde_form_file_upload",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.ratiosec.com/2019/horde-groupware-webmail-authenticated-arbitrary-file-injection-to-rce/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.ratiosec.com/2019/horde-groupware-webmail-authenticated-arbitrary-file-injection-to-rce/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1260/default-remediation-status"
            }
        ]
    }
}