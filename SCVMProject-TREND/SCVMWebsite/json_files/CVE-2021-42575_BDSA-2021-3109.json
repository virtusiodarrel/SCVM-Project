{
    "source": "BDSA",
    "name": "BDSA-2021-3109",
    "title": "OWASP Java HTML Sanitizer Vulnerable to Cross-Site Scripting (XSS) via 'style' Tags in 'option' Elements",
    "description": "OWASP Java HTML Sanitizer is vulnerable to cross-site scripting (XSS) due to the improper sanitization of certain tags. An attacker could bypass the XSS filters and inject malicious code into dynamically generated web content in order to steal confidential information or execute actions on others' behalf.",
    "technicalDescription": "An application is vulnerable if it imports `org.owasp.html`, and calls the `allowElements()` method of the `HtmlPolicyBuilder` class with inputs that include the strings `option` and `style`.  Such input can correspond to `<style>` tags inside `<option>` elements. In that case, a payload such as `<select><option><style><script>alert(1)</script></style></option></select>` would result in XSS. The default configuration of OWASP Java HTML Sanitizer is not vulnerable.",
    "publishedDate": "2021-10-19T13:17:03.720Z",
    "updatedDate": "2022-02-18T15:47:05.396Z",
    "disclosureDate": "2021-10-18T00:00:00.000Z",
    "exploitPublishDate": "2021-10-18T00:00:00.000Z",
    "solution": "Fixed in version [**20211018.2**](https://github.com/OWASP/java-html-sanitizer/releases/tag/release-20211018.2) by  [this](https://github.com/owasp/java-html-sanitizer/commit/14f84fd49ebe68918b3aa0944a6a658674a39e6b) commit.\n\n**Note:** the vulnerability was initially fixed in [**20211018.1**](https://github.com/OWASP/java-html-sanitizer/releases/tag/release-20211018.2) by [this](https://github.com/owasp/java-html-sanitizer/commit/be33ec6962fa3938ec028873e269632d5d8fa55a) commit. However, the patch in **20211018.2** changes the initial fix and applies a different methodology of fixing this vulnerability.\n\nThe latest stable releases can be found [here](https://github.com/OWASP/java-html-sanitizer/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tom Anthony",
    "workaround": "",
    "vendorFixDate": "2021-10-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3109",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-42575",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3109/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.google.com/document/d/11SoX296sMS0XoQiQbpxc5pNxSdbJKDJkm5BDv0zrX50/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://docs.google.com/document/d/11SoX296sMS0XoQiQbpxc5pNxSdbJKDJkm5BDv0zrX50/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OWASP/java-html-sanitizer/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OWASP/java-html-sanitizer/releases/tag/release-20211018.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/owasp/java-html-sanitizer/commit/14f84fd49ebe68918b3aa0944a6a658674a39e6b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/owasp/java-html-sanitizer/commit/be33ec6962fa3938ec028873e269632d5d8fa55a",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3109/default-remediation-status"
            }
        ]
    }
}