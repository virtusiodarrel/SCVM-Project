{
    "source": "BDSA",
    "name": "BDSA-2021-1761",
    "title": "Zephyr L2CAP Implementation Vulnerable to   Reachable Assertion via L2CAP K-frame",
    "description": "Synopsys Cybersecurity Research Center (CyRC) has discovered a vulnerability in zephyr's L2CAP Implementation that can lead to denial-of-service (DoS).  An attacker can trigger this vulnerability by sending crafted L2CAP `K-frame` SDU to the target device.\n\nTriggering this vulnerability does not require authentication or encryption. The only requirement is that the device is in advertising mode and accepting connections, and that the attacker is within range of the Bluetooth device.",
    "technicalDescription": "This vulnerability occurs in `l2cap_chan_le_recv()` function in `zephyr/subsys/bluetooth/host/l2cap.c` where buffer size is not checked before fetching the SDU length from the buffer. An invalid SDU length can lead to assertion failure exception and denial of service.\n\nWhen assertions are disabled, the invalid SDU length causes the packet to be dropped.\n\nAn attacker is able to disrupt all the ongoing communication and cause  denial-of-service (DoS)  by sending a truncated L2CAP `K-frame` packet to any Zephyr based Bluetooth LE device which is advertising and open to connection.",
    "publishedDate": "2021-06-22T15:43:52.324Z",
    "updatedDate": "2021-06-22T15:43:52.317Z",
    "disclosureDate": "2021-06-12T00:00:00.000Z",
    "solution": "Fixed in [**2.6.0-rc1**]() with [this](https://github.com/zephyrproject-rtos/zephyr/commit/0ba94379381f3e58994a94497c327d7cad9c1227) commit.\nFix is backported to [**2.5-branch**](https://github.com/zephyrproject-rtos/zephyr/tree/v2.5-branch) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/61682bd6d96e854259d569357b1a63654b4d6ff2) commit.\nFix is backported to [**2.4-branch**](https://github.com/zephyrproject-rtos/zephyr/tree/v2.4-branch) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/3a06d3d523d89d07f6fa2131985bced38371ae94) commit.\nThe most recent release can be found [here](https://www.zephyrproject.org/developer-resources/#current-release).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:A/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matias Karhumaa  (Synopsys Cybersecurity Research Center   (CyRC))",
    "workaround": "",
    "vendorFixDate": "2021-02-24T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1761",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-617"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3454",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1761/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/0ba94379381f3e58994a94497c327d7cad9c1227",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/3a06d3d523d89d07f6fa2131985bced38371ae94",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/61682bd6d96e854259d569357b1a63654b4d6ff2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/pull/32588",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-fx88-6c29-vrp3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/policy",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v2.4-branch",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v2.5-branch",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v2.6.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synopsys.com/blogs/software-security/cyrc-advisory-zephyr-vulnerability/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.zephyrproject.org/developer-resources/#current",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1761/default-remediation-status"
            }
        ]
    }
}