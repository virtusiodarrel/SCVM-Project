{
    "source": "BDSA",
    "name": "BDSA-2022-1351",
    "title": "Strapi Vulnerable to Account Takeover via Information Leak in JSON Responses",
    "description": "Strapi is vulnerable to information leak flaws in several JSON responses. A remote authenticated attacker with access to the admin panel can leverage this to takeover other accounts that have a direct or indirect relationship through site functionality with the attacker user. One example is where a low-privileged \u201cAuthor\u201d role account can view these details in the JSON response for an \u201cEditor\u201d or \u201cSuper Admin\u201d that has updated one of the author\u2019s blog posts. The JSON response contains sensitive data that allows the attacker to hijack the password reset workflow and takeover the higher privileged users account. This has confidentiality, integrity and availability impacts.",
    "technicalDescription": "The problem exists in the **3.x** branch in the `shouldRemoveAttribute()`function of the `packages/strapi-utils/lib/sanitize-entity.js` file. It was not fully programmed to remove all sensitive information.\n\nIn the **4.x** branch the same underlying issue existed in the `packages/core/admin/server/services/permission/permissions-manager/sanitize.js` file in the `createSanitizeOutput()` function.\n\nThe issue was resolved in the **3.x** branch by adding special attributes to sensitive structures so they could be removed by `shouldRemoveAttribute()` in the sanitization code. The issue was resolved in the **4.x** branch  by removing  unallowed fields from `admin::user` relations in the sanitization code.",
    "publishedDate": "2022-05-19T13:18:31.653Z",
    "updatedDate": "2022-05-19T13:18:31.642Z",
    "disclosureDate": "2022-05-19T00:00:00.000Z",
    "exploitPublishDate": "2022-05-19T00:00:00.000Z",
    "solution": "Fixed in version [**3.6.10**](https://github.com/strapi/strapi/releases/tag/v3.6.10) by [these](https://github.com/strapi/strapi/pull/13189/commits) commits.\n\nFixed in version [**4.0.0-beta.16**](https://github.com/strapi/strapi/releases/tag/v4.0.0-beta.16) by [this](https://github.com/strapi/strapi/commit/ba25b7b651ff845d1c5037f74a4a53de8971f2e2) commit.\n\nThe latest releases can be found [here](https://github.com/strapi/strapi/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Synopsys",
    "workaround": "",
    "vendorFixDate": "2022-05-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1351",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-201"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-30617",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1351/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/strapi/strapi/commit/ba25b7b651ff845d1c5037f74a4a53de8971f2e2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/strapi/strapi/pull/13189/commits",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/strapi/strapi/releases/tag/v3.6.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/strapi/strapi/releases/tag/v4.0.0-beta.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/strapi/strapi/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synopsys.com/blogs/software-security/cyrc-advisory-strapi",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.synopsys.com/blogs/software-security/cyrc-advisory-strapi",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1351/default-remediation-status"
            }
        ]
    }
}