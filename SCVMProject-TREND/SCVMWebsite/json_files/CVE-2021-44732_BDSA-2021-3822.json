{
    "source": "BDSA",
    "name": "BDSA-2021-3822",
    "title": "Mbed TLS Vulnerable to Memory Corruption via Double-Free Following Out-of-Memory Error",
    "description": "Mbed TLS is vulnerable to memory corruption due to the improper management of system memory resources. An attacker could cause a double-free by triggering an error in the library's SSL session handling functionality. This could allow the attacker to cause the program to crash. The attacker may also be able to leverage this issue in order to modify data or execute arbitrary code, but this has not been demonstrated.",
    "technicalDescription": "The functions `mbedtls_ssl_set_session()` and  `mbedtls_ssl_get_session()`,  of file `library/ssl_tls.c`, can fail due to the insufficient availability of memory. The error code `MBEDTLS_ERR_SSL_ALLOC_FAILED` indicates that such a situation has occurred. If this error code is returned, then the invocation of `mbedtls_ssl_session_free()` and `mbedtls_ssl_free()` will cause a double-free to occur. An attacker that is able to trigger the aforementioned out-of-memory error could therefore leverage this double-free in order to corrupt the process's memory. This could allow the attacker to crash the application. The attacker may also be able to modify data or execute arbitrary code. However, such an attack has not been demonstrated.",
    "publishedDate": "2021-12-20T16:49:03.475Z",
    "updatedDate": "2021-12-20T16:49:03.465Z",
    "disclosureDate": "2021-12-14T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.1.0**](https://github.com/ARMmbed/mbedtls/releases/tag/v3.1.0).\n* [**2.28.0**](https://github.com/ARMmbed/mbedtls/releases/tag/v2.28.0).\n* [**2.16.12**](https://github.com/ARMmbed/mbedtls/releases/tag/v2.16.12).\n\nThe latest stable releases can be found [here](https://github.com/ARMmbed/mbedtls/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "duckPowerMB",
    "workaround": "The vendor has stated [here](https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2021-12) that the following workarounds can be implemented:\n\n> Either do not call `mbedtls_ssl_session_free()` (which will unfortunately cause a memory leak) or set the `mbedtls_ssl_session` field ticket to NULL manually, in the case where either `mbedtls_ssl_set_session()` or `mbedtls_ssl_get_session()` returns `MBEDTLS_ERR_SSL_ALLOC_FAILED`.",
    "vendorFixDate": "2021-12-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3822",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-415"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-664"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-44732",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3822/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ARMmbed/mbedtls/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ARMmbed/mbedtls/releases/tag/v2.16.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ARMmbed/mbedtls/releases/tag/v2.28.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ARMmbed/mbedtls/releases/tag/v3.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2021-12",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2021-12",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3822/default-remediation-status"
            }
        ]
    }
}