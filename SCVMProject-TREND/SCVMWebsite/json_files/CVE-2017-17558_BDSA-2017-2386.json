{
    "source": "BDSA",
    "name": "BDSA-2017-2386",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Write in 'usb_destroy_configuration' Function",
    "description": "Linux kernel contains an out-of-bounds (OOB) write vulnerability that can be used to cause a denial-of-service (DoS) condition.",
    "technicalDescription": "Linux kernel contains an out-of-bounds write vulnerability in the function `usb_destroy_configuration`  of file `drivers/usb/core/config.c `. This is within the USB core subsystem. This exists due to the lack of consideration for the maximum value of number of configurations and interfaces before attempting to release resources.\n\nA local attacker is able to exploit this via a USB device containing malicious descriptors which sets the value of `bNumInterfaces` too high causing the kernel to access unallocated memory. This results in a system crash resulting in a denial-of-service (DoS) condition and could result in overwrite of memory.",
    "publishedDate": "2017-12-20T12:58:50.199Z",
    "updatedDate": "2018-11-22T17:32:06.561Z",
    "disclosureDate": "2017-12-12T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.2.97**](https://www.kernel.org)\n* [**3.16.52**](https://www.kernel.org)\n* [**3.18.89**](https://www.kernel.org)\n* [**4.1.49**](https://www.kernel.org)\n* [**4.4.107**](https://www.kernel.org)\n* [**4.9.71**](https://www.kernel.org)\n* [**4.14.8**](https://www.kernel.org)\n* [**4.15-rc4**](https://www.kernel.org)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=48a4ff1c7bb5a32d2e396b03132d20d552c0eca7) git commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.6,
        "impactSubscore": 9.2,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 0.9,
        "severity": "MEDIUM",
        "attackVector": "PHYSICAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.0/AV:P/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "syzkaller",
    "workaround": "There is a third party [patch](https://www.spinics.net/lists/linux-usb/msg163644.html) available.",
    "vendorFixDate": "2017-12-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2386",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-17558",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2386/ranges"
            },
            {
                "rel": "reference",
                "href": "http://openwall.com/lists/oss-security/2017/12/12/7",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-17558",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=48a4ff1c7bb5a32d2e396b03132d20d552c0eca7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.spinics.net/lists/linux-usb/msg163644.html",
                "label": "WORKAROUND"
            }
        ]
    }
}