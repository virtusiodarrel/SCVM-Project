{
    "source": "BDSA",
    "name": "BDSA-2021-1671",
    "title": "OpenWRT Vulnerable to Cross-Site Scripting (XSS) via 'Hostname' Parameter in Web Interface (LuCI) 'Hostname Change' Functionality",
    "description": "OpenWRT, when using OpenWRT LuCI, is vulnerable to a stored cross-site scripting (XSS) issue due to a lack of sufficient input sanitization.\n\nAn authenticated attacker could use this issue in order to inject arbitrary scripts that run in a victim user's browser when they view the affected content.",
    "technicalDescription": "OpenWRT, when using OpenWRT LuCI, is vulnerable to stored cross-site scripting (XSS) because the `Hostname` parameter that is used in the 'hostname change' operation is not sufficiently sanitized. The content of this parameter is stored and displayed in an unsafe manner such that malicious scripts can be executed in a victim user's browser. This was addressed by adding the `strip_tags` function to sanitize the hostname.",
    "publishedDate": "2021-06-04T13:39:37.367Z",
    "updatedDate": "2021-12-01T15:30:33.448Z",
    "disclosureDate": "2021-05-20T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/openwrt/luci/commit/5cbd79d7e31c0f0feaea2770bf102bbae7831e3c) commit in Luci **main** branch.\n\nFixed in Openwrt [**19.07.8**](https://git.openwrt.org/?p=openwrt/openwrt.git;a=summary) by [this](https://github.com/openwrt/luci/commit/15ca915da92686dce86be05c205118f57ec7015a) commit and [**21.02.0**](https://git.openwrt.org/?p=openwrt/openwrt.git;a=summary) by [this](https://github.com/openwrt/luci/commit/139edfce8b2e9092255be78700eb3d57a564e54e) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-06-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1671",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33425",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1671/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.openwrt.org/?p=openwrt/openwrt.git;a=summary",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openwrt/luci/commit/139edfce8b2e9092255be78700eb3d57a564e54e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openwrt/luci/commit/15ca915da92686dce86be05c205118f57ec7015a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openwrt/luci/commit/5cbd79d7e31c0f0feaea2770bf102bbae7831e3c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openwrt/luci/pull/5109",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://openwrt.org/advisory/2021-08-01-2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.tenable.com/cve/CVE-2021-33425",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1671/default-remediation-status"
            }
        ]
    }
}