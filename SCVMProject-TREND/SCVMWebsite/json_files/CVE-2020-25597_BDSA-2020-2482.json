{
    "source": "BDSA",
    "name": "BDSA-2020-2482",
    "title": "Xen Vulnerable to Denial-of-Service (DoS) via Event Channels Reset Operation",
    "description": "Xen is vulnerable to a denial-of-service (DoS) condition due to a flaw present in event channel handling. An assumption is made that valid event channels will not become invalid over the life time of a guest. This assumption can lead to errors occurring as some operations can decrease certain bounds used to validate channels.\n\nAn attacker could trigger these errors by creating an unsupported amount of event channels and conducting an event channel reset operation. Xen can crash as a result of the error, leading to a denial-of-service scenario for the system.",
    "technicalDescription": "Xen is vulnerable to a denial-of-service (DoS) condition because operations, like the resetting of all event channels, can decrease bounds that are used to validate them. When an unsupported number of channels exist, this can lead to a crash.\n\nSystems where untrusted guests are permitted to create more than the default amount of event channels are affected, where this amount is:\n* **1023** for `32-bit X86 PV` guests, and\n* **4095** for `64-bit X86 PV` and `ARM` guests.\n\nThe vendor has also stated that `xl` and `libxl` limit the `max_event_channels` value to **1023** by default and that systems using `xl`, `libvirt+libxl`, or their own toolstack based on `libxl` while also not explicitly setting the `max_event_channels` value, are not affected by this issue.",
    "publishedDate": "2020-09-24T09:56:43.028Z",
    "updatedDate": "2022-02-02T09:27:47.004Z",
    "disclosureDate": "2020-09-22T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.14.1**](https://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=fae6f50c923abcd36267a20e6b20adc1a771084f) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e417504febf4ef5cc3442ebaa00da1a5c7939b22) commit,\n* [**4.13.2**](https://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=470e3aa86da501a2dfe3883ee340b9444bc8bcba) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ae922b9fc203cc3907b4feed5f2d50783b7c32d5) commit, \n* [**4.12.4**](https://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=f3be7536cc05514dc29cae2278e27c52d6c045e9) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b2db00754fc39971bb0ff8a60c54ae8a58c3d473) commit.\n\nFixed in the following branches by these commits which are not yet included in any release:\n* **staging-4.11** branch by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7284bfab0506f3281343689d08ff4731fcbebaa6) commit,\n* **staging-4.10** branch by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=f85223f4af24ba11a575d599a2ca7adb238d4046) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jan Beulich of SUSE",
    "workaround": "The vendor has suggested a [workaround](https://xenbits.xen.org/xsa/advisory-338.html):\n\nThe problem can be avoided by reducing the number of event channels available to the guest to no more than **1023**.  For example, setting `max_event_channels=1023` in the `xl` domain configuration, or deleting\nany existing setting (since 1023 is the default for `xl`/`libxl`).\n\nFor `ARM` systems, any limit no more than **4095** is safe.\n\nFor `64-bit x86 PV` guests, any limit no more than **4095** is likewise safe if the host configuration prevents the guest administrator from substituting and running a 32-bit kernel (and thereby putting the guest into 32-bit PV mode).",
    "vendorFixDate": "2020-09-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2482",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-119"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25597",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2482/ranges"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7284bfab0506f3281343689d08ff4731fcbebaa6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ae922b9fc203cc3907b4feed5f2d50783b7c32d5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b2db00754fc39971bb0ff8a60c54ae8a58c3d473",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e417504febf4ef5cc3442ebaa00da1a5c7939b22",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=f85223f4af24ba11a575d599a2ca7adb238d4046",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=470e3aa86da501a2dfe3883ee340b9444bc8bcba",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=f3be7536cc05514dc29cae2278e27c52d6c045e9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=fae6f50c923abcd36267a20e6b20adc1a771084f",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-338.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-338.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2482/default-remediation-status"
            }
        ]
    }
}