{
    "source": "BDSA",
    "name": "BDSA-2020-1931",
    "title": "Typo3 Vulnerable to Remote Code Execution (RCE) via Improper HMAC Verification in Legacy Components",
    "description": "Typo3 is vulnerable to remote code execution due to the possibility of generating arbitrary valid checksums. A remote authenticated attacker could use this to conduct arbitrary code execution on a vulnerable server by crafting malicious serialized objects that will pass HMAC verification checks.",
    "technicalDescription": "Typo3 verifies the HMAC checksums of query parameters using code that is contained within the script `ValidateHashEID.php`. Hashes for parameters are generated using `GeneralUtility::hmac()`. However, the scope in which the hashes are valid is ambiguous, such that it is possible to pass hashes within queries that will be successfully verified but are in fact invalid. This could allow an attacker to inject malicious serialized objects and other arbitrary data, potentially leading to remote code execution.",
    "publishedDate": "2020-07-31T15:35:51.842Z",
    "updatedDate": "2021-08-17T15:29:06.472Z",
    "disclosureDate": "2020-07-28T00:00:00.000Z",
    "solution": "Fixed in [**6.2.52**](https://get.typo3.org/release-notes/6.2.52) by [this](https://typo3.org/security/advisory/typo3-psa-2020-001) patch.\n\nThe latest stable releases are available [here](https://get.typo3.org).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Oliver Hader",
    "workaround": "",
    "vendorFixDate": "2020-07-02T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1931",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-347"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15086",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1931/ranges"
            },
            {
                "rel": "reference",
                "href": "https://get.typo3.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://get.typo3.org/release-notes/6.2.52",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-psa-2020-001",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-psa-2020-001",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1931/default-remediation-status"
            }
        ]
    }
}