{
    "source": "BDSA",
    "name": "BDSA-2017-1754",
    "title": "Wireless Protected Access Tunneled Direct-Link Setup Handshake Allows Reinstallation of the Tunneled Direct-Link Setup Peer Key",
    "description": "KRACK (Key Re-installation Attack) refers to a collection of vulnerabilities affecting products supporting the Wi-Fi Protected Access (WPA) and Wi-Fi Protected Access II (WPA2) protocols.  These vulnerabilities arise from design and implementation flaws in the underlying protocol itself.\n\nWPA and WPA2 in multiple products suffer from key re-installation attacks via protocol handshakes which can compromise the data-confidentiality layer.  Once encryption has been compromised, further attacks can be mounted against applications at the network layer.",
    "technicalDescription": "Tunneled Direct Link Setup (TDLS) enables 2 Wi-Fi Direct-certified devices to establish a connection between each other without using an Access Point (AP).  It was first described in IEEE 802.11z-2010, but researchers should refer to IEEE 802.11-2016 or latest specification available.\n\nThe specification states the following in section 8.5.9.1 \n\n*In order to maintain TPK confidentiality, both the TDLS initiator STA and the TDLS responder STAs must establish an RSNA with their common AP prior to executing the TDLS Peer Key Handshake. To meet this criteria, a STA may refuse to initiate the TDLS direct link if*\n\n1. The AP does not include an RSNIE in its Beacons and Probe Responses to advertise the availability of security;\n2. The AP\u2019s RSN IE indicates that WEP-40 (OUI 00-0F-AC:1) or WEP-104 (OUI 00-0F-AC:5) are enabled as either pairwise or group cipher suites; or\n3. The AP\u2019s RSN IE indicates that Use group cipher suite (00-0F-AC:0) is used as the pairwise cipher suite\n\nThe TDLS Peer Key (TPK) Handshake is vulnerable to a key re-installation attack.\n\nTo attack wpa_supplicant, a replay attack of Message 3 in the 4-Way handshake is sufficient to force a remote peer to reinstall a TPK.",
    "publishedDate": "2017-10-24T15:38:28.519Z",
    "updatedDate": "2020-11-27T16:39:24.430Z",
    "disclosureDate": "2017-10-16T00:00:00.000Z",
    "exploitPublishDate": "2017-10-16T00:00:00.000Z",
    "solution": "Fixed in [**2.7**](https://w1.fi/cgit/hostap/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.2,
        "impactSubscore": 9.2,
        "exploitabilitySubscore": 3.2,
        "severity": "MEDIUM",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "(AV:A/AC:H/Au:N/C:C/I:C/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mathy Vanhoef and Frank Piessens",
    "workaround": "",
    "vendorFixDate": "2017-10-02T00:00:00.000Z",
    "vendorNotifiedDate": "2017-07-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1754",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-323"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-13086",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1754/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vanhoefm/krackattacks",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://lirias.kuleuven.be/bitstream/123456789/572634/1/asiaccs2017.pdf",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://papers.mathyvanhoef.com/ccs2017.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/security/2017-1/rebased-v2.6-0006-TDLS-Reject-TPK-TK-reconfiguration.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/security/2017-1/wpa-packet-number-reuse-with-replayed-messages.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.blackhat.com/docs/us-17/wednesday/us-17-Vanhoeft-WiFuzz-Detecting-And-Exploiting_Logical-Flaws-In-The-Wi-Fi-Cryptographic-Handshake-wp.pdf",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.kb.cert.org/vuls/id/228519",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.krackattacks.com/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.wi-fi.org/discover-wi-fi/specifications",
                "label": "LINK"
            }
        ]
    }
}