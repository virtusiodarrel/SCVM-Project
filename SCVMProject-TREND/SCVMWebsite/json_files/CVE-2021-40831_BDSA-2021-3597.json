{
    "source": "BDSA",
    "name": "BDSA-2021-3597",
    "title": "AWS IoT Device SDK v2 Vulnerable to Broker Spoofing via Improper Certificate Authority Override",
    "description": "Amazon Web Services (AWS) IoT Device SDK v2is vulnerable to MQTT broker spoofing due to the improper implementation of Certificate Authority (CA) override functionality. This can allow an attacker to either drop traffic or inject responses on a client connection, however they will not be able to forward this data on to the MQTT broker.\n\n**Note:** This vulnerability affects AWS IoT Device SDK v2 for Java, Python, C++ and Node.js on macOS.",
    "technicalDescription": "This vulnerability exists in the `aws_tls_ctx_options_override_default_trust_store()` function of the `source/tls_channel_handler.*` files of the aws-c-io submodule of Amazon Web Services. This could allow an attacker with access to a host's trust stores to bypass Certificate Authority pinning.",
    "publishedDate": "2022-02-02T09:59:59.856Z",
    "updatedDate": "2022-02-02T09:59:59.841Z",
    "disclosureDate": "2021-06-15T00:00:00.000Z",
    "solution": "Fixed in AWS-C-IO [**0.10.8**](https://github.com/awslabs/aws-c-io/releases/tag/v0.10.7) by [this](https://github.com/awslabs/aws-c-io/commit/3500d3fdcf1c4f806345c42a9dcdb95284a6b1b8) commit.\n\nFixed in AWS IoT Device SDK for Java [**1.5.0**](https://github.com/aws/aws-iot-device-sdk-java-v2/releases/tag/v1.5.0) by [this](https://github.com/aws/aws-iot-device-sdk-java-v2/commit/46375e9b1bfb34109b9ff3b1eff9c770f9daa186) commit.\n\nFixed in AWS IoT Device SDK for Python [**1.7.0**](https://github.com/aws/aws-iot-device-sdk-python-v2/releases/tag/v1.7.0) by [this](https://github.com/aws/aws-iot-device-sdk-python-v2/commit/5aef82573202309063eb540b72cee0e565f85a2d) commit.\n\nFixed in AWS IoT Device SDK for C++ [**1.14.0**](https://github.com/aws/aws-iot-device-sdk-cpp-v2/releases/tag/v1.14.0) by [this](https://github.com/aws/aws-iot-device-sdk-cpp-v2/commit/ef0b21fcb346a0b344986aeb092bf9cb3f71f6cd) commit.\n\nFixed in AWS IoT Device SDK for Node.js [**1.6.0**](https://github.com/aws/aws-iot-device-sdk-js-v2/releases/tag/v1.6.0) by [this](https://github.com/aws/aws-iot-device-sdk-js-v2/commit/22f1989f5bdb0bdd9c912a5a2d255ee6c0854f68) commit.\n\nThe latest stable releases of AWS-C-IO are available [here](https://github.com/awslabs/aws-c-io/tags)\n\nThe latest stable releases of AWS IoT Device SDK for Java are available [here](https://github.com/aws/aws-iot-device-sdk-java-v2/tags)\n\nThe latest stable releases of AWS IoT Device SDK for Python are available [here](https://github.com/aws/aws-iot-device-sdk-python-v2/tags)\n\nThe latest stable releases of AWS IoT Device SDK for C++ are available [here](https://github.com/aws/aws-iot-device-sdk-cpp-v2/tags)\n\nThe latest stable releases of AWS IoT Device SDK for Node.js are available [here](https://github.com/aws/aws-iot-device-sdk-js-v2/tags)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-08-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3597",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-295"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-358"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-40831",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3597/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-cpp-v2/commit/ef0b21fcb346a0b344986aeb092bf9cb3f71f6cd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-cpp-v2/releases/tag/v1.14.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-cpp-v2/releases/tag/v1.14.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-cpp-v2/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-java-v2/commit/46375e9b1bfb34109b9ff3b1eff9c770f9daa186",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-java-v2/releases/tag/v1.5.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-java-v2/releases/tag/v1.5.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-java-v2/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-js-v2/commit/22f1989f5bdb0bdd9c912a5a2d255ee6c0854f68",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-js-v2/releases/tag/v1.6.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-js-v2/releases/tag/v1.6.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-js-v2/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-python-v2/commit/5aef82573202309063eb540b72cee0e565f85a2d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-python-v2/releases/tag/v1.7.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-python-v2/releases/tag/v1.7.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aws/aws-iot-device-sdk-python-v2/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/awslabs/aws-c-io/commit/3500d3fdcf1c4f806345c42a9dcdb95284a6b1b8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/awslabs/aws-c-io/releases/tag/v0.10.7",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/awslabs/aws-c-io/releases/tag/v0.10.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/awslabs/aws-c-io/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3597/default-remediation-status"
            }
        ]
    }
}