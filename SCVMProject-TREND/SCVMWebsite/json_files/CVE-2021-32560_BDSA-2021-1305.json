{
    "source": "BDSA",
    "name": "BDSA-2021-1305",
    "title": "OctoPrint Vulnerable to Local File Disclosure via Improper Access Control in Logging Subsystem",
    "description": "OctoPrint is vulnerable to local file disclosure due to an improper access control issue in the within its logging subsystem functionality. An administrator could set arbitrary file logging location and OctoPrint would list its contents and allow downloading the local files. This could be abused in order to disclose sensitive information such as private SSH keys.",
    "technicalDescription": "This vulnerability exists in the `src/octoprint/plugins/logging/__init__.py` and `src/octoprint/server/__init__.py` files, due to the application attempting to manage files that are not `*.log` files.",
    "publishedDate": "2021-05-12T11:51:57.850Z",
    "updatedDate": "2022-04-27T11:43:07.853Z",
    "disclosureDate": "2021-04-27T00:00:00.000Z",
    "exploitPublishDate": "2021-05-11T00:00:00.000Z",
    "solution": "Fixed in [**1.6.0rc1**](https://github.com/OctoPrint/OctoPrint/releases/tag/1.6.0rc1) by [this](https://github.com/OctoPrint/OctoPrint/commit/07c1d53a44c203fd83f7d2fc96b52b3aacadb56d) commit.\n\nThe latest stable releases are available [here](https://octoprint.org/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 5.1,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.1
        },
        "vector": "(AV:A/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 0.9,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jakub Brzozowski",
    "workaround": "",
    "vendorFixDate": "2021-04-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1305",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32560",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1305/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OctoPrint/OctoPrint/commit/07c1d53a44c203fd83f7d2fc96b52b3aacadb56d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OctoPrint/OctoPrint/releases/tag/1.6.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OctoPrint/OctoPrint/releases/tag/1.6.0rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://octoprint.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.brzozowski.io/web-applications/2021/05/11/the-insecure-story-of-octoprint.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.brzozowski.io/web-applications/2021/05/11/the-insecure-story-of-octoprint.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1305/default-remediation-status"
            }
        ]
    }
}