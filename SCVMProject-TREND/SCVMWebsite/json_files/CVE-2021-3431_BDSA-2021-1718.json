{
    "source": "BDSA",
    "name": "BDSA-2021-1718",
    "title": "Zephyr OS Bluetooth LE Controller Vulnerable to Denial of Service via Repeated LL Packets",
    "description": "Synopsys  Cybersecurity Research Center (CyRC) has discovered that Zephyr's Bluetooth Low Energy Controller (LE Link Layer) is vulnerable to denial-of-service (DoS) when targeted with repeat LL packets.\n\nTriggering this vulnerability does not require authentication or encryption. The only requirement is that the device is in advertising mode and accepting connections, and that the attacker is within range of the Bluetooth device.",
    "technicalDescription": "This vulnerability  occurs in `isr_done()` function in `lll_conn.c` file due to the implementation of control procedures to manage transaction violations. Receipt of repeated duplicate control PDUs  from a rogue device causes depletion of the control Tx PDU pool in the target when response transmissions from the targeted device are not acknowledged.  This results in assertion failure exception and a denial of service. \n\nWhen assertions are disabled, a denial of service ensues because the target device does not resume advertising state after disconnection and a reboot is required to recover. \n\nAn attacker is able to disrupt all the ongoing communication and cause a denial-of-service (DoS)  by repeatedly sending any of the following list of packet types  to any Zephyr based Bluetooth LE device which is advertising and open to connection:\n* LL_FEATURE_REQ\n* LL_PING_REQ\n* LL_LENGTH_REQ\n* LL_PHY_REQ\n\nThis vulnerability was fixed with the introduction of a new locking mechanism for Link Layer control procedures.",
    "publishedDate": "2021-06-22T13:37:03.799Z",
    "updatedDate": "2021-09-21T12:34:11.990Z",
    "disclosureDate": "2021-06-10T00:00:00.000Z",
    "solution": "Fixed in version **[2.6.0-rc1](https://github.com/zephyrproject-rtos/zephyr/tree/v2.6.0-rc1)** by [this](https://github.com/zephyrproject-rtos/zephyr/commit/ab5d8432d36915e53487a0613436477e864492d1) commit.\n\nFixed in [**2.5.1-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.5.1-rc1) by [this](https://github.com/zephyrproject-rtos/zephyr/commit/1e320a352fe3bf6027bb6d31040acf140eaf9186) commit.\n\nInstructions for manual backport of fix to [**1.14-branch**](https://github.com/zephyrproject-rtos/zephyr/tree/v1.14-branch) can be found [here](https://github.com/zephyrproject-rtos/zephyr/issues/33882).\n\nThe most recent release can be found [here](https://www.zephyrproject.org/developer-resources/#current-release).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:A/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matias Karhumaa  (Synopsys Cybersecurity Research Center   (CyRC))",
    "workaround": "",
    "vendorFixDate": "2021-03-15T00:00:00.000Z",
    "discoveryDate": "2021-02-02T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1718",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-617"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3431",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1718/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/1e320a352fe3bf6027bb6d31040acf140eaf9186",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/ab5d8432d36915e53487a0613436477e864492d1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/ab5d8432d36915e53487a0613436477e864492d1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/issues/33882",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/pull/33340",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.5.1-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/policy",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v2.6.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synopsys.com/blogs/software-security/cyrc-advisory-zephyr-vulnerability/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.zephyrproject.org/developer-resources/#current",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1718/default-remediation-status"
            }
        ]
    }
}