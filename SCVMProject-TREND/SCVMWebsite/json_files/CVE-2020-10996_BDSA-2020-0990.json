{
    "source": "BDSA",
    "name": "BDSA-2020-0990",
    "title": "XtraDB Cluster Vulnerable to Information Disclosure via Hard-Coded Backup Transition Key",
    "description": "XtraDB Cluster is vulnerable to information disclosure due to the usage of a hard-coded encryption key. An attacker could potentially recover sensitive information that is being backed up by using the XtraDB Cluser SST script in conjunction with an instance of the Galera Arbitrator daemon.",
    "technicalDescription": "The script `wsrep_sst_xtrabackup-v2.sh` defines the `transition_key` variable, which specifies an encryption key that can be used to protect the backup data. The implementation of `transition_key` within the script means that the `--transition-key` flag will be enclosed within single quotes whenever the SST script is being executed. This will cause the key to have a hard-coded value of `$transition_key`. An attacker could potentially use this to recover the encrypted data.\n\nIt should be noted that the only situation in which this constitutes an exploitable vulnerability is whenever the SST script is used to conduct a backup with an instance of the Galera Arbitrator daemon.",
    "publishedDate": "2020-05-04T15:46:44.203Z",
    "updatedDate": "2020-07-15T16:35:19.665Z",
    "disclosureDate": "2020-03-27T00:00:00.000Z",
    "solution": "Fixed in [8.0.18-9.3](https://github.com/percona/percona-xtradb-cluster/compare/release-8.0.18-9.3) by [this](https://github.com/percona/percona-xtradb-cluster/commit/2ccfa95846fe94aa8a8a4cf292d2c04cae823e44) commit.\n\nFixed in [5.7.29-31.43](https://github.com/percona/percona-xtradb-cluster/releases/tag/Percona-XtraDB-Cluster-5.7.29-31.43) by [this](https://github.com/percona/percona-xtradb-cluster/commit/f27affd37f3c7fcd6b107f640dbc11d85488c89b) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Pavel Kasko",
    "workaround": "",
    "vendorFixDate": "2020-04-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0990",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-321"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10996",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0990/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/percona/percona-xtradb-cluster/commit/2ccfa95846fe94aa8a8a4cf292d2c04cae823e44",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/percona/percona-xtradb-cluster/commit/a8510605d99814fff1f91cc46e7bfb632d16ea7e",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/percona/percona-xtradb-cluster/commit/f27affd37f3c7fcd6b107f640dbc11d85488c89b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/percona/percona-xtradb-cluster/compare/release-8.0.18-9.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/percona/percona-xtradb-cluster/releases/tag/Percona-XtraDB-Cluster-5.7.29-31.43",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jira.percona.com/browse/PXC-3117",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0990/default-remediation-status"
            }
        ]
    }
}