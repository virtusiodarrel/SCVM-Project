{
    "source": "BDSA",
    "name": "BDSA-2020-2920",
    "title": "Mozilla NSS Vulnerable to CCS Flooding and Denial-of-Service (DoS) via Improper CCS Message Handling in Compatibility Mode",
    "description": "Mozilla Network Security Services (NSS) is vulnerable  to ChangeCipherSpec (CCS) flooding attacks due to improper CCS message handling. A remote attacker could exploit this to flood the server with maliciously crafted packets to cause a denial-of-service (DoS) condition. \n\n**Note:**: This affects servers that have NSS library compiled and when the TLS **1.3** protocol is used.",
    "technicalDescription": "This vulnerability exists in `ssl3_HandleRecord` function of the file `/nss/lib/ssl/ss3con.c`. After a `ClientHello` message is sent within the compatibility mode, an attacker is able to craft malicious TCP packets to compose of multiple CCS messages. These will result in the NSS server to be flooded with messages, causing it to be caught in a loop, disrupting the normal processing. This could lead to a denial-of-service (DoS) condition. \n\nThis was addressed by improving the CCS handling and rejecting CCS when:\n* Multiple CCS messages are sent concurrently.\n* If there is no indication of the use of the middlebox compatibility mode with a non-empty session id ( `ClientHello.legacy_session_id`).",
    "publishedDate": "2020-10-22T08:33:21.441Z",
    "updatedDate": "2021-07-05T14:44:59.415Z",
    "disclosureDate": "2020-10-12T00:00:00.000Z",
    "exploitPublishDate": "2021-04-04T00:00:00.000Z",
    "solution": "Fixed in [**3.58-BETA1**](https://hg.mozilla.org/projects/nss/rev/NSS_3_58_BETA1) by  [this](https://hg.mozilla.org/projects/nss/rev/57bbefa793232586d27cee83e74411171e128361) commit.\n\nThe latest stable releases are available [here](https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_Releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mozilla Project",
    "workaround": "",
    "vendorFixDate": "2020-10-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2920",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-924"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25648",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2920/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1641480",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1641480",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1887319",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.58_release_notes",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_Releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/projects/nss/rev/57bbefa793232586d27cee83e74411171e128361",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/projects/nss/rev/NSS_3_58_BETA1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2920/default-remediation-status"
            }
        ]
    }
}