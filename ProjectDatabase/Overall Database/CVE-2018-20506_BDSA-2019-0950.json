{
    "source": "BDSA",
    "name": "BDSA-2019-0950",
    "title": "SQLite Vulnerable to Remote Code Execution (RCE) via Integer Overflow in FTS3 Extension",
    "description": "It has been discovered that SQLite is vulnerable to SQL Injection. An attacker could exploit this vulnerability by crafting malicious SQL queries to target database tables, which can leak program memory, enabling execution of arbitrary code against the target system.",
    "technicalDescription": "An integer overflow vulnerability in FTS3 extension modules in SQLite can be manipulated to trigger a heap buffer overflow and execute arbitrary code against the target system. The FTS3 module allows users to perform full text searches on several documents with various rules.\n\nA remote attacker can craft changes to FTS3 shadow tables that can trigger the integer overflow which leads to a heap-based buffer overflow. The FTS3 `merge` action will then allow an attacker to modify internal tables with normal SQL statements, allowing untrusted user input into the tables. \n\nThis exploit was initially fixed in SQLite version **3.25.3** and Chromium version **71.0.3578.75** but a further patch was added to SQLite version **3.26.0** and Chromium version **73.0.3673.0** which added the `SQLITE_DBCONFIG_DEFENSIVE` flag for applications that run untrusted SQL queries.\n\nThis is a different vulnerability to CVE-2018-20346.",
    "publishedDate": "2019-04-08T14:39:35.525Z",
    "updatedDate": "2019-04-08T14:39:35.510Z",
    "disclosureDate": "2019-01-24T00:00:00.000Z",
    "exploitPublishDate": "2018-12-15T00:00:00.000Z",
    "solution": "Fixed in SQLite version [**3.26.0**](https://www.sqlite.org/download.html) by [this](https://sqlite.org/src/info/940f2adc8541a838) commit and [this](https://www.sqlite.org/src/artifact/0efc9f6fba87f7b4) commit.\n\nFixed in Chromium [**73.0.3673.0**](https://github.com/chromium/chromium/releases/tag/73.0.3673.0) by [this](https://chromium.googlesource.com/chromium/src/+/c368e30ae55600a1c3c9cb1710a54f9c55de786e) commit and [this](https://chromium.googlesource.com/chromium/src.git/+/a06c5187775536a68f035f16cdb8bc47b9bfad24) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wenxiang Qian of Tencent Blade Team",
    "workaround": "SQLite is not vulnerable if no external SQL requests are accepted by the application or if the FTS3 extension is disabled.",
    "vendorFixDate": "2018-11-05T00:00:00.000Z",
    "vendorNotifiedDate": "2018-11-03T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-0950",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-20506",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-0950/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blade.tencent.com/magellan/index_en.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/chromium/issues/detail?id=900910",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://chromium.googlesource.com/chromium/src.git/+/a06c5187775536a68f035f16cdb8bc47b9bfad24",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://chromium.googlesource.com/chromium/src/+/c368e30ae55600a1c3c9cb1710a54f9c55de786e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chromium/chromium/releases/tag/73.0.3673.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zhuowei/worthdoingbadly.com/blob/master/_posts/2018-12-14-sqlitebug.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://sqlite.org/src/info/940f2adc8541a838",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/releaselog/3_25_3.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/releaselog/3_26_0.html",
                "label": "ADVISORY"
            }
        ]
    }
}