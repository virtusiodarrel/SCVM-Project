{
    "source": "BDSA",
    "name": "BDSA-2019-4869",
    "title": "EspoCRM Vulnerable to Stored Cross-Site Scripting (XSS) via Attachment Name",
    "description": "EspoCRM has a stored cross-site scripting (XSS) vulnerability due to an absence of correct input validation for attachments. A remote attacker could insert JavaScript code in the attachments which, when opened, will result in theft of a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "This vulnerability affects the following URL endpoint: `/EspoCRM-5.6.8/#Attachment`. Usually, this endpoint is used to handle email attachments. However, the filenames of the attachments received are not correctly sanitized before the attachments are stored on the server. This could allow an attacker to send attachments with malicious JavaScript code in their names. When a user views all attachments using the endpoint `/EspoCRM-5.6.8/#Attachment`, the malicious JavaScript code from the filename of the attacker's attachment will execute in that user's browser. This could allow an attacker to steal a user's session tokens or cookies.",
    "publishedDate": "2020-12-01T14:41:14.696Z",
    "updatedDate": "2020-12-01T14:41:14.685Z",
    "disclosureDate": "2019-08-03T00:00:00.000Z",
    "exploitPublishDate": "2019-08-03T00:00:00.000Z",
    "solution": "Fixed in [**5.6.9**](https://github.com/espocrm/espocrm/releases/tag/5.6.9) by [this](https://github.com/espocrm/espocrm/commit/ffd3f762ce4a8de3b8962f33513e073c55d943b5) commit.\n\nThe latest stable releases are available [here](https://www.espocrm.com/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Gaurav Narwani",
    "workaround": "",
    "vendorFixDate": "2019-07-30T00:00:00.000Z",
    "vendorNotifiedDate": "2019-07-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4869",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14547",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4869/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gauravnarwani.com/publications/cve-2019-14547/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gauravnarwani.com/publications/cve-2019-14547/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/commit/ffd3f762ce4a8de3b8962f33513e073c55d943b5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/issues/1369",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/releases/tag/5.6.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.espocrm.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4869/default-remediation-status"
            }
        ]
    }
}