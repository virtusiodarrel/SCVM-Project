{
    "source": "BDSA",
    "name": "BDSA-2019-2478",
    "title": "MongoDB Vulnerable to Session Fixation via Improper Invalidation of Deleted User Sessions",
    "description": "MongoDB contains a session fixation vulnerability due to improperly invalidating deleted user's sessions. If a user is deleted and a new user is added with the same username, the account can be accessed using the same session token. An attacker could exploit this to gain unauthorized access to a victim's account.",
    "technicalDescription": "For a successful attack, an attacker must have access to the user's first session and an administrator must create another user with the same username. The new and the old account will combine, exposing sensitive information from the previous user.\n\nNote that if any action is attempted on this session before the user is recreated, then an attack will not be successful.",
    "publishedDate": "2019-08-07T14:10:23.761Z",
    "updatedDate": "2019-08-07T14:10:23.753Z",
    "disclosureDate": "2019-08-06T00:00:00.000Z",
    "exploitPublishDate": "2019-08-06T00:00:00.000Z",
    "solution": "Fixed in [**4.1.9**](https://github.com/mongodb/mongo/releases/tag/r4.1.9) by [this](https://github.com/mongodb/mongo/commit/e55d6e2292e5dbe2f97153251d8193d1cc89f5d7) commit.\n\nThis was backported into the following versions:\n\n*  [**4.0.9**](https://github.com/mongodb/mongo/releases/tag/r4.0.9) by [this](https://github.com/mongodb/mongo/commit/6dfb92b1299de04677d0bd2230e89a52eb01003c) commit.\n* [**3.6.13**](https://github.com/mongodb/mongo/releases/tag/r3.6.13) by [this](https://github.com/mongodb/mongo/commit/db19e7ce84cfd702a4ba9983ee2ea5019f470f82) commit.\n* [**3.4.22**](https://github.com/mongodb/mongo/releases/tag/r3.4.22) by [this](https://github.com/mongodb/mongo/commit/64d8e9e1b12d16b54d6a592bae8110226c491b4e) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mitch Wasson",
    "workaround": "Do not allow usernames to be reused after deletion.",
    "vendorFixDate": "2019-01-30T00:00:00.000Z",
    "vendorNotifiedDate": "2019-01-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2478",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-384"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-2386",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2478/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/commit/64d8e9e1b12d16b54d6a592bae8110226c491b4e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/commit/6dfb92b1299de04677d0bd2230e89a52eb01003c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/commit/db19e7ce84cfd702a4ba9983ee2ea5019f470f82",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/commit/e55d6e2292e5dbe2f97153251d8193d1cc89f5d7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/releases/tag/r3.4.22",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/releases/tag/r3.6.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/releases/tag/r4.0.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/releases/tag/r4.1.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jira.mongodb.org/browse/SERVER-38984",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.talosintelligence.com/vulnerability_reports/TALOS-2019-0829",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.talosintelligence.com/vulnerability_reports/TALOS-2019-0829",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.talosintelligence.com/vulnerability_reports/TALOS-2019-0829",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2478/default-remediation-status"
            }
        ]
    }
}