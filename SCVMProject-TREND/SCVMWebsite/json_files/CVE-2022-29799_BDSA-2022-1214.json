{
    "source": "BDSA",
    "name": "BDSA-2022-1214",
    "title": "networkd-dispatcher Vulnerable to Path Traversal via 'OperationalState' and 'AdministrativeState' State Values",
    "description": "networkd-dispatcher is vulnerable to path traversal due to the use of unsanitized, user-controlled values within file access operations. An attacker that is able to control the `OperationalState` and `AdministrativeState` state values could cause the application to access files that lie outside of the intended base directory. An attacker could potentially leverage this issue in conjunction with **CVE-2022-29800** in order to achieve privilege escalation.",
    "technicalDescription": "networkd-dispatcher uses the state values `OperationalState` and `AdministrativeState` in order to determine which handler functions need to be invoked. The relevant state values, which are retrieved in the `_receive_signal()` signal handler, are ultimately user-controlled, and are used to dynamically construct the paths of scripts which are to be executed by the application. An attacker could provide state values that contain relative paths in order to trigger file access operations which lie outside of the intended base directory. An attacker can exploit this issue alongside **CVE-2022-29800** in order to escalate their privileges to root.",
    "publishedDate": "2022-05-02T16:06:16.883Z",
    "updatedDate": "2022-05-16T12:20:19.330Z",
    "disclosureDate": "2022-04-26T00:00:00.000Z",
    "exploitPublishDate": "2022-04-26T00:00:00.000Z",
    "solution": "The initial fix commits, found [here](https://gitlab.com/craftyguy/networkd-dispatcher/-/commit/2e226ee027bdc8022f0e10470318f89f25dc6133) and [here](https://gitlab.com/craftyguy/networkd-dispatcher/-/commit/074ff68f08d64a963a13e3cfc4fb3e3fb9006dfe), were released in version **2.2**. However, it was discovered that these fixes introduced a [regression](https://bugs.launchpad.net/ubuntu/+source/networkd-dispatcher/+bug/1971550).\n\nThe regression was remedied in [**2.2.2**](https://gitlab.com/craftyguy/networkd-dispatcher/-/tags/2.2.2) with [this](https://gitlab.com/craftyguy/networkd-dispatcher/-/commit/652b32f17ad37c49ef098f352424f97f9b8aa031) commit.\n\nThe latest stable releases can be found [here](https://gitlab.com/craftyguy/networkd-dispatcher/-/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jonathan Bar Or",
    "workaround": "",
    "vendorFixDate": "2022-04-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1214",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-23"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-29799",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1214/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/ubuntu/+source/networkd-dispatcher/+bug/1971550",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/craftyguy/networkd-dispatcher/-/commit/074ff68f08d64a963a13e3cfc4fb3e3fb9006dfe",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/craftyguy/networkd-dispatcher/-/commit/2e226ee027bdc8022f0e10470318f89f25dc6133",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/craftyguy/networkd-dispatcher/-/commit/652b32f17ad37c49ef098f352424f97f9b8aa031",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/craftyguy/networkd-dispatcher/-/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/craftyguy/networkd-dispatcher/-/tags/2.2.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.microsoft.com/security/blog/2022/04/26/microsoft-finds-new-elevation-of-privilege-linux-vulnerability-nimbuspwn/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.microsoft.com/security/blog/2022/04/26/microsoft-finds-new-elevation-of-privilege-linux-vulnerability-nimbuspwn/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.youtube.com/watch?v=9z0SP_NJwqk",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1214/default-remediation-status"
            }
        ]
    }
}