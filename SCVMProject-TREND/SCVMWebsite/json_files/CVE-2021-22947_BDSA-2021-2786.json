{
    "source": "BDSA",
    "name": "BDSA-2021-2786",
    "title": "Curl Vulnerable to STARTTLS Protocol Injection via Man-in-the-Middle (MitM) Attacks",
    "description": "Curl is vulnerable to STARTTLS protocol injection. This can allow an attacker to use a man-in-the-middle (MitM) attack in order to inject fake IMAP, POP3, or FTP responses.",
    "technicalDescription": "This vulnerability exists when Curl uses STARTTLS to upgrade a connection with a IMAP, POP3, SMTP or FTP server to TLS level in order to exchange data securely. The server is still able to respond and send back multiple responses before the TLS upgrade, these responses are not subsequently flushed after the upgrade. This means that Curl will trust that any responses it receives before the TLS handshake. This can allow an attacker to use a man-in-the-middle (MitM) attack in order to inject fake IMAP, POP3, or FTP responses, which means they are able to send data directly to a user as if they are the TLS-protected server.",
    "publishedDate": "2021-09-15T14:16:14.896Z",
    "updatedDate": "2021-10-04T15:09:36.914Z",
    "disclosureDate": "2021-09-15T00:00:00.000Z",
    "exploitPublishDate": "2021-09-24T00:00:00.000Z",
    "solution": "Fixed in [**7.79.0**](https://github.com/curl/curl/releases/tag/curl-7_79_0) by [this](https://github.com/curl/curl/commit/8ef147c4) commit.\n\nThe latest stable releases are available [here](https://curl.se/download.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Patrick Monnerat",
    "workaround": "The vendor has [suggested](https://curl.se/docs/CVE-2021-22947.html) that a recommendation to mitigate this is to not use IMAP, POP3, SMTP or FTP with explicit TLS.",
    "vendorFixDate": "2021-09-13T00:00:00.000Z",
    "vendorNotifiedDate": "2021-09-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2786",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-349"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22947",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2786/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22947.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2021-22947.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/8ef147c4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/ec3bb8f727405",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_79_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1334763",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2786/default-remediation-status"
            }
        ]
    }
}