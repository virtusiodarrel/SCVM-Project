{
    "source": "BDSA",
    "name": "BDSA-2021-4434",
    "title": "Airflow Vulnerable to Remote Code Execution (RCE) via Missing Authentication for Variable Import Endpoint",
    "description": "Airflow is vulnerable to remote code execution (RCE) due to a failure to implement an authentication mechanism for the variable import endpoint. A remote unauthenticated attacker could add or modify Airflow variables via this endpoint in order to execute arbitrary code on the server. The attacker could also potentially leverage this issue in order to obtain sensitive information from the server, or to cause it to crash.",
    "technicalDescription": "The PoC demonstrates a request that can be sent to the `/variable/varimport` endpoint in order to create a new variable `kafka_captainhook_user` under `Admin>variables`. This variable can then be utilized by the attacker to cause a crash, information exposure or possibly remote code execution (although this has not been demonstrated yet).",
    "publishedDate": "2022-06-07T15:54:44.776Z",
    "updatedDate": "2022-09-09T15:50:44.997Z",
    "disclosureDate": "2021-09-09T00:00:00.000Z",
    "exploitPublishDate": "2022-06-13T00:00:00.000Z",
    "solution": "Fixed in version [**2.1.3**](https://github.com/apache/airflow/releases/tag/2.1.3).\n\nThe latest stable releases can be found [here](https://github.com/apache/airflow/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Nathan Jones (National Australia Bank\u2019s Offensive Security Team)",
    "workaround": "",
    "vendorFixDate": "2021-09-11T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4434",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-306"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-38540",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4434/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Captain-v-hook/PoC-for-CVE-2021-38540-",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/airflow/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/airflow/releases/tag/2.1.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/t65hfz4cydtf6382cz63oro58ymbrhky",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4434/default-remediation-status"
            }
        ]
    }
}