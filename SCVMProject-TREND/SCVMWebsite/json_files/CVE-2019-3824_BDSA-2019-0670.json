{
    "source": "BDSA",
    "name": "BDSA-2019-0670",
    "title": "Samba Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Read in 'ldb_wildcard_compare' Function",
    "description": "Samba is vulnerable to denial-of-service (DoS) due to improper handling of search expressions in the ldb library leading to an out-of-bounds read. An authenticated attacker with read permissions could exploit this vulnerability by sending a maliciously crafted request to a target LDAP server.",
    "technicalDescription": "The ldb library in Samba does not properly handle wildcard matching with certain LDAP search expressions such as `cn=test*multi*test*multi`. The function `ldb_wildcard_compare()` within the file `lib/ldb/common/ldb_match.c` allows a buffer overread by manipulating the wildcard chunk value `cnk.length`. An attacker with read permissions could exploit this by sending a maliciously crafted LDAP search request. If processed when Samba is running in single or prefork mode, this could cause the LDAP server to crash. \n\nWhen Samba runs in standard mode a separate process is forked for every accepted client connection - therefore in this mode an attacker could only cause a DoS of their own connection.",
    "publishedDate": "2019-03-13T15:59:18.622Z",
    "updatedDate": "2022-04-04T13:49:39.748Z",
    "disclosureDate": "2019-02-25T00:00:00.000Z",
    "solution": "Fixed in Samba versions: \n* **[4.10.0-rc4](https://github.com/samba-team/samba/releases/tag/samba-4.10.0rc4)**\n* **[4.9.5](https://github.com/samba-team/samba/releases/tag/samba-4.9.5)**\n* **[4.8.10](https://github.com/samba-team/samba/releases/tag/samba-4.8.10)**\n\nFixed in the following Samba development branches which are yet to be included in any releases:\n* **[4.9-test](https://github.com/samba-team/samba/tree/v4-9-test)**\n* **[4.8-test](https://github.com/samba-team/samba/tree/v4-8-test)**\n* **[4.7-test](https://github.com/samba-team/samba/tree/v4-7-test)**\n\nFixed in ldb versions:\n* **[1.6.1](https://github.com/samba-team/samba/releases/tag/ldb-1.6.1)**\n* **[1.5.4](https://github.com/samba-team/samba/releases/tag/ldb-1.5.4)**\n* **[1.4.6](https://github.com/samba-team/samba/releases/tag/ldb-1.4.6)**\n* **[1.3.8](https://github.com/samba-team/samba/releases/tag/ldb-1.3.8)**\n* **[1.2.4](https://github.com/samba-team/samba/releases/tag/ldb-1.2.4)**\n\nThe issue has been fixed by these commits:\n* [Commit 1](https://github.com/samba-team/samba/commit/3674b0891afb016c83763520b87e9f190dcfe884)\n* [Commit 2](https://github.com/samba-team/samba/commit/745b99fc6b75db33cdb0a58df1a3f2a5063bc76e)\n* [Commit 3](https://github.com/samba-team/samba/commit/9427806f7298d71bd7edfbdda7506ec63f15dda1)\n* [Commit 4](https://github.com/samba-team/samba/commit/de3bb5cd5236565f2b79644d99e55d03b254b65e)\n* [Commit 5](https://github.com/samba-team/samba/commit/45b75db50f5c1a7c8c38af59a62fccee5401c845)\n* [Commit 6](https://github.com/samba-team/samba/commit/8d34d172092f71baad0d777567e49aebfa07313d)\n* [Commit 7](https://github.com/samba-team/samba/commit/42f0f57eb819ce6b68a8c5b3b53123b83ec917e3)\n* [Commit 8](https://github.com/samba-team/samba/commit/34383981a0c40860f71a4451ff8fd752e1b67666)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sam Garming (Catalyst)",
    "workaround": "A proposed patch for Samba **4.5** is available [here](https://bugzilla.samba.org/show_bug.cgi?id=13773#c13).\n\nPlease be aware that this patch may not be sufficiently tested.",
    "vendorFixDate": "2019-02-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0670",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3824",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0670/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.samba.org/show_bug.cgi?id=13773",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.samba.org/show_bug.cgi?id=13773#c13",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/34383981a0c40860f71a4451ff8fd752e1b67666",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/3674b0891afb016c83763520b87e9f190dcfe884",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/42f0f57eb819ce6b68a8c5b3b53123b83ec917e3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/45b75db50f5c1a7c8c38af59a62fccee5401c845",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/745b99fc6b75db33cdb0a58df1a3f2a5063bc76e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/8d34d172092f71baad0d777567e49aebfa07313d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/9427806f7298d71bd7edfbdda7506ec63f15dda1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/commit/de3bb5cd5236565f2b79644d99e55d03b254b65e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/ldb-1.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/ldb-1.3.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/ldb-1.4.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/ldb-1.5.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/ldb-1.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.10.0rc4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.8.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.9.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.debian.org/debian-lts-announce/2019/03/msg00000.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0670/default-remediation-status"
            }
        ]
    }
}