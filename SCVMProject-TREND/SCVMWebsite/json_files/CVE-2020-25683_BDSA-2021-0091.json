{
    "source": "BDSA",
    "name": "BDSA-2021-0091",
    "title": "Dnsmasq Vulnerable to Denial-of-Service (DoS) via Heap-Based Buffer Overflow in 'rfc1035.c' from 'get_rdata Large memcpy' Call",
    "description": "Dnsmasq is vulnerable to a denial-of-service (DoS) condition due to a flaw in how DNS packets are handled.\n\nAn attacker could use this flaw to cause a heap-based buffer overflow to occur and impact the stability of the application.",
    "technicalDescription": "Dnsmasq is vulnerable to a denial-of-service (DoS) condition because the `extract_name()` function present in the `src/rfc1035.c` file does not sufficiently perform length checks when `DNSSEC` is enabled. Under certain circumstances, this flaw can cause the `get_rdata()` function to incorrectly call  `memcpy()` with a negative value, resulting in a crash.",
    "publishedDate": "2021-01-20T14:05:47.708Z",
    "updatedDate": "2021-01-29T12:39:14.215Z",
    "disclosureDate": "2021-01-19T00:00:00.000Z",
    "exploitPublishDate": "2021-01-19T00:00:00.000Z",
    "solution": "Fixed in [**2.83**](http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=tag;h=47b4f0e37558e7a947bbf1c5c41e6bc87f1c9ebb) by [this](http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=4e96a4be685c9e4445f6ee79ad0b36b9119b502a) commit.\n\nThe latest stable releases are available [here](http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Moshe Kol and Shlomi Oberman",
    "workaround": "Third-party mitigations have been proposed [here](https://www.jsof-tech.com/wp-content/uploads/2021/01/DNSpooq_Technical-Whitepaper.pdf):\n\n\u2022 Configure dnsmasq not to listen on WAN interfaces if unnecessary in your environment.\n\u2022 Reduce the maximum queries allowed to be forwarded with the option `--dns-forward-max=<queries>`. The default is 150, but it could be lowered.\n\u2022 Temporarily disable `DNSSEC` validation option until you get a patch.\n\u2022 Use protocols that provide transport security for DNS (such as DoT or DoH). This will mitigate Dnspooq but may have other security and privacy implications. Consider your own setup, security goals, and risks before doing this.\n\u2022 Reducing the maximum size of EDNS messages will likely mitigate some of the vulnerabilities. This, however, has not been tested and is against the recommendation of the relevant RFC5625.",
    "vendorFixDate": "2020-12-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0091",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25683",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0091/ranges"
            },
            {
                "rel": "reference",
                "href": "http://lists.thekelleys.org.uk/pipermail/dnsmasq-discuss/2021q1/014599.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=4e96a4be685c9e4445f6ee79ad0b36b9119b502a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=tag;h=47b4f0e37558e7a947bbf1c5c41e6bc87f1c9ebb",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=tags",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.jsof-tech.com/disclosures/dnspooq/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.jsof-tech.com/wp-content/uploads/2021/01/DNSpooq_Technical-Whitepaper.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.jsof-tech.com/wp-content/uploads/2021/01/DNSpooq_Technical-Whitepaper.pdf",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.jsof-tech.com/wp-content/uploads/2021/01/DNSpooq_Technical-Whitepaper.pdf",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0091/default-remediation-status"
            }
        ]
    }
}