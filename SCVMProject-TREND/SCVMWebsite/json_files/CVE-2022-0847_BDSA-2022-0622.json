{
    "source": "BDSA",
    "name": "BDSA-2022-0622",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via 'copy_page_to_iter_pipe' and 'push_pipe' Functions",
    "description": "The Linux kernel contains a flaw which allows overwriting data in arbitrary read-only files. This could allow an unauthenticated local attacker to escalate their privileges on the system.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "This vulnerability exists due to a missing `flags` member initializer in the `copy_page_to_iter_pipe()` and `push_pipe()` functions of file `lib/iov_iter.c` in the Linux Kernel. This can allow an authenticated but non-privileged attacker to inject and overwrite data in read-only (including SUID) files that run as root. This can allow the attacker to remove restrictions or modify configurations in order to escalate their privileges to root. \n\nThe vendor has mitigated against this by including the `buf->flags = 0;` member initializer in both the `copy_page_to_iter_pipe()` and `push_pipe()` functions.\n\nThe researcher who discovered this vulnerability has provided more technical information [here](https://dirtypipe.cm4all.com/).",
    "publishedDate": "2022-03-08T14:14:26.369Z",
    "updatedDate": "2022-05-09T13:34:44.002Z",
    "disclosureDate": "2022-03-07T00:00:00.000Z",
    "exploitPublishDate": "2022-03-07T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.10.102**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b19ec7afa9297d862ed86443e0164643b97250ab) commit,\n* [**5.15.25**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=114e9f141822e6977633d322c1b03e89bd209932) commit,\n* [**5.16.11**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=eddef98207d678f21261c2bd07da55938680df4e) commit,\n* [**5.17-rc6**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9d2231c5d74e13b2a0546fee6737ee4446017903) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.5
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.2
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Max Kellermann",
    "workaround": "",
    "vendorFixDate": "2022-02-23T00:00:00.000Z",
    "discoveryDate": "2021-04-29T00:00:00.000Z",
    "vendorNotifiedDate": "2022-02-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0622",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-281"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-665"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-0847",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0622/ranges"
            },
            {
                "rel": "reference",
                "href": "https://dirtypipe.cm4all.com/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://dirtypipe.cm4all.com/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=114e9f141822e6977633d322c1b03e89bd209932",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=87c575d2a238febe8a04241008f18252fe5d093d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9d2231c5d74e13b2a0546fee6737ee4446017903",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a162b11c975ef9a03a75027c04052906ed7710da",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b19ec7afa9297d862ed86443e0164643b97250ab",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c460ef6e0596eb5ca844c45338c20f6023f1e43c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=d46c42d8d2742742eddf9290e72df4b563f2e301",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=eddef98207d678f21261c2bd07da55938680df4e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/torvalds/linux/commit/f6dd975583bd8ce088400648fd9819e4691c8958",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/166258/cve_2022_0847_dirtypipe.rb.txt",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.bleepingcomputer.com/news/security/new-linux-bug-gives-root-on-all-major-distros-exploit-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0622/default-remediation-status"
            }
        ]
    }
}