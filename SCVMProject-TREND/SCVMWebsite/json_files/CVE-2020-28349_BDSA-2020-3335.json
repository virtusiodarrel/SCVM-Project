{
    "source": "BDSA",
    "name": "BDSA-2020-3335",
    "title": "ChirpStack Network Server Vulnerable to Denial-of-Service (DoS) via Malformed Attributes",
    "description": "ChirpStack Network Server is vulnerable to denial-of-service (DoS) via malformed attributes. An attacker could cause a DoS condition via a compromised gateway on the network. If the gateway has `read/write` permissions relating to all uplink topics then an attack can affect any or all devices on the network. If the gateway has only `write` permissions then the attack is limited to devices within the range of the gateway. \n\nThis vulnerability is disputed by the vendor since they believe there are no \"guarantees that allowing untrusted LoRa gateways to the network should still result in a secure network.\"",
    "technicalDescription": "This issue exists in the `collectAndCallOnce` function within the `internal/uplink/collect.go` file due to malformed frequency attributes. It was mitigated by improving error handling relating to unknown gateways and by improving uplink de-duplication.",
    "publishedDate": "2020-11-20T11:38:59.279Z",
    "updatedDate": "2020-11-30T09:58:38.853Z",
    "disclosureDate": "2020-10-15T00:00:00.000Z",
    "exploitPublishDate": "2020-10-15T00:00:00.000Z",
    "solution": "Fixed in [**3.10.0-test.3**](https://github.com/brocaar/chirpstack-network-server/releases/tag/v3.10.0-test.3) by [this](https://github.com/brocaar/chirpstack-network-server/commit/874fc1a9b01045ebe8a340f0bb01ed19e8256e60) commit.\nFixed in [**3.11.0-test.1**](https://github.com/brocaar/chirpstack-network-server/releases/tag/v3.11.0-test.1) by [this](https://github.com/brocaar/chirpstack-network-server/commit/f996bb0c6c85281b5658f59ff09db1b4a73db453) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Emmanuel Ouanounou",
    "workaround": "",
    "vendorFixDate": "2020-07-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3335",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28349",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3335/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/brocaar/chirpstack-network-server/commit/874fc1a9b01045ebe8a340f0bb01ed19e8256e60",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/brocaar/chirpstack-network-server/commit/f996bb0c6c85281b5658f59ff09db1b4a73db453",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/brocaar/chirpstack-network-server/releases/tag/v3.10.0-test.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/brocaar/chirpstack-network-server/releases/tag/v3.11.0-test.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.cyberark.com/resources/threat-research-blog/lorawan-mqtt-what-to-know-when-securing-your-iot-network",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cyberark.com/resources/threat-research-blog/lorawan-mqtt-what-to-know-when-securing-your-iot-network",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3335/default-remediation-status"
            }
        ]
    }
}