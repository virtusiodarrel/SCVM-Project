{
    "source": "BDSA",
    "name": "BDSA-2019-4393",
    "title": "Pimcore Vulnerable to SQL Injection (SQLi) via Multiple Parameters in 'ClassificationstoreController.php'",
    "description": "Pimcore is vulnerable to SQL injection (SQLi) due to a lack of validation of input supplied by users. This could allow a remote authenticated attacker to extract information from the Pimcore database, including usernames and passwords.",
    "technicalDescription": "Pimcore is vulnerable to SQL injection (SQLi) because two queries in the `getPageAction()` function within `ClassificationstoreController.php` are generated using the concatenation of parameters that are not sanitized despite containing input from users. The parameters are `id`, `storeId`, `pageSize` and `table`.\n\nWithout validation or sanitization of these parameters, an attacker can manipulate the SQL queries and construct statements to perform different functions like extracting usernames and passwords.\n\nThis vulnerability was mitigated by validating the contents of the `table` parameter and casting the values of the `id`, `storeId` and `pageSize` parameters to integers.",
    "publishedDate": "2020-05-20T18:05:32.601Z",
    "updatedDate": "2020-05-20T18:05:32.594Z",
    "disclosureDate": "2019-11-17T00:00:00.000Z",
    "exploitPublishDate": "2019-11-17T00:00:00.000Z",
    "solution": "Fixed in [**6.3.0**](https://github.com/pimcore/pimcore/releases/tag/v6.3.0) by [this](https://github.com/pimcore/pimcore/commit/608ef5d81ba34d034c9b70519bbc6806ad115d68) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-11-17T00:00:00.000Z",
    "discoveryDate": "2019-11-04T00:00:00.000Z",
    "vendorNotifiedDate": "2019-11-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4393",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10763",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4393/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.certimetergroup.com/it/articolo/security/sql_injection_in_pimcore_6.2.3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.certimetergroup.com/it/articolo/security/sql_injection_in_pimcore_6.2.3",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/commit/608ef5d81ba34d034c9b70519bbc6806ad115d68",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/commit/ed2fe8d9951c466c9a58e1badc180d4f343da53f",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/releases/tag/v6.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-PHP-PIMCOREPIMCORE-480391",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4393/default-remediation-status"
            }
        ]
    }
}