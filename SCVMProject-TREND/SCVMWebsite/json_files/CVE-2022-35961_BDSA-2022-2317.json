{
    "source": "BDSA",
    "name": "BDSA-2022-2317",
    "title": "OpenZeppelin 'Contracts' and 'Contracts Upgradeable' Vulnerable to ECDSA Signature Malleability via 'recover' and 'tryRecover' Functions",
    "description": "OpenZeppelin Contracts and Contracts Upgradeable is vulnerable to ECDSA signature malleability due to improper validation of signatures. This could allow an attacker to bypass the current cryptographic protection measures and use a signature that has already been submitted, change its form and submit it again.",
    "technicalDescription": "The functions `recover()` and `tryRecover()`, that have a single `bytes` argument, are vulnerable to signature malleability due to accepting EIP-2098 compact signatures.\n\n**Note:** This does not affect functions that take `r, v, s` or `r, vs ` as arguments.\n\nThis has been mitigated in the `contracts/utils/cryptography/ECDSA.sol` and `contracts/utils/cryptography/ECDSAUpgradeable.sol` files so that `recover()` and `tryRecover()` do not accept compact signatures.",
    "publishedDate": "2022-08-22T11:39:26.833Z",
    "updatedDate": "2022-09-14T08:02:04.393Z",
    "disclosureDate": "2022-08-10T00:00:00.000Z",
    "solution": "Fixed in Contracts version [**4.7.3**](https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.7.3) by [this](https://github.com/OpenZeppelin/openzeppelin-contracts/commit/e1878ace8c2908b85d39f9925c68c6f738cf3325) commit.\n\nThe latest stable releases can be found [here](https://github.com/OpenZeppelin/openzeppelin-contracts/releases).\n\nFixed in Contracts - Upgradeable version [**4.7.3**](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/releases/tag/v4.7.3) by [this](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/0a2cb9a445c365870ed7a8ab461b12acf3e27d63) commit.\n\nThe latest stable releases can be found [here](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-08-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2317",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-347"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-35961",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2317/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/0a2cb9a445c365870ed7a8ab461b12acf3e27d63",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/releases/tag/v4.7.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/e1878ace8c2908b85d39f9925c68c6f738cf3325",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.7.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-4h98-2769-gh6h",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2317/default-remediation-status"
            }
        ]
    }
}