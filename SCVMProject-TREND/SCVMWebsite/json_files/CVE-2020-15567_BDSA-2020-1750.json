{
    "source": "BDSA",
    "name": "BDSA-2020-1750",
    "title": "Xen Vulnerable to Privilege Escalation via Non-Atomic Bitfield Writes Leading to Partially Filled PTE Entries",
    "description": "Xen is vulnerable to not writing complete Page Table Entries (PTEs) due to compiler optimizations. An attacker may be able to race this condition to cause a denial-of-service (DoS) or elevate their privileges.",
    "technicalDescription": "Xen could use a series of non-atomic bitfield writes when mapping guest EPT (nested paging) tables. This could lead to a race condition where partially-written PTEs might be exposed to the hardware. If an attacker could race these partially written PTEs, they may be able to elevate their privileges.\n\nIntel CPU systems are the only ones vulnerable to this flaw. AMD CPUs and Arm systems are not vulnerable. Only systems using nested paging (Intel EPT) are vulnerable. Only HVM and PVH guests can exploit the vulnerability.\n\nIf the compiler generates atomic single 64-bit writes, or a series of read-modify-write operations which are in the same order as the source code, the hypervisor is not vulnerable. Manual inspection of the generated assembly would be required in order to determine if this was the case.",
    "publishedDate": "2020-07-20T13:51:59.844Z",
    "updatedDate": "2021-08-17T13:28:13.425Z",
    "disclosureDate": "2020-07-07T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* [**4.14.0-rc6**](https://xenbits.xen.org/gitweb/?p=xen.git;a=tree;h=4f370a7cc0bec3748994ef4ae6550cca4c8d982d;hb=ce3c4493e4e6c94495ddd8538e801a35980bff0d) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1104288186ee73a7f9bfa41cbaa5bb7611521028) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=bc3d9f95d661372b059a5539ae6cb1e79435bb95) commit.\n* [**RELEASE-4.12.4**](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=97b7b5567fba6918a656ad349051b5343b5dea2e) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=731bdaf416800809bc71f19dbdeb726203a2b3ef) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=8faa45e25e8b97570b81b46a6b48bdbc8b489b4f) commit.\n* [**RELEASE-4.13.2**](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=0060ac29bcbdb76d49d2e248ddfcb7afa2345440) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=56e117f504f83d1576bf62b53bf70e4a82e2a877) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=2b34d8cd734a46f59e8a697d339b10e64514ab3d) commit..\n\nFixed in:\nThe **remotes/origin/stable-4.9** branch by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=098d95995564f38f5415dd7b30096785db9e2337) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6ee71c98e35054045d47e65cb10587b0f60cae52) commit.\nThe **remotes/origin/stable-4.10** branch by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=a380168a5672cc3bf3066f630bab3c9355e4e1cf) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=a9bda69c6bf7da2933891f3e18f77f8a18f874bb) commit.\nThe **remotes/origin/stable-4.11** branch by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=18be3aabd83fa9f683e8ddb0bca2066dd302c20e) commit and [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7def72c0de00b4f833da4896fd5f07ecec5c3fa9) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.1,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jan Beulich of SUSE",
    "workaround": "The vendor supplies the following workarounds:\n> Running only PV guests will avoid this vulnerability.\n> \n> Switching to shadow paging (e.g. using the \"hap=0\" xl domain domain\n> configuration file parameter) will avoid exposing the vulnerability to\n> those guests.\n> \n> Manual inspection of the generated assembly code might allow a\n> suitably qualified person to say that a particular build is not\n> vulnerable.",
    "vendorFixDate": "2020-07-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1750",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15567",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1750/ranges"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-328.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-328.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=0060ac29bcbdb76d49d2e248ddfcb7afa2345440",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=098d95995564f38f5415dd7b30096785db9e2337",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1104288186ee73a7f9bfa41cbaa5bb7611521028",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=18be3aabd83fa9f683e8ddb0bca2066dd302c20e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=2b34d8cd734a46f59e8a697d339b10e64514ab3d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=56e117f504f83d1576bf62b53bf70e4a82e2a877",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6ee71c98e35054045d47e65cb10587b0f60cae52",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=731bdaf416800809bc71f19dbdeb726203a2b3ef",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=731bdaf416800809bc71f19dbdeb726203a2b3ef)",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7def72c0de00b4f833da4896fd5f07ecec5c3fa9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=8faa45e25e8b97570b81b46a6b48bdbc8b489b4f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=97b7b5567fba6918a656ad349051b5343b5dea2e)",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=a380168a5672cc3bf3066f630bab3c9355e4e1cf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=a9bda69c6bf7da2933891f3e18f77f8a18f874bb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=bc3d9f95d661372b059a5539ae6cb1e79435bb95",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=tree;h=4f370a7cc0bec3748994ef4ae6550cca4c8d982d;hb=ce3c4493e4e6c94495ddd8538e801a35980bff0d",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1750/default-remediation-status"
            }
        ]
    }
}