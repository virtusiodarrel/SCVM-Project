{
    "source": "BDSA",
    "name": "BDSA-2019-1075",
    "title": "wpa_supplicant Vulnerable to Information Exposure via Time-Based Side Channel Attack during Dragonfly Handshake",
    "description": "A time based side-channel vulnerability has been discovered in wpa_supplicant utilized by WPA3 protocol. An attacker could exploit this vulnerability through a dictionary attack by observing the time difference an access point takes to process passwords and comparing the results against the observed time to retrieve password information.",
    "technicalDescription": "A weakness has been discovered in wpa_supplicant utilized by the WPA3 protocol. WPA3 utilizes a key agreement method called simultaneous authentication of equals (SAE) which is a variant of the Dragonfly Key Exchange. The  implemented extensible authentication protocol (EAP) framework does prevent against timing attacks, access points which utilize the modulo a prime (MODP) security groups can be observed to retrieve sensitive information.\n\nThe password element (PWE) generation algorithm requires additional loops in MODP groups 22, 23 and 24 which can result in a sufficient time difference. This can be observed by an external actor to discover the amount of rounds required to find the PWE based on the password and MAC address. If this process is observed repeatedly by the external actor they can gather enough information about the password to be able to recover it in full via an offline dictionary attack.\n\nThe functionality located in the file `src/common/sae.c` did not adequately mask the time difference against MODP security groups. In order to exploit this vulnerability MODP groups must be enabled by the `wpa_supplicant` configuration, which are disabled by default.\n\nAn attacker could exploit this vulnerability to retrieve the full password and gain unauthorized access to the network.",
    "publishedDate": "2019-04-17T12:23:05.610Z",
    "updatedDate": "2022-01-17T15:13:15.939Z",
    "disclosureDate": "2019-04-10T00:00:00.000Z",
    "solution": "Fixed in the **master** branch by the following commits:\n* [commit1](https://w1.fi/cgit/hostap/commit/?id=d42c477cc794163a3757956bbffca5cea000923c),\n* [commit2](https://w1.fi/cgit/hostap/commit/?id=c93461c1d98f52681717a088776ab32fd97872b0),\n* [commit3](https://w1.fi/cgit/hostap/commit/?id=90839597cc4016b33f00055b12d59174c62770a3),\n* [commit4](https://w1.fi/cgit/hostap/commit/?id=6513db3e96c43c2e36805cf5ead349765d18eaf7),\n* [commit5](https://w1.fi/cgit/hostap/commit/?id=f8f20717f87eff1f025f48ed585c7684debacf72),\n* [commit6](https://w1.fi/cgit/hostap/commit/?id=cff138b0747fa39765cbc641b66cfa5d7f1735d1),\n* [commit7](https://w1.fi/cgit/hostap/commit/?id=362704dda04507e7ebb8035122e83d9f0ae7c320).\n\nDisable MODP groups 1, 2, 5, 22, 23, 24 by removing them from `hostapd`/`wpa_supplicant`sae_groups as they are not considered strong enough to meet the current security expectations.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.8,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.2,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:A/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mathy Vanhoef (NYUAD), Eyal Ronen (Tel Aviv University & KU Leuven)",
    "workaround": "",
    "vendorFixDate": "2019-03-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1075",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-385"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-9494",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1075/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1699141",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=362704dda04507e7ebb8035122e83d9f0ae7c320",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=6513db3e96c43c2e36805cf5ead349765d18eaf7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=90839597cc4016b33f00055b12d59174c62770a3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=c93461c1d98f52681717a088776ab32fd97872b0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=cff138b0747fa39765cbc641b66cfa5d7f1735d1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=d42c477cc794163a3757956bbffca5cea000923c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=f8f20717f87eff1f025f48ed585c7684debacf72",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/security/2019-1/sae-side-channel-attacks.txt",
                "label": "ADVISORY"
            }
        ]
    }
}