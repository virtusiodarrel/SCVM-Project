{
    "source": "BDSA",
    "name": "BDSA-2021-2439",
    "title": "TensorFlow Vulnerable to Out-of-Bounds Read via Insufficient Validation in 'fractional_avg_pool_op.cc' File",
    "description": "TensorFlow is vulnerable to a heap-based out-of-bounds read  issue due to a lack of sufficient input validation in the `tf.raw_ops.FractionalAvgPoolGrad` implementation.\n\nAn attacker could submit a crafted tensor input in order to trigger this issue which could cause the `FractionalAvgPoolGrad` implementation to access data outside the bounds of heap allocated buffers and disclose information or impact stability and cause denial-of-service (DoS) effects.",
    "technicalDescription": "TensorFlow is vulnerable to an out-of-bounds read issue because the `tf.raw_ops.FractionalAvgPoolGrad` implementation, defined in the `tensorflow/core/kernels/fractional_avg_pool_op.cc` file, does not sufficiently validate that the input tensor is not empty. This flaw can cause an empty `EigenDoubleMatrixMap` to be created where later attempts to access this buffer can result in memory being accessed from outside of the empty area.\n\nTo remedy this issue, the vendor has added checks to validate that the `in_batch`, `in_rows`,`in_cols` and `in_depth` values are not empty.",
    "publishedDate": "2021-08-13T13:16:03.953Z",
    "updatedDate": "2021-08-13T13:52:31.872Z",
    "disclosureDate": "2021-08-11T00:00:00.000Z",
    "exploitPublishDate": "2021-08-11T00:00:00.000Z",
    "solution": "Fixed in:\n* **[2.3.4](https://github.com/tensorflow/tensorflow/releases/tag/v2.3.4)** by [this](https://github.com/tensorflow/tensorflow/commit/e101ff24923b053cd21e05d75356f2f25adcfeb6) commit,\n* **[2.4.3](https://github.com/tensorflow/tensorflow/releases/tag/v2.4.3)** by [this](https://github.com/tensorflow/tensorflow/commit/c2533e1bab99a880fa9a636ac8c426a7ac57b0d5) commit,\n* **[2.5.1](https://github.com/tensorflow/tensorflow/releases/tag/v2.5.1)** by [this](https://github.com/tensorflow/tensorflow/commit/084b7e2b6b48a8a2d371fc6924befe189c3eb9af) commit,\n* **[2.6.0](https://github.com/tensorflow/tensorflow/releases/tag/v2.6.0)** by [this](https://github.com/tensorflow/tensorflow/commit/d0f3bb0feb839db46e192b325a0b85549b9fd80c) commit,\n* the **master** branch by [this](https://github.com/tensorflow/tensorflow/commit/0f931751fb20f565c4e94aa6df58d54a003cdb30) commit.\n\nThe latest stable releases can be found [here](https://github.com/tensorflow/tensorflow/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.8
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.7,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Aivul Team from Qihoo 360",
    "workaround": "",
    "vendorFixDate": "2021-08-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2439",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-37651",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2439/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/084b7e2b6b48a8a2d371fc6924befe189c3eb9af",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/0f931751fb20f565c4e94aa6df58d54a003cdb30",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/c2533e1bab99a880fa9a636ac8c426a7ac57b0d5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/d0f3bb0feb839db46e192b325a0b85549b9fd80c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/e101ff24923b053cd21e05d75356f2f25adcfeb6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.6.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-hpv4-7p9c-mvfr",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-hpv4-7p9c-mvfr",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2439/default-remediation-status"
            }
        ]
    }
}