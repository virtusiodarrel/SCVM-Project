{
    "source": "BDSA",
    "name": "BDSA-2020-3813",
    "title": "Apache TomEE Vulnerable to Authentication Bypass via Broker Misconfiguration",
    "description": "Apache TomEE is vulnerable to authentication bypass when the ActiveMQ broker is misconfigured. A remote attacker could take advantage of this to gain access to a JMX server on a vulnerable host.\n\nThis issue exists due to an incomplete fix for CVE-2020-11969.",
    "technicalDescription": "Apache TomEE can utilize an embedded ActiveMQ broker, which is managed by the `ActiveMQ5Factory` class. This broker is associated with a broker URI, which can contain the optional `useJMX` parameter. If this has been configured to use a value of `true`, the server will automatically open a JMX server on port 1099. This JMX server will not have authentication enabled, and so a remote attacker could connect to that server using crafted requests.\n\nThis issue was addressed in TomEE versions **8.0.2**, **7.1.3** and **7.0.8** however an additional edge case was not covered. If TomEE is configured to use the embedded ActiveMQ broker and the broker config is misconfigured an unauthenticated JMX port will be opened on TCP port 1099.",
    "publishedDate": "2020-12-17T16:26:34.126Z",
    "updatedDate": "2020-12-17T16:26:34.120Z",
    "disclosureDate": "2020-12-16T00:00:00.000Z",
    "solution": "Fixed in:\n* [**7.0.9**](https://downloads.apache.org/tomee/tomee-7.0.9/)\n* [**7.1.4**](https://downloads.apache.org/tomee/tomee-7.1.4/)\n* [**8.0.4**](https://downloads.apache.org/tomee/tomee-8.0.4/)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.6,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Frans Henskens",
    "workaround": "",
    "vendorFixDate": "2020-07-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3813",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13931",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3813/ranges"
            },
            {
                "rel": "reference",
                "href": "https://downloads.apache.org/tomee/tomee-7.0.9/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://downloads.apache.org/tomee/tomee-7.1.4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://downloads.apache.org/tomee/tomee-8.0.4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q4/225",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3813/default-remediation-status"
            }
        ]
    }
}