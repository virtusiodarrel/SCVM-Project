{
    "source": "BDSA",
    "name": "BDSA-2019-1079",
    "title": "Jupyter Notebook and Jupyterhub Vulnerable to Open Redirect via '_redirect_safe()' Function",
    "description": "Jupyter Notebook and Jupyterhub are vulnerable to open redirects due to the insufficient validation of the contents of URIs. An attacker could make a victim navigate to a malicious web page by tricking them into clicking on a crafted link. Successfully exploiting could also allow the attacker to steal sensitive data from the victim's browser.",
    "technicalDescription": "Jupyter Notebook and Jupyterhub attempt to validate redirect URIs included within requests using code contained within the ` _redirect_safe()` function, which is defined within `login.py`. However, this code does not take into account some of the ways in which this redirection can occur. For example, the Google Chrome browser will treat the `\\` character as a valid `/` character. The `_redirect_safe` function does not sanitize the `\\` character, and so a malicious redirect URI that contains these characters can pass the validation process. The function also neglects to conduct other URI parsing activities, meaning that URIs can be crafted that will contain the proper base URI (thus passing the `url.startswith(self.base_url)` check) but will still end up leading the client to an external resource. An attacker could therefore cause a victim to visit a malicious resource by tricking them into clicking on a crafted link.\n\nIt should be noted that the mitigations that were introduced for this vulnerability were found to be incomplete (see related advisories).",
    "publishedDate": "2019-04-16T12:01:11.018Z",
    "updatedDate": "2019-05-24T13:29:50.451Z",
    "disclosureDate": "2019-03-28T00:00:00.000Z",
    "solution": "Fixed in version [**5.7.7**](https://github.com/jupyter/notebook/releases/tag/5.7.7) of Jupyter Notebook by [this](https://github.com/jupyter/notebook/commit/c6fafc38cba7dc51a3b3d5b11f1faf0aeee2a6d3) commit and [this](https://github.com/jupyter/notebook/commit/70fe9f0ddb3023162ece21fbb77d5564306b913b) commit.\n\nFixed in version [**0.9.5**](https://github.com/jupyterhub/jupyterhub/releases/tag/0.9.5) of Jupyterhub by [this](https://github.com/jupyterhub/jupyterhub/commit/244ab813fed5dacedc41543c7605fe20e0b2af76) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ronak Odhaviya",
    "workaround": "",
    "vendorFixDate": "2019-03-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1079",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-601"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10255",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1079/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.jupyter.org/open-redirect-vulnerability-in-jupyter-jupyterhub-adf43583f1e4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jupyter/notebook/commit/70fe9f0ddb3023162ece21fbb77d5564306b913b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jupyter/notebook/commit/c6fafc38cba7dc51a3b3d5b11f1faf0aeee2a6d3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jupyter/notebook/releases/tag/5.7.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jupyterhub/jupyterhub/commit/244ab813fed5dacedc41543c7605fe20e0b2af76",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jupyterhub/jupyterhub/releases/tag/0.9.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1079/default-remediation-status"
            }
        ]
    }
}