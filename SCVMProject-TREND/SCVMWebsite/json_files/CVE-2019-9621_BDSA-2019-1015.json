{
    "source": "BDSA",
    "name": "BDSA-2019-1015",
    "title": "Zimbra Vulnerable to Server Side Request Forgery (SSRF) Due to Improper Check for Administrator Privilege",
    "description": "A remote attacker is able to manipulate a Zimbra installation into performing network requests to remote hosts (SSRF).",
    "technicalDescription": "There are incomplete permission checks on a feature of Zimbra that allows a user to spoof administration privileges to perform a server side request. In order to verify an admin request Zimbra first checks that the request comes from port 7071. However it uses `ServletRequest.getServerPort()` to fetch the incoming port.  This method takes the port from the HTTP HOST header, which is controllable by the attacker..  Another check for a valid administrator token is flawed. The full verification only happens if the token is from a parameter.  When the token comes from the cookie, it passes verification automatically, allowing an attacker to spoof administration privileges to perform the SSRF.  This SSRF technique can be used to spoof an `AuthRequest` to port 7071 and obtain a global admin token.",
    "publishedDate": "2019-04-15T09:02:04.322Z",
    "updatedDate": "2019-06-11T08:04:36.289Z",
    "disclosureDate": "2019-03-13T00:00:00.000Z",
    "exploitPublishDate": "2019-04-01T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* [**8.8.11.p4**](https://github.com/Zimbra/zm-mailbox/releases/tag/8.8.11.p4) by [this](https://github.com/Zimbra/zm-mailbox/commit/aa575ed9f9c10ece928ed62e087c2dea017b8c14) commit.\n* [**8.8.10.p8**](https://github.com/Zimbra/zm-mailbox/releases/tag/8.8.10.p8) by [this](https://github.com/Zimbra/zm-mailbox/commit/69df7a1750862c92e226132c07ec68252a6727bc) commit.\n* [**8.8.9.p10**](https://github.com/Zimbra/zm-mailbox/releases/tag/8.8.9.p10) by [this](https://github.com/Zimbra/zm-mailbox/commit/0c2484ffce0fe162949595f9bcd8e10fa11648a7) commit.\n* [**8.7.11.p11**](https://github.com/Zimbra/zm-mailbox/releases/tag/8.7.11.p11) by [this](https://github.com/Zimbra/zm-mailbox/commit/1e35a54723116d8918c943404f85668d9b79175d) commit.\n* [**8.8.12**](https://github.com/Zimbra/zm-mailbox/releases/tag/8.8.12) by [this](https://github.com/Zimbra/zm-mailbox/commit/291ab91fb4a6772899252e1ea0993094a6d54251) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "An Trinh",
    "workaround": "",
    "vendorFixDate": "2019-04-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1015",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9621",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1015/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-mailbox/commit/0c2484ffce0fe162949595f9bcd8e10fa11648a7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-mailbox/commit/1e35a54723116d8918c943404f85668d9b79175d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-mailbox/commit/291ab91fb4a6772899252e1ea0993094a6d54251",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-mailbox/commit/69df7a1750862c92e226132c07ec68252a6727bc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-mailbox/commit/aa575ed9f9c10ece928ed62e087c2dea017b8c14",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Zimbra/zm-mailbox/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/zimbra_xxe_rce.rb",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46967",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1015/default-remediation-status"
            }
        ]
    }
}