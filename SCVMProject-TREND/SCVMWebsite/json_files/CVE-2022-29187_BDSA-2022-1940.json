{
    "source": "BDSA",
    "name": "BDSA-2022-1940",
    "title": "Git Vulnerable to Privilege Escalation via Directory Protections Bypass",
    "description": "Git contains a privilege escalation vulnerability. An attacker could exploit this issue by placing a `.git` file in a shared hard drive, such as `C:\\` on a multi user machine, could potentially load any git config file for other users. A user could be affected by navigating as root into a shared and owned `tmp` directory, where an attacker could create a git repository. This may lead to the escalation of privileges for an attacker.\n\n**Note:** This issue may exist due to an incomplete fix for CVE-2022-24765.",
    "technicalDescription": "The fix introduced in CVE-2022-24765 could be worked around by an attacker by creating a git repository in a victim-controlled directory that they can write into.\n\nThis issue was mitigated by extending the `ensure_valid_ownership()` function's ability to check for multiple paths and ensuring the `gitfile` is resolved to find a `gitdir` for checking.",
    "publishedDate": "2022-07-13T13:29:01.528Z",
    "updatedDate": "2022-07-13T13:29:01.507Z",
    "disclosureDate": "2022-07-12T00:00:00.000Z",
    "solution": "Fixed in: \n\n* Version [**2.30.5**](https://github.com/git/git/releases/tag/v2.30.5),\n* Version [**2.31.4**](https://github.com/git/git/releases/tag/v2.31.4),\n* Version [**2.32.3**](https://github.com/git/git/releases/tag/v2.32.3) ,\n* Version [**2.33.4**](https://github.com/git/git/releases/tag/v2.33.4) ,\n* Version [**2.34.4**](https://github.com/git/git/releases/tag/v2.34.4) ,\n* Version [**2.35.4**](https://github.com/git/git/releases/tag/v2.35.4),\n* Version [**2.36.2**](https://github.com/git/git/releases/tag/v2.36.2),\n* Version [**2.37.1**](https://github.com/git/git/releases/tag/v2.37.1).\n\nby [this](https://github.com/git/git/commit/3b0bf2704980b1ed6018622bdf5377ec22289688) commit.\n\nThe latest stable releases can be found [here](https://github.com/git/git/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "hannob",
    "workaround": "The vendor has recommended that affected users should:\n\n> avoid running git as root (or an Administrator in Windows), and if needed to reduce its use to a minimum.\n> \n> While a generic workaround is not possible, a system could be hardened from the exploit described in the example by removing any such repository if it exists already and creating one as root to block any future attacks.",
    "vendorFixDate": "2022-06-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1940",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-282"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-29187",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1940/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/commit/3b0bf2704980b1ed6018622bdf5377ec22289688",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/releases/tag/v2.30.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/releases/tag/v2.31.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/releases/tag/v2.32.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/releases/tag/v2.33.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/releases/tag/v2.34.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/releases/tag/v2.35.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/releases/tag/v2.36.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/releases/tag/v2.37.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/security/advisories/GHSA-j342-m5hw-rr3v",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/security/advisories/GHSA-j342-m5hw-rr3v",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/git/git/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/git/xmqqv8s2fefi.fsf@gitster.g/T/#u",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1940/default-remediation-status"
            }
        ]
    }
}