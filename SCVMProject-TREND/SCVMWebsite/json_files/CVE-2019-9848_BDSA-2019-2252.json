{
    "source": "BDSA",
    "name": "BDSA-2019-2252",
    "title": "LibreOffice Vulnerable to Arbitrary Code Execution via LibreLogo XScript Functionality",
    "description": "LibreOffice is vulnerable to arbitrary code execution due to unrestricted access to its event-handling functionality. An attacker could execute arbitrary Python code on a victim's machine by tricking them into opening a crafted document.",
    "technicalDescription": "LibreOffice implements XScript functionality via the source file `objmisc.cxx`. This file invokes a variety of XScript libraries, and defines a series of functions (such as `SfxObjectShell::CallXScript()`) in order to utilize the functionality offered by those libraries. LibreOffice is often bundled with various components, such as LibreLogo, that are comprised of scripts that can invoke XScript functionality via the functions defined within `objmisc.cxx`. These functions can be called in order to respond to certain document events, such as mouse-overs. This will result in the execution of scripts that contain code which will produce the desired response for the document event. The access LibreLogo has to this XScript functionality could be exploited by attacker in order to execute arbitrary Python code that is contained within a crafted document. This is made possible by the fact that LibreOffice insufficiently restricts external access to its XScript functionality.\n\n**Note**: this vulnerability was originally disclosed under CVE-2019-9848, but it was discovered that the implemented fix (included in releases **6.3.0.0-beta2** and **6.2.5.1**) could be bypassed due to additional issues:\n* insufficient URL validation within the file `sfx2/source/doc/objmisc.cxx`,\n* insufficient validation of script execution via global script event handlers within the file `sfx2/source/notify/eventsupplier.cxx`.\n\nTherefore further fixes were required which were disclosed under CVE-2019-9850 (described in BDSA-2019-4352) and CVE-2019-9851 (described in BDSA-2019-4353).",
    "publishedDate": "2019-07-22T15:38:41.785Z",
    "updatedDate": "2020-04-03T13:40:14.766Z",
    "disclosureDate": "2019-07-18T00:00:00.000Z",
    "exploitPublishDate": "2019-08-20T00:00:00.000Z",
    "solution": "Fixed in **[6.3.0.3](https://github.com/LibreOffice/core/releases/tag/libreoffice-6.3.0.3)** and **[6.2.6.1](https://github.com/LibreOffice/core/releases/tag/libreoffice-6.2.6.1)** by these commits:\n* [Commit 1](https://github.com/LibreOffice/core/commit/1b63fa32bbd4a5b89d2ee3a53b28de4250c8dad3)\n* [Commit 2](https://github.com/LibreOffice/core/commit/cb0024e3668979dfdef44db5aa15ddfaf035e695)\n* [Commit 3](https://github.com/LibreOffice/core/commit/4a66c7eda6ccde26a42c4e31725248c59940255d)\n* [Commit 4](https://github.com/LibreOffice/core/commit/7942929685fafb0f9c82feb8da7279e5103c87f0)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.2
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nils Emmerich, alex, Gabriel Masei (1&1)",
    "workaround": "",
    "vendorFixDate": "2019-07-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2252",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-749"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9848",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2252/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/commit/1b63fa32bbd4a5b89d2ee3a53b28de4250c8dad3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/commit/4a66c7eda6ccde26a42c4e31725248c59940255d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/commit/7942929685fafb0f9c82feb8da7279e5103c87f0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/commit/cb0024e3668979dfdef44db5aa15ddfaf035e695",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/releases/tag/libreoffice-6.2.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/releases/tag/libreoffice-6.3.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/154168/libreoffice_logo_exec.rb.txt",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.libreoffice.org/about-us/security/advisories/CVE-2019-9848",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.libreoffice.org/about-us/security/advisories/CVE-2019-9850",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.libreoffice.org/about-us/security/advisories/CVE-2019-9851",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2252/default-remediation-status"
            }
        ]
    }
}