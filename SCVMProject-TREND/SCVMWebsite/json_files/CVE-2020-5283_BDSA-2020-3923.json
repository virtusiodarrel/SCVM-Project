{
    "source": "BDSA",
    "name": "BDSA-2020-3923",
    "title": "ViewVC Vulnerable to Cross-Site Scripting (XSS) via 'show_subdir_lastmod' Functionality",
    "description": "ViewVC is vulnerable to stored cross-site scripting (XSS) due to a lack of sanitization of user-supplied input. An attacker can exploit this flaw to execute malicious scripts in the context of the victim's browser, allowing the theft of session tokens, cookies, and other sensitive information.",
    "technicalDescription": "This vulnerability exists within the `lib/viewvc.py ` file when CVS `show_subdir_lastmod` support is enabled. Attackers with commit privileges to a CVS repository could exploit this by inputting payloads which are stored as file names to be executed when the file is embedded in an `html stream`. This could allow the attacker to obtain sensitive information, such as browser cookies.",
    "publishedDate": "2020-12-30T10:43:45.556Z",
    "updatedDate": "2020-12-30T10:43:45.550Z",
    "disclosureDate": "2020-03-26T00:00:00.000Z",
    "exploitPublishDate": "2020-03-26T00:00:00.000Z",
    "solution": "Fixed in [**1.2.1**](https://github.com/viewvc/viewvc/releases/tag/1.2.1) by [this](https://github.com/viewvc/viewvc/commit/ad0f966e9a997b17d853a6972ea283d4dcd70fa8) commit.\n\nFixed in [**1.1.28**](https://github.com/viewvc/viewvc/releases/tag/1.1.28) by [this](https://github.com/viewvc/viewvc/commit/1109c82e93ce0334b42256077afab715cfd61957) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "There are three workarounds suggested by the vendor:\n\nUnless the naughtily-named file is actually desired in your repository, remove or rename its ,v backing file in your repository.\nDisable show_subdir_lastmod in your viewvc.conf file.\nPatch lib/viewvc.py",
    "vendorFixDate": "2020-03-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3923",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5283",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3923/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/viewvc/viewvc/commit/1109c82e93ce0334b42256077afab715cfd61957",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/viewvc/viewvc/commit/ad0f966e9a997b17d853a6972ea283d4dcd70fa8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/viewvc/viewvc/issues/211",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/viewvc/viewvc/issues/211",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/viewvc/viewvc/releases/tag/1.1.28",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/viewvc/viewvc/releases/tag/1.2.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/viewvc/viewvc/security/advisories/GHSA-xpxf-fvqv-7mfg",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/viewvc/viewvc/security/advisories/GHSA-xpxf-fvqv-7mfg",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3923/default-remediation-status"
            }
        ]
    }
}