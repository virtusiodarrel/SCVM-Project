{
    "source": "BDSA",
    "name": "BDSA-2019-0972",
    "title": "Magento Vulnerable to SQL Injection vai Un-sanitized 'from-to' Parameter Component",
    "description": "A remote attacker with access to Magento can cause the execution of SQL statements (SQLi) that will result in the leaking of information from the database.",
    "technicalDescription": "Magento does not properly sanitize the input to a `from-to` SQL condition through the `/catalog/product_frontend_action/synchronize` URL.  This allows the injection of SQL commands that can let an attacker to infer information about the data in the database by time based or error based blind SQL injection (SQLi) techniques. The `/catalog/product_frontend_action/synchronize` URL is only available in version **2.2.0** and above, but other vulnerable endpoints may be available in earlier versions  as the un-sanitized `from-to` parameter components exist since version **1.0**.",
    "publishedDate": "2019-04-09T12:11:58.654Z",
    "updatedDate": "2019-04-11T14:35:25.681Z",
    "disclosureDate": "2019-03-22T00:00:00.000Z",
    "exploitPublishDate": "2019-03-22T00:00:00.000Z",
    "solution": "Fixed in versions [**2.3.1**](https://github.com/magento/magento2/releases/tag/2.3.1), [**2.2.8**](https://github.com/magento/magento2/releases/tag/2.2.8) and [**2.1.17**](https://github.com/magento/magento2/releases/tag/2.1.17) by [this](https://github.com/magento/magento2/commit/60ae26d9fbff50e247b9803e0a247bfd51f4332a) git commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.0
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-03-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0972",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-7139",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0972/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/magento/magento2/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://magento.com/security/patches/magento-2.3.1-2.2.8-and-2.1.17-security-update",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/152285/magento-sqli.py.txt",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.ambionics.io/blog/magento-sqli",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0972/default-remediation-status"
            }
        ]
    }
}