{
    "source": "BDSA",
    "name": "BDSA-2019-1741",
    "title": "Freenet Vulnerable to Content Filter Bypass via Missing 'Content-Encoding' HTTP Header",
    "description": "Freenet is vulnerable to the bypassing of content filters due to a missing response header. A remote attacker could cause users to render dangerous content within their browser, such as malicious scripts. This could allow for various adverse outcomes, such as de-anonymization.",
    "technicalDescription": "Whenever Freenet communicates data between nodes on a network, it will attempt to ensure that end users are warned if that data contains poorly formed or scripted content. Code relating to this functionality is contained within the script `FProxyToadlet.java`. Users can specify the MIME type of data that is being sent. The treatment of the file by Freenode with regards to warnings is dependent on this MIME type. For example, plain text data will not be subjected to any rigorous filtering. \n\nWhenever Freenet is delivering the data, it does not insert an appropriate `Content-Encoding` header. Certain browsers (e.g. Firefox) will attempt to automatically detect the content type, and process it accordingly, if the `Content-Encoding` header is missing. Data that is considered not to be plain text will be processed according to the specified file extension. This could be used to bypass Freenode's content warning system. An attacker could  send malicious data, such as a de-anonymization script, via Freenode having specified that it as plaintext content. Freenode will therefore not warn the recipient of the data's dangerous nature. The recipient's browser will then detect the true nature of the content and render it accordingly, executing the malicious script.",
    "publishedDate": "2019-06-14T15:39:12.496Z",
    "updatedDate": "2019-06-14T15:39:12.489Z",
    "disclosureDate": "2019-03-23T00:00:00.000Z",
    "exploitPublishDate": "2019-03-23T00:00:00.000Z",
    "solution": "Fixed in version [**0.7.5**](https://github.com/freenet/fred/releases/tag/build01484) by [this](https://github.com/freenet/fred/commit/8326a571326605542d5f23fb16e625bc984e9c8c) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-03-09T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1741",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-436"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9673",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1741/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bpb.opendns.com/b/https/freenetproject.org/freenet-build-1484-released.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/freenet/fred/commit/8326a571326605542d5f23fb16e625bc984e9c8c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/freenet/fred/releases/tag/build01484",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mgrube/CVE-2019-9673",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1741/default-remediation-status"
            }
        ]
    }
}