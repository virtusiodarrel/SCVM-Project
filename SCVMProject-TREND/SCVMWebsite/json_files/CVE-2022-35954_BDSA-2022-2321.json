{
    "source": "BDSA",
    "name": "BDSA-2022-2321",
    "title": "@actions/core in GitHub Actions ToolKit Vulnerable to Command Injection via 'core.exportVariable' Function",
    "description": "@actions/core within GitHub Actions ToolKit is vulnerable to command injection. An authenticated attacker could exploit this to inject arbitrary environment variables which may lead to the modification of other environment variables and paths in the process. This could be leveraged to achieve remote code execution (RCE).",
    "technicalDescription": "This vulnerability exists within the `core.exportVariable` function as it uses a well known delimiter. This can be leveraged to modify paths or other environment variables to an attacker controlled value in the `GITHUB_ENV` file.\n\nIt has been mitigated in the `packages/core/src/core.ts` file within the same function to use a randomized multi-line environment delimiter `uuid`.",
    "publishedDate": "2022-08-22T14:26:04.401Z",
    "updatedDate": "2022-08-25T08:06:36.310Z",
    "disclosureDate": "2022-08-12T00:00:00.000Z",
    "solution": "Fixed in version [**1.9.1**](https://www.npmjs.com/package/@actions/core/v/1.9.1) by [this](https://github.com/actions/toolkit/commit/4beda9cbc00ba6eefe387a937c21087ccb8ee9df) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/@actions/core).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.0,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "jupenur",
    "workaround": "The vendor has issued the following workaround:\n\n\"Modify your action to ensure that any user input does not contain the delimiter `_GitHubActionsFileCommandDelimeter_` before calling `core.exportVariable`\"",
    "vendorFixDate": "2022-08-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 4.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2321",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-35954",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2321/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/actions/toolkit/commit/4beda9cbc00ba6eefe387a937c21087ccb8ee9df",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/actions/toolkit/security/advisories/GHSA-7r3h-m5j6-3q42",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/actions/toolkit/security/advisories/GHSA-7r3h-m5j6-3q42",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1625652",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/@actions/core",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/@actions/core/v/1.9.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2321/default-remediation-status"
            }
        ]
    }
}