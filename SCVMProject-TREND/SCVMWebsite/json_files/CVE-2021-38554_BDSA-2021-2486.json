{
    "source": "BDSA",
    "name": "BDSA-2021-2486",
    "title": "HashiCorp Vault Vulnerable to Sensitive Data Exposure via Improper Caching of User-Viewed Secrets on a Shared Browser via Vault UI",
    "description": "HashiCorp Vault is vulnerable to sensitive data exposure via improper caching of user-viewed secrets on a shared browser via Vault UI. An authenticated attacker could exploit this in order to view the secrets viewed by the previous user in instances where the browser had not between closed or refreshed between a logout and subsequent login. \n\n**Note:** Per the Vendor, \"Vault UI is not activated by default, and requires `ui=true` to be set in the Vault configuration.\"",
    "technicalDescription": "Vault UI is an optional web-based user interface with features including the ability to view secrets which have authorization enforced. This issue occurs in the `Route.extend()` function of the `ui/app/routes/vault/cluster/logout.js` file because Vault UI failed to clear the client side user cache which incorrectly included these secrets. In order to achieve successful exploitation of this attack the same browser must have been used for both sessions, without being closed or refreshed, and the secrets mush have been viewed by the initial user. \nIt was mitigated by the addition of an automatic page refresh upon logout.",
    "publishedDate": "2021-08-17T16:00:50.415Z",
    "updatedDate": "2021-12-06T16:10:00.084Z",
    "disclosureDate": "2021-08-12T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.8.0**](https://github.com/hashicorp/vault/releases/tag/v1.8.0) by [this](https://github.com/hashicorp/vault/commit/ed8d36b632f46e17227764ab0570cb01b13a6db0) commit,\n* [**1.7.4**](https://github.com/hashicorp/vault/releases/tag/v1.7.4) by [this](https://github.com/hashicorp/vault/commit/e7cc5fcea4ba744e0bb499ed9e753557b5e44c8b) commit,\n* [**1.6.6**](https://github.com/hashicorp/vault/releases/tag/v1.6.6) by [this](https://github.com/hashicorp/vault/commit/d7cb1ff8aa2146db034a6cee06f2c0aa50d6fd5c) commit.\n\nThe latest stable releases can be found [here](https://www.vaultproject.io/downloads).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Avinash Kumar",
    "workaround": "The Vendor suggests the following for users unable to upgrade:\n\n\"Vault UI users should avoid sharing a browser, or should ensure they close or refresh their browser window or tab between Vault login sessions by different users.\"",
    "vendorFixDate": "2021-07-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2486",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-525"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-38554",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2486/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.hashicorp.com/t/hcsec-2021-19-vault-s-ui-cached-user-viewed-secrets-between-shared-browser-sessions/28166",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://discuss.hashicorp.com/t/hcsec-2021-19-vault-s-ui-cached-user-viewed-secrets-between-shared-browser-sessions/28166",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/2c2f0d853f0342509037b4573c28d9be409db2fb",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/d7cb1ff8aa2146db034a6cee06f2c0aa50d6fd5c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/e7cc5fcea4ba744e0bb499ed9e753557b5e44c8b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/ed8d36b632f46e17227764ab0570cb01b13a6db0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/pull/12035",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases/tag/v1.6.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases/tag/v1.7.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases/tag/v1.8.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.vaultproject.io/downloads",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2486/default-remediation-status"
            }
        ]
    }
}