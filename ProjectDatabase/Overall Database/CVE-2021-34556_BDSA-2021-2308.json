{
    "source": "BDSA",
    "name": "BDSA-2021-2308",
    "title": "Linux Kernel Vulnerable to Information Disclosure via Unprotected Uninitialized BPF Stack Locations in Speculative Store Bypass Protection",
    "description": "The Linux Kernel is vulnerable to an information disclosure issue due to how any uninitialized BPF stack locations are not considered when identifying memory store operations to be protected against the Speculative Store Bypass attack.\n\nA malicious, unprivileged BPF program could be used to abuse this flaw and disclose the contents of arbitrary kernel memory with a side-channel attack.",
    "technicalDescription": "The Linux Kernel is vulnerable to an information disclosure issue because uninitialized BPF stack locations are left unprotected by the Speculative Store Bypass protection measures. These locations are not considered when identifying memory store operations that are to be protected, which means that the BPF verifier does not protect the first store operation. The BPF stack is also allocated without sanitization of preexisting memory content, which allows load instructions that occur later to speculatively execute ahead of store operations and disclose the contents of the kernel's memory.",
    "publishedDate": "2021-08-02T12:53:41.490Z",
    "updatedDate": "2021-08-12T13:20:29.676Z",
    "disclosureDate": "2021-08-01T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.10.56**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bea9e2fd180892eba2574711b05b794f1d0e7b73) commit and [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0e9280654aa482088ee6ef3deadef331f5ac5fb0) commit,\n* [**5.13.8**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ddab060f996e17b38bb181c5fd11a83fd1bfa0df) commit and [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0b27bdf02c400684225ee5ee99970bcbf5082282) commit,\n* [**5.14-rc4**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f5e81d1117501546b7be050c5fbafa6efd2c722c) commit and [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2039f26f3aca5b0e419b98f65dd36481337b86ee) commit.\n\nThe latest stable releases are available [here](https://www.kernel.org).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Benedict Schlueter",
    "workaround": "",
    "vendorFixDate": "2021-07-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2308",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-34556",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2308/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0b27bdf02c400684225ee5ee99970bcbf5082282",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0e9280654aa482088ee6ef3deadef331f5ac5fb0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2039f26f3aca5b0e419b98f65dd36481337b86ee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bea9e2fd180892eba2574711b05b794f1d0e7b73",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ddab060f996e17b38bb181c5fd11a83fd1bfa0df",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f5e81d1117501546b7be050c5fbafa6efd2c722c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2039f26f3aca5b0e419b98f65dd36481337b86ee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f5e81d1117501546b7be050c5fbafa6efd2c722c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/08/01/3",
                "label": "ADVISORY"
            }
        ]
    }
}