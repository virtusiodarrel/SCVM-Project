{
    "source": "BDSA",
    "name": "BDSA-2019-0913",
    "title": "libssh2 Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Read in '_libssh2_transport_read()' Function",
    "description": "libssh2 is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause a victim's instance of the application to crash by tricking them into connecting to a malicious server.",
    "technicalDescription": "The function `_libssh2_transport_read()`, defined in `transport.c`, collects received packets into the input queue. These packets contain data disclosing their length, and the length of any padding that they contain. The padding length specified in the received packet is extracted, and its value assigned to the `padding_length` variable that is contained in the structure `p`. Similarly, the field that denotes the length of the entire packet is extracted and assigned to the `packet_length` variable within `p`.  These values influence the packet decompression process, as the application uses the size values denoted by the received packet in order to calculate offsets in memory from which data is read. \n\nThe application makes no attempt to validate the sizes of these variables. If the `padding_length` value is larger than `packet_length`, the application will attempt to read memory from a location which lies outside of the target buffer's boundaries. This out-of-bounds read operation can result in an exception being raised, halting program execution. \n\nAn attacker could therefore cause a DoS by supplying a client with packets which will cause `padding_length` to be greater than `packet_length`. The attacker could accomplish this by tricking the victim into connecting to a malicious server.",
    "publishedDate": "2019-04-02T15:27:43.035Z",
    "updatedDate": "2019-04-02T15:27:43.017Z",
    "disclosureDate": "2019-03-18T00:00:00.000Z",
    "solution": "Fixed in version [**1.8.1**](https://github.com/libssh2/libssh2/releases/tag/libssh2-1.8.1) by [this](https://github.com/libssh2/libssh2/commit/c286e4d82f24def116d9679cb2453948f74e8183) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Chris Coulson (Canonical Ltd)",
    "workaround": "",
    "vendorFixDate": "2019-03-14T00:00:00.000Z",
    "vendorNotifiedDate": "2018-12-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0913",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3861",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0913/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libssh2/libssh2/commit/c286e4d82f24def116d9679cb2453948f74e8183",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libssh2/libssh2/releases/tag/libssh2-1.8.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.libssh2.org/CVE-2019-3861.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0913/default-remediation-status"
            }
        ]
    }
}