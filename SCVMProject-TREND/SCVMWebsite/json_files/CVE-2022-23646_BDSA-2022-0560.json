{
    "source": "BDSA",
    "name": "BDSA-2022-0560",
    "title": "Next.js Vulnerable to Improper Content Security Policy (CSP) in Image Optimization API",
    "description": "Next.js contains an improper Content Security Policy (CSP) implementation, this will lead to the to User Interface (UI) misrepresenting critical information. An attacker can exploit this vulnerability in order to display incorrect information to users that appears to have come from a trusted source, which could then be used to trick the user into performing unwanted actions. \n\n**Note:** The vendor has stated that the following must be true in order to be affected by this vulnerability:\n* The `next.config.js` file has `images.domains` array assigned\n* The image host assigned in `images.domains` allows user-provided SVG\n\nAdditionally if the `next.config.js` file has images.loader assigned to something other than default then the vendor has stated you are not affected.",
    "technicalDescription": "This vulnerability exists due to issues with the `response-cache` used for ISR for the `image-optimizer`  in Next.js.",
    "publishedDate": "2022-03-02T10:24:27.957Z",
    "updatedDate": "2022-05-30T15:56:44.221Z",
    "disclosureDate": "2022-02-17T00:00:00.000Z",
    "solution": "Fixed in  [**12.0.11-canary.10**](https://github.com/vercel/next.js/releases/tag/v12.0.11-canary.10) by [this](https://github.com/vercel/next.js/commit/130f8645a2db18527142a7764eaa5e649183cc74) commit.\n\nThe latest stable releases are available [here](https://github.com/vercel/next.js/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has provided two workarounds [here](https://github.com/vercel/next.js/security/advisories/GHSA-fmvm-x8mv-47mj):\n\n* Change `next.config.js` to use a different loader configuration other than the default, for example:\n```\nmodule.exports = {\n  images: {\n    loader: 'imgix',\n    path: 'https://example.com/myaccount/',\n  },\n}\n```\n\n* Or if you want to use the loader prop on the component, you can use custom:\n```\nmodule.exports = {\n  images: {\n    loader: 'custom',\n  },\n}\n```",
    "vendorFixDate": "2022-02-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0560",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-451"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23646",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0560/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-fmvm-x8mv-47mj",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vercel/next.js/commit/130f8645a2db18527142a7764eaa5e649183cc74",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vercel/next.js/pull/34075",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vercel/next.js/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vercel/next.js/releases/tag/v12.0.11-canary.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vercel/next.js/security/advisories/GHSA-fmvm-x8mv-47mj",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vercel/next.js/security/advisories/GHSA-fmvm-x8mv-47mj",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0560/default-remediation-status"
            }
        ]
    }
}