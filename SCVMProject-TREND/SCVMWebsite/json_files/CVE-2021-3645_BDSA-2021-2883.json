{
    "source": "BDSA",
    "name": "BDSA-2021-2883",
    "title": "merge Vulnerable to Remote Code Execution (RCE) via Prototype Pollution in 'merge()' Function",
    "description": "merge is vulnerable to remote code execution (RCE) due to insufficient restrictions being placed on object manipulation functionality. An attacker could use maliciously crafted scripts in order to modify the prototype of objects in memory. This could potentially allow the attacker to execute arbitrary code on a vulnerable system. Other impacts include denial-of-service (DoS), or the modification of business logic, depending on how affected objects are used.",
    "technicalDescription": "The function `merge()`, of file `index.js`, sets the properties of one object to match those of another. This function doesn't place restrictions on the object properties that can be modified, and so it can be leveraged to modify the `__proto__` or `constructor` properties of an object. A remote attacker could potentially exploit this in order to conduct a prototype pollution attack. The impact that the attacker is able to achieve will depend on how affected objects are used by the application. Potential impacts include remote code execution, DoS, and business logic modification.\n\nThe vulnerability was fixed by introducing a check to `merge()` which prevents the modification of the `__proto__` and  `constructor` properties.",
    "publishedDate": "2021-09-29T10:32:31.127Z",
    "updatedDate": "2021-09-29T10:32:31.116Z",
    "disclosureDate": "2021-09-08T00:00:00.000Z",
    "exploitPublishDate": "2021-09-08T00:00:00.000Z",
    "solution": "Fixed in version [**1.0.2**](https://www.npmjs.com/package/@viking04/merge) by [this](https://github.com/viking04/merge/commit/baba40332080b38b33840d2614df6d4142dedaf6) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jayateertha Guruprasad",
    "workaround": "",
    "vendorFixDate": "2021-09-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2883",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-668"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-915"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3645",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2883/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/viking04/merge/commit/baba40332080b38b33840d2614df6d4142dedaf6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/ef387a9e-ca3c-4c21-80e3-d34a6a896262/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/ef387a9e-ca3c-4c21-80e3-d34a6a896262/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/@viking04/merge",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2883/default-remediation-status"
            }
        ]
    }
}