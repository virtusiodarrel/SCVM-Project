{
    "source": "BDSA",
    "name": "BDSA-2020-1537",
    "title": "Ansible AWX Vulnerable to Information Disclosure via World-Readable 'rsyslog' Configuration File",
    "description": "It has been discovered that Ansible Tower, a derivative project from AWX, may leak sensitive information (such as Splunk tokens) due to an improperly setup configuration file. This is valid evidence to believe that AWX is impacted as well.",
    "technicalDescription": "Sensitive information may get leaked due to `rsyslog` file (`/var/lib/awx/rsyslog/rsyslog.conf`) having permissions which allow anyone to read the file (`644`). This was fixed by setting them to `640` in `reconfigure_rsyslog()` (in file `awx/main/utils/external_logging.py`).",
    "publishedDate": "2020-06-26T14:37:09.526Z",
    "updatedDate": "2020-08-04T11:46:37.344Z",
    "disclosureDate": "2020-06-17T00:00:00.000Z",
    "solution": "Fixed in [**13.0.0**](https://github.com/ansible/awx/releases/tag/13.0.0) by [this](https://github.com/ansible/awx/commit/8174516d3) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "Regarding Ansible Tower, the vendor notes that manually setting the permissions for the `rsyslog.conf` file to `640` would mitigate the issue temporarily since they will be set back to `644` every time the Tower services are restarted.",
    "vendorFixDate": "2020-06-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1537",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-276"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10782",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1537/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-10782",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/awx/commit/8174516d3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/awx/releases/tag/13.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1537/default-remediation-status"
            }
        ]
    }
}