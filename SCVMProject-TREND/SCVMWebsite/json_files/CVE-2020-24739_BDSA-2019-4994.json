{
    "source": "BDSA",
    "name": "BDSA-2019-4994",
    "title": "iCMS Vulnerable to Cross-Site Request Forgery (CSRF) via Missing CSRF Tokens",
    "description": "`iCMS` contains a cross-site request forgery (CSRF) vulnerability due to the lack of appropriate security measures (i.e. CSRF tokens). An attacker could exploit this vulnerability by sending a crafted link to another user, in order to execute malicious actions on their behalf.",
    "technicalDescription": "This issue occurs in the application's administrator account deletion functionality. An attacker can use a crafted link in order to delete all of the administrator accounts, except for that of the initial administrator.\n\nThe vendor has addressed this issue by adding token verification logic (via the code `empty($token) && trigger_error(\"TOKEN empty\",E_USER_ERROR);`), within the `iPHP/core/iWAF.class.php` file.",
    "publishedDate": "2021-01-12T14:26:19.716Z",
    "updatedDate": "2021-01-22T09:57:36.315Z",
    "disclosureDate": "2019-09-02T00:00:00.000Z",
    "exploitPublishDate": "2019-09-02T00:00:00.000Z",
    "solution": "Fixed in [**7.0.16**](https://github.com/idreamsoft/iCMS/releases/tag/v7.0.16) with [this](https://github.com/idreamsoft/iCMS/commit/c7cab1ed4533187c6164807b3ed3228572d5609f) commit.\n\nThe latest stable releases can be found [here](https://github.com/idreamsoft/iCMS/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "laker",
    "workaround": "",
    "vendorFixDate": "2019-09-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4994",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-24739",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4994/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/idreamsoft/iCMS/commit/c7cab1ed4533187c6164807b3ed3228572d5609f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/idreamsoft/iCMS/issues/76",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/idreamsoft/iCMS/issues/76",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/idreamsoft/iCMS/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/idreamsoft/iCMS/releases/tag/v7.0.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4994/default-remediation-status"
            }
        ]
    }
}