{
    "source": "BDSA",
    "name": "BDSA-2020-3161",
    "title": "BookStack Vulnerable to Cross-Site Scripting (XSS) via 'escapeScripts' Function",
    "description": "BookStack contains a cross-site scripting (XSS) vulnerability due to improper user input sanitization. This can allow an attacker to execute malicious scripts in the context of the browser, allowing the theft of session tokens, cookies or other sensitive information.",
    "technicalDescription": "This vulnerability exists within the `escapeScripts`function in the `app/Entities/Managers/PageContent.php` file.\nAttackers with permissions to edit a page could input malicious JavaScript code through the use of `javascript:` URIs to be executed by the victim. The vendor addressed this by removing clickable links and calls to JavaScript URI and also meta tags to prevent any external redirects.",
    "publishedDate": "2020-11-05T14:09:28.101Z",
    "updatedDate": "2020-11-05T14:09:28.093Z",
    "disclosureDate": "2020-10-27T00:00:00.000Z",
    "solution": "Fixed in [**0.30.4**](https://github.com/BookStackApp/BookStack/releases/tag/v0.30.4) by [this](https://github.com/BookStackApp/BookStack/commit/bbd1384acbe7e52c21f89af69f2dc391c95dbf54) commit.\n\nThe latest stable releases are available [here](https://github.com/BookStackApp/BookStack/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "As a workaround without upgrading, \n> \"page edit permissions could be limited to only those that are trusted until you can upgrade although this will not address existing exploitation of this vulnerability.\"",
    "vendorFixDate": "2020-10-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3161",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-26211",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3161/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/commit/bbd1384acbe7e52c21f89af69f2dc391c95dbf54",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/releases/tag/v0.30.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/security/advisories/GHSA-r2cf-8778-3jgp",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/security/advisories/GHSA-r2cf-8778-3jgp",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3161/default-remediation-status"
            }
        ]
    }
}