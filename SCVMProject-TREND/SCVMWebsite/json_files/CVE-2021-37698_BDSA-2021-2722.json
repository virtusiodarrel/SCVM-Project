{
    "source": "BDSA",
    "name": "BDSA-2021-2722",
    "title": "Icinga Vulnerable to Man-in-the-Middle (MitM) Attacks via Missing TLS server Certificate Validation in Multiple TSDBs",
    "description": "Icinga is vulnerable to man-in-the-middle (MitM) style attacks due to how multiple metric writers/time series databases (TSDBs), when using TLS, do not verify the server's certificate.\n\nThis issue could allow an attacker to provide a spoofed certificate in order to obtain information between Icinga and the metrics server.\n\n**Note**: The vendor has stated [here](https://icinga.com/blog/2021/08/19/icinga-2-13-1-security-release/) that apart from upgrading, instances which connect to any of the mentioned TSDBs using TLS over a spoofable infrastructure should also change the credentials (if any) used by the TSDB writer feature to authenticate against the TSDB.",
    "technicalDescription": "Icinga is vulnerable to man-in-the-middle (MitM) attacks because multiple TSDBs do not verify the server's certificate, even when a certificate authority is specified.\n\nThe affected TSDBs are:\n* `ElasticsearchWriter`, \n* `GelfWriter`, \n* `InfluxdbWriter`, and \n* `Influxdb2Writer`.",
    "publishedDate": "2021-09-08T11:35:49.098Z",
    "updatedDate": "2021-09-08T11:35:49.075Z",
    "disclosureDate": "2021-08-19T00:00:00.000Z",
    "solution": "Fixed in [**2.13.1**](https://github.com/Icinga/icinga2/releases/tag/v2.13.1) by the following commits:\n* [Commit 1](https://github.com/Icinga/icinga2/commit/6080538223c29ca83317943f8ec4998d1cdf1853)\n* [Commit 2](https://github.com/Icinga/icinga2/commit/055cdf22a83ee0e0ae7b57511c569e45c2434d5f)\n* [Commit 3](https://github.com/Icinga/icinga2/commit/4855cbc23253e3c994f9aae6ce0e63e9ee46d8a7)\n* [Commit 4](https://github.com/Icinga/icinga2/commit/50a798070997459d7005168d2fe2af87b8000c15)\n* [Commit 5](https://github.com/Icinga/icinga2/commit/f0b1195b4a89a8c1d90ec1c747837d4bc972a824)\n* [Commit 6](https://github.com/Icinga/icinga2/commit/b98f939c7f7ad56391a19331266e7c7db0f518f2)\n\nFixed in [**2.12.6**](https://github.com/Icinga/icinga2/releases/tag/v2.12.6) by the following commits:\n* [Commit 1](https://github.com/Icinga/icinga2/commit/8910abc5882774c067dfc22cdf8bf8b830257608)\n* [Commit 2](https://github.com/Icinga/icinga2/commit/bf535969ac23962b65b72ea3893c6b384e1d3218)\n* [Commit 3](https://github.com/Icinga/icinga2/commit/d7133ae4298d133a088b25c9a71ffeb1f8164a8d)\n* [Commit 4](https://github.com/Icinga/icinga2/commit/6db8795ca4b6a853f49615279f068d4cf2b42087)\n* [Commit 5](https://github.com/Icinga/icinga2/commit/b7dd909a30367a4b8389e9362f05a856bbd7b081)\n\nFixed in [**2.11.11**](https://github.com/Icinga/icinga2/releases/tag/v2.11.11) by the following commits:\n* [Commit 1](https://github.com/Icinga/icinga2/commit/5c35ab551bb34e9d817e449dfea70a90264f302c)\n* [Commit 2](https://github.com/Icinga/icinga2/commit/78aa348e6a29c55388673ab5d7869796bf3c50ee)\n* [Commit 3](https://github.com/Icinga/icinga2/commit/037944a51b910144e8fc99b69f27e100616e0d68)\n* [Commit 4](https://github.com/Icinga/icinga2/commit/8da90d44fa5082fb7ea06fbbe3877e71fc9b6228)\n* [Commit 5](https://github.com/Icinga/icinga2/commit/c2abb0c9dc07e0abb78e940359b511293762cb1e)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-08-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2722",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-295"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-37698",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2722/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/037944a51b910144e8fc99b69f27e100616e0d68",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/055cdf22a83ee0e0ae7b57511c569e45c2434d5f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/4855cbc23253e3c994f9aae6ce0e63e9ee46d8a7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/50a798070997459d7005168d2fe2af87b8000c15",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/5c35ab551bb34e9d817e449dfea70a90264f302c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/6080538223c29ca83317943f8ec4998d1cdf1853",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/6db8795ca4b6a853f49615279f068d4cf2b42087",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/78aa348e6a29c55388673ab5d7869796bf3c50ee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/8910abc5882774c067dfc22cdf8bf8b830257608",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/8da90d44fa5082fb7ea06fbbe3877e71fc9b6228",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/b7dd909a30367a4b8389e9362f05a856bbd7b081",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/b98f939c7f7ad56391a19331266e7c7db0f518f2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/bf535969ac23962b65b72ea3893c6b384e1d3218",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/c2abb0c9dc07e0abb78e940359b511293762cb1e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/d7133ae4298d133a088b25c9a71ffeb1f8164a8d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/f0b1195b4a89a8c1d90ec1c747837d4bc972a824",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/releases/tag/v2.11.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/releases/tag/v2.12.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/releases/tag/v2.13.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/security/advisories/GHSA-cxfm-8j5v-5qr2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://icinga.com/blog/2021/08/19/icinga-2-13-1-security-release/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2722/default-remediation-status"
            }
        ]
    }
}