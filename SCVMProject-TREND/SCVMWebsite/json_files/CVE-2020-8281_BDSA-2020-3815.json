{
    "source": "BDSA",
    "name": "BDSA-2020-3815",
    "title": "Nextcloud Contacts Vulnerable to Cross-Site Scripting (XSS) via malicious SVG files",
    "description": "Nextcloud Contacts is vulnerable to cross-site scripting (XSS) attacks. An attacker could exploit this vulnerability by inserting malicious code in order to steal session tokens, cookies, or other sensitive information as well as perform external redirects to a malicious source.",
    "technicalDescription": "This vulnerability exists due to a missing file type check in the `contact-avatar-upload` functionality of file`src/components/ContactDetails/ContactDetailsAvatar.vue` of Nextcloud Contacts. When uploading a contact avatar an attacker could upload a malicious SVG file in order to perform an cross-site scripting (XSS) when a user views the image. This could allow the attacker to steal session tokens, cookies, or other sensitive information as well as perform external redirects to a malicious source.",
    "publishedDate": "2020-12-17T16:00:33.909Z",
    "updatedDate": "2020-12-17T16:00:33.900Z",
    "disclosureDate": "2020-10-20T00:00:00.000Z",
    "exploitPublishDate": "2020-12-17T00:00:00.000Z",
    "solution": "Fixed in [**3.4.0**](https://github.com/nextcloud/contacts/releases/tag/v3.4.0) by [this](https://github.com/nextcloud/contacts/commit/fbb58588a92072fca0d07ec4692d5c0f840dddd5) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tommy Suriel",
    "workaround": "",
    "vendorFixDate": "2020-09-06T00:00:00.000Z",
    "vendorNotifiedDate": "2020-06-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3815",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8281",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3815/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/contacts/commit/fbb58588a92072fca0d07ec4692d5c0f840dddd5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/contacts/releases/tag/v3.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/894876",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://nextcloud.com/security/advisory/?id=NC-SA-2020-045",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3815/default-remediation-status"
            }
        ]
    }
}