{
    "source": "BDSA",
    "name": "BDSA-2021-2739",
    "title": "Xen Vulnerable to Privilege Escalation, Information Exposure, and Denial-of-Service (DoS) via Race Condition",
    "description": "Xen is vulnerable to privilege escalation, information exposure and denial-of-service (DoS) issues due to how, under certain circumstances, grant table version 2 status pages can remain accessible after they have been deallocated.\n\nA malicious guest could abuse this issue and trigger racing requests to insert mappings of the status pages and cause them to be mapped in multiple locations which are left accessible and could lead to information exposure, stability issues or potentially allow the guest to elevate its privileges to that of the host.\n\n**Note**: The vendor has stated [here](http://xenbits.xen.org/xsa/advisory-384.html) that only x86 `HVM` and `PVH` guests that are permitted to use grant table v2 interfaces can leverage this vulnerability.  x86 `PV` guests cannot leverage this vulnerability.  On Arm systems, grant table v2 use is explicitly unsupported.",
    "technicalDescription": "This issue occurs in the `xenmem_add_to_physmap_one()` function of the `xen/arch/arm/mm.c` file, the `xenmem_add_to_physmap_one()` function of the `xen/arch/x86/mm.c` file, and the `gnttab_map_frame()` function of the `xen/common/grant_table.c` file. It was mitigated by ensuring that a page reference is obtained in `gnttab_map_frame()` in order to ensure the page is not freed until `xenmem_add_to_physmap_one()` had completed its action on the page. These amendments have been made across the board and not just for v2 status pages.",
    "publishedDate": "2021-09-09T15:53:54.754Z",
    "updatedDate": "2021-09-28T09:34:21.101Z",
    "disclosureDate": "2021-09-08T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.15.1**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.1) by [this](https://github.com/xen-project/xen/commit/6f92f38419d6bd052da9076a7d89534b1f85ded9) commit,\n* [**4.14.3**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.3) by [this](https://github.com/xen-project/xen/commit/ef6455a3707cf1c7c61ad8af12558811eeee4ba8) commit,\n* [**4.13.4**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.4) by [this](https://github.com/xen-project/xen/commit/9c4b19c110e1410e50a9f1dbd15d337b05e9cc9d) commit.\n\nThe latest stable releases are available [here](https://github.com/xen-project/xen/releases).\n\nFixed in the **staging-4.12** branch by [this](https://github.com/xen-project/xen/commit/47193c78887734c2f95a50125684bf81419f1565) commit which is not yet included in any release.\nFixed in the **staging** branch by [this](https://github.com/xen-project/xen/commit/eb6bbf7b30da5bae87932514d54d0e3c68b23757) commit which is not yet included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Julien Grall of Amazon",
    "workaround": "The vendor has suggested [here](http://xenbits.xen.org/xsa/advisory-384.html) that it is possible to mitigate this vulnerability by only running `PV` guests, or by suppressing the use of grant table v2 interfaces for `HVM` or `PVH` guests.",
    "vendorFixDate": "2021-09-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2739",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28701",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2739/ranges"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-384.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-384.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/47193c78887734c2f95a50125684bf81419f1565",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/6f92f38419d6bd052da9076a7d89534b1f85ded9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/9c4b19c110e1410e50a9f1dbd15d337b05e9cc9d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/eb6bbf7b30da5bae87932514d54d0e3c68b23757",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/ef6455a3707cf1c7c61ad8af12558811eeee4ba8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2739/default-remediation-status"
            }
        ]
    }
}