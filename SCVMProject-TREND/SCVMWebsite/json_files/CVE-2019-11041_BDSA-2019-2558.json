{
    "source": "BDSA",
    "name": "BDSA-2019-2558",
    "title": "PHP Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Read in 'exif_scan_thumbnail' Function",
    "description": "PHP is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause an application that uses an affected version of PHP to crash by uploading a file containing maliciously crafted EXIF data.",
    "technicalDescription": "The function `exif_scan_thumbnail()`, which is defined within the script `exif.c`, is used by PHP to process the in-memory JPEG representation of an image's thumbnail. This function will perform a variety of operations on the memory associated with the JPEG image, such as using the `memcmp()`  function to examine if the initial bytes of the image match the expected JPEG signature. These operations assume that the memory located at certain offsets will contain data relating to the image. \n\nHowever, if the size of the image is small enough, then the offsets accessed by the function will lie outside of the heap buffer that is allocated to store the JPEG image. This will lead to an out-of-bounds read within heap memory. This could lead to an exception being raised, halting program execution. An attacker could therefore cause a vulnerable PHP-based application to crash by causing that application to process an image file containing crafted EXIF data.",
    "publishedDate": "2019-08-15T15:41:42.288Z",
    "updatedDate": "2019-08-15T15:41:42.278Z",
    "disclosureDate": "2019-06-27T00:00:00.000Z",
    "exploitPublishDate": "2019-06-27T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**7.3.8**](https://www.php.net/downloads.php) by [this](http://git.php.net/?p=php-src.git;a=commit;h=f22101c8308669bb63c03a73a2cac2408d844f38) commit,\n* [**7.2.21**](https://www.php.net/downloads.php) by [this](http://git.php.net/?p=php-src.git;a=commit;h=ec39e9646c943d90e627ba24c27651c27a284b75) commit,\n* [**7.1.31**](https://www.php.net/downloads.php) by [this](http://git.php.net/?p=php-src.git;a=commit;h=dea2989ab8ba87a6180af497b2efaf0527e985c5) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-07-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2558",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11041",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2558/ranges"
            },
            {
                "rel": "reference",
                "href": "http://git.php.net/?p=php-src.git;a=commit;h=dea2989ab8ba87a6180af497b2efaf0527e985c5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://git.php.net/?p=php-src.git;a=commit;h=ec39e9646c943d90e627ba24c27651c27a284b75",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://git.php.net/?p=php-src.git;a=commit;h=f22101c8308669bb63c03a73a2cac2408d844f38",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=78222",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=78222",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.php.net/downloads.php",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2558/default-remediation-status"
            }
        ]
    }
}