{
    "source": "BDSA",
    "name": "BDSA-2020-4236",
    "title": "Helm Vulnerable to Authorization Bypass via Duplicate Package Mishandling",
    "description": "Helm is vulnerable to authorization bypass due to the mishandling of duplicate packages. An attacker could add charts to a repository, despite not being authorized to do so, by writing to the index file.",
    "technicalDescription": "A Helm repository can contain multiple charts, with are intended to be distinct. However, it is possible for multiple charts to exist in the same repository, with the indexing process failing to validate that a chart has no duplicates. An authenticated attacker who has write access to the index file (which can be achieved through a MiTM attack) could exploit this to inject malicious charts into the repository, despite not being authorized to do so.",
    "publishedDate": "2021-03-05T16:27:39.433Z",
    "updatedDate": "2021-03-05T16:27:39.425Z",
    "disclosureDate": "2020-09-17T00:00:00.000Z",
    "solution": "Fixed in [**3.3.2**](https://github.com/helm/helm/releases/tag/v3.3.2) by [this](https://github.com/helm/helm/commit/6874a13ad94da0acba1c8e66b2aeb23c3274fccf) commit, and in [**2.16.11**](https://github.com/helm/helm/releases/tag/v2.16.11) by [this](https://github.com/helm/helm/commit/6aab63765f99050b115f0aec3d6350c85e8da946) commit.\n\nThe latest stable releases are available [here](https://github.com/helm/helm/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.4,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 0.7,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Trail of Bits Security Research Team",
    "workaround": "The vendor has stated that the following workarounds are effective:\n* Don't install charts from untrusted repositories.\n* Don't fetch charts over insecure channels.\n* Fetch charts via the `helm pull` command, and then inspect the chart (e.g. via `helm verify`) to ensure that it has not been tampered with. \n* Verify the index file before installing software.",
    "vendorFixDate": "2020-09-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4236",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15185",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4236/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/commit/6874a13ad94da0acba1c8e66b2aeb23c3274fccf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/commit/6aab63765f99050b115f0aec3d6350c85e8da946",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases/tag/v2.16.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases/tag/v3.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/security/advisories/GHSA-jm56-5h66-w453",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/security/advisories/GHSA-jm56-5h66-w453",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4236/default-remediation-status"
            }
        ]
    }
}