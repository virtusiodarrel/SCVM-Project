{
    "source": "BDSA",
    "name": "BDSA-2019-0939",
    "title": "Mozilla Firefox & Thunderbird Vulnerable to Argument Injection via URL Handler Shell Configuration",
    "description": "An argument injection vulnerability has been discovered in Mozilla Mozilla Firefox & Thunderbird. An attacker could exploit this vulnerability by crafting a malicious URL which launches installed programs and exposes them to web content which could be malicious.\n\nNote: This issue only affects Windows operating systems. Other operating systems are unaffected.",
    "technicalDescription": "A weakness has been discovered in Mozilla Firefox & Thunderbird which could aid in executing malicious actions against the target system. The URL handling functionality implemented by the applications does not validate which installed system programs have been registered as a \"URL Handler\" in the windows registry. This can cause any installed program to be executed as a URL handler, which could lead to the program being exposed to malicious web content.\n\nThe `nsOSHelperAppService::OSProtocolHandlerExists` function located in the file `uriloader/exthandler/win/nsOSHelperAppService.cpp` does not check the windows registry for the URL protocol when checking if the protocol handler exists.",
    "publishedDate": "2019-04-05T14:03:30.103Z",
    "updatedDate": "2019-04-05T14:03:30.086Z",
    "disclosureDate": "2019-03-19T00:00:00.000Z",
    "solution": "Fixed in Thunderbird version [**60.6**](https://www.thunderbird.net/en-US/) and Firefox version [**66.0**](https://www.mozilla.org/en-US/firefox/) by [this](https://hg.mozilla.org/mozilla-central/rev/e3a71ebe4064) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Daniel Veditz",
    "workaround": "",
    "vendorFixDate": "2019-03-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-0939",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-88"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-9801",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-0939/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1527717",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1690682",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/e3a71ebe4064",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/firefox/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2019-07/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2019-11/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.thunderbird.net/en-US/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}