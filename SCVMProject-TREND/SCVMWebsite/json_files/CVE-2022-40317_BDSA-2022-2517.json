{
    "source": "BDSA",
    "name": "BDSA-2022-2517",
    "title": "OpenKM DMS Vulnerable to Stored Cross-Site Scripting (XSS) via Insufficient Sanitization of Object 'Notes' Functionality",
    "description": "OpenKM is vulnerable to a stored cross-site scripting (XSS) issue due to a lack of sufficient sanitization of the 'Notes' section of elements/objects.\n\nAn attacker could submit a crafted input that includes potentially malicious scripts within the 'Notes' sections and trick victim user into viewing this content in order to execute the scripts in the context of the victim user's browser. Such scripts could be used to steal information such as cookies, or manipulate the layout of the page.",
    "technicalDescription": "In order to remedy this issue, the vendor has updated the `sanitizeInput()` method of the `src/main/java/com/openkm/util/FormatUtil.java` file to remove `javascript&colon;` substrings from elements.",
    "publishedDate": "2022-09-12T11:53:02.136Z",
    "updatedDate": "2022-09-12T11:53:02.122Z",
    "disclosureDate": "2022-09-01T00:00:00.000Z",
    "solution": "Fixed in the **master** branch by [this](https://github.com/openkm/document-management-system/commit/7680e284596c9a984b39aa1477895d1ec443d61e) commit which is not yet available in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Izdihar (izdiwho)",
    "workaround": "",
    "vendorFixDate": "2022-09-06T00:00:00.000Z",
    "vendorNotifiedDate": "2022-09-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2517",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-40317",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2517/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openkm/document-management-system/commit/7680e284596c9a984b39aa1477895d1ec443d61e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openkm/document-management-system/issues/333",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openkm/document-management-system/pull/336",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2517/default-remediation-status"
            }
        ]
    }
}