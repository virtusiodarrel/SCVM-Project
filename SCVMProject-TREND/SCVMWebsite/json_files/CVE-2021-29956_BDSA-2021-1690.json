{
    "source": "BDSA",
    "name": "BDSA-2021-1690",
    "title": "Thunderbird Vulnerable to Insecure OpenPGP Key Storage via Ineffective Master Password",
    "description": "Thunderbird is vulnerable to insecure OpenPGP secret key storage. Newly imported OpenPGP keys are not automatically encrypted, which means local users with sufficient permissions could read them without knowing the master password.",
    "technicalDescription": "OpenPGP secret keys that are imported in Thunderbird are not automatically protected, meaning the master password is effectively useless. This is caused by an issue in the RNP library where, due to specific key protection setting management, a key decrypted through `rnp_key_unprotect()` will remain unprotected after a subsequent call of `rnp_key_protect()`. Although this has been fixed in RNP, unprotected keys that have been saved outside of RNP still need to be re-protected. The fix in Thunderbird applies the re-protection step and runs repeated automatic scans to detect and encrypt any unprotected keys.",
    "publishedDate": "2021-06-07T16:06:19.968Z",
    "updatedDate": "2021-06-07T16:06:19.963Z",
    "disclosureDate": "2021-05-17T00:00:00.000Z",
    "exploitPublishDate": "2021-05-17T00:00:00.000Z",
    "solution": "Fixed in [**78.10.2**](https://archive.mozilla.org/pub/thunderbird/releases/78.10.2/) by the following commits:\n* [Commit 1](https://hg.mozilla.org/releases/comm-esr78/rev/36ed28f4ec88f8d747399b538d5afd3e73702c94)\n* [Commit 2](https://hg.mozilla.org/releases/comm-esr78/rev/248ac0ef78f64b0c6a57dad759a34977fb73d481)\n* [Commit 3](https://hg.mozilla.org/releases/comm-esr78/rev/6657aa43703aaa1de16003c4ab7e92a1cbc6dff8)\n\nFixed in [**89.0-b4**](https://archive.mozilla.org/pub/thunderbird/releases/89.0b4/) by the following commits:\n* [Commit 1](https://hg.mozilla.org/releases/comm-beta/rev/08585e2d0c668251f00212ce81d082a32d480320)\n* [Commit 2](https://hg.mozilla.org/releases/comm-beta/rev/498ff73e90a3c81f2a89c9012196ab58b2d49f7a)\n* [Commit 3](https://hg.mozilla.org/releases/comm-beta/rev/be0ed093191adfa7c91515bca973714858bb8dca)\n\nThe latest stable releases are available [here](https://archive.mozilla.org/pub/thunderbird/releases/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "HIGH",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.8
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:H/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.0,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.5,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "HIGH",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:H/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Kai Engert and Thunderbird users",
    "workaround": "In order to detect unprotected keys and protect them without upgrading to a fixed version, apply the hotfix provided in the original [bug report](https://bugzilla.mozilla.org/show_bug.cgi?id=1710290).",
    "vendorFixDate": "2021-05-13T00:00:00.000Z",
    "vendorNotifiedDate": "2021-05-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1690",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-311"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29956",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1690/ranges"
            },
            {
                "rel": "reference",
                "href": "https://archive.mozilla.org/pub/thunderbird/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://archive.mozilla.org/pub/thunderbird/releases/78.9.1/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://archive.mozilla.org/pub/thunderbird/releases/89.0b4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1710290",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1710290",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/comm-beta/rev/08585e2d0c668251f00212ce81d082a32d480320",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/comm-beta/rev/498ff73e90a3c81f2a89c9012196ab58b2d49f7a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/comm-beta/rev/be0ed093191adfa7c91515bca973714858bb8dca",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/comm-esr78/rev/248ac0ef78f64b0c6a57dad759a34977fb73d481",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/comm-esr78/rev/36ed28f4ec88f8d747399b538d5afd3e73702c94",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/comm-esr78/rev/6657aa43703aaa1de16003c4ab7e92a1cbc6dff8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-22/#CVE-2021-29957",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.rnpgp.org/advisories/ri-2021-001/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1690/default-remediation-status"
            }
        ]
    }
}