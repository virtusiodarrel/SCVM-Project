{
    "source": "BDSA",
    "name": "BDSA-2020-2142",
    "title": "BookStack Vulnerable to Remote Code Execution (RCE) via Image Upload Functionality",
    "description": "BookStack contains a remote code execution (RCE) vulnerability. Attackers can exploit this by crafting a malicious payload to be inserted via the file image upload functionality.",
    "technicalDescription": "This vulnerability exists due to improper input validation of file types within the image upload functionality. Unauthenticated attackers could exploit this by uploading malicious PHP files, resulting in execution of code on the host remotely, allowing attackers the permissions of the PHP process.",
    "publishedDate": "2020-08-24T15:24:43.395Z",
    "updatedDate": "2021-01-18T15:28:39.660Z",
    "disclosureDate": "2020-03-13T00:00:00.000Z",
    "exploitPublishDate": "2020-03-27T00:00:00.000Z",
    "solution": "Fixed in [**0.25.5**](https://github.com/BookStackApp/BookStack/releases/tag/v0.25.5).\n\nThe latest stable releases are available [here](https://github.com/BookStackApp/BookStack/releases)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "inc0x0 and Thiago Mayllart",
    "workaround": "Depending on BookStack version, you could use the `local_secure` image storage option, or use `s3` or a similar compatible service.\n\nPreventing direct execution of any php files, apart from the `public/index.php file`, though web-server configuration would also prevent this.",
    "vendorFixDate": "2020-03-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2142",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5256",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2142/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/releases/tag/v0.25.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/security/advisories/GHSA-g9rq-x4fj-f5hx",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BookStackApp/BookStack/security/advisories/GHSA-g9rq-x4fj-f5hx",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://medium.com/stolabs/bookstack-cve-2020-5256-rce-through-file-upload-870a98228c7a",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2142/default-remediation-status"
            }
        ]
    }
}