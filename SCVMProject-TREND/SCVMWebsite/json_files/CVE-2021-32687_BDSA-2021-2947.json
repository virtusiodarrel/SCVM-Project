{
    "source": "BDSA",
    "name": "BDSA-2021-2947",
    "title": "Redis Vulnerable to Remote Code Execution (RCE) via Integer Overflow with 'intset' Arrays",
    "description": "Redis is vulnerable to remote code execution (RCE) due to the improper processing of `intset` encoded sets. An attacker could exploit this vulnerability by supplying a system with maliciously crafted commands.",
    "technicalDescription": "The issue occurs with the processing of `intsets`, which are sets encoded as sorted arrays of integers. Improper validation of the maximum number of entries for such sets could allow an integer overflow which causes corruption of the heap, or the arbitrary leaking of information from the heap.",
    "publishedDate": "2021-10-05T16:49:51.180Z",
    "updatedDate": "2022-08-23T10:26:20.447Z",
    "disclosureDate": "2021-10-04T00:00:00.000Z",
    "solution": "Fixed in:\n* [**6.2.6**](https://github.com/redis/redis/releases/tag/6.2.6) by [this](https://github.com/redis/redis/commit/b1149a49b) commit,\n* [**6.0.16**](https://github.com/redis/redis/releases/tag/6.0.16) by [this](https://github.com/redis/redis/commit/a30d367a71b7017581cf1ca104242a3c644dec0f) commit,\n* [**5.0.14**](https://github.com/redis/redis/releases/tag/5.0.14) by [this](https://github.com/redis/redis/commit/c043ba77c) commit.\n\nThe latest stable releases are available [here](https://redis.io/download).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Pawel Wieczorkiewicz (Amazon Web Services)",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, the vendor recommends to prevent users from modifying the `set-max-intset-entries` configuration parameter. This can be done using ACL to restrict unprivileged users from using the `CONFIG SET` command.",
    "vendorFixDate": "2021-10-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2947",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32687",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2947/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/a30d367a71b7017581cf1ca104242a3c644dec0f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/b1149a49b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/c043ba77c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/c043ba77cf9bbf73e964fd9b8681c0cc4bd2662e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/5.0.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/6.0.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/6.2.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/security/advisories/GHSA-m3mf-8x9w-r27q",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/security/advisories/GHSA-m3mf-8x9w-r27q",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://redis.io/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2947/default-remediation-status"
            }
        ]
    }
}