{
    "source": "BDSA",
    "name": "BDSA-2020-2620",
    "title": "Linux Kernel Vulnerable to Information Disclosure via Uninitialized Memory Copied to Userspace with udisks and romfs",
    "description": "The Linux kernel is vulnerable to leaking uninitialized memory to userspace through the udisk and romfs subsystems. A local attacker on the system may learn the contents of sensitive kernel memory.",
    "technicalDescription": "The udisk subsystem allows the mounting of arbitrary file systems by low privileged local users on most Linux desktop configurations. The romfs file system component of the Linux kernel contains a flaw whereby it will return uninitialized kernel memory to userspace. \n\nThe flaw exists in the `romfs_dev_read()` function of file `fs/romfs/storage.c`. A specially crafted filesystem whose last inode is a file of size 0x1000, but whose data actually starts one byte before `romfs_maxsize(sb)`, can make `romfs_readpage()` calculate that `romfs_dev_read()` should fill the entire page, whereas it only fills the first byte. The remaining bytes will leak uninitialized kernel data to the attacker.\n\nKernels that are configured to zero kernel pages before release are not affected.",
    "publishedDate": "2020-10-05T11:37:54.240Z",
    "updatedDate": "2021-02-05T13:31:19.837Z",
    "disclosureDate": "2020-10-02T00:00:00.000Z",
    "exploitPublishDate": "2020-10-02T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.234**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2935e0a3cec1ffa558eea90db6279cff83aa3592) commit\n* [**4.9.234**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6d26d08216475e5a40e4f6ade397c181a19dc524) commit\n* [**4.14.195**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=89346bc395e7bc0a7d3c36c824782050b17d4fec) commit\n* [**4.19.142**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9660983738399465fd0e3b1977a61bbd29b2e5be) commit\n* [**5.4.61**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=19a77c937a1914bdd655366e79a2a1b7d675f554) commit\n* [**5.7.18**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ec5713663214ae0cc9821c0a40b6c6022fcaa4d8) commit\n* [**5.8.4**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=734a5c3f266c26ff785bc1fcf083b55fcda47ff5) commit\n* [**5.9-rc2**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bcf85fcedfdd17911982a3e3564fcfec7b01eebd) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "jannh@google.com",
    "workaround": "",
    "vendorFixDate": "2020-08-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2620",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-402"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-29371",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2620/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=2077&q=udisk&can=1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=2077&q=udisk&can=1",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=19a77c937a1914bdd655366e79a2a1b7d675f554",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2935e0a3cec1ffa558eea90db6279cff83aa3592",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6d26d08216475e5a40e4f6ade397c181a19dc524",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=734a5c3f266c26ff785bc1fcf083b55fcda47ff5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=89346bc395e7bc0a7d3c36c824782050b17d4fec",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9660983738399465fd0e3b1977a61bbd29b2e5be",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bcf85fcedfdd17911982a3e3564fcfec7b01eebd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=da4458bda237",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ec5713663214ae0cc9821c0a40b6c6022fcaa4d8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2620/default-remediation-status"
            }
        ]
    }
}