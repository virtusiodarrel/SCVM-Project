{
    "source": "BDSA",
    "name": "BDSA-2017-1111",
    "title": "BlueZ Linux Bluetooth Stack Information Leak Vulnerability (BlueBorne)",
    "description": "A stack based buffer overflow vulnerability in the Linux Bluetooth stack (BlueZ) can result in information leak.",
    "technicalDescription": "The Service Discovery Protocol (SDP) allows devices to discover services that the device supports.  An SDP client will send out an SDP request, polling for nearby services.  If a response to the request exceeds the MTU for the established L2CAP connection, a fragmentation mechanism called SDP Continuation will be employed in order to ensure that the entirety of the response is returned to the client.  According to the Bluetooth specification, the format of the continuation information is not standardised among SDP servers, and servers are free to define their own continuation state (Bluetooth Sepcification v5.0, Vol 3, Part B, page 1926).\n\nBlueZ therefore defines its own continuation state.  This consists of a timestamp, and an index which represents the total number of bytes already transmitted (`maxBytesSent`).  Because this struct is attacker controlled, the attacker can cause the server to read arbitrary data from the heap beyond the bounds of the response buffer.   The `service_search_attr_req()` function in `sdp-request.c` fails to perform any validation on the attacker-controlled value `maxBytesSent` in the continuation state.\n\nThis vulnerability allows data to be leaked from the `bluetoothd` process which contains, among other critical data, encryption keys used in Bluetooth communications.  Such an attack would require no user interaction or prior pairing of devices.",
    "publishedDate": "2017-09-13T15:22:38.183Z",
    "updatedDate": "2017-12-06T16:00:08.549Z",
    "disclosureDate": "2017-09-12T00:00:00.000Z",
    "exploitPublishDate": "2017-09-12T00:00:00.000Z",
    "solution": "Fixed in version [**5.47**](https://git.kernel.org/pub/scm/bluetooth/bluez.git).\n\nAlternatively, merge [this commit](https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/?id=9e009647b14e810e06626dde7f1bb9ea3c375d09) for affected versions.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.1,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 6.5,
        "severity": "MEDIUM",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:A/AC:L/Au:N/C:C/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Amis Labs",
    "workaround": "",
    "vendorFixDate": "2017-09-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1111",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-1000250",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1111/ranges"
            },
            {
                "rel": "reference",
                "href": "http://go.armis.com/hubfs/BlueBorne%20Technical%20White%20Paper.pdf?t=1505222709963",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/bluetooth/bluez.git",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/?id=9e009647b14e810e06626dde7f1bb9ea3c375d09",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.bluetooth.com/specifications/bluetooth-core-specification",
                "label": "LINK"
            }
        ]
    }
}