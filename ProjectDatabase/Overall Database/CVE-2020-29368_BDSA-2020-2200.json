{
    "source": "BDSA",
    "name": "BDSA-2020-2200",
    "title": "Linux Kernel Vulnerable to Privilege Escalation and Information Disclosure via Copy-on-Write Issues",
    "description": "The Linux Kernel is vulnerable to potential information disclosure and privilege escalation via copy-on-write issues.",
    "technicalDescription": "Two issues exist in relation to copy-on-write of anonymous memory after `fork()` is called:\n\nThe first issue relates to page refcount not being accounted for. The child process created by `fork` can read memory from the parent process by getting a refcounted reference to a page with `vmsplice` and then dropping the page from its pagetables. This is possible because the CoW fault handler grants the parent process write access to its original page based on whether or not its mapcount indicates that nothing else has it mapped. In environments like Android this has the potential to result in data leakage between apps. \n\nThe second issue is a race condition in the transparent huge pages logic. The race is between the `__split_huge_pmd_locked()` and `page_trans_huge_map_swapcount()` functions. This can cause the THP CoW fault path to ignore up to two other mappings if one other process is constantly shattering its THP mapping.\n An attacker who could write a sufficiently fast exploit for this issue may be able to perform local privilege escalation. For instance they may be able to break out of the Chrome renderer sandbox on Linux desktop systems.",
    "publishedDate": "2020-09-04T14:55:59.541Z",
    "updatedDate": "2020-11-30T13:34:44.190Z",
    "disclosureDate": "2020-08-25T00:00:00.000Z",
    "exploitPublishDate": "2020-08-25T00:00:00.000Z",
    "solution": "Fixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=17839856fd588f4ab6b789f482ed3ffd7c403e1f) commit and [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c444eb564fb16645c172d550359cb3d75fe8a040) commit in:\n* [**4.9.228**](https://www.kernel.org)\n* [**4.14.185**](https://www.kernel.org)\n* [**4.19.129**](https://www.kernel.org)\n* [**5.4.48**](https://www.kernel.org)\n* [**5.7.5**](https://www.kernel.org)\n* [**5.8-rc1**](https://www.kernel.org)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "(AV:L/AC:H/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn",
    "workaround": "",
    "vendorFixDate": "2020-06-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-2200",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2020-29368",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-2200/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=2045",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=2045",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.7.5",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=17839856fd588f4ab6b789f482ed3ffd7c403e1f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c444eb564fb16645c172d550359cb3d75fe8a040",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}