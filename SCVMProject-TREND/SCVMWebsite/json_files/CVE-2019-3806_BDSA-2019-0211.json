{
    "source": "BDSA",
    "name": "BDSA-2019-0211",
    "title": "PowerDNS Recursor Vulnerable to Access Restriction Bypass via Improper Lua Hooks Usage",
    "description": "PowerDNS Recursor is vulnerable to security policies bypass due to improper Lua hooks application. This vulnerability can be triggered by TCP queries with specific configurations. Successful exploit will allow access restriction bypass.",
    "technicalDescription": "When  PowerDNS Recursor is configured to run multiple threads and distributes the incoming queries to the worker thread (when the configuration variable `pdns-distributes-queries` is set to `yes`), the Lua script fails to properly load in the thread that handles incoming TCP queries for specific setting combinations. \n\nFailure of proper application of Lua scripts can cause security policy bypass that should have been enforced.",
    "publishedDate": "2019-03-05T15:28:52.861Z",
    "updatedDate": "2019-03-05T15:28:52.845Z",
    "disclosureDate": "2019-01-21T00:00:00.000Z",
    "exploitPublishDate": "2019-01-21T00:00:00.000Z",
    "solution": "Fixed in [**rec-4.1.9**](https://github.com/PowerDNS/pdns/releases/tag/rec-4.1.9) by [this](https://github.com/PowerDNS/pdns/pull/7397/commits/66f0bf7f0872e13e1789e487ac6228018a91294a) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dhananjay Arunesh",
    "workaround": "Setting the configuration variable `pdns-distributes-queries` to `no`.",
    "vendorFixDate": "2019-01-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0211",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3806",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0211/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1669422",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://docs.powerdns.com/recursor/security-advisories/powerdns-advisory-2019-01.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://docs.powerdns.com/recursor/security-advisories/powerdns-advisory-2019-01.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://docs.powerdns.com/recursor/security-advisories/powerdns-advisory-2019-01.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/pull/7397/commits/66f0bf7f0872e13e1789e487ac6228018a91294a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/releases/tag/rec-4.1.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0211/default-remediation-status"
            }
        ]
    }
}