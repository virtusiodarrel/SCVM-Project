{
    "source": "BDSA",
    "name": "BDSA-2018-5038",
    "title": "OP-TEE Vulnerable to Denial-of-Service (DoS) via Memory Corruption in 'tee_mmu_check_access_rights' Function",
    "description": "OP-TEE is vulnerable to denial-of-service (DoS) due to improper access checks for secure memory regions, which can lead to memory corruption. A local attacker could exploit this vulnerability by supplying maliciously crafted input.",
    "technicalDescription": "The function `tee_mmu_check_access_rights` within the file `core/arch/arm/mm/tee_mmu.c` does not sufficiently validate a trusted application (TA)'s access rights when it attempts to verify its access to a particular memory region.\n\nThe function uses a start address `uaddr` and a length `len` provided by the TA to check the memory buffer in increments of `addr_incr` (4KiB). If the start and length are not page aligned, this can cause the current address `a` to exceed `uaddr + len`, and the function to stop the check, before the final page of the buffer is reached. This could therefore allow a TA to incorrectly access up to 4KiB of memory possessed by another TA or the secure trusted execution environment (TEE) kernel, which could lead to corruption of TA or TEE kernel memory.",
    "publishedDate": "2019-07-23T15:54:08.895Z",
    "updatedDate": "2019-07-24T08:58:49.531Z",
    "disclosureDate": "2018-11-19T00:00:00.000Z",
    "solution": "Fixed in **[3.4.0](https://github.com/OP-TEE/optee_os/releases/tag/3.4.0)** by [this](https://github.com/OP-TEE/optee_os/commit/95f36d661f2b75887772ea28baaad904bde96970) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Riscure",
    "workaround": "",
    "vendorFixDate": "2018-11-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5038",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-1010293",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5038/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OP-TEE/optee_os/commit/95f36d661f2b75887772ea28baaad904bde96970",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OP-TEE/optee_os/releases/tag/3.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.op-tee.org/security-advisories/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5038/default-remediation-status"
            }
        ]
    }
}