{
    "source": "BDSA",
    "name": "BDSA-2021-1728",
    "title": "CKEditor 4 Vulnerable to Cross-Site Scripting (XSS) via Mishandled Comment Validation in 'CKEDITOR.htmlParser' Functionality",
    "description": "CKEditor 4 is vulnerable to a cross-site scripting (XSS) issue due to how comment end tags are not sufficiently validated.\n\nThis issue could allow an attacker to inject malicious scripts that will execute in the context of the browser of victim user who views the malicious content.",
    "technicalDescription": "CKEditor 4 is vulnerable to cross-site scripting (XSS) because the `CKEDITOR.htmlParser` functionality does not treat the `--!>` syntax as a comment end tag correctly. This does not follow HTML specifications and could allow an attacker to inject malicious content with a crafted comment.\n\nTo remedy this issue, the parser's HTML regex that is defined in the `core/htmlparser.js` file was updated to match the use of `--!>`.",
    "publishedDate": "2021-06-10T16:03:01.322Z",
    "updatedDate": "2021-06-10T16:03:01.318Z",
    "disclosureDate": "2021-05-20T00:00:00.000Z",
    "solution": "Fixed in [**4.16.1**](https://github.com/ckeditor/ckeditor4/releases/tag/4.16.1) by [this](https://github.com/ckeditor/ckeditor4/commit/524ea0e98de3f7d7b117789d44cfcf98171d48c9) commit.\n\nThe latest stable releases are available [here](https://ckeditor.com/ckeditor-4/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-05-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1728",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33829",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1728/ranges"
            },
            {
                "rel": "reference",
                "href": "https://ckeditor.com/blog/ckeditor-4.16.1-with-accessibility-enhancements/#improvements-for-comments-in-html-parser",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ckeditor.com/ckeditor-4/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ckeditor/ckeditor4/blob/major/CHANGES.md#ckeditor-4161",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ckeditor/ckeditor4/commit/524ea0e98de3f7d7b117789d44cfcf98171d48c9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ckeditor/ckeditor4/issues/4659",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ckeditor/ckeditor4/releases/tag/4.16.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1728/default-remediation-status"
            }
        ]
    }
}