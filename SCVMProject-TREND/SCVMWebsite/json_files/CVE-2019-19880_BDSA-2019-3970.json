{
    "source": "BDSA",
    "name": "BDSA-2019-3970",
    "title": "SQLite Vulnerable to Denial-of-Service (DoS) via Invalid Pointer Dereference via 'exprListAppendList()' Function",
    "description": "SQLite is vulnerable to denial-of-service (DoS) due to the mismanagement of memory resources. A remote attacker could cause a victim's instance of the application to crash by submitting crafted request that will lead to the application parsing problematic integer values.",
    "technicalDescription": "The function `exprListAppendList()`, which is defined within `window.c`, appends the expressions contained in one expression list (`pAppend`) to those contained in another (`pList`). This function uses a pointer to an `Expr` structure, `pDup`. The value of this pointer is obtained by evaluating the function `sqlite3ExprDup()`. No validation is performed to ensure that the value returned by this function will be a valid pointer. If certain integer values in an `ORDER BY` clause are being processed, this function may in fact return an invalid pointer value. An exception will occur whenever the program attempts to dereference this pointer, halting program execution. An attacker could therefore cause a victim's instance of the application to crash by submitting crafted request that will lead to the application parsing problematic integer values.",
    "publishedDate": "2019-12-19T13:14:15.411Z",
    "updatedDate": "2020-01-23T14:45:19.599Z",
    "disclosureDate": "2019-12-18T00:00:00.000Z",
    "solution": "Fixed in [**3.31.0**](https://github.com/sqlite/sqlite/releases/tag/version-3.31.0) by [this](https://github.com/sqlite/sqlite/commit/75e95e1fcd52d3ec8282edb75ac8cd0814095d54) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Yongheng and Rui",
    "workaround": "",
    "vendorFixDate": "2019-12-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3970",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-465"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19880",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3970/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sqlite/sqlite/commit/75e95e1fcd52d3ec8282edb75ac8cd0814095d54",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sqlite/sqlite/commit/75e95e1fcd52d3ec8282edb75ac8cd0814095d54",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sqlite/sqlite/releases/tag/version-3.31.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3970/default-remediation-status"
            }
        ]
    }
}