{
    "source": "BDSA",
    "name": "BDSA-2020-4216",
    "title": "Pydio Cells Vulnerable to Stored Cross-Site Scripting (XSS) via Uploading Malicious SVG Files",
    "description": "Pydio Cells is vulnerable to stored cross-site scripting (XSS) due to insufficient validation of client-provided input. An attacker could execute arbitrary scripts within the web browser of a victim by tricking them into clicking a crafted link. This could allow the attacker to obtain sensitive information such as browser cookies.",
    "technicalDescription": "This vulnerability exists because the application allows malicious SVG files to be uploaded as profile pictures. An attacker with access to a user account could upload a malicious JavaScript file for the profile picture of that account. The malicious code will execute when a victim user clicks on the URL for that profile picture. Furthermore, if an admin user clicks on the URL, the attacker could obtain the corresponding JWT token. Then, the attacker could use it to create another admin account as shown in the PoC.",
    "publishedDate": "2021-02-26T09:43:33.213Z",
    "updatedDate": "2021-05-03T08:57:50.078Z",
    "disclosureDate": "2020-05-20T00:00:00.000Z",
    "exploitPublishDate": "2020-05-20T00:00:00.000Z",
    "solution": "Fixed in [**2.0.7**](https://github.com/pydio/cells/releases/tag/v2.0.7) by [this](https://github.com/pydio/cells/commit/327acf08eb696bc0c6f5886539404c585b30b03a) commit.\n\nThe latest stable releases are available [here](https://github.com/pydio/cells/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Iv\u00e1n Koiffman and Ramiro Molina",
    "workaround": "",
    "vendorFixDate": "2020-05-08T00:00:00.000Z",
    "discoveryDate": "2020-04-07T00:00:00.000Z",
    "vendorNotifiedDate": "2020-04-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4216",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12849",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4216/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pydio/cells/commit/327acf08eb696bc0c6f5886539404c585b30b03a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pydio/cells/releases/tag/v2.0.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pydio/cells/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.coresecurity.com/core-labs/advisories/pydio-cells-204-multiple-vulnerabilities",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.coresecurity.com/core-labs/advisories/pydio-cells-204-multiple-vulnerabilities",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4216/default-remediation-status"
            }
        ]
    }
}