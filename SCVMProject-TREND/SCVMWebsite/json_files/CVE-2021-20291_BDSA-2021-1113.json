{
    "source": "BDSA",
    "name": "BDSA-2021-1113",
    "title": "Containers/Storage Vulnerable to Denial-of-Service (DoS) via Deadlock Condition",
    "description": "Containers/Storage is vulnerable to denial-of-service (DoS) via a deadlock condition in the decompression functionality. An attacker can take advantage of this by tricking a user into pulling a malicious container image. \n\nThis issue affects tools which use this library such as podman and cri-o. For applications like podman the affect is minimal. When running `podman pull`  it will wait to download the image forever. Once canceled the affect is negated. For applications like cri-o the affect is more severe. The malicious image will lock the service up, although it is left somewhat responsive. The service must then be killed before returning back to normal.",
    "technicalDescription": "A deadlock vulnerability is present in the Containers/Storage library. When a container engine pulls an image from a registry each layer is unpacked using `tar`. If a layer is not a valid `tar` archive this causes a deadlock situation where the code indefinitely waits for the tar unpacked stream, which will never finish.\n\nAn attacker can upload a malicious layer to the registry which aims to exploit the vulnerability and then upload an image that uses numerous layers, including the malicious layer, and by that create a malicious image. When the victim pulls the image from the registry, it will download the malicious layer in the process and the vulnerability will be exploited.",
    "publishedDate": "2021-08-31T10:53:32.136Z",
    "updatedDate": "2021-08-31T10:53:32.126Z",
    "disclosureDate": "2021-04-14T00:00:00.000Z",
    "solution": "Fixed in [**1.28.1**](https://github.com/containers/storage/releases/tag/v1.28.1) by [this](https://github.com/containers/storage/commit/306fcabc964470e4b3b87a43a8f6b7d698209ee1) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Aviv Sasson",
    "workaround": "",
    "vendorFixDate": "2021-03-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1113",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-833"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20291",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1113/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1939485",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/containers/storage/commit/306fcabc964470e4b3b87a43a8f6b7d698209ee1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/containers/storage/releases/tag/v1.28.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://unit42.paloaltonetworks.com/cve-2021-20291/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1113/default-remediation-status"
            }
        ]
    }
}