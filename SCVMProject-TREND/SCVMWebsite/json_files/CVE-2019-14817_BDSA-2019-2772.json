{
    "source": "BDSA",
    "name": "BDSA-2019-2772",
    "title": "Ghostscript Vulnerable to Arbitrary Code Execution via 'pdfexectoken()' Function",
    "description": "Ghostscript is vulnerable to arbitrary code execution and authorization bypass due to the exposure of an unsafe function. An attacker could execute arbitrary commands on the underlying operating system or access areas of the file system that are supposed to be restricted by tricking a victim into running the program using a crafted script as input.",
    "technicalDescription": "Ghostscript uses 'Safer Mode' in order to restrict the files that are accessible to the application to those that lie within a permitted path. This can be enabled using the `-dSAFER` flag at runtime. However, this functionality can potentially be overridden by the `.forceput()` function. The function `.pdfexectoken()` exposes `.forceput()` in a manner that means it can be called in a controlled manner using a crafted input file. If an attacker can trick a user into running the application using such a crafted file they could potentially bypass the `-dSAFER` flag and access files outside of permitted paths. This can also be leveraged in order to execute arbitrary commands on the underlying operating system, It should be noted that only `.pdfexectoken()` has explicitly been demonstrated to be vulnerable but related procedures could theoretically be made to exhibit the same behavior.",
    "publishedDate": "2019-09-06T14:36:01.250Z",
    "updatedDate": "2021-01-12T09:35:26.527Z",
    "disclosureDate": "2019-08-28T00:00:00.000Z",
    "solution": "Fixed in [**9.50**](https://www.ghostscript.com/download.html) by [this](http://git.ghostscript.com/?p=ghostpdl.git;a=commitdiff;h=885444fcbe10dc42787ecb76686c8ee4dd33bf33) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-08-20T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2772",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-749"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14817",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2772/ranges"
            },
            {
                "rel": "reference",
                "href": "http://git.ghostscript.com/?p=ghostpdl.git;a=commitdiff;h=885444fcbe10dc42787ecb76686c8ee4dd33bf33",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.ghostscript.com/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2019/08/28/2",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2772/default-remediation-status"
            }
        ]
    }
}