{
    "source": "BDSA",
    "name": "BDSA-2020-1929",
    "title": "Typo3 Vulnerable to Remote Code Execution (RCE) via Improper HMAC Verification",
    "description": "Typo3 is vulnerable to remote code execution due to the possibility of generating arbitrary valid checksums. A remote authenticated attacker could use this to conduct arbitrary code execution on a vulnerable server by crafting malicious serialized objects that will pass HMAC verification checks.",
    "technicalDescription": "Typo3 verifies the HMAC checksums of query parameters within various functions, including `areFieldChangeFunctionsValid()` and `render()` (of `LinkBrowserController.php`and `EditPopup.php` respectively). Hashes are generated using `GeneralUtility::hmac()`, and verified using `hash_equals()`. However, the scope in which the hashes are valid is ambiguous, such that it is possible to pass hashes within queries that will be successfully verified but are in fact invalid. This could allow an attacker to inject malicious serialized objects and other arbitrary data, potentially leading to remote code execution.",
    "publishedDate": "2020-07-31T14:18:05.520Z",
    "updatedDate": "2021-08-17T15:28:32.404Z",
    "disclosureDate": "2020-07-28T00:00:00.000Z",
    "solution": "Fixed in [**10.4.6**](https://github.com/TYPO3/TYPO3.CMS/releases/tag/v10.4.6) by [this](https://github.com/TYPO3/TYPO3.CMS/commit/85d3e70dff35a99ef53f4b561114acfa9e5c47e1) commit and [**9.5.20**](https://github.com/TYPO3/TYPO3.CMS/releases/tag/v9.5.20) by [this](https://github.com/TYPO3/TYPO3.CMS/commit/d2842eb11a338f69f79f744fa050d475d4c0fda3) commit.\n\nThe latest stable releases can be found [here](https://github.com/TYPO3/TYPO3.CMS/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Oliver Hader",
    "workaround": "",
    "vendorFixDate": "2020-07-28T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1929",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-347"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15098",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1929/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/commit/85d3e70dff35a99ef53f4b561114acfa9e5c47e1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/commit/d2842eb11a338f69f79f744fa050d475d4c0fda3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/releases/tag/v10.4.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/releases/tag/v9.5.20",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/security/advisories/GHSA-m5vr-3m74-jwxp",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1929/default-remediation-status"
            }
        ]
    }
}