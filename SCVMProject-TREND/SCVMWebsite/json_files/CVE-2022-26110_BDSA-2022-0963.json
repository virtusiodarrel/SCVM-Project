{
    "source": "BDSA",
    "name": "BDSA-2022-0963",
    "title": "HTCondor Vulnerable to Arbitrary Command Execution and Impersonation Issues via 'CLAIMTOBE' Method",
    "description": "HTCondor contains an impersonation risk vulnerability due to insufficient authentication. An attacker with READ-level access to any vulnerable daemon could exploit this issue to remotely issue READ-level commands which could allow for the impersonation of any user, daemon or administrator and the issuing of commands to any daemon.",
    "technicalDescription": "This issue exists within the `CLAIMTOBE` method, which facilitates authentication for users. In the default configuration, the method is capable of being used to execute READ-level commands.",
    "publishedDate": "2022-04-08T14:48:14.438Z",
    "updatedDate": "2022-04-08T14:48:14.426Z",
    "disclosureDate": "2022-04-05T00:00:00.000Z",
    "solution": "Fixed in:\n\n* [**8.8.16**](https://github.com/htcondor/htcondor/releases/tag/V8_8_16),\n* [**9.0.10**](https://github.com/htcondor/htcondor/releases/tag/V9_0_10) and\n* [**9.6.0**](https://github.com/htcondor/htcondor/releases/tag/V9_6_0) \n\nby [this](https://github.com/htcondor/htcondor/commit/1cae7601d796725e7f5dd73fedf37f6fbbe379ca) commit and [this](https://github.com/htcondor/htcondor/commit/8568e8ba65c9490f30a1089b6d4f8910e4bfbd6b) commit.\n\nThe latest stable releases can be found [here](https://github.com/htcondor/htcondor/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jaime Frey",
    "workaround": "The vendor has stated that the issue can be mitigated by:\n\n> not allowing the CLAIMTOBE authentication method. This means overriding the default list of authentication methods for READ authorization (which includes CLAIMTOBE by default)\n\nWindows users should add the following line to configuration files:\n\n`SEC_READ_AUTHENTICATION_METHODS = NTSSPI,IDTOKENS,KERBEROS,SCITOKENS,SSL`\n\nMacOS and Linux users should add the following line to configuration files:\n\n`SEC_READ_AUTHENTICATION_METHODS = FS,IDTOKENS,KERBEROS,SCITOKENS,SSL`\n\nUsers are also encouraged to ensure the `CLAIMTOBE` method is not referenced in any other configuration parameters.",
    "vendorFixDate": "2022-03-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0963",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-26110",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0963/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/commit/1cae7601d796725e7f5dd73fedf37f6fbbe379ca",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/commit/8568e8ba65c9490f30a1089b6d4f8910e4bfbd6b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/releases/tag/V8_8_16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/releases/tag/V9_0_10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/releases/tag/V9_6_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://research.cs.wisc.edu/htcondor/security/vulnerabilities/HTCONDOR-2022-0003.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://research.cs.wisc.edu/htcondor/security/vulnerabilities/HTCONDOR-2022-0003.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0963/default-remediation-status"
            }
        ]
    }
}