{
    "source": "BDSA",
    "name": "BDSA-2021-0507",
    "title": "Zenphoto Vulnerable to Remote Code Execution (RCE) via Arbitrary File Upload",
    "description": "Zenphoto is vulnerable to arbitrary file upload. An authenticated attacker can take advantage of this in order to upload malicious content and achieve remote code execution (RCE).",
    "technicalDescription": "This vulnerability exists due to the ability for any authenticated user to upload arbitrary files with the `elFinder` plugin, including malicious `PHP` files to the server's directory. This can be exploited by an attacker in order to achieve remote code execution (RCE).\n\nThe vendor has mitigated against this vulnerability by ensuring only users with full admin rights can upload executable files with the `elFinder` plugin.\n\n**Note:** The vendor has questioned the validity of this issue but they still implemented tighter security measures as outlined [here](https://www.zenphoto.org/news/why-not-every-security-issue-is-really-an-issue/).",
    "publishedDate": "2021-03-02T15:49:59.490Z",
    "updatedDate": "2021-03-02T15:49:59.484Z",
    "disclosureDate": "2021-02-26T00:00:00.000Z",
    "exploitPublishDate": "2021-02-10T00:00:00.000Z",
    "solution": "Fixed in [**1.5.7**](https://github.com/zenphoto/zenphoto/releases/tag/v1.5.7) by [this](https://github.com/zenphoto/zenphoto/commit/f4d71c9d71424cf321887171ccefb0708d7fd85f) commit.\n\nThe latest stable releases are available [here](https://www.zenphoto.org/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "SEC Consult Vulnerability Lab",
    "workaround": "",
    "vendorFixDate": "2020-06-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0507",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-36079",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0507/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/azizalshammari/CVE-2020-36079.",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zenphoto/zenphoto/commit/f4d71c9d71424cf321887171ccefb0708d7fd85f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zenphoto/zenphoto/issues/1292",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zenphoto/zenphoto/releases/tag/v1.5.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/161569/zenphotocms157-exec.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.zenphoto.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.zenphoto.org/news/why-not-every-security-issue-is-really-an-issue/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.zenphoto.org/news/zenphoto-1.5.7/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0507/default-remediation-status"
            }
        ]
    }
}