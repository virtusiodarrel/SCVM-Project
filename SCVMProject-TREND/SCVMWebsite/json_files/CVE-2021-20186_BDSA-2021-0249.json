{
    "source": "BDSA",
    "name": "BDSA-2021-0249",
    "title": "Moodle Vulnerable to Stored Cross-Site Scripting (XSS) Attacks via Improperly Sanitized TeX Content",
    "description": "Moodle is vulnerable to stored cross-site scripting attacks if the TeX notation filter was enabled. A remote attacker could leverage this to execute arbitrary JavaScript in the context of the victims browser. This could be used to perform site actions on their behalf, or steal site authentication data, such as cookies.",
    "technicalDescription": "A `$texexp` variable could contain user controlled input and could be used between script tags. \n\nThe issue has been resolved by sanitizing this TeX content with the `clean_param` function in `filter/tex/filter.php`.",
    "publishedDate": "2021-01-29T16:44:44.723Z",
    "updatedDate": "2021-01-29T16:44:44.713Z",
    "disclosureDate": "2021-01-25T00:00:00.000Z",
    "solution": "Fixed in: \n* **[v3.9.4](https://github.com/moodle/moodle/releases/tag/v3.9.4)** by [this](https://github.com/moodle/moodle/commit/af6e65f221b) commit.\n* **[v3.10.1](https://github.com/moodle/moodle/releases/tag/v3.10.1)** by [this](https://github.com/moodle/moodle/commit/8fa9d159bca) commit.\n* **[v3.5.16](https://github.com/moodle/moodle/releases/tag/v3.5.16)** by [this](https://github.com/moodle/moodle/commit/6c241fb61e6) commit.\n* **[v3.8.7](https://github.com/moodle/moodle/releases/tag/v3.8.7)** by [this](https://github.com/moodle/moodle/commit/f0bb4a442a0) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ata Hakcil",
    "workaround": "The vendor supplies the following workaround:\n> Disable the TeX notation filter until the patch has been applied. (Note that this filter is disabled by default.)",
    "vendorFixDate": "2021-01-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0249",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20186",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0249/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/6c241fb61e6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/8fa9d159bca",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/af6e65f221b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/f0bb4a442a0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.10.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.5.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.8.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.9.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=417170",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=417170",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0249/default-remediation-status"
            }
        ]
    }
}