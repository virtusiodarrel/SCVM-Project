{
    "source": "BDSA",
    "name": "BDSA-2019-2420",
    "title": "Magento Vulnerable to Stored Cross-Site Scripting (XSS) via Return Product Comments Field",
    "description": "Magento is vulnerable to stored cross-site scripting (XSS) due to the insufficient validation of client-provided input. A remote attacker with valid administrative credentials could execute malicious scripts within the browser of a victim by tricking them into visiting a web page containing crafted attacker-provided input data.",
    "technicalDescription": "Magento provides application management functionality via an administrative panel. Administrators can provide text-based input via a number of interfaces within this panel. Some of this input will be stored in a back-end database and then used to create web pages dynamically. This input will not be sanitized or validated prior to its insertion into the dynamically generated web page. This means that an attacker can use these input interfaces as a means to deliver XSS payloads to clients. This could potentially allow the attacker to obtain sensitive information from the web browsers of victims who visit affected pages, including session cookies.",
    "publishedDate": "2019-08-05T14:30:41.405Z",
    "updatedDate": "2020-07-15T10:41:04.666Z",
    "disclosureDate": "2019-06-25T00:00:00.000Z",
    "solution": "Fixed in version [**2.3.2**](https://github.com/magento/magento2/releases/tag/2.3.2)\nFixed in version [**2.2.9**](https://github.com/magento/magento2/releases/tag/2.2.9)\nFixed in version [**2.1.18**](https://github.com/magento/magento2/releases/tag/2.1.18)\nFixed in version [**1.9.4.2**](https://github.com/OpenMage/magento-mirror/releases/tag/1.9.4.2)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 1.7,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Max Chadwick",
    "workaround": "",
    "vendorFixDate": "2019-06-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2420",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-7940",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2420/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenMage/magento-mirror/releases/tag/1.9.4.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/magento/magento2/releases/tag/2.1.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/magento/magento2/releases/tag/2.2.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/magento/magento2/releases/tag/2.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://magento.com/security/patches/magento-2.3.2-2.2.9-and-2.1.18-security-update-23",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2420/default-remediation-status"
            }
        ]
    }
}