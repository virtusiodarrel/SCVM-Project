{
    "source": "BDSA",
    "name": "BDSA-2019-3209",
    "title": "Xen Vulnerable to Denial-of-Service (DoS) via Mishandling of 'grant-table' Transfer Requests",
    "description": "Xen is vulnerable to a logic flaw in the handling of `grant-table` transfer requests. A local attacker on a guest virtual machine could cause a memory leak, and with passed through PCI devices, may also be able to escalate their privileges, cause a denial-of-service (DoS) of the host or access data belonging to other guests.",
    "technicalDescription": "The code that handles copy-on-grant-transfer requests fails to set a bit (`PGC_allocated`) and install the associated reference on the newly allocated page. The `mfn` local variable is not updated either, leading to the wrong `MFN` being passed to `guest_physmap_add_page()`, leading to an IOMMU mapping into an unowned page.\n\nThis issue is exploitable on 64-bit x86 PV guests on hosts with physical memory greater than 16TB  and with hypervisors built with `CONFIG_BIGMEM` enabled. It is also exploitable on 32-bit x86 PV guests on hosts with physical memory greater than 168GB.\n\nThis is not exploitable from x86 HVM and PVH guests on libxl based systems. It is exploitable on xend based systems with x86 HVM guests if their guest config file has a `machine_address_size` setting.",
    "publishedDate": "2019-10-14T14:22:29.214Z",
    "updatedDate": "2019-10-14T14:22:29.196Z",
    "disclosureDate": "2019-03-05T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.10.4**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=edbc9b02ebf182590370c629bc4dbd4a935adead) commit.\n* [**4.11.2**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1028304d4244df2ee9af0ca37ee8a6f998c61d9c) commit.\n* [**4.12.0-rc5**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6d4f36c3fecc0a6a0991716199612c81d909316e) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.1,
        "impactSubscore": 8.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jan Beulich of SUSE",
    "workaround": "Running only x86 HVM/PVH guests will avoid this vulnerability. ARM systems are not vulnerable.",
    "vendorFixDate": "2019-03-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3209",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-201"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-401"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-840"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-17340",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3209/ranges"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1028304d4244df2ee9af0ca37ee8a6f998c61d9c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6d4f36c3fecc0a6a0991716199612c81d909316e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=edbc9b02ebf182590370c629bc4dbd4a935adead",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-284.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/xsa284.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3209/default-remediation-status"
            }
        ]
    }
}