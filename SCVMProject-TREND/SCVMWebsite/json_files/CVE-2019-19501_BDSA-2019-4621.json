{
    "source": "BDSA",
    "name": "BDSA-2019-4621",
    "title": "VeraCrypt Vulnerable to Privilege Escalation via VeraCrypt Expander Functionality",
    "description": "VeraCrypt is vulnerable to a local privilege escalation issue due to how the VeraCrypt Expander process operates using administrative privileges.\n\nAn attacker can abuse the issue in order to execute other attacks on the system using administrative privileges like executing arbitrary code.",
    "technicalDescription": "VeraCrypt is vulnerable to local privilege escalation issue because the VeraCrypt Expand process can open an unsanitized, user-specified URL using administrative privileges.\n\nThe `szHelpFile` and `szHelpFile2` buffers in the `src/Common/Dlgcode.c` file contain pathnames generated from where the current executable is run from.\n\nAn attacker could influence these paths and trick a victim user into requesting  a malicious resource that in turn uses the administrative privileges of the process to read and write data to the system, or possibly execute arbitrary code.",
    "publishedDate": "2020-08-25T15:57:13.377Z",
    "updatedDate": "2021-08-23T16:17:18.029Z",
    "disclosureDate": "2019-12-16T00:00:00.000Z",
    "exploitPublishDate": "2021-08-22T00:00:00.000Z",
    "solution": "Fixed in [**1.24-Update2**](https://github.com/veracrypt/VeraCrypt/releases/tag/VeraCrypt_1.24-Update2) by the following commits:\n* [Commit 1](https://github.com/veracrypt/VeraCrypt/commit/ade8e3f8cbfd1143fcd2e4bfbd6c387b8b64f732)\n* [Commit 2](https://github.com/veracrypt/VeraCrypt/commit/27d1f404f1dd187e56cbd9fa9b7d56da2fa55eb3)\n* [Commit 3](https://github.com/veracrypt/VeraCrypt/commit/4a215c2ddbb3a960c28f9f5a79e3d7ad8de77496)\n* [Commit 4](https://github.com/veracrypt/VeraCrypt/commit/07bb27e3b94ee26128d5c7f800cdcf3232ff281a)\n\nThe latest stable releases are available [here](https://github.com/veracrypt/VeraCrypt/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.4,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-12-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4621",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-73"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19501",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4621/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/veracrypt/VeraCrypt/commit/07bb27e3b94ee26128d5c7f800cdcf3232ff281a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/veracrypt/VeraCrypt/commit/1efb78266631d4c3aa0cd28e32485a9f2016f9de",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/veracrypt/VeraCrypt/commit/27d1f404f1dd187e56cbd9fa9b7d56da2fa55eb3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/veracrypt/VeraCrypt/commit/4a215c2ddbb3a960c28f9f5a79e3d7ad8de77496",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/veracrypt/VeraCrypt/commit/ade8e3f8cbfd1143fcd2e4bfbd6c387b8b64f732",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/veracrypt/VeraCrypt/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/veracrypt/VeraCrypt/releases/tag/VeraCrypt_1.24-Update2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/530292",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/530292",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.veracrypt.fr/en/Release%20Notes.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4621/default-remediation-status"
            }
        ]
    }
}