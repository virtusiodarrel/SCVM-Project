{
    "source": "BDSA",
    "name": "BDSA-2021-3635",
    "title": "Froxlor Vulnerable to SQL Injection (SQLi) via 'Custom Database Name' Feature",
    "description": "Froxlor contains a SQL injection vulnerability. This allows remote authenticated attackers with the ability to create a custom database to execute arbitrary SQL.  This can lead to an attacker gaining root privileges on Froxlor and effectively being able to execute commands on the server hosting Froxlor. The ability to execute commands on the server is intended functionality that should only be accessible to trusted users (i.e. Root/Admin).  \n\nVulnerable installations must manually enable the feature to allow custom database names.",
    "technicalDescription": "The SQL injection vulnerability is due to a lack of sanitization on the `dbname` parameter supplied to the `createDatabase` function in `lib/Froxlor/Database/Manager/DbManagerMySQL.php`.  By supplying a crafted SQL query, it is possible to create a root/admin account on the Froxlor instance.  From this account, a remote attacker can navigate to `System Settings->Webserrver Setting` and modify the `Webserver reload command` field to contain a command injection payload. Although this field is sanitized by disallowing certain characters, it is possible to download a `php` shell hosted on a remote server that can then be used to execute commands on the server with the privileges of the Froxlor instance.",
    "publishedDate": "2021-12-03T16:42:24.861Z",
    "updatedDate": "2021-12-03T16:44:12.633Z",
    "disclosureDate": "2021-11-07T00:00:00.000Z",
    "exploitPublishDate": "2021-11-07T00:00:00.000Z",
    "solution": "Fixed in version [**0.10.30**](https://github.com/Froxlor/Froxlor/releases/tag/0.10.30) by [this](https://github.com/Froxlor/Froxlor/commit/eb592340b022298f62a0a3e8450dbfbe29585782) commit.\n\nThe latest stable releases can be found [here](https://github.com/Froxlor/Froxlor/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Martin Cernac",
    "workaround": "",
    "vendorFixDate": "2021-10-11T00:00:00.000Z",
    "discoveryDate": "2021-10-11T00:00:00.000Z",
    "vendorNotifiedDate": "2021-10-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3635",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-42325",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3635/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Froxlor/Froxlor/commit/eb592340b022298f62a0a3e8450dbfbe29585782",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Froxlor/Froxlor/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Froxlor/Froxlor/releases/tag/0.10.30",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/164800/froxlor010291-sql.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/164800/froxlor010291-sql.txt",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3635/default-remediation-status"
            }
        ]
    }
}