{
    "source": "BDSA",
    "name": "BDSA-2019-2691",
    "title": "Schine MediaWiki OAuth2 Client Vulnerable to Cross-Site Request Forgery (CSRF) via OAuth2 Client in 'State' Parameter",
    "description": "It was discovered that MediaWiki is vulnerable to CSRF. An attacker could exploit this vulnerability by crafting a malicious link to trick a victim into executing malicious requests against the application",
    "technicalDescription": "The vulnerability occurs due to insufficient validation of the OAuth2 `state` parameter in the `callback` function. The software creates an unguessable `state` value and sets it in the value of the OAuth2 server, however when the callback function returns the parameter it does not validate it against the previous value. This could allow an attacker to preform cross-site request forgery (CSRF) attacks against the application",
    "publishedDate": "2019-08-28T15:27:30.688Z",
    "updatedDate": "2019-08-28T15:27:30.676Z",
    "disclosureDate": "2019-08-18T00:00:00.000Z",
    "solution": "Fixed in version [**0.4**](https://github.com/Schine/MW-OAuth2Client/releases/tag/v0.4) by [this](https://github.com/Schine/MW-OAuth2Client/commit/6a4fe4500ddd72ad4e826d9d63b2d69512bd10d1) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Justin Bull",
    "workaround": "",
    "vendorFixDate": "2019-08-17T00:00:00.000Z",
    "discoveryDate": "2019-08-17T00:00:00.000Z",
    "vendorNotifiedDate": "2019-08-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2691",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15150",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2691/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Schine/MW-OAuth2Client/commit/6a4fe4500ddd72ad4e826d9d63b2d69512bd10d1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Schine/MW-OAuth2Client/releases/tag/v0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q3/144",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2691/default-remediation-status"
            }
        ]
    }
}