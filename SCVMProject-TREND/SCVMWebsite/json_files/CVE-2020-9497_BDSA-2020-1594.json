{
    "source": "BDSA",
    "name": "BDSA-2020-1594",
    "title": "Apache Guacamole Vulnerable to Information Disclosure via Improper Input Validation in Multiple Files",
    "description": "Apache Guacamole does not properly validate input data. An attacker can exploit this vulnerability to gain information about the system.",
    "technicalDescription": "This vulnerability is due to a lack of input validation in the `guac_rdpsnd_formats_handler()` function of the `protocols\\rdp\\channels\\rdpsnd\\rdpsnd-messages.c` file. Incoming packets are wrapped by FreeRDP\u2019s `wStream` objects, however there is no enforcement that this stream object must contain the same number of bytes as declared by the packet. An attacker can connect to a malicious or compromised RDP server, send a malicious `rdpsnd` channel message, and trick Apache Guacamole into thinking the packet contains a large number of bytes. The response will therefore contain this number of bytes, which results in information disclosure of the system memory. \n\nThis vulnerability also occurs due to lack of input validation in the `guac_rdpsnd_process_receive()` function of the `protocols\\rdp\\channels\\rdpsnd\\rdpsnd.c` file. An attacker can connect to a malicious or compromised RDP server and use this to send specially crafted requests to Apache Guacamole, which will then leak information to the attacker as part of an out-of-bounds read when it responds. \n\nThis vulnerability also occurs due to a lack of input validation in the  the `guac_rdp_ai_read_format()` function of the `protocols\\rdp\\plugins\\guacai\\guacai-messages.c` file. The `guacai` channel is responsible for sound messages, particularly audio input messages. An attacker can connect to a malicious or compromised RDP server and use this to send specially crafted requests to Apache Guacamole, which will then leak information to the attacker when it responds.\n\nThe vendor has mitigated against this by adding input validation.\n\nThis can be used in a vulnerability chaining attack detailed in BDSA-2020-1659.",
    "publishedDate": "2020-07-15T14:55:05.505Z",
    "updatedDate": "2020-07-15T14:55:05.499Z",
    "disclosureDate": "2020-07-02T00:00:00.000Z",
    "exploitPublishDate": "2020-07-02T00:00:00.000Z",
    "solution": "Fixed in [**1.2.0-RC1**](https://github.com/apache/guacamole-server/releases/tag/1.2.0-RC1) by [this](https://github.com/apache/guacamole-server/commit/0bf65ce8b03f52dd60755e147fd1de7e0492e626) commit.\n\nThe latest stable releases are available [here](https://guacamole.apache.org/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Eyal Itkin",
    "workaround": "",
    "vendorFixDate": "2020-05-07T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1594",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-9497",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1594/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/guacamole-server/commit/0bf65ce8b03f52dd60755e147fd1de7e0492e626",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/guacamole-server/releases/tag/1.2.0-RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://guacamole.apache.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://research.checkpoint.com/2020/apache-guacamole-rce/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://research.checkpoint.com/2020/apache-guacamole-rce/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1594/default-remediation-status"
            }
        ]
    }
}