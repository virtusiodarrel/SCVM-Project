{
    "source": "BDSA",
    "name": "BDSA-2020-3833",
    "title": "MariaDB Vulnerable to Man-in-the-Middle (MitM) via Named Pipe Connections",
    "description": "MariaDB is vulnerable to man-in-the-middle (MitM) attacks. This could allow an attacker to gain access to information sent between the client and the server, as well as run arbitrary SQL commands through the connected user.\n\n**Note:** This vulnerability only exists when running MariaDB on Windows",
    "technicalDescription": "This vulnerability exists as the security descriptor is not set correctly when local clients connect to the server with a named pipe connection. This means that every user on the system can create a pipe server instance. An attacker could exploit this by creating an instance of a pipe server and waiting for a client to connect to it, once connected the attacker can then connect to the real pipe server instance as a client. This places the attacker in between the server and the client, and they can pass messages back and forth between the two. This allows the attacker to read and possible change the messages, as well as run arbitrary SQL commands through the connected user.",
    "publishedDate": "2020-12-18T12:42:24.424Z",
    "updatedDate": "2021-11-29T11:00:39.545Z",
    "disclosureDate": "2020-12-17T00:00:00.000Z",
    "exploitPublishDate": "2020-12-17T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/MariaDB/server/commit/3829b408d689182f05804ec045c9705da8de4e34) commit in:\n* [**10.1.48**](https://github.com/MariaDB/server/releases/tag/mariadb-10.1.48),\n* [**10.2.35**](https://github.com/MariaDB/server/releases/tag/mariadb-10.2.35),\n* [**10.3.26**](https://github.com/MariaDB/server/releases/tag/mariadb-10.3.26).\n \nFixed by [this](https://github.com/MariaDB/server/commit/e451145aa981f3442977975687087183a05cda88) commit and [this](https://github.com/MariaDB/server/commit/3829b408d689182f05804ec045c9705da8de4e34) commit in:\n* [**10.4.16**](https://github.com/MariaDB/server/releases/tag/mariadb-10.4.16),\n* [**10.5.7**](https://github.com/MariaDB/server/releases/tag/mariadb-10.5.7),\n* [**10.6.0**](https://github.com/MariaDB/server/releases/tag/mariadb-10.6.0).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-10-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3833",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28912",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3833/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MariaDB/server/commit/3829b408d689182f05804ec045c9705da8de4e34",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MariaDB/server/commit/e451145aa981f3442977975687087183a05cda88",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MariaDB/server/releases/tag/mariadb-10.1.48",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MariaDB/server/releases/tag/mariadb-10.2.35",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MariaDB/server/releases/tag/mariadb-10.3.26",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MariaDB/server/releases/tag/mariadb-10.4.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MariaDB/server/releases/tag/mariadb-10.5.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MariaDB/server/releases/tag/mariadb-10.6.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1019891",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1019891",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3833/default-remediation-status"
            }
        ]
    }
}