{
    "source": "BDSA",
    "name": "BDSA-2022-1887",
    "title": "Eclipse Jetty Vulnerable to Denial-of-Service (DoS) via Incorrect Handling of Invalid HTTP/2 Requests",
    "description": "Eclipse Jetty does not correctly handle invalid HTTP/2 requests. An attacker could exploit this flaw to exhaust the HTTP/2 flow control window or TCP congest the connection. This will cause the relevant selector threads to be blocked and it will lead to a denial-of-service (DoS).",
    "technicalDescription": "This vulnerability exists because the application incorrectly handles invalid HTTP/2 requests by writing a blocking error response directly from the selector thread. An attacker could supply crafted HTTP/2 requests and exhaust the HTTP/2 flow control window or TCP congest the connection. When the relevant selector thread subsequently tries to write the error response, it will be blocked. If all selector threads go through this process and become blocked, a denial-of-service can occur.\n\nThis was fixed in `jetty-http2/http2-server/src/main/java/org/eclipse/jetty/http2/server/HttpChannelOverHTTP2.java` file by returning the error handling code as a `Runnable` object.",
    "publishedDate": "2022-07-08T09:55:30.971Z",
    "updatedDate": "2022-08-17T15:01:23.519Z",
    "disclosureDate": "2022-07-08T00:00:00.000Z",
    "solution": "Fixed in:\n* **[9.4.47](https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.47.v20220610)** by [this](https://github.com/eclipse/jetty.project/commit/be912d4315839405a8ae601f2e4ee0306867266e) commit,\n* **[10.0.10](https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.10)** and **[11.0.10](https://github.com/eclipse/jetty.project/releases/tag/jetty-11.0.10)** by [this](https://github.com/eclipse/jetty.project/commit/b705091afb9158b39590fa36b9b84795524a8f0b) commit.\n\n\nThe latest stable releases can be found [here](https://github.com/eclipse/jetty.project/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "bjorncs, hakonhall",
    "workaround": "The vendor recommends users to filter the requests before they are sent to Jetty. One way to filter them would be to use a proxy.",
    "vendorFixDate": "2022-05-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1887",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-410"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-664"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-2048",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1887/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/commit/b705091afb9158b39590fa36b9b84795524a8f0b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/commit/be912d4315839405a8ae601f2e4ee0306867266e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-11.0.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.47.v20220610",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/security/advisories/GHSA-wgmr-mf83-7x4j",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/security/advisories/GHSA-wgmr-mf83-7x4j",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1887/default-remediation-status"
            }
        ]
    }
}