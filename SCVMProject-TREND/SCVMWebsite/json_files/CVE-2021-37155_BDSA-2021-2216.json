{
    "source": "BDSA",
    "name": "BDSA-2021-2216",
    "title": "wolfSSL Vulnerable to Improper Certificate Verification via Flawed OCSP Serial Number Check",
    "description": "wolfSSL is vulnerable to a certificate verification issue due to how the verification of OCSP serial numbers is flawed.\n\nThis issue could allow the verification of OCSP requests with serial numbers that are different from the OCSP response to succeed which could in turn enable authentication bypass style attacks.",
    "technicalDescription": "wolfSSL is vulnerable to improper certificate verification because the `CompareOcspReqResp()` function in the `wolfcrypt/src/asn.c` file does not correctly verify the serial number in an OCSP request. In the case where the serial number in a request differs from the serial number in the OCSP response, the resulting comparison error does not cause verification to fail.",
    "publishedDate": "2021-07-28T13:21:03.023Z",
    "updatedDate": "2021-08-12T12:31:48.780Z",
    "disclosureDate": "2021-04-28T00:00:00.000Z",
    "solution": "Fixed in [**4.8.0**](https://github.com/wolfSSL/wolfssl/releases/tag/v4.8.0-stable) by [this](https://github.com/wolfSSL/wolfssl/commit/385e0bedaac935a1fc86766fbb2fcc47c9b82386) commit.\n\nThe latest stable releases are available [here](https://github.com/wolfSSL/wolfssl/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rainer, Roee, Barak, Hila and Shoshi (from Cymotive and CARIAD)",
    "workaround": "",
    "vendorFixDate": "2021-04-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2216",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-295"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-37155",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2216/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wolfSSL/wolfssl/commit/385e0bedaac935a1fc86766fbb2fcc47c9b82386",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wolfSSL/wolfssl/pull/3990",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wolfSSL/wolfssl/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wolfSSL/wolfssl/releases/tag/v4.8.0-stable",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wolfSSL/wolfssl/releases/tag/v4.8.0-stable",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2216/default-remediation-status"
            }
        ]
    }
}