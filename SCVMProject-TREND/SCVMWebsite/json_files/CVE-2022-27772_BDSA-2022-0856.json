{
    "source": "BDSA",
    "name": "BDSA-2022-0856",
    "title": "Spring Boot Vulnerable to Privilege Escalation via Race Condition During Temporary Directory Creation",
    "description": "Spring Boot is vulnerable to privilege escalation due to a race condition which occurs during the creation of a temporary directory. A local attacker could create their own temporary directory by racing against Spring Boot and supply their own configuration files which would allow for the full takeover of the application.",
    "technicalDescription": "This vulnerability exists in the `createTempDir` method of the `AbstractConfigurableWebServerFactory` class. The method finds the system's general temporary file directory by creating a temporary file (via `File.createTempFile`) and immediately deleting it. This is where it then creates a new temporary directory. However, a local attacker could notice the temporary file being created, and create their own temporary directory in that location just before Spring Boot does. Spring Boot will then quietly fail to make its legitimate temporary directory and accept the one created by the attacker.\n\nThis vulnerability impacts Unix-like systems, and very old versions of Mac OSX and Windows as they all share the system temporary directory between all users.",
    "publishedDate": "2022-04-01T16:23:13.198Z",
    "updatedDate": "2022-05-31T10:23:29.630Z",
    "disclosureDate": "2022-02-16T00:00:00.000Z",
    "solution": "Fixed in [**2.2.11**](https://github.com/spring-projects/spring-boot/releases/tag/v2.2.11.RELEASE) by [this](https://github.com/spring-projects/spring-boot/commit/667ccdae84822072f9ea1a27ed5c77964c71002d) commit.\n\nThe latest stable releases can be found [here](https://github.com/spring-projects/spring-boot/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.1,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "trungPa, JLLeitschuh (GitHub)",
    "workaround": "According to the [Github Security Advisory](https://github.com/JLLeitschuh/security-research/security/advisories/GHSA-cm59-pr5q-cw85), setting the `java.io.tmpdir` system environment variable to a directory that is exclusively owned by the executing user will fix this vulnerability for all operating systems.",
    "vendorFixDate": "2020-10-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0856",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-379"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-27772",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0856/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/JLLeitschuh/security-research/security/advisories/GHSA-cm59-pr5q-cw85",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/JLLeitschuh/security-research/security/advisories/GHSA-cm59-pr5q-cw85",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/github/codeql/pull/4473#issuecomment-1030416237",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-boot/commit/667ccdae84822072f9ea1a27ed5c77964c71002d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-boot/commit/b1c689b9b26c5f70f9b97d75ff2f1fbfc59e2c02",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-boot/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-boot/releases/tag/v2.2.11.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0856/default-remediation-status"
            }
        ]
    }
}