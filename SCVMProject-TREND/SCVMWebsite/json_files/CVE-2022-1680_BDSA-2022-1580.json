{
    "source": "BDSA",
    "name": "BDSA-2022-1580",
    "title": "Gitlab Vulnerable to Account Takeover via SCIM Email Change",
    "description": "Gitlab contains a vulnerability in its SCIM feature when group SAML SSO has been configured. This vulnerability will allow an attacker having Premium group owner privileges to send invites to arbitrary users and then change their email addresses. Exploitation of this vulnerability can lead to an account takeover.\n\n**Note** This vulnerability can only be exploited in the absence of 2-factor authentication.",
    "technicalDescription": "This vulnerability exists because of a flaw in the SCIM feature (only available for Premium+ subscriptions) for group SAML SSO. Exploiting this vulnerability will require an attacker to have the privileges of the owner of a Premium group. With these privileges, the attacker can invite arbitrary application users through their email addresses and usernames and then change their email addresses via SCIM. In the absence of 2-factor authentication, an attacker-controlled email address can result in an account takeover. The attacker can also use this flaw to change the targeted account's username and display name.\n\nThe vendor has mitigated this vulnerability by disallowing user attribute modifications when updating SCIM provisioned users.",
    "publishedDate": "2022-06-07T11:51:21.954Z",
    "updatedDate": "2022-06-07T11:55:26.307Z",
    "disclosureDate": "2022-06-03T00:00:00.000Z",
    "solution": "Fixed in:\n* **[14.9.5](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.9.5)** by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/9d5aca002edb2e0ab3c7d5b6eb00ea781d3dde9f) commit,\n* **[14.10.4](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.10.4)** by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/ae4eb58668513f38c0daf1dc3b977c6b22a9a476) commit,\n* **[15.0.1](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v15.0.1)** by [this](https://gitlab.com/gitlab-org/gitlab/-/commit/660a0021e3df45893c1f4317d3aa86dd276c6071) commit.\n\nThe latest stable releases can be found [here](https://gitlab.com/gitlab-org/gitlab-foss/-/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "GitLab team",
    "workaround": "",
    "vendorFixDate": "2022-06-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1580",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-308"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-1680",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1580/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2022/06/01/critical-security-release-gitlab-15-0-1-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.10.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v14.9.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v15.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/660a0021e3df45893c1f4317d3aa86dd276c6071",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/9d5aca002edb2e0ab3c7d5b6eb00ea781d3dde9f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab/-/commit/ae4eb58668513f38c0daf1dc3b977c6b22a9a476",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1580/default-remediation-status"
            }
        ]
    }
}