{
    "source": "BDSA",
    "name": "BDSA-2022-1515",
    "title": "DNN Content Management System (CMS) Vulnerable to Server Side Request Forgery (SSRF) via Profile Image Upload Functionality",
    "description": "DNN content management system (CMS) is vulnerable to server side request forgery (SSRF) due to insufficient URL validation in the profile image upload functionality. An attacker could use this flaw to make requests to the internal network of the DNN host and compromise the network's integrity or disclose confidential data residing on the network.",
    "technicalDescription": "The vulnerability exists in the function `UploadFromUrl`, file `FileUploadController.cs` due to only verifying the initial URL to contain an image extension. However, an attacker could setup a remote endpoint that contains an image extension, but once accessed redirects to an arbitrary target.",
    "publishedDate": "2022-06-01T11:17:52.793Z",
    "updatedDate": "2022-09-30T13:20:36.948Z",
    "disclosureDate": "2022-05-26T00:00:00.000Z",
    "exploitPublishDate": "2022-05-26T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:POC/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 3.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N/E:P/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "AppCheck",
    "workaround": "The credited researcher suggests the following mitigations:\n> If possible disabling image uploads for all users other than trusted to prevent the vulnerability being exploited. If this isn\u2019t possible, a defense in depth approach could help mitigate the impact of exploitation.\n> \n> Limit the HTTP services that can be accessed from the DNN server via the firewall, this includes any local HTTP services such as local management interfaces and any locally accessible hosts.\n> \n> If hosting in the Cloud, ensure that cloud metadata services cannot be accessed from the affected DNN host. This can prevent a particularly powerful attack whereby the attacker is able to extract sensitive authentication tokens and other configuration information.",
    "vendorNotifiedDate": "2021-08-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1515",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-40186",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1515/ranges"
            },
            {
                "rel": "reference",
                "href": "https://appcheck-ng.com/dnn-cms-server-side-request-forgery-cve-2021-40186",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://appcheck-ng.com/dnn-cms-server-side-request-forgery-cve-2021-40186",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://appcheck-ng.com/dnn-cms-server-side-request-forgery-cve-2021-40186",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1515/default-remediation-status"
            }
        ]
    }
}