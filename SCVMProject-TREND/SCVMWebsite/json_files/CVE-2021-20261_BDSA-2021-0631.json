{
    "source": "BDSA",
    "name": "BDSA-2021-0631",
    "title": "Linux Kernel Vulnerable to Memory Corruption via Race Condition in Floppy Disk Drive Controller",
    "description": "The Linux kernel's implementation of the floppy disk drive controller contains a race condition flaw. A local attacker with privileges to access the device could cause memory corruption that may lead to privilege escalation, or a denial-of-service (DoS) of the host system.",
    "technicalDescription": "The floppy disk driver, defined in file `drivers/block/floppy.c`, fails to check if the return value of function `lock_fdc()` in function `floppy_revalidate()`. `lock_fdc()` could actually fail if it is interrupted, in which case `floppy_revalidate()` will proceed to operate on critical sections of code as though it had obtained the lock. This can result in severe memory corruption that may be controllable by an attacker through concurrent access to the device. In the (non-default) cases where the floppy disk drive device file is accessible to unprivileged users, privilege escalation cannot be ruled out. The most likely outcome of such memory corruption is a DoS of the host system, however.",
    "publishedDate": "2021-03-12T10:40:26.123Z",
    "updatedDate": "2022-02-22T09:56:47.914Z",
    "disclosureDate": "2021-02-24T00:00:00.000Z",
    "solution": "Fixed in version [**4.5-rc5**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a0c80efe5956ccce9fe7ae5c78542578c07bc20a) commit, and in [**4.4.262**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b93c6b400ed51e526e724b430a115293fd147466) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:L/AC:L/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.7,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jay Shin (Red Hat Engineering)",
    "workaround": "If the floppy disk driver is not required for the system, the module loading may be disabled through a modprobe configuration. Disabling the floppy in the BIOS or virtual machine configuration and restarting the system will also ensure that the floppy hardware will not autoload the kernel floppy module.",
    "vendorFixDate": "2016-02-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0631",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-413"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20261",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0631/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1932150",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1932150",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a0c80efe5956ccce9fe7ae5c78542578c07bc20a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b93c6b400ed51e526e724b430a115293fd147466",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0631/default-remediation-status"
            }
        ]
    }
}