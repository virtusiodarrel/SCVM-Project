{
    "source": "BDSA",
    "name": "BDSA-2021-3986",
    "title": "Xen Vulnerable to Denial-of-Service (DoS) via Insufficient 'netback' Driver Buffer Limits for UDP Connections",
    "description": "It was found that a Xen guest could exploit the Linux kernel's `netback` driver to cause an out of memory situation in the domain the backend is running in. This would cause a denial-of-service (DoS) condition.",
    "technicalDescription": "Incoming data packets for a guest in the Linux kernel's `netback` driver are buffered until the guest is ready to process them. In order to prevent too much data piling up, a timeout has been introduced that specifies how long the client side of an interface can consume new packets before it stalls. However, the timeout is rather long (60 seconds by default). During this time a fast UDP connection could still be used to accumulate large amounts of data and exhaust the available memory.",
    "publishedDate": "2022-01-12T14:54:40.889Z",
    "updatedDate": "2022-01-12T14:54:40.873Z",
    "disclosureDate": "2021-12-20T00:00:00.000Z",
    "solution": "Fixed in the Linux kernel:\n* [**4.4.296**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0928efb09178e01d3dc8e8849aa1c807436c3c37) commit\n* [**4.9.294**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b4226b387436315e7f57465c15335f4f4b5b075d) commit\n* [**4.14.259**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9bebb2eedf679b3be4acaa20efda97f32c999d74) commit\n* [**4.19.222**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c9f17e92917fd5786be872626a3928979ecc4c39) commit\n* [**5.4.168**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0d99b3c6bd39a0a023e972d8f912fd47698bbbb8) commit\n* [**5.10.88**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=88f20cccbeec9a5e83621df5cc2453b5081454dc) commit\n* [**5.15.11**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bd926d189210cd1d5b4e618e45898053be6b4b3b) commit\n* [**5.16-rc7**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=be81992f9086b230623ae3ebbc85ecee4d00a3d3) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "J\u00fcrgen Gro\u00df",
    "workaround": "The vulnerability can be prevented by using another PV network backend (e.g. the qemu based `qnic` backend). Alternatively, using dedicated network driver domain per guest will mitigate the problem.",
    "vendorFixDate": "2021-12-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-3986",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-28715",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-3986/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0928efb09178e01d3dc8e8849aa1c807436c3c37",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0d99b3c6bd39a0a023e972d8f912fd47698bbbb8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=88f20cccbeec9a5e83621df5cc2453b5081454dc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9bebb2eedf679b3be4acaa20efda97f32c999d74",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b4226b387436315e7f57465c15335f4f4b5b075d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bd926d189210cd1d5b4e618e45898053be6b4b3b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=be81992f9086b230623ae3ebbc85ecee4d00a3d3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c9f17e92917fd5786be872626a3928979ecc4c39",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f48da8b14d04ca87ffcffe68829afd45f926ec6a",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-392.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-392.txt",
                "label": "WORKAROUND"
            }
        ]
    }
}