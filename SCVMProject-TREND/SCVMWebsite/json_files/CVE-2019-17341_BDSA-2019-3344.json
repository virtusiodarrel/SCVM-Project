{
    "source": "BDSA",
    "name": "BDSA-2019-3344",
    "title": "Xen Vulnerable to Privilege Escalation via Race Condition in 'arch_iommu_populate_page_table' Function",
    "description": "Xen is vulnerable to privilege escalation due to the improper management of system memory resources. A local attacker could escalate their privileges to that of the hypervisor by causing a device to be assigned to a guest after a domain creation event. Only x86 PV guests are vulnerable.",
    "technicalDescription": "The function `arch_iommu_populate_page_table()`, which is defined within the file `iommu.c`, contains code that manages the construction of page tables whenever passed-through PCI devices are added to a domain. If the device is added to the domain following the construction of that domain, the code may have to dynamically reconstruct page tables. These page tables contain information on the permissions that are assigned to each page. The dynamic reconstruction of page tables is controlled using mappings. If the computations that are involved in this process occur in a particular order, mappings may occur which allow arbitrary access to these page tables. \n\nA local attacker could escalate their privileges to that of the hypervisor by causing a device to be assigned to a guest after a domain creation event in a manner which exploits that aforementioned race condition. Only x86 PV guests are vulnerable.",
    "publishedDate": "2019-10-29T17:06:08.489Z",
    "updatedDate": "2020-07-29T13:18:06.792Z",
    "disclosureDate": "2019-03-05T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**4.12.0-rc5**](https://xenbits.xenproject.org/gitweb/?p=xen.git;a=tag;h=refs/tags/4.12.0-rc5) by [this](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1f0b0bb7773d537bcf169e021495d0986d9809fc) commit.\n* [**4.11.2**](https://xenproject.org/downloads/xen-project-archives/xen-project-4-11-series/xen-project-4-11-2/) by [this](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=4f785ea01cf2e689e66f993bfa2e0c86a5d6b2d3) commit.\n* [**4.10.4**](https://xenproject.org/downloads/xen-project-archives/xen-project-4-10-series/xen-project-4-10-4/) by [this](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=382e4a62da06980c3291c9880ccfef2d2135d243) commit.\n\nThe latest stable releases can be found [here](https://xenproject.org/downloads/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.9,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.4,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:L/AC:M/Au:N/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.4,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jan Beulich of SUSE",
    "workaround": "The vendor advises that users can avoid the vulnerability by running only HVM or PVH guests. The vendor states that assigning passed-through PCI devices to PV guests at domain creation time will also mitigate the vulnerability.",
    "vendorFixDate": "2019-03-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3344",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-17341",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3344/ranges"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1f0b0bb7773d537bcf169e021495d0986d9809fc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=382e4a62da06980c3291c9880ccfef2d2135d243",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=4f785ea01cf2e689e66f993bfa2e0c86a5d6b2d3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-285.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/gitweb/?p=xen.git;a=tag;h=refs/tags/4.12.0-rc5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/xen-project-archives/xen-project-4-10-series/xen-project-4-10-4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/xen-project-archives/xen-project-4-11-series/xen-project-4-11-2/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3344/default-remediation-status"
            }
        ]
    }
}