{
    "source": "BDSA",
    "name": "BDSA-2022-2405",
    "title": "Linux Kernel Vulnerable to Memory Corruption via Unauthorized Memory Access with KVM Instruction Emulation",
    "description": "The Linux kernel is vulnerable to memory corruption due to the improper handling of Kernel-based Virtual Machine (KVM) instruction emulation when `KVM_VCPU_PREEMPTED` is set, which can lead to unintended memory access operations and potentially privilege escalation. This could allow an attacker within a guest to compromise the guest kernel.",
    "technicalDescription": "The `KVM_VCPU_PREEMPTED` flag, if set, can stop the VCPUs that are associated with a KVM guest from sending TLB flush requests. This can lead to the existence of stale translations within the TLB, even though the guest kernel may believe that all stale translations have been flushed. KVM instruction emulation is able to run whenever the  `KVM_VCPU_PREEMPTED` flag has been set, and so is able to access the stale translations. This could allow for malicious memory access operations to be performed, which could be leveraged within a KVM guest in order to compromise the guest kernel and achieve privilege escalation.",
    "publishedDate": "2022-08-31T15:39:42.839Z",
    "updatedDate": "2022-09-14T12:38:36.142Z",
    "disclosureDate": "2022-08-29T00:00:00.000Z",
    "exploitPublishDate": "2022-08-29T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.15.60**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=92343314d34e04da0923cefd3be67521d706fa35) commit,\n* [**5.18.17**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=719492d2bc3b99c067076bddc62e63cda8ad16e2) commit,\n* [**5.19-rc2**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6cd88243c7e03845a450795e134b488fc2afb736) commit.\n\nThe latest stable releases are available [here](https://www.kernel.org).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Jann Horn (Google Security Research)",
    "workaround": "",
    "vendorFixDate": "2022-06-08T00:00:00.000Z",
    "vendorNotifiedDate": "2022-05-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2405",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-39189",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2405/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=2309",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=2309",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6cd88243c7e03845a450795e134b488fc2afb736",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=719492d2bc3b99c067076bddc62e63cda8ad16e2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=92343314d34e04da0923cefd3be67521d706fa35",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2405/default-remediation-status"
            }
        ]
    }
}