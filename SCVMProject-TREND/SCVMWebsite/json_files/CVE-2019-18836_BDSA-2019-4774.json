{
    "source": "BDSA",
    "name": "BDSA-2019-4774",
    "title": "Envoy Vulnerable to Denial-of-Service (DoS) via Excessive CPU Consumption",
    "description": "Envoy is vulnerable to a denial-of-service (DoS) condition due to an infinite loop being triggered.\n\nAn attacker could trigger this issue in order to exhaust CPU resources which can impact the system's availability to legitimate users and their requests.\n\n**Note:** This vulnerability only affects systems where listeners are configured with `continue_on_listener_filters_timeout` as true.",
    "technicalDescription": "This vulnerability exists due to the `continue_on_listener_filters_timeout` option. If this is configured, Envoy may register two sets of interested socket events when going through listener filter chain and network filter chain. This will put the worker thread in an infinite busy loop. An attacker can exploit this by maintaining 1 idle connection in order to consume CPU resources, and trigger a denial-of-service (DoS).",
    "publishedDate": "2020-10-22T09:32:14.868Z",
    "updatedDate": "2020-10-22T09:32:14.862Z",
    "disclosureDate": "2019-11-09T00:00:00.000Z",
    "exploitPublishDate": "2019-11-09T00:00:00.000Z",
    "solution": "Fixed in [**1.12.1**](https://github.com/envoyproxy/envoy/releases/tag/v1.12.1) by [this](https://github.com/envoyproxy/envoy/commit/0cd355a376734e65f37fb906115535195bb33109) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Yuchen Dai, Google",
    "workaround": "Set `continueOnListenerFiltersTimeout` to false.",
    "vendorFixDate": "2019-11-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4774",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-834"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-18836",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4774/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/0cd355a376734e65f37fb906115535195bb33109",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.12.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-3xvf-4396-cj46",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-3xvf-4396-cj46",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-3xvf-4396-cj46",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4774/default-remediation-status"
            }
        ]
    }
}