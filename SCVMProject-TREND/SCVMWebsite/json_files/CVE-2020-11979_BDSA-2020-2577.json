{
    "source": "BDSA",
    "name": "BDSA-2020-2577",
    "title": "Apache Ant Vulnerable to Information Disclosure via Insecure Temporary File Directory",
    "description": "Apache Ant is vulnerable to information disclosure due to the usage of a default temporary directory for several tasks. Some tasks may also allow the integrity of a build to be damaged.",
    "technicalDescription": "As mitigation for CVE-2020-1945 Apache Ant **1.10.8** altered the permissions of any temporary files it created so that only the current user was permitted to access them. Unfortunately the `fixcrlf` task deleted the temporary file and created a new one without said protection. This would still allow an attacker to inject modified source files into the build process.\nThis was mitigated by a adding a fallback to a separate owner-only `tempdir` where possible and by documenting why the file is removed before writing.",
    "publishedDate": "2020-10-01T10:58:16.608Z",
    "updatedDate": "2021-02-17T14:46:44.120Z",
    "disclosureDate": "2020-09-30T00:00:00.000Z",
    "solution": "Fixed in [**ANT_1.10.9_RC1**](https://github.com/apache/ant/releases/tag/ANT_1.10.9_RC1) by [this](https://github.com/apache/ant/commit/87ac51d3c22bcf7cfd0dc07cb0bd04a496e0d428) commit and [this](http://link-to-the-commit.com) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mike Salvatore of the Ubuntu Security Team",
    "workaround": "**Note:** Per the vendor, The best mitigation still is to make Ant use a directory that is only readable and writable by the current user.\n\nThe official mitigation for versions from **1.1** to **1.9.14** and **1.10.0** to **1.10.7** is setting the `java.io.tmpdir` system property to point to a directory only readable and writable by the current user prior to running Ant.\n\nVersions **1.9.15** and **1.10.8** can be trusted to use the Ant property `ant.tmpfile`, but the vendor still highly recommends using a safer private temporary directory instead.\n\nAnt **1.10.9** will also try to create a temporary directory only accessible by the current user if neither of the properties above is set but may fail to create one if the underlying filesystem doesn't allow it.\n\nExplicitly setting up a directory to use and set the respective property is the only mitigation that will work on every platform.",
    "vendorFixDate": "2020-08-11T00:00:00.000Z",
    "vendorNotifiedDate": "2020-06-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2577",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-829"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11979",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2577/ranges"
            },
            {
                "rel": "reference",
                "href": "https://ant.apache.org/security.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ant.apache.org/security.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ant/commit/87ac51d3c22bcf7cfd0dc07cb0bd04a496e0d428",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ant/commit/f7159e8a084a3fcb76b933d393df1fc855d74d78",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ant/releases/tag/ANT_1.10.9_RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q3/209",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q3/209",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2577/default-remediation-status"
            }
        ]
    }
}