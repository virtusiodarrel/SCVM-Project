{
    "source": "BDSA",
    "name": "BDSA-2020-2245",
    "title": "WSO2 Carbon-Kernel Vulnerable to Reflected Cross-Site Scripting (XSS) via 'Try it' Tool Functionality",
    "description": "WSO2 Carbon-Kernel contains a reflected cross-site scripting (XSS) vulnerability due to the insufficient validation of user-controlled data. Attackers could craft a malicious URL that could execute arbitrary JavaScript code in a victim's browser, allowing the attacker to steal cookie based session tokens or credentials.",
    "technicalDescription": "This vulnerability occurs due to the insufficient validation of user-controlled data within the SOAP service `Try it` tool. Attackers could exploit this by crafting requests to the `Try it` tool that contain a malicious JavaScript payload, resulting in a request containing valid Carbon Management session cookies being sent to an attacker-controlled host. The vendor has addressed this by encoding the HTML to prevent content within the URI from being executed, and by disabling the sending of session data as the part of the request.",
    "publishedDate": "2020-09-04T14:58:12.947Z",
    "updatedDate": "2021-08-10T09:10:26.538Z",
    "disclosureDate": "2020-08-17T00:00:00.000Z",
    "solution": "Fixed in the in the **4.5.x** branch of Carbon-Kernel by [this](https://github.com/wso2/carbon-kernel/commit/1d4b7f18d2521f23bcebcea274bfee8803a456b8) commit.\n\nFixed in Carbon-Kernel version [**v4.6.1-m4**](https://github.com/wso2/carbon-kernel/releases/tag/v4.6.1-m4) by [this](https://github.com/wso2/carbon-kernel/commit/d613b9ec7227adc06a045dff88a67ea4a81245b0) commit.\n\nThe latest releases are available [here](https://github.com/wso2/carbon-kernel/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-04-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2245",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-24704",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2245/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2020-0685",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/carbon-kernel/commit/1d4b7f18d2521f23bcebcea274bfee8803a456b8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/carbon-kernel/commit/d613b9ec7227adc06a045dff88a67ea4a81245b0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/carbon-kernel/releases/tag/v4.6.1-m4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wso2/carbon-kernel/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2245/default-remediation-status"
            }
        ]
    }
}