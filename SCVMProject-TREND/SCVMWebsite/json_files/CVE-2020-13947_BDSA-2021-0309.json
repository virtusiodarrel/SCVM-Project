{
    "source": "BDSA",
    "name": "BDSA-2021-0309",
    "title": "Apache ActiveMQ Vulnerable to Cross-Site Scripting (XSS) in Web Console Functionality",
    "description": "Apache ActiveMQ contains a cross site scripting (XSS) vulnerability due to lack of sanitization of user-supplied input. An attacker can then exploit this by executing malicious scripts in the context of the browser, allowing the theft of session tokens, cookies and sensitive information.",
    "technicalDescription": "This vulnerability exists in the `activemq-web-console/src/main/webapp/message.jsp` file. Attackers could exploit the administration console functionality by injecting malicious scripts which can then be executed when rendered in the victim's browser. The vendor addressed this by implementing encoding on the copy and move message URLs.",
    "publishedDate": "2021-02-09T11:59:25.513Z",
    "updatedDate": "2021-07-05T13:32:32.156Z",
    "disclosureDate": "2021-02-08T00:00:00.000Z",
    "solution": "Fixed in [**5.16.1**](https://github.com/apache/activemq/releases/tag/activemq-5.16.1) by [this](https://github.com/apache/activemq/commit/177eb71c52069712bcc9fe14c70e079cc2671a80) commit. \n\nFixed in [**5.15.14**](https://github.com/apache/activemq/releases/tag/activemq-5.15.14) by [this](https://github.com/apache/activemq/commit/032a9446adc21e6790b891e44af463a9ba165b3e) commit.\n\nThe latest stable releases are available [here](https://activemq.apache.org/components/classic/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "qiang qiang",
    "workaround": "",
    "vendorFixDate": "2020-09-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0309",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13947",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0309/ranges"
            },
            {
                "rel": "reference",
                "href": "http://activemq.apache.org/security-advisories.data/CVE-2020-13947-announcement.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://activemq.apache.org/components/classic/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/activemq/commit/032a9446adc21e6790b891e44af463a9ba165b3e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/activemq/commit/177eb71c52069712bcc9fe14c70e079cc2671a80",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/activemq/releases/tag/activemq-5.15.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/activemq/releases/tag/activemq-5.16.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0309/default-remediation-status"
            }
        ]
    }
}