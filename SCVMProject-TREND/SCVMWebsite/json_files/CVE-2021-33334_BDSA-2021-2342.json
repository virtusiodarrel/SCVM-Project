{
    "source": "BDSA",
    "name": "BDSA-2021-2342",
    "title": "Liferay Portal Vulnerable to Authorization Bypass via Missing Permissions Checks in Dynamic Data Mapping Module",
    "description": "Liferay Portal is vulnerable to the unauthorized accessing of resources due to insufficient permissions checks in the Dynamic Data Mapping module. A remote attacker with the `Access in Site Administration` permission can view all forms, and form entries, via the site's forms section.",
    "technicalDescription": "The dynamic data mapping module within Liferay Portal is implemented using code and configuration scripts that are contained under the `modules/apps/dynamic-data-mapping/` directory. This includes code that manages the data access permissions that users have, and which determines whether or not they are authorized to view certain resources. Some of the code and configuration settings are incorrect, such that certain users may view resources that they are not authorized to view. \n\nFor example, the `updateFormInstancePermission()` function (of file `PublishFormInstanceMVCActionCommand.java`) retrieves, and performs processing on, a `ResourcePermission` object which describes a particular user's permissions. The object is obtained by calling `_resourcePermissionLocalService.getResourcePermission()`. `updateFormInstancePermission()` does not contain code for correctly handling cases where no object (i.e. a null reference) is returned by `getResourcePermission()`. \n\nAn example of an erroneous configuration file is `default.xml`. Within this file, the value of the `action-key` node which lies under the `guest-defaults` node is `VIEW`. This corresponds to an unsafe default configuration.\n\nAs a result of these issues, a remote attacker with the `Access in Site Administration` permission can view all forms and form entries via the site's forms section, even when they are unauthorized to do so.",
    "publishedDate": "2021-08-05T15:49:06.184Z",
    "updatedDate": "2021-09-08T12:49:38.341Z",
    "disclosureDate": "2021-05-10T00:00:00.000Z",
    "solution": "Fixed in [**7.3.3-ga4**](https://github.com/liferay/liferay-portal/releases/tag/7.3.3-ga4).\n\nA cumulative patch for version **7.2.1** can be found [here](https://github.com/community-security-team/liferay-portal/compare/7.2.1-ga2...7.2.1-cumulative.patch). This cumulative patch has not yet been included in any release.\n\nThe latest stable releases are available [here](https://github.com/liferay/liferay-portal/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-05-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2342",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-280"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33334",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2342/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/community-security-team/liferay-portal/compare/7.2.1-ga2...7.2.1-cumulative.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/liferay/liferay-portal/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/liferay/liferay-portal/releases/tag/7.3.3-ga4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.liferay.com/browse/LPE-17039",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/id/120748332",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2342/default-remediation-status"
            }
        ]
    }
}