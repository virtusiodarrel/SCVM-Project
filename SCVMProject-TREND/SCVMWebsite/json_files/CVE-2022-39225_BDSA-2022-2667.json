{
    "source": "BDSA",
    "name": "BDSA-2022-2667",
    "title": "Parse Server Vulnerable to Unauthorized Manipulation of Session Object Properties via Known Object ID",
    "description": "Parse Server is vulnerable to an unauthorized session object properties editing issue due to a lack of sufficient authorization checks.\n\nThis issue could be abused by a foreign user in order to tamper with the session objects of another user if the object ID is known. This could enable the foreign user to assign the session object to themselves.\n\n**Note**: The vendor has stated in their [advisory](https://github.com/parse-community/parse-server/security/advisories/GHSA-6w4q-23cf-j9jp) that by default, assigning a session to a foreign user does not usually change the privileges of either of the two users. If custom logic is used to relate specific session objects to privileges this vulnerability may have a higher level of severity.",
    "technicalDescription": "This issue exists due to how Parse Server does not validate if a request to edit a session object has come from it's owner. A foreign user with knowledge of an object ID could abuse this flaw manipulate to the session object of another user. For example, the foreign user could assign the session object to their own user, through writing to the `user` field, which could enable them to read any custom fields associated with the session object. To gain knowledge of a session object ID, the attacker could attempt to brute-force guess the ID, however, they will not know which user a successfully guessed session object ID belongs to.\n\nTo remedy this issue, the vendor has updated the `RestWrite.prototype.handleSession` function of the `src/RestWrite.js` file to prevent all writes to foreign session objects even in cases where the session object ID is known.",
    "publishedDate": "2022-09-23T16:33:05.230Z",
    "updatedDate": "2022-09-26T11:23:54.983Z",
    "disclosureDate": "2022-09-20T00:00:00.000Z",
    "solution": "Fixed in:\n* **[4.10.15](https://github.com/parse-community/parse-server/releases/tag/4.10.15)** by [this](https://github.com/parse-community/parse-server/commit/7ca9ed01) commit,\n* **[5.2.6](https://github.com/parse-community/parse-server/releases/tag/5.2.6)** by [this](https://github.com/parse-community/parse-server/commit/6d0b2f53) commit,\n* the **beta** branch by [this](https://github.com/parse-community/parse-server/commit/83cdc89b) commit,\n* the **alpha** branch by [this](https://github.com/parse-community/parse-server/commit/37fed306) commit.\n\nThe latest stable releases are available [here](https://github.com/parse-community/parse-server/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has suggested [here](https://github.com/parse-community/parse-server/security/advisories/GHSA-6w4q-23cf-j9jp) that users can choose to add a `beforeSave` trigger to the `_Session` class and prevent writing if the requesting user is different from the user in the session object.",
    "vendorFixDate": "2022-09-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2667",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-39225",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2667/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/37fed306",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/6d0b2f53",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/7ca9ed01",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/83cdc89b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/pull/8183",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases/tag/4.10.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases/tag/5.2.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/security/advisories/GHSA-6w4q-23cf-j9jp",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/security/advisories/GHSA-6w4q-23cf-j9jp",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2667/default-remediation-status"
            }
        ]
    }
}