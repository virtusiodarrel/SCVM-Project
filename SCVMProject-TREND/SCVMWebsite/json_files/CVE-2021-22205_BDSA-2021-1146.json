{
    "source": "BDSA",
    "name": "BDSA-2021-1146",
    "title": "Gitlab Vulnerable to Remote Code Execution (RCE) via Improper Validation of Image Files",
    "description": "Gitlab is vulnerable to remote code execution (RCE) via improper validation of image files. An authenticated attacker could exploit this via uploading crafted image files.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "This issue occurs due to improper validation of image files with the extensions `jpg`, `jpeg`, `tiff` when they are passed through ExifTool in Gitlab. The ExifTool will try and determine the file type based on it's content, rather than the file extension. An attacker may be able to exploit this vulnerability using a malformed DjVu file. If this file is processed, this could lead to the execution of arbitrary code.",
    "publishedDate": "2021-04-26T15:59:08.002Z",
    "updatedDate": "2022-05-05T15:17:33.197Z",
    "disclosureDate": "2021-04-14T00:00:00.000Z",
    "exploitPublishDate": "2021-05-14T00:00:00.000Z",
    "solution": "Fixed in:\n[**13.10.3**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.10.3) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/efe45a03bff39d238a0fda1c273beca0295c48c9) commit,\n[**13.9.6**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.9.6) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/b9245e1011919b9327a1a41ad2bcfe965558c67a) commit,\n[**13.8.8**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.8.8) by [this](https://gitlab.com/gitlab-org/gitlab-foss/-/commit/9e9a3b0f375eeb16b6f5ef56df59b0301cfb256f) commit.\n\nThe latest stable releases are available [here](https://gitlab.com/gitlab-org/gitlab-foss/-/releases).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.1,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "vakzz",
    "workaround": "Per the Vendor, \"Anyone running a vulnerable, public-facing GitLab self-managed instance unable to immediately upgrade to a patched version can apply a patch as a temporary hotfix.\" The patch is available [here](https://forum.gitlab.com/t/cve-2021-22205-how-to-determine-if-a-self-managed-instance-has-been-impacted/60918/2).",
    "vendorFixDate": "2021-04-13T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-07T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1146",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22205",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1146/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/blog/2021/11/04/action-needed-in-response-to-cve2021-22205/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2021/04/14/security-release-gitlab-13-10-3-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://forum.gitlab.com/t/cve-2021-22205-how-to-determine-if-a-self-managed-instance-has-been-impacted/60918/2",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-22205.json",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/9e9a3b0f375eeb16b6f5ef56df59b0301cfb256f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/b9245e1011919b9327a1a41ad2bcfe965558c67a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/commit/efe45a03bff39d238a0fda1c273beca0295c48c9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.10.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.8.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v13.9.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1154542",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1154542",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/164994/gitlab13102reverse-exec.txt",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/50532",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1146/default-remediation-status"
            }
        ]
    }
}