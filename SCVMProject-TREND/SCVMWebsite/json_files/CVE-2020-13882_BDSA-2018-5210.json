{
    "source": "BDSA",
    "name": "BDSA-2018-5210",
    "title": "CISOfy Lynis Vulnerable to Privilege Escalation via Time-of-check Time-of-use (TOCTOU) Race Condition",
    "description": "CISOfy Lynis is vulnerable to improper access control via a time-of-check time-of-use (TOCTOU) race condition. A local attacker could exploit this issue in order to manipulate data within log and report files. This could result in privilege escalation, sensitive data exposure, and denial-of-service (DoS). In order to successfully exploit this issue an attacker must wait until a non-privileged user runs Lynis. Symlinks must also be unprotected by the kernel to attempt to cause a TOCTOU race condition which may permit access to the log and report file.",
    "technicalDescription": "This issue occurs in the `Make sure to execute ${PROGRAM_NAME} from untarred directory or check your insta` function within the `lynis` file because the symlink detection routine can be bypassed. An unprivileged attacker could set up a log and report file and control it until the check is carried out. After this point the file may be deleted or rewritten for additional use. It was mitigated by ensuring the the log and report file for non-privileged users is stored in the home directory.",
    "publishedDate": "2021-01-04T09:35:03.763Z",
    "updatedDate": "2021-01-11T09:20:30.323Z",
    "disclosureDate": "2018-10-27T00:00:00.000Z",
    "solution": "Fixed in [**3.0.0**](https://github.com/CISOfy/lynis/releases/tag/3.0.0) by [this](https://github.com/CISOfy/lynis/commit/5b09da0d9878096d45f04b858c4f65e674369ab4) commit.\n\nThe latest stable releases are available [here](https://github.com/CISOfy/lynis/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sander Bos",
    "workaround": "Per the vendor : Linux users with kernel 3.6 or higher can utilize `fs.protected_hardlinks=1` and `fs.protected_symlinks=1`, to counter the symlink attack.",
    "vendorFixDate": "2018-10-27T00:00:00.000Z",
    "vendorNotifiedDate": "2018-10-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5210",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-367"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13882",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5210/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cisofy.com/security/cve/cve-2020-13882/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://cisofy.com/security/cve/cve-2020-13882/",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/CISOfy/lynis/commit/5b09da0d9878096d45f04b858c4f65e674369ab4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/CISOfy/lynis/pull/594",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/CISOfy/lynis/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/CISOfy/lynis/releases/tag/3.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5210/default-remediation-status"
            }
        ]
    }
}