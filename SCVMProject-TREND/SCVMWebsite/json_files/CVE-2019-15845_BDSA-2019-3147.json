{
    "source": "BDSA",
    "name": "BDSA-2019-3147",
    "title": "Ruby Vulnerable to NUL Injection via 'File.fnmatch' and 'File.fnmatch?' Methods",
    "description": "Ruby is vulnerable to NUL injection due to improper validation of user-supplied input with built-in file methods. This could allow an attacker to bypass path matching restrictions implemented in a target Ruby application, which could be leveraged to obtain sensitive file information.",
    "technicalDescription": "The functions `File.fnmatch` and `File.fnmatch?`, which take a path pattern as the first parameter and a pathname as the second parameter, do not properly validate patterns which contain NUL characters. An attacker could exploit this by supplying maliciously crafted input to applications which allow patterns to be passed to these functions from external sources, in order to match pathnames which would otherwise not be matched.",
    "publishedDate": "2019-10-07T14:28:23.514Z",
    "updatedDate": "2019-11-28T15:53:13.560Z",
    "disclosureDate": "2019-10-01T00:00:00.000Z",
    "exploitPublishDate": "2019-10-17T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/ruby/ruby/commit/a0a2640b398cffd351f87d3f6243103add66575b) commit in:\n* [**2.7.0preview2**](https://github.com/ruby/ruby/releases/tag/v2_7_0_preview2)\n* **[2.6.5](https://www.ruby-lang.org/en/news/2019/10/01/ruby-2-6-5-released/)**\n* **[2.5.7](https://www.ruby-lang.org/en/news/2019/10/01/ruby-2-5-7-released/)**\n* **[2.4.9](https://www.ruby-lang.org/en/news/2019/10/02/ruby-2-4-9-released/)**\n\nNote that in **2.4.x** this issue was originally fixed in **2.4.8**, but an installation issue with this version's tarball required a further **2.4.9** release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ooooooo_q",
    "workaround": "",
    "vendorFixDate": "2018-12-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3147",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-158"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15845",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3147/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/a0a2640b398cffd351f87d3f6243103add66575b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/releases/tag/v2_7_0_preview2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/449617",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/449617",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2019/10/01/nul-injection-file-fnmatch-cve-2019-15845/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2019/10/01/ruby-2-5-7-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2019/10/01/ruby-2-6-5-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2019/10/02/ruby-2-4-9-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3147/default-remediation-status"
            }
        ]
    }
}