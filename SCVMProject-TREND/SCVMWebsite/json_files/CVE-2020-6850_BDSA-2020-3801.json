{
    "source": "BDSA",
    "name": "BDSA-2020-3801",
    "title": "miniOrange SAML Single Sign On Vulnerable to Cross-Site Scripting (XSS) via 'msgDestination' Parameter",
    "description": "The miniOrange SAML Single Sign on WP plugin is vulnerable to cross-site scripting (XSS). A remote attacker could provide a specially crafted URL to a user of the plugin, allowing them to run arbitrary JavaScript on their browser. This could be used to steal credentials, and perform actions on the site.",
    "technicalDescription": "This vulnerability exists in the `msgDestination` parameter within the `SAMLResponse` element. An attacker will send the crafted payload via `SAMLResponse` and `RelayState` variable to the `wp-login` page which contains the destination parameter. If the `msgDestination` value  doesn\u2019t match with the current URL then an error will occur. This error outputs the destination value without prior sanitization. The crafted malicious JavaScript payload injected by the attacker will execute upon this error.\n\nThe vendor has addressed this issue by providing sanitization of the parameter in`miniorange-saml-20-single-sign-on/trunk/Utilities.php` file.",
    "publishedDate": "2020-12-23T15:59:59.400Z",
    "updatedDate": "2020-12-23T15:59:59.389Z",
    "disclosureDate": "2020-01-28T00:00:00.000Z",
    "exploitPublishDate": "2020-01-28T00:00:00.000Z",
    "solution": "Fixed in version [**4.8.84**](https://en-gb.wordpress.org/plugins/miniorange-saml-20-single-sign-on/advanced/) by  [this](https://plugins.trac.wordpress.org/changeset/2224528/) changeset.\n\nThe latest stable releases are available [here](https://en-gb.wordpress.org/plugins/miniorange-saml-20-single-sign-on/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ZEROAUTH",
    "workaround": "",
    "vendorFixDate": "2020-08-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3801",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-6850",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3801/ranges"
            },
            {
                "rel": "reference",
                "href": "https://en-gb.wordpress.org/plugins/miniorange-saml-20-single-sign-on/advanced/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://plugins.trac.wordpress.org/changeset/2224528/",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://zeroauth.ltd/blog/2020/01/28/cve-2020-6850-miniorange-saml-wp-plugin-before-4-8-84-is-vulnerable-to-xss-via-a-specially-crafted-saml-xml-response/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://zeroauth.ltd/blog/2020/01/28/cve-2020-6850-miniorange-saml-wp-plugin-before-4-8-84-is-vulnerable-to-xss-via-a-specially-crafted-saml-xml-response/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3801/default-remediation-status"
            }
        ]
    }
}