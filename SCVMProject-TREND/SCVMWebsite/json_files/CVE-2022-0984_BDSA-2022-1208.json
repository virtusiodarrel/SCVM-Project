{
    "source": "BDSA",
    "name": "BDSA-2022-1208",
    "title": "Moodle Vulnerable to Unauthorized Badge Modification via Insufficient Acceptance Criteria Validation",
    "description": "Moodle is vulnerable to unauthorized modification of badge properties due to the improper enforcement of access restrictions on badge criteria. An authenticated attacker with badge configuration permissions could configure profile field criteria for course badges, which should not be allowed.",
    "technicalDescription": "The script `badges/criteria_settings.php` contains code that is used to control operations on badges. This code fails to validate the criteria type that is associated with a given badge. This could allow a user that has badge configuration permissions to set disallowed profile field criteria for course badges.",
    "publishedDate": "2022-05-02T16:15:51.483Z",
    "updatedDate": "2022-05-02T16:15:51.460Z",
    "disclosureDate": "2022-03-15T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**4.0.0-rc1**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v4.0.0-rc1) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=c36ab09b66f683987d1f0bf34903d32d4e8f0326) commit.\n* [**3.11.6**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.11.6) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=cdc78a16a5da95a17fb10bf1c66689237f5a3f7d) commit.\n* [**3.10.10**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.10.10) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=3b47042a4a905c71d004714a22254cf65ee8fe63) commit.\n* [**3.9.13**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.9.13) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=1cdc2e81f8327812024aa26bbce79e19bb73b93e) commit.\n\nThe latest stable releases can be found [here](https://download.moodle.org/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-03-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1208",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-0984",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1208/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2064118",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://download.moodle.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=1cdc2e81f8327812024aa26bbce79e19bb73b93e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=3b47042a4a905c71d004714a22254cf65ee8fe63",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=c36ab09b66f683987d1f0bf34903d32d4e8f0326",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=cdc78a16a5da95a17fb10bf1c66689237f5a3f7d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.10.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.11.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.9.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v4.0.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1208/default-remediation-status"
            }
        ]
    }
}