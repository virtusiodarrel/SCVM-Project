{
    "source": "BDSA",
    "name": "BDSA-2022-2660",
    "title": "Node.js 'vm2' Package Vulnerable to Sandbox Escape via Flawed Exception Handling",
    "description": "vm2 is vulnerable to a sandbox escape issue due to how exceptions are not properly handled.\n\nAn attacker could submit crafted code that abuses this flaw in order to bypass sandbox protections and gain the ability to execute code on the host running the sandbox.",
    "technicalDescription": "This issue exists due to how users can abuse the `global.Error` property in order to gain access to `process.mainModule`  which can allow libraries to be imported with the aim of executing malicious commands.",
    "publishedDate": "2022-09-23T16:08:03.137Z",
    "updatedDate": "2022-09-23T16:08:03.109Z",
    "disclosureDate": "2022-08-30T00:00:00.000Z",
    "exploitPublishDate": "2022-09-15T00:00:00.000Z",
    "solution": "Fixed in [**3.9.11**](https://github.com/patriksimek/vm2/releases/tag/3.9.11) by [this](https://github.com/patriksimek/vm2/commit/d9a7f3cc995d3d861e1380eafb886cb3c5e2b873) commit.\n\nThe latest stable releases are available [here](https://www.npmjs.com/package/vm2).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Oxeye Research Team",
    "workaround": "",
    "vendorFixDate": "2022-08-28T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2660",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-913"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-36067",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2660/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/patriksimek/vm2/commit/d9a7f3cc995d3d861e1380eafb886cb3c5e2b873",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/patriksimek/vm2/issues/467",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/patriksimek/vm2/issues/467#issuecomment-1247515828",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/patriksimek/vm2/releases/tag/3.9.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/patriksimek/vm2/security/advisories/GHSA-mrgp-mrhc-5jrq",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/vm2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2660/default-remediation-status"
            }
        ]
    }
}