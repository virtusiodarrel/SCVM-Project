{
    "source": "BDSA",
    "name": "BDSA-2019-4298",
    "title": "Asterisk Vulnerable to Denial-of-Service (DoS) via Null Pointer Dereference When Negotiating for T.38 With a Declined Stream",
    "description": "Asterisk is vulnerable to a null pointer dereference flaw in its handling of T.38 negotiations. A remote attacker could cause the application to crash, resulting in a denial-of-service (DoS).",
    "technicalDescription": "Asterisk will crash by attempting to dereference a NULL session media object when receiving a \"200 OK\" with a declined stream in response to a T.38 initiated re-invite. The issue occurs in the `res/res_pjsip_t38.c` file and has been fixed by adding checks to make sure the session media object is not NULL before attempting to use it.",
    "publishedDate": "2020-03-13T15:58:42.652Z",
    "updatedDate": "2021-05-04T08:32:30.149Z",
    "disclosureDate": "2019-09-05T00:00:00.000Z",
    "exploitPublishDate": "2019-09-05T00:00:00.000Z",
    "solution": "Fixed in **[15.7.4](https://github.com/asterisk/asterisk/releases/tag/15.7.4)** by [this](https://github.com/asterisk/asterisk/commit/b49f09a292) commit.\n\nFixed in **[16.5.1](https://github.com/asterisk/asterisk/releases/tag/16.5.1)** by [this](https://github.com/asterisk/asterisk/commit/3e794ada8e) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alexei Gradinari",
    "workaround": "The vendor supplies the following workaround:\n> If T.38 faxing is not required then setting the \u201ct38_udptl\u201d configuration option on the endpoint to \u201cno\u201d disables this functionality. This option defaults to \u201cno\u201d so you have to have explicitly set it \u201cyes\u201d to potentially be affected by this issue.",
    "vendorFixDate": "2019-08-20T00:00:00.000Z",
    "vendorNotifiedDate": "2019-08-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4298",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-476"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15297",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4298/ranges"
            },
            {
                "rel": "reference",
                "href": "http://downloads.digium.com/pub/security/AST-2019-004.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://downloads.digium.com/pub/security/AST-2019-004.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/commit/3e794ada8e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/commit/b49f09a292",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/releases/tag/15.7.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/releases/tag/16.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.asterisk.org/jira/browse/ASTERISK-28495",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://issues.asterisk.org/jira/browse/ASTERISK-28495",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4298/default-remediation-status"
            }
        ]
    }
}