{
    "source": "BDSA",
    "name": "BDSA-2020-1057",
    "title": "OpenStack Keystone Vulnerable to Privilege Escalation via EC2 Credential Updates",
    "description": "OpenStack Keystone contains a privilege escalation vulnerability due insufficient verification that a user has sufficient privileges to update credentials to a given user or project. An authenticated attacker could create EC2 credentials for themselves for a project they have a role on and then update those credentials to the victim or another project which they have no rights to. This could allow an attacker to perform action as an admin user of a project which that admin user has a role on.",
    "technicalDescription": "The `patch` function in `keystone/api/credentials.py` has no checks in place when an EC2 credential is updated to ensure the user is updating the credentials to a user and project which they currently own. An attacker could abuse this by updating an EC2 credential they control to another user and project which they are not associated. Worst case this could be an admin user for a project which that admin user has a role. The attacker can then perform actions as the victim user. It may be possible for an attacker to gain global admin privileges through this vulnerability.",
    "publishedDate": "2020-05-12T03:26:28.650Z",
    "updatedDate": "2020-08-17T09:02:28.500Z",
    "disclosureDate": "2020-05-06T00:00:00.000Z",
    "solution": "Fixed in:\n* **[17.0.0.0rc2](https://github.com/openstack/keystone/releases/tag/17.0.0.0rc2)** by [this](https://github.com/openstack/keystone/commit/2f2736ebb) commit.\n* **[15.0.1](https://github.com/openstack/keystone/releases/tag/15.0.1)** by [this](https://github.com/openstack/keystone/commit/206392a40) commit.\n* **[16.0.1](https://github.com/openstack/keystone/releases/tag/16.0.1)** by [this](https://github.com/openstack/keystone/commit/54590544f) commit.\n* The **remotes/origin/stable/queens** branch by [this](https://github.com/openstack/keystone/commit/487c7276c7608fb11086b9875b0d7cc7cf594a5a) commit.\n* The **remotes/origin/stable/rocky** branch by [this](https://github.com/openstack/keystone/commit/53d1ccb8a1bdbb5aa0efaacf9739b1a6f436e191) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "kay",
    "workaround": "",
    "vendorFixDate": "2020-04-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1057",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12691",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1057/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/206392a40",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/2f2736ebb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/37e9907a176dad6843819b1bec4946c3aecc4548",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/54590544f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/releases/tag/15.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/releases/tag/16.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/releases/tag/17.0.0.0rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://security.openstack.org/ossa/OSSA-2020-004.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1057/default-remediation-status"
            }
        ]
    }
}