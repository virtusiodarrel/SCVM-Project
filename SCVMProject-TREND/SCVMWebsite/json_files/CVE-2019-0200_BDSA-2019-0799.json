{
    "source": "BDSA",
    "name": "BDSA-2019-0799",
    "title": "Apache Qpid Broker-J Vulnerable to Denial-of-Service (DoS) via Improper Handling of Malformed AMQP Messages",
    "description": "Apache Qpid Broker-J is vulnerable to denial-of-service (DoS) due to an inability to handle malformed Advanced Message Queuing Protocol (AMQP) messages. A remote attacker could cause the application to crash by sending such messages.",
    "technicalDescription": "AMQP (version 0-8 to 0-10) messages are handled by Qpid Broker-J using code contained in a variety of functions and scripts. These messages contain a variety of headers and status codes. The Qpid Broker-J code proceeds with the asssumption that these header and status codes are located at the correct offsets in memory and are of the correct size and data type. If this is not the case, the code may attempt to perform illegal data manipulation or comparison operations. This can result in the raising of an exception, halting program execution. An attacker could therefore cause a DoS by providing the application with crafted AMQP packets that are malformed in such a way as to trigger an exception.",
    "publishedDate": "2019-03-22T16:16:44.823Z",
    "updatedDate": "2019-03-22T16:16:44.791Z",
    "disclosureDate": "2019-01-17T00:00:00.000Z",
    "solution": "Fixed in version [**7.1.1**](https://github.com/apache/qpid-broker-j/releases/tag/7.1.1) by the following commits:\n* [Commit 1](https://github.com/apache/qpid-broker-j/commit/dd1034cd656668129da03c4497a28053fd380471)\n* [Commit 2](https://github.com/apache/qpid-broker-j/commit/ae6fecffad5edb4abde74f1e4d2e2060702523f2)\n* [Commit 3](https://github.com/apache/qpid-broker-j/commit/934a206e9535c27d59fb55ba7846345f95e27e0e)\n\nFixed in version [**7.0.7**](https://github.com/apache/qpid-broker-j/releases/tag/7.0.7) by the following commits:\n* [Commit 1](https://github.com/apache/qpid-broker-j/commit/9c6440805791e21b8c9d8982f6790b16763a593e)\n* [Commit 2](https://github.com/apache/qpid-broker-j/commit/21320b5a2944e1c546f2abff64d8db35532773c6)\n* [Commit 3](https://github.com/apache/qpid-broker-j/commit/4524b0432afef223f6122349a0832932188c4e35)\n* [Commit 4](https://github.com/apache/qpid-broker-j/commit/2e72e832d9b8274cc09f7f1cfba313a40f8cc0da)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-03-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0799",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-703"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-707"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-0200",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0799/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/qpid-broker-j/commit/21320b5a2944e1c546f2abff64d8db35532773c6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/qpid-broker-j/commit/2e72e832d9b8274cc09f7f1cfba313a40f8cc0da",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/qpid-broker-j/commit/4524b0432afef223f6122349a0832932188c4e35",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/qpid-broker-j/commit/934a206e9535c27d59fb55ba7846345f95e27e0e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/qpid-broker-j/commit/9c6440805791e21b8c9d8982f6790b16763a593e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/qpid-broker-j/commit/ae6fecffad5edb4abde74f1e4d2e2060702523f2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/qpid-broker-j/commit/dd1034cd656668129da03c4497a28053fd380471",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/qpid-broker-j/releases/tag/7.0.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/qpid-broker-j/releases/tag/7.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/QPID-8273",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0799/default-remediation-status"
            }
        ]
    }
}