{
    "source": "BDSA",
    "name": "BDSA-2021-0632",
    "title": "Envoy Vulnerable to Authentication Bypass via JWT Token Logic Errors",
    "description": "Envoy contains an authentication bypass vulnerability due to incorrect logic with JWT tokens. An attacker can take advantage of this in order to gain access to restricted functionality.",
    "technicalDescription": "This vulnerability exists due to the Envoy JWT Authentication filter containing incorrect logic. When an invalid JWT token is presented the Authentication filter is meant to fail, however instead it has been configured with the `allow_missing` requirement which will authenticate JWT tokens even if they are invalid. An attacker can take advantage of this by presenting a JWT token with an issuer that is not in the provider list. This will allow them to gain access to restricted functionality, for example writes or modifications.",
    "publishedDate": "2021-03-12T15:22:57.034Z",
    "updatedDate": "2021-10-26T12:44:22.698Z",
    "disclosureDate": "2021-03-09T00:00:00.000Z",
    "solution": "Fixed in [**1.18.0**](https://github.com/envoyproxy/envoy/releases/tag/v1.18.0) by [this](https://github.com/envoyproxy/envoy/commit/ea39e3cba652bcc4b11bb0d5c62b017e584d2e5a) commit.\n\nThe latest stable releases are available [here](https://github.com/envoyproxy/envoy/releases)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Vladimir Pouzanov",
    "workaround": "The vendor has stated \"Vulnerable users can mitigate this by using an RBAC filter that checks the dynamic metadata for the validation result.\"\n\nFurther information on this workaround is available [here](https://github.com/envoyproxy/envoy/security/advisories/GHSA-4996-m8hf-hj27).",
    "vendorFixDate": "2021-02-26T00:00:00.000Z",
    "discoveryDate": "2021-02-20T00:00:00.000Z",
    "vendorNotifiedDate": "2021-02-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0632",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-290"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21378",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0632/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/9270506f9f2b6786c21719bed3a97a6e0e71a760",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/ea39e3cba652bcc4b11bb0d5c62b017e584d2e5a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.18.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-4996-m8hf-hj27",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-4996-m8hf-hj27",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0632/default-remediation-status"
            }
        ]
    }
}