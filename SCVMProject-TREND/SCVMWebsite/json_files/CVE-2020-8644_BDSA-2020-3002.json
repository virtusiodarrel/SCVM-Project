{
    "source": "BDSA",
    "name": "BDSA-2020-3002",
    "title": "PlaySMS Vulnerable to Remote Code Execution (RCE) via Server Side Template Injection",
    "description": "PlaySMS is vulnerable to remote code execution (RCE) due to server-side template injection in `index.php`. This could allow an attacker to inject any malicious code and obtain sensitive information or compromise the system.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "PlaySMS supports a custom PHP templating system (TPL) present in the location `src/Playsms/Tpl.php:_compile()`. The vulnerability is broken into two parts; where the server-side template is processed twice, the attacker can send the malicious template via username field in POST request that will get stored in the given custom TPL. Provided custom TPL is vulnerable to PHP code execution that will help to render the malicious template from the cache request data.",
    "publishedDate": "2020-10-28T14:10:53.476Z",
    "updatedDate": "2022-05-06T11:27:30.118Z",
    "disclosureDate": "2020-02-05T00:00:00.000Z",
    "exploitPublishDate": "2020-02-11T00:00:00.000Z",
    "solution": "Fixed in [**1.4.3**](https://sourceforge.net/projects/playsms/files/playsms/Version%201.4.3/) by [this](https://github.com/antonraharja/playSMS/commit/e57af24ef0bed5ed1c1afd633c3ca182ca8bb46a) commit.\n\nThe latest stable releases are available [here](https://playsms.org/).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-02-04T00:00:00.000Z",
    "vendorNotifiedDate": "2020-01-25T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3002",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-917"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8644",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3002/ranges"
            },
            {
                "rel": "reference",
                "href": "https://forum.playsms.org/t/playsms-1-4-3-has-been-released/2704",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/antonraharja/playSMS/commit/e57af24ef0bed5ed1c1afd633c3ca182ca8bb46a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/157106/PlaySMS-index.php-Unauthenticated-Template-Injection-Code-Execution.html",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://playsms.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://sourceforge.net/projects/playsms/files/playsms/Version%201.4.3/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3002/default-remediation-status"
            }
        ]
    }
}