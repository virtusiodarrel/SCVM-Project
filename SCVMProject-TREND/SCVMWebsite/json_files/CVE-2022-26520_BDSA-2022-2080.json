{
    "source": "BDSA",
    "name": "BDSA-2022-2080",
    "title": "pgjdbc Vulnerable to Remote Code Execution (RCE) via Arbitrary File Write in Connection Properties Settings",
    "description": "pgjdbc is vulnerable to remote code execution (RCE) due to an arbitrary file write issue in the Connection Properties settings. An attacker could potentially exploit this by creating an executable `.JSP` file under a Tomcat web root.\n\n**Note:** The vendor disputes that the issue lies within pgjdbc, instead suggesting that the issue lies with how the driver can be allowed to run with untrusted connection properties within an application.",
    "technicalDescription": "This issue occurs in the `pgjdbc/src/main/java/org/postgresql/ds/common/BaseDataSource.java` file. It was mitigated by the removal of the `loggerFile` and `loggerLevel` connection properties and now utilizes `java.util.logging` to configure all logging in the driver.",
    "publishedDate": "2022-07-26T14:14:00.238Z",
    "updatedDate": "2022-09-06T13:25:27.826Z",
    "disclosureDate": "2022-02-15T00:00:00.000Z",
    "exploitPublishDate": "2022-02-15T00:00:00.000Z",
    "solution": "Fixed in [**42.3.3-rc1**](https://github.com/pgjdbc/pgjdbc/releases/tag/REL42.3.3-rc1) by [this](https://github.com/pgjdbc/pgjdbc/commit/12c7fb40f761d69d64ced158684af2ccef279b48) commit and [this](https://github.com/pgjdbc/pgjdbc/commit/f6d47034a4ce292e1a659fa00963f6f713117064) commit.\n\nThe latest stable releases can be found [here](https://github.com/pgjdbc/pgjdbc/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Allan Lou",
    "workaround": "The vendor suggests sanitizing the inputs to the driver as a mitigation.",
    "vendorFixDate": "2022-02-15T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2080",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-26520",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2080/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2064007",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/commit/12c7fb40f761d69d64ced158684af2ccef279b48",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/commit/f6d47034a4ce292e1a659fa00963f6f713117064",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/releases/tag/REL42.3.3-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-673j-qm5f-xpv8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-673j-qm5f-xpv8",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-673j-qm5f-xpv8",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://jdbc.postgresql.org/documentation/changelog.html#version_42.3.3",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2080/default-remediation-status"
            }
        ]
    }
}