{
    "source": "BDSA",
    "name": "BDSA-2022-1168",
    "title": "Redis Vulnerable to Privilige Escalation via Insecure Script Execution Environment",
    "description": "Redis is vulnerable to privilege escalation due to the unsafe implementation of its Lua scripting environment. An authenticated attacker could leverage this issue in order to execute arbitrary Lua code in the context of a more privileged user.",
    "technicalDescription": "Redis contains a Lua script execution environment. This is implemented using code that is contained in a range of files and functions, such as the function `scriptingInit()` of file `src/eval.c`. The scripting environment is insufficiently protected. An attacker could potentially inject Lua code into the environment that will be executed under the context of a more privileged user. In this way, the attacker can achieve privilege escalation.",
    "publishedDate": "2022-04-28T15:38:36.541Z",
    "updatedDate": "2022-04-28T15:38:36.527Z",
    "disclosureDate": "2022-04-27T00:00:00.000Z",
    "solution": "Fixed in versions [**7.0.0**](https://github.com/redis/redis/releases/tag/7.0.0) by [this](https://github.com/redis/redis/commit/89772ed827209c3dca376644498a235ef3edf692) commit, and in [**6.2.7**](https://github.com/redis/redis/releases/tag/6.2.7) by [this](https://github.com/redis/redis/commit/13c1e1f2986adcd8788f464a1931cdfe744f15f9) commit and [this](https://github.com/redis/redis/commit/11b602fbf8f9cdf8fc741c24625ab6287ab998a9) commit.\n\nThe latest stable releases can be found [here](https://github.com/redis/redis/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.2
        },
        "vector": "(AV:L/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.9,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 1.3,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated that the following workaround can be implemented:\n\n> An additional workaround to mitigate this problem without patching the redis-server executable, if Lua scripting is not being used, is to block access to SCRIPT LOAD and EVAL commands using ACL rules.",
    "vendorFixDate": "2022-04-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1168",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24735",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1168/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/11b602fbf8f9cdf8fc741c24625ab6287ab998a9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/13c1e1f2986adcd8788f464a1931cdfe744f15f9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/89772ed827209c3dca376644498a235ef3edf692",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/pull/10651",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/6.2.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/7.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/security/advisories/GHSA-647m-2wmq-qmvq",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/security/advisories/GHSA-647m-2wmq-qmvq",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1168/default-remediation-status"
            }
        ]
    }
}