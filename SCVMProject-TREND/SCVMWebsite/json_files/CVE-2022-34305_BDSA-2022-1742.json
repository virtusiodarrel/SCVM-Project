{
    "source": "BDSA",
    "name": "BDSA-2022-1742",
    "title": "Apache Tomcat Vulnerable to Cross-Site Scripting (XSS) via Form Authentication Example",
    "description": "The form authentication example in Apache Tomcat is vulnerable to cross-site scripting (XSS). If the code for this example form is used in production it could be exploited to steal user session tokens or perform actions on other users' behalf.",
    "technicalDescription": "The vulnerable principal attributes are `name`, `value`, `type`. The session attribute for `name` is vulnerable as well. This form, which resides in `webapps/examples/jsp/security/protected/index.jsp`, was fixed by applying `util.HTMLFilter.filter` on vulnerable attributes.\n\n**Note:** Although the direct impact severity for the Form authentication example is low, there is a considerable risk of this vulnerable code being reused in production.",
    "publishedDate": "2022-06-24T10:01:01.124Z",
    "updatedDate": "2022-09-02T12:22:23.291Z",
    "disclosureDate": "2022-06-23T00:00:00.000Z",
    "solution": "Fixed in:\n* [**8.5.82**](https://github.com/apache/tomcat/releases/tag/8.5.82)** by [this](https://github.com/apache/tomcat/commit/5f6c88b054) commit,\n* [**9.0.65**](https://github.com/apache/tomcat/releases/tag/9.0.65)** by [this](https://github.com/apache/tomcat/commit/8b60af90b9) commit,\n* [**10.0.23**](https://github.com/apache/tomcat/releases/tag/10.0.23)** by [this](https://github.com/apache/tomcat/commit/1a7e95d9c3) commit,\n* **main** branch by [this](https://github.com/apache/tomcat/commit/d6251d1cfb) commit which is not yet included in any release.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.0,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 1.6,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "Removing the examples web application and all of the Form authentication code used in production would mitigate the issue.",
    "vendorFixDate": "2022-06-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1742",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-34305",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1742/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/1a7e95d9c3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/5f6c88b054",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/8b60af90b9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/d6251d1cfb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/10.0.23",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/8.5.82",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/9.0.65",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/k04zk0nq6w57m72w5gb0r6z9ryhmvr4k",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/k04zk0nq6w57m72w5gb0r6z9ryhmvr4k",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1742/default-remediation-status"
            }
        ]
    }
}