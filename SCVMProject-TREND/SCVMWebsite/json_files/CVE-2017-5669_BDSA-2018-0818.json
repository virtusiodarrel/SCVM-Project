{
    "source": "BDSA",
    "name": "BDSA-2018-0818",
    "title": "Linux Kernel do_shmat Vulnerable to Security Feature Bypass via Crafted shmget and shmat System Calls",
    "description": "A local attacker can map page zero by issuing specially crafted systemcalls to the Linux Kernel.  This bypasses a security feature that should prevent them from doing that.  This could allow them to further exploit other kernel vulnerabilities.",
    "technicalDescription": "There is a bypass of a check due to a rounding error in function `do_shmat` in `ipc/shm.c`. Page zero is not supposed to be mapped in userland, but by issuing specially crafted `shmget` and `shmat` system calls this flaw can allow that to happen. This is only possible as the root user. This could, for example, allow kernel exploitation of many other NULL pointer dereference vulnerabilities as the attacker can now map specially crafted data in the zero page.  A restricted root user who can then execute arbitrary kernel code could break out of sandboxes, target other virtual machines running on the same hardware, or stealthily hide malicious functionality.",
    "publishedDate": "2018-04-20T12:15:02.903Z",
    "updatedDate": "2018-12-06T09:32:08.406Z",
    "disclosureDate": "2017-01-20T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.2.87**](https://www.kernel.org)\n* [**3.10.107**](https://www.kernel.org)\n* [**3.12.72**](https://www.kernel.org)\n* [**3.16.42**](https://www.kernel.org)\n* [**4.1.40**](https://www.kernel.org)\n* [**4.4.53**](https://www.kernel.org)\n* [**4.9.14**](https://www.kernel.org)\n* [**4.10.2**](https://www.kernel.org)\n* [**4.11-rc1**](https://www.kernel.org)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=95e91b831f87ac8e1f8ed50c14d709089b4e01b8) git commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "MULTIPLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:L/AC:L/Au:M/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2017-02-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-0818",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-684"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-5669",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-0818/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.kernel.org/show_bug.cgi?id=192931",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=95e91b831f87ac8e1f8ed50c14d709089b4e01b8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}