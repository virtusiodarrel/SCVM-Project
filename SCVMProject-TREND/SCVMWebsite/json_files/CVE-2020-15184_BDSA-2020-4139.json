{
    "source": "BDSA",
    "name": "BDSA-2020-4139",
    "title": "Helm Vulnerable to Chart Modification via Insufficient 'alias' Field Validation",
    "description": "Helm is vulnerable to the unauthorized modification of charts due to the insufficient sanitization of a particular field. A remote authenticated attacker could use a maliciously crafted `alias` field that contains illegal characters in order to inject information into a chart.",
    "technicalDescription": "The `Chart.yaml` file which is used by Helm contains a `dependencies` field, which can contain an optional sub-field called `alias`. The name that is provided with this field should consist only of certain characters. However, Helm does not perform any validation on the value of this field in order to ensure that it does not contain illegal characters. Such illegal characters could be used by an authenticated attacker in order to inject unwanted information into a chart.\n\nThe vulnerability was fixed by adding validation logic which ensures that illegal characters are not present.",
    "publishedDate": "2021-02-04T09:29:56.115Z",
    "updatedDate": "2021-02-04T09:29:56.106Z",
    "disclosureDate": "2020-09-17T00:00:00.000Z",
    "solution": "Fixed in [**3.3.2**](https://github.com/helm/helm/releases/tag/v3.3.2) by [this](https://github.com/helm/helm/commit/e7c281564d8306e1dcf8023d97f972449ad74850) commit, and in [**2.16.11**](https://github.com/helm/helm/releases/tag/v2.16.11) by [this](https://github.com/helm/helm/commit/6aab63765f99050b115f0aec3d6350c85e8da946) commit..\n\nThe latest stable releases are available [here](https://github.com/helm/helm/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 2.7,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.2,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has provided the following workaround:\n\n> Manually review the dependencies field of any untrusted chart, verifying that the alias field is either not used, or (if used) does not contain newlines or path characters.",
    "vendorFixDate": "2020-09-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4139",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15184",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4139/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/commit/6aab63765f99050b115f0aec3d6350c85e8da946",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/commit/e7c281564d8306e1dcf8023d97f972449ad74850",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases/tag/v2.16.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases/tag/v3.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/security/advisories/GHSA-9vp5-m38w-j776",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/security/advisories/GHSA-9vp5-m38w-j776",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4139/default-remediation-status"
            }
        ]
    }
}