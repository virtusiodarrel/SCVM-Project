{
    "source": "BDSA",
    "name": "BDSA-2019-4847",
    "title": "MongoDB Server Vulnerable to Denial-of-Service (DoS) via Memory Misallocation in Message Decompressor Functionality",
    "description": "MongoDB Server is vulnerable to a denial-of-service (DoS) condition due to a flaw in the message decompressor functionality that can lead to memory allocation issues.\n\nAn unauthenticated attacker could send crafted wire protocol messages in order to trigger this scenario and cause DoS conditions via instability.",
    "technicalDescription": "MongoDB Server is vulnerable to a denial-of-service (DoS) condition because the `MessageCompressorManager::decompressMessage()` function in the `src/mongo/transport/message_compressor_manager.cpp` file does not sufficiently validate the size of the user controlled `compressionHeader` value.\n\nAs a result of this, an attacker could send a crafted wire protocol message to to cause the message decompressor to incorrectly allocate memory, impacting the stability of the application.",
    "publishedDate": "2020-11-25T15:16:22.709Z",
    "updatedDate": "2020-11-25T15:16:22.703Z",
    "disclosureDate": "2019-10-01T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.3.1**](https://github.com/mongodb/mongo/releases/tag/r4.3.1) by [this](https://github.com/mongodb/mongo/commit/1411cf602a21e45a5ef42b6869c480eb420976ee) commit,\n* [**4.2.1-rc0**](https://github.com/mongodb/mongo/releases/tag/r4.2.1-rc0) by [this](https://github.com/mongodb/mongo/commit/be871247f92e6761f462300db061a48ccb9f3543) commit,\n* [**4.0.14-rc0**](https://github.com/mongodb/mongo/releases/tag/r4.0.14-rc0) by [this](https://github.com/mongodb/mongo/commit/5381b1655a7d5a5967a5cdad5481ed43714b5638) commit,\n* [**3.6.15-rc0**](https://github.com/mongodb/mongo/releases/tag/r3.6.15-rc0) by [this](https://github.com/mongodb/mongo/commit/bcec27cddbc82def0eb09e7abe047b14f6ccb995) commit,\n* [**3.4.24-rc0**](https://github.com/mongodb/mongo/releases/tag/3.4.24-rc0) by [this](https://github.com/mongodb/mongo/commit/c1a956e084d39e6da75cd347e63d0064ed9151a8) commit.\n\nThe latest stable releases are available [here](https://www.mongodb.com/download-center/community/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-10-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4847",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-839"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20925",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4847/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.mongodb.com/master/release-notes/4.0-changelog/#id69",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/commit/5381b1655a7d5a5967a5cdad5481ed43714b5638",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/commit/bcec27cddbc82def0eb09e7abe047b14f6ccb995",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/commit/be871247f92e6761f462300db061a48ccb9f3543",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/commit/c1a956e084d39e6da75cd347e63d0064ed9151a8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/releases/tag/3.4.24-rc0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/releases/tag/r3.6.15-rc0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/releases/tag/r4.0.14-rc0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/releases/tag/r4.2.1-rc0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jira.mongodb.org/browse/SERVER-43751",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4847/default-remediation-status"
            }
        ]
    }
}