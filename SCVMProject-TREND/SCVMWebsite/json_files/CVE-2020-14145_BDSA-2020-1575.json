{
    "source": "BDSA",
    "name": "BDSA-2020-1575",
    "title": "OpenSSH Vulnerable to Man-in-the-Middle Attacks via Information Leak During Initial Key Exchange",
    "description": "OpenSSH is vulnerable to man-in-the-middle (MITM) attacks due to the leakage of information during the key exchange process. A remote attacker could obtain information or modify data by tricking a client into connecting to an attacker controlled server.",
    "technicalDescription": "Whenever an OpenSSH client that is using the default configuration connects to a server, a key exchange process occurs. The exchange messages that are sent by clients that possess the host key of the target server will differ from those that do not possess the host key. This is due to the fact that the messages will list the host key algorithms in order of preference, with the algorithms of the possessed host keys having the highest preference.\n\nAn attacker can use this information to deduce which clients possess the host key, versus those that do not. The attacker will then be able to conduct a MITM attack against clients that do not have the host key whenever they attempt to connect for the first time. The attacker can achieve this provided they can trick the victim into connecting to an attacker controlled server, and that the victim does not compare the signature of the provided key to a real reference value. This could potentially allow the attacker to obtain or modify sensitive information.\n\nThe vendor has stated that they do not intend to release a patch for this vulnerability, as modifying this functionality can affect the key exchange process in other undesirable ways.",
    "publishedDate": "2020-06-30T15:14:44.308Z",
    "updatedDate": "2021-07-19T14:18:54.825Z",
    "disclosureDate": "2020-06-26T00:00:00.000Z",
    "exploitPublishDate": "2020-06-26T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:POC/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.7,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N/E:P/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Timon Hackenjos",
    "workaround": "The reporters have stated that the following configuration changes can be used to mitigate the vulnerability:\n\" OpenSSH provides alternative ways to validate host keys, namely Secure Shell Fingerprint (SSHFP) records and host certificates. These should be used if Domain Name System Security Extensions (DNSSEC) or a Public Key Infrastructure (PKI) are available.\nOtherwise, by setting the option `HostKeyAlgorithms` explicitly (without `+`, `-` or `^`) the adaptive order of the host key algorithms can be disabled including the aforementioned drawback. OpenSSH offers the option `UpdateHostKeys` that can reduce the impact of this change. By enabling this option, the client will receive additional host keys from the server after authentication, given that the server supports the protocol extension. \"\n\nThe openssh team [committed](https://anongit.mindrot.org/openssh.git/commit/?id=b3855ff053f5078ec3d3c653cdaedefaa5fc362d) a partial mitigation of this issue which is included in openssh **8.4**.",
    "bdsaTags": [],
    "overallScore": 4.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1575",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-203"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14145",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1575/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/articles/6128631",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/articles/6128631",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://anongit.mindrot.org/openssh.git/commit/?id=b3855ff053f5078ec3d3c653cdaedefaa5fc362d",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://docs.ssh-mitm.at/CVE-2020-14145.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://docs.ssh-mitm.at/CVE-2020-14145.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-2-ausnutzung-eines-informationslecks-fuer-gezielte-mitm-angriffe-auf-ssh-clients/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-2-ausnutzung-eines-informationslecks-fuer-gezielte-mitm-angriffe-auf-ssh-clients/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-2-ausnutzung-eines-informationslecks-fuer-gezielte-mitm-angriffe-auf-ssh-clients/",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/12/02/1",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1575/default-remediation-status"
            }
        ]
    }
}