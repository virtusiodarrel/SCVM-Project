{
    "source": "BDSA",
    "name": "BDSA-2021-0801",
    "title": "FreeBSD Vulnerable to Sandbox Escape via 'ptrace()' Mishandling for Jailed Processes",
    "description": "FreeBSD is vulnerable to a sandbox escape due to the improper implementation of process tracing functionality. A local attacker could bypass jail restrictions and gain read-write access to files on the system by invoking the `ptrace()` system call.\n\nIt should be noted that only systems that are running jails with untrusted root users are vulnerable.",
    "technicalDescription": "The function `do_jail_attach()`, of file `sys/kern/kern_jail.c`, is used to implement the `jail_attach()` system call. This system call allows a process to move into an exiting jail. There are insufficient checks performed to ensure that the working directory of the jailed process has been successfully contained within the jail, and to ensure that there are no directory descriptors open which may reference directories outside of the jail. This could allow an attacker to perform a `ptrace()` system call against a process that lies outside of the jail, which could in turn allow the attacker to read and write to arbitrary files on the system. An attacker could use this to escape from the jail.\n\nIt should be noted that only systems that are running jails with untrusted root users are vulnerable.",
    "publishedDate": "2021-03-29T13:36:14.424Z",
    "updatedDate": "2021-04-28T12:58:15.681Z",
    "disclosureDate": "2021-02-24T00:00:00.000Z",
    "solution": "Fixed in: \n* [**13.0.0**](https://www.freebsd.org/releases/) by [this](https://cgit.freebsd.org/src/commit/?id=f3f042d850baaeda1bed19e00c2b3b578644b7e9) commit,\n* [**12.2**](https://www.freebsd.org/releases/) by [this](https://cgit.freebsd.org/src/commit/?id=ca9ab8ea17748a1758701fde262cb272fb757989) commit,\n* [**11.4**](https://www.freebsd.org/releases/) by [this](https://cgit.freebsd.org/src/commit/?id=570121808a76b85b2709502fb15618dd1e5296f1) commit.\n\nThe latest stable releases are available [here](http://link-to-latest-stable-releases.com).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mateusz Guzik",
    "workaround": "",
    "vendorFixDate": "2021-02-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0801",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-669"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25582",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0801/ranges"
            },
            {
                "rel": "reference",
                "href": "http://link-to-latest-stable-releases.com",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=570121808a76b85b2709502fb15618dd1e5296f1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=ca9ab8ea17748a1758701fde262cb272fb757989",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=f3f042d850baaeda1bed19e00c2b3b578644b7e9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-21:05.jail_chdir.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0801/default-remediation-status"
            }
        ]
    }
}