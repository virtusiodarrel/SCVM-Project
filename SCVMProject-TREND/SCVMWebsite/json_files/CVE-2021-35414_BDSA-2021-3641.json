{
    "source": "BDSA",
    "name": "BDSA-2021-3641",
    "title": "Chamilo Vulnerable to SQL Injection (SQLi) via 'Compilatio' Module and 'Sepe' Plugin",
    "description": "Chamilo contains multiple SQL injection (SQLi) vulnerabilities. These allow an unauthenticated attacker to execute SQL queries on instances that have either the \"Compilatio\" module enabled or have the \"Sepe\" plugin installed.",
    "technicalDescription": "Chamilo instances that have the \"Sepe\" plugin installed allow SQLi through the password field during the login initiation process. It should be noted that the plugin does not need to be enabled to allow the SQLi to occur. The \"Compilatio\" module allows unauthenticated attacker to execute SQL through the `doc` HTTP parameter used in `main/plagiarism/compilatio/upload.php`. Both SQLi vulnerabilities can be reached by unauthenticated attackers.",
    "publishedDate": "2021-12-06T11:39:09.966Z",
    "updatedDate": "2021-12-06T11:39:09.953Z",
    "disclosureDate": "2021-12-04T00:00:00.000Z",
    "exploitPublishDate": "2021-12-04T00:00:00.000Z",
    "solution": "Fixed in [**1.11.16-beta.1**](https://github.com/chamilo/chamilo-lms/releases/tag/v1.11.16-beta.1) by the following commits:\n\n* [Commit 1](https://github.com/chamilo/chamilo-lms/commit/36149c1ff99973840a809bb865f23e1b23d6df00).\n* [Commit 2](https://github.com/chamilo/chamilo-lms/commit/6a98e32bb04aa66cbd0d29ad74d7d20cc7e7e9c5).\n* [Commit 3](https://github.com/chamilo/chamilo-lms/commit/f398b5b45c019f873a54fe25c815dbaaf963728b).\n\nThe latest stable releases can be found [here](https://github.com/chamilo/chamilo-lms/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrej Spuler",
    "workaround": "",
    "vendorFixDate": "2021-05-13T00:00:00.000Z",
    "vendorNotifiedDate": "2021-05-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3641",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-35414",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3641/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/andrejspuler/writeups/tree/main/chamilo-lms#unauthenticated-sql-injection-2-in-plugin",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/andrejspuler/writeups/tree/main/chamilo-lms#unauthenticated-sql-injection-2-in-plugin",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/commit/19189a91d1eac9aa204b9439b82e3e73c8ac2e03",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/commit/36149c1ff99973840a809bb865f23e1b23d6df00",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/commit/6a98e32bb04aa66cbd0d29ad74d7d20cc7e7e9c5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/releases/tag/v1.11.16-beta.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://support.chamilo.org/projects/1/wiki/Security_issues#Issue-59-2021-05-13-High-impact-low-risk-Unauthenticated-SQL-injection-vulnerability-when-a-module-is-enabled",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://support.chamilo.org/projects/1/wiki/Security_issues#Issue-65-2021-05-15-High-impact-very-high-risk-Unauthenticated-SQL-injection-in-plugin",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3641/default-remediation-status"
            }
        ]
    }
}