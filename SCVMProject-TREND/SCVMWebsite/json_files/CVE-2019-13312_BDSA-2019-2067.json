{
    "source": "BDSA",
    "name": "BDSA-2019-2067",
    "title": "FFmpeg Vulnerable to Denial-of-Service (DoS) via Heap Buffer Over-Read in 'block_cmp()' Function",
    "description": "FFMpeg is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause a victim's instance of the application to crash by tricking them into running the program with a crafted file as input.",
    "technicalDescription": "The function `block_cmp()`, which is defined within the script `zmbvenc.c`, contains code that is used by FFmpeg in order to compare blocks of bytes; it does so by constructing a histogram denoting the frequency of byte values. This histogram is constructed using a nested `for` loop, which increases the value of the index variable `i`; this variable is used to access the values in the buffers `src` and `src2`. The outcome of the bitwise `OR` comparison between these two values is used as an index into the buffer `histogram`. Whenever certain input files are being processed, one of these index values can be such that the memory location that is accessed lies outside the boundaries of the buffer being examined. This could potentially constitute an illegal memory access operation, which will raise an exception and halt program execution. An attacker could therefore cause a victim's instance of the application to crash by tricking them into running the program with a crafted file as input.",
    "publishedDate": "2019-07-15T09:30:58.819Z",
    "updatedDate": "2020-07-29T10:17:16.062Z",
    "disclosureDate": "2019-06-30T00:00:00.000Z",
    "exploitPublishDate": "2019-06-30T00:00:00.000Z",
    "solution": "Fixed by [this](http://git.videolan.org/?p=ffmpeg.git;a=commit;h=def04022f4a7058f99e669bfd978d431d79aec18) commit in:\n* [**4.3.0**](https://ffmpeg.org/releases/) \n* [**4.2.2**](https://ffmpeg.org/releases/) \n* [**2.8.16**](https://ffmpeg.org/releases/) \n\n\nThe latest stable releases can be found [here](https://ffmpeg.org/download.html).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-10-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2067",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13312",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2067/ranges"
            },
            {
                "rel": "reference",
                "href": "http://git.videolan.org/?p=ffmpeg.git;a=commit;h=def04022f4a7058f99e669bfd978d431d79aec18",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://ffmpeg.org/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ffmpeg.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://trac.ffmpeg.org/ticket/7980",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://trac.ffmpeg.org/ticket/7980",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2067/default-remediation-status"
            }
        ]
    }
}