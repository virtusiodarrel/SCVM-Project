{
    "source": "BDSA",
    "name": "BDSA-2022-1142",
    "title": "cURL Vulnerable to OAUTH2 Bearer Bypass via Connection Reuse",
    "description": "cURL does not contain sufficient checks for authorization parameters that lead to unauthorized connection reuse. This could allow an attacker to reuse an existing connection to bypass the application's authentication mechanism.",
    "technicalDescription": "This vulnerability exists because the application allows connection reuse from a pool of created OAUTH2-authenticated connections. This leads to a new transfer request used with an existing connection to go through without validating if the request is using the same credentials. Thus, an existing connection created and authenticated using `user name + OAUTH2 bearer` could be reused with `user + [other/invalid OAUTH2 bearer]`. An attacker could exploit this flaw to bypass the application's authentication mechanism. This vulnerability affects SASL-enabled protocols: SMPTP(S), IMAP(S), POP3(S) and LDAP(S) (openldap only).\nThis issue has been fixed in `lib/url.c` file by introducing appropriate checks for `sasl_authzid` and `oauth_bearer` parameters. The use of a connection is disallowed when the values of these parameters don't match the expected values.",
    "publishedDate": "2022-04-26T13:18:25.531Z",
    "updatedDate": "2022-05-04T12:15:41.292Z",
    "disclosureDate": "2022-04-27T00:00:00.000Z",
    "solution": "Fixed in [**7.83.0**](https://github.com/curl/curl/releases/tag/curl-7_83_0) by [this](https://github.com/curl/curl/commit/852aa5ad351ea53e5f01d2f44b5b4370c2bf5425) commit.\n\nThe latest stable releases are available [here](https://github.com/curl/curl/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Patrick Monnerat",
    "workaround": "The vendor recommends setting the bearer string as password in addition to the normal mechanism when using OAUTH2 bearer authentication.",
    "vendorFixDate": "2022-04-25T00:00:00.000Z",
    "vendorNotifiedDate": "2022-03-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1142",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-305"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-22576",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1142/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2022-22576.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2022-22576.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/19a05c908f7d8b",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/852aa5ad351ea53e5f01d2f44b5b4370c2bf5425",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_83_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1142/default-remediation-status"
            }
        ]
    }
}