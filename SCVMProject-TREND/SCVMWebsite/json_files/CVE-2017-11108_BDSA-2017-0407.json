{
    "source": "BDSA",
    "name": "BDSA-2017-0407",
    "title": "tcpdump Vulnerable to Denial-of-Service (DoS) via Heap-Based Buffer Overflow in 'print-stp.c' File",
    "description": "A vulnerability exists in tcpdump which allows an attacker on the adjacent network to cause a denial-of-service condition by suppling a specially crafted packet.",
    "technicalDescription": "In the `stp_print()` function of `print-stp.c`, tcpdump attempts to dereference a pointer with a user-controlled address value, namely `mstp_len`, which is unpacked from the incoming packet.  The vulnerability arises due a failure to check whether or not the value can be extracted safely.  By using the `ND_TCHECK_16BITS` macro before dereferencing the pointer, this appears to fix the reported symptoms.\n\nIt has been suggested by the maintainer that the attacker would have to be on the same data link layer (i.e. the adjacent network) as the target component, and would have to have permission to send STP packets.  This would limit the exploitability of this vulnerability, but would not lessen it's impact.",
    "publishedDate": "2017-07-26T14:15:50.294Z",
    "updatedDate": "2022-07-18T14:41:25.743Z",
    "disclosureDate": "2017-07-07T00:00:00.000Z",
    "exploitPublishDate": "2017-07-07T00:00:00.000Z",
    "solution": "Fixed in version [**4.9.1**](https://github.com/the-tcpdump-group/tcpdump/releases/tag/tcpdump-4.9.1) by [this](https://github.com/the-tcpdump-group/tcpdump/commit/60c708bb926465d349f83a16978501913cae027d) commit.\n\nThe latest stable releases can be found [here](https://github.com/the-tcpdump-group/tcpdump/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.9,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 5.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.2
        },
        "vector": "(AV:A/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Team OWL337",
    "workaround": "",
    "vendorFixDate": "2017-07-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-0407",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-11108",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-0407/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1468504",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1468504",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/tcpdump/commit/60c708bb926465d349f83a16978501913cae027d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/tcpdump/issues/616",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/tcpdump/releases/tag/tcpdump-4.9.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/tcpdump/tags",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}