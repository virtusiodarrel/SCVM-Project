{
    "source": "BDSA",
    "name": "BDSA-2019-1730",
    "title": "Exim Vulnerable to Remote Command Execution (RCE) via 'deliver_message()' Function",
    "description": "Exim is vulnerable to remote command execution (RCE) due to the insufficient validation of client-provided input. A remote attacker could potentially execute arbitrary commands on the underlying operating system by supplying input which specifies a crafted recipient address.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "The function `deliver_message()`, which is defined within the script `deliver.c`, contains  code that is used during Exim's  delivery of a message, which is identified by the value associated with the `id` pointer variable. The execution flow of this function is affected by the boolean `DISABLE_EVENT` macro, which influences how the recipient email address is utilized by the program. If the `DISABLE_EVENT` condition is true, then the `expand_string()` function will be called with the recipient email address as a parameter (`new->address`). The data associated with the recipient email address is not validated. This function will perform expansion on its input parameters, and so an attacker can pass in a crafted email address containing a shell command which will be executed on the underlying operating system via the expansion process. The default value of the configuration variable  `deliver_drop_privilege` is `false`, by default, and so the injected commands will be executed with root privileges.\n\nAlthough earlier versions of Exim do not possess this vulnerability by default, it may be possible to introduce the vulnerability by enabling the `EXPERIMENTAL_EVENT` macro manually.",
    "publishedDate": "2019-06-12T10:28:39.747Z",
    "updatedDate": "2022-01-12T16:25:56.577Z",
    "disclosureDate": "2019-06-05T00:00:00.000Z",
    "exploitPublishDate": "2019-06-05T00:00:00.000Z",
    "solution": "Fixed in version [**4.92**](https://github.com/Exim/exim/releases/tag/exim-4.92) by [this](https://git.exim.org/exim.git/commitdiff/7ea1237c783e380d7bdb86c90b13d8203c7ecf26) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.6,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "(AV:N/AC:H/Au:N/C:C/I:C/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Qualys Research Labs",
    "workaround": "",
    "vendorFixDate": "2018-09-17T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1730",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10149",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1730/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.exim.org/exim.git/commitdiff/7ea1237c783e380d7bdb86c90b13d8203c7ecf26",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exim/exim/releases/tag/exim-4.92",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exim.org/static/doc/security/CVE-2019-10149.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2019/06/05/4",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1730/default-remediation-status"
            }
        ]
    }
}