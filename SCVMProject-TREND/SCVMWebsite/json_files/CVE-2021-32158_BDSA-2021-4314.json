{
    "source": "BDSA",
    "name": "BDSA-2021-4314",
    "title": "Webmin Vulnerable to Remote Command Execution via Reflected Cross-Site Scripting (XSS) and Cross-Site Request Forgery (CSRF) through Upload and Download Feature",
    "description": "Webmin has a reflected cross-site scripting (XSS) and cross-site request forgery (CSRF) vulnerability due to an absence of correct parameter input validation. This could allow a remote attacker to inject malicious code and obtain a command shell on the server. The attacker could then execute arbitrary commands on the server.\n\n**Note:** this vulnerability only affects Webmin instances that were set up using the Perl installation script, which is mainly used on Windows systems. Although the Perl installation script is also available to Linux users, it is not used by default during regular installation procedures.",
    "technicalDescription": "The vulnerability exists due to the CSRF protection setting `referers_none` not being enabled if Perl-based (`setup.pl`) installation is used. This causes CSRF to be disabled site-wide, meaning multiple admin endpoints can be targeted to achieve remote code execution (RCE).\n\nThe attacker can exploit the reflected XSS vulnerability through the application's Upload and Download feature using the `/tunnel/link.cgi/` endpoint. Exploitation of this flaw will allow the attacker to include a malicious link on the server using the following form action: `updown/download.cgi`. This link will be passed to the server using a hidden input field during form submission. Subsequently, the link will be available at the following path: `/var/www/html/Mesh3l_Z0ldyck/webshell.php`\nTo actually exploit this vulnerability, the attacker can generate a URL that will create the malicious link. Then, the attacker can trick a victim into clicking on this crafted URL. Once the victim clicks on the link, the attacker can then obtain the command shell at `/var/www/html/Mesh3l_Z0ldyck/webshell.php`. Through the command shell, the attacker can execute malicious commands.\n\nThe issue was fixed by adding a statement in `setup.pl` that sets `referers_none=1` in the config file.",
    "publishedDate": "2022-04-12T08:36:26.716Z",
    "updatedDate": "2022-07-07T09:53:34.373Z",
    "disclosureDate": "2021-04-26T00:00:00.000Z",
    "exploitPublishDate": "2021-04-26T00:00:00.000Z",
    "solution": "Fixed in [**1.974**](https://github.com/webmin/webmin/releases/tag/1.974) by [this](https://github.com/webmin/webmin/commit/0c85e067df477fe4ace6e9447706ea488dc70a8d) commit.\n\nThe latest stable releases are available [here](https://www.webmin.com/download.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 9.3,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 8.6,
        "severity": "HIGH",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "(AV:N/AC:M/Au:N/C:C/I:C/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mesh3l_911 & Z0ldyck",
    "workaround": "The vulnerability can be mitigated by manually setting `referers_none=1` in the config.",
    "vendorFixDate": "2021-04-22T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4314",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32158",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4314/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Mesh3l911/CVE-2021-32158",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Mesh3l911/CVE-2021-32158",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webmin/webmin/commit/0c85e067df477fe4ace6e9447706ea488dc70a8d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webmin/webmin/commit/0c85e067df477fe4ace6e9447706ea488dc70a8d",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webmin/webmin/releases/tag/1.974",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.webmin.com/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4314/default-remediation-status"
            }
        ]
    }
}