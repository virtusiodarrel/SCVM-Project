{
    "source": "BDSA",
    "name": "BDSA-2018-5144",
    "title": "Rubygems Bundler Vulnerable to Arbitrary Code Execution via Insecure '/tmp' Directory Permissions",
    "description": "Rubygems Bundler is vulnerable to arbitrary code execution due to the utilization of an insecure directory. A local attacker could execute malicious code in the context of the application by writing malicious files to this directory.",
    "technicalDescription": "The function `tmp_home_path()`, which is defined within the file `bundler.rb`, will attempt to create a temporary directory within the user's home directory, which can be used to store library files. If the function is unable to create the directory within the user's home directory, it will instead create it under the `/tmp` directory. The new directory will be world-writable, meaning a local attacker could write malicious library files to this directory in order to achieve arbitrary code execution after the libraries have been loaded.",
    "publishedDate": "2020-06-19T15:24:31.677Z",
    "updatedDate": "2020-06-19T15:24:31.671Z",
    "disclosureDate": "2018-04-23T00:00:00.000Z",
    "solution": "Fixed in [**2.1.0-pre3**](https://github.com/rubygems/bundler/releases/tag/v2.1.0.pre.3) by [this](https://github.com/rubygems/bundler/commit/65cfebb041c454c246aaf32a177b0243915a9998) commit.\n\nThe latest stable releases can be found [here](https://github.com/rubygems/bundler/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-11-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5144",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-276"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3881",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5144/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1651826",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bundler/bundler/commit/02e7f67727b45",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rubygems/bundler/commit/65cfebb041c454c246aaf32a177b0243915a9998",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rubygems/bundler/issues/6501",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rubygems/bundler/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5144/default-remediation-status"
            }
        ]
    }
}