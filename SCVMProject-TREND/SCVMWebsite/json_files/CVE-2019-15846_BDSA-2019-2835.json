{
    "source": "BDSA",
    "name": "BDSA-2019-2835",
    "title": "Exim Vulnerable to Execution of Programs wIth Root Privileges via Heap-Based Buffer overflow in Exim Mail Transport Agent",
    "description": "Exim is vulnerable to a local or remote attacker being able to execute programs with root privileges. This is due to a buffer overflow in the mail transport agent and could allow an attacker to execute arbitrary code with root privileges.",
    "technicalDescription": "This heap-based buffer overflow vulnerability exists in the TLS negotiation code of the Exim mail transport agent and affects any Exim installation that accepts TLS connections. Depending on Exim's configuration it is either exploitable using a crafted Server Name Indication (SNI), or using a crafted client TLS certificate.\n\nThis vulnerability is triggered when SNI headers containing a trailing slash followed by a Null character are read from the spool. This is because, the `string_unprinting()` and `string_interpret_escape()` functions  in `src/src/exim_dbmbuild.c` and `src/src/string.c`  respectively, do not handle trailing backslash characters followed by a Null byte correctly.  This sequence of characters can occur  due to the `string_printing()` function escaping characters with backslashes, but will not escape the backslash itself.  The output from `string_printing()` can be passed to either vulnerable function.  This will result in out-of-bounds access with an attacker being able to read and write memory.  This can be used to achieve remote code execution.",
    "publishedDate": "2019-09-05T09:52:04.044Z",
    "updatedDate": "2019-09-13T15:26:27.320Z",
    "disclosureDate": "2019-09-06T00:00:00.000Z",
    "exploitPublishDate": "2019-08-19T00:00:00.000Z",
    "solution": "Fixed in [**4.92.2**](https://github.com/Exim/exim/releases/tag/exim-4.92.2) by [this](https://github.com/Exim/exim/commit/2600301ba6dbac5c9d640c87007a07ee6dcea1f4) commit .",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 10.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 10.0,
        "severity": "HIGH",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "(AV:N/AC:L/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Zerons, Qualys",
    "workaround": "The vendor states that a mitigation is available:\n\nAdd - as part of the mail ACL (the ACL referenced by the main config option \"acl_smtp_mail\"):\n\n`deny    condition = ${if eq{\\\\}{${substr{-1}{1}{$tls_in_sni}}}}`\n`deny    condition = ${if eq{\\\\}{${substr{-1}{1}{$tls_in_peerdn}}}}`\n\nThis should prevent the currently known attack vector.",
    "vendorFixDate": "2019-08-19T00:00:00.000Z",
    "vendorNotifiedDate": "2019-07-21T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2835",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-250"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15846",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2835/ranges"
            },
            {
                "rel": "reference",
                "href": "http://exim.org/static/doc/security/CVE-2019-15846.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exim/exim/commit/2600301ba6dbac5c9d640c87007a07ee6dcea1f4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exim/exim/commit/c3aefacc72991f4960486052775ab47cd83c5fae",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exim/exim/commit/c3aefacc72991f4960486052775ab47cd83c5fae",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exim/exim/releases/tag/exim-4.92.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q3/192",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2835/default-remediation-status"
            }
        ]
    }
}