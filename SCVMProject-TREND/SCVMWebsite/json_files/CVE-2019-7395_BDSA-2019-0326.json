{
    "source": "BDSA",
    "name": "BDSA-2019-0326",
    "title": "ImageMagick Vulnerable to Denial-of-Service (DoS) via Memory Leak in 'WritePSDChannel' Function",
    "description": "ImageMagick is vulnerable to denial- of-service (DoS) as it fails to sufficiently track and release memory during PSD file parsing. An attacker could leverage this flaw by supplying a crafted image to an application that makes use of ImageMagick or by tricking a user into doing so. Parsing malformed images can lead to excessive memory allocation and a crash.",
    "technicalDescription": "The flaws lie in the `WritePSDChannel()` function of the `coders/psd.c` source file. \n\nThe vulnerable function does not sufficiently track the usage of the `compressed_pixels` variable. Whenever the condition `if (deflateInit(&stream,level) != Z_OK)` is satisfied and the function returns, `compressed_pixels` is not passed to a caller function or released. \n\nThis memory leak can be leveraged by an attacker to allocate excessive amounts of memory which may degrade the performance of the underlying host or cause application crash.",
    "publishedDate": "2019-02-05T16:45:10.446Z",
    "updatedDate": "2019-09-23T14:53:33.157Z",
    "disclosureDate": "2019-01-17T00:00:00.000Z",
    "solution": "Fixed in [**6.9.10-25**](https://github.com/ImageMagick/ImageMagick6/releases/tag/6.9.10-25) by [this](https://github.com/ImageMagick/ImageMagick6/commit/d646562fbfb8bd230879fef7d67a62bf28bb1e19) commit.\n\nFixed in [**7.0.8-25**](https://github.com/ImageMagick/ImageMagick/releases/tag/7.0.8-25) by [this](https://github.com/ImageMagick/ImageMagick/commit/8a43abefb38c5e29138e1c9c515b313363541c06) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Bingchang Liu at VARAS of IIE",
    "workaround": "",
    "vendorFixDate": "2019-01-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0326",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-401"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-7395",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0326/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick/commit/8a43abefb38c5e29138e1c9c515b313363541c06",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick/issues/1451",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick/releases/tag/7.0.8-25",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick6/commit/d646562fbfb8bd230879fef7d67a62bf28bb1e19",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImageMagick/ImageMagick6/releases/tag/6.9.10-25",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0326/default-remediation-status"
            }
        ]
    }
}