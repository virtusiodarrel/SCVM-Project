{
    "source": "BDSA",
    "name": "BDSA-2021-3720",
    "title": "Multiple Mozilla Products Vulnerable to Spoofing Attacks via Race Condition in Notification Code",
    "description": "Mozilla Firefox, Firefox ESR and Thunderbird are vulnerable to spoofing attacks. An attacker can take advantage of this by misusing  a race condition in the notification code.",
    "technicalDescription": "This vulnerability exists due to mishandling of notifications for pages in `browser/base/content/browser-fullScreenAndPointerLock.js`. This can allow an attacker to exploit a race condition in order to forcefully hide the notification for pages that had received full screen and pointer lock access. This can subsequently allow the attacker to carry out spoofing attacks.",
    "publishedDate": "2021-12-09T15:10:03.651Z",
    "updatedDate": "2022-05-30T13:54:57.561Z",
    "disclosureDate": "2021-12-07T00:00:00.000Z",
    "solution": "Fixed in Firefox [**95.0**](https://ftp.mozilla.org/pub/firefox/releases/95.0/) by [this](https://hg.mozilla.org/releases/mozilla-release/rev/1734250057491ebde43ada6f5fcb0e638cb95f2c) revision. \n\nFixed in Firefox ESR [**91.4.0**](https://ftp.mozilla.org/pub/firefox/releases/91.4.0esr/) by [this](https://hg.mozilla.org/releases/mozilla-esr91/rev/d1924a4be37791315e2b3a94d558c7904a42e2de) revision.\n\nFixed in Thunderbird [**91.4.0**](https://archive.mozilla.org/pub/thunderbird/releases/91.4.0/).\n\nThe latest stable releases of Firefox and Firefox ESR are available [here](https://ftp.mozilla.org/pub/firefox/releases/).\n\nThe latest stable releases of Thunderbird are available [here](https://archive.mozilla.org/pub/thunderbird/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Irvan Kurniawan (@sourc7)",
    "workaround": "",
    "vendorFixDate": "2021-12-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-3720",
        "links": [
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-43538",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-3720/ranges"
            },
            {
                "rel": "reference",
                "href": "https://archive.mozilla.org/pub/thunderbird/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://archive.mozilla.org/pub/thunderbird/releases/91.4.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/91.4.0esr/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/95.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-esr91/rev/d1924a4be37791315e2b3a94d558c7904a42e2de",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/1734250057491ebde43ada6f5fcb0e638cb95f2c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-52/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-53/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-54/",
                "label": "ADVISORY"
            }
        ]
    }
}