{
    "source": "BDSA",
    "name": "BDSA-2020-1658",
    "title": "OCS Inventory NG Vulnerable to Remote Command Execution (RCE) via Unescaped Shell Command with Attacker Supplied Input to 'get_mib_oid' Function",
    "description": "OCS Inventory NG is vulnerable by not escaping attacker controlled input to an executed shell command. A remote authenticated attacker could leverage this flaw to execute arbitrary shell commands on the server.",
    "technicalDescription": "Function `get_mib_oid()` of file `require/commandLine/CommandLine.php` fails to escape the command (that contains attacker controlled input) for shell metacharacters. This allows the attacker to execute arbitrary system commands with the privileges of the running process. The attacker can trigger the vulnerability through a HTTP POST request to the `/index.php?function=SNMP_config` endpoint.",
    "publishedDate": "2020-07-14T16:16:04.033Z",
    "updatedDate": "2020-11-03T13:54:08.483Z",
    "disclosureDate": "2020-06-05T00:00:00.000Z",
    "exploitPublishDate": "2020-06-05T00:00:00.000Z",
    "solution": "Fixed in [**2.8**](https://github.com/OCSInventory-NG/OCSInventory-ocsreports/releases/tag/2.8) by [this](https://github.com/OCSInventory-NG/OCSInventory-ocsreports/commit/da72e0fddaeceee44fbbd7241e07e5d53d1eee64) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Askar (@mohammadaskar2)",
    "workaround": "",
    "vendorFixDate": "2020-07-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1658",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14947",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1658/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gist.github.com/mhaskar/233436d3096d4a7beafe36ff61dc2c73",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OCSInventory-NG/OCSInventory-ocsreports/commit/da72e0fddaeceee44fbbd7241e07e5d53d1eee64",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OCSInventory-NG/OCSInventory-ocsreports/releases/tag/2.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://shells.systems/ocs-inventory-ng-v2-7-remote-command-execution-cve-2020-14947/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1658/default-remediation-status"
            }
        ]
    }
}