{
    "source": "BDSA",
    "name": "BDSA-2021-4163",
    "title": "Roundcube Webmail Vulnerable to SQL Injection (SQLi) via 'search' and 'search_params' Parameters",
    "description": "Roundcube Webmail is vulnerable to SQL injection (SQLi) due to improper validation of user supplied input. This could allow an attacker to input malicious or crafted statements to execute commands that may interfere with the databases associated with the application.",
    "technicalDescription": "The files that are vulnerable are:\n* ` addressbook/export.inc`\n* `addressbook/func.inc`\n* `addressbook/search.inc`\n* ` mail/list_contacts.inc`\n* `mail/search_contacts.inc`\n\nThe `search` and `search_params` parameters are vulnerable to SQL Injection (SQLi). This has been mitigated by renaming these variable names to `contact_search` and `contact_search_params` to prevent potential conflicts in session item names.",
    "publishedDate": "2022-03-02T13:38:23.189Z",
    "updatedDate": "2022-03-02T13:38:23.175Z",
    "disclosureDate": "2021-11-27T00:00:00.000Z",
    "solution": "Fixed in version [**1.3.17**](https://github.com/roundcube/roundcubemail/releases/tag/1.3.17) by [this](https://github.com/roundcube/roundcubemail/commit/ee809bde2dcaa04857a919397808a7296681dcfa) commit and version  [**1.4.12**](https://github.com/roundcube/roundcubemail/releases/tag/1.4.12) by [this](https://github.com/roundcube/roundcubemail/commit/c8947ecb762d9e89c2091bda28d49002817263f1) commit.\n\nThe latest stable releases can be found [here](https://github.com/roundcube/roundcubemail/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Guilhem Moulin",
    "workaround": "",
    "vendorFixDate": "2021-09-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4163",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-44026",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4163/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/commit/c8947ecb762d9e89c2091bda28d49002817263f1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/commit/ee809bde2dcaa04857a919397808a7296681dcfa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/releases/tag/1.3.17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/roundcube/roundcubemail/releases/tag/1.4.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NDVGIZMQJ5IOM47Y3SAAJRN5VPANKTKO/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.debian.org/security/2021/dsa-5013",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4163/default-remediation-status"
            }
        ]
    }
}