{
    "source": "BDSA",
    "name": "BDSA-2022-1029",
    "title": "GeoTools Vulnerable to Remote Code Execution (RCE) via Deserialization of Untrusted JNDI Lookup Data",
    "description": "GeoTools contains deserialization of untrusted data, improper input validation and Uncontrolled Resource Consumption vulnerabilities. An authenticated attacker can successfully exploit this via crafted input that could lead to the execution arbitrary code against the target system.",
    "technicalDescription": "The vulnerability exists due to improper input validation when performing a `JNDI` lookup. This can be exploited to perform class deserialization which may lead to arbitrary code execution.\n\nThis has been mitigated by restricting the lookups in the fixed releases.",
    "publishedDate": "2022-04-14T13:57:48.867Z",
    "updatedDate": "2022-08-23T11:27:39.847Z",
    "disclosureDate": "2022-04-13T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**26.4**](https://github.com/geotools/geotools/releases/tag/26.4) by [this](https://github.com/geotools/geotools/commit/4f70fa3234391dd0cda883a20ab0ec75688cba49) commit.\n* [**25.6**](https://github.com/geotools/geotools/releases/tag/25.6) by [this](https://github.com/geotools/geotools/commit/a1e94eb28debc0396db46528207b5eeb6b7cd02f) commit.\n* [**24.6**](https://github.com/geotools/geotools/releases/tag/24.6) by [this](https://github.com/geotools/geotools/commit/bbf32a90829ea09cf2c8d692f3bc7b9e7ab6ee9a) commit.\n\nThe latest stable releases can be found [here](https://github.com/geotools/geotools/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Jody Garnett, mbadanoiu, Andrea Aime",
    "workaround": "The vendor has issued the following workaround:\nThe downstream application should not allow usage of remotely provided JNDI strings. For example, in GeoServer, make the GUI (geoserver/web) and the REST configuration (geoserver/rest) unreachable from remote hosts.",
    "vendorFixDate": "2022-04-11T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1029",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24818",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1029/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geotools/geotools/commit/4f70fa3234391dd0cda883a20ab0ec75688cba49",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geotools/geotools/commit/a1e94eb28debc0396db46528207b5eeb6b7cd02f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geotools/geotools/commit/bbf32a90829ea09cf2c8d692f3bc7b9e7ab6ee9a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geotools/geotools/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geotools/geotools/releases/tag/24.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geotools/geotools/releases/tag/25.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geotools/geotools/releases/tag/26.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geotools/geotools/security/advisories/GHSA-jvh2-668r-g75x",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geotools/geotools/security/advisories/GHSA-jvh2-668r-g75x",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1029/default-remediation-status"
            }
        ]
    }
}