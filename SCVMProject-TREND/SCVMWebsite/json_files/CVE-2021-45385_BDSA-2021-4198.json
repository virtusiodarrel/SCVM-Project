{
    "source": "BDSA",
    "name": "BDSA-2021-4198",
    "title": "ffjpeg Vulnerable to Denial-of-Service (DoS) via Null Pointer Dereference in 'jfif_encode()' Function",
    "description": "ffjpeg is vulnerable to denial-of-service (DoS) due to the improper handling of system memory resources. An attacker can exploit this flaw by tricking a user in to loading a crafted over sized `.bmp` file.",
    "technicalDescription": "The vulnerability exists in the file `src/ffjpeg.c` where the function `jfif_encode()` is called within `main()`. If an over sized `bmp` file is loaded to the application, a `NULL` dereference condition can occur due to insufficient checks on the size of the `bmp` file. A `NULL` value would then be passed to the `jfif_encode()` function as the `pb->pdata` buffer is not initialized resulting in an application crash as it tries to access an invalid memory address.\n \nThis has been mitigated through implementing validation on the pointer reference to ensure that the file that is loaded to the application is within the size range. A check is performed to see if the address that is being referenced does not exist `if (bmp_load(&bmp, argv[2]) == -1)` and if this comparison is true, the program will exit.",
    "publishedDate": "2022-03-10T11:22:17.561Z",
    "updatedDate": "2022-03-10T11:22:17.540Z",
    "disclosureDate": "2021-12-16T00:00:00.000Z",
    "exploitPublishDate": "2021-12-16T00:00:00.000Z",
    "solution": "Fixed in the **master** branch by [this](https://github.com/rockcarry/ffjpeg/commit/caade60a69633d74100bd3c2528bddee0b6a1291) commit.\n\nThe latest stable commits can be found [here](https://github.com/rockcarry/ffjpeg/commits/master).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Marsman1996",
    "workaround": "",
    "vendorFixDate": "2021-12-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4198",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-476"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-45385",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4198/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rockcarry/ffjpeg",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rockcarry/ffjpeg/commit/caade60a69633d74100bd3c2528bddee0b6a1291",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rockcarry/ffjpeg/commits/master",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rockcarry/ffjpeg/issues/47",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rockcarry/ffjpeg/issues/47",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rockcarry/ffjpeg/pull/48",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4198/default-remediation-status"
            }
        ]
    }
}