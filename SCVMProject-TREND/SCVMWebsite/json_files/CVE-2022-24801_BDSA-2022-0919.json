{
    "source": "BDSA",
    "name": "BDSA-2022-0919",
    "title": "Twisted Web Vulnerable to HTTP Request Smuggling via Improper HTTP Request Parsing due to Insufficient Validation",
    "description": "Twisted Web allows parsing of HTTP requests without validating that they conform to `RFC 7230` standard. If multiple HTTP parsers are involved, a desynchronization could happen because of this non-conformance. An attacker could exploit this flaw and smuggle in malicious HTTP requests.\n\n**Note** This vulnerability only affects Twisted Web's HTTP 1.1 server/proxy.",
    "technicalDescription": "This vulnerability exists because the application does not correctly validate incoming HTTP requests to check if they conform to `RFC 7230` standard. This could allow an attacker to have malicious HTTP requests parsed by the application. For instance, the attacker could set the prefix for the `Content-Length` header value as either `+` or `-`. Or, they could use illegal characters like `\\n` in chunked extensions. If such requests are parsed by other HTTP parsers, it could lead to HTTP request smuggling. The vendor states that this vulnerability depends on the configuration of the other parsers. The vendor has also identified some versions of Apache Traffic Server and HAProxy are affected by this vulnerability.\n\nThis issue has been fixed in `src/twisted/web/http.py` file by implementing validation measures for incoming HTTP requests so that they conform to `RFC 7230` standard.\n\n**Note** This vulnerability only affects  Twisted Web's HTTP 1.1 server/proxy. It does not affect Twisted Web client and HTTP 2.0 server.",
    "publishedDate": "2022-04-05T14:24:05.265Z",
    "updatedDate": "2022-04-05T14:24:05.252Z",
    "disclosureDate": "2022-04-04T00:00:00.000Z",
    "solution": "Fixed in version [**22.4.0rc1**](https://github.com/twisted/twisted/releases/tag/twisted-22.4.0rc1) by [this](https://github.com/twisted/twisted/commit/592217e951363d60e9cd99c5bbfd23d4615043ac) commit.\n\nThe latest stable releases can be found [here](https://github.com/twisted/twisted/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Zhang Zeyu, Tom Most, Jean-Paul Calderone",
    "workaround": "The vendor has specified the following workarounds to address this vulnerability:\n* Vulnerabilities in any upstream proxies should be addressed.\n* Malicious requests should be filtered through other means such as upstream proxy configurations.",
    "vendorFixDate": "2022-04-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0919",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24801",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0919/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/twisted/twisted/commit/592217e951363d60e9cd99c5bbfd23d4615043ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/twisted/twisted/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/twisted/twisted/releases/tag/twisted-22.4.0rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/twisted/twisted/security/advisories/GHSA-c2jg-hw38-jrqq",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/twisted/twisted/security/advisories/GHSA-c2jg-hw38-jrqq",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0919/default-remediation-status"
            }
        ]
    }
}