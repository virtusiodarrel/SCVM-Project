{
    "source": "BDSA",
    "name": "BDSA-2022-1028",
    "title": "GeoServer Vulnerable to Remote Code Execution (RCE) via Deserialization of Untrusted JNDI Lookup Data",
    "description": "GeoServer contains deserialization of untrusted data, improper input validation and Uncontrolled Resource Consumption vulnerabilities. An authenticated attacker with 'admin' rights, can successfully exploit this via crafted input that could lead to the execution arbitrary code against the target system.",
    "technicalDescription": "The vulnerability exists due to improper input validation in the `src/web/security/jdbc/src/main/java/org/geoserver/security/web/jdbc/JDBCConnectionPanel.java` file within the `test()` function when performing a `JNDI` lookup. This can be exploited to perform class deserialization which may lead to arbitrary code execution.\n\nThis has been mitigated by restricting the lookups.",
    "publishedDate": "2022-04-14T12:10:06.045Z",
    "updatedDate": "2022-08-26T10:46:21.191Z",
    "disclosureDate": "2022-04-13T00:00:00.000Z",
    "solution": "Fixed in version [**2.20.4**](https://github.com/geoserver/geoserver/releases/tag/2.20.4) by [this](https://github.com/geoserver/geoserver/commit/f3028095d6881d3b2f500a20901de4baf1085811) commit and version [**2.19.6**](https://github.com/geoserver/geoserver/releases/tag/2.19.6) by [this](https://github.com/geoserver/geoserver/commit/b94a69943992df999d627b21a4ed056fad4569f8) commit.\n\nThe latest stable releases can be found [here](https://github.com/geoserver/geoserver/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "jodygarnett",
    "workaround": "The vendor has recommended the following workaround:\nProtection can be achieved by making the GUI (`geoserver/web`), the REST configuration (`geoserver/rest`) and the embedded GeoWebCache configuration (`geoserver/gwc/rest`) unreachable from remote hosts, in addition to protecting access to the file system where the GeoServer configuration is stored.",
    "vendorFixDate": "2022-04-11T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1028",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24847",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1028/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geoserver/geoserver/commit/89284fd92eb6fd4804eda8f8818d779e3d36c4ef",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geoserver/geoserver/commit/b94a69943992df999d627b21a4ed056fad4569f8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geoserver/geoserver/commit/f3028095d6881d3b2f500a20901de4baf1085811",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geoserver/geoserver/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geoserver/geoserver/releases/tag/2.19.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geoserver/geoserver/releases/tag/2.20.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geoserver/geoserver/security/advisories/GHSA-4pm3-f52j-8ggh",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/geoserver/geoserver/security/advisories/GHSA-4pm3-f52j-8ggh",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1028/default-remediation-status"
            }
        ]
    }
}