{
    "source": "BDSA",
    "name": "BDSA-2020-3580",
    "title": "Eclipse Jetty Vulnerable to HTTP Data Injection via  GZIP Request Body Inflation",
    "description": "Eclipse Jetty contains a vulnerability that allows a remote attacker to inject data into other client's requests. This vulnerability only exists when GZIP request body inflation is enabled, and requests from different clients are multiplexed onto a single connection.",
    "technicalDescription": "This vulnerability is due to a buffer not being correctly recycled during GZIP request inflation. This means that if an application is using Eclipse Jetty,  GZIP request body inflation is enabled, and requests from different clients are multiplexed onto a single connection, a remote attacker can send a request with a body that will be received, but not fully consumed by Jetty. The remaining data from the body will be prepended onto the next request.",
    "publishedDate": "2020-11-30T14:56:44.110Z",
    "updatedDate": "2021-02-10T11:25:12.793Z",
    "disclosureDate": "2020-11-28T00:00:00.000Z",
    "solution": "Fixed in **[9.4.35.v20201120](https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.35.v20201120)** by [this](https://github.com/eclipse/jetty.project/commit/850a0330ff25da42b1b1cbdbdca0fcc0c40e47e9) commit.\n\nFixed in **[10.0.0.beta3](https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.0.beta3)** and in **[11.0.0.beta3](https://github.com/eclipse/jetty.project/releases/tag/jetty-11.0.0.beta3)** by [this](https://github.com/eclipse/jetty.project/commit/34d27e85483c119b7dd1aa9beda735844d14b605) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andi, Peter",
    "workaround": "The vendor states that any of the following will mitigate this vulnerability:\n\n\n> * Disabling compressed request body inflation by GzipHandler.\n> * By always fully consuming the request content before sending a response.\n> * By adding a Connection: close to any response where the servlet does not fully consume request content.",
    "vendorFixDate": "2020-11-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3580",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-226"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27218",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3580/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.eclipse.org/bugs/show_bug.cgi?id=568892",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/commit/34d27e85483c119b7dd1aa9beda735844d14b605",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/commit/850a0330ff25da42b1b1cbdbdca0fcc0c40e47e9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.0.beta3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-11.0.0.beta3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.35.v20201120",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/security/advisories/GHSA-86wm-rrjm-8wh8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/security/advisories/GHSA-86wm-rrjm-8wh8",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3580/default-remediation-status"
            }
        ]
    }
}