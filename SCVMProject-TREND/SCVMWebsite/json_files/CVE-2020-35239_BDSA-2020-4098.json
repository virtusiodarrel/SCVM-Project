{
    "source": "BDSA",
    "name": "BDSA-2020-4098",
    "title": "CakePHP Vulnerable to Cross-Site Request Forgery (CSRF) via 'CsrfProtectionMiddleware' Component",
    "description": "CakePHP contains a  vulnerability to cross-site request forgery (CSRF) attacks. This allows a remote attacker to craft links or web content that, if clicked on by an authenticated victim, can be used to perform actions on their behalf.",
    "technicalDescription": "This vulnerability exists in the `CsrfProtectionMiddleware` component in the `src/Routing/Route/Route.php` file. This is due to the method override parameters bypassing cross-site request forgery (CSRF) checks. Attackers could exploit this using maliciously crafted HTTP requests to use the victim's authenticated session to perform unwanted actions. The vendor addressed this by implementing validation so that the HTTP method override is a valid HTTP method name.",
    "publishedDate": "2021-01-21T17:17:01.608Z",
    "updatedDate": "2021-01-21T17:17:01.600Z",
    "disclosureDate": "2020-12-07T00:00:00.000Z",
    "solution": "Fixed in [**4.0.10**](https://github.com/cakephp/cakephp/releases/tag/4.0.10) by [this](https://github.com/cakephp/cakephp/commit/d2da5346a6cddab284f8cf94e38f90d897595fe8) commit.\n\nFixed in [**4.1.4**](https://github.com/cakephp/cakephp/releases/tag/4.1.4) by [this](https://github.com/cakephp/cakephp/commit/9e0802f3e4d22bf1fb4d26f0b23a3dec94f0c4b7) commit.\n\nThe latest stable releases are available [here](https://github.com/cakephp/cakephp/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.3,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Xhelal Likaj",
    "workaround": "",
    "vendorFixDate": "2020-12-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4098",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-35239",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4098/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bakery.cakephp.org/2020/12/07/cakephp_4010_released.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/commit/9e0802f3e4d22bf1fb4d26f0b23a3dec94f0c4b7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/commit/d2da5346a6cddab284f8cf94e38f90d897595fe8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/releases/tag/4.0.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/releases/tag/4.1.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4098/default-remediation-status"
            }
        ]
    }
}