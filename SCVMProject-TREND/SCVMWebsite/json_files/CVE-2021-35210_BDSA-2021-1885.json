{
    "source": "BDSA",
    "name": "BDSA-2021-1885",
    "title": "Contao Vulnerable to Stored Cross Site Scripting via the `tl_log` table",
    "description": "Contao is vulnerable to stored cross-site scripting (XSS) due to improper validation of user-supplied input. This could allow an attacker to include malicious JavaScript in the system log to be executed in a victim's browser, which could be used to steal session tokens, cookies, or other sensitive information.",
    "technicalDescription": "This vulnerability exists due to insufficient validation in the `tl_log` table of the system log of Contao. An unauthenticated attacker can take advantage of this in order to include malicious JavaScript in the system log, which will subsequently be executed in a victims browser when the system log is called in the back end.",
    "publishedDate": "2021-06-23T15:07:18.772Z",
    "updatedDate": "2021-06-23T15:07:18.767Z",
    "disclosureDate": "2021-06-23T00:00:00.000Z",
    "solution": "Fixed in [**4.9.16**](https://github.com/contao/contao/releases/tag/4.9.16) and [**4.11.5**](https://github.com/contao/contao/releases/tag/4.11.5).\n\nThe latest stable releases are available [here](https://contao.org/en/download.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has [stated](https://contao.org/en/security-advisories/cross-site-scripting-in-the-system-log-2021.html) that a workaround is to disable the system log module in the back end for all users (especially admin users).",
    "vendorFixDate": "2021-06-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1885",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-35210",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1885/ranges"
            },
            {
                "rel": "reference",
                "href": "https://contao.org/en/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://contao.org/en/security-advisories/cross-site-scripting-in-the-system-log-2021.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://contao.org/en/security-advisories/cross-site-scripting-in-the-system-log-2021.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/releases/tag/4.11.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/releases/tag/4.9.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1885/default-remediation-status"
            }
        ]
    }
}