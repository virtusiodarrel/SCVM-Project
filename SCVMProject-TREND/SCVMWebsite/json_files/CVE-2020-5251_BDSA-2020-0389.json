{
    "source": "BDSA",
    "name": "BDSA-2020-0389",
    "title": "Parse Server Vulnerable to Improper Authorization via Improper Input Validation of Regular Expressions",
    "description": "Parse Server is vulnerable to improper authorization due to improper input validation of user controlled input. An attacker could exploit this vulnerability to retrieve information on valid user accounts, confirm an account with any email address or confirm a password reset for any users account.",
    "technicalDescription": "The `handleParseHeaders()` function in `src/middlewares.js` does not ensure the `_SessionToken` parameter valid is of an appropriate type before processing the data, allowing an attacker to use `$regex` to retrieve data regarding any account.\n\nThe `verifyEmail()`, `requestResetPassword()` and `resetPassword()` functions in `src/Routers/PublicAPIRouter.js` do not ensure the `token` parameter is of an appropriate type before processing the data, allowing an attacker to alter the parameter to `token[$regex]` and the value to various letters and numbers to be able to verify an account with any email or reset any accounts password without sufficient privileges.",
    "publishedDate": "2020-03-06T17:11:48.156Z",
    "updatedDate": "2020-03-06T17:11:48.146Z",
    "disclosureDate": "2020-03-03T00:00:00.000Z",
    "exploitPublishDate": "2020-03-03T00:00:00.000Z",
    "solution": "Fixed in version [**4.1.0**](https://github.com/parse-community/parse-server/releases/tag/4.1.0) by [this](https://github.com/parse-community/parse-server/commit/3a3a5eee5ffa48da1352423312cb767de14de269) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "W0lfw00d",
    "workaround": "",
    "vendorFixDate": "2020-03-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0389",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5251",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0389/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/3a3a5eee5ffa48da1352423312cb767de14de269",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases/tag/4.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/security/advisories/GHSA-h4mf-75hf-67w4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/security/advisories/GHSA-h4mf-75hf-67w4",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0389/default-remediation-status"
            }
        ]
    }
}