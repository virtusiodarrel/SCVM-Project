{
    "source": "BDSA",
    "name": "BDSA-2022-0420",
    "title": "Linux Kernel Vulnerable to Stack-Based Buffer Overflow via Networking Module TIPC Protocol Implementation",
    "description": "The Linux Kernel is vulnerable to a stack-based buffer overflow flaw in the networking module for the Transparent Inter-Process Communication (TIPC) protocol.\n\nA remote attacker could pretend to be a peer node and abuse this issue to cause a denial-of-service (DoS) or potentially perform a control flow hijack attack if stack canaries/KASLR are bypassed or absent.\n\n**Note**: The vulnerability reporter has stated [here](https://www.openwall.com/lists/oss-security/2022/02/10/1) that while the module is present in most major Linux distributions, it must first be loaded in order for this vulnerability to be exploited. For a remote exploitation, the target system needs to have a TIPC bearer set up already.",
    "technicalDescription": "The Linux Kernel is vulnerable to a stack-based buffer overflow issue in the TIPC functionality because the `tipc_mon_rcv()` function in the `net/tipc/monitor.c` file does not validate if the `member_cnt` value is below `MAX_MON_DOMAIN` (the maximum size of the `members` array). \n\nAn attacker could abuse the validation flaw by submitting a malicious domain record that contains an arbitrary payload, and then a follow-up record to cause the previous one to be copied, triggering the stack overflow. This allows an attacker to overwrite the contents of the stack.",
    "publishedDate": "2022-02-11T13:58:19.745Z",
    "updatedDate": "2022-04-06T11:55:27.701Z",
    "disclosureDate": "2022-02-10T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.9.301**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.9.301) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=175db196e45d6f0e6047eccd09c8ba55465eb131) commit,\n* [**4.14.266**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.14.266) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fde4ddeadd099bf9fbb9ccbee8e1b5c20d530a2d) commit,\n* [**4.19.229**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.19.229) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f1af11edd08dd8376f7a84487cbb0ea8203e3a1d) commit,\n* [**5.4.179**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.4.179) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=d692e3406e052dbf9f6d9da0cba36cb763272529) commit,\n* [**5.10.100**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.10.100) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3c7e5943553594f68bbc070683db6bb6f6e9e78e) commit,\n* [**5.15.23**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.15.23) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1f1788616157b0222b0c2153828b475d95e374a7) commit,\n* [**5.16.9**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.16.9) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=59ff7514f8c56f166aadca49bcecfa028e0ad50f) commit,\n* [**5.17-rc4**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.17-rc4) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9aa422ad326634b76309e8ff342c246800621216) commit.\n\nThe latest stable releases are available [here](https://www.kernel.org).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Samuel Page, Eric Dumazet, Immunity Inc.",
    "workaround": "The vulnerability reporter has suggested [here](https://www.openwall.com/lists/oss-security/2022/02/10/1) that users who require TIPC and cannot apply the patch should try to enforce configurations that prevent or limit the ability for attackers to imitate nodes in the cluster. Options to do this include: TIPC protocol level encryption, IPSec/MACSec, network separation etc.",
    "vendorFixDate": "2022-02-10T00:00:00.000Z",
    "vendorNotifiedDate": "2022-01-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0420",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-0435",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0420/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=175db196e45d6f0e6047eccd09c8ba55465eb131",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1f1788616157b0222b0c2153828b475d95e374a7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3c7e5943553594f68bbc070683db6bb6f6e9e78e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=59ff7514f8c56f166aadca49bcecfa028e0ad50f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9aa422ad326634b76309e8ff342c246800621216",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=d692e3406e052dbf9f6d9da0cba36cb763272529",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f1af11edd08dd8376f7a84487cbb0ea8203e3a1d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fde4ddeadd099bf9fbb9ccbee8e1b5c20d530a2d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=35c55c9877f8de0ab129fa1a309271d0ecc868b9",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.14.266",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.19.229",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.9.301",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.10.100",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.15.23",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.16.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.17-rc4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.4.179",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2022/02/10/1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2022/02/10/1",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0420/default-remediation-status"
            }
        ]
    }
}