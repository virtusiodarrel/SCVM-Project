{
    "source": "BDSA",
    "name": "BDSA-2020-3560",
    "title": "Matrix Synapse Vulnerable to Denial-of-Service (DoS) via Invalid Event JSON Values",
    "description": "Matrix Synapse is vulnerable to denial-of-service (DoS) due to allowing invalid JavaScript Object Notation (JSON) data to be passed in events. The data could be relayed to Synapse's clients and cause them to crash or hang.",
    "technicalDescription": "This vulnerability was fixed by disabling Python extensions that support the parsing of `Infinity`, `-Infinity` and `NaN` JSON objects. Note that if an invalid event is accepted into a room state before upgrading to a newer version, the event has to be manually redacted to fix the issue.",
    "publishedDate": "2020-11-27T12:04:13.971Z",
    "updatedDate": "2020-11-27T12:04:13.966Z",
    "disclosureDate": "2020-11-23T00:00:00.000Z",
    "solution": "Fixed in **[1.20.0-rc3](https://github.com/matrix-org/synapse/releases/tag/v1.20.0rc3)** by the following commits:\n* [Commit 1](https://github.com/matrix-org/synapse/commit/eebf52be060876ff14bbcbbc86b64ff9965b3622)\n* [Commit 2](https://github.com/matrix-org/synapse/commit/b86764662b6058dc53dd7cef923b806dc28f3a53)\n* [Commit 3](https://github.com/matrix-org/synapse/commit/4dd27e6d1125df83a754b5e0c2c14aaafc0ce837)\n* [Commit 4](https://github.com/matrix-org/synapse/commit/dbc630a628e4fc6eb5eff09ce5edba062c0e9955)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Denis Kasak",
    "workaround": "",
    "vendorFixDate": "2020-09-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3560",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-26890",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3560/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/synapse/commit/4dd27e6d1125df83a754b5e0c2c14aaafc0ce837",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/synapse/commit/b86764662b6058dc53dd7cef923b806dc28f3a53",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/synapse/commit/dbc630a628e4fc6eb5eff09ce5edba062c0e9955",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/synapse/commit/eebf52be060876ff14bbcbbc86b64ff9965b3622",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/synapse/releases/tag/v1.20.0rc3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/synapse/security/advisories/GHSA-4mp3-385r-v63f",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3560/default-remediation-status"
            }
        ]
    }
}