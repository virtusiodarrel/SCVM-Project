{
    "source": "BDSA",
    "name": "BDSA-2021-2787",
    "title": "Keycloak Vulnerable to Brute Force Attacks via Incorrect Error Message",
    "description": "Keycloak is vulnerable to brute force attacks due to an incorrect error message. An attacker could exploit this in order to determine a user's credentials once the `Permanent Lockout` feature has been triggered.",
    "technicalDescription": "This issue occurs due to improper implementation of the `Permanent Lockout` feature. If an attacker keeps attempting to login after the feature has been triggered then the error message will indicate that the account has been disabled once the correct password has been entered. It was mitigated by the introduction of `isPermanentlyLockedOut()` within the `BruteForceProtector.java` file which is designed to remove any trace of an account which has been permanently locked out. A generic error message has also been introduced for instances where the user does not exist.",
    "publishedDate": "2021-09-15T15:41:56.471Z",
    "updatedDate": "2021-09-15T15:41:56.459Z",
    "disclosureDate": "2021-04-26T00:00:00.000Z",
    "solution": "Fixed in version [**13.0.0**](https://github.com/keycloak/keycloak/releases/tag/13.0.0) by [this](https://github.com/keycloak/keycloak/commit/315b9e3c2970145e03dfaaddc364d588c9ebf060) commit.\n\nThe latest stable releases can be found [here](https://github.com/keycloak/keycloak/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.4,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Micha\u0142 Knapik & Peter Nicholson (u2i)",
    "workaround": "",
    "vendorFixDate": "2021-05-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2787",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-522"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3513",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2787/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1953439",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/0cb6053699f0460bc827d29115f78ae7cd374b81",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/315b9e3c2970145e03dfaaddc364d588c9ebf060",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/pull/7976",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases/tag/13.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2787/default-remediation-status"
            }
        ]
    }
}