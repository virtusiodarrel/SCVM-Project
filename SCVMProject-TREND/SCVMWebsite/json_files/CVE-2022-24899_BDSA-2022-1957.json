{
    "source": "BDSA",
    "name": "BDSA-2022-1957",
    "title": "Contao Vulnerable to Reflected Cross-Site Scripting (XSS) via Unsanitized Canonical Tag",
    "description": "Contao is vulnerable to a reflected cross-site scripting (XSS) issue due to how the canonical tag is not sufficiently sanitized.\n\nAn attacker could trick a victim user into following a crafted link in order to execute malicious scripts in the context of the victim user's browser which could allow for information such as cookies to be stolen, or the rendering of the page to be tampered with.",
    "technicalDescription": "To remedy this issue, the vendor has updated the `prepare()` function in the `core-bundle/src/Resources/contao/pages/PageRegular.php` file to use the `htmlspecialchars()` PHP function when handling the user-supplied input from `getCanonicalUriForRequest()`.",
    "publishedDate": "2022-07-15T10:06:05.057Z",
    "updatedDate": "2022-07-15T10:13:47.528Z",
    "disclosureDate": "2022-05-05T00:00:00.000Z",
    "exploitPublishDate": "2022-05-05T00:00:00.000Z",
    "solution": "Fixed in [**4.13.3**](https://github.com/contao/contao/releases/tag/4.13.3) by [this](https://github.com/contao/contao/commit/199206849a87ddd0fa5cf674eb3c58292fd8366c) commit.\n\nThe latest stable releases are available [here](https://github.com/contao/contao/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "AggressiveUser",
    "workaround": "The vendor has suggested [here](https://github.com/contao/contao/security/advisories/GHSA-m8x6-6r63-qvj2) that users can disable canonical tags in the root page settings in order to mitigate this issue.",
    "vendorFixDate": "2022-05-05T00:00:00.000Z",
    "vendorNotifiedDate": "2022-04-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1957",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24899",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1957/ranges"
            },
            {
                "rel": "reference",
                "href": "https://contao.org/en/security-advisories/cross-site-scripting-via-canonical-url.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/commit/199206849a87ddd0fa5cf674eb3c58292fd8366c",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/commit/a48f31219bf45ab9f45b141e87edbac1eb9afc35",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/releases/tag/4.13.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/security/advisories/GHSA-m8x6-6r63-qvj2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/security/advisories/GHSA-m8x6-6r63-qvj2",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/df46e285-1b7f-403c-8f6c-8819e42deb80/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/df46e285-1b7f-403c-8f6c-8819e42deb80/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/50945",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1957/default-remediation-status"
            }
        ]
    }
}