{
    "source": "BDSA",
    "name": "BDSA-2021-3291",
    "title": "jose Vulnerable to Key Decryption via Padding Oracle Attack",
    "description": "jose is vulnerable to data decryption due to an observable timing discrepancy in the padding error checks. An attacker that is able to trigger `AES_CBC_HMAC_SHA2` decryption checks could use the timing difference between different errors to decrypt the data without the decryption key.",
    "technicalDescription": "During the decryption of `AES_CBC_HMAC_SHA2` algorithm, both HMAC tag verification and CBC decryption is performed. If either of them fails, `JWEDecryptionFailed` error is thrown. However, it is possible to discern padding errors by observing their timing during the decryption, which makes the errors work as a padding oracle. An attacker could submit multiple calls (128 times the size of ciphertext on average) to the padding oracle and decrypt the data without knowing the decryption key.\n\nThe vulnerability was fixed by ensuring that the HMAC tag is verified before performing CBC decryption.",
    "publishedDate": "2021-11-02T13:54:09.536Z",
    "updatedDate": "2021-11-02T14:15:58.846Z",
    "disclosureDate": "2021-04-15T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.11.4**](https://github.com/panva/jose/releases/tag/v3.11.4) by [this](https://github.com/panva/jose/commit/579485c) commit.\n* [**2.0.5**](https://github.com/panva/jose/releases/tag/v2.0.5) by [this](https://github.com/panva/jose/commit/812e03f) commit.\n* [**1.28.1**](https://github.com/panva/jose/releases/tag/v1.28.1) by [this](https://github.com/panva/jose/commit/08e1bc5) commit.\n\nThe latest stable releases can be found [here](https://github.com/panva/jose/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Morgan Brown, Microsoft",
    "workaround": "",
    "vendorFixDate": "2021-04-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3291",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-696"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29443",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3291/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/panva/jose/commit/08e1bc5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/panva/jose/commit/579485c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/panva/jose/commit/812e03f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/panva/jose/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/panva/jose/releases/tag/v1.28.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/panva/jose/releases/tag/v2.0.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/panva/jose/releases/tag/v3.11.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/panva/jose/security/advisories/GHSA-58f5-hfqc-jgch",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3291/default-remediation-status"
            }
        ]
    }
}