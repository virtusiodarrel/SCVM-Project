{
    "source": "BDSA",
    "name": "BDSA-2020-0128",
    "title": "SimpleSAMLphp Vulnerable to Cross-Site Scripting (XSS) via 'EMail' Class Template",
    "description": "SimpleSAMLphp is vulnerable to cross-site scripting (XSS) due to the improper sanitization of client-controlled input. A remote attacker could execute malicious scripts within the browser of a victim by tricking the victim into clicking on a crafted URI.",
    "technicalDescription": "The `EMail` class template, which is defined within `EMail.php`, contains a function called `generateBody()`. This function is used to generate the body of an email based on a hard-coded template. The script `erroreport.php` contains code that is used to generate and send error reports to the system administrator. This will create an email by using the `EMail` class template. This email will contain user-controlled data, which is referenced via the `$this->text` variable. This user-controlled data is not validated or sanitized prior to its insertion into the email. If the new user interface is not being used (which uses Twig templates with built-in sanitization), then an attacker could provide crafted input to the application in order to insert a malicious script into the email body. This could then be executed within the browser of the administrator who views the email. This could allow the attacker to obtain sensitive information, such as browser cookies.",
    "publishedDate": "2020-01-29T10:47:47.750Z",
    "updatedDate": "2020-01-29T10:47:47.739Z",
    "disclosureDate": "2020-01-24T00:00:00.000Z",
    "solution": "Fixed in [**1.18.4**](https://github.com/simplesamlphp/simplesamlphp/releases/tag/v1.18.4) by [this](https://github.com/simplesamlphp/simplesamlphp/commit/864f0392480317a6f44b0e3c26db23ad0e21e5fb) commit.\n\nThe latest stable release can be found [here](https://github.com/simplesamlphp/simplesamlphp/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.3
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Frederic Vleminckx",
    "workaround": "",
    "vendorFixDate": "2020-01-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0128",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5226",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0128/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/simplesamlphp/simplesamlphp/commit/864f0392480317a6f44b0e3c26db23ad0e21e5fb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/simplesamlphp/simplesamlphp/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/simplesamlphp/simplesamlphp/releases/tag/v1.18.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/simplesamlphp/simplesamlphp/security/advisories/GHSA-mj9p-v2r8-wf8w",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0128/default-remediation-status"
            }
        ]
    }
}