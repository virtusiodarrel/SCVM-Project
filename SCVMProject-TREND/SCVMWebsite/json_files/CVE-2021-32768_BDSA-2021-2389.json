{
    "source": "BDSA",
    "name": "BDSA-2021-2389",
    "title": "TYPO3 CMS Vulnerable to Cross-Site Scripting (XSS) via 'HTMLparser' Insufficient Sanitization of Rich-Text Content",
    "description": "TYPO3 CMS is vulnerable to a cross-site scripting (XSS) issue due to how the content rendering process in the frontend functionality does not sufficiently parse, sanitize and encode rich-text content.\n\nBy default, an attacker is required to control a valid backend user account to exploit this vulnerability. Where custom plugins that accept and reflect rich-text content submitted by users are used, authentication may not required. The malicious scripts could be used in order to manipulate webpages or steal information, such as cookies, from victim users who view the affected content.",
    "technicalDescription": "TYPO3 CMS is vulnerable to cross-site scripting (XSS) because the `HTMLparser` functionality does not consider all potentially malicious HTML tag and attribute combinations by default. \n\nTo remedy this issue, the vendor has introduced the use of the `typo3/html-sanitizer ` package which sanitizes and purges potential malicious scripts from markup during frontend rendering.",
    "publishedDate": "2021-08-11T15:57:04.816Z",
    "updatedDate": "2021-08-11T15:57:04.808Z",
    "disclosureDate": "2021-08-10T00:00:00.000Z",
    "solution": "Fixed in:\n* [**11.3.2**](https://github.com/TYPO3/typo3/releases/tag/v11.3.2) by [this](https://github.com/TYPO3/typo3/commit/216250a38dbd070b4f2ea1e74ca7228d4d8b70e2) commit,\n* [**10.4.19**](https://github.com/TYPO3/typo3/releases/tag/v10.4.19) by [this](https://github.com/TYPO3/typo3/commit/5a9f5927335338396898812ddf6b06a6802d8dec) commit,\n* [**9.5.29**](https://github.com/TYPO3/typo3/releases/tag/v9.5.29) by [this](https://github.com/TYPO3/typo3/commit/ac8f1fc3ac8c3e004e8730e0bd8144bd3209300f) commit.\n\nThe latest stable releases are available [here](https://get.typo3.org/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Benjamin Stiber, Gert-Jan Jansma, G\u00e1bor \u00c1cs-Kurucz, Alexander Kellner, Richie Lee, Nina R\u00f6sch",
    "workaround": "",
    "vendorFixDate": "2021-08-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2389",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32768",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2389/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.typo3.org/c/typo3/cms-core/master/en-us/Changelog/9.5.x/Important-94484-IntroduceHTMLSanitizer.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://get.typo3.org/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/typo3/commit/216250a38dbd070b4f2ea1e74ca7228d4d8b70e2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/typo3/commit/5a9f5927335338396898812ddf6b06a6802d8dec",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/typo3/commit/ac8f1fc3ac8c3e004e8730e0bd8144bd3209300f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/typo3/releases/tag/v10.4.19",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/typo3/releases/tag/v11.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/typo3/releases/tag/v9.5.29",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-core-sa-2021-013",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2389/default-remediation-status"
            }
        ]
    }
}