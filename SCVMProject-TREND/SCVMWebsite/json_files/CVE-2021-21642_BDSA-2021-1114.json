{
    "source": "BDSA",
    "name": "BDSA-2021-1114",
    "title": "Jenkins Config File Provider Plugin Vulnerable to XML External Entities (XXE) Attacks via Crafted Maven Configuration Files",
    "description": "Jenkins Config File Provider Plugin is vulnerable to XML external entities (XXE) attacks because it allows its XML parser to resolve external entities in imported XML files. An attacker could use a crafted Maven configuration file to exploit this vulnerability.",
    "technicalDescription": "This vulnerability mainly exists in the `src/main/java/org/jenkinsci/plugins/configfiles/maven/security/CredentialsHelper.java` file. This file allows external entity resolution for XML documents. This could allow an attacker to exploit this flaw using a crafted Maven configuration file that contains entity references to sensitive files. This can lead to disclosure of information like Jenkins controller secrets. Also, it could potentially allow the attacker to conduct a server-side request forgery (SSRF) attack. This issue was fixed by disabling external entity resolution with the following lines of code:\n```\ndocumentBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\ndocumentBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, \"\");\n```",
    "publishedDate": "2021-04-22T13:58:48.349Z",
    "updatedDate": "2021-09-08T11:55:05.755Z",
    "disclosureDate": "2021-04-21T00:00:00.000Z",
    "solution": "Fixed in [**3.7.1**](https://github.com/jenkinsci/config-file-provider-plugin/releases/tag/config-file-provider-3.7.1) by [this](https://github.com/jenkinsci/config-file-provider-plugin/commit/3fc07e611a52ff5940306388e51f0dd92cf7054f) commit.\n\nThe latest stable releases are available [here](https://github.com/jenkinsci/config-file-provider-plugin/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.6,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1114",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-611"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21642",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1114/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/config-file-provider-plugin/commit/3fc07e611a52ff5940306388e51f0dd92cf7054f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/config-file-provider-plugin/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/config-file-provider-plugin/releases/tag/config-file-provider-3.7.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/security/advisory/2021-04-21/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1114/default-remediation-status"
            }
        ]
    }
}