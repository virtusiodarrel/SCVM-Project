{
    "source": "BDSA",
    "name": "BDSA-2019-3135",
    "title": "FasterXML jackson-databind Vulnerable to Remote Code Execution via Typing Issue in 'p6spy' Package Classes",
    "description": "FasterXML jackson-databind is vulnerable to remote code execution (RCE) due to how polymorphic data types are handled by a gadget used by the application. A remote attacker could execute arbitrary commands on the underlying system by submitting crafted JSON messages to the application. It should be noted that this 'Default Typing' must be enabled for an externally exposed JSON end-path in order for this vulnerability to manifest. An attacker must also be able to find a RMI service endpoint to access.",
    "technicalDescription": "The `p6spy` component used within jackson-databind contains the `com.p6spy.engine.spy.P6DataSource` gadget type, which can utilize deserialized JSON objects. The JSON object received by jackson-databind can include a class name as the type ID for certain fields, in order to ensure that the deserializer knows what subtype to use for the values of those fields. Alternatively, if 'Default Typing' is enabled, default class names will be used for all JSON properties that match a given set of criteria. An attacker could potentially provide crafted JSON messages in order to invoke classes that will allow for remote code execution via deserialization. \n\nIn order for an attacker to exploit this vulnerability, 'Default Typing' must be enabled for an externally exposed JSON end-path. An attacker must also be able to find a RMI service endpoint to access.",
    "publishedDate": "2019-10-02T15:46:56.206Z",
    "updatedDate": "2021-06-29T08:54:57.832Z",
    "disclosureDate": "2019-09-27T00:00:00.000Z",
    "solution": "Fixed  by [this](https://github.com/FasterXML/jackson-databind/commit/9593e16cf5a3d289a9c584f7123639655de9ddac) commit and [this](https://github.com/FasterXML/jackson-databind/commit/54aa38d87dcffa5ccc23e64922e9536c82c1b9c8) commit in: \n* [**2.10.1**](https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.10.1)\n* [**2.9.10.1**](https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.9.10.1)\n* [**2.8.11.5**](https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.8.11.5)\n\nFixed in [**2.7.9.7**](https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.7.9.7) by [this](https://github.com/FasterXML/jackson-databind/commit/bbdbc40029b10f19710d8510695018c170457fc5) commit.\n\nFixed in [**2.6.7.3**](https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.6.7.3) by [this](https://github.com/FasterXML/jackson-databind/commit/a3939d36edcc755c8af55bdc1969e0fa8438f9db) commit.\n\nThe latest stable releases can be found [here](https://github.com/FasterXML/jackson-databind/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-09-29T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3135",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-16943",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3135/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/commit/54aa38d87dcffa5ccc23e64922e9536c82c1b9c8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/commit/9593e16cf5a3d289a9c584f7123639655de9ddac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/commit/a3939d36edcc755c8af55bdc1969e0fa8438f9db",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/commit/bbdbc40029b10f19710d8510695018c170457fc5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/issues/2478",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.10.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.6.7.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.7.9.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.8.11.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.9.10.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3135/default-remediation-status"
            }
        ]
    }
}