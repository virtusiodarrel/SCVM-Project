{
    "source": "BDSA",
    "name": "BDSA-2021-2698",
    "title": "Cyrus IMAP Vulnerable to Denial-of-Service (DoS) via Slow Hash-Table Interaction",
    "description": "Cyrus IMAP is vulnerable to a denial-of-service (DoS) issue due to a weakness present in the string hashing algorithm that is in use.\n\nAn attacker could submit multiple crafted inputs in order to trigger excessive CPU usage which could negatively impact performance and cause other tasks to take longer.",
    "technicalDescription": "Cyrus IMAP is vulnerable to denial-of-service (DoS) conditions because the the ad-hoc string hashing algorithm that is in use utilizes user inputs as hash table keys. The problem is that users can control which bucket the data is stored in, meaning that multiple inputs can be directed to a single bucket. As each insertion occurs, a `strcmp` operation is performed on every other entry in the bucket which causes excessive consumption of CPU resources when the bucket contains thousands of entries.",
    "publishedDate": "2021-09-07T10:26:34.318Z",
    "updatedDate": "2022-09-01T14:03:48.913Z",
    "disclosureDate": "2021-09-01T00:00:00.000Z",
    "solution": "Fixed in:\n* the **cyrus-imapd-2.4** branch.\n* the **cyrus-imapd-2.5** branch.\n* version [**3.4.2**](https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-3.4.2).\n* version [**3.2.8**](https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-3.2.8).\n* version [**3.0.16**](https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-3.0.16).\n\nThe following commits consist of the applied fixes as found on the **master** branch:\n* [Commit 1](https://github.com/cyrusimap/cyrus-imapd/commit/0fb658f1727f4446f7f33adcc428ba4c9eeabe3e)\n* [Commit 2](https://github.com/cyrusimap/cyrus-imapd/commit/12b1aeceaa38d124b2d30ed70bb06c9e419b1a6f)\n* [Commit 3](https://github.com/cyrusimap/cyrus-imapd/commit/a66ca0ceb7aa78ebeb5387a4cdcc071e7724a543)\n* [Commit 4](https://github.com/cyrusimap/cyrus-imapd/commit/ae5e6beab12a22e8930cfeaaea41334272871e74)\n* [Commit 5](https://github.com/cyrusimap/cyrus-imapd/commit/4f896a828837380bada79387bb06486f06977162)\n* [Commit 6](https://github.com/cyrusimap/cyrus-imapd/commit/5a2c1d56edb9ee506ef90f3555e2f6c353b24000)\n* [Commit 7](https://github.com/cyrusimap/cyrus-imapd/commit/96aa61f0a8ad5ed50fa42f505aeda340946c0a85)\n* [Commit 8](https://github.com/cyrusimap/cyrus-imapd/commit/755ceebb7d13fc9347a7427f95876075a3512ab8)\n\nThe latest stable releases are available [here](https://github.com/cyrusimap/cyrus-imapd/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Matthew Horsfall (Fastmail)",
    "workaround": "",
    "vendorFixDate": "2021-07-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2698",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33582",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2698/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cyrus.topicbox.com/groups/announce/T3dde0a2352462975/cyrus-imap-3-4-2-3-2-8-and-3-0-16-released",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/commit/0fb658f1727f4446f7f33adcc428ba4c9eeabe3e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/commit/12b1aeceaa38d124b2d30ed70bb06c9e419b1a6f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/commit/4f896a828837380bada79387bb06486f06977162",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/commit/5a2c1d56edb9ee506ef90f3555e2f6c353b24000",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/commit/755ceebb7d13fc9347a7427f95876075a3512ab8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/commit/96aa61f0a8ad5ed50fa42f505aeda340946c0a85",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/commit/a66ca0ceb7aa78ebeb5387a4cdcc071e7724a543",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/commit/ae5e6beab12a22e8930cfeaaea41334272871e74",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-3.0.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-3.2.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cyrusimap/cyrus-imapd/releases/tag/cyrus-imapd-3.4.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2698/default-remediation-status"
            }
        ]
    }
}