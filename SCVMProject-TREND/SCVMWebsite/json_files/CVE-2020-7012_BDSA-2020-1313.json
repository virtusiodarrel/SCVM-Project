{
    "source": "BDSA",
    "name": "BDSA-2020-1313",
    "title": "Kibana Vulnerable to Remote Code Execution (RCE) via Prototype Pollution Attack in Upgrade Assistant",
    "description": "Kibana is vulnerable to remote code execution (RCE) through the \"Upgrade Assistant\" in the \"Management\" tab.  An attacker can modify the prototype of an undisclosed object that may lead to the execute of code.",
    "technicalDescription": "The RCE vulnerability is in the \"Upgrade Assistant\" component of Kibana. Through an undisclosed prototype pollution attack vector, an authenticated attacker with privileges to write to the Kibana index can insert data that will cause Kibana to execute arbitrary code. This will be executed on the host system with the permissions of the Kibana process.",
    "publishedDate": "2020-06-05T15:56:35.855Z",
    "updatedDate": "2021-11-02T12:09:33.303Z",
    "disclosureDate": "2020-06-03T00:00:00.000Z",
    "solution": "Fixed in version [**6.8.9**](https://github.com/elastic/kibana/releases/tag/v6.8.9) and [**7.7.0**](https://github.com/elastic/kibana/releases/tag/v7.7.0).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.5,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor states the following as a workaround:\n\n\"Upgrade Assistant can be disabled by setting the following options in Kibana:\n\n * Kibana versions **6.7.0** and **6.7.1** can set `upgrade_assistant.enabled: false` in the `kibana.yml` file\n\n * Kibana versions starting with **6.7.2** can set `xpack.upgrade_assistant.enabled: false` in the `kibana.yml` file\n\nThis flaw is mitigated by default in all Elastic Cloud Kibana versions.\"",
    "vendorFixDate": "2020-05-13T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 5.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1313",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7012",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1313/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.elastic.co/t/elastic-stack-6-8-9-and-7-7-0-security-update/235571",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://discuss.elastic.co/t/elastic-stack-6-8-9-and-7-7-0-security-update/235571",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/releases/tag/v6.8.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/releases/tag/v7.7.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1313/default-remediation-status"
            }
        ]
    }
}