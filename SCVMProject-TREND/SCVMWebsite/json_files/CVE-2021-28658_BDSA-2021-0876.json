{
    "source": "BDSA",
    "name": "BDSA-2021-0876",
    "title": "Django Vulnerable to Directory Traversal via 'file_name' Parameter in 'multipartparser.py' File",
    "description": "Django contains a directory traversal vulnerability because of improper sanitization measures. An attacker could exploit this flaw and gain access to restricted files or directories.",
    "technicalDescription": "This vulnerability exists in the `django/http/multipartparser.py` file. It does not sanitize the contents of `file_name` parameter before it's processed further. An attacker could supply an arbitrary file name and gain access to restricted files on the server. \nThis issue was fixed in the vulnerable file by introducing a new function `sanitize_file_name()` which correctly sanitizes the variable `file_name`.\n\n**Note** This vulnerability does not affect built-in upload handlers.",
    "publishedDate": "2021-04-07T13:55:16.368Z",
    "updatedDate": "2021-04-07T13:55:16.361Z",
    "disclosureDate": "2021-04-06T00:00:00.000Z",
    "solution": "Fixed in [**2.2.20**](https://github.com/django/django/releases/tag/2.2.20) by [this](https://github.com/django/django/commit/4036d62bda0e9e9f6172943794b744a454ca49c2) commit.\n\nFixed in [**3.0.14**](https://github.com/django/django/releases/tag/3.0.14) by [this](https://github.com/django/django/commit/e7fba62248f604c76da4f23dcf1db4a57b0808ea) commit.\n\nFixed in [**3.1.8**](https://github.com/django/django/releases/tag/3.1.8) by [this](https://github.com/django/django/commit/cca0d98118cccf9ae0c6dcf2d6c57fc50469fbf0) commit.\n\nFixed in [**3.2**](https://github.com/django/django/releases/tag/3.2) by [this](https://github.com/django/django/commit/2820fd1be5dfccbf1216c3845fad8580502473e1) commit.\n\nThe latest stable releases are available [here](https://github.com/django/django/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dennis Brinkrolf",
    "workaround": "",
    "vendorFixDate": "2021-04-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0876",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28658",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0876/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/2820fd1be5dfccbf1216c3845fad8580502473e1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/4036d62bda0e9e9f6172943794b744a454ca49c2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/cca0d98118cccf9ae0c6dcf2d6c57fc50469fbf0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/e7fba62248f604c76da4f23dcf1db4a57b0808ea",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/2.2.20",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/3.0.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/3.1.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/weblog/2021/apr/06/security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0876/default-remediation-status"
            }
        ]
    }
}