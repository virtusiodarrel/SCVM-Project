{
    "source": "BDSA",
    "name": "BDSA-2021-3638",
    "title": "plugin-scaffolder-backend Vulnerable to Path Traversal via Scaffolder Template Manipulation",
    "description": "`@backstage/plugin-scaffolder-backend` npm package is vulnerable to path traversal. An attacker with a write access to a registered scaffolder template could manipulate the template in a way that writes files to arbitrary paths on the `scaffolder-backend` host instance.",
    "technicalDescription": "The path traversal can also be exploited via user input when executing a template, meaning the attacker does not need the write access to the templates. However, in this scenario the attacker cannot control the contents of the injected file, unless the template is also crafted in a specific way that gives control of the file contents.\n\nThe vulnerability was fixed by removing all usages of `path.resolve` in order to ensure that template paths are resolved in a safe way.",
    "publishedDate": "2021-12-03T17:47:41.665Z",
    "updatedDate": "2021-12-03T17:47:41.641Z",
    "disclosureDate": "2021-11-28T00:00:00.000Z",
    "solution": "Fixed in version [**0.15.14**](https://www.npmjs.com/package/@backstage/plugin-scaffolder-backend/v/0.15.14) by [this](https://github.com/backstage/backstage/commit/f9352ab606367cd9efc6ff048915c70ed3013b7f) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/@backstage/plugin-scaffolder-backend).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor provides the following workaround:\n```\nThis attack is mitigated by restricting access and requiring reviews when registering or modifying scaffolder templates.\n```",
    "vendorFixDate": "2021-11-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3638",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43783",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3638/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/backstage/backstage/commit/f9352ab606367cd9efc6ff048915c70ed3013b7f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/backstage/backstage/security/advisories/GHSA-mg3m-f475-28hv",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/backstage/backstage/security/advisories/GHSA-mg3m-f475-28hv",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/@backstage/plugin-scaffolder-backend",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/@backstage/plugin-scaffolder-backend/v/0.15.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3638/default-remediation-status"
            }
        ]
    }
}