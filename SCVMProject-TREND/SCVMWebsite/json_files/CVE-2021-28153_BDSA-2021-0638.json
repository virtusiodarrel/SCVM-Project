{
    "source": "BDSA",
    "name": "BDSA-2021-0638",
    "title": "Glib Vulnerable to Arbitrary File Overwrites via Symlink Attacks with 'g_file_replace()' Function",
    "description": "Glib is vulnerable to symlink attacks due to improper processing of archives in the `file-roller` archive manager. This could allow an attacker to overwrite arbitrary files using a maliciously crafted archive.",
    "technicalDescription": "The issue exists within the file `gio/glocalfileoutputstream.c`. When the function `g_file_replace()` with the `G_FILE_CREATE_REPLACE_DESTINATION` flag is called and the destination is a dangling symlink, the function incorrectly creates an empty file for the target location of the symlink. This could be leveraged by an attacker to overwrite arbitrary content if they are in control of the processed symlink.",
    "publishedDate": "2021-03-12T11:57:54.144Z",
    "updatedDate": "2021-07-09T15:46:41.707Z",
    "disclosureDate": "2021-03-10T00:00:00.000Z",
    "exploitPublishDate": "2021-03-10T00:00:00.000Z",
    "solution": "Fixed in [**2.67.6**](https://gitlab.gnome.org/GNOME/glib/-/tags/2.67.6) by [this](https://gitlab.gnome.org/GNOME/glib/-/commit/c80528f17ba25ea7d7089946926b93a98bd1479e) commit and [**2.66.8**](https://gitlab.gnome.org/GNOME/glib/-/tags/2.66.8) [this](https://gitlab.gnome.org/GNOME/glib/-/commit/01c5468e10707cbf78e6e83bbcf1ce9c866f2885) commit.\n\nThe latest stable releases are available [here](https://download.gnome.org/sources/glib/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.7
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Yi\u011fit Can Y\u0131lmaz",
    "workaround": "",
    "vendorFixDate": "2021-03-10T00:00:00.000Z",
    "vendorNotifiedDate": "2020-11-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0638",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-61"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28153",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0638/ranges"
            },
            {
                "rel": "reference",
                "href": "https://download.gnome.org/sources/glib/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/file-roller/-/issues/108",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/-/commit/01c5468e10707cbf78e6e83bbcf1ce9c866f2885",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/-/commit/c80528f17ba25ea7d7089946926b93a98bd1479e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/-/issues/2325",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/-/issues/2325",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/-/tags/2.67.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0638/default-remediation-status"
            }
        ]
    }
}