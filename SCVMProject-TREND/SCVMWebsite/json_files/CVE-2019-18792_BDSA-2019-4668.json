{
    "source": "BDSA",
    "name": "BDSA-2019-4668",
    "title": "Suricata Vulnerable to TCP Based Packet Evasion via Fake FIN Packet",
    "description": "Suricata is vulnerable to TCP based packet evasion via fake FIN packets. An attacker could exploit this by overlapping a TCP segment with a fake FIN packet.",
    "technicalDescription": "Exploitation occurs when the fake FIN packet is injected just before the `PUSH ACK` packet that is to be bypassed. The `PUSH ACK` packet will be ignored because it would have overlapped the FIN packet. This happens because the sequence and ack number are the same for both packets. This would result in the client ignoring the fake FIN packet because the ACK flag would not have been set. This has been mitigated by ensuring that packets with a broken ACK field are rejected. These packets have a non-0 ACK field, but do not have a ACK flag set.",
    "publishedDate": "2020-09-18T09:50:08.166Z",
    "updatedDate": "2020-09-18T09:50:08.158Z",
    "disclosureDate": "2019-12-13T00:00:00.000Z",
    "exploitPublishDate": "2019-12-13T00:00:00.000Z",
    "solution": "Fixed in [**5.0.1**](https://github.com/OISF/suricata/releases/tag/suricata-5.0.1) by [this](https://github.com/OISF/suricata/commit/fa692df37a796c3330c81988d15ef1a219afc006) commit.\nFixed in [**4.1.6**](https://github.com/OISF/suricata/releases/tag/suricata-4.1.6) by [this](https://github.com/OISF/suricata/commit/1c63d3905852f746ccde7e2585600b2199cefb4b) commit.\n\nThe latest stable releases are available [here](https://github.com/OISF/suricata/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nicolas Adba",
    "workaround": "",
    "vendorFixDate": "2019-12-13T00:00:00.000Z",
    "vendorNotifiedDate": "2019-11-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4668",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-18792",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4668/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OISF/suricata/commit/1c63d3905852f746ccde7e2585600b2199cefb4b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OISF/suricata/commit/fa692df37a796c3330c81988d15ef1a219afc006",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OISF/suricata/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OISF/suricata/releases/tag/suricata-4.1.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OISF/suricata/releases/tag/suricata-5.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://redmine.openinfosecfoundation.org/issues/3324",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://redmine.openinfosecfoundation.org/issues/3394",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://suricata-ids.org/2019/12/13/suricata-4-1-6-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://suricata-ids.org/2019/12/13/suricata-5-0-1-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4668/default-remediation-status"
            }
        ]
    }
}