{
    "source": "BDSA",
    "name": "BDSA-2021-2987",
    "title": "Zephyr Vulnerable to Arbitrary Code Execution, Data Structure Corruption, and Information Exposure via Heap-Based Buffer Overflow",
    "description": "Zephyr contains a heap-based buffer overflow vulnerability. An attacker with adjacent network access could exploit this in order to achieve arbitrary code execution, cause corruption of data structures, gain unintended access to Information, or cause a denial-of-service (DoS) condition.",
    "technicalDescription": "This issue occurs in the `usb_handle_std_device_req()` function of the `subsys/usb/usb_device.c` file due to improper buffer boundary restrictions. It was mitigated by the addition of checks to verify the request direction within the standard device, interface, and endpoint request handlers.",
    "publishedDate": "2021-10-07T15:47:16.725Z",
    "updatedDate": "2022-03-25T16:11:09.937Z",
    "disclosureDate": "2021-10-05T00:00:00.000Z",
    "exploitPublishDate": "2021-10-05T00:00:00.000Z",
    "solution": "Fixed in version [**2.7.0-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.7.0-rc1) and [**2.7.99**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.7.99) by [this](https://github.com/zephyrproject-rtos/zephyr/commit/4b79912dc7cd9efbc951164c7d13ca14a536d170) commit.\n\nThe latest stable releases can be found [here](https://github.com/zephyrproject-rtos/zephyr/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.5,
        "severity": "MEDIUM",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "(AV:A/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:L/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "szymonh",
    "workaround": "",
    "vendorFixDate": "2021-08-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2987",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3625",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2987/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/4b79912dc7cd9efbc951164c7d13ca14a536d170",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.7.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.7.99",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-c3gr-hgvr-f363",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-c3gr-hgvr-f363",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2987/default-remediation-status"
            }
        ]
    }
}