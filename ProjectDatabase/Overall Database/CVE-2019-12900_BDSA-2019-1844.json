{
    "source": "BDSA",
    "name": "BDSA-2019-1844",
    "title": "bzip2 Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Write in 'BZ2_decompress' Function",
    "description": "bzip2 contains an out-of-bounds write vulnerability. An attacker can exploit this by tricking a user into downloading and loading a malicious file into the application,  resulting in a denial-of-service (DoS) condition",
    "technicalDescription": "This exists in the function `BZ2_decompress` within the file `decompress.c` due to a missing range check for  `nSelectors` (the number of selectors). If the value for `nSelectors` is greater than the value `BZ_MAX_SELECTORS`( the maximum number of selectors), it will result in an invalid memory access.\n\nThis was thought to be addressed by [this](https://gitlab.com/federicomenaquintero/bzip2/commit/74de1e2e6ffc9d51ef9824db71a8ffee5962cdbc) commit, by adding an appropriate range check for the `nSelectors` value to ensure that it was not bigger than the maximum number of selectors `BZ_MAX_SELECTORS`. However this resulted in writing past the `DState->selectorMtf[]` array end, and over-writing into `DState->len[][]`.\n\nAnother commit was added to allow as many selectors as the file format allows, however dismissing any selectors over than the maximum value of `BZ_MAX_SELECTORS`, which is calculated as 18002. If the number of selectors is greater than the maximum number of selectors, the number of selectors is set to the maximum value.\n\nAs bzip2's file format allows `nSelector` to be encoded with up to 15 bits, this results in a maximum of 32768 selectors. When a file is decompressed, any additional selectors past the value of 18002 are now read and discarded.",
    "publishedDate": "2019-06-20T13:13:57.323Z",
    "updatedDate": "2019-09-25T16:57:49.309Z",
    "disclosureDate": "2019-06-05T00:00:00.000Z",
    "solution": "Fixed in [**1.0.8**](https://sourceware.org/git/?p=bzip2.git;a=tag;h=refs/tags/bzip2-1.0.8) [this](https://gitlab.com/federicomenaquintero/bzip2/commit/812a898b7622de90e98f103ff7fed0984e4548e4) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-06-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1844",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-12900",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1844/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/federicomenaquintero/bzip2/commit/74de1e2e6ffc9d51ef9824db71a8ffee5962cdbc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/federicomenaquintero/bzip2/commit/812a898b7622de90e98f103ff7fed0984e4548e4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/federicomenaquintero/bzip2/issues/24",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sourceware.org/git/?p=bzip2.git;a=tag;h=refs/tags/bzip2-1.0.8",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}