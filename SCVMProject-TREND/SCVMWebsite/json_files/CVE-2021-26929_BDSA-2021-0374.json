{
    "source": "BDSA",
    "name": "BDSA-2021-0374",
    "title": "Horde_Text_Filter Vulnerable Cross-Site Scripting (XSS) via Insufficient Input Validation in 'preProcess' Function",
    "description": "Horde_Text_Filter is vulnerable to a cross-site scripting (XSS) issue due to a flaw in handling untrusted content in the `preProcess()` function.\n\nAn attacker could abuse this flaw by sending a crafted email containing malicious encoded scripts. These scripts could be used to exfiltrate the victim target mailbox when the library is used in Horde Groupware Webmail Edition.",
    "technicalDescription": "Horde_Text_Filter is vulnerable to cross-site scripting (XSS) because the `preProcess()` function in the `lib/Horde/Text/Filter/Text2html.php` file can bypass calls to `htmlspecialchars()` when looking for URLs and emails to replace with their base64 encoded value.\n\nThis flaw allows an attacker to perform stored XSS attacks by injecting malicious scripts via crafted URLs or email addresses in the email body. To trigger the exploit, a user can simply display the malicious email.\n\n**Note**: The vendor has advised users to upgrade to the latest Horde_Text_Filter library available. Horde Groupware Webmail Edition has not received any updates as of yet.",
    "publishedDate": "2021-02-15T15:59:39.761Z",
    "updatedDate": "2022-04-28T13:50:36.279Z",
    "disclosureDate": "2021-02-13T00:00:00.000Z",
    "exploitPublishDate": "2021-02-13T00:00:00.000Z",
    "solution": "Fixed in Horde_Text_Filter [**2.3.7**](https://github.com/horde/Text_Filter/releases/tag/v2.3.7) by [this](https://github.com/horde/Text_Filter/commit/a2f67da064d7a91440b7a2448e56a6387ab94c67) commit.\n\nThe latest stable releases are available [here](https://github.com/horde/Text_Filter/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Alex Birnberg",
    "workaround": "",
    "vendorFixDate": "2021-02-13T00:00:00.000Z",
    "discoveryDate": "2020-11-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0374",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-26929",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0374/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/horde/Text_Filter/commit/a2f67da064d7a91440b7a2448e56a6387ab94c67",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/horde/Text_Filter/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/horde/Text_Filter/releases/tag/v2.3.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.horde.org/archives/announce/2021/001298.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/162187/webmailedition5222-exec.txt",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.alexbirnberg.com/horde-xss.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.alexbirnberg.com/horde-xss.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0374/default-remediation-status"
            }
        ]
    }
}