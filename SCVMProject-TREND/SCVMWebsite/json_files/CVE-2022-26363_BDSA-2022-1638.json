{
    "source": "BDSA",
    "name": "BDSA-2022-1638",
    "title": "Xen Vulnerable to Guest Admin Privilege Escalation via Insufficient Care with Non-Coherent Mappings",
    "description": "Xen contains a privilege escalation vulnerability. A guest attacker could exploit this by using WC mappings to deliberately create non-coherency between the cache and RAM in order to trick Xen into improperly validating an unsafe pagetable.\n\n**Note:** Per the Vendor, \"Only CPUs which can issue non-coherent memory accesses are impacted. CPUs which enumerate the SelfSnoop feature are not impacted, except as noted in errata.  Therefore, we believe that Xen running on Intel IvyBridge or later CPUs is not impacted by the vulnerability.\" Additionally, \"Only x86 PV guests can trigger this vulnerability\" or \"Only x86 PV guests configured with access to devices (e.g. PCI Passthrough) can trigger the vulnerability.\".",
    "technicalDescription": "",
    "publishedDate": "2022-06-13T10:41:41.277Z",
    "updatedDate": "2022-08-12T11:04:47.343Z",
    "disclosureDate": "2022-06-10T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.15.3**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.3) by [this](https://github.com/xen-project/xen/commit/9b1e1e74a6c23ffad4c6a78973995957db2d4cc7) commit,\n* **staging-4.13** branch by [this](https://github.com/xen-project/xen/commit/fce392fa36c31f88be4f6b5f5821d244549cc825) commit which is not yet included in any release,\n* **staging-4.14** branch by [this](https://github.com/xen-project/xen/commit/07fbed87582c117262541a9a0903848a36adcc79) commit which is not yet included in any release,\n* **staging-4.16** branch by [this](https://github.com/xen-project/xen/commit/74193f4292d9cfc2874866e941d9939d8f33fcef) commit which is not yet included in any release.\n\nThe latest stable releases are available [here](https://github.com/xen-project/xen/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.4,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Jann Horn of Google Project Zero",
    "workaround": "Per the Vendor, \"Not passing devices through to untrusted x86 PV guests will avoid the vulnerability.\"",
    "vendorFixDate": "2022-06-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1638",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-26363",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1638/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-j296-h8mh-r88j",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/07fbed87582c117262541a9a0903848a36adcc79",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/74193f4292d9cfc2874866e941d9939d8f33fcef",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/9b1e1e74a6c23ffad4c6a78973995957db2d4cc7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/fce392fa36c31f88be4f6b5f5821d244549cc825",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-402.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-402.txt",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1638/default-remediation-status"
            }
        ]
    }
}