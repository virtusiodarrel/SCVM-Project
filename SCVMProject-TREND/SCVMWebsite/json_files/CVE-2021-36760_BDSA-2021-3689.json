{
    "source": "BDSA",
    "name": "BDSA-2021-3689",
    "title": "WSO2 Products Vulnerable to Reflected Cross-Site Scripting (XSS) and Open Redirects via Account Recovery Endpoint",
    "description": "WSO2 API Manager, WSO2 Identity Server, WSO2 IS as Key Manager and WSO2 IoT Server are vulnerable to reflected cross-site scripting (XSS) and open redirect attacks due to how regular expression validation is not applied for callback URLs configured in the `Account Recovery Configurations` by default.\n\nAn attacker could trick a victim user into clicking on a crafted link that contains malicious scripts that can execute in the context of the victim's browser to manipulate the UI of the web page or steal browser information such as cookies. An attacker could also abuse this same flaw in order to redirect the victim user to an attacker-controlled page.",
    "technicalDescription": "",
    "publishedDate": "2021-12-08T16:52:58.811Z",
    "updatedDate": "2022-03-07T17:43:35.511Z",
    "disclosureDate": "2021-10-14T00:00:00.000Z",
    "solution": "The vendor has recommended [here](https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2021-1314) to apply the regular expression validation for callback URLs in `Account Recovery Configurations` in the management console. The [password recovery](https://is.docs.wso2.com/en/latest/learn/password-recovery/) documentation contains instructions related to performing this configuration change. Additionally, the [WSO2 Security Guidelines for Production Deployments](https://is.docs.wso2.com/en/latest/administer/product-level-security-guidelines/) documentation has also been updated with relevant recommendations to mitigate this issue.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mariani Francesco",
    "workaround": "",
    "vendorFixDate": "2021-10-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3689",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-601"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-36760",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3689/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2021-1314",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://is.docs.wso2.com/en/latest/administer/product-level-security-guidelines/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://is.docs.wso2.com/en/latest/learn/password-recovery/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://is.docs.wso2.com/en/latest/learn/password-recovery/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3689/default-remediation-status"
            }
        ]
    }
}