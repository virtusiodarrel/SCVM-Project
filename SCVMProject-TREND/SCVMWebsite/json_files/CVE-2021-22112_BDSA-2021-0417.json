{
    "source": "BDSA",
    "name": "BDSA-2021-0417",
    "title": "Spring Security Vulnerable to Privilege Escalation via 'SecurityContext' State Mishandling",
    "description": "Spring Security is vulnerable to privilege escalation due to a failure to correctly save security context information. An attacker who is allowed to use elevated privileges in a small portion of a program could extend those privileges to the entire program by sending maliciously crafted requests to the application.\n\nIt should be noted that the vulnerability is not present by default, and must be programmed in by an application developer.",
    "technicalDescription": "Instances of the `SecurityContext` class are used by Spring Security in order to store information on the current security context of the application. The state of such instances can change multiple times during the application's execution flow. Any changes to the security context much be saved in order for them to be persisted correctly, via functions such as `responseWrapper.saveContext()`. If the security context is changed multiple times whenever a single request is being processed, and the application fails to save the context upon each change, then it may be possible for an attacker to elevate their privileges. It should be noted that such a vulnerability will not exist by default, and must have been introduced by a developer who has changes the security context multiple times whilst handling elevated privileges.",
    "publishedDate": "2021-02-22T14:31:23.198Z",
    "updatedDate": "2021-02-22T14:31:23.192Z",
    "disclosureDate": "2021-02-19T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.4.4**](https://github.com/spring-projects/spring-security/releases/tag/5.4.4) by [this](https://github.com/spring-projects/spring-security/commit/c72a6fac04853912a4b7caad5f0500f2aace5a79) commit.\n* [**5.3.8**](https://github.com/spring-projects/spring-security/releases/tag/5.3.8.RELEASE) by [this](https://github.com/spring-projects/spring-security/commit/9a49a8695fd7fd6ab5e8d31ba1fae00dead1f643) commit.\n* [**5.2.9**](https://github.com/spring-projects/spring-security/releases/tag/5.2.9.RELEASE) by [this](https://github.com/spring-projects/spring-security/commit/7cab7b06c51ea885dd0d07ff26b135dd3afce1d1) commit.\n\nThe latest stable releases are available [here](https://github.com/spring-projects/spring-security/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Daniel Beck, Jeff Thompson, Jesse Glick, and Wadeck Follonier (CloudBees, Inc.)",
    "workaround": "",
    "vendorFixDate": "2021-02-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0417",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22112",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0417/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/commit/7cab7b06c51ea885dd0d07ff26b135dd3afce1d1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/commit/9a49a8695fd7fd6ab5e8d31ba1fae00dead1f643",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/commit/c72a6fac04853912a4b7caad5f0500f2aace5a79",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/issues/9387",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.2.9.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.3.8.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.4.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://tanzu.vmware.com/security/cve-2021-22112",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0417/default-remediation-status"
            }
        ]
    }
}