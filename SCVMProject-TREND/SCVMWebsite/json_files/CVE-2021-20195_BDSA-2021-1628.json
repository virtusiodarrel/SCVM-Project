{
    "source": "BDSA",
    "name": "BDSA-2021-1628",
    "title": "Keycloak Vulnerable to Stored Cross-Site Scripting (XSS) and Account Takeover via 'loggedInUserName()' Function",
    "description": "Keycloak contains a stored cross-site scripting (XSS) vulnerability. An authenticated attacker can use this to execute malicious JavaScript code in a victim's browser, which could be used to steal session tokens, cookies, or other sensitive information. In addition to this, this vulnerability can be further exploited in order to achieve complete account takeover.",
    "technicalDescription": "This vulnerability exists due to insufficient validation in the `loggedInUserName()` function of file `themes/src/main/resources/theme/keycloak.v2/account/resources/welcome-page-scripts.js`. The Account page of Keycloak does not HTML-encode the first name and last name inputs which make up the `userName` parameter. This could allow an authenticated attacker to embed malicious JavaScript code on the Account page, which could be executed on an admin users browser if they use the Impersonation functionality to view the attackers account page.",
    "publishedDate": "2021-06-01T15:28:44.420Z",
    "updatedDate": "2021-06-01T15:28:44.416Z",
    "disclosureDate": "2021-01-22T00:00:00.000Z",
    "solution": "Fixed in [**13.0.0**](https://github.com/keycloak/keycloak/releases/tag/13.0.0) by [this](https://github.com/keycloak/keycloak/commit/717d9515fa131e3d8c8936e41b2e52270fdec976) commit.\n\nThe latest stable releases are available [here](https://github.com/keycloak/keycloak/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-03-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1628",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20195",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1628/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/cve-2021-20195",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1919143",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/717d9515fa131e3d8c8936e41b2e52270fdec976",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases/tag/13.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1628/default-remediation-status"
            }
        ]
    }
}