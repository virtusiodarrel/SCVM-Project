{
    "source": "BDSA",
    "name": "BDSA-2021-1457",
    "title": "DjVuLibre Vulnerable to Integer Overflow Leading to Heap Buffer Overflow in Function 'DJVU::GBitmap::decode()'",
    "description": "DjVuLibre is vulnerable to a heap-based buffer overflow. A remote attacker could leverage this by supplying the application with a specially crafted djvu file. This can lead to a denial-of-service (DoS). It has been reported by distribution vendors that this could also lead to code execution.",
    "technicalDescription": "In function `DJVU::GBitmap::decode()` of file `libdjvu/GBitmap.cpp` there exists a flaw where the summation of two unsigned shorts is stored in another unsigned short. This can result in an overflow occurring, later resulting in a heap based buffer overflow. Such overwriting of other program data has integrity and availability impacts, and can be leveraged to overwrite pointers, potentially causing confidentiality impacts. Several Linux distribution vendors have noted that this could potentially lead to code execution.",
    "publishedDate": "2021-05-19T15:57:19.098Z",
    "updatedDate": "2022-05-10T09:17:33.596Z",
    "disclosureDate": "2021-05-10T00:00:00.000Z",
    "exploitPublishDate": "2021-05-10T00:00:00.000Z",
    "solution": "Fixed in the **origin/master** branch by [this](https://sourceforge.net/p/djvu/djvulibre-git/ci/cd8b5c97b27a5c1dc83046498b6ca49ad20aa9b6) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "1vanChen (NSFOCUS Security Team)",
    "workaround": "",
    "vendorFixDate": "2021-05-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1457",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-680"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32493",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1457/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1943424",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1943424",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/162612/USN-4957-1.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://sourceforge.net/p/djvu/djvulibre-git/ci/cd8b5c97b27a5c1dc83046498b6ca49ad20aa9b6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://ubuntu.com/security/CVE-2021-32493",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ubuntu.com/security/notices/USN-4957-1",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1457/default-remediation-status"
            }
        ]
    }
}