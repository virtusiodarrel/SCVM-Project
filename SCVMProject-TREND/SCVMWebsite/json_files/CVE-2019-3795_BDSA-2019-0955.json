{
    "source": "BDSA",
    "name": "BDSA-2019-0955",
    "title": "Pivotal Spring Security Vulnerable to Brute Force via Cryptographically Weak PRNG in 'SecureRandom' Instance",
    "description": "A cryptographically weak pseudo-random number generator (PRNG) vulnerability has been discovered in Pivotal Spring Security. An attacker could exploit this vulnerability through brute force attacks to guess the algorithm if they have advanced knowledge of the seed utilized.",
    "technicalDescription": "A weakness has been discovered in the pseudo-random number generator (PRNG) implemented in Pivotal Spring Security. The `SecureRandomFactoryBean` class utilized by the application located in the file `core/src/main/java/org/springframework/security/core/token/SecureRandomFactoryBean.java` does not create a secure instance. The `getObject()` method executed by the class to calculate the `rnd` value can cause the `setSeed` method to replace the entire state due to an wrong-ordered IF statement, resulting in a mis-configured `RandomSecure` instance.",
    "publishedDate": "2019-04-08T13:44:52.644Z",
    "updatedDate": "2019-04-08T13:44:52.625Z",
    "disclosureDate": "2019-04-02T00:00:00.000Z",
    "solution": "* Fixed in version [**4.2.12**](https://github.com/spring-projects/spring-security/releases/tag/4.2.12.RELEASE) by [this](https://github.com/spring-projects/spring-security/commit/6f02f690ac65ccf99d8df47ac3d730a68f87c569) commit.\n* Fixed in version [**5.0.12**](https://github.com/spring-projects/spring-security/releases/tag/5.0.12.RELEASE) by [this](https://github.com/spring-projects/spring-security/commit/1304c958bf9c38940082f3ad1558d413ed82f2b6) commit.\n* Fixed in version [**5.1.5**](https://github.com/spring-projects/spring-security/releases/tag/5.1.5.RELEASE) by [this](https://github.com/spring-projects/spring-security/commit/3ddcbde466c16646a3a858baa57aafd8e65f6d52) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Thijs Alkemade",
    "workaround": "",
    "vendorFixDate": "2019-03-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0955",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-338"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3795",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0955/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1696616",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/commit/1304c958bf9c38940082f3ad1558d413ed82f2b6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/commit/3ddcbde466c16646a3a858baa57aafd8e65f6d52",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/commit/6f02f690ac65ccf99d8df47ac3d730a68f87c569",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/issues/6734",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/4.2.12.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.0.12.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.1.5.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://pivotal.io/security/cve-2019-3795",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0955/default-remediation-status"
            }
        ]
    }
}