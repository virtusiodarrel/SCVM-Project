{
    "source": "BDSA",
    "name": "BDSA-2019-0895",
    "title": "PostgreSQL Vulnerable to Authenticated Arbitrary Command Execution via COPY TO/FROM PROGRAM",
    "description": "PostgreSQL is vulnerable to authenticated arbitrary code execution due to an unsafe feature being enabled by default. This allows the database superuser, and users with a privileged role to run commands on the underlying system. The feature can be abused by malicious users with sufficient access in order to compromise the server.\n\nNOTE: The vendor has explicitly stated that this is not a security vulnerability in [this](https://www.postgresql.org/about/news/1935/) announcement.",
    "technicalDescription": "The `COPY TO/FROM PROGRAM` functionality introduced in version **9.3** allows users with sufficient privilege level to execute commands on the underlying host by piping data with an external program. This feature is enabled by default meaning that it can be easily abused by any database superuser or a user with `pg_execute_server_program` role to compromise the underlying host. The commands will be executed with the privilege level of the user running the PostgreSQL server (normally postgres).",
    "publishedDate": "2019-04-02T12:47:30.694Z",
    "updatedDate": "2022-03-30T09:24:22.265Z",
    "disclosureDate": "2019-03-20T00:00:00.000Z",
    "exploitPublishDate": "2019-03-24T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:F/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "Administrators should audit the `pg_execute_server_program` role to ensure only trusted users are assigned these permissions. The PostgreSQL user account should be sufficiently restricted on the system to make sure it only has access to the resources that it actually requires.",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0895",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-657"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9193",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0895/ranges"
            },
            {
                "rel": "reference",
                "href": "https://medium.com/greenwolf-security/authenticated-arbitrary-command-execution-on-postgresql-9-3-latest-cd18945914d5",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://meterpreter.org/cve-2019-9193-postgresql-arbitrary-code-execution/",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://paquier.xyz/postgresql-2/postgres-9-3-feature-highlight-copy-tofrom-program/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46813",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/50847",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.postgresql.org/about/news/1935/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.postgresql.org/docs/11/sql-copy.html",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0895/default-remediation-status"
            }
        ]
    }
}