{
    "source": "BDSA",
    "name": "BDSA-2018-1856",
    "title": "GnuPG Vulnerable to Signature Verification Bypass via Unsanitized Diagnostic Output",
    "description": "GnuPG contains a vulnerability which can be leveraged to bypass signature verification when another program makes a call to pgp to verify the signature and parses the returned output.",
    "technicalDescription": "This vulnerability exists in the `mainproc.c` source file due to lack of neutralization of user-supplied input. The OpenPGP specification permits to include the file name of the original input file in the signed or encrypted message. The GPG tool can later use this filename to display a notice when performing decryption and verification. The problem is that this filename is not sanitized when it is displayed and can contain dangerous control characters.\n\nPotential attackers can leverage this flaw to inject terminal control sequences via crafted filenames allowing them to spoof the status messages. These messages can then be parsed by other programs to retrieve information about the validity of a signature and other parameters. Ultimately this can lead to a bypass of signature verification resulting in a loss of integrity.",
    "publishedDate": "2018-06-15T09:39:30.004Z",
    "updatedDate": "2018-06-15T09:39:29.992Z",
    "disclosureDate": "2018-06-08T00:00:00.000Z",
    "solution": "Fixed in [**1.4.23**](https://gnupg.org/download/index.html) by [this](https://dev.gnupg.org/rG2326851c60793653069494379b16d84e4c10a0ac) commit.\nFixed in [**2.2.8**](https://gnupg.org/download/index.html) by [this](https://dev.gnupg.org/rG210e402acd3e284b32db1901e43bf1470e659e49) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Marcus Brinkmann",
    "workaround": "The vendor has provided two workarounds for short-term mitigation prior to upgrading:\n* Add `--no-verbose` to the invocation of gpg.\n* Redirect the log output to a different file: e.g. \"`--log-file /dev/null`\".",
    "vendorFixDate": "2018-06-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-1856",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-12020",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-1856/ranges"
            },
            {
                "rel": "reference",
                "href": "http://seclists.org/oss-sec/2018/q2/169",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://dev.gnupg.org/T4012",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://dev.gnupg.org/rG210e402acd3e284b32db1901e43bf1470e659e49",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://dev.gnupg.org/rG2326851c60793653069494379b16d84e4c10a0ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gnupg.org/download/index.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.gnupg.org/pipermail/gnupg-announce/2018q2/000425.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.gnupg.org/pipermail/gnupg-announce/2018q2/000425.html",
                "label": "WORKAROUND"
            }
        ]
    }
}