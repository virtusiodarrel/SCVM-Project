{
    "source": "BDSA",
    "name": "BDSA-2021-4303",
    "title": "RaspAP Vulnerable to Remote Code Execution (RCE) via Command Injection in 'DisplayWPAConfig()' Function",
    "description": "RaspAP contains a command injection vulnerability. An authenticated attacker could exploit this issue by crafting malicious POST requests and commands in order to receive a reverse shell of the application, allowing for the execution of remote code.",
    "technicalDescription": "This vulnerability can be exploited via the `includes/configure_client.php` file within the `DisplayWPAConfig()` function. An attacker could craft a POST request to the application with the key value `connect` and `csrf_token` to `/wpa_conf` (this calls the `DisplayWPAConfig()` via `index.php`). Once this has been constructed, the attacker will be able to inject commands to spawn a reverse shell and from here, the attacker will have the ability to gain control of non public facing devices within the network to execute arbitrary commands, steal sensitive data or carry out further attacks.",
    "publishedDate": "2022-04-07T12:49:30.927Z",
    "updatedDate": "2022-08-23T11:39:46.897Z",
    "disclosureDate": "2021-08-23T00:00:00.000Z",
    "exploitPublishDate": "2021-08-23T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "HIGH",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNCORROBORATED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:H/RL:U/RC:UR)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "HIGH",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "REASONABLE",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:H/RL:U/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Moritz Gruber",
    "workaround": "",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4303",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-38556",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4303/ranges"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/163896/raspap266-exec.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/163896/raspap266-exec.txt",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://web.archive.org/web/20210811172034/https://zerosecuritypenetrationtesting.com/?p=1011",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4303/default-remediation-status"
            }
        ]
    }
}