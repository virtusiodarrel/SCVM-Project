{
    "source": "BDSA",
    "name": "BDSA-2020-4272",
    "title": "Singularity Vulnerable to Arbitrary Code Execution and Information Disclosure via Build Operation Insecure Permissions",
    "description": "Singularity is vulnerable to arbitrary code execution and information disclosure due to how temporary directories used in container build operations use insecure permissions.\n\nAn attacker could use this issue to read the contents of the image or conduct arbitrary code execution attacks.",
    "technicalDescription": "Singularity is vulnerability to arbitrary code execution and information disclosure because insecure permissions are applied on temporary directories that are used in both explicit and implicit container build operations.\n\nIt is possible for an attacker with access to the system to read the contents of the image during the build operation. If the image also contains a world-writable file or directory, the attacker could inject arbitrary content into the running build in order to execute arbitrary code during the build and/or when the container is run.",
    "publishedDate": "2021-04-02T09:03:19.901Z",
    "updatedDate": "2021-04-02T09:03:19.894Z",
    "disclosureDate": "2020-09-15T00:00:00.000Z",
    "solution": "Fixed in [**3.6.3**](https://github.com/hpcng/singularity/releases/tag/v3.6.3) by [this](https://github.com/hpcng/singularity/commit/98ad49a3de9043ea287d65f4d544632ff074e506) commit.\n\nThe latest stable releases are available [here](https://github.com/hpcng/singularity/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "David Trudgian, Adam Hughes",
    "workaround": "The vendor has stated [here](https://github.com/hpcng/singularity/security/advisories/GHSA-jv9c-w74q-6762), that the issue can potentially be mitigated if `TMPDIR` is set to a location that is only accessible to the user, as any subdirectories directly under `TMPDIR` cannot then be accessed by others. The vendor believes this is difficult to enforce, so it is not recommended to rely on this as a mitigation.",
    "vendorFixDate": "2020-09-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4272",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-276"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25040",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4272/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/commit/98ad49a3de9043ea287d65f4d544632ff074e506",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/releases/tag/v3.6.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/security/advisories/GHSA-jv9c-w74q-6762",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hpcng/singularity/security/advisories/GHSA-jv9c-w74q-6762",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4272/default-remediation-status"
            }
        ]
    }
}