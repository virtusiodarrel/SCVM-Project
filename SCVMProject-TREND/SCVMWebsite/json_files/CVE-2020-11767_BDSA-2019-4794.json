{
    "source": "BDSA",
    "name": "BDSA-2019-4794",
    "title": "Envoy and Istio Vulnerable to Information Disclosure via Mishandled Connection Recycling",
    "description": "Envoy and Istio are vulnerable to information disclosure due to the possibility of a data leak whenever connections are being recycled. An attacker could obtain sensitive data that is intended for a different endpoint if they can control a subdomain related to that endpoint.",
    "technicalDescription": "RFC 7540 specifies mechanisms for connection reuse which are implemented within Envoy and Istio. Both of these applications will conduct HTTP/2 connection coalescence in order to reuse connections as efficiently as possible. This can lead to a data leak in cases where a user connects to an application that resides in a domain that uses a wildcard certificate.\n\nA subdomain of the wildcard domain may exist that utilizes a back end that is different to the other subdomains of the wildcard domain. If the user connects to an application within this subdomain, the connections may be coalesced, causing requests that should be forwarded to one back end to be forwarded the other instead. An attacker listening at this back end may be able to obtain sensitive information from the client's requests. Envoy and Istio should instead detect such an event and issue a `421 Misdirected Request` message.",
    "publishedDate": "2020-11-06T16:45:25.109Z",
    "updatedDate": "2022-01-24T13:20:42.937Z",
    "disclosureDate": "2019-04-01T00:00:00.000Z",
    "solution": "",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 2.1
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.4,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.6,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:N/A:N/E:U/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "A workaround for Envoy is proposed [here](https://github.com/envoyproxy/envoy/issues/6767#issuecomment-688017034). Workaround proposals for Istio can be found [here](https://github.com/istio/istio/issues/13589).",
    "bdsaTags": [],
    "overallScore": 3.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4794",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-923"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11767",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4794/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/issues/6767",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/issues/6767#issuecomment-688017034",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/issues/13589",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/issues/13589",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4794/default-remediation-status"
            }
        ]
    }
}