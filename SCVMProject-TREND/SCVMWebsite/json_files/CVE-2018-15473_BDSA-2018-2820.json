{
    "source": "BDSA",
    "name": "BDSA-2018-2820",
    "title": "OpenSSH Vulnerable to Username Enumeration via Malformed Packet Authentication Attempt",
    "description": "OpenSSH is vulnerable to username enumeration as it behaves differently in response to malicious probing based on whether the username is valid or not. An attacker can leverage this flaw to confirm valid OpenSSH usernames and by extension increase the effectiveness of brute force attacks.",
    "technicalDescription": "An attacker can confirm whether a username is valid on a target OpenSSH server by trying to authenticate a user with a malformed packet (e.g. a truncated packet). If the user does not exist the `userauth_pubkey()` function returns immediately, and an `SSH2_MSG_USERAUTH_FAILURE` message is sent to the attacker. If the user does exist then the `sshpkt_get_u8()` fails, the server calls `fatal()` and closes the connection to the attacker. This variance in behavior can be leveraged by an attacker to confirm valid usernames.\n\nAdministrators can search the logs for this indicator of attack:\n```\nAug 16 21:42:10 victim sshd[10680]: fatal: ssh_packet_get_string: incomplete message [preauth]\n```",
    "publishedDate": "2018-08-17T13:15:16.116Z",
    "updatedDate": "2019-08-05T10:47:46.216Z",
    "disclosureDate": "2018-08-15T00:00:00.000Z",
    "exploitPublishDate": "2018-08-16T00:00:00.000Z",
    "solution": "Fixed in version [**7.8p1**](http://www.openssh.com/portable.html) of Portable implementation by [this](https://anongit.mindrot.org/openssh.git/commit/?id=74287f5df9966a0648b4a68417451dd18f079ab8) commit.\nFixed in version [**7.8**](http://www.openssh.com/openbsd.html) of OpenBSD implementation by [this](https://github.com/openbsd/src/commit/779974d35b4859c07bc3cb8a12c74b43b0a7d1e0) commit.\n\nLatest stable releases:\n* [OpenSSH Portable Release](http://www.openssh.com/portable.html)\n* [OpenSSH for OpenBSD](http://www.openssh.com/openbsd.html)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dariusz Tytko and Micha\u0142 Sajdak",
    "workaround": "",
    "vendorFixDate": "2018-07-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-2820",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-209"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2018-15473",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-2820/ranges"
            },
            {
                "rel": "reference",
                "href": "http://seclists.org/oss-sec/2018/q3/124",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://www.openssh.com/openbsd.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.openssh.com/portable.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.openwall.com/lists/oss-security/2018/08/16/1",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://anongit.mindrot.org/openssh.git/commit/?id=74287f5df9966a0648b4a68417451dd18f079ab8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openbsd/src/commit/779974d35b4859c07bc3cb8a12c74b43b0a7d1e0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssh/openssh-portable/commit/74287f5df9966a0648b4a68417451dd18f079ab8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://sekurak.pl/openssh-users-enumeration-cve-2018-15473/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/45210/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-2820/default-remediation-status"
            }
        ]
    }
}