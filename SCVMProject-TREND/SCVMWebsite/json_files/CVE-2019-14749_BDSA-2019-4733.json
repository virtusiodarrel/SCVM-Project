{
    "source": "BDSA",
    "name": "BDSA-2019-4733",
    "title": "osTicket Vulnerable to CSV Injection (Formula Injection) via Improper Input Validation in Multiple Fields",
    "description": "osTicket contains a CSV Injection vulnerability due to insufficient validation of user controlled input. An attacker could insert malicious content, a windows formula for example,into a visualization which would be treated as a valid formula in a spreadsheet application. As a result the malicious formula would be executed in the victims application when the CSV file is exported and opened.",
    "technicalDescription": "The vulnerability occurs due to insufficient sanitization of user supplied input in the Name and Internal Notes fields in the Users tab, and the Issue Summary field in the tickets tab. \n\nThe issue was addressed by adding the validator `is_formula()` to any text field that allows user-input in\nthe system and a further protection mechanism to escape input matching the formula regex with a single quote to the export functionality.",
    "publishedDate": "2020-10-07T16:20:11.601Z",
    "updatedDate": "2020-10-07T20:58:33.703Z",
    "disclosureDate": "2019-08-12T00:00:00.000Z",
    "exploitPublishDate": "2019-08-12T00:00:00.000Z",
    "solution": "Fixed in [**1.12.1**](https://github.com/osTicket/osTicket/releases/tag/v1.12.1) by [this](https://github.com/osTicket/osTicket/commit/99818486c5b1d8aa445cee232825418d6834f249) commit.\nFixed in [**1.10.7**](https://github.com/osTicket/osTicket/releases/tag/v1.10.7) by [this](https://github.com/osTicket/osTicket/commit/99818486c5b1d8aa445cee232825418d6834f249) commit.\n\nThe latest stable releases are available [here](https://github.com/osTicket/osTicket/tags)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Aishwarya Iyer",
    "workaround": "",
    "vendorFixDate": "2019-07-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4733",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-74"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14749",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4733/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/commit/99818486c5b1d8aa445cee232825418d6834f249",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/commit/99818486c5b1d8aa445cee232825418d6834f249",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/releases/tag/v1.10.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/releases/tag/v1.12.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/47225",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/47225",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4733/default-remediation-status"
            }
        ]
    }
}