{
    "source": "BDSA",
    "name": "BDSA-2020-4277",
    "title": "Grav Admin Plugin Vulnerable to Sensitive Information Disclosure via Path Traversal in Backup Functionality",
    "description": "The Grav Admin Plugin is vulnerable to a sensitive information disclosure issue due to a lack of sufficient input validation in the backup functionality. \n\nA malicious user with administrative credentials could supply a relative path to the backup file download functionality in order to perform a path traversal attack and download arbitrary files from the file system.",
    "technicalDescription": "The Grav Admin Plugin is vulnerable is sensitive information disclosure because the `taskBackup()` function in the `classes/admincontroller.php` file does not correctly check the path of the file to be backed up. This function can accept a relative path to a known file and allow administrative users to download arbitrary and potentially sensitive files.\n\nDepending on the Grav configuration, it could be possible for files outside of the webroot to be accessed.",
    "publishedDate": "2021-03-16T16:42:02.966Z",
    "updatedDate": "2021-03-16T16:42:02.960Z",
    "disclosureDate": "2020-12-10T00:00:00.000Z",
    "exploitPublishDate": "2021-03-04T00:00:00.000Z",
    "solution": "Fixed in [**1.9.18**](https://github.com/getgrav/grav-plugin-admin/releases/tag/1.9.18) by [this](https://github.com/getgrav/grav-plugin-admin/commit/c32fa412b7a7a0f67a5010e47e8b5e35f3d29705) commit.\n\nThe latest stable releases are available [here](https://github.com/getgrav/grav-plugin-admin/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-11-30T00:00:00.000Z",
    "discoveryDate": "2020-11-21T00:00:00.000Z",
    "vendorNotifiedDate": "2020-11-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4277",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-29556",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4277/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.bssi.fr/cve-2020-29553-cve-2020-29555-cve-2020-29556-multiple-vulnerabilities-within-cms-grav/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.bssi.fr/cve-2020-29553-cve-2020-29555-cve-2020-29556-multiple-vulnerabilities-within-cms-grav/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/getgrav/grav-plugin-admin/commit/c32fa412b7a7a0f67a5010e47e8b5e35f3d29705",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/getgrav/grav-plugin-admin/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/getgrav/grav-plugin-admin/releases/tag/1.9.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/getgrav/grav-plugin-admin/security/advisories/GHSA-vrvq-2pxg-rw5r",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.youtube.com/watch?v=wCcwV13Q2_E",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4277/default-remediation-status"
            }
        ]
    }
}