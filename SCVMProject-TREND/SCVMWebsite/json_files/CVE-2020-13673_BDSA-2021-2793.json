{
    "source": "BDSA",
    "name": "BDSA-2021-2793",
    "title": "Drupal Core Vulnerable to Cross-Site Request Forgery (CSRF) via Media Module",
    "description": "Drupal Core is vulnerable to cross-site request forgery (CSRF). This could be exploited by an unprivileged attacker to trick a user into executing unintentional actions.",
    "technicalDescription": "This vulnerability exists due to the Media module in Drupal Core allowing internal and external media to be embedded in content fields. This could allow an unprivileged attacker to inject HTML into a page when it is accessed by a trusted user who has the permission to embed media. This could lead to the attacker being able to trick the user into executing unintentional actions, and could also potentially be used to launch a cross-site scripting (XSS) attack. \n\nThe vendor has mitigated against this by included addition CSRF validation checks in `core/modules/media/src/Controller/MediaFilterController.php`.",
    "publishedDate": "2021-09-16T11:01:03.190Z",
    "updatedDate": "2021-09-16T11:01:03.178Z",
    "disclosureDate": "2021-09-15T00:00:00.000Z",
    "solution": "Fixed in:\n* [**9.2.6**](https://github.com/drupal/drupal/releases/tag/9.2.6) by [this](https://github.com/drupal/drupal/commit/741a4f6bfbfc72202274b56936327070bdfe9892) commit,\n* [**9.1.13**](https://github.com/drupal/drupal/releases/tag/9.1.13) by [this](https://github.com/drupal/drupal/commit/2a89e7cb90a96c49444d06f5dde472d192bbbba7) commit,\n* [**8.9.19**](https://github.com/drupal/drupal/releases/tag/8.9.19) by [this](https://github.com/drupal/drupal/commit/92035ee5938c92ea036be5c2429807cb54810454) commit.\n\nThe latest stable releases are available [here](https://www.drupal.org/project/drupal).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Aaron Zinck",
    "workaround": "",
    "vendorFixDate": "2021-09-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2793",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13673",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2793/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/drupal/commit/2a89e7cb90a96c49444d06f5dde472d192bbbba7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/drupal/commit/741a4f6bfbfc72202274b56936327070bdfe9892",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/drupal/commit/92035ee5938c92ea036be5c2429807cb54810454",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/drupal/releases/tag/8.9.19",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/drupal/releases/tag/9.1.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/drupal/releases/tag/9.2.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/drupal",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-core-2021-006",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2793/default-remediation-status"
            }
        ]
    }
}