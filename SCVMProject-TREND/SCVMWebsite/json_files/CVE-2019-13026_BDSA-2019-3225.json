{
    "source": "BDSA",
    "name": "BDSA-2019-3225",
    "title": "OXID eShop Vulnerable to SQL Injection via Crafted URL",
    "description": "OXID eShop allows SQL Injection via a crafted URL, leading to full access by an unauthenticated attacker, including shopping cart options, customer data, and the application database. An attacker could exploit this vulnerability without further user interaction required.",
    "technicalDescription": "An attacker can set the `sorting` parameter to an SQL query which will eventually be injected into the following statement in the function `_getVendorSelect `(file `source/Application/Model/ArticleList.php`):\n\n`$sSelect .= \" ORDER BY {$this->_sCustomSorting} \";` \n\nThe attacker can use this exploit to view and modify the underlying database. This includes inserting a new admin user with a self chosen password.\n\nAfter gaining access to the backend the attacker can then launch a remote code execution exploit via a PHP object injection vulnerability, as disclosed in BDSA-2019-3229.",
    "publishedDate": "2019-10-18T08:33:58.122Z",
    "updatedDate": "2019-10-18T08:52:52.451Z",
    "disclosureDate": "2019-07-29T00:00:00.000Z",
    "exploitPublishDate": "2019-07-29T00:00:00.000Z",
    "solution": "Fixed in [**6.1.4**](https://oxidforge.org/en/oxid-eshop-version-6-1-4.html) and [**6.0.5**](https://oxidforge.org/en/oxid-eshop-version-6-0-5.html) by [this](https://github.com/OXID-eSales/oxideshop_ce/commit/b7395392ea3d27feb1bfedbc0d1661e90310703d) commit.",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.0
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Robin Peraglie",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, the vendor recommends as a temporary measure adding the following `mod_rewrite` rules right after `RewriteBase /` in `source/.htaccess` line 4:\n\n```\nRewriteCond %{QUERY_STRING} \\bsorting=[^\\&\\=]*[^a-z]+[^\\&\\=]*(\\&|$) [NC]\nRewriteRule .* - [F]\n```",
    "vendorFixDate": "2019-07-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 9.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3225",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13026",
                "label": "NVD"
            },
            {
                "rel": "child-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3229",
                "label": "BDSA"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3225/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.ripstech.com/2019/oxid-esales-shop-software/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.ripstech.com/2019/oxid-esales-shop-software/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://bugs.oxid-esales.com/view.php?id=7002",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OXID-eSales/oxideshop_ce/commit/b7395392ea3d27feb1bfedbc0d1661e90310703d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://oxidforge.org/en/security-bulletin-2019-001.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3225/default-remediation-status"
            }
        ]
    }
}