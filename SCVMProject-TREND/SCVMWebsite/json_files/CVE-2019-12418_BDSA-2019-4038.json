{
    "source": "BDSA",
    "name": "BDSA-2019-4038",
    "title": "Apache Tomcat Vulnerable to Privilege Escalation via RMI Registry Manipulation",
    "description": "Apache Tomcat is vulnerable to privilege escalation due to insufficient protections on manipulation of the RMI registry when Tomcat is configured with the JMX Remote Lifecycle Listener. This could allow a local attacker to obtain credentials to the JMX interface and compromise the Tomcat instance.",
    "technicalDescription": "The issue exists due to insufficient protections on the RMI registry within the file `java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java`. When the JMX Remote Lifecycle Listener is configured, credentials for the JMX interface can be captured by a local attacker, without access to the Tomcat configuration or process, by modifying the RMI registry. Access to the JMX interface can allow the attacker to fully compromise the Tomcat instance.\n\nThe vendor states that CVE-2019-2684, a vulnerability in the RMI component of Java SE, can be leveraged to exploit this issue remotely.",
    "publishedDate": "2019-12-24T15:22:23.363Z",
    "updatedDate": "2021-03-30T08:36:39.638Z",
    "disclosureDate": "2019-12-18T00:00:00.000Z",
    "solution": "Fixed in:\n* **[9.0.29](https://github.com/apache/tomcat/releases/tag/9.0.29)** by [this](https://github.com/apache/tomcat/commit/1fc9f58) commit.\n* **[8.5.48](https://github.com/apache/tomcat/releases/tag/8.5.48)** by [this](https://github.com/apache/tomcat/commit/a91d7db) commit,\n* **[7.0.98](https://github.com/apache/tomcat/releases/tag/7.0.98)** by [this](https://github.com/apache/tomcat/commit/bef3f40) commit.\n\nThe latest stable releases are available [here](https://tomcat.apache.org/index.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "An Trinh (Viettel Cyber Security)",
    "workaround": "",
    "vendorFixDate": "2019-11-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4038",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12418",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4038/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/1fc9f58",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/a91d7db",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/commit/bef3f40",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/7.0.98",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/8.5.48",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tomcat/releases/tag/9.0.29",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/43530b91506e2e0c11cfbe691173f5df8c48f51b98262426d7493b67%40%3Cannounce.tomcat.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://tomcat.apache.org/index.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4038/default-remediation-status"
            }
        ]
    }
}