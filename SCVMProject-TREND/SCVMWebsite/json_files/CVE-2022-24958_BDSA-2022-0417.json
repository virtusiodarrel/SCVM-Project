{
    "source": "BDSA",
    "name": "BDSA-2022-0417",
    "title": "Linux Kernel Vulnerable to Memory Corruption via Use-After-Free Following 'dev_config()' Failure",
    "description": "The Linux kernel is vulnerable to memory corruption due to the improper releasing of several heap-based buffers. An attacker could potentially leverage this issue in order to achieve arbitrary code execution in the kernel, but this has not been demonstrated.",
    "technicalDescription": "The function `dev_config()`, of file `drivers/usb/gadget/legacy/inode.c`, utilizes a `struct dev_data` structure which contains references to the heap memory buffers `config`, `hs_config` and `dev`. If the function fails, then these buffers are freed. However, the aforementioned references to these buffers retain their original values. Code that exists outside of the function may still try to access the freed heap memory buffers via these references. An attacker could potentially leverage this issue in order to execute arbitrary code in the kernel and escalate their privileges to that of the root user. However, such an attack has not been demonstrated.",
    "publishedDate": "2022-02-11T16:48:42.070Z",
    "updatedDate": "2022-02-11T16:48:42.051Z",
    "disclosureDate": "2022-02-11T00:00:00.000Z",
    "solution": "Fixed in version [**5.17-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=501e38a5531efbd77d5c73c0ba838a889bfc1d74) commit and [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=89f3594d0de58e8a57d92d497dea9fee3d4b9cda) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "UNCORROBORATED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:UR)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "REASONABLE",
            "score": 6.2
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-01-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0417",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-664"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24958",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0417/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=501e38a5531efbd77d5c73c0ba838a889bfc1d74",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=89f3594d0de58e8a57d92d497dea9fee3d4b9cda",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit?id=89f3594d0de58e8a57d92d497dea9fee3d4b9cda",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/all/20211231172138.7993-1-hbh25y@gmail.com/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0417/default-remediation-status"
            }
        ]
    }
}