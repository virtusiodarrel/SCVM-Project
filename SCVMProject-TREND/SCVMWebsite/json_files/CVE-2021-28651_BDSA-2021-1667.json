{
    "source": "BDSA",
    "name": "BDSA-2021-1667",
    "title": "Squid Vulnerable to Denial-of-Service (DoS) via Memory Leak in 'urnParseReply' Function",
    "description": "Squid is vulnerable to denial-of-service (DoS) via a memory leak in the `urnParseReply` function. A malicious server in collaboration with a trusted client will consume arbitrarily large amounts of memory on the server running Squid. This will impact all services on the machine running Squid. This situation will persist until Squid is shut down. \n\nThis attack is limited to proxies which try to resolve a `urn` resource identifier. This is disabled by default in Squid.",
    "technicalDescription": "When resolving a request with the urn scheme the parser leaks a small amount of memory. In the file `src/urn.cc` the memory leak can occur in the function `urnParseReply`: \n\n`char *buf = xstrdup(inbuf);`\n\nThe memory associated with `buf` is never freed.",
    "publishedDate": "2021-06-04T13:34:11.869Z",
    "updatedDate": "2021-06-04T13:34:11.861Z",
    "disclosureDate": "2021-05-10T00:00:00.000Z",
    "solution": "Fixed in [**4.15**](http://www.squid-cache.org/Versions/v4/) and [**5.0.6**](http://www.squid-cache.org/Versions/v5/) by [this](https://github.com/squid-cache/squid/commit/74e158ce7b9131e62f592db011fa6eaca44c9dca) commit.\n\nThe latest stable releases are available [here](http://www.squid-cache.org/Versions/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.7,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Joshua Rogers of Opera Software",
    "workaround": "The vendor has provided the following advice for mitigation:\n\nDisable URN processing by the proxy. Add these lines to `squid.conf`:\n\n`acl URN proto URN`\n`http_access deny URN`",
    "vendorFixDate": "2021-02-24T00:00:00.000Z",
    "vendorNotifiedDate": "2021-02-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1667",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-401"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28651",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1667/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v5/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/74e158ce7b9131e62f592db011fa6eaca44c9dca",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/pull/778",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-ch36-9jhx-phm4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-ch36-9jhx-phm4",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1667/default-remediation-status"
            }
        ]
    }
}