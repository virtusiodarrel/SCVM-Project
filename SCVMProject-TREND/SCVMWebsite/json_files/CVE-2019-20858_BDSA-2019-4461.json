{
    "source": "BDSA",
    "name": "BDSA-2019-4461",
    "title": "Mattermost Server Vulnerable to Denial-of-Service (DoS) via SQL 'LIKE' Clause Resource Consumption",
    "description": "Mattermost Server is vulnerable to a denial-of-service (DoS) condition due to a lack of sanitization on the 'LIKE' clause for user search terms.\n\nAn attacker could insert a crafted search term containing special characters in order to cause some API endpoints to spend CPU cycles processing, slowing down execution of other tasks.",
    "technicalDescription": "Mattermost Server is vulnerable to a denial-of-service (DoS) condition because various search queries contain 'LIKE' clauses that users can manipulate. \n\nThese clauses are not completely sanitized allowing for special SQL characters, like wildcards, to be inserted. This means some API endpoints are then susceptible to regular expression denial-of-service (ReDoS), where CPU cycles are spent processing potentially complicated queries. This high CPU usage can slow down other tasks on the database server or prevent them from completing.",
    "publishedDate": "2020-07-01T13:39:34.065Z",
    "updatedDate": "2020-07-01T13:39:34.056Z",
    "disclosureDate": "2019-09-16T00:00:00.000Z",
    "solution": "Fixed in [**5.15.0**](https://github.com/mattermost/mattermost-server/releases/tag/v5.15.0) by [this](https://github.com/mattermost/mattermost-server/commit/4691fb46b6adc1d829be4653d155b784d625128a) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Roman Shchekin",
    "workaround": "",
    "vendorFixDate": "2019-09-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4461",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-624"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20858",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4461/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.mattermost.com/administration/changelog.html#release-v5-15-quality-release",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/commit/4691fb46b6adc1d829be4653d155b784d625128a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/pull/12044",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/releases/tag/v5.15.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mattermost.com/security-updates/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4461/default-remediation-status"
            }
        ]
    }
}