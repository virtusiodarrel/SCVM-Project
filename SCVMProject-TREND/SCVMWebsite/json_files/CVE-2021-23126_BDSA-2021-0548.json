{
    "source": "BDSA",
    "name": "BDSA-2021-0548",
    "title": "Joomla Vulnerable to Insufficient Two Factor Authentication Secret via Use of Insecure 'Rand' Function",
    "description": "Joomla contains an insufficient two factor authentication secret vulnerability due to insecure randomness when generating the 2FA secret. An attacker may be able to exploit this flaw to bypass two factor authentication and log in to the system if they also have valid credentials of another user.",
    "technicalDescription": "The vulnerability occurs due to the use of the insecure `rand()` function when generating the two factor authentication (2FA) secret. The issue was mitigated by implementing the more secure method `random_bytes` in place of the insecure `rand` function.",
    "publishedDate": "2021-03-05T16:50:43.137Z",
    "updatedDate": "2021-03-05T17:45:11.869Z",
    "disclosureDate": "2021-03-01T00:00:00.000Z",
    "solution": "Fixed in [**3.9.25**](https://github.com/joomla/joomla-cms/releases/tag/3.9.25) by [this](https://github.com/joomla/joomla-cms/commit/aadf6979f8b99308c3621ea3af2ca98e678a477d) commit.\n\nThe latest stable releases are available [here](https://github.com/joomla/joomla-cms/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-03-02T00:00:00.000Z",
    "vendorNotifiedDate": "2021-01-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0548",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-338"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23126",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0548/ranges"
            },
            {
                "rel": "reference",
                "href": "https://developer.joomla.org/security-centre/841-20210301-core-insecure-randomness-within-2fa-secret-generation.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/joomla/joomla-cms/commit/aadf6979f8b99308c3621ea3af2ca98e678a477d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/joomla/joomla-cms/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/joomla/joomla-cms/releases/tag/3.9.25",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0548/default-remediation-status"
            }
        ]
    }
}