{
    "source": "BDSA",
    "name": "BDSA-2019-4166",
    "title": "Mozilla Client Applications Vulnerable to Cross-site Scripting (XSS) via Improperly Implemented CSS Escaping",
    "description": "Firefox, Firefox ESR and Thunderbird are vulnerable to cross-site scripting (XSS) due to the improper implementation of a security mechanism. A remote attacker could execute malicious scripts within the browser of a victim by tricking the victim into opening maliciously crafted web content. It should be noted that this vulnerability can only be exploited for web pages that conduct certain actions.",
    "technicalDescription": "The issue exists in the CSS sanitizer. `<style>` tags are not escaped whenever they are copied from the clipboard into a rich text editor, leading to a potential XSS vulnerability. The string will be pasted directly into the text node of the element, and so any malicious scripts specified by an attacker will only be executed in cases where a web page copies the text node's innerHTML to another innerHTML.",
    "publishedDate": "2020-01-15T16:59:23.962Z",
    "updatedDate": "2020-08-11T15:13:41.403Z",
    "disclosureDate": "2019-01-07T00:00:00.000Z",
    "exploitPublishDate": "2020-06-05T00:00:00.000Z",
    "solution": "Fixed in version [**72.0**](https://ftp.mozilla.org/pub/firefox/releases/) of Firefox by [this](https://hg.mozilla.org/releases/mozilla-release/rev/7e9e38f8bd84419fad4c10b2e5bba22dca6381c9) commit and in version [**68.4.0**](https://ftp.mozilla.org/pub/firefox/releases/) of Firefox ESR by [this](https://hg.mozilla.org/releases/mozilla-esr68/rev/34c6d0d056ced736ccbeb47120740497f1febfbd) commit.\n\nFixed in version [**68.4.1**](https://archive.mozilla.org/pub/thunderbird/releases/) of Thunderbird.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.0,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 1.6,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Micha\u0142 Bentkowski",
    "workaround": "",
    "vendorFixDate": "2019-01-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4166",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-693"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-17022",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4166/ranges"
            },
            {
                "rel": "reference",
                "href": "https://archive.mozilla.org/pub/thunderbird/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1602843",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1602843",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-esr68/rev/34c6d0d056ced736ccbeb47120740497f1febfbd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/7e9e38f8bd84419fad4c10b2e5bba22dca6381c9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2020-01/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2020-02/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2020-04/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4166/default-remediation-status"
            }
        ]
    }
}