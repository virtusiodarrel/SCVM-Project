{
    "source": "BDSA",
    "name": "BDSA-2022-1119",
    "title": "OWASP AntiSamy Vulnerable to Cross-Site Scripting (XSS) via HTML Tag Smuggling through 'STYLE' Content",
    "description": "OWASP AntiSamy has a cross-site scripting (XSS) vulnerability due to an absence of correct parameter input validation. A remote attacker could insert JavaScript code and steal a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "This vulnerability exists in `src/main/java/org/owasp/validator/html/scan/AntiSamyDOMScanner.java` file. The `processStyleTag()` function in this file does not properly sanitize the content from Cascading Style Sheets (CSS). An attacker could smuggle HTML tags in the output by supplying crafted input through the CSS content. They could share a crafted URL with a victim. When the victim interacts with this URL, the malicious code within the URL will execute within the victim's browser. Exploiting this flaw will allow the attacker to steal sensitive information like session tokens and cookies.\n\n**Note** This vulnerability was originally fixed in version [**1.6.6**](https://github.com/nahsra/antisamy/releases/tag/v1.6.6) by [this](https://github.com/nahsra/antisamy/commit/0199e7e194dba5e7d7197703f43ebe22401e61ae) commit. But the fix was incomplete and this vulnerability has been tracked further using **CVE-2022-29577**. The issue has been completely fixed in **v1.6.7**.",
    "publishedDate": "2022-04-22T12:13:32.577Z",
    "updatedDate": "2022-08-22T12:03:09.878Z",
    "disclosureDate": "2022-03-27T00:00:00.000Z",
    "solution": "Fixed in version [**1.6.7**](https://github.com/nahsra/antisamy/releases/tag/v1.6.7) by [this](https://github.com/nahsra/antisamy/commit/32e273507da0e964b58c50fd8a4c94c9d9363af0) commit.\n\nThe latest stable releases can be found [here](https://github.com/nahsra/antisamy/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-04-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1119",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-28367",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1119/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nahsra/antisamy/commit/0199e7e194dba5e7d7197703f43ebe22401e61ae",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nahsra/antisamy/commit/0199e7e194dba5e7d7197703f43ebe22401e61ae",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nahsra/antisamy/commit/32e273507da0e964b58c50fd8a4c94c9d9363af0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nahsra/antisamy/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nahsra/antisamy/releases/tag/v1.6.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nahsra/antisamy/releases/tag/v1.6.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1119/default-remediation-status"
            }
        ]
    }
}