{
    "source": "BDSA",
    "name": "BDSA-2019-2787",
    "title": "Ansible Vulnerable to Information Exposure via Logging GCP Fields during Errors",
    "description": "Ansible is vulnerable to information exposure. This is due to Ansible incorrectly logging certain data relating to Google Cloud Platform (GCP) when an error occurs. An attacker that has overall access to Ansible's logs could use this to obtain sensitive system information including credentials.",
    "technicalDescription": "The information exposure is due to Ansible not handling exceptions when decoding GCP JSON content.  This occurs in the `_credentials()` function in `lib/ansible/module_utils/gcp_utils.py`.  Since Ansible also does not set the `no_log` boolean on `service_account_contents` data, it is possible that an attacker with access to Ansible logs could obtain  sensitive information relating to `service_account_contents`.",
    "publishedDate": "2019-09-03T10:37:50.875Z",
    "updatedDate": "2022-08-12T09:43:44.124Z",
    "disclosureDate": "2019-07-27T00:00:00.000Z",
    "solution": "Fixed in version [**2.9.0b1**](https://github.com/ansible/ansible/releases/tag/v2.9.0b1) by commits [one](https://github.com/ansible/ansible/commit/61d60d07d1aaf2d270814921ece58db5e7c5ffec) and [two](https://github.com/ansible/ansible/commit/c1ee1f142db1e669b710a65147ea32be47a91519).\n\nThe latest stable releases can be found [here](https://github.com/ansible/ansible/tags).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Romain Albon",
    "workaround": "",
    "vendorFixDate": "2019-07-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2787",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-779"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10217",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2787/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1733509",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/08918c6c2bcd73eb40b89af31736d3fcbe55e75a",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/61d60d07d1aaf2d270814921ece58db5e7c5ffec",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/c1ee1f142db1e669b710a65147ea32be47a91519",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/issues/56269",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases/tag/v2.9.0b1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2787/default-remediation-status"
            }
        ]
    }
}