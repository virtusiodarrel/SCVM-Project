{
    "source": "BDSA",
    "name": "BDSA-2020-1218",
    "title": "Dolibarr Vulnerable to Stored Cross-Site Scripting (XSS) via Missing 'attachment' Parameter",
    "description": "Dolibarr is vulnerable to stored cross-site scripting (XSS) due to the improper implementation of a security mechanism. A remote authenticated attacker could execute malicious scripts in the browser of a victim by tricking them into clicking on a crafted link.",
    "technicalDescription": "The DMS/ECM module within Dolibarr allows users to upload files, and then share those files with other users via a link. Dolibarr will append the `.noexe`extension to files that may contain executable code. This is implemented using the function `isAFileWithExecutableContent()`, which is defined within the file `functions.lib.php`. This function calls `preg_match()` in order to detect dangerous file extensions. If an attacker is able to modify the name of an uploaded file, they can change the extension from `.noexe` to `.html` after the file has been processed by `isAFileWithExecutableContent()`. \n\nThe response that a user receives when they click on the sharing link is generated using code contained within `document.php`. The link has a default format, with one of its parameters being `attachment`. If this is set to `1` (true), the user who clicks on the link will receive a prompt to download the file. If set to `0` (false), the file rendered in the user's browser. If the `attachment` parameter is missing from the link when it is clicked on, the application will default to the false case. A remote attacker could therefore upload a file that contains malicious JavaScript, and then manipulate the sharing link to ensure that the file is rendered in the victim's browser. This will cause the script to be executed, potentially allowing the attacker to obtain sensitive information such as browser cookies.",
    "publishedDate": "2020-05-26T12:01:20.204Z",
    "updatedDate": "2020-10-01T09:00:43.025Z",
    "disclosureDate": "2020-05-17T00:00:00.000Z",
    "exploitPublishDate": "2020-05-17T00:00:00.000Z",
    "solution": "Fixed [**11.0.5**](https://github.com/Dolibarr/dolibarr/releases/tag/11.0.5) by [this](https://github.com/Dolibarr/dolibarr/commit/a207365bd2f3373405e04ebd292b29529d3b4217) commit.\n\nThe latest stable releases are available [here](https://github.com/Dolibarr/dolibarr/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-07-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1218",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13239",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1218/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/commit/a207365bd2f3373405e04ebd292b29529d3b4217",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/releases/tag/11.0.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.dubget.com/stored-xss-via-file-upload.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.dubget.com/stored-xss-via-file-upload.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1218/default-remediation-status"
            }
        ]
    }
}