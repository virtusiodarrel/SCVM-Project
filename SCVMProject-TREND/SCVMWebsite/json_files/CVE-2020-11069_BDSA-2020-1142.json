{
    "source": "BDSA",
    "name": "BDSA-2020-1142",
    "title": "TYPO3 Vulnerable to Same-Site Request Forgery via Backend User Interface and Install Tool",
    "description": "TYPO3 is vulnerable to same-site request forgery via the backend user interface and the install tool. Legitimate users could be tricked into interacting with a resource previously uploaded by an attacker and have malicious web scripts executed on their behalf. This could result in damage to TYPO3's integrity, as well as stolen private information such as session tokens.",
    "technicalDescription": "In order to upload the payload the attacker must either be an authenticated backend user or use a 3rd party extension that allows file uploads to known locations.\n\nThis vulnerability was fixed by enforcing a proper HTTP `Referer` header to ensure that the previous authenticated request has originated from the TYPO3 backend user interface or install tool.",
    "publishedDate": "2020-05-18T16:05:19.124Z",
    "updatedDate": "2020-05-18T16:05:19.120Z",
    "disclosureDate": "2020-05-12T00:00:00.000Z",
    "solution": "Fixed in [**9.5.17**](https://github.com/TYPO3/TYPO3.CMS/releases/tag/v9.5.17) by [this](https://github.com/TYPO3/TYPO3.CMS/commit/deaf931cf45d37daf0a490d4ac7a910ebf1a25f1) commit.\n\nFixed in [**10.4.2**](https://github.com/TYPO3/TYPO3.CMS/releases/tag/v10.4.2) by [this](https://github.com/TYPO3/TYPO3.CMS/commit/1b28fec3af40f085299af2a93adc38030365043c) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.6,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 2.1,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matteo Bonaker",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, the vendor suggests using the `Sudo Mode` extension, which intercepts modifications to security relevant database tables, preventing unintended background actions from happening. \n\nThe vendor also suggests using Content Security Policies to disallow direct script execution at least for locations `/fileadmin/` and `/uploads/`.",
    "vendorFixDate": "2020-05-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1142",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11069",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1142/ranges"
            },
            {
                "rel": "reference",
                "href": "https://extensions.typo3.org/extension/sudo_mode",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/commit/1b28fec3af40f085299af2a93adc38030365043c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/commit/deaf931cf45d37daf0a490d4ac7a910ebf1a25f1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/releases/tag/v10.4.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/releases/tag/v9.5.17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TYPO3/TYPO3.CMS/security/advisories/GHSA-pqg8-crx9-g8m4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-core-sa-2020-006",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-core-sa-2020-006",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1142/default-remediation-status"
            }
        ]
    }
}