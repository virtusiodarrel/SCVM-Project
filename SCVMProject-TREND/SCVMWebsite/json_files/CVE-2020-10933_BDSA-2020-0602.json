{
    "source": "BDSA",
    "name": "BDSA-2020-0602",
    "title": "Ruby Vulnerable to Heap Memory Disclosure via Socket Library",
    "description": "Ruby contains a heap memory exposure vulnerability within the socket library. An attacker could exploit this by carrying out blocking operations, which will allow them to obtain a string buffer that contains arbitrary data from heap memory.",
    "technicalDescription": "The methods `BasicSocket#recv_nonblock()` and `BasicSocket#read_nonblock()` are given size and buffer arguments, which are used to resize the buffer. In situations where operations are blocked, the vulnerable methods return without copying the specified memory. They will return the string buffer instead, which contains arbitrary data from heap memory.\n\nIf an attacker can invoke operations to block, they may be able to extract sensitive information from the returned arbitrary heap memory.\n\nThis was addressed by only resizing the buffer when data is received in the method `BasicSocket#read_nonblock()`and other particular methods.",
    "publishedDate": "2020-04-01T11:38:24.714Z",
    "updatedDate": "2020-04-01T11:38:24.708Z",
    "disclosureDate": "2020-03-31T00:00:00.000Z",
    "solution": "Fixed in:\n* [**2.5.8**](https://www.ruby-lang.org/en/news/2020/03/31/ruby-2-5-8-released/) by [this](https://github.com/ruby/ruby/commit/d5e7ea9e217568dfaf898ec82e8bc2c7ee2deb93) commit.\n* [**2.6.6**](https://www.ruby-lang.org/en/news/2020/03/31/ruby-2-6-6-released/) by [this](https://github.com/ruby/ruby/commit/d0012e50aeab3af26705f62aca542c6834922635) commit.\n* [**2.7.1**](https://www.ruby-lang.org/en/news/2020/03/31/ruby-2-7-1-released/) by [this](https://github.com/ruby/ruby/commit/f832d957b837d5167058a3f8579d66e5b5d3472e) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Samuel Williams",
    "workaround": "",
    "vendorFixDate": "2020-03-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0602",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-908"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10933",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0602/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/d0012e50aeab3af26705f62aca542c6834922635",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/d5e7ea9e217568dfaf898ec82e8bc2c7ee2deb93",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/f832d957b837d5167058a3f8579d66e5b5d3472e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2020/03/31/heap-exposure-in-socket-cve-2020-10933/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2020/03/31/ruby-2-5-8-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2020/03/31/ruby-2-6-6-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2020/03/31/ruby-2-7-1-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0602/default-remediation-status"
            }
        ]
    }
}