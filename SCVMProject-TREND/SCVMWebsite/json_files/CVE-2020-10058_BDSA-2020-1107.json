{
    "source": "BDSA",
    "name": "BDSA-2020-1107",
    "title": "Zephyr Vulnerable to Code Execution and Privilege Escalation via Insufficient Argument Validation in Kscan Subsystem",
    "description": "Zephyr contains a code execution vulnerability which could result in privilege escalation due to insufficient argument validation in kscan subsystem. An attacker with access to the kscan subsystem API could execute malicious code in userspace and potentially gain elevated privileges.",
    "technicalDescription": "The `z_vrfy_kscan_disable_callback` and `z_vrfy_kscan_enable_callback` functions in `drivers/kscan/kscan_handlers.c` failed to validate the driver object before performing the corresponding API actions. This could allow an attacker with access to the kscan subsystem API to perform code execution in user space and potentially gain elevated privileges.",
    "publishedDate": "2020-05-13T15:22:25.355Z",
    "updatedDate": "2021-07-26T11:37:23.444Z",
    "disclosureDate": "2020-05-07T00:00:00.000Z",
    "solution": "Fixed in **[v2.2.0](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.2.0)** by [this](https://github.com/zephyrproject-rtos/zephyr/commit/f669b7cb9f) commit.\n\nFixed by [this](https://github.com/zephyrproject-rtos/zephyr/commit/839bee1eb07b7c57745346a9db5adbac6a672452) commit in the **v2.1** branch which is not yet included in any release.\n\nThe latest stable releases are available [here](https://github.com/zephyrproject-rtos/zephyr/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-03-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1107",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10058",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1107/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.zephyrproject.org/latest/security/vulnerabilities.html#cve-2020-10058",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/839bee1eb07b7c57745346a9db5adbac6a672452",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/edf24998b000cc69e4187ef9890a2bd4f24fe5a5",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/f669b7cb9f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-34",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1107/default-remediation-status"
            }
        ]
    }
}