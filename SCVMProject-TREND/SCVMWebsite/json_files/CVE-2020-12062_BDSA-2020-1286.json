{
    "source": "BDSA",
    "name": "BDSA-2020-1286",
    "title": "OpenSSH Vulnerable to File Overwrite via Synchronization Mismanagement in 'scp' Client",
    "description": "OpenSSH is vulnerable to the overwriting of files due to the possibility of the file transfer mechanism becoming unsynchronized. A remote attacker could exploit this to write arbitrary files into the transfer glob or directory that has been specified by the victim. The attacker would have to trick a victim into connecting to a malicious peer containing a crafted file system to achieve this.\n\nIt should be noted that this vulnerability is not exploitable under normal circumstances, as a configuration must exist that will cause the `utimes` system call to fail.",
    "technicalDescription": "The OpenSSH `scp` client, as implemented within `scp.c`, can be used with the `-rp` flags to download a file system hierarchy on a remote server. This process makes use of the `utimes` system call. If this all fails, the client may not fail gracefully such that a message can be sent to the server that will cause the client and the server communications to become unsyncronised. The `scp` client can continue to run, but can begin interpreting the file contents being sent by the server as file metadata. An attacker could craft a malicious file system that will cause the `scp` client to overwrite already-existing files with those that have been received from the server. The attacker must trick the victim into connecting to a malicious peer in order to achieve this.\n\nIt should be noted that a non-standard configuration must be in place in order for the `utimes` system call to fail. The attacker will only be able to overwrite files that exist within the target glob or directory that has been specified by the user.",
    "publishedDate": "2020-06-05T15:25:23.417Z",
    "updatedDate": "2020-07-15T09:32:50.671Z",
    "disclosureDate": "2020-05-27T00:00:00.000Z",
    "solution": "Fixed in [**8.3**](https://github.com/openssh/openssh-portable/releases/tag/V_8_3_P1) by [this](https://github.com/openssh/openssh-portable/commit/aad87b88fc2536b1ea023213729aaf4eaabe1894) commit and [this](\nhttps://github.com/openssh/openssh-portable/commit/955854cafca88e0cdcd3d09ca1ad4ada465364a1) commit.\n\nThe latest stable releases can be found [here](https://github.com/openssh/openssh-portable/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.1,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.6,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-05-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1286",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-662"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12062",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1286/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssh/openssh-portable/commit/955854cafca88e0cdcd3d09ca1ad4ada465364a1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssh/openssh-portable/commit/aad87b88fc2536b1ea023213729aaf4eaabe1894",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssh/openssh-portable/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssh/openssh-portable/releases/tag/V_8_3_P1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openssh.com/txt/release-8.3",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1286/default-remediation-status"
            }
        ]
    }
}