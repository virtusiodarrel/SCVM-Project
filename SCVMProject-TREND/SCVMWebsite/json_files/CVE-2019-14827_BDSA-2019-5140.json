{
    "source": "BDSA",
    "name": "BDSA-2019-5140",
    "title": "Moodle Vulnerable to Cross-Site Scripting (XSS) in Mustache Templates Functionality",
    "description": "Moodle contains a cross-site scripting (XSS) vulnerability due to improper validation of user-supplied input. An attacker can exploit this to execute malicious scripts in the browser of a victim by tricking them into clicking on a crafted link.",
    "technicalDescription": "This vulnerability exists within the mustache templates via recursive rendering from contexts. This is due to the helper tags that are implemented in the template context not correctly escaping before being injected to another mustache helper. Attackers could exploit this vulnerability by injecting malicious scripts which can then be executed when rendered in the victim's browser.",
    "publishedDate": "2021-05-18T13:35:59.012Z",
    "updatedDate": "2021-05-18T13:35:59.006Z",
    "disclosureDate": "2019-09-16T00:00:00.000Z",
    "solution": "Fixed in:\n* **[3.7.2](https://git.moodle.org/gw?p=moodle.git;a=commit;h=6a30269d98d8e939930f5fea71fc82da6824806e)**\n* **[3.6.6](https://git.moodle.org/gw?p=moodle.git;a=commit;h=7de0c0f1ad6452b2562bdb7ea0349ab84e81e35f)**\n* **[3.5.8](https://git.moodle.org/gw?p=moodle.git;a=commit;h=4a852e846705b7a396895cba7b2da348af170a50)** by the following commits:\n* [Commit 1](https://git.moodle.org/gw?p=moodle.git;a=commit;h=f9664b0c194059cc6e9852d5762d1342808dbb4d)\n* [Commit 2](https://git.moodle.org/gw?p=moodle.git;a=commit;h=3fb0cbd4bba965f952181539f925cf4ccc8577d7)\n\nThe latest stable releases are also available [here](https://git.moodle.org/gw?p=moodle.git;a=tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sam Hemelryk and Andrew Nicols",
    "workaround": "",
    "vendorFixDate": "2019-09-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5140",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14827",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5140/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=3fb0cbd4bba965f952181539f925cf4ccc8577d7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=4a852e846705b7a396895cba7b2da348af170a50",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=6a30269d98d8e939930f5fea71fc82da6824806e",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=7de0c0f1ad6452b2562bdb7ea0349ab84e81e35f",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=f9664b0c194059cc6e9852d5762d1342808dbb4d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=391030",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5140/default-remediation-status"
            }
        ]
    }
}