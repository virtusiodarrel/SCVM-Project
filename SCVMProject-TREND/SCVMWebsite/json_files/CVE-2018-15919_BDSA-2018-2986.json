{
    "source": "BDSA",
    "name": "BDSA-2018-2986",
    "title": "OpenSSH Vulnerable to User Enumeration via 'postpone' in 'auth2-gss.c' File",
    "description": "OpenSSH is vulnerable to username enumeration as it behaves differently in response to malicious probing based on whether the username is valid or not. If a user does not exist the server will disconnect the attacker after several attempts. An attacker can leverage this flaw to confirm valid OpenSSH usernames and by extension increase the effectiveness of brute force attacks.",
    "technicalDescription": "This flaw lies in the `userauth_gssapi()` function of the `auth2-gss.c` source file. In cases where the first step of the GSSAPI authentication process is successful the `postponed` variable is set to 1 and a `SSH2_MSG_USERAUTH_GSSAPI_RESPONSE` packet is sent in response. If that first step fails, `postponed ` is not set and `userauth_gssapi()` returns `0`.\n\nNext,  `userauth_finish()` will send back a `SSH2_MSG_USERAUTH_FAILURE` packet regardless of which of the two execution paths was taken. In theory this should prevent an attacker from being able to determine the validity of the username. However, there is another flag - `server_caused_failure`, which will only be set if the user exists. This has an impact on the behavior of the `userauth_finish()` function and is the root of the problem. \n\nIf the flag is set then the `failures` variable is not incremented and an attacker can keep attempting the GSSAPI authentication without a limit on the number of allowed attempts. Otherwise, if the user does not exist, the `failures` variable will be incremented after every attempt which will eventually result in a disconnect once `max_authtries` value is reached (6 by default).",
    "publishedDate": "2018-09-03T15:14:31.738Z",
    "updatedDate": "2020-04-17T16:06:19.583Z",
    "disclosureDate": "2018-08-28T00:00:00.000Z",
    "exploitPublishDate": "2018-08-28T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNCORROBORATED",
            "score": 4.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:U/RC:UR)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "REASONABLE",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:U/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Qualys Security Advisory team",
    "workaround": "",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-2986",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-209"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-15919",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-2986/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.openwall.com/lists/oss-security/2018/08/28/2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://www.openwall.com/lists/oss-security/2018/08/28/2",
                "label": "POC"
            }
        ]
    }
}