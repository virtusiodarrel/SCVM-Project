{
    "source": "BDSA",
    "name": "BDSA-2019-5024",
    "title": "Arm Mbed TLS Deterministic ECDSA Implementation Vulnerable to Private Key Recovery via Side-Channel Attacks",
    "description": "The deterministic ECDSA implementation in the Arm Mbed TLS project is vulnerable to side-channel attacks. A remote attacker could leverage this to recover the private key if the end application can be made to sign the same message repeatedly.",
    "technicalDescription": "The blinding technique used in the deterministic ECDSA implementation to prevent side-channel analysis is ineffective due to its implementation. This is because for the same key and message the same blinding value was generated because the same RNG object was used for generating the ephemeral key pair and for generating the blinding values. This may allow an attacker to determine the private key through side-channel analysis.\n\nApplications should switch from using the now deprecated `mbedtls_ecdsa_sign_det()` function and use the new `mbedtls_ecdsa_sign_det_ext()` function instead. This new function allows passing an external RNG for the purpose of blinding.",
    "publishedDate": "2021-02-04T10:37:58.970Z",
    "updatedDate": "2021-02-04T12:22:54.980Z",
    "disclosureDate": "2019-09-06T00:00:00.000Z",
    "solution": "Fixed in mbedtls: \n* **[2.19.0d1](https://github.com/ARMmbed/mbedtls/releases/tag/mbedtls-2.19.0d1)**\n* **[2.16.3](https://github.com/ARMmbed/mbedtls/releases/tag/mbedtls-2.16.3)** by [this](https://github.com/ARMmbed/mbedtls/commit/33f66ba6fd234114aa37f0209dac031bb2870a9b) commit.\n*  **[2.7.12](https://github.com/ARMmbed/mbedtls/releases/tag/mbedtls-2.7.12)** by [this](https://github.com/ARMmbed/mbedtls/commit/298a43a77ec0ed2c19a8c924ddd8571ef3e65dfd) commit.\n\n\nFixed in mbed-crypto [**2.0.0d2**](https://github.com/ARMmbed/mbed-crypto/releases/tag/mbedcrypto-2.0.0d2) by [this](https://github.com/ARMmbed/mbed-crypto/commit/c7cde03feca387ae32a29d9845dd28a3020f0d97) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jack Lloyd",
    "workaround": "Disabling deterministic ECDSA prevents this attack.",
    "vendorFixDate": "2019-08-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-5024",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-16910",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-5024/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ARMmbed/mbed-crypto/commit/c7cde03feca387ae32a29d9845dd28a3020f0d97",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ARMmbed/mbed-crypto/releases/tag/mbedcrypto-2.0.0d2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ARMmbed/mbedtls/commit/298a43a77ec0ed2c19a8c924ddd8571ef3e65dfd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ARMmbed/mbedtls/commit/33f66ba6fd234114aa37f0209dac031bb2870a9b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ARMmbed/mbedtls/releases/tag/mbedtls-2.16.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ARMmbed/mbedtls/releases/tag/mbedtls-2.19.0d1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ARMmbed/mbedtls/releases/tag/mbedtls-2.7.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2019-10",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2019-10",
                "label": "WORKAROUND"
            }
        ]
    }
}