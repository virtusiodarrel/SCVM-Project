{
    "source": "BDSA",
    "name": "BDSA-2021-1075",
    "title": "Multiple Mozilla Products Vulnerable to SSL Spoofing via Improper 'pageproxystate' Handling in 'browser-siteIdentity.js' File",
    "description": "Multiple Mozilla products contain a vulnerability in the way `pageproxystate` is handled for web pages. This could allow an attacker to spoofed HTTP page which has inherited the HTTPS padlock icon from another HTTPS page.",
    "technicalDescription": "This vulnerability exists in the `\nbrowser/base/content/browser-siteIdentity.js` file. Because this file does not correctly handle `pageproxystate`, HTTP URLs can inherit the HTTPS padlock icon from a different page when the application is subjected to complicated page navigations. An attacker could exploit this flaw to serve spoofed HTTPS pages to potential victims. This issue was fixed by ensuring that the correct icons are displayed depending on whether the `pageproxystate` is valid.\n\n**Note** For Mozilla Thunderbird, this flaw cannot be exploited directly through email because scripting is disabled. But it can be a risk in browsers or browser-like contexts.",
    "publishedDate": "2021-04-21T13:34:25.825Z",
    "updatedDate": "2022-04-19T10:42:37.609Z",
    "disclosureDate": "2021-04-19T00:00:00.000Z",
    "exploitPublishDate": "2021-11-22T00:00:00.000Z",
    "solution": "Fixed in Firefox [**88.0**](https://ftp.mozilla.org/pub/firefox/releases/88.0/) and Firefox ESR [**78.10.0esr**](https://ftp.mozilla.org/pub/firefox/releases/78.10.0esr/) by [this](https://hg.mozilla.org/mozilla-central/rev/e6671fdfaf4920662fe931cb00e20a8731ae50f8) commit.\n\nFixed in Thunderbird [**78.10.0**](https://ftp.mozilla.org/pub/thunderbird/releases/78.10.0/).\n\nThe latest stable Firefox releases are available [here](https://ftp.mozilla.org/pub/firefox/releases/).\n\nThe latest stable Thunderbird releases are available [here](https://ftp.mozilla.org/pub/thunderbird/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jordi Chancel",
    "workaround": "",
    "vendorFixDate": "2021-03-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1075",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-277"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-290"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23998",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1075/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1667456",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1667456",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/78.10.0esr/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/88.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/thunderbird/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/thunderbird/releases/78.10.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/e6671fdfaf4920662fe931cb00e20a8731ae50f8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-14/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-15/#CVE-2021-23998",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-16/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1075/default-remediation-status"
            }
        ]
    }
}