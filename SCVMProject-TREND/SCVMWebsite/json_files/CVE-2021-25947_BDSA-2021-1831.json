{
    "source": "BDSA",
    "name": "BDSA-2021-1831",
    "title": "nestie Package Vulnerable to Prototype Pollution via 'nestie' Function",
    "description": "nestie package is vulnerable to prototype pollution. This can allow an attacker to inject malicious properties into prototypes, which will then be inherited by all objects in that prototype chain. This could lead to denial-of-service (DoS) and remote code execution (RCE).",
    "technicalDescription": "This vulnerability exists in the `nestie()` function in the file `src/index.js`. Due to improper validation on function inputs, an attacker is able to manipulate the values to include malicious properties. The original issue was addressed in **1.0.1** by including proper validation for prototype keyword `__proto__`.\n\nHowever other properties, `constructor` and `prototype`, were not addressed until an additional patch was introduced in version **1.0.2**.",
    "publishedDate": "2021-06-18T08:59:18.550Z",
    "updatedDate": "2021-06-18T08:59:18.544Z",
    "disclosureDate": "2021-06-03T00:00:00.000Z",
    "exploitPublishDate": "2021-06-03T00:00:00.000Z",
    "solution": "The `__proto__` property was fixed in **1.0.1** by [this](https://github.com/lukeed/nestie/commit/bc80d5898d1e5e8a3d325d355eda0c325c8dcfc2) commit.\n\nHowever other properties that can be used maliciously to cause prototype pollution, `constructor` and `prototype`,  were not fixed until [**1.0.2**](https://github.com/lukeed/nestie/releases/tag/v1.0.2) by [this](https://github.com/lukeed/nestie/commit/c571c77928ecd7f256a935c7c3860f33dac4653f) commit.\n\nIt is recommended to upgrade to [**1.0.2**](https://github.com/lukeed/nestie/releases/tag/v1.0.2) to fully fix the vulnerability.\n\nThe latest stable releases are available [here](https://www.npmjs.com/package/nestie).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "",
    "workaround": "",
    "vendorFixDate": "2021-06-05T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1831",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-25947",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1831/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/lukeed/nestie/commit/bc80d5898d1e5e8a3d325d355eda0c325c8dcfc2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/lukeed/nestie/commit/c571c77928ecd7f256a935c7c3860f33dac4653f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/lukeed/nestie/releases/tag/v1.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/nestie",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-25947",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-25947",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1831/default-remediation-status"
            }
        ]
    }
}