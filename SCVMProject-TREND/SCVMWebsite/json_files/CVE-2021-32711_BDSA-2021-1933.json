{
    "source": "BDSA",
    "name": "BDSA-2021-1933",
    "title": "Shopware Vulnerable to Information Disclosure via Insecure 'store-api' Implementation",
    "description": "Shopware is vulnerable to information disclosure due to the unsafe implementation of an API. A remote attacker could recover sensitive information from the application by using maliciously crafted API requests.",
    "technicalDescription": "Shopware can use collections of fields in order to store information about Shopware entities. For example, fields can store information about customer billing addresses, email addresses and payment methods. The data that is associated with such fields can be retrieved using the various Shopware APIs. The manner in which a field is handled by a particular API is determined by the flags which are associated with that field. \n\nEach flag is implemented using a characteristic class. A flag is associated with a field by passing an instance of the relevant class to the `addFlags()` method. APIs can be restricted from accessing certain fields via the `ReadProtected` flag class. Insufficient restrictions have been placed on the Shopware Store API, which is associated with the `store-api` endpoint. An attacker could potentially exploit this API in order to recover sensitive information from a vulnerable server.",
    "publishedDate": "2021-06-28T15:55:08.599Z",
    "updatedDate": "2021-06-28T15:55:08.588Z",
    "disclosureDate": "2021-02-08T00:00:00.000Z",
    "solution": "Fixed in [**6.3.5.1**](https://github.com/shopware/platform/releases/tag/v6.3.5.1) by [this](https://github.com/shopware/platform/commit/b54b7e60e904e8a98d96fdca4e6a86d715b36753) commit and [this](https://github.com/shopware/platform/commit/5c1ec3911040fab33557c5a98df287f43ded3323) commit..\n\nThe latest stable releases are available [here](https://github.com/shopware/platform/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The Shopware security plugin can be used if an upgrade cannot be performed. The security plugin can be found [here](https://store.shopware.com/en/detail/index/sArticle/518463/number/Swag136939272659).",
    "vendorFixDate": "2021-02-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1933",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-749"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32711",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1933/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/commit/5c1ec3911040fab33557c5a98df287f43ded3323",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/commit/b54b7e60e904e8a98d96fdca4e6a86d715b36753",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/releases/tag/v6.3.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/security/advisories/GHSA-f2vv-h5x4-57gr",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/security/advisories/GHSA-f2vv-h5x4-57gr",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://store.shopware.com/en/detail/index/sArticle/518463/number/Swag136939272659",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1933/default-remediation-status"
            }
        ]
    }
}