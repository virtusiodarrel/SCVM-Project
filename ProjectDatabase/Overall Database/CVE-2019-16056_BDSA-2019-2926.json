{
    "source": "BDSA",
    "name": "BDSA-2019-2926",
    "title": "Python Vulnerable to Email Domain Spoofing via 'email.utils.parseaddr'",
    "description": "Pythons email module can be tricked into parsing an incorrect email domain.  If a system or application uses Pythons email module to process user supplied email addresses,  it may be possible for a remote attacker to perform unwanted actions or bypass restrictions.  This vulnerability has been used in known attacks against applications.",
    "technicalDescription": "The vulnerability lies in Python's email module in `email.utils.parseaddr`.  The `parseaddr()` function does not correctly handle input when attempting to parse an email address.  If an email address is supplied to the function containing multiple `@` symbols, an incorrect domain address will be returned.  It is expected that if the `parseaddr` function fails or parses an invalid address, two empty tuples should be returned.  However, the function will return the first domain.  This can be used to bypass restrictions, and, depending on how the module is used, be used in further attacks.",
    "publishedDate": "2019-09-12T12:45:15.663Z",
    "updatedDate": "2019-10-14T09:00:39.446Z",
    "disclosureDate": "2019-09-06T00:00:00.000Z",
    "exploitPublishDate": "2019-09-06T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**2.7.17-rc1**](https://github.com/python/cpython/releases/tag/v2.7.17rc1) by [this](https://github.com/python/cpython/commit/4cbcd2f8c4e12b912e4d21fd892eedf7a3813d8e) commit.\n*  [**3.8.0b4**](https://github.com/python/cpython/releases/tag/v3.8.0b4) by [this](https://github.com/python/cpython/commit/217077440a6938a0b428f67cfef6e053c4f8673c) commit.\n*  [**3.7.5-rc1**](https://github.com/python/cpython/releases/tag/v3.7.5rc1) by [this](https://github.com/python/cpython/commit/c48d606adcef395e59fd555496c42203b01dd3e8) commit.\n*  [**3.5.8rc1**](https://github.com/python/cpython/releases/tag/v3.5.8rc1) by [this](https://github.com/python/cpython/commit/8cb65d1381b027f0b09ee36bfed7f35bb4dec9a9) commit.\n\nFixed on these branches which do not yet contain a tagged release version:\n\n*  [**3.6**](https://github.com/python/cpython/tree/3.6) by [this](https://github.com/python/cpython/commit/8cb65d1381b027f0b09ee36bfed7f35bb4dec9a9) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-07-17T00:00:00.000Z",
    "vendorNotifiedDate": "2018-07-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2926",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-290"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-16056",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2926/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue34155",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue34155",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/217077440a6938a0b428f67cfef6e053c4f8673c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/4cbcd2f8c4e12b912e4d21fd892eedf7a3813d8e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/8cb65d1381b027f0b09ee36bfed7f35bb4dec9a9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/c48d606adcef395e59fd555496c42203b01dd3e8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/pull/13079",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v2.7.17rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.5.8rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.7.5rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.8.0b4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/tree/3.6",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://matrix.org/blog/2019/04/18/security-update-sydent-1-0-2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://medium.com/@fs0c131y/tchap-the-super-not-secure-app-of-the-french-government-84b31517d144",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://twitter.com/fs0c131y/status/1119143946687434753",
                "label": "LINK"
            }
        ]
    }
}