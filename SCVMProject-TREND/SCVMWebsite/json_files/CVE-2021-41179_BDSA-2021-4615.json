{
    "source": "BDSA",
    "name": "BDSA-2021-4615",
    "title": "Nextcloud Vulnerable to Authentication Bypass via Improper Two Factor Authentication Enforcement for Public Pages",
    "description": "Nextcloud is vulnerable to authentication bypass due to a failure to enforce two-factor authentication for pages marked as public. A remote attacker with access to a valid user session could leverage this issue to gain access to restricted resources.",
    "technicalDescription": "The `beforeController()` function, of file `core/Middleware/TwoFactorMiddleware.php`, returns immediately if a page has the `PublicPage` annotation. This means that the functions two factor authentication (2FA) authentication logic is not evaluated. An attacker could leverage this issue in order to access restricted resources, such as private chat channels within Nextcloud Talk.",
    "publishedDate": "2022-09-14T08:20:14.438Z",
    "updatedDate": "2022-09-14T08:20:14.421Z",
    "disclosureDate": "2021-10-25T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**22.2.0-rc2**](https://github.com/nextcloud/server/releases/tag/v22.2.0rc2) by [this](https://github.com/nextcloud/server/commit/0bd57da8f0fffd1abb7121f047ca4310c22886a6) commit and [this](https://github.com/nextcloud/server/commit/2e1f7a81615babbd7098c533ac0229c054b3e36b) commit.\n* [**20.0.13-rc1**](https://github.com/nextcloud/server/releases/tag/v20.0.13rc1) by [this](https://github.com/nextcloud/server/commit/fde61e8a22e0ee31d8e350a6d66a4b2f35134944) commit.\n* [**21.0.5-rc1**](https://github.com/nextcloud/server/releases/tag/v21.0.5rc1) by [this](https://github.com/nextcloud/server/commit/b2e4f34e2f7b49b5137462580315b5173c6a6afb) commit.\n\nThe latest stable releases can be found [here](https://github.com/nextcloud/server/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "LukasReschke",
    "workaround": "",
    "vendorFixDate": "2021-09-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4615",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-304"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41179",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4615/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-7hvh-rc6f-px23",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/0bd57da8f0fffd1abb7121f047ca4310c22886a6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/2e1f7a81615babbd7098c533ac0229c054b3e36b",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/b2e4f34e2f7b49b5137462580315b5173c6a6afb",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/fde61e8a22e0ee31d8e350a6d66a4b2f35134944",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v20.0.13rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v21.0.5rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v22.2.0rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4615/default-remediation-status"
            }
        ]
    }
}