{
    "source": "BDSA",
    "name": "BDSA-2021-2328",
    "title": "Centreon Vulnerable to SQL Injection (SQLi) via Insufficient Input Sanitization in 'ProceduresProxy.class.php' File",
    "description": "Centreon is vulnerable to an SQL Injection (SQLi) issue due to a lack of sufficient input sanitization in the `ProceduresProxy.class.php` file.\n\nIf a valid `Knowledge base url` is configured in the `/centreon/main.php?p=50133&o=knowledgeBase` page to point to a MediaWiki instance, an unauthenticated attacker can abuse the lack of sanitization to execute arbitrary SQL commands against the database to read or modify information. This issue could potentially be used to enable further attacks, such as privilege escalation.",
    "technicalDescription": "Centreon is vulnerable to an SQL Injection (SQLi) issue because the `host_name` and `service_description` parameters in the `www/include/configuration/configKnowledge/proxy/proxy.php` file are not sufficiently sanitized. These parameters are passed to the `getServiceUrl()` and `getHostUrl()` functions in the `www/class/centreon-knowledge/ProceduresProxy.class.php` file where SQL queries are constructed without sufficient sanitization.\n\nThis issue can only be exploited when a valid `Knowledge base url` is configured to point to a MediaWiki instance.",
    "publishedDate": "2021-08-04T12:53:11.063Z",
    "updatedDate": "2021-08-04T12:53:11.057Z",
    "disclosureDate": "2021-07-28T00:00:00.000Z",
    "exploitPublishDate": "2021-07-28T00:00:00.000Z",
    "solution": "Fixed in:\n* [**21.04.2**](https://github.com/centreon/centreon/releases/tag/21.04.2) by [this](https://github.com/centreon/centreon/commit/97b9fabd5b0794037893f982ae9afe1a010bd7fa) commit,\n* [**20.10.8**](https://github.com/centreon/centreon/releases/tag/20.10.8) by [this](https://github.com/centreon/centreon/commit/4c4228f4c4f540d768d9bc868d51fd45864d81b6) commit,\n* [**20.04.14**](https://github.com/centreon/centreon/releases/tag/20.04.14) by [this](https://github.com/centreon/centreon/commit/f4aea0123d320a8f14c2c9e3d913a3dc24a36a5d) commit,\n* [**2.8.38**](https://github.com/centreon/centreon/releases/tag/2.8.38) by [this](https://github.com/centreon/centreon/commit/5415d532f5570175e4693e850b8beb6a7e8a9485) commit.\n\nThe latest stable releases are available [here](https://github.com/centreon/centreon/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Guillaume Andr\u00e9 & Th\u00e9o Louis-Tisserand from Synacktiv",
    "workaround": "",
    "vendorFixDate": "2021-05-05T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2328",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-37558",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2328/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/4c4228f4c4f540d768d9bc868d51fd45864d81b6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/5415d532f5570175e4693e850b8beb6a7e8a9485",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/97b9fabd5b0794037893f982ae9afe1a010bd7fa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/commit/f4aea0123d320a8f14c2c9e3d913a3dc24a36a5d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/2.8.38",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/20.04.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/20.10.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/centreon/centreon/releases/tag/21.04.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synacktiv.com/sites/default/files/2021-07/Centreon_Multiple_vulnerabilities_0.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.synacktiv.com/sites/default/files/2021-07/Centreon_Multiple_vulnerabilities_0.pdf",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2328/default-remediation-status"
            }
        ]
    }
}