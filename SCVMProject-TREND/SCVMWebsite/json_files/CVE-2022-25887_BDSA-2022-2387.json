{
    "source": "BDSA",
    "name": "BDSA-2022-2387",
    "title": "Node.js 'sanitize-html' Vulnerable to Regular Expression Denial-of-Service (ReDoS) via Flawed HTML Comment Removal Logic",
    "description": "sanitize-html is vulnerable to a regular expression denial-of-service (DoS) issue due to the presence of a flawed regular expression in the `naughtyHref()` function.\n\nAn attacker could abuse this issue by submitting a crafted input that, when processed, could result in the excessive consumption of resources which could then impact the speed at which requests are processed.",
    "technicalDescription": "This issue exists because the global regular expression replacement logic for HTML comment removal in the `naughtyHref()` function of the `index.js` file uses an unsafe pattern that allows an attacker to trigger an excessive consumption of resources.\n\nIn order to remedy this issue, the vendor has removed this logic and replaced it with simpler array index validation logic.",
    "publishedDate": "2022-08-30T12:02:28.782Z",
    "updatedDate": "2022-08-30T12:02:28.772Z",
    "disclosureDate": "2022-07-20T00:00:00.000Z",
    "solution": "Fixed in [**2.7.1**](https://github.com/apostrophecms/sanitize-html/releases/tag/2.7.1) by [this](https://github.com/apostrophecms/sanitize-html/commit/b4682c12fd30e12e82fa2d9b766de91d7d2cd23c) commit.\n\nThe latest stable releases are available [here](https://www.npmjs.com/package/sanitize-html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nariyoshi Chida of NTT Security Japan",
    "workaround": "",
    "vendorFixDate": "2022-07-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2387",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-185"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-25887",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2387/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apostrophecms/sanitize-html/blob/main/CHANGELOG.md#271-2022-07-20",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apostrophecms/sanitize-html/commit/734ed6b2ec57f771a797ec75684f638844fd9318",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apostrophecms/sanitize-html/commit/b4682c12fd30e12e82fa2d9b766de91d7d2cd23c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apostrophecms/sanitize-html/pull/557",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apostrophecms/sanitize-html/releases/tag/2.7.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/sanitize-html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2387/default-remediation-status"
            }
        ]
    }
}