{
    "source": "BDSA",
    "name": "BDSA-2020-1032",
    "title": "OpenStack Keystone EC2 Credentials API Vulnerable to Authenticated Privilege Escalation via EC2 Credential Creation",
    "description": "OpenStack Keystone is vulnerable to allowing an attacker with the \"viewer\" role to create credentials that give them escalated permissions. This could give them access to the privileges of an \"admin\" role.",
    "technicalDescription": "An authenticated user can create an EC2 credential for a project they have a role on, then update the credential to target a user and project completely unrelated to them. This effectively gives them the ability to have the \"admin\" role on any project.\n\nThe issue has been fixed by ensuring that regular users may only change the credential to be one that they still own.",
    "publishedDate": "2020-05-20T14:00:18.731Z",
    "updatedDate": "2021-07-29T10:51:00.298Z",
    "disclosureDate": "2020-05-06T00:00:00.000Z",
    "solution": "Fixed in:\n* **[17.0.0.0rc2](https://github.com/openstack/keystone/releases/tag/17.0.0.0rc2)** by [this](https://github.com/openstack/keystone/commit/2f2736ebb) commit.\n* **[15.0.1](https://github.com/openstack/keystone/releases/tag/15.0.1)** by [this](https://github.com/openstack/keystone/commit/206392a40) commit.\n* **[16.0.1](https://github.com/openstack/keystone/releases/tag/16.0.1)** by [this](https://github.com/openstack/keystone/commit/54590544f) commit.\n* The **remotes/origin/stable/queens** branch by [this](https://github.com/openstack/keystone/commit/487c7276c7608fb11086b9875b0d7cc7cf594a5a) commit.\n* The **remotes/origin/stable/rocky** branch by [this](https://github.com/openstack/keystone/commit/53d1ccb8a1bdbb5aa0efaacf9739b1a6f436e191) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "kay",
    "workaround": "",
    "vendorFixDate": "2020-04-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1032",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12689",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1032/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/keystone/+bug/1872735",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/206392a40",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/2f2736ebb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/487c7276c7608fb11086b9875b0d7cc7cf594a5a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/53d1ccb8a1bdbb5aa0efaacf9739b1a6f436e191",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/commit/54590544f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/releases/tag/15.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/releases/tag/16.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openstack/keystone/releases/tag/17.0.0.0rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/05/07/2",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1032/default-remediation-status"
            }
        ]
    }
}