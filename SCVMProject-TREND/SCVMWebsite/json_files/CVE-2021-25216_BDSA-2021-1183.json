{
    "source": "BDSA",
    "name": "BDSA-2021-1183",
    "title": "ISC BIND Vulnerable to Remote Code Execution (RCE) via Buffer Overflow in GSSAPI Security Policy Negotiation",
    "description": "ISC BIND is vulnerable to remote code execution (RCE) due to an insecure custom implementation of the Simple and Protected GSSAPI Negotiation (SPNEGO) mechanism. A remote unauthenticated attacker could exploit this vulnerability by supplying a server with maliciously crafted queries.",
    "technicalDescription": "The issue exists with improper handling of buffer operations in the SPNEGO mechanism for the GSS-TSIG protocol extension. On servers which have set values for the `tkey-gssapi-keytab` or `tkey-gssapi-credential` configuration options, this could be exploited by an attacker using maliciously crafted GSS-TSIG queries. For `named` binaries compiled for 64-bit platforms this could result in a denial-of-service (DoS), and on 32-bit platforms this could additionally allow code execution.\n\nAn earlier buffer overflow issue in this mechanism, which was disclosed as **CVE-2020-8625**, was addressed by a [patch](https://github.com/isc-projects/bind9/commit/dc5f0e77ecef88ebbefd368b62b1a3840b1a081d) to fix an off-one-by error. However with the discovery of an additional overflow issue the vendor has ultimately addressed this by removing the custom SPNEGO implementation, as standard SPNEGO implementations are available in the MIT and Heimdal Kerberos libraries.",
    "publishedDate": "2021-04-29T13:57:03.168Z",
    "updatedDate": "2022-07-22T15:22:23.330Z",
    "disclosureDate": "2021-04-28T00:00:00.000Z",
    "solution": "Fixed in:\n* [**9.17.2**](https://github.com/isc-projects/bind9/releases/tag/v9_17_2) by [this](https://github.com/isc-projects/bind9/commit/978c7b2e89aa37a7ddfe2f6b6ba12ce73dd04528) commit,\n* [**9.16.15**](https://github.com/isc-projects/bind9/releases/tag/v9_16_15) by [this](https://github.com/isc-projects/bind9/commit/a875dcc66969ea3995eb6fc1545d39dafcb56b26) commit,\n* [**9.11.31**](https://github.com/isc-projects/bind9/releases/tag/v9_11_31) by [this](https://github.com/isc-projects/bind9/commit/7f08c756aa54d10a71bdf8242479ffeb82e52396) commit.\n\nThe vendor states that the removal of isc-spnego support requires that the system have other libraries and header files to support GSS-TSIG functionality, unless such functionality is completely disabled at build time by providing the `--without-gssapi` argument to the `./configurescript` when selecting build options.\n\nThe latest stable releases are available [here](https://www.isc.org/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Anonymous party working in conjunction with Trend Micro Zero Day Initiative",
    "workaround": "The vendor states the following workaround that may be available:\n> Prior to the April 2021 BIND releases, on some platforms it was possible to build a working BIND installation that was not vulnerable to CVE-2021-25216 by providing the `--disable-isc-spnego` command-line argument when running the `./configure` script in the top level of the BIND source directory, before compiling and linking `named`.",
    "vendorFixDate": "2020-04-21T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1183",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-120"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-25216",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1183/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/isc-projects/bind9/commit/7f08c756aa54d10a71bdf8242479ffeb82e52396",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/isc-projects/bind9/commit/978c7b2e89aa37a7ddfe2f6b6ba12ce73dd04528",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/isc-projects/bind9/commit/a875dcc66969ea3995eb6fc1545d39dafcb56b26",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/isc-projects/bind9/commit/dc5f0e77ecef88ebbefd368b62b1a3840b1a081d",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/isc-projects/bind9/releases/tag/v9_11_31",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/isc-projects/bind9/releases/tag/v9_16_15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/isc-projects/bind9/releases/tag/v9_17_2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://kb.isc.org/v1/docs/cve-2021-25216",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://kb.isc.org/v1/docs/cve-2021-25216",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.isc.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1183/default-remediation-status"
            }
        ]
    }
}