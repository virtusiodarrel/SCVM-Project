{
    "source": "BDSA",
    "name": "BDSA-2021-3308",
    "title": "Linux Kernel Vulnerable to Unspecified Impacts via Missing MSG_CRYPTO Message Size Check",
    "description": "The Transparent Inter-Process Communication (TIPC) functionality in Linux does not check the size of cryptographic messages sent by other nodes in the cluster. Although the exact impact of this is not specified, the vulnerability could potentially be exploited to crash the kernel or cause integral damage by manipulating the size and content of the messages.",
    "technicalDescription": "There is a missing `MSG_CRYPTO` message size check in the function `tipc_crypto_key_rcv()`, file `net/tipc/crypto.c`. This could potentially result in a buffer overflow and a crash due to an erroneous `memcpy(skey->key, data + TIPC_AEAD_ALG_NAME + sizeof(__be32), skey->keylen);` operation, where `skey->keylen` is the message size.\n\nThe vulnerability was fixed by verifying the message size.",
    "publishedDate": "2021-11-03T11:45:37.750Z",
    "updatedDate": "2021-11-03T11:45:37.737Z",
    "disclosureDate": "2021-10-26T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.10.77**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0b1b3e086b0af2c2faa9938c4db956fe6ce5c965) commit\n* [**5.14.16**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e029c9828c5b503b11a609fcc7c5840de2db3fb4) commit\n* [**5.15**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fa40d9734a57bcbfa79a280189799f76c88f7bb0) commit\n\nThe latest stable releases can be found [here](https://www.kernel.org).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 7.8,
        "exploitabilitySubscore": 6.5,
        "severity": "MEDIUM",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:A/AC:L/Au:N/C:N/I:P/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-10-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3308",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-120"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43267",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3308/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0b1b3e086b0af2c2faa9938c4db956fe6ce5c965",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e029c9828c5b503b11a609fcc7c5840de2db3fb4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fa40d9734a57bcbfa79a280189799f76c88f7bb0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/torvalds/linux/commit/1ef6f7c9390ff5308c940ff8d0a53533a4673ad9",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/torvalds/linux/commit/fa40d9734a57bcbfa79a280189799f76c88f7bb0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3308/default-remediation-status"
            }
        ]
    }
}