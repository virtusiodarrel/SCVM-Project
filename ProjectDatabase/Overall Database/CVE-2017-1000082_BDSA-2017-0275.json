{
    "source": "BDSA",
    "name": "BDSA-2017-0275",
    "title": "SystemD Service Configuration with Invalid Syntax Usernames allows Privilege Escalation",
    "description": "When specifying a username that does not meet SystemD's definition of a 'valid username', such as one beginning with a number, the server will be launched as a root process.",
    "technicalDescription": "SystemD is a system and service manager commonly used on the Linux Kernel. It commonly handles management of logging/journal facility, launch and shutdown of services, hardware hotswapping, Inter-Process Communications, DNS resolution, virtual console, network configuration, login provider, userspace driver devices and system time management.\n\nA design principle within SystemD's development leads to the creation of this vulnerability. SystemD will refuse to start any services for a non-existent username. However, for any attributes that are syntax incorrect (such as a username like '0day', a username that begins with a number), SystemD is to ignore the value and continue launching the service. The principle is to maintain both backwards and forward compatibility to a degree. SystemD treats the service file as if no 'user' has been provided, defaulting to launching as root.\n\nThe [Open Group Base Specifications Issue 6, IEEE Std 1003.1, 2004 Edition](http://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap03.html#tag_03_276) does not restrict the use of numbers leading in usernames and therefore SystemD in this case would not be providing POSIX compatibility or compliance. This can lead to problems where users can be created with standard distribution tools that are POSIX compliant that does not take SystemD's limitations into account. Additionally, POSIX compliant enforced Single-Sign-On solutions like LDAP directories may contain invalid users that users would assume SystemD would be capable of handling properly in service files.\n\nWithout direct knowledge of these limitations, it is possible that a service intended to be ran under a limited user will operate under full root privileges, leading to privilege escalation.\n\n**Please Note:** SystemD's stance is that this vulnerability is by design and therefore users should not use usernames they consider invalid.",
    "publishedDate": "2017-08-23T09:02:12.118Z",
    "updatedDate": "2019-01-15T09:10:53.892Z",
    "disclosureDate": "2017-06-29T00:00:00.000Z",
    "exploitPublishDate": "2017-06-29T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:F/RL:W/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:F/RL:W/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Mapleray <zhiwuliao@gmail.com>",
    "workaround": "A [patch](https://build.opensuse.org/request/show/508564) has been produced for inclusion into OpenSuSE that changes the shadow utils concept of a valid username. This only adds a further restriction to user creation using some standard tools but does not actually correct the underlying issue of invalid syntax usernames causing the service to launch as root under SystemD and does not deal with Single-Sign on solutions.\n\nIt is recommended to avoid the use of user names that do not fit within SystemD's view of what is invalid/syntax incorrect, including on any SSO solutions such as LDAP/Active Directory.",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-0275",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-266"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-272"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-1000082",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-0275/ranges"
            },
            {
                "rel": "reference",
                "href": "http://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap03.html#tag_03_276",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://build.opensuse.org/request/show/508564",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/issues/6237",
                "label": "EXPLOIT"
            }
        ]
    }
}