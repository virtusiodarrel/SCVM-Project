{
    "source": "BDSA",
    "name": "BDSA-2022-0159",
    "title": "FreeBSD Vulnerable to System Misbehavior via 'vt' Console Buffer Overflow",
    "description": "FreeBSD is vulnerable to a system misbehavior issue due to the presence of a buffer overflow flaw inside the `vt(4)` functionality.\n\nAn attacker with access to the system console could abuse the highlight buffer while text is scrolling on the console to cause system console data structures or other kernel memory to be overwritten. This introduces unintended behavior, such as restricting movement of the mouse cursor while in console mode.",
    "technicalDescription": "To remedy this issue, the vendor has added more validation checks to the `vt_fb_bitblt_text()` and `vt_fb_invalidate_text()` functions in the `sys/dev/vt/hw/fb/vt_fb.c` file as well as the `vga_bitblt_text_txtmode()` and `vga_invalidate_text()` functions in the  `sys/dev/vt/hw/vga/vt_vga.c` file in order to properly bound buffer access.",
    "publishedDate": "2022-01-19T17:15:26.809Z",
    "updatedDate": "2022-05-20T15:04:19.937Z",
    "disclosureDate": "2020-08-12T00:00:00.000Z",
    "exploitPublishDate": "2020-10-19T00:00:00.000Z",
    "solution": "Vendor supplied source code patches for FreeBSD versions **13.0** and **12.2** are available [here](https://www.freebsd.org/security/advisories/FreeBSD-SA-22:01.vt.asc).\n\nFixed in [**12.3.0**](https://cgit.freebsd.org/src/tag/?h=release/12.3.0) by [this](https://cgit.freebsd.org/src/commit/?id=e4fcff8ee124f8faed2f1fcc1e15b7ae6906d4d7) commit.\n\nFixed in [**13.1.0**](https://cgit.freebsd.org/src/tag/?h=release/13.1.0) by [this](https://cgit.freebsd.org/src/commit/?id=3e0a1e12416996b63949de2b11ca74a0e0d70bd5) commit.\n\nFixed in:\n* the **releng/12.2** branch by [this](https://cgit.freebsd.org/src/commit/?id=9c9d0d90512f0e5950b179d1a07f717ad7c8fe28) commit,\n* the **releng/13.0** branch by [this](https://cgit.freebsd.org/src/commit/?id=3e0a1e12416996b63949de2b11ca74a0e0d70bd5) commit,\n* the **main** branch by [this](https://cgit.freebsd.org/src/commit/?id=dbc7ca59451561a179f9852642e13ef024169d84) commit.\n\nThe latest stable releases are available [here](https://www.freebsd.org/where/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.8
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.1,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Oleg Bulyzhin",
    "workaround": "",
    "vendorFixDate": "2021-09-22T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0159",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29632",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0159/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=248628",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=248628#c5",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=3e0a1e12416996b63949de2b11ca74a0e0d70bd5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=9352de39c3dcc94f2745f939e52388a8e1cc1c05",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=9c9d0d90512f0e5950b179d1a07f717ad7c8fe28",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=dbc7ca59451561a179f9852642e13ef024169d84",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=e4fcff8ee124f8faed2f1fcc1e15b7ae6906d4d7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=ee97b2336aa47851a1dc5681ea2017cc2193aac4",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/tag/?h=release/12.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/tag/?h=release/13.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-22:01.vt.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-22:01.vt.asc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/where/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0159/default-remediation-status"
            }
        ]
    }
}