{
    "source": "BDSA",
    "name": "BDSA-2020-2983",
    "title": "Aptdaemon Vulnerable to Information Disclosure via 'Locale' Property Mishandling",
    "description": "Aptdaemon is vulnerable to information disclosure due to the insufficient validation of user-provided input values. A local attacker could check for the existence of any files on a system by providing crafted input parameters to the Aptdaemon application.",
    "technicalDescription": "Aptdaemon uses the `Locale` property whenever it is conducting transactions. The locale is derived from input provided by the user, and is parsed using the function `_parselocale()`. The locale is insufficiently validated, such that an attacker can specify arbitrary paths as input. The attacker can use the application's feedback to determine if the specified file exists on the system.",
    "publishedDate": "2020-10-26T17:19:12.508Z",
    "updatedDate": "2020-10-29T10:09:27.777Z",
    "disclosureDate": "2020-09-24T00:00:00.000Z",
    "exploitPublishDate": "2020-09-24T00:00:00.000Z",
    "solution": "Fixed by [this](https://launchpadlibrarian.net/495880775/reject-paths-in-locale.patch) patch in:\n* [**1.1.1+bzr982-0ubuntu32.2**](https://launchpad.net/ubuntu/+source/aptdaemon/1.1.1+bzr982-0ubuntu32.2?_ga=2.27626943.228868739.1603714120-1046091399.1592490233)\n* [**1.1.1+bzr982-0ubuntu19.4**](https://launchpad.net/ubuntu/+source/aptdaemon/1.1.1+bzr982-0ubuntu19.4?_ga=2.27626943.228868739.1603714120-1046091399.1592490233)\n* [**1.1.1+bzr982-0ubuntu14.4**](https://launchpad.net/ubuntu/+source/aptdaemon/1.1.1+bzr982-0ubuntu14.4?_ga=2.27626943.228868739.1603714120-1046091399.1592490233)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Vaisha Bernard",
    "workaround": "",
    "vendorFixDate": "2020-09-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2983",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-233"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15703",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2983/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/ubuntu/%2Bsource/aptdaemon/%2Bbug/1888235",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/ubuntu/%2Bsource/aptdaemon/%2Bbug/1888235",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/aptdaemon/1.1.1+bzr982-0ubuntu14.4?_ga=2.27626943.228868739.1603714120-1046091399.1592490233",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/aptdaemon/1.1.1+bzr982-0ubuntu19.4?_ga=2.27626943.228868739.1603714120-1046091399.1592490233",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/aptdaemon/1.1.1+bzr982-0ubuntu32.2?_ga=2.27626943.228868739.1603714120-1046091399.1592490233",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpadlibrarian.net/495880775/reject-paths-in-locale.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://ubuntu.com/security/notices/USN-4537-1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/48962",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2983/default-remediation-status"
            }
        ]
    }
}