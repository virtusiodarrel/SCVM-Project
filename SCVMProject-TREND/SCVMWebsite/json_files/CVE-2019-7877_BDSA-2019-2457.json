{
    "source": "BDSA",
    "name": "BDSA-2019-2457",
    "title": "Magento Vulnerable to Stored Cross-site Scripting (XSS) in Admin Panel",
    "description": "Magento is vulnerable to stored cross-site scripting (XSS) attack through the admin panel due to improper validation of user-supplied input. A remote attacker with high privileges can inject arbitrary code into a web page to steal sensitive data from the user's browser and mount further attacks.",
    "technicalDescription": "This vulnerability exists due to a broken HTML sanitizer and deserialization of an authenticated Phar file.\n\nAn authenticated attacker with privileges to the admin panel can inject malicious JavaScript code into the admin panel. The injected code will be activated when a victim visits the crafted page. Please note that in some non-standard configurations this attack does not require an authentication or high privileges and it can be mounted by using the store front.",
    "publishedDate": "2019-08-06T15:01:31.995Z",
    "updatedDate": "2019-08-06T15:01:31.983Z",
    "disclosureDate": "2019-06-25T00:00:00.000Z",
    "solution": "Fixed in Magento:\n* **[2.1.18](https://github.com/magento/magento2/releases/tag/2.1.18)**\n* **[2.2.9](https://github.com/magento/magento2/releases/tag/2.2.9)**\n* **[2.3.2](https://github.com/magento/magento2/releases/tag/2.3.2)**\n\nPatches for the older versions can be found [here](https://magento.com/tech-resources/download#download2314).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.3
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Simon Scannell",
    "workaround": "",
    "vendorFixDate": "2019-06-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2457",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-7877",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2457/ranges"
            },
            {
                "rel": "reference",
                "href": "https://community.magento.com/t5/Magento-DevBlog/Extending-the-June-25-Security-Update-to-Older-Versions-of/ba-p/138231?_ga=2.196113583.227404790.1565096336-1703735404.1565096336",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/magento/magento2/releases/tag/2.1.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/magento/magento2/releases/tag/2.2.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/magento/magento2/releases/tag/2.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://magento.com/security/patches/magento-2.3.2-2.2.9-and-2.1.18-security-update-13",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://magento.com/tech-resources/download#download2314",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2457/default-remediation-status"
            }
        ]
    }
}