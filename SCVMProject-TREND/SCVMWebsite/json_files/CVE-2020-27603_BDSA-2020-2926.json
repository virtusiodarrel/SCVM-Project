{
    "source": "BDSA",
    "name": "BDSA-2020-2926",
    "title": "Big Blue Button Vulnerable to Insecure File Upload via Security Misconfiguration in 'OfficeToPdfConversionService.java'",
    "description": "BigBlueButton contains a security misconfiguration vulnerability. An attacker could exploit this flaw to upload malicious files which can access other local files on the server and exfiltrate their contents.",
    "technicalDescription": "This vulnerability exists in `bbb-common-web/src/main/java/org/bigbluebutton/presentation/imp/OfficeToPdfConversionService.java`.  This file contains an insecure setting which allows the uploading of presentation files which exfiltrate the content of other files on the server. The main cause of this is an unsafe `JODConverter` setting that allows external files to be integrated in the `.odt` (LibreOffice) files. This setting overrides the default conversion functionality of LibreOffice files which only integrates external files after a dialog with the user.\nAs shown in the PoC, it is possible for an attacker to upload a document file which refers to a configuration file and exfiltrate the content of that file. Then, he can compromise the application further.\n\nThis vulnerability has been fixed by preventing the uploaded files from reading local files.",
    "publishedDate": "2020-10-22T11:04:03.683Z",
    "updatedDate": "2021-07-05T15:25:21.031Z",
    "disclosureDate": "2020-10-21T00:00:00.000Z",
    "exploitPublishDate": "2020-10-21T00:00:00.000Z",
    "solution": "Fixed in [**2.2.27**](https://github.com/bigbluebutton/bigbluebutton/releases/tag/v2.2.27) by [this](https://github.com/bigbluebutton/bigbluebutton/commit/db413c59e99ff81b19426bb761da4097fd418f34) commit.\n\nThe latest stable releases are available [here](https://github.com/bigbluebutton/bigbluebutton/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Golem.de",
    "workaround": "",
    "vendorFixDate": "2020-10-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2926",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27603",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2926/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bigbluebutton/bigbluebutton/commit/db413c59e99ff81b19426bb761da4097fd418f34",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bigbluebutton/bigbluebutton/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bigbluebutton/bigbluebutton/releases/tag/v2.2.27",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.golem.de/news/big-blue-button-das-grosse-blaue-sicherheitsrisiko-2010-151610.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.golem.de/news/big-blue-button-das-grosse-blaue-sicherheitsrisiko-2010-151610.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2926/default-remediation-status"
            }
        ]
    }
}