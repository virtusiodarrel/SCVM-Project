{
    "source": "BDSA",
    "name": "BDSA-2019-1320",
    "title": "Envoy Vulnerable to Authentication Bypass via Crafted Request Header Values",
    "description": "Envoy is vulnerable to authentication bypass due to the insufficient validation of client-provided input. An attacker could gain unauthorized access to resources by providing crafted requests, in which the request headers contain embedded NULL values.",
    "technicalDescription": "Envoy processes the contents of HTTP headers using code that is contained within the scripts `header_map.h`, `header_map_impl.cc` and `codec_impl.cc`. Although RFC 7230 states that HTTP headers should be validated to ensure they do not contain prohibited characters (e.g. `NULL`, `LF` or `CR`), Envoy neglects to do so. HTTP header matching rules are used by Envoy in order to restrict access to certain resources. The embedding of prohibited characters within HTTP headers can be used by an attacker in order to circumvent these checks and gain access to resources to which they are not authorized.",
    "publishedDate": "2019-04-30T09:10:59.155Z",
    "updatedDate": "2019-04-30T09:10:59.142Z",
    "disclosureDate": "2019-03-29T00:00:00.000Z",
    "exploitPublishDate": "2019-03-29T00:00:00.000Z",
    "solution": "Fixed in version [**1.9.1**](https://github.com/envoyproxy/envoy/releases/tag/v1.9.1) by [this](https://github.com/envoyproxy/envoy/commit/6cc5edfcc2d61caf698cd10ae7d160e12a24c30e) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Harvey Tuch",
    "workaround": "The vendor advises that the following workaround can be implemented in some circumstances: \n\n\"External data plane sidecall servers such as ext_authz that interact with Envoy supplied headers can be modified to detect and reject requests with embedded NULs.\"",
    "vendorFixDate": "2019-03-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1320",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-626"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9900",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1320/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/6cc5edfcc2d61caf698cd10ae7d160e12a24c30e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/issues/6434",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/issues/6434",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/issues/6434",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.9.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1320/default-remediation-status"
            }
        ]
    }
}