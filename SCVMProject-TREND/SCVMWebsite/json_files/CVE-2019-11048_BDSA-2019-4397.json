{
    "source": "BDSA",
    "name": "BDSA-2019-4397",
    "title": "PHP Vulnerable to Denial-of-Service (DoS) via Integer Overflow in 'SAPI_API SAPI_POST_HANDLER_FUNC' Function",
    "description": "It was discovered that PHP contains an integer overflow vulnerability. An attacker could exploit this flaw to cause an application crash when uploading a multipart/form-data file with a large filename. Triggering this exception also results in the temporary files created during the process not being properly cleaned up. In a situation where multiple files are uploaded before the malicious file triggers the crash, none of the temporary files are deleted, which could also lead to exhausting the disk space on the target server.",
    "technicalDescription": "The vulnerability occurs in the `SAPI_API SAPI_POST_HANDLER_FUNC()`function in the `main/rfc1867.c` file. An attacker could supply a file with a crafted filename to trigger an integer over-flow. \n\nThe vulnerability occurs due to the `size_t` variable being cast to `int` without any checks taking place. If a file is uploaded with an array-like name that exceeds the max size of a 32 bit integer, `array_len` gets set as a negative value. `array_len` is then converted into a large 64 bit integer causing the integer overflow. This triggers an exception and the already uploaded temporary files are not deleted. An attacker could exploit this flaw to trigger a denial-of-service (DoS) condition and exhaust available disk space on the target server.",
    "publishedDate": "2020-05-20T15:29:48.920Z",
    "updatedDate": "2020-05-20T15:29:48.914Z",
    "disclosureDate": "2019-11-28T00:00:00.000Z",
    "exploitPublishDate": "2019-11-28T00:00:00.000Z",
    "solution": "Fixed in:\n* [**7.4.6**](https://github.com/php/php-src/compare/PHP-7.4.6) by [this](https://github.com/php/php-src/commit/a3924ab6542a358a3099de992b63b932a9570add) commit,\n*  [**7.3.18**](https://github.com/php/php-src/compare/PHP-7.3.18) by [this](https://github.com/php/php-src/commit/8fd927768991df88df0c338b2b7c29e490392430) commit and [this](https://github.com/php/php-src/commit/c71416cba2ad7b596233e3c0da117a90a2e78bbf) commit,\n* [**7.2.31**](https://github.com/php/php-src/releases/tag/php-7.2.31) by [this](https://github.com/php/php-src/commit/1c9bd513ac5c7c1d13d7f0dfa7c16a7ad2ce0f87) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "jr",
    "workaround": "",
    "vendorFixDate": "2020-03-18T00:00:00.000Z",
    "vendorNotifiedDate": "2019-11-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4397",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11048",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4397/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=78875",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=78875",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=78876",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=78876",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/1c9bd513ac5c7c1d13d7f0dfa7c16a7ad2ce0f87",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/8fd927768991df88df0c338b2b7c29e490392430",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/a3924ab6542a358a3099de992b63b932a9570add",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/c71416cba2ad7b596233e3c0da117a90a2e78bbf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/compare/PHP-7.3.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/compare/PHP-7.4.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.2.31",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4397/default-remediation-status"
            }
        ]
    }
}