{
    "source": "BDSA",
    "name": "BDSA-2022-1808",
    "title": "ESAPI Vulnerable to Control-Flow-Bypass Check Failure and Path Traversal via 'DefaultValidator.getValidDirectoryPath' Implementation",
    "description": "ESAPI is vulnerable to control-flow-bypass check failure due to an improper default implementation of the validator method `getValidDirectoryPath()`. This could be leveraged by an attacker to perform path traversal attacks that would normally be restricted by the validator.",
    "technicalDescription": "The issue exists in the function `getValidDirectoryPath()` within the file `src/main/java/org/owasp/esapi/reference/DefaultValidator.java`. A check that detects if an input path is inside the specified parent directory is not correctly defined, allowing for path traversal attacks if the canonical path of the parent directory as processed by the function is not slash terminated.",
    "publishedDate": "2022-07-01T09:40:23.400Z",
    "updatedDate": "2022-07-01T09:40:23.387Z",
    "disclosureDate": "2022-04-23T00:00:00.000Z",
    "solution": "Fixed in version [**2.3.0.0**](https://github.com/ESAPI/esapi-java-legacy/releases/tag/esapi-2.3.0.0) by [this](https://github.com/ESAPI/esapi-java-legacy/commit/a0d67b75593878b1b6e39e2acc1773b3effedb2a) commit.\n\nThe latest stable releases are available [here](https://github.com/ESAPI/esapi-java-legacy/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jaroslav Loba\u010devski",
    "workaround": "",
    "vendorFixDate": "2022-04-17T00:00:00.000Z",
    "vendorNotifiedDate": "2022-01-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1808",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23457",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1808/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ESAPI/esapi-java-legacy/commit/a0d67b75593878b1b6e39e2acc1773b3effedb2a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ESAPI/esapi-java-legacy/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ESAPI/esapi-java-legacy/releases/tag/esapi-2.3.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ESAPI/esapi-java-legacy/security/advisories/GHSA-8m5h-hrqm-pxm2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://securitylab.github.com/advisories/GHSL-2022-008_The_OWASP_Enterprise_Security_API/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1808/default-remediation-status"
            }
        ]
    }
}