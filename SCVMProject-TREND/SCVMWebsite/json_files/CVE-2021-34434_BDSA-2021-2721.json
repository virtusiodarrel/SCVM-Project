{
    "source": "BDSA",
    "name": "BDSA-2021-2721",
    "title": "Mosquitto with Dynamic Security Plugin Vulnerable to Unauthorized Access to Subscriptions via Access Control Failure",
    "description": "Mosquitto is vulnerable to subscription access issue when using the Dynamic Security Plugin due to how access control is mishandled.\n\nWhere the plugin has granted ACL subscription access to a durable/non-clean-session client and subsequently removed the access, it is possible for the client to keep its subscription and potentially access information that should otherwise now be restricted.",
    "technicalDescription": "Mosquitto is vulnerable to an unauthorized access to subscriptions issue because the Dynamic Security Plugin does not sufficiently validate if clients should still have the sufficient rights to access their subscriptions when the ability for the client to make subscriptions on a topic is revoked while the client is offline. This can cause subscriptions to persist and potentially allow clients to access restricted information.\n\nTo remedy this issue, a new function `check_subscription_acls()` has been added to `src/plugin_public.c` to specifically validate if durable clients still have rights to their subscriptions.",
    "publishedDate": "2021-09-08T09:19:55.106Z",
    "updatedDate": "2021-09-08T09:19:55.080Z",
    "disclosureDate": "2021-08-09T00:00:00.000Z",
    "exploitPublishDate": "2021-08-09T00:00:00.000Z",
    "solution": "Fixed in [**2.0.12**](https://github.com/eclipse/mosquitto/releases/tag/v2.0.12) by [this](https://github.com/eclipse/mosquitto/commit/32af599c81e63fa38e834b8f1c1f108c49328e95) commit.\n\nThe latest stable releases are available [here](https://mosquitto.org/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-08-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2721",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-34434",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2721/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.eclipse.org/bugs/show_bug.cgi?id=575324",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.eclipse.org/bugs/show_bug.cgi?id=575324",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/mosquitto/commit/32af599c81e63fa38e834b8f1c1f108c49328e95",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/mosquitto/releases/tag/v2.0.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mosquitto.org/ChangeLog.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://mosquitto.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mosquitto.org/security/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2721/default-remediation-status"
            }
        ]
    }
}