{
    "source": "BDSA",
    "name": "BDSA-2019-1665",
    "title": "GNOME GLib Vulnerable to Arbitrary Access via Unsafe File Access Permissions During 'file_copy_fallback' Operation",
    "description": "GNOME GLib is vulnerable to arbitrary file access due to incorrectly set permissions during a file copy operation. The flawed copy operation creates new files with default permissions and sets correct permissions only after copying completes. This leaves an attacker a window of opportunity when the file may be open to arbitrary access. Depending on how the function is implemented in the target application this has a potential of leading to arbitrary code execution on the underlying host.",
    "technicalDescription": "This flaw lies in the `file_copy_fallback()` function of the `gio/gfile.c` source file. When writing data to the `out` buffer, files get created with default permissions and then updated with correct permissions after the operation is done. If an application that makes use of this vulnerable functionality makes it possible to reach the files during the copy an attacker could get unintended access. That could be abused to read or modify the buffer before the permissions get changed to restrict access.",
    "publishedDate": "2019-05-30T12:53:27.789Z",
    "updatedDate": "2020-04-10T09:40:39.608Z",
    "disclosureDate": "2019-05-29T00:00:00.000Z",
    "solution": "Fixed in [**2.60.4**](https://gitlab.gnome.org/GNOME/glib/releases) by [this](https://gitlab.gnome.org/GNOME/glib/commit/e6b769819d63d2b24b251dbc9f902fe6fd614da3) commit.\n\nFixed in [**2.61.2**](https://gitlab.gnome.org/GNOME/glib/releases) by [this](https://gitlab.gnome.org/GNOME/glib/commit/d8f8f4d637ce43f8699ba94c9b7648beda0ca174) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-05-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1665",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-276"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-12450",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-1665/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/commit/d8f8f4d637ce43f8699ba94c9b7648beda0ca174",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/commit/e6b769819d63d2b24b251dbc9f902fe6fd614da3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/commit/e6b769819d63d2b24b251dbc9f902fe6fd614da3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/glib/releases",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}