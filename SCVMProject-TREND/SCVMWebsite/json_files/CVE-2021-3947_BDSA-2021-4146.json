{
    "source": "BDSA",
    "name": "BDSA-2021-4146",
    "title": "QEMU Vulnerable to Information Disclosure via Out-of-Bounds Read in NVME",
    "description": "QEMU is vulnerable to an information disclosure issue due to the presence of an integer underflow flaw caused by insufficient validation in the NVME component.\n\nA malicious guest could abuse this flaw in order to read from out-of-bounds memory which could allow for the disclosure of sensitive information.",
    "technicalDescription": "QEMU is vulnerable to information disclosure because the `nvme_changed_nslist()` function in the `hw/nvme/ctrl.c` file does not sufficiently validate the guest-controlled `off` value. If this value is set larger than 4096, an integer underflow can occur leading to the occurrence of an out-of-bounds read.",
    "publishedDate": "2022-02-21T15:11:45.332Z",
    "updatedDate": "2022-02-21T15:11:45.316Z",
    "disclosureDate": "2021-11-10T00:00:00.000Z",
    "solution": "Fixed in [**6.2.0-rc2**](https://gitlab.com/qemu-project/qemu/-/tags/v6.2.0-rc2) by [this](https://gitlab.com/qemu-project/qemu/-/commit/e2c57529c9306e4c9aac75d9879f6e7699584a22) commit and in [**6.1.1**](https://gitlab.com/qemu-project/qemu/-/tags/v6.1.1) by [this](https://gitlab.com/qemu-project/qemu/-/commit/2b2eb343a01bb84a9d988158f706a65b57604d65) commit.\n\nThe latest stable releases are available [here](https://gitlab.com/qemu-project/qemu/-/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.1
        },
        "vector": "(AV:L/AC:M/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-11-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4146",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-191"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3947",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4146/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2021869",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/qemu-project/qemu/-/commit/2b2eb343a01bb84a9d988158f706a65b57604d65",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/qemu-project/qemu/-/commit/e2c57529c9306e4c9aac75d9879f6e7699584a22",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/qemu-project/qemu/-/commit/f432fdfa1215bc3a00468b2e711176be279b0fd2",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/qemu-project/qemu/-/tags",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/qemu-project/qemu/-/tags/v6.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/qemu-project/qemu/-/tags/v6.2.0-rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/qemu-devel/163777841100.97511.6461566282040035969@amd.com/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/qemu-devel/164029849563.281415.815636408301189127@amd.com/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4146/default-remediation-status"
            }
        ]
    }
}