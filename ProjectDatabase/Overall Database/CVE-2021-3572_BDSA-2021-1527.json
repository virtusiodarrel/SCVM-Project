{
    "source": "BDSA",
    "name": "BDSA-2021-1527",
    "title": "Python PIP Vulnerable to Arbitrary Revision Installation via Improper Unicode Separator Handling",
    "description": "Python PIP is vulnerable to the installation of arbitrary revisions due to the improper handling of unicode separator characters. An attacker could cause a different git revision to be installed than what was intended by using a maliciously crafted reference field.",
    "technicalDescription": "The function `get_revision_sha()`, of file `src/pip/_internal/vcs/git.py`, executes the `show-ref` GIT command in order to obtain a list of revisions. The output of the command, which is stored in the `output` variable, is processed by calling `output.strip().splitlines()` in order to derive a list of the revision hashes. The `splitlines()` function can split input strings on a range of characters, including various unicode separators. Such separators are allowed within Git tag names. An attacker could therefore use such separators to cause an unexpected revision hash to be included in the resulting hash list. This could cause the victim to install an unexpected revision.\n\nThe attacker must have access to the repository in order to exploit this issue.",
    "publishedDate": "2021-05-21T14:51:49.987Z",
    "updatedDate": "2022-01-04T09:49:45.570Z",
    "disclosureDate": "2021-05-19T00:00:00.000Z",
    "exploitPublishDate": "2021-06-07T00:00:00.000Z",
    "solution": "Fixed in [**21.1**](https://github.com/pypa/pip/releases/tag/21.1) by [this](https://github.com/pypa/pip/pull/9827/commits/ca832b2836e0bffa7cf95589acdcd71230f5834e) commit.\n\nThe latest stable releases are available [here](https://github.com/pypa/pip/releases/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 2.4,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 0.9,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.2,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1527",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-176"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-3572",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1527/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pypa/pip/issues/10042",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pypa/pip/issues/10042",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pypa/pip/pull/9827",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pypa/pip/pull/9827/commits/ca832b2836e0bffa7cf95589acdcd71230f5834e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pypa/pip/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pypa/pip/releases/tag/21.1",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}