{
    "source": "BDSA",
    "name": "BDSA-2021-3571",
    "title": "MongoDB Vulnerable to Denial-of-Service (DoS) via Violation of Invariance for Shard Connections",
    "description": "MongoDB is vulnerable to denial-of-service (DoS) due to a failure to uphold value invariance. An attacker could cause a vulnerable server to crash by sending a maliciously crafted shard request to that server.",
    "technicalDescription": "Shards within MongoDB can be used to handle aggregation requests, each of which is associated with an aggregation pipeline. These pipelines can have multiple stages, during which various operations can be performed. One of these operations is \"sampling\", which is denoted by the `$sample` operator. Aggregation requests containing a sampling stage can be incorrectly processed by MongoDB if they are sent to a shard. This can lead to the modification of invariant values, which will cause the server to crash. A remote authenticated attacker could leverage this issue in order to cause a denial-of-service (DoS).",
    "publishedDate": "2021-11-26T16:31:50.626Z",
    "updatedDate": "2021-11-26T16:31:50.611Z",
    "disclosureDate": "2021-08-03T00:00:00.000Z",
    "solution": "Fixed in version [**5.0.3-rc0**](https://github.com/mongodb/mongo/releases/tag/r5.0.3-rc0) by [this](https://github.com/mongodb/mongo/commit/a5e2f9b0a236462a6d1ca129583c617f111367b4) commit, and in version [**5.1.0-rc0**](https://github.com/mongodb/mongo/releases/tag/r5.1.0-rc0) by [this](https://github.com/mongodb/mongo/commit/f3604b901d688c194de5e430c7fbab060c9dc8e0) commit.\n\nThe latest stable releases can be found [here](https://github.com/mongodb/mongo/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-08-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3571",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-344"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-617"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32037",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3571/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/commit/a5e2f9b0a236462a6d1ca129583c617f111367b4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/commit/f3604b901d688c194de5e430c7fbab060c9dc8e0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/releases/tag/r5.0.3-rc0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/releases/tag/r5.1.0-rc0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb/mongo/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jira.mongodb.org/browse/SERVER-59071",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3571/default-remediation-status"
            }
        ]
    }
}