{
    "source": "BDSA",
    "name": "BDSA-2020-4634",
    "title": "djv Vulnerable to Remote Code Execution (RCE) via Insufficient Schema File Validation",
    "description": "djv is vulnerable to remote code execution due to the insufficient sanitization of client-provided schema files. A remote attacker could execute code on a vulnerable server by causing it to process a maliciously crafted JSON payload.",
    "technicalDescription": "The function `template()`, of file `lib/utils/template.js`, is used in the dynamic generation of function bodies. The application is capable of parsing schema files which are to be used in this process. Such files can be in the JSON format. Insufficient sanitization is performed on the contents of the schema file, such that an attacker can inject a malicious payload into the code that is to be executed. A remote attacker can therefore achieve remote code execution (RCE) by causing a vulnerable endpoint to parse a crafted JSON file.\n\nThe vulnerability was fixed via the addition of a new function, `sanitizeString()`, which performs the required sanitization on the schema file content.",
    "publishedDate": "2021-10-01T12:37:37.521Z",
    "updatedDate": "2021-10-01T12:37:37.506Z",
    "disclosureDate": "2020-09-30T00:00:00.000Z",
    "exploitPublishDate": "2020-09-30T00:00:00.000Z",
    "solution": "Fixed in version [**2.1.4-alpha0**](https://www.npmjs.com/package/djv) by [this](https://github.com/korzio/djv/commit/48fe9544e1497653d4089209b01e55f3255586eb) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alessio Della Libera (Snyk Research Team)",
    "workaround": "",
    "vendorFixDate": "2020-12-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4634",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28464",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4634/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/korzio/djv/commit/48fe9544e1497653d4089209b01e55f3255586eb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/korzio/djv/pull/98",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-DJV-1014545",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/djv",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4634/default-remediation-status"
            }
        ]
    }
}