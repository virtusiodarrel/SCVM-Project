{
    "source": "BDSA",
    "name": "BDSA-2021-2976",
    "title": "Mozilla Firefox and Firefox ESR Vulnerable to Memory Corruption via Multiple Memory Safety Bugs",
    "description": "Firefox and Firefox ESR contain multiple memory safety bugs that showed evidence of memory corruption. The worst case exploitation scenario could potentially result in remote code execution (RCE), however this has not been demonstrated.",
    "technicalDescription": "These vulnerabilities exist due to:\n* Insufficient checks for the WebGPU pref before initializing the GPU process in the `gfx/ipc/CompositorOptions.h` file.\n* A lack of clean up on the encode callback during shutdown in the `dom/media/webrtc/libwebrtcglue/WebrtcGmpVideoCodec.cpp` file.",
    "publishedDate": "2021-10-07T10:26:03.305Z",
    "updatedDate": "2022-07-18T09:49:23.407Z",
    "disclosureDate": "2021-10-05T00:00:00.000Z",
    "solution": "Fixed in Firefox [**93**](https://ftp.mozilla.org/pub/firefox/releases/93.0/) by the following commits:\n* [Commit 1](https://hg.mozilla.org/releases/mozilla-release/rev/a6e059349151e7f6767e1ad9eb489b781f8c2a6a)\n* [Commit 2](https://hg.mozilla.org/releases/mozilla-release/rev/4e0617841a37c8ce6c7952d0ff92c026ac262a1f)\n\nFixed in Firefox ESR [**91.2**](https://ftp.mozilla.org/pub/firefox/releases/91.2.0esr/) by the following commits:\n* [Commit 1](https://hg.mozilla.org/releases/mozilla-esr91/rev/989bde68af0951b0c1be25fb6304f4b358849979)\n* [Commit 2](https://hg.mozilla.org/releases/mozilla-esr91/rev/951862a51fd68c96ce4a37b9b2b21c2acc422b74)\n\nFixed in Firefox ESR [**78.15**](https://ftp.mozilla.org/pub/firefox/releases/78.15.0esr/) by the following commits:\n* [Commit 1](https://hg.mozilla.org/releases/mozilla-esr78/rev/e1d4e7ed74be90e4aca5faea36203bc753f61d91)\n* [Commit 2](https://hg.mozilla.org/releases/mozilla-esr78/rev/5a16b1e043044bd928baa3587bf5a60d1d21f3ab)\n\nThe latest releases for Firefox and Firefox ESR are available [here](https://ftp.mozilla.org/pub/firefox/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Andreas Pehrson and Christian Holler",
    "workaround": "",
    "vendorFixDate": "2021-10-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2976",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-38500",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2976/ranges"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/78.15.0esr/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/91.2.0esr/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/93.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-esr78/rev/5a16b1e043044bd928baa3587bf5a60d1d21f3ab",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-esr78/rev/e1d4e7ed74be90e4aca5faea36203bc753f61d91",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-esr91/rev/951862a51fd68c96ce4a37b9b2b21c2acc422b74",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-esr91/rev/989bde68af0951b0c1be25fb6304f4b358849979",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/4e0617841a37c8ce6c7952d0ff92c026ac262a1f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/a6e059349151e7f6767e1ad9eb489b781f8c2a6a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-43/#CVE-2021-38500",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-44/#CVE-2021-38500",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-45/#CVE-2021-38500",
                "label": "ADVISORY"
            }
        ]
    }
}