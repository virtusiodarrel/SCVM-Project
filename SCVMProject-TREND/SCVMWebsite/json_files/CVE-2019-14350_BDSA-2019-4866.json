{
    "source": "BDSA",
    "name": "BDSA-2019-4866",
    "title": "EspoCRM Vulnerable to Stored Cross-Site Scripting (XSS) via 'body' parameter",
    "description": "EspoCRM has a stored cross-site scripting (XSS) vulnerability due to an absence of correct parameter input validation. A remote attacker could insert JavaScript code and steal a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "This vulnerability exists because, during the knowledge base record creation process, user input that is received via the `body` parameter  is not properly sanitized before it's processed further. This could allow an attacker to inject malicious JavaScript code into the server via this parameter. Later on, when other users visit the page where the knowledge record was created, the malicious code will execute in their browsers.",
    "publishedDate": "2020-12-01T11:46:30.371Z",
    "updatedDate": "2020-12-01T11:46:30.365Z",
    "disclosureDate": "2019-07-18T00:00:00.000Z",
    "exploitPublishDate": "2019-07-18T00:00:00.000Z",
    "solution": "Fixed in [**5.6.5**](https://github.com/espocrm/espocrm/releases/tag/5.6.5) by [this](https://github.com/espocrm/espocrm/commit/6dd0bd8b90705e02f0d325ca6278d95b8823d9ca) commit.\n\nThe latest stable releases are available [here](https://github.com/espocrm/espocrm/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Khajiit Stole Nothing",
    "workaround": "",
    "vendorFixDate": "2019-07-18T00:00:00.000Z",
    "vendorNotifiedDate": "2019-07-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4866",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14350",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4866/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/commit/6dd0bd8b90705e02f0d325ca6278d95b8823d9ca",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/issues/1356",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/issues/1356",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/espocrm/espocrm/releases/tag/5.6.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4866/default-remediation-status"
            }
        ]
    }
}