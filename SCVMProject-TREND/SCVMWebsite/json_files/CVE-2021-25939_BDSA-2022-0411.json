{
    "source": "BDSA",
    "name": "BDSA-2022-0411",
    "title": "Arangodb Vulnerable to Blind Server-Side Request Forgery (SSRF) via 'Foxx Service' Download Feature",
    "description": "Arangodb is vulnerable to a blind server-side request forgery (SSRF) issue due to how the 'Foxx service' download feature does not enforce sufficient filtering of requests that are performed internally.\n\nAn authenticated attacker with high privileges could abuse this issue in order to send internal requests to localhost.",
    "technicalDescription": "",
    "publishedDate": "2022-02-11T11:27:16.347Z",
    "updatedDate": "2022-02-11T11:27:16.294Z",
    "disclosureDate": "2022-02-09T00:00:00.000Z",
    "exploitPublishDate": "2022-02-09T00:00:00.000Z",
    "solution": "Fixed in [**3.8.5**](https://github.com/arangodb/arangodb/releases/tag/v3.8.5) by [this](https://github.com/arangodb/arangodb/commit/d93fc3974c7) commit and in [**3.9.0-beta1**](https://github.com/arangodb/arangodb/releases/tag/v3.9.0-beta.1) by [this](https://github.com/arangodb/arangodb/commit/d7b35a6884c) commit.\n\n**Note**: The vendor has stated [here](https://github.com/arangodb/arangodb/pull/15344#issue-1079754008) that to preserve backwards compatibility, they have opted to enable the new `--foxx.allow-install-from-remote` option by default in ArangoDB **3.8.x** versions from **3.8.5** and onwards. This means that these versions are vulnerable to this issue in their default state. Users will need to toggle this option in the startup options.\nIn **3.9.x** versions starting with **3.9.0-beta1**, the default value for the option will flip from `true` to `false`. \n\nThe latest stable releases are available [here](https://www.arangodb.com/download/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 2.7,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.2,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-12-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0411",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-25939",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0411/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/arangodb/arangodb/commit/d7b35a6884c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/arangodb/arangodb/commit/d93fc3974c7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/arangodb/arangodb/pull/15292",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/arangodb/arangodb/pull/15344#issue-1079754008",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/arangodb/arangodb/releases/tag/v3.8.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/arangodb/arangodb/releases/tag/v3.9.0-beta.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/arangodb-announce/c/FktLZet7tlA",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.arangodb.com/download/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-25939",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-25939",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0411/default-remediation-status"
            }
        ]
    }
}