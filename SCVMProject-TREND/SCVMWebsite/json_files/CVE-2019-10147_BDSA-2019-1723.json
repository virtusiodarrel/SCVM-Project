{
    "source": "BDSA",
    "name": "BDSA-2019-1723",
    "title": "CoreOS rkt Vulnerable to Sandbox Escape via 'rkt enter' Command",
    "description": "CoreOS rkt contains a sandbox escape vulnerability. This allows an attacker with root access to a container to escape the container onto connected hosts.",
    "technicalDescription": "The sandbox escape is possible due to binaries used with the `rkt enter` command not being isolated by cgroups during stage 2. This is the final stage of rkt deployment, meaning that the given binary will be running with root privileges.  \n\nThis allows an attacker with root access to a container to overwrite common binaries such as `bin/bash` with a malicious version that will run as root.  In an attack scenario, a victim has to connect to the attackers container using the `rkt enter` command. This will by default use the `bin/bash` binary. Once a victim has connected to the malicious container and spawned a process controlled by the attacker, it is trivial for the attacker to escape the container since the process is running with root privileges (no seccomp filtering, no cgroup isolation).",
    "publishedDate": "2019-06-05T14:54:52.534Z",
    "updatedDate": "2019-06-05T14:54:52.516Z",
    "disclosureDate": "2019-05-30T00:00:00.000Z",
    "exploitPublishDate": "2019-05-30T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 2.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:A/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:U/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 0.7,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "CONFIRMED",
            "score": 6.9
        },
        "vector": "CVSS:3.0/AV:A/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:H/E:P/RL:U/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Yuval Avrahami",
    "workaround": "",
    "vendorNotifiedDate": "2019-05-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1723",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10147",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1723/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10144",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rkt/rkt/issues/3998",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.twistlock.com/labs-blog/breaking-out-of-coresos-rkt-3-new-cves/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.twistlock.com/labs-blog/breaking-out-of-coresos-rkt-3-new-cves/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1723/default-remediation-status"
            }
        ]
    }
}