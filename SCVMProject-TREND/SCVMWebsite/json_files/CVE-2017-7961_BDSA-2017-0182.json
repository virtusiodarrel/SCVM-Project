{
    "source": "BDSA",
    "name": "BDSA-2017-0182",
    "title": "libcroco cr_tknzr_parse_rgb allows Heap Overflow",
    "description": "There is a flaw in libcroco that causes a Heap Buffer Overflow when an RGB value greater than the allotted range is read. \n\nThe security implications of this vulnerability are disputed.",
    "technicalDescription": "The libcroco package contains a standalone CSS2 parsing and manipulation library.\n\nIn libcroco **0.6.11** and **0.6.12** the `cr_tknzr_parse_rgb` function in `cr-tknzr.c`  contains a function that converts (truncates) a double value to a  long value which may lead to an undefined behavior issue.  This coding flaw may be exploitable through manipulation of the integer variable. \n```\n#csslint-0.6 $MALICIOUSFILE\n```\n\n```\n> /tmp/portage/dev-libs/libcroco-0.6.12/work/libcroco-0.6.12/src/cr-\n> tknzr.c:1283:15: runtime error: value 9.11111e+19 is outside the range of \n> representable values of type 'long'\n```\n\nThis attack vector is disputed as the program truncates the value from double to long, and the value is that of an RGB component which would have little or no impact. Without further research it is not possible to determine the scope of a potential exploit.",
    "publishedDate": "2017-07-14T16:10:24.878Z",
    "updatedDate": "2019-02-19T15:59:54.371Z",
    "disclosureDate": "2017-04-17T00:00:00.000Z",
    "exploitPublishDate": "2017-04-12T00:00:00.000Z",
    "solution": "Patch  [here](https://git.gnome.org/browse/libcroco/commit/?id=9ad72875e9f08e4c519ef63d44cdbd94aa9504f7)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "TEMPORARY_FIX",
            "reportConfidence": "UNCONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:F/RL:TF/RC:UC)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "TEMPORARY_FIX",
            "reportConfidence": "UNKNOWN",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:F/RL:T/RC:U"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Agostino Sarubbo of Gentoo.",
    "workaround": "",
    "vendorFixDate": "2017-04-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-0182",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-7961",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-0182/ranges"
            },
            {
                "rel": "reference",
                "href": "http://openwall.com/lists/oss-security/2017/04/24/2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blogs.gentoo.org/ago/2017/04/17/libcroco-heap-overflow-and-undefined-behavior/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.gnome.org/browse/libcroco/commit/?id=9ad72875e9f08e4c519ef63d44cdbd94aa9504f7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asarubbo/poc/commit/62e3d81183986b8686d2c2aa77e13837e0dd2909#diff-fe349c73d306a57742dcc9864bb1514f",
                "label": "EXPLOIT"
            }
        ]
    }
}