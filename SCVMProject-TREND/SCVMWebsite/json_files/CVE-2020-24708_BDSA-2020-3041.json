{
    "source": "BDSA",
    "name": "BDSA-2020-3041",
    "title": "Gophish Vulnerable to Cross-Site Scripting (XSS) via 'sendTestEmail()' Function",
    "description": "Gophish is vulnerable to cross-site scripting (XSS) due to improper validation of user-supplied input. This could allow an attacker to execute arbitrary web scripts in a victim's browser. This could allow them to steal sensitive information, such as authentication tokens and user session cookies.",
    "technicalDescription": "This vulnerability exists within `sendTestEmail()` function of file `static/js/src/app/sending_profiles.js`. This is due to the lack of validation of user supplied input that is used in the dynamic construction of an error message. Attackers can exploit this to execute malicious scripts in a victim's browser. This could allow the attacker to obtain sensitive information, such as browser cookies.\n\nThe issue was resolved by using the `escapeHtml()` function to sanitize the client-provided data.",
    "publishedDate": "2020-10-29T16:04:21.948Z",
    "updatedDate": "2020-10-29T16:04:21.941Z",
    "disclosureDate": "2020-08-07T00:00:00.000Z",
    "solution": "Fixed in [**0.11.0**](https://github.com/gophish/gophish/releases/tag/v0.11.0) by [this](https://github.com/gophish/gophish/commit/90fed5a575628b89eaf941e1627b49e0f3693812) commit.\n\nThe latest stable releases are available [here](https://github.com/gophish/gophish/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-08-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3041",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-24708",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3041/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gophish/gophish/commit/90fed5a575628b89eaf941e1627b49e0f3693812",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gophish/gophish/commit/90fed5a575628b89eaf941e1627b49e0f3693812",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gophish/gophish/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gophish/gophish/releases/tag/v0.11.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3041/default-remediation-status"
            }
        ]
    }
}