{
    "source": "BDSA",
    "name": "BDSA-2021-1484",
    "title": "libx11 Vulnerable to Remote Code Execution (RCE) via Command Injection in Color Lookup Functionality",
    "description": "libx11 is vulnerable to remote code execution due to the improper handling of color name requests. A remote attacker could execute arbitrary X protocol requests on a vulnerable server by sending maliciously crafted `XLookupColor` requests to that server.",
    "technicalDescription": "Various functions within libx11 can use user-specified string values for color code lookups.  Examples of such functions include `XLoadQueryFont()`, of file `src/Font.c`, and `XLoadFont()`, of file `src/LoadFont.c`. The lengths of these strings are stored in unsigned short integer variables. The lengths of the strings are insufficiently validated, which can lead to an overflow in the length value. The application can be mislead into thinking that the final character in the string is located at a point prior to the actual end location. The remaining characters in the string can be processed as if they are a valid X protocol command. An attacker can exploit this to inject malicious commands and achieve arbitrary code execution on the vulnerable machine.",
    "publishedDate": "2021-05-20T15:44:32.756Z",
    "updatedDate": "2021-05-20T15:44:32.746Z",
    "disclosureDate": "2021-05-18T00:00:00.000Z",
    "exploitPublishDate": "2021-05-18T00:00:00.000Z",
    "solution": "Fixed in [**1.7.1**](https://gitlab.freedesktop.org/xorg/lib/libx11/-/tags/libX11-1.7.1) by [this](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/8d2e02ae650f00c4a53deb625211a0527126c605) commit.\n\nThe latest stable releases are available [here](https://gitlab.freedesktop.org/xorg/lib/libx11/-/tags).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The following workarounds have been provided:\n\n> xterm should not be used to display less trusted data, e.g. from SSH connections to less trusted remote machines.\n> To avoid attacks via .Xdefaults on kiosk type machines, where graphical user has no permission to execute arbitrary operating system commands or sometimes not even to send hardware keyboard keystrokes, the .Xdefaults must not be modifiable by the user. But also changing of \"HOME\" environment variable to an untrusted location has to be prevented.",
    "vendorFixDate": "2021-03-26T00:00:00.000Z",
    "vendorNotifiedDate": "2021-02-12T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1484",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-31535",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1484/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1961822",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/8d2e02ae650f00c4a53deb625211a0527126c605",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/8d2e02ae650f00c4a53deb625211a0527126c605",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/xorg/lib/libx11/-/tags/libX11-1.7.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://unparalleled.eu/blog/2021/20210518-using-xterm-to-navigate-the-huge-color-space/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://unparalleled.eu/blog/2021/20210518-using-xterm-to-navigate-the-huge-color-space/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://unparalleled.eu/publications/2021/advisory-unpar-2021-1.txt",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1484/default-remediation-status"
            }
        ]
    }
}