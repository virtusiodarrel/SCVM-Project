{
    "source": "BDSA",
    "name": "BDSA-2021-2518",
    "title": "Dolibarr Vulnerable to Account Takeover via Insufficient Validation in 'update()' Function",
    "description": "Dolibarr is vulnerable to account takeovers due to insufficient checks being performed in functionality that is used to update user information. A remote authenticated attacker could gain access to a victim's account by abusing the application's user update interface.",
    "technicalDescription": "The `User` class is defined in the file `htdocs/user/class/user.class.php`. This class contains the `$login` attribute, which is a string that specifies the login name for the user. The `User` class also contains the `update()` method. This can be used to modify a user's information, including their login name, within the back-end database. \n\nThe `update()` method accepts a `$user` object as one of its arguments. The data that is to be used in the update is extracted from this object's attributes and then used to dynamically construct the SQL statements which modify the database. No checks are performed to ensure that the `$login` attribute of the `$user` object does not match that of an existing user.\n\nAn authenticated attacker with administrator privileges could exploit this flaw in order to perform account takeover attacks. They could achieve this by providing a login name to the update interface which matches that of a victim, along with an arbitrary password. The attacker will then be able to log in to the application with that name and password and have full access to the victim user's account.",
    "publishedDate": "2021-08-19T15:48:44.417Z",
    "updatedDate": "2021-08-19T15:54:38.446Z",
    "disclosureDate": "2021-06-13T00:00:00.000Z",
    "solution": "Fixed in version [**14.0.0**](https://github.com/Dolibarr/dolibarr/releases/tag/14.0.0) by [this](https://github.com/Dolibarr/dolibarr/commit/c4cba43bade736ab89e31013a6ccee59a6e077ee) commit.\n\nThe latest stable releases can be found [here](https://github.com/Dolibarr/dolibarr/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ahsan Aziz",
    "workaround": "",
    "vendorFixDate": "2021-06-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2518",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-25956",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2518/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/commit/c4cba43bade736ab89e31013a6ccee59a6e077ee",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/commit/c4cba43bade736ab89e31013a6ccee59a6e077ee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/releases/tag/14.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2518/default-remediation-status"
            }
        ]
    }
}