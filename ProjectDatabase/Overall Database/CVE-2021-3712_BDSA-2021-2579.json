{
    "source": "BDSA",
    "name": "BDSA-2021-2579",
    "title": "OpenSSL Vulnerable to Information Exposure via Null Byte Mishandling for ASN.1 Strings",
    "description": "OpenSSL is vulnerable to information exposure due to faulty logic that assumes that ASN.1 strings will always be null-terminated. A remote attacker could potentially recover sensitive data from the application's memory by causing it to process maliciously crafted ASN.1 strings. It may also be possible for an attacker to cause the application to crash.",
    "technicalDescription": "The function `X509_aux_print()`, of file `crypto/x509/t_x509.c`, accepts several arguments. One of these arguments is a pointer to an `X509` structure, `x`. The function defines a local variable, `alias`, which is a pointer to an array of characters. The value of `alias` is set via a call to `X509_alias_get0()`, which is defined within the file `crypto/x509/x_x509a.c`. This function returns a pointer to the `data` array which is nested within the `X509` structure. This is an array of bytes which may or may not be null terminated. Whenever invoking `X509_alias_get0()`, the caller can pass a pointer to an integer variable as an argument. `X509_alias_get0()` will set the value of this integer to the size of the byte array.\n\nInstead of passing such a pointer, `X509_aux_print()` simply passes a value of null, and assumes that the buffer returned by `X509_alias_get0()` constitutes a C-style string (i.e. a null terminated array of characters). The `BIO_printf()` function is then called in order to print the contents of the `alias` buffer. This function behaves similarly to the regular `printf()` function, in that it will keep printing the characters in a buffer until a null byte is encountered. However, because the `alias` buffer is not necessarily null-terminated, an out-of-bounds read could occur. This could potentially disclose the contents of the process's memory, or may lead to an exception being raised, which will halt the execution of the program.\n\nA remote attacker could therefore exploit this issue in order to recover sensitive information (such as private keys or pointers, which may assist the attacker in further exploiting the application), or to cause a denial-of-service (DoS).",
    "publishedDate": "2021-08-25T10:22:13.833Z",
    "updatedDate": "2021-10-18T12:36:44.277Z",
    "disclosureDate": "2021-07-20T00:00:00.000Z",
    "solution": "Fixed in version [**1.1.1l**](https://github.com/openssl/openssl/releases/tag/OpenSSL_1_1_1l) by [this](https://github.com/openssl/openssl/commit/d9d838ddc0ed083fb4c26dd067e71aad7c65ad16) commit.\n\nA fix release for the **1.0.2** branch, [**1.0.2za**](https://www.openssl.org/support/contracts.html),  is available for premium support customers.\n\nThe latest stable releases can be found [here](https://github.com/openssl/openssl/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ingo Schwarze, Matt Caswell",
    "workaround": "",
    "vendorFixDate": "2021-07-20T00:00:00.000Z",
    "vendorNotifiedDate": "2021-07-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2579",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-3712",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2579/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/commit/d9d838ddc0ed083fb4c26dd067e71aad7c65ad16",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/releases/tag/OpenSSL_1_1_1l",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openssl.org/news/secadv/20210824.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openssl.org/news/vulnerabilities.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openssl.org/support/contracts.html",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}