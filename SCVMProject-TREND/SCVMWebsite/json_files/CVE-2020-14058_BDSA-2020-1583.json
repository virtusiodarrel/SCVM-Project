{
    "source": "BDSA",
    "name": "BDSA-2020-1583",
    "title": "Squid Vulnerable to Denial-of-Service (DoS) via Faulty Certificate Validation During TLS Handshake",
    "description": "Squid is vulnerable to denial-of-service (DoS) due to the flawed processing of TLS certificates. A remote attacker could cause a vulnerable server to crash by conducting a malicious TLS handshake with that server. Squid must have been built with OpenSSL features to be vulnerable.",
    "technicalDescription": "The TLS handshake that is conducted by Squid involves the validation of X509 certificates. If an error occurs whenever Squid is conducting this validation, an error value is produced. These values are mapped to error name strings, which are retrieved using the function `Ssl::GetErrorName()` of `ErrorDetail.cc`. However, error codes may be produced that are unknown and thus do not map to an error string. This will cause `Ssl::GetErrorName()` to return `NULL`. This can cause an exception to occur, as Squid always expects a valid error string to have been returned. This will crash the program. A remote attacker could therefore cause a DoS by conducting a malicious TLS handshake with that server. Squid must have been built with OpenSSL features to be vulnerable.",
    "publishedDate": "2020-07-01T16:30:39.004Z",
    "updatedDate": "2020-07-01T16:30:38.995Z",
    "disclosureDate": "2020-06-19T00:00:00.000Z",
    "solution": "Fixed in [**5.0.3**](http://www.squid-cache.org/Versions/v5/) by [this](https://github.com/squid-cache/squid/commit/c6d1a4f6a2cbebceebc8a3fcd8f539ceb7b7f723) commit.\n\nFixed in [**4.12**](http://www.squid-cache.org/Versions/v4/) by [this](https://github.com/squid-cache/squid/commit/93f5fda134a2a010b84ffedbe833d670e63ba4be) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Christof Gerber and Mario Galli (Open Systems AG)",
    "workaround": "The vendor has provided the following workaround information:\n\"\n * For interception proxies using SSL-Bump functionality there is no workaround.\n\n* For  `reverse-proxy` the GnuTLS support available in Squid-4 may provide sufficient functionality. The vulnerable certificate validator helper feature is not supported yet by GnuTLS builds.\n\n * Other installations just needing to relay HTTPS do not need OpenSSL support and should be able to run a build that does not have `--with-openssl`. \"",
    "vendorFixDate": "2020-05-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1583",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-242"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14058",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1583/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Advisories/SQUID-2020_6.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Advisories/SQUID-2020_6.txt",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v5/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/93f5fda134a2a010b84ffedbe833d670e63ba4be",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/c6d1a4f6a2cbebceebc8a3fcd8f539ceb7b7f723",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-qvf6-485q-vm57",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1583/default-remediation-status"
            }
        ]
    }
}