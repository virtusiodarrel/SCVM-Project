{
    "source": "BDSA",
    "name": "BDSA-2021-3387",
    "title": "PostgreSQL Vulnerable to Man-in-the-Middle (MitM) attacks via SSL or GSS Encryption",
    "description": "PostgreSQL is vulnerable to a man-in-the-middle (MitM) attack. An attacker could take advantage of this to inject data into a TCP connection in order to send faked inject faked responses to the client's first few queries.\n\n**Note:** This vulnerability has been shown to be possible with a server vulnerable to CVE-2021-23214 (BDSA-2021-3382).",
    "technicalDescription": "This vulnerability exists when SSL or GSS encryption is requested during startup. Due to the server collecting up to a bufferload of data whenever it reads data from the client socket then any additional data received with the initial request message will remain in the buffer. This additional data will would be treated as already-decrypted data once the SSL or GSS encryption handshake is completed.  An attacker could take advantage of this to inject cleartext data into a TCP connection in order to send faked inject faked responses to the client's first few queries. This vulnerability could also be exploited to exfiltrate the client's password, or other sensitive data that might be sent early in the session.\n\nThe vendor has mitigated against this by throwing  a protocol-violation error if the internal buffer is not empty after the encryption handshake.",
    "publishedDate": "2021-11-12T10:22:44.464Z",
    "updatedDate": "2021-11-12T10:22:44.449Z",
    "disclosureDate": "2021-11-08T00:00:00.000Z",
    "solution": "Fixed in:\n* [**9.6.24**](https://github.com/postgres/postgres/releases/tag/REL9_6_24) by [this](https://github.com/postgres/postgres/commit/d83cdfdca9) commit,\n* [**10.19**](https://github.com/postgres/postgres/releases/tag/REL_10_19) by [this](https://github.com/postgres/postgres/commit/e65d9c8cd1) commit,\n* [**11.14**](https://github.com/postgres/postgres/releases/tag/REL_11_14) by [this](https://github.com/postgres/postgres/commit/a021a1d2ae) commit,\n* [**12.9**](https://github.com/postgres/postgres/releases/tag/REL_12_9) by [this](https://github.com/postgres/postgres/commit/36bb95ef2b) commit,\n* [**13.5**](https://github.com/postgres/postgres/releases/tag/REL_13_5) by [this](https://github.com/postgres/postgres/commit/844b316920) commit,\n* [**14.1**](https://github.com/postgres/postgres/releases/tag/REL_14_1) by [this](https://github.com/postgres/postgres/commit/30547d7913) commit.\n\nThe latest stable releases are available [here](https://www.postgresql.org/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jacob Champion",
    "workaround": "",
    "vendorFixDate": "2021-11-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3387",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23222",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3387/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/160c0258",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/30547d7913",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/36bb95ef2b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/844b316920",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/a021a1d2ae",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/d83cdfdca9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/e65d9c8cd1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL9_6_24",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_10_19",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_11_14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_12_9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_13_5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_14_1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.postgresql.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3387/default-remediation-status"
            }
        ]
    }
}