{
    "source": "BDSA",
    "name": "BDSA-2017-0246",
    "title": "Linux Kernel NFSv4 Server Layout Type Remote Denial of Service",
    "description": "The linux kernel NFSv4 server implementation contains a size check implemented by undefined behaviour.  An attacker can exploit this condition to cause a denial of service or code execution in the context of the kernel.",
    "technicalDescription": "The c code below, in `fs/nfsd/nfs4proc.c:1262` is undefined. Shift exponent `128` is too large for 32-bit type 'int'\n\n`if (!(exp->ex_layout_types & (1 << layout_type)))`\n\nDepending on compiler and architecture, this may cause the check for layout_type to succeed for overly large values (which seems to be the case with amd64). The large value will be later used in de-referencing nfsd4_layout_ops for function pointers.  This will lead to remote denial of service or remote code execution.\n\nThe attack payload fits to single one-way UDP packet. The kernel must be compiled with `CONFIG_NFSD_PNFS` enabled, which seems to be the case with many vendor kernels.",
    "publishedDate": "2017-06-30T15:18:51.694Z",
    "updatedDate": "2019-05-21T08:44:21.819Z",
    "disclosureDate": "2017-05-05T00:00:00.000Z",
    "solution": "Fixed in versions [**4.9.30**](https://www.kernel.org), [**4.11.3**](https://www.kernel.org), [**4.12-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b550a32e60a4941994b437a8d662432a486235a5) git commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 9.0,
        "impactSubscore": 8.5,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.6
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jani Tuovila from Synopsys",
    "workaround": "The attack vector requires that the attack host is within host mask of the exported NFSv4 mount, or source address spoofing is not properly mitigated in the network.  The kernel must be compiled with `CONFIG_NFSD_PNFS` enabled, which seems to be the case with many vendor kernels.",
    "vendorFixDate": "2017-05-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-0246",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-823"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-8797",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-0246/ranges"
            },
            {
                "rel": "reference",
                "href": "http://seclists.org/oss-sec/2017/q2/615",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b550a32e60a4941994b437a8d662432a486235a5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}