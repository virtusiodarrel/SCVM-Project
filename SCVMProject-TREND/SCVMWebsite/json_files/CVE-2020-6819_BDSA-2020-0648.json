{
    "source": "BDSA",
    "name": "BDSA-2020-0648",
    "title": "Multiple Mozilla Products Vulnerable to Denial-of-Service (DoS) via Use-After-Free in 'nsDocShell' Destructor Method",
    "description": "Multiple Mozilla products are vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause a victim's instance of the application to crash by tricking them into viewing maliciously crafted web content.\n\nIt has been reported that this vulnerability has been exploited by threat actors in the wild. The exact nature of this exploitation remains undisclosed.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "The `nsDocShell` class is used by Firefox in order to render content. Firefox accesses an instance of this class via the `nsCOMPtr` variable. This instance of `nsDocShell` utilizes the pointer variable `mRawPtr`, which corresponds to dynamically allocated memory. However, `nsDocShell` fails to set this pointer to NULL within its destructor. \nA race condition exists such that the application can attempt to access the memory pointed to by `mRawPtr` after the corresponding instance of `nsDocShell` has been destroyed. This constitutes a use-after-free, which can occur whenever certain content is being processed by the browser. An attacker could cause a victim's instance of the application to crash by tricking them into viewing maliciously crafted web content.\n\nIt has been reported that this vulnerability has been exploited by threat actors in the wild. The exact nature of this exploitation remains undisclosed.",
    "publishedDate": "2020-04-20T13:38:09.190Z",
    "updatedDate": "2022-05-06T11:21:38.380Z",
    "disclosureDate": "2020-04-03T00:00:00.000Z",
    "exploitPublishDate": "2020-04-03T00:00:00.000Z",
    "solution": "Fixed in Firefox version [**74.0.1**](https://ftp.mozilla.org/pub/firefox/releases/74.0.1/) by [this](https://hg.mozilla.org/releases/mozilla-release/rev/a4d7d228e423decf11c3981f5870574daecb5457) commit.\n\nFixed in Firefox ESR version [**68.6.1**](https://ftp.mozilla.org/pub/firefox/releases/68.6.1esr/).\n\nFixed in Mozilla Thunderbird [**68.7.0**](https://ftp.mozilla.org/pub/thunderbird/releases/) by [this](https://hg.mozilla.org/mozilla-central/rev/a4d7d228e423decf11c3981f5870574daecb5457) revision.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Francisco Alonso, Javier Marcos (JMP Security)",
    "workaround": "",
    "vendorFixDate": "2020-04-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0648",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-6819",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0648/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1620818",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/68.6.1esr/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/74.0.1/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/thunderbird/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/a4d7d228e423decf11c3981f5870574daecb5457",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/releases/mozilla-release/rev/a4d7d228e423decf11c3981f5870574daecb5457",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2020-11/#CVE-2020-6819",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0648/default-remediation-status"
            }
        ]
    }
}