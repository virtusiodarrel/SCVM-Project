{
    "source": "BDSA",
    "name": "BDSA-2020-4630",
    "title": "Eclipse Theia Vulnerable to Cross-Site Scripting (XSS) via Markdown Preview",
    "description": "Eclipse Theia is vulnerable to cross site scripting (XSS) due to lack of sanitization of user supplied input. This could allow an attacker to inject arbitrary web scripts and obtain sensitive information, such as authentication tokens and user session cookies.\n\n**Note:** As demonstrated in the third-party PoC this issue could be exploited to achieve remote code execution (RCE) as Root on Google Cloud Shell.",
    "technicalDescription": "This issue occurs in the `MarkdownPreviewHandler` class of the `packages/preview/src/browser/markdown/markdown-preview-handler.ts` file due to a lack of sanitization. It was mitigated by the addition of sanitization via `DOMPurify`.",
    "publishedDate": "2021-10-01T16:06:02.688Z",
    "updatedDate": "2021-10-01T16:06:02.679Z",
    "disclosureDate": "2020-06-03T00:00:00.000Z",
    "exploitPublishDate": "2020-06-03T00:00:00.000Z",
    "solution": "Fixed in version [**1.3.0**](https://github.com/eclipse-theia/theia/releases/tag/v1.3.0) and by [this](https://github.com/eclipse-theia/theia/commit/309b21892eedfadf0cd559afff64a26750933c4f) commit.\n\nThe latest stable releases can be found [here](https://github.com/eclipse-theia/theia/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Casey Flynn caseyflynn-google",
    "workaround": "",
    "vendorFixDate": "2020-06-08T00:00:00.000Z",
    "vendorNotifiedDate": "2020-06-03T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4630",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27224",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4630/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse-theia/theia/commit/309b21892eedfadf0cd559afff64a26750933c4f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse-theia/theia/commit/44f79e94866ecf1632bfe59595c739161f7fa05a",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse-theia/theia/issues/7954",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse-theia/theia/issues/7954",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse-theia/theia/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse-theia/theia/releases/tag/v1.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://omespino.com/write-up-google-bug-bounty-xss-to-cloud-shell-instance-takeover-rce-as-root-5000-usd/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://omespino.com/write-up-google-bug-bounty-xss-to-cloud-shell-instance-takeover-rce-as-root-5000-usd/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4630/default-remediation-status"
            }
        ]
    }
}