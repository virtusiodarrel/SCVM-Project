{
    "source": "BDSA",
    "name": "BDSA-2018-5172",
    "title": "Rufus Vulnerable to DLL Search Order Hijacking Leading to Remote Code Execution (RCE)",
    "description": "Rufus is vulnerable to a DLL search order hijacking vulnerability that can allow an attacker to execute arbitrary code and escalate their privileges.",
    "technicalDescription": "This issue stems from `SetDllDirectory(\"\")` not working correctly as intended. If a parameter containing an empty string is passed to it, the call is supposed to remove the current directory from the default DLL search order. As this does not work correctly, the developers implemented their own call (`SetDllDirectoryA(\"\")`) to fix this vulnerability.",
    "publishedDate": "2020-08-27T15:34:07.523Z",
    "updatedDate": "2020-08-27T15:34:07.515Z",
    "disclosureDate": "2018-05-31T00:00:00.000Z",
    "exploitPublishDate": "2018-07-01T00:00:00.000Z",
    "solution": "Fixed in [**3.1**](https://github.com/pbatard/rufus/releases/tag/v3.1) by [this](https://github.com/pbatard/rufus/commit/e1d864f75553767310eea17d0369b25456607bc6) commit.\n\nA list of current stable releases can be found [here](https://github.com/pbatard/rufus/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 10.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 10.0,
        "severity": "HIGH",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "(AV:N/AC:L/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "An incomplete mitigation provided by the vendor can be found [here](https://github.com/pbatard/rufus/commit/8473e9ef561295fd10dd9526010c1fd1cb1e6701).",
    "vendorFixDate": "2018-10-20T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5172",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-426"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-427"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-1010100",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5172/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pbatard/rufus/commit/8473e9ef561295fd10dd9526010c1fd1cb1e6701",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pbatard/rufus/commit/e1d864f75553767310eea17d0369b25456607bc6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pbatard/rufus/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pbatard/rufus/releases/tag/v3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2018/q2/146",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2018/q2/152",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5172/default-remediation-status"
            }
        ]
    }
}