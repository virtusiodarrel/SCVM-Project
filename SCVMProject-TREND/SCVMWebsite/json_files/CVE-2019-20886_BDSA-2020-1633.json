{
    "source": "BDSA",
    "name": "BDSA-2020-1633",
    "title": "Mattermost Server Vulnerable to Privilege Escalation via Improper Privilege Assignment During User Creation",
    "description": "Mattermost contains a privilege escalation issue where the first user created has system admin privileges. This could allow an attacker unrestricted access to the system.",
    "technicalDescription": "This vulnerability occurs in the `UpdateUserRoles()` function of the `cmd/mattermost/commands/user.go` file in Mattermost Server. \n\nAn attacker can take advantage of this by creating a user with system admin privileges. This allows unrestricted access to the system which could be used to carry out subsequent attacks.\n\nThe vendor has mitigated against this by adding in additional checks during user creation.",
    "publishedDate": "2020-07-10T09:21:38.913Z",
    "updatedDate": "2020-07-10T09:21:38.904Z",
    "disclosureDate": "2020-01-02T00:00:00.000Z",
    "solution": "Fixed in [**5.8.0-rc1**](https://github.com/mattermost/mattermost-server/releases/tag/v5.8.0-rc1) by [this](https://github.com/mattermost/mattermost-server/commit/daa6c4172a937a69943d56671511efc2d1747b6b) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rohitesh Gupta",
    "workaround": "",
    "vendorFixDate": "2020-01-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1633",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20886",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1633/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/commit/daa6c4172a937a69943d56671511efc2d1747b6b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/releases/tag/v5.8.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mattermost.com/security-updates/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1633/default-remediation-status"
            }
        ]
    }
}