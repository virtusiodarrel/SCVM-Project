{
    "source": "BDSA",
    "name": "BDSA-2021-2471",
    "title": "HashiCorp Vault  Vulnerable to Data Removal via Insufficient Access Control on Integrated Storage Backend Database",
    "description": "HashiCorp Vault contains access controls on the Integrated Storage backend database which are overly inclusive.  This could allow an attacker to delete the `vault.db` database file. \n\n**Note:** The vendor has stated that most Vault environments are unlikely to have significant impacts as a result of this issue, and that:\n* Only Vault clusters utilizing Integrated Storage are affected.\n* The default system umask on each Vault node will likely cause a less-inclusive permission to be applied.",
    "technicalDescription": "This vulnerability exists due to a `vault.db` database file being created on the disk during the initialization of the Integrated Storage backend, which has overly inclusive filesystem permissions. The permissions applied to this `vault.db` file may vary, however the vendor has stated that there are already protections in place against the unauthorized access or tampering of data. This means that the only unauthorized actions an attacker can perform on the `vault.db` file is to delete it.\n\nThe vendor has mitigated against this by ensuring the `vault.db` file is only accessible to the owner.",
    "publishedDate": "2021-08-16T16:27:00.287Z",
    "updatedDate": "2021-08-16T16:27:00.277Z",
    "disclosureDate": "2021-08-12T00:00:00.000Z",
    "solution": "Fixed in [**1.8.0**](https://github.com/hashicorp/vault/releases/tag/v1.8.0) by [this](https://github.com/hashicorp/vault/commit/82a99f14eb6133f99a975e653d4dac21c17505c7) commit.\n\nThe latest stable releases are available [here](https://github.com/hashicorp/vault/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-07-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2471",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-38553",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2471/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.hashicorp.com/t/hcsec-2021-20-vault-s-integrated-storage-backend-database-file-may-have-excessively-broad-permissions/28168",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/82a99f14eb6133f99a975e653d4dac21c17505c7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases/tag/v1.8.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2471/default-remediation-status"
            }
        ]
    }
}