{
    "source": "BDSA",
    "name": "BDSA-2022-1149",
    "title": "Apache CouchDB Vulnerable to Remote Code Execution (RCE) via Insecure Default Installation",
    "description": "Apache CouchDB is vulnerable to remote code execution (RCE) due to insecure configurations used by the packaging functionality. This could be leveraged by an attacker against installations which have not been properly secured to obtain administrative privileges without authentication.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "By default, CouchDB uses a random network port for clustered operation/runtime introspection which is advertised by the `epmd` utility to the network. Additionally, the default cookie value `monster` is set which is used for Erlang node communication. This default configuration can be exploited to obtain unauthenticated access and elevate privileges.\n\nThe vendor addressed this issue by removing the default `monster` value and requiring installations to choose a different value, as well as locally binding `epmd` and the CouchDB distribution port.\n\nThe vendor recommends the following for securing an installation:\n> We recommend a firewall in front of all CouchDB installations. The full CouchDB api is available on registered port `5984` and this is the only port that needs to be exposed for a single-node install. Installations that do not expose the separate distribution port to external access are not vulnerable.",
    "publishedDate": "2022-04-27T10:25:54.068Z",
    "updatedDate": "2022-08-26T08:17:49.058Z",
    "disclosureDate": "2022-04-26T00:00:00.000Z",
    "exploitPublishDate": "2022-05-11T00:00:00.000Z",
    "solution": "Fixed in version [**3.2.2**](https://github.com/apache/couchdb/releases/tag/3.2.2) by [this](https://github.com/apache/couchdb/commit/c4e811ecf97d5796145b60f3b99a84abcec56ebf) commit and [this](https://github.com/apache/couchdb/commit/63ee1944a94c274fb80d29a666229b50c02a2b0a) commit.\n\nThe latest stable releases can be found [here](https://couchdb.apache.org/#download).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alex Vandiver",
    "workaround": "",
    "vendorFixDate": "2022-04-06T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1149",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-453"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24706",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1149/ranges"
            },
            {
                "rel": "reference",
                "href": "https://couchdb.apache.org/#download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/couchdb/commit/63ee1944a94c274fb80d29a666229b50c02a2b0a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/couchdb/commit/c4e811ecf97d5796145b60f3b99a84abcec56ebf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/couchdb/releases/tag/3.2.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/w24wo0h8nlctfps65txvk0oc5hdcnv00",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/50914",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1149/default-remediation-status"
            }
        ]
    }
}