{
    "source": "BDSA",
    "name": "BDSA-2018-5039",
    "title": "OP-TEE Vulnerable to Information Exposure via Leaked Trusted Application Code/Data",
    "description": "OP-TEE is vulnerable to information exposure due to improper unloading of trusted applications (TAs). This could allow a local attacker to obtain sensitive information from previously loaded trusted application code and data.",
    "technicalDescription": "The function `elf_load_body` within the file `core/arch/arm/kernel/user_ta.c` does not properly clear memory allocated for the code and data of a previously loaded TA before a new TA is loaded.\n\nThe function uses the total size of the previous TA's code/data segments to clear the used memory block - however, this does not account for the fact that when memory for the TA was allocated, the actual size is rounded up to the next multiple of the memory pool granularity. This can result in some used memory not being cleared which may be accessible by the newly loaded TA, depending on the memory layouts of the TAs and any flags set which can prevent unloading of TAs such as `TA_FLAG_INSTANCE_KEEP_ALIVE`.",
    "publishedDate": "2019-07-24T08:48:49.150Z",
    "updatedDate": "2019-07-24T08:48:49.140Z",
    "disclosureDate": "2018-09-07T00:00:00.000Z",
    "solution": "Fixed in **[3.4.0](https://github.com/OP-TEE/optee_os/releases/tag/3.4.0)** by [this](https://github.com/OP-TEE/optee_os/commit/7e768f8a473409215fe3fff8f6e31f8a3a0103c6) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.2,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.9
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.1,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Riscure",
    "workaround": "",
    "vendorFixDate": "2018-09-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5039",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-1010294",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5039/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OP-TEE/optee_os/commit/7e768f8a473409215fe3fff8f6e31f8a3a0103c6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OP-TEE/optee_os/releases/tag/3.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.op-tee.org/security-advisories/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5039/default-remediation-status"
            }
        ]
    }
}