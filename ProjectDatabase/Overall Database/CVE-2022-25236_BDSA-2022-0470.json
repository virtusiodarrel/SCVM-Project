{
    "source": "BDSA",
    "name": "BDSA-2022-0470",
    "title": "libexpat Vulnerable to Remote Code Execution (RCE) via Namespace URI Validation Bypass with Namespace Separator Characters",
    "description": "libexpat is vulnerable to remote code execution (RCE) due to improper validation of namespace URIs. An attacker could exploit this vulnerability by supplying an application using libexpat with maliciously crafted input.\n\nThe vendor states that exploits with code execution are known to exist.",
    "technicalDescription": "The issue exists within the file `expat/lib/xmlparse.c`. The parser does not sufficiently restrict the insertion of additional namespace separator characters into `xmlns[:prefix]` attribute values, due to a missing URI validation check.",
    "publishedDate": "2022-02-17T11:39:45.087Z",
    "updatedDate": "2022-06-15T15:44:55.400Z",
    "disclosureDate": "2022-02-15T00:00:00.000Z",
    "solution": "Fixed in [**2.4.5**](https://github.com/libexpat/libexpat/releases/tag/R_2_4_5) by [this](https://github.com/libexpat/libexpat/commit/2cc97e875ef84da4bcf55156c83599116f7523b4) commit.\n\n**Note**: Due to compatibility issues, an update to the fix was pushed in [**2.4.7**](https://github.com/libexpat/libexpat/releases/tag/R_2_4_7) by [this](https://github.com/libexpat/libexpat/commit/f178826bb1e9c8ee23202f1be55ad4ac7b649e84) commit. The vendor also added documentation clarifying the current state of the resolution and application pre-requisites:\n> Expat does not validate namespace URIs (beyond encoding) against RFC 3986 today (and is not required to do so with regard to the XML 1.0 namespaces specification) but it may start doing that in future releases.  Before that, an application using Expat must be ready to receive namespace URIs containing non-URI characters.\n\nThe latest stable releases are available [here](https://github.com/libexpat/libexpat/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Ivan Fratric, Google Project Zero",
    "workaround": "",
    "vendorFixDate": "2022-02-18T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-0470",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2022-25236",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-0470/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libexpat/libexpat/commit/2cc97e875ef84da4bcf55156c83599116f7523b4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libexpat/libexpat/commit/f178826bb1e9c8ee23202f1be55ad4ac7b649e84",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libexpat/libexpat/pull/561",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libexpat/libexpat/pull/561/files#diff-234ad03631757ed9da4759c375c1e232de106a64a4b52213f609d5a3c6f5c60a",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libexpat/libexpat/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libexpat/libexpat/releases/tag/R_2_4_5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libexpat/libexpat/releases/tag/R_2_4_7",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}