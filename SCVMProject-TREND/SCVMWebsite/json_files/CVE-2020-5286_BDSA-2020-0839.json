{
    "source": "BDSA",
    "name": "BDSA-2020-0839",
    "title": "PrestaShop Vulnerable to Cross-Site Scripting (XSS) via 'file upload' Messages",
    "description": "PrestaShop contains a cross-site scripting (XSS) vulnerability due to a lack of user input validation. A remote attacker could trick a user into uploading a file with a malicious filename resulting in malicious scripts being executed when the filename is displayed in the error message. This could allow an attacker to steal the victim's session cookies.",
    "technicalDescription": "The vulnerability occurs due to insufficient sanitization of the  `filename` and `message` parameters used in the `showImportFileError` function. Failed file uploads result in an error message being displayed which includes user input from the affected parameters.  An attacker could exploit this to inject malicious scripts which will execute in the context of the user's browser.\n\nThis is issue was addressed by using the `.text` method to render the filename to the error message. This method escapes all special HTML characters.",
    "publishedDate": "2020-04-21T10:11:47.077Z",
    "updatedDate": "2020-04-21T10:11:47.070Z",
    "disclosureDate": "2020-04-15T00:00:00.000Z",
    "solution": "Fixed in version [**1.7.6.5**](https://github.com/PrestaShop/PrestaShop/tree/1.7.6.5) by [this](https://github.com/PrestaShop/PrestaShop/commit/fc0625fb0a9aab1835515f1bea52e8e063384da7) commit",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-04-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0839",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5286",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0839/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrestaShop/PrestaShop/commit/fc0625fb0a9aab1835515f1bea52e8e063384da7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-98j8-hvjv-x47j",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PrestaShop/PrestaShop/tree/1.7.6.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0839/default-remediation-status"
            }
        ]
    }
}