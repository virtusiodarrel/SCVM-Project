{
    "source": "BDSA",
    "name": "BDSA-2021-2628",
    "title": "October Library Vulnerable to Account Takeover via Password Reset Functionality",
    "description": "October Library contains an account takeover vulnerability. An attacker can take advantage of this in order to gain access to another user's account.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "This vulnerability exists due to insufficient checks in the `src/Auth/Models/Role.php`, `src/Auth/Models/User.php` and `src/Auth/Manager.php` files to ensure that a user has the correct permissions to change another account's password. An attacker can take advantage of this by using a specially crafted request in order to request an account password reset and subsequently gain access to the account.",
    "publishedDate": "2021-09-03T13:40:49.217Z",
    "updatedDate": "2022-01-28T15:04:32.737Z",
    "disclosureDate": "2021-08-26T00:00:00.000Z",
    "exploitPublishDate": "2022-01-20T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.0.472**](https://github.com/octobercms/library/releases/tag/v1.0.472) by [this](https://github.com/octobercms/library/commit/a969fa93d3dc27d23fbe6f95a5c9626ddab6e89a) commit and [this](https://github.com/octobercms/library/commit/d374aea7c38eb6e103c0faa68ec38a0d36d57fb8) commit,\n* [**1.1.5**](https://github.com/octobercms/library/releases/tag/v1.1.5) by [this](https://github.com/octobercms/library/commit/016a297b1bec55d2e53bc889458ed2cb5c3e9374) commit and [this](https://github.com/octobercms/library/commit/5bd1a28140b825baebe6becd4f7562299d3de3b9) commit.\n\nThe latest stable releases are available [here](https://github.com/octobercms/library/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrey Basarygin , Andrey Guzei, Mikhail Khramenkov, Alexander Sidukov, Maxim Teplykh",
    "workaround": "",
    "vendorFixDate": "2021-04-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2628",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-640"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32648",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2628/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/library/commit/016a297b1bec55d2e53bc889458ed2cb5c3e9374",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/library/commit/51f6eb180f9817a49ce7d7f968a084594e3148fb",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/library/commit/5bd1a28140b825baebe6becd4f7562299d3de3b9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/library/commit/a969fa93d3dc27d23fbe6f95a5c9626ddab6e89a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/library/commit/d374aea7c38eb6e103c0faa68ec38a0d36d57fb8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/library/releases/tag/v1.0.472",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/library/releases/tag/v1.1.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/library/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/octobercms/october/security/advisories/GHSA-mxr5-mc97-63rc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.youtube.com/watch?v=0hDxZWGWZrM",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2628/default-remediation-status"
            }
        ]
    }
}