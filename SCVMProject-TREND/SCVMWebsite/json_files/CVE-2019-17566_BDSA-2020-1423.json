{
    "source": "BDSA",
    "name": "BDSA-2020-1423",
    "title": "Apache Batik Vulnerable to Server Side Request Forgery (SSRF) via 'xlink:href' Attributes",
    "description": "Apache Batik is vulnerable to server side request forgery (SSRF) due to the unsafe implementation of a particular scalable vector graphic (SVG) file attribute. A remote attacker could cause a vulnerable server to submit arbitrary GET requests by sending malicious input to that server that makes use of this attribute.",
    "technicalDescription": "SVG files that are being parsed by Apache Batik can contain the `xlink:href` attribute, which can be used to specify an external resource. The server will then submit a HTTP GET request in order to retrieve that resource. There are no mechanisms in place to impose restrictions on, or to prevent, these requests. An attacker could therefore cause the server to send arbitrary HTTP GET requests using SVG images that contain maliciously crafted `xlink:href` attributes. This constitutes a SSRF vulnerability.\n\nIn order to mitigate this vulnerability, the `-blockExternalResources` has been added to Apache Batik. This should be specified on the command line when running the server.",
    "publishedDate": "2020-06-17T09:45:58.173Z",
    "updatedDate": "2021-08-03T10:37:47.884Z",
    "disclosureDate": "2020-06-15T00:00:00.000Z",
    "solution": "Fixed in [**1.13**](https://xmlgraphics.apache.org/batik/download.html) by [this](https://github.com/apache/xmlgraphics-batik/commit/bc6078ca949039e2076cd08b4cb169c84c1179b1) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sean Melia",
    "workaround": "",
    "vendorFixDate": "2019-12-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1423",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-17566",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1423/ranges"
            },
            {
                "rel": "reference",
                "href": "http://xmlgraphics.apache.org/security.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/xmlgraphics-batik/commit/bc6078ca949039e2076cd08b4cb169c84c1179b1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xmlgraphics.apache.org/batik/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1423/default-remediation-status"
            }
        ]
    }
}