{
    "source": "BDSA",
    "name": "BDSA-2022-2324",
    "title": "undici Vulnerable to CRLF Injection via Unsafe ''content-type'' Header Handling in 'processHeader' Function",
    "description": "undici is vulnerable to CRLF injection due to the improper handling of `content-header` fields. This could cause content that is contained in a single request to be treated as though it is associated with multiple requests. An attacker could potentially leverage this issue in order to obtain sensitive information, or cause unintended actions to be carried out on behalf of a victim user.",
    "technicalDescription": "The vulnerability exists because the function `processHeader()`, of file `lib/core/request.js`, performs insufficient validation on the values which are associated with `content-header` fields.",
    "publishedDate": "2022-08-22T15:33:39.027Z",
    "updatedDate": "2022-08-22T15:33:39.016Z",
    "disclosureDate": "2022-08-09T00:00:00.000Z",
    "exploitPublishDate": "2022-08-09T00:00:00.000Z",
    "solution": "Fixed in version [**5.8.2**](https://github.com/nodejs/undici/releases/tag/v5.8.2) by [this](https://github.com/nodejs/undici/commit/66165d604fd0aee70a93ed5c44ad4cc2df395f80) commit.\n\nThe latest stable releases can be found [here](https://github.com/nodejs/undici/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "happyhacking-k",
    "workaround": "The vendor has stated [here](https://github.com/nodejs/undici/security/advisories/GHSA-f772-66g8-q5h3) that the following workaround can be implemented:\n\n> Sanitize input when sending content-type headers using user input.",
    "vendorFixDate": "2022-08-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2324",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-93"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-35948",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2324/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/commit/66165d604fd0aee70a93ed5c44ad4cc2df395f80",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/releases/tag/v5.8.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/security/advisories/GHSA-f772-66g8-q5h3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/security/advisories/GHSA-f772-66g8-q5h3",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/undici/security/advisories/GHSA-f772-66g8-q5h3",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2324/default-remediation-status"
            }
        ]
    }
}