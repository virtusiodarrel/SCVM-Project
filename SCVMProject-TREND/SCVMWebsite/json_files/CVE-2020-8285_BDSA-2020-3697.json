{
    "source": "BDSA",
    "name": "BDSA-2020-3697",
    "title": "Libcurl Vulnerable to Denial-of-Service (DoS) via Stack Overflow in 'CURLOPT_WILDCARDMATCH' Component",
    "description": "Libcurl contains a stack overflow vulnerability in its FTP wildcard matching functionality (`CURLOPT_WILDCARDMATCH`) because of uncontrolled recursion. An attacker could exploit this flaw to cause a denial-of-service (DoS).",
    "technicalDescription": "This vulnerability stems from a potential stack overflow condition in the application's FTP wildcard matching functionality (`CURLOPT_WILDCARDMATCH`). This functionality allows callbacks that tell the application how to handle file entries in a directory via `CURLOPT_CHUNK_BGN_FUNCTION`. When `CURLOPT_CHUNK_BGN_FUNCTION` is set to `CURL_CHUNK_BGN_FUNC_SKIP`, the application skips the particular file entry from this callback. Also, the function which is using the wildcard matching functionality recursively calls itself to handle the next file entry in the directory. However, if this happens a lot of times, then a stack overflow condition can occur because of uncontrolled recursion. While it can be difficult for attackers to control the data that is overwritten on the stack, they can still cause a Denial-of-Service (DoS). \n\n**Note** This functionality is not used by the curl tool, so it's not affected by this vulnerability.",
    "publishedDate": "2020-12-10T11:31:18.027Z",
    "updatedDate": "2021-01-08T11:50:08.466Z",
    "disclosureDate": "2020-12-09T00:00:00.000Z",
    "solution": "Fixed in [**7.74.0**](https://github.com/curl/curl/releases/tag/curl-7_74_0) by [this](https://github.com/curl/curl/commit/69a358f2186e04cf44698b5100332cbf1ee7f01d) commit.\n\nThe latest stable releases are available [here](https://github.com/curl/curl/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "xnynx",
    "workaround": "Apart from upgrading to **v7.74.0**, the vendor has suggested the following workarounds:\n>  Disable FTP wildcard use (`CURLOPT_WILDCARDMATCH`)\n>  Make sure your `CURLOPT_CHUNK_BGN_FUNCTION` callback doesn't do multiple skips.",
    "vendorFixDate": "2020-12-07T00:00:00.000Z",
    "vendorNotifiedDate": "2020-11-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3697",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-674"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8285",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3697/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2020-8285.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2020-8285.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/0825cd80a62c21725fb3615f1fdd3aa6cc5f0f34",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/69a358f2186e04cf44698b5100332cbf1ee7f01d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/issues/6255",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_74_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3697/default-remediation-status"
            }
        ]
    }
}