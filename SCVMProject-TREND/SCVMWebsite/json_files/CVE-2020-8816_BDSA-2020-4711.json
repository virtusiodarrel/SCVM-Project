{
    "source": "BDSA",
    "name": "BDSA-2020-4711",
    "title": "Pi-Hole Vulnerable to Remote Code Execution (RCE) via Crafted DHCP Static Lease",
    "description": "Pi-Hole contains a remote code execution (RCE) vulnerability due to a lack of input validation for MAC addresses. An authenticated attacker could exploit this issue by using maliciously crafted environment variables. Successful exploitation of this issue may allow for unauthorized remote access to the web-based interface.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "Pi-Hole uses a web-based user interface to configure its built-in DHCP server, which allows users to define static DHCP leases. This issue exists within the `validMAC()` function, in the `savesettings.php` file. MAC address values which are insufficiently validated are used to build commands that will be passed to the `exec()` function. The vulnerability was mitigated by expanding the list of filtered characters and by validating environmental variables.",
    "publishedDate": "2022-01-24T10:24:31.056Z",
    "updatedDate": "2022-05-06T11:43:37.394Z",
    "disclosureDate": "2020-02-19T00:00:00.000Z",
    "exploitPublishDate": "2020-03-28T00:00:00.000Z",
    "solution": "Fixed in version [**4.3.3**](https://github.com/pi-hole/AdminLTE/releases/tag/v4.3.3) by [this](https://github.com/pi-hole/AdminLTE/commit/4f824bec7845c75c60b957f8b44d598d2e2efcc7) commit.\n\nThe latest stable releases can be found [here](https://github.com/pi-hole/AdminLTE/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.5,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "nateksec",
    "workaround": "",
    "vendorFixDate": "2020-02-18T00:00:00.000Z",
    "vendorNotifiedDate": "2020-02-10T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4711",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8816",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4711/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pi-hole/AdminLTE/commit/4f824bec7845c75c60b957f8b44d598d2e2efcc7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pi-hole/AdminLTE/releases/tag/v4.3.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pi-hole/AdminLTE/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://natedotred.wordpress.com/2020/03/28/cve-2020-8816-pi-hole-remote-code-execution/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://natedotred.wordpress.com/2020/03/28/cve-2020-8816-pi-hole-remote-code-execution/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/158737/Pi-hole-4.3.2-Remote-Code-Execution.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4711/default-remediation-status"
            }
        ]
    }
}