{
    "source": "BDSA",
    "name": "BDSA-2021-2791",
    "title": "Squashfs-Tools Vulnerable to Directory Traversal via Symbolic Link",
    "description": "Squashfs-Tools contains a directory traversal vulnerability. Successfully exploiting this could allow an attacker to write files to locations outside of the destination directory.",
    "technicalDescription": "This vulnerability exist due to insufficient checks for duplicate filenames within a directory in Squashfs. This means that a symbolic link which produces a pathname pointing outside of the destination directory can be used to write a duplicate identically named file within the directory. This could allow an attacker to use a Squashfs filesystem which contains a symbolic link pointing outside of the destination directory, paired with a file which has an identical name within the same directory, in order to cause Unsquashfs to write files outside of the destination directory.\n\nThe vendor has mitigated against this by including checks for duplicate filenames within a directory in the `squashfs-tools/unsquash-x.c` files",
    "publishedDate": "2021-09-16T09:21:31.329Z",
    "updatedDate": "2022-09-05T15:37:48.560Z",
    "disclosureDate": "2021-09-06T00:00:00.000Z",
    "solution": "Fixed in [**4.5.1**](https://github.com/plougher/squashfs-tools/releases/tag/4.5.1) by [this](https://github.com/plougher/squashfs-tools/commit/e0485802ec72996c20026da320650d8362f555bd) commit.\n\nThe latest releases are available [here](https://github.com/plougher/squashfs-tools).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.1,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-09-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2791",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41072",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2791/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plougher/squashfs-tools",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plougher/squashfs-tools/commit/e0485802ec72996c20026da320650d8362f555bd",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plougher/squashfs-tools/commit/e0485802ec72996c20026da320650d8362f555bd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plougher/squashfs-tools/issues/72#issuecomment-913833405",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plougher/squashfs-tools/releases/tag/4.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2791/default-remediation-status"
            }
        ]
    }
}