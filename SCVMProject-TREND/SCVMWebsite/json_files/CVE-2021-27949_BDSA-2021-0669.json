{
    "source": "BDSA",
    "name": "BDSA-2021-0669",
    "title": "MyBB Vulnerable to Cross-Site Scripting (XSS) via Hidden Fields in Custom Moderator Tools",
    "description": "MyBB is vulnerable to reflected cross-site scripting (XSS) due to missing sanitization of hidden form fields on custom Moderator Tools action confirmation pages. An attacker could exploit this to execute malicious scripts in the context of a victim's browser.",
    "technicalDescription": "XSS is possible in cross-site request forgery (CSRF) token-protected POST requests via parameters `action`, `modtype`, `inlinetype` and `searchid`. They were sanitized in `moderation.php` by converting values to integer and applying the `htmlspecialchars_uni()` function.",
    "publishedDate": "2021-03-16T15:06:37.700Z",
    "updatedDate": "2021-03-16T15:06:37.695Z",
    "disclosureDate": "2021-03-10T00:00:00.000Z",
    "solution": "Fixed in [**1.8.26**](https://github.com/mybb/mybb/releases/tag/mybb_1826) by [this](https://github.com/mybb/mybb/commit/bddb6943d799cf21535a90526c2735dd8e33c4b2) commit.\n\nThe latest stable releases are available [here](https://mybb.com/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.8,
        "impactSubscore": 3.7,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor notes that \"indirect controls, including the anti-CSRF token, and the SameSite Cookie Flag (enabled by default) reduce the likelihood of successful exploitation.\"",
    "vendorFixDate": "2021-03-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0669",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-27949",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0669/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mybb/mybb/commit/bddb6943d799cf21535a90526c2735dd8e33c4b2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mybb/mybb/releases/tag/mybb_1826",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mybb/mybb/security/advisories/GHSA-cmmr-39v8-8rx2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mybb/mybb/security/advisories/GHSA-cmmr-39v8-8rx2",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://mybb.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0669/default-remediation-status"
            }
        ]
    }
}