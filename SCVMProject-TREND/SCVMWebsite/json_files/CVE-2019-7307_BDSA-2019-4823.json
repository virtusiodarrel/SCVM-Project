{
    "source": "BDSA",
    "name": "BDSA-2019-4823",
    "title": "Apport Vulnerable to Information Disclosure via Race Condition in '_get_ignore_dom()' Function",
    "description": "Apport is vulnerable to information disclosure due to a race condition that exists during file parsing. A local attacker could read the contents of arbitrary files on the system by generating crash reports in a malicious manner.",
    "technicalDescription": "The function `_get_ignore_dom()`, of file `report.py`, is used to parse a XML file into a DOM tree. This XML file, `.apport-ignore.xml`, can be created by users in their home directory. The `_get_ignore_dom()` function dynamically finds this file via the user's `HOME` environment variable and the value of the `_ignore_file` variable. The function checks that the file belongs to the correct user by calling `os.access()` against the dynamically constructed path. It then proceeds to call `xml.dom.minidom.parse()` in order to actually parse the file's contents. This causes the contents of the file to be loaded into the application's heap.\n\nThis sequence of events constitutes a time-of-check-to-time-of-use (TOCTOU) flaw. If `.apport-ignore.xml` is replaced with a symlink to an arbitrary file between the calls to  `os.access()` and `xml.dom.minidom.parse()`, then the file that the symlink points to will be loaded into the process's heap instead. If the Apport process is made to crash, and a crash dump is generated by a second Apport process, then the contents of the file will be included in the crash dump. An attacker can exploit this to read the contents of arbitrary files with root privileges.",
    "publishedDate": "2020-11-23T13:12:20.512Z",
    "updatedDate": "2020-11-23T13:12:20.507Z",
    "disclosureDate": "2019-05-29T00:00:00.000Z",
    "exploitPublishDate": "2019-05-29T00:00:00.000Z",
    "solution": "* [**2.14.1-0ubuntu3.29+esm1**](https://launchpad.net/ubuntu/+source/apport)\n* [**2.20.1-0ubuntu2.19**](https://launchpad.net/ubuntu/+source/apport/2.20.1-0ubuntu2.19)\n* [**2.20.9-0ubuntu7.7**](https://launchpad.net/ubuntu/+source/apport/2.20.9-0ubuntu7.7)\n* [**2.20.10-0ubuntu27.1**](https://launchpad.net/ubuntu/+source/apport/2.20.10-0ubuntu27.1)\n* [**2.20.11-0ubuntu5**](https://launchpad.net/ubuntu/+source/apport/2.20.11-0ubuntu5)\n\nThe latest stable releases can be found [here](https://launchpad.net/ubuntu/+source/apport).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.8,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.7,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-07-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4823",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-367"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-7307",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4823/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/ubuntu/%2Bsource/apport/%2Bbug/1830858",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/ubuntu/%2Bsource/apport/%2Bbug/1830858",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/apport",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/apport/2.20.1-0ubuntu2.19",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/apport/2.20.10-0ubuntu27.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/apport/2.20.11-0ubuntu5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://launchpad.net/ubuntu/+source/apport/2.20.9-0ubuntu7.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4823/default-remediation-status"
            }
        ]
    }
}