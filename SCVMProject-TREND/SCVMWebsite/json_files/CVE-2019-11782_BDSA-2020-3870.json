{
    "source": "BDSA",
    "name": "BDSA-2020-3870",
    "title": "Odoo Vulnerable to Unauthorized Modification of User Account Information via Improper Access Controls in Portal Module",
    "description": "Odoo is vulnerable to unauthorized modification of users accounts due to improper validation of parameters within the \"Portal Access Management\" wizard. An authenticated attacker could exploit this to modify the information stored on user accounts, resulting in privilege escalation.",
    "technicalDescription": "Within the Portal module of Odoo, the \"Portal Access Management\" wizard can be used to grant `portal` access to customers and suppliers to view orders, tickets etc. Users within the `internal` group can be accidentally be assigned to this `portal` group. An attacker with contact management access can exploit this improper unauthorized access, to manipulate other users' account information. \n\nThis was addressed in `addons/portal/wizard/portal_wizard.py` .",
    "publishedDate": "2020-12-23T12:32:43.285Z",
    "updatedDate": "2020-12-23T12:32:43.278Z",
    "disclosureDate": "2020-12-22T00:00:00.000Z",
    "solution": "Fixed in:\n* [**11.0**](https://github.com/odoo/odoo/tree/11.0) branch by [this](https://github.com/odoo/odoo/commit/ec541ced9c58e9d45e4dbc331336eb16e8f1d84e) commit.\n* [**12.0**](https://github.com/odoo/odoo/tree/12.0) branch by [this](https://github.com/odoo/odoo/commit/e56c5f43a55150a7127d441a3b607097e7cec831) commit.\n* [**13.0**](https://github.com/odoo/odoo/tree/13.0) branch by [this](https://github.com/odoo/odoo/commit/c4462a44f6b2fc08beaff8049c247f7756ef045e) commit.\n* [**14.0**](https://github.com/odoo/odoo/tree/14.0) branch by [this](https://github.com/odoo/odoo/commit/c0964b3f54d2be8c8c5acda46c4203c8d18e88ab) commit.\n\nThe latest stable releases are available [here](https://www.odoo.com/page/download).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Damien LESCOS",
    "workaround": "For **14.0** only, the vendor has stated: \n\"Administrators may mitigate the problem by blocking access to the \"Portal User Config\" model (`portal.wizard.user`) to\nnon-administrators, by removing the \"Create\" and \"Write\" permissions.\"",
    "vendorFixDate": "2020-11-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3870",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11782",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3870/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/commit/c0964b3f54d2be8c8c5acda46c4203c8d18e88ab",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/commit/c4462a44f6b2fc08beaff8049c247f7756ef045e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/commit/e56c5f43a55150a7127d441a3b607097e7cec831",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/commit/ec541ced9c58e9d45e4dbc331336eb16e8f1d84e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/issues/63707",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/issues/63707",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/tree/11.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/tree/12.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/tree/13.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/odoo/odoo/tree/14.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.odoo.com/page/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3870/default-remediation-status"
            }
        ]
    }
}