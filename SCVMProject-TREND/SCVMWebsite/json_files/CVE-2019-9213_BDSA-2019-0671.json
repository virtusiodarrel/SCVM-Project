{
    "source": "BDSA",
    "name": "BDSA-2019-0671",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) via NULL Pointer Dereference in 'expand_downwards()' Function on non-SMAP Platforms",
    "description": "Linux Kernel is vulnerable to Denial-of-Service (DoS) due to a flaw in a check during virtual memory area (VMA) mapping. The current implementation does not consider that the code for the check can be reached from several different contexts and end up being erroneous in some of them. This can be abused to make NULL pointer dereferences exploitable on x86 non-SMAP systems.",
    "technicalDescription": "This flaw lies in the `expand_downwards()` function of the `/mm/mmap.c` source file. The problem is that the `security_mmap_addr()` function does an unconditional capability check with the value returned from `current_cred()` which can cause problems in some cases. The `expand_downwards()` code can also be reached from other contexts (e.g. VFS write handler) where `current_cred()` should not be used for the check.\n\nIn such scenarios comparing `current_cred()` will actually check the credentials of the task doing the `write()`, instead of the credentials of the task whose VMA is being changed.\n\nThis can be leveraged on x86 systems without supervisor mode access prevention (SMAP) to make NULL pointer dereferences exploitable again. That is to say, security vulnerabilities that were previously thought to be only a denial-of-service (DoS) may combine with this vulnerability to facilitate privilege escalation.",
    "publishedDate": "2019-03-11T14:43:48.055Z",
    "updatedDate": "2020-01-27T14:53:47.378Z",
    "disclosureDate": "2019-03-05T00:00:00.000Z",
    "exploitPublishDate": "2019-03-05T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.16.66**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c90030281dc8b6a25ac8850e98e15877f80b8d66) commit\n* [**3.18.137**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f290a73f3e919c4d5482632284ccb0aa17f7380c) commit\n* [**4.4.177**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=40952b6a649b9bfad11ae4fa2862fa0108c9ec24) commit\n* [**4.9.162**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=331fc4df776be3e5a88a1a9f08ef2f7e063ef1a9) commit\n* [**4.14.105**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f5817069248630b3b7b17ebfcdee0b679c52be33) commit\n* [**4.19.27**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=de04d2973a62e4efb3de45e93bd46acd6d510e0a) commit\n* [**4.20.14**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2938737cc23d1f77bb7acceacf85f7c2492e6793) commit\n* [**5.0**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0a1d52994d440e21def1c2174932410b4f2a98a1) commit\n* [**5.1-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=0a1d52994d440e21def1c2174932410b4f2a98a1) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn (Google Security Research)",
    "workaround": "",
    "vendorFixDate": "2019-02-27T00:00:00.000Z",
    "vendorNotifiedDate": "2019-02-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0671",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-476"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9213",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0671/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1792&desc=2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0a1d52994d440e21def1c2174932410b4f2a98a1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2938737cc23d1f77bb7acceacf85f7c2492e6793",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=331fc4df776be3e5a88a1a9f08ef2f7e063ef1a9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=de04d2973a62e4efb3de45e93bd46acd6d510e0a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f5817069248630b3b7b17ebfcdee0b679c52be33",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46502",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0671/default-remediation-status"
            }
        ]
    }
}