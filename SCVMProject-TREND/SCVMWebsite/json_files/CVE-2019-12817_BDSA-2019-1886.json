{
    "source": "BDSA",
    "name": "BDSA-2019-1886",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via Illegal Read/Write in Hash Page Table (HPT) MMU on 64-bit PowerPC",
    "description": "Linux kernel is vulnerable to denial-of-service (DoS) due to a flaw in the way its memory subsystem handles memory above 512TB on machines using 64-bit CPUs with the hash page table (HPT) MMU. A local attacker could leverage this flaw to escalate their privilege level to root.",
    "technicalDescription": "This bug can get triggered when a process allocates more than 512TB of memory, which can be done by explicitly requesting it with `mmap()` from userspace. If such process then forks, the child process will incorrectly inherit the context id of the parent associated with the mapping over 512TB. This will allow the parent/child to write to each other's mappings in the space above 512TB, and could result in memory corruption.\n\nIn another code path, if the child process exits, all of its context ids will be freed, including the one that it shares with the parent process (for mapping above 512TB). This id can then be reused by yet another process which will be able to perform arbitrary read/writes to the parent's mapping above 512TB.\n\nIf the freed id is instead used as the third process's primary context id, the original parent process will be able to perform arbitrary read/writes to its mappings below 512TB.",
    "publishedDate": "2019-06-25T13:41:00.753Z",
    "updatedDate": "2019-06-25T13:41:00.744Z",
    "disclosureDate": "2019-06-25T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.19.56**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cd3e49394cb0f45c8dbf3c17c0818cd3d30b1332) commit, and\n* [**5.1.15**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1d7446deafa4111acbbeca0ac8ae7ac4340577fa) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Michael Ellerman",
    "workaround": "",
    "vendorFixDate": "2019-06-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1886",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12817",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1886/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1d7446deafa4111acbbeca0ac8ae7ac4340577fa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cd3e49394cb0f45c8dbf3c17c0818cd3d30b1332",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q2/200",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1886/default-remediation-status"
            }
        ]
    }
}