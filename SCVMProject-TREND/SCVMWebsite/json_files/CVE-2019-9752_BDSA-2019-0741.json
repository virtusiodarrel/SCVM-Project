{
    "source": "BDSA",
    "name": "BDSA-2019-0741",
    "title": "OTRS Vulnerable to Stored Cross-Site Scripting (XSS) via 'PictureUpload' Module",
    "description": "OTRS is vulnerable to stored cross-site scripting (XSS) as it fails to reject files with incorrect content-type supplied to the `PictureUpload` module. An authenticated attacker could leverage this flaw to upload a crafted resource capable of executing arbitrary JavaScript payloads in the context of OTRS. This can be leveraged to steal a victim's session cookies.",
    "technicalDescription": "This flaw lies in the `Kernel/Modules/PictureUpload.pm` source file. The vulnerable module does not restrict the type of uploaded files to those containing proper image content. Therefore, it is possible to leverage this functionality to upload crafted files and execute arbitrary JavaScript payloads in the browsers of users who try to access it.",
    "publishedDate": "2019-03-15T15:39:14.718Z",
    "updatedDate": "2019-03-15T15:39:14.691Z",
    "disclosureDate": "2019-01-18T00:00:00.000Z",
    "solution": "Fixed in versions:\n* **7.0.4**,\n* [**6.0.16**](https://community.otrs.com/download-otrs-community-edition/) by [this](https://github.com/OTRS/otrs/commit/341c4096222819a108feb02256aba878943bf810) commit, and\n* [**5.0.34**](https://community.otrs.com/download-otrs-community-edition/) by [this](https://github.com/OTRS/otrs/commit/d4e3dfbaa054762b29df54705aa412685dd37e15) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "David Bidner",
    "workaround": "",
    "vendorFixDate": "2018-12-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0741",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9752",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0741/ranges"
            },
            {
                "rel": "reference",
                "href": "https://community.otrs.com/download-otrs-community-edition/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://community.otrs.com/security-advisory-2019-01-security-update-for-otrs-framework/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OTRS/otrs/commit/341c4096222819a108feb02256aba878943bf810",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OTRS/otrs/commit/d4e3dfbaa054762b29df54705aa412685dd37e15",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0741/default-remediation-status"
            }
        ]
    }
}