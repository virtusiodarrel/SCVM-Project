{
    "source": "BDSA",
    "name": "BDSA-2021-3114",
    "title": "passport-oauth2 Vulnerable to Authentication Bypass via Improper Error Code Handling",
    "description": "passport-oauth2 is vulnerable to authentication bypass due to the unsafe handling of an error code. A remote attacker could gain access to restricted functionality by sending maliciously crafted input to a vulnerable endpoint which will trigger the error in question.\n\nThis vulnerability can only be exploited in cases where an application grants authorization after having received an access token, and doesn't try to use that token. An OAuth identity provider that produces authentication-failure error reports based on a HTTP 200 status code is also required.\n\nIt should also be noted that the vendor does not consider this to be a passport-oauth2 vulnerability.",
    "technicalDescription": "",
    "publishedDate": "2021-10-26T17:03:31.241Z",
    "updatedDate": "2021-10-26T17:03:31.225Z",
    "disclosureDate": "2021-09-23T00:00:00.000Z",
    "solution": "Fixed in version [**1.6.1**](https://github.com/jaredhanson/passport-oauth2/releases/tag/v1.6.1) by [this](https://github.com/jaredhanson/passport-oauth2/commit/83a9409f8b4fa4983929120636a48f68a01c4f38) commit and [this](https://github.com/jaredhanson/passport-oauth2/commit/ec7298324799f879a40b9a2a58bcb4be704c37de) commit.\n\nThe latest stable releases can be found [here](https://github.com/jaredhanson/passport-oauth2/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-09-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3114",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-393"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41580",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3114/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-f794-r6xc-hf3v",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jaredhanson/passport-oauth2/commit/83a9409f8b4fa4983929120636a48f68a01c4f38",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jaredhanson/passport-oauth2/commit/ec7298324799f879a40b9a2a58bcb4be704c37de",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jaredhanson/passport-oauth2/pull/144",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jaredhanson/passport-oauth2/releases/tag/v1.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jaredhanson/passport-oauth2/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3114/default-remediation-status"
            }
        ]
    }
}