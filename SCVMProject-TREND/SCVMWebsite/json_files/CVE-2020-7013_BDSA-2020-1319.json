{
    "source": "BDSA",
    "name": "BDSA-2020-1319",
    "title": "Kibana Vulnerable to Remote Code Execution (RCE) via Prototype Pollution Attack in TSVB",
    "description": "Kibana is vulnerable to remote code execution (RCE) through the Time Series Visual Builder (TSVB) panel. An attacker can modify the prototype of an undisclosed object that may lead to the execution of code.",
    "technicalDescription": "The RCE vulnerability is in the TSVB component of Kibana.  The use of the`set` function from lodash is used with untrusted input in multiple functions called in the TSVB component. \n\nAn authenticated attacker with privileges to create TSVB visualizations can insert data that will be passed to the `set` function and pollute Object properties.  This can cause Kibana to execute arbitrary code if the property is evaluated. This will be execute on the host system with the permissions of the Kibana process.\n\nThe vulnerability has been fixed by replacing the standard lodash `set` function with a new `overwrite` function.",
    "publishedDate": "2020-06-08T15:14:58.416Z",
    "updatedDate": "2021-06-17T14:17:39.367Z",
    "disclosureDate": "2020-06-03T00:00:00.000Z",
    "solution": "Fixed in [**6.8.9**](https://github.com/elastic/kibana/releases/tag/v6.8.9) and [**7.7.0**](https://github.com/elastic/kibana/releases/tag/v7.7.0) by [this](https://github.com/elastic/kibana/commit/f287f702223d72e963bf7ea663b89868fec88e11) commit and [this](https://github.com/elastic/kibana/commit/f565266a9704d6e8067ae80c6e5e290218556f54) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.5,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor states the following mitigates this vulnerability:\n\n> Users unable to upgrade can disable TSVB by setting `metrics.enabled: false` in the `kibana.yml` file.",
    "vendorFixDate": "2020-05-13T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 5.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1319",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7013",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1319/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.elastic.co/t/elastic-stack-6-8-9-and-7-7-0-security-update/235571",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://discuss.elastic.co/t/elastic-stack-6-8-9-and-7-7-0-security-update/235571",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/commit/f287f702223d72e963bf7ea663b89868fec88e11",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/commit/f565266a9704d6e8067ae80c6e5e290218556f54",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/releases/tag/v6.8.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/releases/tag/v7.7.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1319/default-remediation-status"
            }
        ]
    }
}