{
    "source": "BDSA",
    "name": "BDSA-2021-1607",
    "title": "GLPi Vulnerable to Stored Cross-Site Scripting (XSS) via Plugins Metadata in 'setup.php' File",
    "description": "GLPi is vulnerable to stored cross-site scripting (XSS) because it does not correctly sanitize the user input before it is processed. An attacker could exploit this flaw by inserting malicious JavaScript code that can result in theft of session tokens or cookies.",
    "technicalDescription": "This vulnerability allows an attacker to insert malicious JavaScript code via metadata in `setup.php` files for different plugins. When these plugins are being installed, the information from metadata (like `author`, `plugin version`, `license`, etc.) is parsed by the application without being sanitized first. An attacker could exploit this flaw to steal session tokens or cookies. This vulnerability was fixed in `inc/marketplace/view.class.php` and `inc/plugin.class.php` files by adding sanitization measures for plugin metadata.",
    "publishedDate": "2021-05-28T11:55:56.209Z",
    "updatedDate": "2021-05-28T11:55:56.204Z",
    "disclosureDate": "2021-04-14T00:00:00.000Z",
    "exploitPublishDate": "2021-04-09T00:00:00.000Z",
    "solution": "Fixed in [**9.5.5**](https://github.com/glpi-project/glpi/releases/tag/9.5.5) by [this](https://github.com/glpi-project/glpi/commit/adface085cf5b47e18dfe6ea4fae8d2cfde7ea62) commit.\n\nThe latest stable releases are available [here](https://github.com/glpi-project/glpi/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Fernando Pinheiro",
    "workaround": "",
    "vendorFixDate": "2021-04-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1607",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3486",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1607/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/commit/adface085cf5b47e18dfe6ea4fae8d2cfde7ea62",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/releases/tag/9.5.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/security/advisories/GHSA-4xfc-4v58-wjhh",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://n3k00n3.github.io/blog/09042021/glpi_xss.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://n3k00n3.github.io/blog/09042021/glpi_xss.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1607/default-remediation-status"
            }
        ]
    }
}