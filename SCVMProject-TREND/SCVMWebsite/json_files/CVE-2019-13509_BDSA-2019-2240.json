{
    "source": "BDSA",
    "name": "BDSA-2019-2240",
    "title": "Docker Engine Vulnerable to Information Disclosure in Debug Mode",
    "description": "Docker engine writes the secrets in log files in debug mode. This allows an attacker, with log files access, to steal credentials and use them to access services that are inaccessible otherwise.",
    "technicalDescription": "The `SecretUpdate` method was added by [this](https://github.com/docker/engine/commit/77b8465d7e68ca102d7aae839c7b3fe0ecd28398) commit and it introduced this vulnerability. Since then, when `docker stack deploy` is used to deploy a stack, Docker engine will write the secrets in log files if it is running in `debug` mode. A local malicious user who has access to log files can steal the secrets and perform attacks to access services depending on the available credentials stored in the secrets.",
    "publishedDate": "2019-07-22T13:25:05.943Z",
    "updatedDate": "2019-08-29T11:34:00.113Z",
    "disclosureDate": "2019-07-17T00:00:00.000Z",
    "exploitPublishDate": "2019-07-02T00:00:00.000Z",
    "solution": "Fixed in **[18.09.8](https://github.com/docker/engine/releases/tag/v18.09.8)** by [this](https://github.com/docker/engine/commit/32b40c5366) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.7
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-07-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2240",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-13509",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2240/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/docker/engine/commit/32b40c5366",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/docker/engine/commit/32b40c5366",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/docker/engine/commit/77b8465d7e68ca102d7aae839c7b3fe0ecd28398",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/docker/engine/pull/298",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/docker/engine/releases/tag/v18.09.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2240/default-remediation-status"
            }
        ]
    }
}