{
    "source": "BDSA",
    "name": "BDSA-2022-1342",
    "title": "Webmin Vulnerable to Remote Code Execution (RCE) via Privilege Escalation in Manual User Creation",
    "description": "Webmin accepts unvalidated user input when an admin user manually creates a user account without using Virtualmin or Cloudmin. This can lead to the newly created user having elevated privileges and being able to achieve remote code execution (RCE).\n\n**Note:** This vulnerability is Authentic theme-specific.",
    "technicalDescription": "This vulnerability exists due to Webmin accepting unvalidated user input via the `file` parameter in `settings-editor_write.cgi`. When an admin user manually creates a user account without using Virtualmin or Cloudmin, then the code in `settings-editor_write.cgi` that checks `get_user_level` will just grant limited access to some modules. This can lead to the newly created user having elevated privileges and being able to achieve remote code execution (RCE).\n\nThe vendor has mitigated against this by including additional checks on the level of the newly created user to ensure correct access and permissions are granted.",
    "publishedDate": "2022-05-16T10:16:07.702Z",
    "updatedDate": "2022-06-13T13:52:55.148Z",
    "disclosureDate": "2022-05-14T00:00:00.000Z",
    "exploitPublishDate": "2022-05-14T00:00:00.000Z",
    "solution": "Fixed in [**1.993**](https://github.com/webmin/webmin/releases/tag/1.993) by [this](https://github.com/webmin/webmin/commit/6a2334bf8b27d55c7edf0b2825cd14f3f8a69d4d) commit.\n\nThe latest stable releases are available [here](https://github.com/webmin/webmin/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "esp0xdeadbeef",
    "workaround": "",
    "vendorFixDate": "2022-05-14T00:00:00.000Z",
    "vendorNotifiedDate": "2022-05-14T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1342",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-250"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-30708",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1342/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/esp0xdeadbeef/rce_webmin",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/esp0xdeadbeef/rce_webmin/blob/main/exploit.py",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webmin/webmin/commit/6a2334bf8b27d55c7edf0b2825cd14f3f8a69d4d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webmin/webmin/issues/1635",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webmin/webmin/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/webmin/webmin/releases/tag/1.993",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.twitch.tv/videos/1483029790",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1342/default-remediation-status"
            }
        ]
    }
}