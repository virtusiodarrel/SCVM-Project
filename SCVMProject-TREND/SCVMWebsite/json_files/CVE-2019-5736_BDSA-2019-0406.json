{
    "source": "BDSA",
    "name": "BDSA-2019-0406",
    "title": "RunC Vulnerable to Arbitrary Code Execution via Improper Privilege Management in '/proc/self/exe' File Descriptor",
    "description": "An improper privilege management vulnerability has been discovered in RunC. An attacker could exploit this vulnerability by utilizing a malicious container to overwrite binary contents and execute arbitrary code against the target system.\n\nRunC is used as the default runtime for containers with Docker, containerd, Podman, and CRI-O.",
    "technicalDescription": "A weakness has been discovered in RunC which can lead to arbitrary code execution. The file system descriptors implemented by the application utilizes the file `/proc/self/exe` to provide read/write access to the current processes. This can cause an issue as it can expose important container binaries which are being accessed by the host container.  A process running as root inside a guest container obtains write access of the exposed host binary which can be manipulated to gain escalated privileges. This can result in a breach of the guest container achieving full control of the host system, allowing malicious commands to be executed as root. \n\nAn attacker can exploit this vulnerability by utilizing a new container with an attacker-controlled image or an existing container in which the attacker had original write access and can be attached with docker.  The weakness is exploited by tricking RunC into executing itself. This is achieved by replacing the target binary inside the container with a custom binary that points back at the RunC binary. This allows the binary to be replaced with an executable script specifying the interpreter path `/proc/self/exe`. If the malicious script has been executed in the container, the original target of `/proc/self/exe` will be executed instead which points to the RunC binary located on the host system. This reuslts in escalated privileges and allows the attacker to try and overwrite the RunC binary on the host which can lead to attacks on other containers within the system. \n\nThe files `libcontainer/nsenter/cloned_binary.c` and `libcontainer/nsenter/nsexec.c` were added to prevent this issue by providing a cloned file with read-only access.",
    "publishedDate": "2019-02-12T16:53:44.720Z",
    "updatedDate": "2021-07-02T07:50:15.932Z",
    "disclosureDate": "2019-02-11T00:00:00.000Z",
    "exploitPublishDate": "2019-02-12T00:00:00.000Z",
    "solution": "Fixed in runc version **[1.0.0-rc7](https://github.com/opencontainers/runc/releases/tag/v1.0.0-rc7)** by the following commits:\n* [Commit 1](https://github.com/opencontainers/runc/commit/6635b4f0c6af3810594d2770f662f34ddc15b40d)\n* [Commit 2](https://github.com/opencontainers/runc/commit/0a8e4117e7f715d5fbeef398405813ce8e88558b)\n\nFixed in Docker CE version [**18.09.2**](https://github.com/docker/docker-ce/releases/tag/v18.09.2) by [this](https://github.com/docker/docker-ce/commit/e4931e664feac6fa8846f3f04268a0cc98822549) commit.\n\nFixed in lxc version **[3.2.0](https://github.com/lxc/lxc/releases/tag/lxc-3.2.0)** by [this](https://github.com/lxc/lxc/commit/6400238d08cdf1ca20d49bafb85f4e224348bf9d) commit.\n\nFixed in Apache Mesos versions [**1.4.3**](http://archive.apache.org/dist/mesos/1.4.3/), [**1.5.3**](http://archive.apache.org/dist/mesos/1.5.3/), [**1.6.2**](http://archive.apache.org/dist/mesos/1.6.2/), [**1.7.2**](http://archive.apache.org/dist/mesos/1.7.2/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.1,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:H/Au:S/C:C/I:C/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 0.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Adam Iwaniuk, Borys Pop\u0142awski",
    "workaround": "",
    "vendorFixDate": "2019-02-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0406",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-672"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5736",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0406/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/cve-2019-5736",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/vulnerabilities/runcescape",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.docker.com/2019/02/docker-security-update-cve-2018-5736-and-container-security-best-practices/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://cloud.google.com/kubernetes-engine/docs/security-bulletins#february-11-2019-runc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/docker/docker-ce/commit/e4931e664feac6fa8846f3f04268a0cc98822549",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/docker/docker-ce/releases/tag/v18.09.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/feexd/pocs/tree/master/CVE-2019-5736",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/lxc/lxc/commit/6400238d08cdf1ca20d49bafb85f4e224348bf9d",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/lxc/lxc/commit/6400238d08cdf1ca20d49bafb85f4e224348bf9d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/lxc/lxc/releases/tag/lxc-3.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencontainers/runc/commit/0a8e4117e7f715d5fbeef398405813ce8e88558b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencontainers/runc/commit/6635b4f0c6af3810594d2770f662f34ddc15b40d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/opencontainers/runc/releases/tag/v1.0.0-rc7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://kubernetes.io/blog/2019/02/11/runc-and-cve-2019-5736/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/b162dd624dc088cd634292f0402282a1d1d0ce853baeae8205bc033c@%3Cdev.mesos.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/163339/docker_runc_escape.rb.txt",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q1/119",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46359",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2019/03/23/1",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0406/default-remediation-status"
            }
        ]
    }
}