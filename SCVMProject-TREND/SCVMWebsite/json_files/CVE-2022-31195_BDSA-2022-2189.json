{
    "source": "BDSA",
    "name": "BDSA-2022-2189",
    "title": "DSpace Vulnerable to Path Traversal via Insufficient Validation in 'ItemImport ' Component",
    "description": "DSpace is vulnerable to path traversal due to the insufficient validation of destination directories which have been specified inside Simple Archive Format (SAF) files. An authenticated attacker could leverage this vulnerability in order to create files or folders within directories for which the Tomcat or DSpace users have write permissions. \n\nIt should  be noted that the attacker must possess administrator credentials, or have command line access to a vulnerable server, in order to exploit this vulnerability. Only the XMLUI, JSPUI and command-line components of a server are affected.",
    "technicalDescription": "",
    "publishedDate": "2022-08-05T15:30:23.323Z",
    "updatedDate": "2022-08-05T15:30:23.314Z",
    "disclosureDate": "2022-07-29T00:00:00.000Z",
    "solution": "Fixed in version [**6.4**](https://github.com/DSpace/DSpace/releases/tag/dspace-6.4) by [this](https://github.com/DSpace/DSpace/commit/7af52a0883a9dbc475cf3001f04ed11b24c8a4c0) commit, and in version [**5.11**](https://github.com/DSpace/DSpace/releases/tag/dspace-5.11) by [this](https://github.com/DSpace/DSpace/commit/56e76049185bbd87c994128a9d77735ad7af0199) commit.\n\nThe latest stable releases can be found [here](https://github.com/DSpace/DSpace/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated [here](https://github.com/DSpace/DSpace/security/advisories/GHSA-8rmh-55h4-93h5) that the following workaround can be implemented:\n\n> As a basic workaround, you may block all access to the following URL paths:\n> * If you are using the XMLUI, block all access to `/admin/batchimport` path (this is the URL of the Admin Batch Import tool). Keep in mind, if your site uses the path \"/xmlui\", then you'd need to block access to `/xmlui/admin/batchimport`.\n> * If you are using the JSPUI, block all access to `/dspace-admin/batchimport` path (this is the URL of the Admin Batch Import tool). Keep in mind, if your site uses the path \"/jspui\", then you'd need to block access to `/jspui/dspace-admin/batchimport`.\n> \n> Keep in mind, only an Administrative user or a user with command-line access to the server is able to import/upload SAF packages. Therefore, assuming those users do not blindly upload untrusted SAF packages, then it is unlikely your site could be impacted by this vulnerability.",
    "vendorFixDate": "2022-01-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2189",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31195",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2189/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/commit/56e76049185bbd87c994128a9d77735ad7af0199",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/commit/7af52a0883a9dbc475cf3001f04ed11b24c8a4c0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/releases/tag/dspace-5.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/releases/tag/dspace-6.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/security/advisories/GHSA-8rmh-55h4-93h5",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/security/advisories/GHSA-8rmh-55h4-93h5",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2189/default-remediation-status"
            }
        ]
    }
}