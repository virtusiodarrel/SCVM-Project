{
    "source": "BDSA",
    "name": "BDSA-2020-0986",
    "title": "Open-AudIT Vulnerable to Remote Code Execution (RCE) via 'discovery_ip_exclude' Value",
    "description": "Open-AudIT contains a remote code execution (RCE) vulnerability due to insufficient validation of user-controlled input. An authenticated attacker could exploit this vulnerability by creating a malicious excluded IP that contains arbitrary commands which would execute when the attacker initiates a new Nmap scan.",
    "technicalDescription": "The `all_ip_list` function in `code_igniter/application/helpers/discoveries_helper.php` includes the value of `exclude_ip` in an Nmap command that is later executed through the `exec` function. The `exclude_ip` value comes from the `discovery_ip_exclude` value which is controlled by the user in the configuration panel. The only validation performed on this value before being used in the command is to replace any spaces found in the value with commas. Due to this lack of validation of the data, it is possible for an attacker to include arbitrary commands in this value of the `discovery_ip_exclude` which will be executed when a new Nmap scan is performed.",
    "publishedDate": "2020-05-01T16:26:13.613Z",
    "updatedDate": "2020-08-25T15:44:22.807Z",
    "disclosureDate": "2020-04-22T00:00:00.000Z",
    "exploitPublishDate": "2020-04-22T00:00:00.000Z",
    "solution": "Fixed in [**3.3.2**](https://github.com/Opmantek/open-audit/releases/tag/Open-AudIT_3.3.2) by [this](https://github.com/Opmantek/open-audit/commit/6ffc7f9032c55eaa1c37cf5e070809b7211c7e9a) commit. \n\nThe latest stable releases are available [here](https://www.open-audit.org/downloads.php).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Askar (mhaskar)",
    "workaround": "",
    "vendorFixDate": "2020-04-24T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0986",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12078",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0986/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Opmantek/open-audit/commit/6ffc7f9032c55eaa1c37cf5e070809b7211c7e9a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Opmantek/open-audit/releases/tag/Open-AudIT_3.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://shells.systems/open-audit-v3-3-1-remote-command-execution-cve-2020-12078/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://shells.systems/open-audit-v3-3-1-remote-command-execution-cve-2020-12078/",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.open-audit.org/downloads.php",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0986/default-remediation-status"
            }
        ]
    }
}