{
    "source": "BDSA",
    "name": "BDSA-2022-1146",
    "title": "Openemr Vulnerable to Insecure Direct Object Reference via 'modId' and 'modAction' Parameters",
    "description": "Openemr contains an insecure direct object reference vulnerability because of insufficient authorization checks for the `manage` endpoint. An attacker having access to an HTTP request that changes the state of application modules could use the `modId` and `modAction` parameters to enable/disable any module on the server.",
    "technicalDescription": "Exploiting this vulnerability will require an attacker to capture an HTTP request that changes the state of modules on the server. Because of insufficient authorization checks, the attacker can use the `modId` and `modAction` parameters to directly reference any module and change its state. Since the application allows low-privileged users to change a module state, the attacker can conduct the exploit using non-admin cookies.\n\nThis vulnerability was fixed in the `registerAction()` and `manageAction()` functions, of file `interface/modules/zend_modules/module/Installer/src/Installer/Controller/InstallerController.php`, by ensuring that only the admin user can access the `manage_modules` section.",
    "publishedDate": "2022-04-27T09:15:30.236Z",
    "updatedDate": "2022-04-27T09:15:30.225Z",
    "disclosureDate": "2022-04-25T00:00:00.000Z",
    "exploitPublishDate": "2022-04-25T00:00:00.000Z",
    "solution": "Fixed in version [**6.1.0.1**](https://github.com/openemr/openemr/releases/tag/v6_1_0_1) by [this](https://github.com/openemr/openemr/commit/3af1f4a28a8df0e446043232214ed08cc8e0889d) commit.\n\nThe latest stable releases can be found [here](https://github.com/openemr/openemr/tags).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 5.1,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.1
        },
        "vector": "(AV:A/AC:L/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.5,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.1,
        "severity": "LOW",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Aden Yap Chuen Zhen, Rizan Sheikh, Ali Radzali",
    "workaround": "",
    "vendorFixDate": "2022-03-30T00:00:00.000Z",
    "vendorNotifiedDate": "2022-03-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1146",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-1461",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1146/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/commit/3af1f4a28a8df0e446043232214ed08cc8e0889d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/releases/tag/v6_1_0_1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/690a8ec5-64fc-4180-9f1f-c3c599bae0a9/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/690a8ec5-64fc-4180-9f1f-c3c599bae0a9/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1146/default-remediation-status"
            }
        ]
    }
}