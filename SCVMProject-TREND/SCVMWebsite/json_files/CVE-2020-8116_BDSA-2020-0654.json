{
    "source": "BDSA",
    "name": "BDSA-2020-0654",
    "title": "dot-prop Vulnerable to Prototype Pollution via 'dotProp.set()' Method",
    "description": "dot-prop is vulnerable to a prototype pollution flaw. A remote attacker able to supply specially crafted input to a dot-prop method could cause a denial-of-service (DoS) of the application, or affect its integrity, depending on the application code. Although unlikely, if the application uses polluted objects in conjunction with code execution primitives (such as eval), remote code execution could be possible.",
    "technicalDescription": "The `dotProp.get()` and `dotProp.set()` methods can be used to get and set the special `__proto__`, `prototype`, and `constructor`properties of objects. If an attacker is able to control input to the setter function, they could make changes to the base object by injecting properties into it. This could affect all objects and is known as prototype pollution. It could allow an attacker to affect the integrity of the application, including security logic, in numerous ways that is application dependent. Although rare, vulnerabilities like this have been used in the past to cause code execution in the end application([1](https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/paper/JavaScript_prototype_pollution_attack_in_NodeJS.pdf), [2](https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/)). This can happen when a polluted object is used in conjunction with `eval()`, command line arguments or environment variables for spawned applications.",
    "publishedDate": "2020-04-07T13:32:50.153Z",
    "updatedDate": "2022-07-19T10:20:24.207Z",
    "disclosureDate": "2020-01-28T00:00:00.000Z",
    "exploitPublishDate": "2020-01-28T00:00:00.000Z",
    "solution": "Fixed in [**5.1.1**](https://github.com/sindresorhus/dot-prop/releases/tag/v5.1.1) by [this](https://github.com/sindresorhus/dot-prop/commit/3039c8c07f6fdaa8b595ec869ae0895686a7a0f2) commit and in [**4.2.1**](https://github.com/sindresorhus/dot-prop/releases/tag/v4.2.1) by [this](https://github.com/sindresorhus/dot-prop/commit/c914124f418f55edea27928e89c94d931babe587) commit.\n\nThe latest stable releases are available [here](https://www.npmjs.com/package/dot-prop).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Aaron Costello",
    "workaround": "",
    "vendorFixDate": "2019-10-23T00:00:00.000Z",
    "vendorNotifiedDate": "2019-10-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0654",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-471"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8116",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0654/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/paper/JavaScript_prototype_pollution_attack_in_NodeJS.pdf",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sindresorhus/dot-prop/commit/3039c8c07f6fdaa8b595ec869ae0895686a7a0f2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sindresorhus/dot-prop/commit/c914124f418f55edea27928e89c94d931babe587",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sindresorhus/dot-prop/issues/63",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sindresorhus/dot-prop/releases/tag/v4.2.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sindresorhus/dot-prop/releases/tag/v5.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/719856",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/719856",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/dot-prop",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0654/default-remediation-status"
            }
        ]
    }
}