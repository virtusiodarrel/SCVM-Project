{
    "source": "BDSA",
    "name": "BDSA-2019-2079",
    "title": "Typo3 Vulnerable to Cross-Site Scripting (XSS) via URL Linker Handler Component",
    "description": "Typo3 is vulnerable to cross-site scripting (XSS) due to the insufficient validation of client-provided input. A remote attacker could execute malicious scripts within a victim's browser by tricking them into clicking on a crafted URI.",
    "technicalDescription": "Typo3 uses URI notation schemes which can be used to fetch resources. These schemes is implemented using code contained in a variety of scripts, including `UrlLinkHandler.php`, `UrlLinkHandlerTest.php` and `ContentObjectRenderer.php`. The provided URI is parsed using the function `parse_url()`, which can detect the scheme being used. Although the scheme is determined, there is no functionality to ensure that unsafe schemes (such as JavaScript) are rejected. An attacker could therefore execute malicious scripts within the browser of a victim by tricking them into clicking on a crafted link that contains an XSS payload and which uses a relevant unsafe scheme.",
    "publishedDate": "2019-07-11T14:44:19.522Z",
    "updatedDate": "2019-07-11T14:44:19.508Z",
    "disclosureDate": "2019-06-25T00:00:00.000Z",
    "exploitPublishDate": "2019-06-25T00:00:00.000Z",
    "solution": "Fixed in version [**9.5.8**](https://git.typo3.org/Packages/TYPO3.CMS.git/commit/16a8bcabe4d8a33a2bc8556b440ed92af0ee508b) by [this](https://git.typo3.org/Packages/TYPO3.CMS.git/commit/6dcbf981f89bed5826e3e284e0441d8e3a50bae6) commit.\n\nFixed in version [**8.7.27**](https://git.typo3.org/Packages/TYPO3.CMS.git/commit/96105753aa6a61397ea47dc6fbe23f1f994fe32e) by [this](https://git.typo3.org/Packages/TYPO3.CMS.git/commit/96105753aa6a61397ea47dc6fbe23f1f994fe32e) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Robin Peraglie",
    "workaround": "",
    "vendorFixDate": "2019-06-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2079",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12748",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2079/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.typo3.org/Packages/TYPO3.CMS.git/commit/16a8bcabe4d8a33a2bc8556b440ed92af0ee508b",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.typo3.org/Packages/TYPO3.CMS.git/commit/6dcbf981f89bed5826e3e284e0441d8e3a50bae6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.typo3.org/Packages/TYPO3.CMS.git/commit/96105753aa6a61397ea47dc6fbe23f1f994fe32e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.typo3.org/Packages/TYPO3.CMS.git/commit/96105753aa6a61397ea47dc6fbe23f1f994fe32e",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-core-sa-2019-015/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://typo3.org/security/advisory/typo3-core-sa-2019-015/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2079/default-remediation-status"
            }
        ]
    }
}