{
    "source": "BDSA",
    "name": "BDSA-2021-0085",
    "title": "Python Vulnerable to Denial-of-Service (DoS) via Buffer Overflow Caused by Large Floating Point Numbers",
    "description": "Python is vulnerable to denial-of-service (DoS) due to a buffer overflow caused by large floating point numbers. An attacker that could provide an arbitrary float number to the python application could cause it to crash and  in highly specialized circumstances, potentially achieve code execution.",
    "technicalDescription": "The buffer overflow occurs in the `PyCArg_repr()` function in `_ctypes/callproc.c`. There is no length check in the statement `sprintf(buffer, \"<cparam '%c' (%f)>\", self->tag, self->value.d);`. This means that if `self->value.d` is large enough it could overflow the `buffer` and crash the application.\n\nThis vulnerability has been triggered ([report](https://www.randori.com/blog/cve-2021-3177-vulnerability-analysis/)) to demonstrate code execution in an extremely contrived environment, with the conclusion that it is highly unlikely that there are real world applications that are vulnerable. Where the vulnerability is reachable within applications, DoS is the more likely outcome of any successful exploitation.",
    "publishedDate": "2021-01-19T11:36:48.559Z",
    "updatedDate": "2021-11-05T10:53:40.441Z",
    "disclosureDate": "2021-01-16T00:00:00.000Z",
    "exploitPublishDate": "2021-01-16T00:00:00.000Z",
    "solution": "Fixed in:\n* **[3.6.13](https://github.com/python/cpython/releases/tag/v3.6.13)** by [this](https://github.com/python/cpython/commit/34df10a9a1) commit\n* **[3.7.10](https://github.com/python/cpython/releases/tag/v3.7.10)** by [this](https://github.com/python/cpython/commit/d9b8f138b7) commit\n* **[3.8.8-rc1](https://github.com/python/cpython/releases/tag/v3.8.8rc1)** by [this](https://github.com/python/cpython/commit/ece5dfd403) commit\n* **[3.9.2-rc1](https://github.com/python/cpython/releases/tag/v3.9.2rc1)** by [this](https://github.com/python/cpython/commit/c347cbe694) commit\n* **[3.10.0-a5](https://github.com/python/cpython/releases/tag/v3.10.0a5)** by [this](https://github.com/python/cpython/commit/916610ef90) commit\n\nThe latest stable releases are available [here](https://www.python.org/downloads/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jordy Zomer",
    "workaround": "",
    "vendorFixDate": "2021-01-18T00:00:00.000Z",
    "vendorNotifiedDate": "2021-01-16T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0085",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-120"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3177",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0085/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue42938",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue42938",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/34df10a9a1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/916610ef90",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/c347cbe694",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/d9b8f138b7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/ece5dfd403",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.10.0a5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.6.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.7.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.8.8rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.9.2rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1084342",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.python.org/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.randori.com/blog/cve-2021-3177-vulnerability-analysis/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0085/default-remediation-status"
            }
        ]
    }
}