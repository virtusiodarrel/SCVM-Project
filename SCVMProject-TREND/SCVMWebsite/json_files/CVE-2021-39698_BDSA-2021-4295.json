{
    "source": "BDSA",
    "name": "BDSA-2021-4295",
    "title": "Linux Kernel File Polling Functionality Vulnerable to Privilege Escalation and Denial-of-Service (DoS) via Use-After-Free (UAF)",
    "description": "The Linux Kernel is vulnerable to privilege escalation and denial-of-service (DoS) issues due to the presence of a use-after-free (UAF) flaw in the file polling functionality.\n\nA local attacker with no additional execution privileges could abuse this flaw in order to escalate privileges, or cause instability which could result in a crash.",
    "technicalDescription": "The Linux Kernel is vulnerable to privilege escalation and denial-of-service (DoS) issues because the `aio_poll_complete_work()` function of the `aio.c` file is missing `POLLFREE` handling which can cause a use-after-free (UAF) flaw to occur that can trigger memory corruption.",
    "publishedDate": "2022-04-04T11:55:18.749Z",
    "updatedDate": "2022-04-04T11:55:18.731Z",
    "disclosureDate": "2021-12-08T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.295**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.4.295) by the following commits:\n\t* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d0ceebaae0e406263b83462701b5645e075c1467)\n\t* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=012a74119641e78a49f9a25c6c27f7a3bf4272e1)\n\t* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2c14047715e0eadee4298bf8e0cc3ca99ef084ff)\n\n\n* [**4.9.293**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.9.293) by the following commits:\n\t* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0e92a7e47a0411d5208990c83a3d200515e314e8)\n\t* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0487ea896e62b5a90a81ac6e73c35e595d77f499)\n\t* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5ecb4e93d70a21f3b7094029986ef0c3e321f56c)\n\n\n* [**4.14.258**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.14.258) by the following commits:\n\t* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a36e1978c6cb6282fadd5d62d4b3e7808cf0597b)\n\t* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7bfd8e1fd8d2a4c5df1ae67d2ee3481b8f53904c)\n\t* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c1574af60c4aef85fc05c17458653fc04cd20ff7)\n\n\n* [**4.19.221**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.19.221) by the following commits:\n\t* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8dd7c46a59756bdc29cb9783338b899cd3fb4b83)\n\t* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=32288f504035b6c359cc33ee615f74f14be2e38a)\n\t* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f226fdd855b7d9c1f2a6e878d82eb3e1fbc880e9)\n\t* [Commit 4](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=580c7e023303ce3a187adcaa40868bfc740725d2)\n\t* [Commit 5](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=321fba81ec034f88aea4898993c1bf15605c023f)\n\n\n* [**5.4.165**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.4.165) by the following commits:\n\t* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e0c03d15cd03476dd698c1ae7fb32a16d3e87f5c)\n\t* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1a478a0522e5618480ee298e886eed18dcac1459)\n\t* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=aac8151624b6376e42b2c60410fe7e3aba3a3d1b)\n\t* [Commit 4](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=380185111fa881fa68382ecf7328c608212218dd)\n\t* [Commit 5](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4105e6a128e8a98455dfc9e6dbb2ab0c33c4497f)\n\n\n* [**5.10.85**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.10.85) by the following commits:\n\t* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8e04c8397bf98235b1aa41153717de7a05e652a2)\n\t* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9f3acee7eac8d8690134b09ba55e2c12164d24ae)\n\t* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fc2f636ffc446d8e9530e441897f877922269051)\n\t* [Commit 4](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e4d19740bccab792f16c7ca6fd1f9aea06193cb2)\n\t* [Commit 5](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=47ffefd88abfffe8a040bcc1dd0554d4ea6f7689)\n\n\n* [**5.15.8**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.15.8) by the following commits:\n\t* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1ebb6cd8c754bfe1a5f9539027980756bce7cb08)\n\t* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f12d997683a7a97e7af834d3181fad61ad67df47)\n\t* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8d6760fd5d1604df29dd7651033167ef99a7698d)\n\t* [Commit 4](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=924f51534d428e91c98ea309ab16270f5e8289c6) \n\t* [Commit 5](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=60d311f9e6381d779d7d53371f87285698ecee24) \n\n\n* [**5.16-rc5**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.16-rc5) by the following commits:\n\t* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=42288cb44c4b5fff7653bc392b583a2b8bd6a8c0)\n\t* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a880b28a71e39013e357fd3adccd1d8a31bc69a8)\n\t* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9537bae0da1f8d1e2361ab6d0479e8af7824e160)\n\t* [Commit 4](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=363bee27e25804d8981dd1c025b4ad49dc39c530)\n\t* [Commit 5](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=50252e4b5e989ce64555c7aef7516bdefc2fea72)\n\nThe latest stable releases are available [here](https://www.kernel.org/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.5,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-12-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4295",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39698",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4295/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2063228",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=012a74119641e78a49f9a25c6c27f7a3bf4272e1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0487ea896e62b5a90a81ac6e73c35e595d77f499",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0e92a7e47a0411d5208990c83a3d200515e314e8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1a478a0522e5618480ee298e886eed18dcac1459",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1ebb6cd8c754bfe1a5f9539027980756bce7cb08",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2c14047715e0eadee4298bf8e0cc3ca99ef084ff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=321fba81ec034f88aea4898993c1bf15605c023f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=32288f504035b6c359cc33ee615f74f14be2e38a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=363bee27e25804d8981dd1c025b4ad49dc39c530",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=380185111fa881fa68382ecf7328c608212218dd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4105e6a128e8a98455dfc9e6dbb2ab0c33c4497f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=42288cb44c4b5fff7653bc392b583a2b8bd6a8c0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=47ffefd88abfffe8a040bcc1dd0554d4ea6f7689",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=50252e4b5e989ce64555c7aef7516bdefc2fea72",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=580c7e023303ce3a187adcaa40868bfc740725d2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5ecb4e93d70a21f3b7094029986ef0c3e321f56c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=60d311f9e6381d779d7d53371f87285698ecee24",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7bfd8e1fd8d2a4c5df1ae67d2ee3481b8f53904c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8d6760fd5d1604df29dd7651033167ef99a7698d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8dd7c46a59756bdc29cb9783338b899cd3fb4b83",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8e04c8397bf98235b1aa41153717de7a05e652a2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=924f51534d428e91c98ea309ab16270f5e8289c6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9537bae0da1f8d1e2361ab6d0479e8af7824e160",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9f3acee7eac8d8690134b09ba55e2c12164d24ae",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a36e1978c6cb6282fadd5d62d4b3e7808cf0597b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a880b28a71e39013e357fd3adccd1d8a31bc69a8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=aac8151624b6376e42b2c60410fe7e3aba3a3d1b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c1574af60c4aef85fc05c17458653fc04cd20ff7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d0ceebaae0e406263b83462701b5645e075c1467",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e0c03d15cd03476dd698c1ae7fb32a16d3e87f5c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e4d19740bccab792f16c7ca6fd1f9aea06193cb2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f12d997683a7a97e7af834d3181fad61ad67df47",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f226fdd855b7d9c1f2a6e878d82eb3e1fbc880e9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fc2f636ffc446d8e9530e441897f877922269051",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.14.258",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.19.221",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.4.295",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.9.293",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.10.85",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.15.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.16-rc5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.4.165",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/all/20211209010455.42744-1-ebiggers@kernel.org/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://source.android.com/security/bulletin/2022-03-01",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4295/default-remediation-status"
            }
        ]
    }
}