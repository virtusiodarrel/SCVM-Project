{
    "source": "BDSA",
    "name": "BDSA-2022-1842",
    "title": "MediaWiki Vulnerable to Cross-Site Scripting (XSS) via Username Reflected in Welcome Message",
    "description": "MediaWiki does not properly sanitize a username in the welcome message for new users. A remote attacker who can sign up a user to a new account and trick them into verifying the new account, could cause the execution of arbitrary JavaScript code in the victims browser. Such code could cause the theft of site site information or perform site actions with the new users permissions.",
    "technicalDescription": "The `welcomeuser` message passed to `showSuccessPage()` is not escaped when HTML elements are allowed in the user name (not a default option). `SpecialCreateAccount::successfulAction()` calls `::showSuccessPage()` with a message as second parameter, and `OutputPage::setPageTitle()` uses `text()` which does not escape the username.",
    "publishedDate": "2022-07-04T15:39:27.108Z",
    "updatedDate": "2022-07-04T15:39:27.094Z",
    "disclosureDate": "2022-05-16T00:00:00.000Z",
    "solution": "Fixed in\n* **[1.35.7](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/+/refs/tags/1.35.7)** by [this](https://gerrit.wikimedia.org/g/mediawiki/core/+/6243547b7b4118da60369dfdd25e616731eb5730) commit,\n* **[1.37.3](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/+/refs/tags/1.37.3)** by [this](https://gerrit.wikimedia.org/g/mediawiki/core/+/57f87396667643d66f6a19391596d8ab4d660fd8) commit,\n* **[1.38.2](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/+/refs/tags/1.38.2)** by [this](https://gerrit.wikimedia.org/g/mediawiki/core/+/28030ffa2b9d528a8d226ba59c9bce299f241e9b) commit.\n\nThe latest releases can be found [here](https://www.mediawiki.org/wiki/Download).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Daimona Eaytoy",
    "workaround": "",
    "vendorFixDate": "2022-06-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1842",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-34911",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1842/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/g/mediawiki/core/+/28030ffa2b9d528a8d226ba59c9bce299f241e9b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/g/mediawiki/core/+/57f87396667643d66f6a19391596d8ab4d660fd8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/g/mediawiki/core/+/6243547b7b4118da60369dfdd25e616731eb5730",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/+/refs/tags/1.35.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/+/refs/tags/1.37.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/+/refs/tags/1.38.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://phabricator.wikimedia.org/T308471",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mediawiki.org/wiki/Download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1842/default-remediation-status"
            }
        ]
    }
}