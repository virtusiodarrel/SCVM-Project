{
    "source": "BDSA",
    "name": "BDSA-2019-1804",
    "title": "MyBB Vulnerable to Stored Cross-site Scripting (XSS) via Improper Input Validation in 'Nested BBCode' Messages",
    "description": "A stored cross-site scripting (XSS) vulnerability has been discovered in MyBB. An attacker could exploit this vulnerability via a distributed link to execute malicious scripts on a victim's browser.",
    "technicalDescription": "A weakness has been discovered in MyBB which can be manipulated to launch cross-site scripting (XSS) attacks. The edit post functionality utilizes a rendered markup language called `BBCodes` to provide embedded media into forum messages.  The functionality implemented in the file `editpost.php` utilizes parameters `$message`, `$subject`, `$previewmessage`, and `$previewsubject` which can contain user-supplied input. These inputs are not sanitized against malicious characters allowing the message validation to be escaped. \n\nThe `mycode_parse_video` function located in the file `inc/class_parser.php` can cause injected `BBCode` to bypass regex validation by URL encoding the `$parsed_url` parameter value.\n\nAn attacker could exploit this vulnerability by embedding crafted links into public forum posts or via private messages to trick unsuspecting victim's into executing malicious scripts on their browsers.",
    "publishedDate": "2019-06-18T09:44:19.507Z",
    "updatedDate": "2019-06-18T09:44:33.229Z",
    "disclosureDate": "2019-06-10T00:00:00.000Z",
    "exploitPublishDate": "2019-06-11T00:00:00.000Z",
    "solution": "Fixed in version [**1.8.21**](https://github.com/mybb/mybb/releases/tag/mybb_1821) by [this](https://github.com/mybb/mybb/commit/44fc01f723b122be1bc8daaca324e29b690901d6) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.3,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.7,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Simon Scannell and Robin Peraglie of RIPS Technologies",
    "workaround": "",
    "vendorFixDate": "2019-06-10T00:00:00.000Z",
    "vendorNotifiedDate": "2019-04-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1804",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12830",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1804/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.mybb.com/2019/06/10/mybb-1-8-21-released-security-maintenance-release/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.ripstech.com/2019/mybb-stored-xss-to-rce/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mybb/mybb/commit/44fc01f723b122be1bc8daaca324e29b690901d6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mybb/mybb/releases/tag/mybb_1821",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1804/default-remediation-status"
            }
        ]
    }
}