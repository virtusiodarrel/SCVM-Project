{
    "source": "BDSA",
    "name": "BDSA-2020-2626",
    "title": "PHP Vulnerable to Incorrect Encryption via 'openssl_encrypt()' Function in AES-CCM Mode",
    "description": "PHP is vulnerable to incorrect encryption via the `openssl_encrypt()` function in AES-CCM mode. \nThis issue may have no or serious security implications depending on the implementation details.",
    "technicalDescription": "The Advanced Encryption Standard-Counter with Cipher Block Chaining-Message Authentication Code (AES-CCM) specification states that the IV should consist of a nonce and a counter. The counter is incremented with each block and ensures that different IVs are used within the same message. As nonce a random nonce for each message is generated or alternatively a random nonce that is incremented for each further message This ensures that different IVs are also used across different messages. \n\nA 12 bytes nonce that is incremented is converted by this issue into a 7 byte nonce in which the last 5 bytes are truncated so that the nonce is identical for the first 2^40 (different) messages. For those messages the i-th block of each message would be encrypted using the same key/IV pair. This violates the AES-CCM specification which dictates that no key/IV pair may be used more than once. The reuse of an AES-CCM or AES-GCM nonce/key combination destroys the security guarantees it affords.",
    "publishedDate": "2020-10-05T16:26:13.258Z",
    "updatedDate": "2020-10-05T16:26:13.245Z",
    "disclosureDate": "2020-05-15T00:00:00.000Z",
    "exploitPublishDate": "2020-05-15T00:00:00.000Z",
    "solution": "Fixed in:\n* [**7.2.34**](https://github.com/php/php-src/releases/tag/php-7.2.34) by [this](https://github.com/php/php-src/commit/a9e4321846dcba0eade116c1d9abc388df8100fc) commit. \n* [**7.3.23**](https://github.com/php/php-src/releases/tag/php-7.3.23) by [this](https://github.com/php/php-src/commit/c4dc080245006e011a484ca609b9d4eaa6cc4963) commit. \n* [**7.4.11**](https://github.com/php/php-src/releases/tag/php-7.4.11) by [this](https://github.com/php/php-src/commit/e14f835d8c4d8f595cc085f7ffae7ea07ae4e745) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "bizxing",
    "workaround": "",
    "vendorFixDate": "2020-09-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2626",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-310"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7069",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2626/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=79601",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.php.net/bug.php?id=79601",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/a9e4321846dcba0eade116c1d9abc388df8100fc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/c4dc080245006e011a484ca609b9d4eaa6cc4963",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/commit/e14f835d8c4d8f595cc085f7ffae7ea07ae4e745",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.2.34",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.3.23",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/php/php-src/releases/tag/php-7.4.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2626/default-remediation-status"
            }
        ]
    }
}