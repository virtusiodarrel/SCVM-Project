{
    "source": "BDSA",
    "name": "BDSA-2020-1687",
    "title": "Socket.io-file Vulnerable to Path Traversal via Insufficient Input Validation in File Upload Functionality",
    "description": "Socket.io-file is vulnerable to path traversal due to a lack of proper input validation on the file name for user uploaded files.\n\nAn attacker could upload a file with a crafted file name in order to write to unintended locations and potentially sensitive directories.",
    "technicalDescription": "Socket.io-file is vulnerable to path traversal because the file upload functionality, present in the default configuration of Socket.io-file, does not sufficiently validate parameters supplied in file upload requests.\n\nTo complete a file upload request, upload directories and file names are combined into one string:\n* In `index.js` prior to **2.0.x**, the `uploadDir` and `fileName` values are combined when calling the  `fs.open()` method.\n* In `index.js` from **2.0.x** onward, the `uploadDir` and `filename` values are merged with the `path.join` method.\n\nIn both cases, there is a lack of validation which means an attacker could alter the file name to include relative paths which allowing them to upload files to arbitrary or potentially sensitive directories on the server depending on the back-end system privileges.",
    "publishedDate": "2020-07-23T08:28:16.972Z",
    "updatedDate": "2021-07-29T09:39:21.172Z",
    "disclosureDate": "2020-05-18T00:00:00.000Z",
    "exploitPublishDate": "2020-05-18T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNCORROBORATED",
            "score": 4.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:POC/RL:U/RC:UR)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "REASONABLE",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N/E:P/RL:U/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Thomas Sermpinis",
    "workaround": "",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1687",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15779",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1687/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.auxiliumcybersec.com/?p=2586",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.auxiliumcybersec.com/?p=2586",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-9h4g-27m8-qjrg",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rico345100/socket.io-file/issues/34",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/advisories/1519",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1687/default-remediation-status"
            }
        ]
    }
}