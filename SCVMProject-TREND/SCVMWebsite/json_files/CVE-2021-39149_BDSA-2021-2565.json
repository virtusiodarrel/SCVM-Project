{
    "source": "BDSA",
    "name": "BDSA-2021-2565",
    "title": "XStream Vulnerable to Remote Code Execution (RCE) via Unsafe 'CompositeInvocationHandlerImpl' Class Deserialization",
    "description": "XStream is vulnerable to remote code execution (RCE) due to the unsafe demarshalling of CORBA and XSLTC classes. A remote attacker could execute arbitrary code on a vulnerable server by causing that server to deserialize a maliciously crafted serialized object.",
    "technicalDescription": "The class `com.sun.corba.se.spi.orbutil.proxy.CompositeInvocationHandlerImpl` contains the `defaultHandler` attribute, which is an `InvocationHandler` instance. This allows an instance of `CompositeInvocationHandlerImpl` to wrap classes from the `sun.tracing` package, such as `sun.tracing.NullProvider`. \n\nThis can in turn wrap an instance of `sun.tracing.dtrace.DTraceProbe`, which has the `proxy` attribute. The `proxy` member of a `DTraceProbe` object can be an instance of `com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl`. The  `_bytecodes` attribute of this class specifies the definition of an XSLTC translet class, which can be instantiated by the application into `Transformer` objects that can be used to process XML documents. A crafted translet class could be specified within the serialized payload that, when instantiated, will cause malicious code to be executed on the server.\n\nIf a server uses XStream in order to deserialize untrusted input, then a remote attacker could send serialized input which contains the aforementioned classes to that server in order to achieve remote code execution. These classes must be present within the class path of the application in order for the attack to succeed.\n\nThe vulnerability was fixed by the implementation of a whitelisting approach. Classes which are not included in the whitelist will not be deserialized by XStream.",
    "publishedDate": "2021-08-24T15:42:34.248Z",
    "updatedDate": "2021-08-25T18:21:08.242Z",
    "disclosureDate": "2021-08-22T00:00:00.000Z",
    "exploitPublishDate": "2021-08-22T00:00:00.000Z",
    "solution": "Fixed in version [**1.4.18**](https://github.com/x-stream/xstream/releases/tag/XSTREAM_1_4_18) by [this](https://github.com/x-stream/xstream/commit/652d72f38b33938c54fd3b2ef626cb7dce38001c) commit.\n\nThe latest stable releases can be found [here](https://github.com/x-stream/xstream/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Lai Han (NSFOCUS Security Team)",
    "workaround": "Users can manually prevent the deserialization of problematic classes by following the [guidance](https://x-stream.github.io/security.html#workaround) provided by the vendor.",
    "vendorFixDate": "2021-05-26T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2565",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39149",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2565/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/commit/652d72f38b33938c54fd3b2ef626cb7dce38001c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/releases/tag/XSTREAM_1_4_18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/security/advisories/GHSA-3ccq-5vw3-2p6x",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/CVE-2021-39149.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/CVE-2021-39149.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/security.html#workaround",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2565/default-remediation-status"
            }
        ]
    }
}