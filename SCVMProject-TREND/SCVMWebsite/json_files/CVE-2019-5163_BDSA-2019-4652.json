{
    "source": "BDSA",
    "name": "BDSA-2019-4652",
    "title": "Shadowsocks-Libev Vulnerable to Denial-of-Service via 'UDPRelay' Module",
    "description": "Shadowsocks-Libev contains a vulnerability which allows the server (`ss-server`) to be spammed with arbitrary UDP packets and cause a crash. An attacker can exploit this flaw to cause a denial-of-service.",
    "technicalDescription": "This vulnerability exists in multiple files which are relevant to the `UDPRelay` module. However, the following three conditions need to be met in order for this to be exploited:\n1. The server (`ss-server`) must be using a stream cipher. \n2. The user must be using the `UDPRelay` functionality.\n3. Either the server (`ss-server`) must be running with the switch `-b ip_address` or the `local_address` field must be properly set in the server configuration.\n\nUsually, `ss-local` (which runs at the user's end) encrypts the traffic and sends it over to `ss-server` (which listens for connections). The traffic is then decrypted by `ss-server` and sent to the specified destination (which could be an IPv4/IPv6 address or a hostname). If a stream cipher is being used, an attacker can send arbitrary traffic to `ss-server` which will attempt to decrypt it and send it further. This can happen because stream ciphers do not provide authentication services. When the aforementioned conditions are met, an attacker can spam `ss-server` with arbitrary UDP traffic. After a sufficient number of attempts which result in an `ERROR` condition, the server will eventually crash because of the code at line 380 in `udprelay.c`. This vulnerability results because IPv6 local addresses are not initialized properly while binding IPv6 sockets. An attacker can exploit this vulnerability to cause a denial-of-service.",
    "publishedDate": "2020-09-11T14:07:14.492Z",
    "updatedDate": "2020-09-11T14:07:14.487Z",
    "disclosureDate": "2019-12-03T00:00:00.000Z",
    "exploitPublishDate": "2019-12-03T00:00:00.000Z",
    "solution": "Fixed in [**3.3.4**](https://github.com/shadowsocks/shadowsocks-libev/releases/tag/v3.3.4) by [this](https://github.com/shadowsocks/shadowsocks-libev/commit/1ba753adaad5454eabf2315fc3a40b82ea732bfa) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-11-08T00:00:00.000Z",
    "vendorNotifiedDate": "2019-11-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4652",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-306"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-617"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5163",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4652/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shadowsocks/shadowsocks-libev/commit/1ba753adaad5454eabf2315fc3a40b82ea732bfa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shadowsocks/shadowsocks-libev/issues/2536",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shadowsocks/shadowsocks-libev/releases/tag/v3.3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2019-0956",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2019-0956",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4652/default-remediation-status"
            }
        ]
    }
}