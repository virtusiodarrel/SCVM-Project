{
    "source": "BDSA",
    "name": "BDSA-2021-1992",
    "title": "Node.js Vulnerable to Code Execution and Privilege Escalation via PATH and DLL Hijacking.",
    "description": "Node.js contains a privilege escalation vulnerability. A local unprivileged attacker could take advantage of this to perform PATH and DLL hijacking attacks and run a malicious executable on a users account with local system permissions, or to load a number of malicious DLLs.\n\n**Note:** This vulnerability only exists on Windows platforms.",
    "technicalDescription": "This vulnerability exists due to improper configuration of permissions in the installation directory, it inherits its permissions from the drive root and is configured with `BUILTIN\\Users Allow *` which allows any local user the ability to create arbitrary files in the installation directory. This unprotected installation directory is also added to the `PATH` variable, which can allow an attacker to include malicious executables with a `.exe` extension in that directory, for example `npm.exe`. When a victim tries running a program with the same name as the malicious executable, for example `npm` Windows will search for a program with the `.exe` extension first, which will result in the malicious executables being run with system privileges, allowing the attacker to achieve local code execution.\nIn addition to this, the improper configuration of permissions in the installation directory also allows for an attacker to perform a DLL hijacking attack and load a number of malicious DLLs from the unprotected folder.\n\nThe vendor has mitigated against this by explicitly setting permission for Windows install directory in the `tools/msvs/msi/product.wxs` file of Node.js.",
    "publishedDate": "2021-07-02T11:46:18.768Z",
    "updatedDate": "2021-07-02T11:46:18.763Z",
    "disclosureDate": "2021-07-01T00:00:00.000Z",
    "exploitPublishDate": "2021-07-01T00:00:00.000Z",
    "solution": "Fixed in:\n* [**16.4.1**](https://github.com/nodejs/node/releases/tag/v16.4.1) by [this](https://github.com/nodejs/node/commit/c6b08f1d04bb3dd0db8e08e261293e4095934f47) commit,\n* [**14.17.2**](https://github.com/nodejs/node/releases/tag/v14.17.2) by [this](https://github.com/nodejs/node/commit/d0b449da1dc405fbb1fa7a217f1934d6a52ba580) commit,\n* [**12.22.2**](https://github.com/nodejs/node/releases/tag/v12.22.2) by [this](https://github.com/nodejs/node/commit/a52790cba097d20c246645827397ffc19fc2e7d9) commit.\n\nThe latest stable releases are available [here](https://nodejs.org/en/download/)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.4,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Robert Chen",
    "workaround": "",
    "vendorFixDate": "2021-06-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1992",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22921",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1992/ranges"
            },
            {
                "rel": "reference",
                "href": "https://deepsurface.com/deepsurface-security-advisory-local-privilege-escalation-in-erlang-on-windows-cve-2021-29221/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/commit/a52790cba097d20c246645827397ffc19fc2e7d9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/commit/c6b08f1d04bb3dd0db8e08e261293e4095934f47",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/commit/d0b449da1dc405fbb1fa7a217f1934d6a52ba580",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/releases/tag/v12.22.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/releases/tag/v14.17.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nodejs/node/releases/tag/v16.4.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1211160",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1211160",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://nodejs.org/en/blog/vulnerability/july-2021-security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://nodejs.org/en/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1992/default-remediation-status"
            }
        ]
    }
}