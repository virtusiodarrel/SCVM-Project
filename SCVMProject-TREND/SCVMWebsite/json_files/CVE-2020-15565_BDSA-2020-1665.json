{
    "source": "BDSA",
    "name": "BDSA-2020-1665",
    "title": "Xen Vulnerable to Denial-of-Service (DoS) and Privilege Escalation via Shared Page Tables",
    "description": "Xen is vulnerable to a denial-of-service (DoS) and possible privilege escalation.  This vulnerability allows a malicious guest to read and write to memory that the guest should not have access to.  This can result in memory corruption or possible write to memory used by other guests.",
    "technicalDescription": "The DoS can occur when page tables are shared between IOMMU and CPU, specifically when Xen splits large page mappings into smaller granularity ones. Translation Lookaside Buffers (TLB) for IOMMU and CPU should be flushed and cached data needs written back to memory in such circumstances,  Xen does not perform this sufficiently.  \n\nThis can lead to guests having direct memory access (DMA) with potentially both read and write capabilities to frames returned to Xen's free pool.  This may cause memory corruption, resulting in a host crash, or possible allow a guest to perform privilege escalation.\n\n**Note:** This only affects x86 Intel based systems. ARM and x86 AMD based systems are not affected.\nThe vendor states: \"Only x86 HVM guests using hardware assisted paging (HAP), having a passed through PCI device assigned, and having page table sharing enabled can leverage the vulnerability. Page table sharing will be enabled (by default) only if Xen considers IOMMU and CPU large page size support compatible.\"",
    "publishedDate": "2020-07-15T15:16:16.335Z",
    "updatedDate": "2020-10-01T10:06:26.276Z",
    "disclosureDate": "2020-07-07T00:00:00.000Z",
    "solution": "Fixed on branches:\n\n* [**stable-4.9**](http://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.9) \n* [**stable-4.10**](http://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.10) \n* [**stable-4.11**](http://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.11)\n* [**stable-4.12**](http://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.12)\n* [**stable-4.13**](http://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.13) \n* [**stable-4.14**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.14)\n\nFixed in [**4.14.0-rc6**](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ce3c4493e4e6c94495ddd8538e801a35980bff0d) by these commits:\n\n* [Commit 1](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=c23274fd0412381bd75068ebc9f8f8c90a4be748)\n* [Commit 2](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=a64ea16522a73a13a0d66cfa4b66a9d3b95dd9d6)\n* [Commit 3](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=23570bce00ee6ba2139ece978ab6f03ff166e21d)\n* [Commit 4](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b6d9398144f21718d25daaf8d72669a75592abc5)\n* [Commit 5](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=91526b460e5009fc56edbd6809e66c327281faba)\n* [Commit 6](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=62298825b9a44f45761acbd758138b5ba059ebd1)\n* [Commit 7](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=5fe515a0fede07543f2a3b049167b1fd8b873caf)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.3,
        "impactSubscore": 8.5,
        "exploitabilitySubscore": 4.4,
        "severity": "MEDIUM",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:A/AC:M/Au:S/C:P/I:P/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 5.3,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Roger Pau Monn\u00e9",
    "workaround": "The vendor suggests the following to mitigate this vulnerability:\n\n* \"Suppressing the use of page table sharing will avoid the vulnerability (command line option `iommu=no-sharept`).  Note however that as of Xen version **4.13** there's also a respective per-guest control (`passthrough=` libxl guest config file option).  If any guests have been created with an explicit setting here, this setting may conflict with the addition of the `iommu=no-sharept` Xen command line option.\"\n\n* \"Suppressing the use of large HAP pages will avoid the vulnerability (command line options `hap_2mb=no hap_1gb=no`).\"\n\n* \"Not passing through PCI devices to HVM guests will avoid the vulnerability.\"",
    "vendorFixDate": "2020-07-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1665",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-119"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15565",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1665/ranges"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=23570bce00ee6ba2139ece978ab6f03ff166e21d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=5fe515a0fede07543f2a3b049167b1fd8b873caf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=62298825b9a44f45761acbd758138b5ba059ebd1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=91526b460e5009fc56edbd6809e66c327281faba",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=a64ea16522a73a13a0d66cfa4b66a9d3b95dd9d6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b6d9398144f21718d25daaf8d72669a75592abc5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=c23274fd0412381bd75068ebc9f8f8c90a4be748",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-321.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-321.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ce3c4493e4e6c94495ddd8538e801a35980bff0d",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1665/default-remediation-status"
            }
        ]
    }
}