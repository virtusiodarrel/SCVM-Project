{
    "source": "BDSA",
    "name": "BDSA-2020-0949",
    "title": "TeamPass Vulnerable to Security Control Bypass via 'X-Forwarded-For' Header",
    "description": "TeamPass contains a security control bypass vulnerability due to the security controls relying entirely on user controlled data for verification. An attacker with a valid `apikey` could access restricted API functionality on an application that uses the IP address whitelisting feature.",
    "technicalDescription": "A TeamPass feature allows the application to be configured so that only requests from predefined whitelisted IP addresses are able to access API functionality of the application. The problem lies in the value in the request used to verify if it has come from an eligible source is the `X-Forwarded-For` header which is controlled by the user. The problematic code is in the `getIp` function in `api/functions.php`. An attacker with a valid `apikey` could make a request with a manipulated `X-Forwarded-For` value that includes a whitelisted IP, resulting in the ability of the attacker to access the restricted functionality.",
    "publishedDate": "2020-05-01T08:40:15.807Z",
    "updatedDate": "2021-07-22T15:23:24.197Z",
    "disclosureDate": "2020-04-02T00:00:00.000Z",
    "exploitPublishDate": "2020-04-02T00:00:00.000Z",
    "solution": "",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNCONFIRMED",
            "score": 6.1
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:U/RC:UC)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNKNOWN",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:U/RC:U"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "bstapes",
    "workaround": "",
    "vendorNotifiedDate": "2020-04-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0949",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12477",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0949/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nilsteampassnet/TeamPass/issues/2761",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nilsteampassnet/TeamPass/issues/2761",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0949/default-remediation-status"
            }
        ]
    }
}