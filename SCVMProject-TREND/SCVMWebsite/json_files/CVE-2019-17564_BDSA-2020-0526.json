{
    "source": "BDSA",
    "name": "BDSA-2020-0526",
    "title": "Apache Dubbo Vulnerable to Remote Code Execution (RCE) via Unsafe Deserialization in 'handle()' Method",
    "description": "Apache Dubbo is vulnerable to remote code execution (RCE) due to the unsafe deserialization of client-provided input. A remote unauthenticated attacker could execute arbitrary code on the underlying operating system of a vulnerable server by submitting malicious web requests to that server.\n\nIt should be noted that HTTP remoting must be enabled within the Dubbo application for an attacker to be able to exploit this vulnerability.",
    "technicalDescription": "The `InternalHandler` class, which is defined within the file `HttpProtocol.java`, contains the `handle()` method. This is invoked by the `DispatcherServlet` class, which is used to provide Dubbo's HTTP remoting functionality. The `handle()` method creates an instance of the `HttpInvokerServiceExporter` class, called `skeleton`. The `HttpInvokerServiceExporter` class is a component that is imported from Spring Framework. This class will eventually pass the request stream to the `readObject()` method of the `ObjectInputStream` class, which deserializes arbitrary Java objects that it receives in an unsafe manner. \n\nIf a Dubbo application has HTTP remoting enabled, it will constitute a vulnerable endpoint to which a remote unauthenticated attacker can submit a maliciously crafted POST request. This POST request's body will contain an object that has been serialized via the `ObjectOutputStream` class. The object itself will contain malicious code that will be invoked whenever the object is deserialized by the `readObject()` method. This will allow the attacker to execute arbitrary commands on the underlying operating system of the vulnerable server with the privileges of the Dubbo service provider.",
    "publishedDate": "2020-03-26T16:20:42.351Z",
    "updatedDate": "2022-02-07T15:59:16.723Z",
    "disclosureDate": "2020-02-10T00:00:00.000Z",
    "exploitPublishDate": "2020-02-19T00:00:00.000Z",
    "solution": "Fixed in [**2.7.4**](https://github.com/apache/dubbo/releases/tag/dubbo-2.7.4) by [this](https://github.com/apache/dubbo/commit/06f719086e0303c8edcc64f660cc7739de4dfdb5) commit and in [**2.6.8**](https://github.com/apache/dubbo/releases/tag/dubbo-2.6.8) by [this](https://github.com/apache/dubbo/commit/112990d06396ba9df3070a4eee077870c724cb82) commit.\n\nThe latest stable releases can be found [here](https://github.com/apache/dubbo/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 10.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 10.0,
        "severity": "HIGH",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "(AV:N/AC:L/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dor Tumarkin (Chekmarx Team)",
    "workaround": "",
    "vendorFixDate": "2019-10-10T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0526",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-17564",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0526/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/dubbo/commit/06f719086e0303c8edcc64f660cc7739de4dfdb5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/dubbo/commit/112990d06396ba9df3070a4eee077870c724cb82",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/dubbo/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/dubbo/releases/tag/dubbo-2.6.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/dubbo/releases/tag/dubbo-2.7.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.checkmarx.com/blog/apache-dubbo-unauthenticated-remote-code-execution-vulnerability",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.mail-archive.com/dev@dubbo.apache.org/msg06225.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0526/default-remediation-status"
            }
        ]
    }
}