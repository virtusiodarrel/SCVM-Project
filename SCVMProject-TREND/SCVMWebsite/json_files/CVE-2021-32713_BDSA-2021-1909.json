{
    "source": "BDSA",
    "name": "BDSA-2021-1909",
    "title": "Shopware Vulnerable to Stored Cross-Site Scripting (XSS) via Product Name Fields",
    "description": "Shopware is vulnerable to stored cross-site scripting (XSS) due to the insufficient validation of client-provided input parameters. A remote attacker with administrator credentials could leverage this issue in order to execute malicious scripts within the browser of a victim. This could allow the attacker to obtain sensitive information, such as browser cookies.",
    "technicalDescription": "Products within Shopware are accessed across a variety of scripts, including `detail.js` and `description.tpl`. These scripts insert the product name into dynamically generated web pages without performing any validation. If the product name constitutes an XSS payload, then that payload will be executed within the browser of a victim who views the dynamically generated content. A remote attacker with administrator credentials could therefore conduct XSS attacks by creating products with maliciously crafted names.",
    "publishedDate": "2021-06-25T15:26:44.388Z",
    "updatedDate": "2021-06-25T15:26:44.379Z",
    "disclosureDate": "2021-05-10T00:00:00.000Z",
    "solution": "Fixed in [**5.6.10**](https://github.com/shopware/shopware/releases/tag/v5.6.10) by [this](https://github.com/shopware/shopware/commit/a0850ffbc6f581a8eb8425cc2bf77a0715e21e12) commit.\n\nThe latest stable releases are available [here](https://github.com/shopware/shopware/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 1.7,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "If an upgrade to a patched version cannot be performed, the [Shopware Security Plugin](https://store.shopware.com/en/swag575294366635f/shopware-security-plugin.html) can be used instead.",
    "vendorFixDate": "2021-05-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1909",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32713",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1909/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.shopware.com/en/shopware-5-en/security-updates/security-update-05-2021",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/shopware/commit/a0850ffbc6f581a8eb8425cc2bf77a0715e21e12",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/shopware/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/shopware/releases/tag/v5.6.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/shopware/security/advisories/GHSA-f6p7-8xfw-fjqq",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://store.shopware.com/en/swag575294366635f/shopware-security-plugin.html",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1909/default-remediation-status"
            }
        ]
    }
}