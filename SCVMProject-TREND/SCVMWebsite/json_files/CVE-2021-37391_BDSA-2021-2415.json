{
    "source": "BDSA",
    "name": "BDSA-2021-2415",
    "title": "Chamilo LMS Vulnerable to Cross-Site Scripting (XSS) via 'sendInvitationToUser' Function",
    "description": "Chamilo LMS contains a stored cross-site scripting (XSS) vulnerability in the user invitations feature of its social network functionality. An attacker could exploit this in order to insert malicious JavaScript into dynamically generated web page content, which when executed could steal authentication tokens, user cookies or other sensitive information.",
    "technicalDescription": "The vulnerability exists due to the insufficient sanitization of the `$content` variable in the `sendInvitationToUser()` function, which is defined in the file `main/inc/lib/social.lib.php`. The value of this variable is derived from client-provided input, and is used by the application in order to dynamically generate the contents of web pages. If the value of the variable constitutes an XSS payload, then that payload will be executed within the browser of a victim who views the dynamically generated content. This could allow an attacker to steal authentication tokens, user cookies or other sensitive information.\n\nThe issue was mitigated by implementing the `strip_tags()` filter function within `sendInvitationToUser()`.",
    "publishedDate": "2021-08-12T11:59:44.687Z",
    "updatedDate": "2022-02-02T09:41:27.047Z",
    "disclosureDate": "2021-07-20T00:00:00.000Z",
    "exploitPublishDate": "2021-07-21T00:00:00.000Z",
    "solution": "Fixed in [**1.11.16-beta1**](https://github.com/chamilo/chamilo-lms/releases/tag/v1.11.16-beta.1) and [**1.11.16**](https://github.com/chamilo/chamilo-lms/releases/tag/v1.11.16) by [this](https://github.com/chamilo/chamilo-lms/commit/de43a77049771cce08ea7234c5c1510b5af65bc8) commit.\n\nThe latest stable releases can be found [here](https://github.com/chamilo/chamilo-lms/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-07-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2415",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-37391",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2415/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/commit/de43a77049771cce08ea7234c5c1510b5af65bc8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/commit/de43a77049771cce08ea7234c5c1510b5af65bc8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/releases/tag/v1.11.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/releases/tag/v1.11.16-beta.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/chamilo/chamilo-lms/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/50694",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2415/default-remediation-status"
            }
        ]
    }
}