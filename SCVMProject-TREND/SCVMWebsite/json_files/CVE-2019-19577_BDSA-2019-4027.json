{
    "source": "BDSA",
    "name": "BDSA-2019-4027",
    "title": "Xen Vulnerable to Denial-of-service (DoS) via Unsafe Allocation of Page Table Height",
    "description": "Xen is vulnerable to denial-of-service (DoS) due to a vulnerability in the way page tables are managed during boot-up, allowing a malicious guest administrator to cause Xen to crash. Memory leakage is also a possibility.",
    "technicalDescription": "A vulnerability exists in the dynamic allocation of page table height (the allocated number of page table levels) for Xen running on AMD systems with IOMMU.  Dynamic allocation is determined based on the guest address space size.  This allocation is performed without implementing the necessary  PCI device structure lock,  resulting in an unsafe operation. \n\nAn attacker with guest administration privileges can cause Xen to access PCI device structures while they are being udpated, causing the hypervisor to crash. An attack can also result in memory leakage of up to  4kb per guest boot.\n\nThe vulnerability resides in`updating_page_mode()`  function in `xen/drivers/passthrough/amd/iommu_map.c` \n\nNote:\n\n* Only Xen running on AMD CPUs  is vulnerable.  \n* Only systems that use PCI pass-through are vulnerable.\n* Only HVM guests can exploit the vulnerability.\n* All versions of Xen with IOMMU support are vulnerable.",
    "publishedDate": "2019-12-23T16:18:32.907Z",
    "updatedDate": "2019-12-23T16:18:32.887Z",
    "disclosureDate": "2019-12-11T00:00:00.000Z",
    "solution": "Fixed in  [**4.13.0-rc5**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/tags/4.13.0-rc5) and in  [**4.12.2**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/tags/RELEASE-4.12.2) with [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b4f042236ae0bb6725b3e8dd40af5a2466a6f971) commit.\n\nAnd, also it is fixed in the following branches awaiting release:\n\n* [**4.10.x**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.10) with [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6cb1cb9c63e91b71ce639e7b7cf08ca85d44266f) commit\n* [**4.9.x**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.9) with [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=43ab30b13fe8b1d5f92a9ad2ca7d61f4c77b6cac) commit\n* [**4.8.x**](https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/heads/stable-4.8) with [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=8db85532cbb80c6396e5dab8809feb7b7b0d5c45) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.2,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Sander Eikelenboom and Andrew Cooper",
    "workaround": "The vendor suggest that some configurations will allow PCI  pass-through to be replaced with a higher-level protocol such as Xen PV block or network devices.",
    "vendorFixDate": "2019-12-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4027",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-591"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19577",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4027/ranges"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xenproject.org/xsa/advisory-311.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xenproject.org/xsa/advisory-311.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=43ab30b13fe8b1d5f92a9ad2ca7d61f4c77b6cac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6cb1cb9c63e91b71ce639e7b7cf08ca85d44266f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=8db85532cbb80c6396e5dab8809feb7b7b0d5c45",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=b4f042236ae0bb6725b3e8dd40af5a2466a6f971",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/tags/4.13.0-rc5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=shortlog;h=refs/tags/RELEASE-4.12.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4027/default-remediation-status"
            }
        ]
    }
}