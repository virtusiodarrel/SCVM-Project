{
    "source": "BDSA",
    "name": "BDSA-2020-1091",
    "title": "GLPI Vulnerable to Cross-Site Scripting (XSS) via Invalid 'Content-Type' in Dropdown Menu Endpoints",
    "description": "GLPI (Open Source IT Equipment Manager) is vulnerable to cross-site scripting (XSS) due to an invalid header returned when using dropdown menus. An attacker could exploit this to execute malicious code into a user's browser and steal user's session cookies.",
    "technicalDescription": "The vulnerability manifests in the following AJAX calls when using dropdown menus:\n\n* `ajax/getDropdownValue.php`\n* `ajax/getDropdownConnect.php`\n* `ajax/getDropdownFindNum.php`\n* `ajax/getDropdownNetpoint.php`\n* `ajax/getDropdownNumber.php`\n* `ajax/getDropdownUsers.php`\n* `ajax/autocompletion.php`\n\nThe server returns JSON content but sets the `Content-Type: text/html` header. This means that if there is JavaScript embedded into the dropdown menu response it will be executed in the user's browser. Note that while in some cases the attacker needs privileges to add an item with JavaScript embedded in the name beforehand, it is also possible to perform reflected XSS via `emptylabel` parameter without having an account.\n\nThis vulnerability was fixed by changing `Content-Type` to `application/json`.",
    "publishedDate": "2020-05-13T13:21:46.252Z",
    "updatedDate": "2020-05-13T13:21:46.248Z",
    "disclosureDate": "2020-05-12T00:00:00.000Z",
    "exploitPublishDate": "2020-05-12T00:00:00.000Z",
    "solution": "Fixed in [**9.4.6**](https://github.com/glpi-project/glpi/releases/tag/9.4.6) by [this](https://github.com/glpi-project/glpi/commit/5e1c52c5e8a30ceb4e9572964da7ed89ddfb1aaf) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-03-04T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1091",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11062",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1091/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/commit/5e1c52c5e8a30ceb4e9572964da7ed89ddfb1aaf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/releases/tag/9.4.6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/releases/tag/9.4.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/security/advisories/GHSA-3xxh-f5p2-jg3h",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://offsec.almond.consulting/multiple-vulnerabilities-in-glpi.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://offsec.almond.consulting/multiple-vulnerabilities-in-glpi.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1091/default-remediation-status"
            }
        ]
    }
}