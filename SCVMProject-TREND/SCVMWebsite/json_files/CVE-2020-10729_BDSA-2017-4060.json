{
    "source": "BDSA",
    "name": "BDSA-2017-4060",
    "title": "Ansible Vulnerable to Insecure Password Generation via Templating Results Caching Flaw",
    "description": "Ansible is vulnerable to a password generation flaw where two random password lookups of the same length can generate an equal value.\n\nThis issue could mean that if one password is leaked, this password could expose multiple services and configurations.",
    "technicalDescription": "Ansible is vulnerable to insecure password generation because the template caching functionality can incorrectly cache dynamic lookup results. This means that identical values can be generated when consecutive facts are created from a password lookup with the same length.\n\nIf an Ansible task uses the lookup functionality to set up multiple passwords with the same length consecutively, services could be at risk to exposure if any of the passwords are leaked.",
    "publishedDate": "2021-06-03T11:28:42.424Z",
    "updatedDate": "2021-06-03T11:28:42.415Z",
    "disclosureDate": "2017-12-21T00:00:00.000Z",
    "exploitPublishDate": "2017-12-21T00:00:00.000Z",
    "solution": "Fixed in [**2.9.6**](https://github.com/ansible/ansible/releases/tag/v2.9.6) by [this](https://github.com/ansible/ansible/commit/b38603c45ed3a53574ec2080fb3a24db38ab5bc6) commit.\n\nThe latest stable releases are available [here](https://github.com/ansible/ansible/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.0,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.2,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rihards Olups",
    "workaround": "",
    "vendorFixDate": "2020-03-02T00:00:00.000Z",
    "vendorNotifiedDate": "2017-12-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2017-4060",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-330"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10729",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2017-4060/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1831089",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/b38603c45ed3a53574ec2080fb3a24db38ab5bc6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/issues/34144",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/issues/34144",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/pull/67429",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases/tag/v2.9.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2017-4060/default-remediation-status"
            }
        ]
    }
}