{
    "source": "BDSA",
    "name": "BDSA-2019-4224",
    "title": "GitLab Vulnerable to Server Side Request Forgery (SSRF) Mitigation Bypass via Webhooks",
    "description": "GitLab contains a server side request forgery (SSRF) vulnerability due to insufficient validation of user controlled input. An attacker could exploit this vulnerability to access sensitive information from the internal network.",
    "technicalDescription": "The `validate` function in `lib/gitlab/url_blocker.rb` does not sufficiently handle errors when resolving a domain. If resolving a domain results in an error, such as the domain does not resolve, the DNS rebinding protection in place to protect against requests to internal IP addresses is not applied. \nBy creating a specially crafted webhook in a GitLab repository an attacker could make requests to the internal network that should not be able accessible.",
    "publishedDate": "2020-01-29T16:05:28.909Z",
    "updatedDate": "2020-01-29T16:05:28.900Z",
    "disclosureDate": "2019-07-29T00:00:00.000Z",
    "exploitPublishDate": "2019-08-30T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**11.11.6**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.11.6) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/de9b7a690c9792cc320f885214240a515615de33) commit,\n* [**12.0.4**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.0.4) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/c5177d9aae2b0c8c1d1780a01aa01862069bdaf1) commit\n* [**12.1.2**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.1.2) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/b6c5c797aaa03d5eed73a37a1c0138431fe755cb) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "mclaren650sspider",
    "workaround": "",
    "vendorFixDate": "2019-07-02T00:00:00.000Z",
    "vendorNotifiedDate": "2019-07-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4224",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5464",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4224/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2019/07/29/security-release-gitlab-12-dot-1-dot-2-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.11.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.1.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/b6c5c797aaa03d5eed73a37a1c0138431fe755cb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/c5177d9aae2b0c8c1d1780a01aa01862069bdaf1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/de9b7a690c9792cc320f885214240a515615de33",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/issues/63959",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/issues/63959",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4224/default-remediation-status"
            }
        ]
    }
}