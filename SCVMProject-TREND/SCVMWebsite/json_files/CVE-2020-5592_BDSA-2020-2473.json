{
    "source": "BDSA",
    "name": "BDSA-2020-2473",
    "title": "Zenphoto Vulnerable to Cross-Site Scripting (XSS) via 'html_encodeTagged()' Function",
    "description": "Zenphoto is vulnerable to cross-site scripting (XSS) issues due to how user supplied input can be printed without sufficient sanitization being applied.\n\nAn attacker could insert malicious scripts into affected parameters and trick a victim user into requesting affected content in order to steal session tokens, cookies, or other sensitive information.",
    "technicalDescription": "Zenphoto is vulnerable to cross-site scripting (XSS) because the `html_encodeTagged()` function in the `zp-core/functions-common.php` file is relied upon to print various user controlled content without applying sufficient validation or input sanitization.\n\nThe `html_encodeTagged()` function is used in multiple places to render content such as album, image, and new article titles and descriptions. An attacker could insert malicious scripts in these locations in order to conduct stored XSS attacks.",
    "publishedDate": "2020-09-23T11:25:41.551Z",
    "updatedDate": "2020-09-23T11:25:41.542Z",
    "disclosureDate": "2020-06-04T00:00:00.000Z",
    "solution": "Fixed in [**1.5.7**](https://github.com/zenphoto/zenphoto/releases/tag/v1.5.7) by [this](https://github.com/zenphoto/zenphoto/commit/2c7652c3b9ef836e2c0ac0e663ca18832a20454c) commit.\n\nThe latest stable releases are available [here](https://github.com/zenphoto/zenphoto/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "JPCERT/CC",
    "workaround": "",
    "vendorFixDate": "2020-04-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2473",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5592",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2473/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zenphoto/zenphoto/commit/2c7652c3b9ef836e2c0ac0e663ca18832a20454c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zenphoto/zenphoto/commit/3702796386c4ac01f677e2c6495785f802d46927",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zenphoto/zenphoto/releases/tag/v1.5.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jvn.jp/en/jp/JVN32252648/index.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.zenphoto.org/news/zenphoto-1.5.7/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2473/default-remediation-status"
            }
        ]
    }
}