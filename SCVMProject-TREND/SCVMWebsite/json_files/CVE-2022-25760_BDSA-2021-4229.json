{
    "source": "BDSA",
    "name": "BDSA-2021-4229",
    "title": "Accesslog Vulnerable to Arbitrary Code Injection via 'Function' Constructor",
    "description": "The Accesslog package contains an arbitrary code injection vulnerability due to lack of input sanitization. An attacker could exploit this issue by passing user input to the format option of the `Function` constructor. This may allow for the execution of arbitrary JavaScript code on the host which the Accesslog package is being run on.",
    "technicalDescription": "Code execution could be achieved through passing maliciously crafted user input to the Function constructor, through the below line of vulnerable code:\n\n`return new Function('tokens, req, res', js).bind(context);`",
    "publishedDate": "2022-03-30T16:09:58.845Z",
    "updatedDate": "2022-09-27T15:34:08.020Z",
    "disclosureDate": "2021-12-08T00:00:00.000Z",
    "exploitPublishDate": "2021-12-08T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "UNCORROBORATED",
            "score": 6.4
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:U/RC:UR)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "UNAVAILABLE",
            "reportConfidence": "REASONABLE",
            "score": 8.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:U/RC:R"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "OmniTaint",
    "workaround": "",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4229",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-25760",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4229/ranges"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-ACCESSLOG-2312099",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-ACCESSLOG-2312099",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4229/default-remediation-status"
            }
        ]
    }
}