{
    "source": "BDSA",
    "name": "BDSA-2021-3087",
    "title": "Nextcloud Vulnerable to Reflected Cross-Site Scripting (XSS) via 'Dialogs' Library",
    "description": "Nextcloud contains a cross-site scripting (XSS) vulnerability due to the insufficient sanitization of user input in a web page. An attacker could inject malicious scripts into the website via user input fields in order to steal sensitive information, such as visitors' browser session cookies.",
    "technicalDescription": "This issue occurs when user text input passed to a toast is insufficiently escaped. Nextcloud uses ToastifyJS which can be used to create toasts with user-supplied input in an application.  An attacker could therefore inject an XSS payload within the web page. This was mitigated by updating ToastifyJS from version 1.9.1 to 1.10.0, which included the addition of the line `escapeMarkup: !options.isHTML`. This vulnerability resides within the Dialogs library.",
    "publishedDate": "2021-10-19T10:29:06.510Z",
    "updatedDate": "2021-10-19T10:29:06.500Z",
    "disclosureDate": "2021-04-13T00:00:00.000Z",
    "solution": "Fixed in version [**3.1.2**](https://github.com/nextcloud/nextcloud-dialogs/releases/tag/v3.1.2) by [this](https://github.com/nextcloud/nextcloud-dialogs/pull/328/commits/da9222735510fd5c939a19a74331f102dc9d8f29/) commit.\n\nThe latest stable releases can be found [here](https://github.com/nextcloud/nextcloud-dialogs/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "solov9ev",
    "workaround": "Per the vendor:\n\n> The vulnerability has been patched in version 3.1.2. If you need to display HTML in the toast, explicitly pass the `options.isHTML` config flag.",
    "vendorFixDate": "2021-04-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3087",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29438",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3087/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/nextcloud-dialogs/pull/328/commits/da9222735510fd5c939a19a74331f102dc9d8f29",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/nextcloud-dialogs/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/nextcloud-dialogs/releases/tag/v3.1.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/nextcloud-dialogs/security/advisories/GHSA-g3fq-3v3g-mh32",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/nextcloud-dialogs/security/advisories/GHSA-g3fq-3v3g-mh32",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3087/default-remediation-status"
            }
        ]
    }
}