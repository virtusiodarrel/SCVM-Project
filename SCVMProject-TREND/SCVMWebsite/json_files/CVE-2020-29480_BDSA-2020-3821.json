{
    "source": "BDSA",
    "name": "BDSA-2020-3821",
    "title": "Xen Xenstore Vulnerable to Information Disclosure via Missing Permission Checks for Watch Notifications",
    "description": "The Xenstore component for Xen does not implement permission checks when a xenstore watch event is being reported. This could allow an attacker to gain access to information which could be useful for conducting other attacks.",
    "technicalDescription": "This vulnerability results from missing permission checks that can allow an attacker to use a guest administrator to watch the root xenstored node and monitor the notifications that it is sending out. Thus, the attacker can monitor notifications for events like creation/deletion of keys and creation/deletion of a domain. Via these notifications, the attacker can gain information like the number/type of VMs, number of virtual interfaces/vcpus, etc. The disclosed information is not limited to the aforementioned items and this information will be accessible in the form of key names. It should be noted that the attacker cannot see the corresponding values for these keys. This information could be useful when the attacker is conducting other attacks on the application.\n\n**Note** Both types of Xenstore implementations (C and Ocaml) are vulnerable to be exploited.",
    "publishedDate": "2020-12-23T16:08:03.512Z",
    "updatedDate": "2022-08-03T15:24:05.640Z",
    "disclosureDate": "2020-12-15T00:00:00.000Z",
    "solution": "Fixed in [**4.14.1**](http://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=fae6f50c923abcd36267a20e6b20adc1a771084f) by these commits:\n* [Commit 1](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=228e5621ebdd3abd520fcdc712347f877880ee71),\n* [Commit 2](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=f4405b67aa7f33d07dd374226b0b4e3bb1fefb69),\n* [Commit 3](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6fa3e05ff5a8083a0be29ac66d4d94bb57e252f2),\n* [Commit 4](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=335ef5b2b49100444aaaff19032235b1283ef1ea),\n* [Commit 5](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=9e53440c3675f143130b72b7bf6ea17240e3c053),\n* [Commit 6](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=61d386343a576de37a8192c7621a4db01124a458),\n* [Commit 7](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=9c898a82b84247fb02deb8ae2adb1f749631a7b1),\n* [Commit 8](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=da67712173474c31695a56a269a8b069f7eb36a6),\n* [Commit 9](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=3beffb3ed0e999e38a6ff4dec042b38c23d77e48),\n* [Commit 10](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=4e298fa40781231ddc3f17e3e14e869c1c591722),\n* [Commit 11](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=91992c72ed55185de07f44aacee499954143c9f3),\n* [Commit 12](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=117521e9c099d92f60753ff2bb30d97eef6e8137),\n* [Commit 13](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=3d0e1a15b31b690018e57547c6b82f442b1cbc76),\n* [Commit 14](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=52593586d58086fe27cfbed3dc9beeae3d9c8c09),\n* [Commit 15](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=5073c6b169dd12ec02afc145d4177f97831646e0),\n* [Commit 16](http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=0a79a1b1d8fc6214f162b2d7b00f5d3533109820),\n\nFixed in the following branches by commits corresponding to [these](https://xenbits.xenproject.org/xsa/advisory-115.html) patches, which are not yet included in any release:\n* **stable-4.10** branch\n* **staging-4.10** branch\n* **stable-4.11** branch\n* **staging-4.11** branch\n* **stable-4.12** branch\n* **staging-4.12** branch\n* **staging-4.13** branch\n* **stable-4.14** branch\n* **staging-4.14** branch\n* **HEAD -> origin/master** branch\n* **coverity-tested/smoke** branch\n* **master** branch\n* **smoke** branch\n* **staging** branch",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 2.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 0.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrew Reimers and Alex Sharp from OrionVM",
    "workaround": "",
    "vendorFixDate": "2020-12-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3821",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-275"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-29480",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3821/ranges"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=0a79a1b1d8fc6214f162b2d7b00f5d3533109820",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=117521e9c099d92f60753ff2bb30d97eef6e8137",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=228e5621ebdd3abd520fcdc712347f877880ee71",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=335ef5b2b49100444aaaff19032235b1283ef1ea",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=3beffb3ed0e999e38a6ff4dec042b38c23d77e48",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=3d0e1a15b31b690018e57547c6b82f442b1cbc76",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=4e298fa40781231ddc3f17e3e14e869c1c591722",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=5073c6b169dd12ec02afc145d4177f97831646e0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=52593586d58086fe27cfbed3dc9beeae3d9c8c09",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=61d386343a576de37a8192c7621a4db01124a458",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6fa3e05ff5a8083a0be29ac66d4d94bb57e252f2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=91992c72ed55185de07f44aacee499954143c9f3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=9c898a82b84247fb02deb8ae2adb1f749631a7b1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=9e53440c3675f143130b72b7bf6ea17240e3c053",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=da67712173474c31695a56a269a8b069f7eb36a6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=f4405b67aa7f33d07dd374226b0b4e3bb1fefb69",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/gitweb/?p=xen.git;a=tag;h=fae6f50c923abcd36267a20e6b20adc1a771084f",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-115.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3821/default-remediation-status"
            }
        ]
    }
}