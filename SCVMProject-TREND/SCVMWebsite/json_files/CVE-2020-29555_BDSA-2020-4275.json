{
    "source": "BDSA",
    "name": "BDSA-2020-4275",
    "title": "Grav Admin Plugin Vulnerable to Arbitrary File Deletion via Path Traversal in Backup Functionality",
    "description": "The Grav Admin Plugin is vulnerable to an arbitrary file deletion issue due to a lack of sufficient input validation in the backup functionality. \n\nA malicious user with administrative credentials could supply a relative path to the delete old backup file functionality in order to perform a path traversal attack and delete arbitrary files from the file system.",
    "technicalDescription": "The Grav Admin Plugin is vulnerable is sensitive information disclosure because the `taskBackupDelete()` function in the `classes/admincontroller.php` file does not correctly check the path of the backup file to be deleted. This function can accept a relative path to a known file and allow administrative users to delete arbitrary and potentially sensitive files.\n\nDepending on the Grav configuration, it could be possible for files outside of the webroot to be deleted.",
    "publishedDate": "2021-03-16T16:55:49.594Z",
    "updatedDate": "2021-03-16T16:55:49.589Z",
    "disclosureDate": "2020-12-10T00:00:00.000Z",
    "exploitPublishDate": "2021-03-04T00:00:00.000Z",
    "solution": "Fixed in [**1.9.18**](https://github.com/getgrav/grav-plugin-admin/releases/tag/1.9.18) by [this](https://github.com/getgrav/grav-plugin-admin/commit/24e7d154f1b2cbbdfb8de77595d75c4ca31c7a14) commit.\n\nThe latest stable releases are available [here](https://github.com/getgrav/grav-plugin-admin/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-11-30T00:00:00.000Z",
    "discoveryDate": "2020-11-21T00:00:00.000Z",
    "vendorNotifiedDate": "2020-11-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4275",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-29555",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4275/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.bssi.fr/cve-2020-29553-cve-2020-29555-cve-2020-29556-multiple-vulnerabilities-within-cms-grav/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.bssi.fr/cve-2020-29553-cve-2020-29555-cve-2020-29556-multiple-vulnerabilities-within-cms-grav/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/getgrav/grav-plugin-admin/commit/24e7d154f1b2cbbdfb8de77595d75c4ca31c7a14",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/getgrav/grav-plugin-admin/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/getgrav/grav-plugin-admin/releases/tag/1.9.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/getgrav/grav-plugin-admin/security/advisories/GHSA-85r3-mf4x-qp8f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://youtu.be/DS2mQKHx6mA",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4275/default-remediation-status"
            }
        ]
    }
}