{
    "source": "BDSA",
    "name": "BDSA-2020-2012",
    "title": "Microweber Vulnerable to Database Disclosure via 'controller.php'",
    "description": "Microweber is vulnerable to database disclosure when a crafted POST request is sent to the `/modules/` endpoint. An attacker could exploit this vulnerability to gain access to the user database.",
    "technicalDescription": "This vulnerability exists in the `userfiles/modules/users/controller.php` file. An unauthenticated attacker could send a POST request to the `/modules/` endpoint via `module=/modules/users/controller`. The `controller.php` file calls the dump and die (`dd()`) function which dumps the entire user database. This could allow the unauthenticated attacker to gain access to the credentials of all Microweber users, including the admin users.\n\nThe information in the database dump includes usernames, password hashes and email IDs. The attacker could use tools like Hashcat to obtain the plaintext passwords (originally hashed using bcrypt).",
    "publishedDate": "2020-08-12T13:50:32.609Z",
    "updatedDate": "2021-08-19T14:28:38.869Z",
    "disclosureDate": "2020-05-22T00:00:00.000Z",
    "exploitPublishDate": "2020-07-16T00:00:00.000Z",
    "solution": "Fixed in [**1.2.3**](https://github.com/microweber/microweber/releases/tag/v1.2.3) by [this](https://github.com/microweber/microweber/commit/269320e0e0e06a1785e1a1556da769a34280b7e6) commit.\n\nThe latest releases are available [here](https://microweber.org/download).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Hunter Stanton",
    "workaround": "",
    "vendorFixDate": "2020-05-22T00:00:00.000Z",
    "vendorNotifiedDate": "2020-04-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2012",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-522"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-528"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13405",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2012/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/microweber/microweber/commit/11466e57de1dcaddd2b55784b0b7daa032ef3e79#",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/microweber/microweber/commit/269320e0e0e06a1785e1a1556da769a34280b7e6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/microweber/microweber/releases/tag/v1.2.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://microweber.org/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://rhinosecuritylabs.com/research/microweber-database-disclosure/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://rhinosecuritylabs.com/research/microweber-database-disclosure/",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2012/default-remediation-status"
            }
        ]
    }
}