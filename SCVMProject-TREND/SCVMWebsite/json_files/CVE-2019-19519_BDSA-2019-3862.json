{
    "source": "BDSA",
    "name": "BDSA-2019-3862",
    "title": "OpenBSD Vulnerable to Privilege Escalation via Improper Login Class Handling",
    "description": "OpenBSD is vulnerable to privilege escalation due to the incorrect management of data in the system's memory. A local attacker could log in as themselves, but with another user's login class, by using the `-L` option of the `su` program. It should be noted that the attacker will not be able to gain the root user's login class unless they are part of the `wheel` group.",
    "technicalDescription": "The `su` program's source code is contained within `su.c`. The `main()` function keeps track of the user's class using the `class` variable. This variable is set once, and is never reset for subsequent iterations of the `main()` function. If the `-L` flag is used, the `su` program will run in a loop until the correct user name a password is specified. If a local attacker with access to a valid user account runs the program with the `-L` flag and then specifies a target user, the `class` variable will correspond to that user. They can then specify an arbitrary password, causing the login process to fail. The program will then start the authentication process again, but will not reset `class`. The attacker can then specify their valid credentials in order to log in successfully, with the class of the target user.",
    "publishedDate": "2019-12-09T16:51:39.014Z",
    "updatedDate": "2019-12-09T16:51:48.104Z",
    "disclosureDate": "2019-12-04T00:00:00.000Z",
    "exploitPublishDate": "2019-12-04T00:00:00.000Z",
    "solution": "Fixed in [this](https://ftp.openbsd.org/pub/OpenBSD/patches/6.6/common/012_suauth.patch.sig) patch which is not yet included in any release.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Qualys",
    "workaround": "",
    "vendorFixDate": "2019-12-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3862",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19519",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3862/ranges"
            },
            {
                "rel": "reference",
                "href": "https://ftp.openbsd.org/pub/OpenBSD/patches/6.6/common/012_suauth.patch.sig",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/bugtraq/2019/Dec/8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/bugtraq/2019/Dec/8",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.openbsd.org/errata66.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3862/default-remediation-status"
            }
        ]
    }
}