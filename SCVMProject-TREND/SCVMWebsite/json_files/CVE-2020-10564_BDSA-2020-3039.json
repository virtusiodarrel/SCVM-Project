{
    "source": "BDSA",
    "name": "BDSA-2020-3039",
    "title": "WordPress File Upload Vulnerable to Remote Code Execution (RCE) via Directory Traversal in 'filenames' and 'uploadedfile_X_name' Parameters",
    "description": "WordPress File Upload is vulnerable to remote code execution (RCE) due to a directory traversal issue. A remote unauthenticated attacker can execute malicious code on a vulnerable server by uploading a crafted file.",
    "technicalDescription": "This vulnerability exists because the parameters `filenames` and `uploadedfile_X_name` are vulnerable to directory traversal. It can allow an attacker to upload a malicious file to the `lib` directory. This file will then be executed when the function `wfu_include_lib()` is called. \nAs shown in the PoC, an attacker could upload a file to the `lib` directory which initiates a connection from the server to the attacker's machine. Firstly, the attacker could select his malicious file for uploading and intercept the subsequent requests. Then, he can prepend the content of the parameters `filenames` and `uploadedfile_X_name` with the hexadecimal representation of `../plugins/wp-file-upload/lib/`. Thus, this will cause the uploaded malicious file to be stored in the `lib` directory. This file will be executed every time a page (which uses the file upload plugin) is loaded. \n\nThe attacker does not need any privileges to exploit this vulnerability and he can subsequently execute malicious code on the server.",
    "publishedDate": "2020-10-29T16:15:56.564Z",
    "updatedDate": "2021-01-08T10:00:12.162Z",
    "disclosureDate": "2020-03-13T00:00:00.000Z",
    "exploitPublishDate": "2020-04-07T00:00:00.000Z",
    "solution": "Fixed in [**4.13.0**](https://plugins.svn.wordpress.org/wp-file-upload/tags/4.13.0/) by [this](https://plugins.trac.wordpress.org/changeset/2258584) commit.\n\nThe latest stable releases are available [here](https://plugins.svn.wordpress.org/wp-file-upload/tags/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Riccardo Krauter",
    "workaround": "",
    "vendorFixDate": "2020-03-11T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-11T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3039",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10564",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3039/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/beerpwn/CVE/blob/master/WP-File-Upload_disclosure_report/report.md",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/beerpwn/CVE/tree/master/WP-File-Upload_disclosure_report/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://plugins.svn.wordpress.org/wp-file-upload/tags/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://plugins.svn.wordpress.org/wp-file-upload/tags/4.13.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://plugins.svn.wordpress.org/wp-file-upload/trunk/readme.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://plugins.trac.wordpress.org/changeset/2258584",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://wpscan.com/vulnerability/10132",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3039/default-remediation-status"
            }
        ]
    }
}