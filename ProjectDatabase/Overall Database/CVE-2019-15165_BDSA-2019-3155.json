{
    "source": "BDSA",
    "name": "BDSA-2019-3155",
    "title": "libpcap Vulnerable to Denial-of-Service (DoS) via Excessive Memory Allocation in 'pcap_ng_check_header()' Function",
    "description": "libpcap is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause a victim's instance of the application to crash by tricking them into running the program using a crafted `.pcap` file as input.",
    "technicalDescription": "The function `pcap_ng_check_header()`, which is defined within the script `sf-pcapng.c`, contains code that is used by libpcap as part of the process of determining if the user-provided `.pcap` file is valid and safe to parse. The length of the header information contained in the file is processed, with its total length being stored in the variable `total_length`. The function attempts to validate the length of the header field by ensuring that `total_length` is not less than the value returned by the calculation `sizeof(*bhdrp) + sizeof(*shbp) + sizeof(struct block_trailer)`. This will ensure that the header length is not too small. \n\nHowever, the function does not performs a check to ensure that the value of `total_length` is not too large. If this check does not fail, the program will allocate memory to store data contained in the file using the function `pcap_open_offline_common()`. If the header field is very large, this could cause the allocation to fail. This could potentially lead to an exception being raised, halting program execution. An attacker could therefore potentially cause a victim's instance of the application to crash by tricking them into running the program using a crafted `.pcap` file as input, in which the header field is exceptionally large.",
    "publishedDate": "2019-10-08T08:59:23.971Z",
    "updatedDate": "2019-11-26T12:50:36.008Z",
    "disclosureDate": "2019-09-20T00:00:00.000Z",
    "solution": "Fixed in version [**1.9.1**](https://github.com/the-tcpdump-group/libpcap/releases/tag/libpcap-1.9.1) by the following commits:\n* [Commit 1](https://github.com/the-tcpdump-group/libpcap/commit/87d6bef033062f969e70fa40c43dfd945d5a20ab)\n* [Commit 2](https://github.com/the-tcpdump-group/libpcap/commit/a5a36d9e82dde7265e38fe1f87b7f11c461c29f6)\n\nThe latest stable release can be found [here](https://github.com/the-tcpdump-group/libpcap/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-09-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-3155",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-15165",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-3155/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/blob/libpcap-1.9/CHANGES",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/commit/87d6bef033062f969e70fa40c43dfd945d5a20ab",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/commit/a5a36d9e82dde7265e38fe1f87b7f11c461c29f6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/releases/tag/libpcap-1.9.1",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}