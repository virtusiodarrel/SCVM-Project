{
    "source": "BDSA",
    "name": "BDSA-2018-4794",
    "title": "mozjpeg and libjpeg-turbo Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Read in 'get_8bit_row()' Function",
    "description": "mozjpeg and libjpeg-turbo are vulnerable to denial-of-service (DoS) due to the improper management of system memory resources. An attacker could cause a victim's instance of these applications to crash by tricking them into running the program using a crafted `.bmp` file.",
    "technicalDescription": "The function `get_8bit_row()`, defined within `rdbmp.c`, contains code that is used by mozjpeg and libjpeg-turbo during the processing of a 8-bit `.bmp` image file. The image's data is first stored in array form. Each row of this array is read by `get_8bit_row()`, so that the pixels can be expanded to a 24-bit format. The value of the variable `t` is used as an index into a color map, so that the correct pixel values can be obtained. The value of `t` is calculated based on the structure of the 8-bit image that is being processed. No checks are performed to ensure that the calculated value actually points to a value within the color map's boundaries. For certain input images, the value that is calculated will point to data that lies outside of the color map. Whenever the program attempts to access this data, an out-of-bounds read exception may occur. This will halt program execution. An attacker could therefore cause a DoS by tricking a victim into using a crafted image as input that will cause this sequence of events to occur.",
    "publishedDate": "2019-03-19T16:43:12.896Z",
    "updatedDate": "2019-03-19T16:43:12.862Z",
    "disclosureDate": "2018-07-20T00:00:00.000Z",
    "exploitPublishDate": "2018-07-20T00:00:00.000Z",
    "solution": "Fixed in mozjpeg by [this](https://github.com/mozilla/mozjpeg/commit/9c78a04df4e44ef6487eee99c4258397f4fdca55) commit in the `master` branch which is not yet included in any release.\n\nFixed in libjpeg-turbo version [**2.0.0**](https://github.com/libjpeg-turbo/libjpeg-turbo/releases/tag/2.0.0) of libjpeg-turbo by [this](https://github.com/libjpeg-turbo/libjpeg-turbo/commit/9c78a04df4e44ef6487eee99c4258397f4fdca55) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-07-20T00:00:00.000Z",
    "vendorNotifiedDate": "2018-07-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.0,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4794",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-14498",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4794/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libjpeg-turbo/libjpeg-turbo/commit/9c78a04df4e44ef6487eee99c4258397f4fdca55",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libjpeg-turbo/libjpeg-turbo/releases/tag/2.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mozilla/mozjpeg/commit/9c78a04df4e44ef6487eee99c4258397f4fdca55",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mozilla/mozjpeg/issues/299",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mozilla/mozjpeg/issues/299",
                "label": "POC"
            }
        ]
    }
}