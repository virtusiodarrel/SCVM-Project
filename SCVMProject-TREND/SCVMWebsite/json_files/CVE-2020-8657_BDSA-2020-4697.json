{
    "source": "BDSA",
    "name": "BDSA-2020-4697",
    "title": "EyesOfNetwork Vulnerable to Information Disclosure via API Keys",
    "description": "EyesOfNetwork is vulnerable to information disclosure. An attacker can take advantage of this in order to discover the API token of the admin account.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "This vulnerability exists due to a default configuration being used to calculate API keys in `include/api_functions.php` of EyesOfNetwork eonapi repository. This means that a user's API token is based on the key, the user ID and the IP of the server. An attacker can use this information in order to discover the API token of the admin account.\n\nThe vendor has mitigated this by ensuring that a users APIKEY is now based on `machine-id`.",
    "publishedDate": "2021-11-30T11:21:50.136Z",
    "updatedDate": "2022-05-05T15:16:57.436Z",
    "disclosureDate": "2020-02-05T00:00:00.000Z",
    "exploitPublishDate": "2020-02-05T00:00:00.000Z",
    "solution": "Fixed in eonapi repository [**2.0-2**](https://github.com/EyesOfNetworkCommunity/eonapi/releases/tag/2.0-2) by [this](https://github.com/EyesOfNetworkCommunity/eonapi/commit/0ed6d8cc901fac30357d438360a13aaee45eb3ba) commit.\n\nThe latest stable releases are available [here](https://github.com/EyesOfNetworkCommunity/eonapi/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "h4knet",
    "workaround": "",
    "vendorFixDate": "2020-02-06T00:00:00.000Z",
    "vendorNotifiedDate": "2020-02-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4697",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8657",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4697/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EyesOfNetworkCommunity/eonapi/commit/0ed6d8cc901fac30357d438360a13aaee45eb3ba",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EyesOfNetworkCommunity/eonapi/issues/17",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EyesOfNetworkCommunity/eonapi/issues/17",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EyesOfNetworkCommunity/eonapi/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EyesOfNetworkCommunity/eonapi/releases/tag/2.0-2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4697/default-remediation-status"
            }
        ]
    }
}