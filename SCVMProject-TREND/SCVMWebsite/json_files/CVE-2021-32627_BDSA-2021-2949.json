{
    "source": "BDSA",
    "name": "BDSA-2021-2949",
    "title": "Redis Vulnerable to Remote Code Execution (RCE) via Integer Overflow Caused by Large Stream Elements",
    "description": "Redis is vulnerable to remote code execution (RCE) due to an integer overflow bug which occurs during the handling of large stream elements. The integer overflow could potentially be leveraged to corrupt heap memory and run arbitrary commands on the Redis host.",
    "technicalDescription": "Exploitation of this vulnerability requires modifying the default configuration parameters `proto-max-bulk-len` and `client-query-buffer-limit` to large values, and then constructing specially crafted large stream elements.\n\nThe vulnerability was fixed by implementing the following changes:\n\n> - fix possible heap corruption in ziplist and listpack resulting by trying to allocate more than the maximum size of 4GB.\n> - prevent ziplist (hash and zset) from reaching size of above 1GB, will be converted to HT encoding, that's not a useful size.\n> - prevent listpack (stream) from reaching size of above 1GB.\n> - XADD will start a new listpack if the new record may cause the previous listpack to grow over 1GB.\n> - XADD will respond with an error if a single stream record is over 1GB\n> - List type (ziplist in quicklist) was truncating strings that were over 4GB, now it'll respond with an error.",
    "publishedDate": "2021-10-05T16:32:04.351Z",
    "updatedDate": "2022-07-26T05:45:31.594Z",
    "disclosureDate": "2021-10-04T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.0.14**](https://github.com/redis/redis/releases/tag/5.0.14) by [this](https://github.com/redis/redis/commit/6facfb7a103b26b9a602253a738b2130afb7c5d3) commit\n* [**6.0.16**](https://github.com/redis/redis/releases/tag/6.0.16) by [this](https://github.com/redis/redis/commit/f6a40570fa63d5afdd596c78083d754081d80ae3) commit\n* [**6.2.6**](https://github.com/redis/redis/releases/tag/6.2.6) by [this](https://github.com/redis/redis/commit/2775a3526e3e8bb040e72995231632c801977395) commit\n\nThe latest stable releases can be found [here](https://redis.io/download).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "sundb (GitHub)",
    "workaround": "To work around the issue the vendor suggests preventing users from modifying `proto-max-bulk-len` and `client-query-buffer-limit` parameters. This can be done using ACL to restrict unprivileged users from using the CONFIG SET command.",
    "vendorFixDate": "2021-10-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2949",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-680"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32627",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2949/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/2775a3526e3e8bb040e72995231632c801977395",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/6facfb7a103b26b9a602253a738b2130afb7c5d3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/commit/f6a40570fa63d5afdd596c78083d754081d80ae3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/5.0.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/6.0.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/releases/tag/6.2.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/security/advisories/GHSA-f434-69fm-g45v",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/redis/redis/security/advisories/GHSA-f434-69fm-g45v",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://redis.io/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2949/default-remediation-status"
            }
        ]
    }
}