{
    "source": "BDSA",
    "name": "BDSA-2020-1294",
    "title": "Elastic Search Vulnerable to Privilege Escalation via Incorrect Privilege Assignment in API Keys",
    "description": "It was discovered that Elastic Search was vulnerable to privilege escalation. An attacker with sufficient privileges to create API keys, could exploit this flaw to generate an authentication token with elevated privileges.",
    "technicalDescription": "An attackers who is able to generate API keys and an authentication token could exploit this flaw by preforming actions that will result in the generation of an API key with elevated privileges.\n\nThe vulnerability occurs due to an incomplete fix for CVE-2020-7009.",
    "publishedDate": "2020-06-04T13:59:44.525Z",
    "updatedDate": "2020-06-04T13:59:44.519Z",
    "disclosureDate": "2020-06-03T00:00:00.000Z",
    "solution": "Fixed in version [**7.7.0**](https://github.com/elastic/elasticsearch/releases/tag/v7.7.0) by [this](https://github.com/elastic/elasticsearch/commit/6f59ef267b2c3567754f8bea87daafc34cd9bd59) commit.\n Fixed in version [**6.8.9**](https://github.com/elastic/elasticsearch/releases/tag/v6.8.9) by [this](https://github.com/elastic/elasticsearch/commit/1c5f53076b625c44111c1e9430dc36327a088583) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "Users who are unable to upgrade can mitigate this flaw by disabling API keys by setting `xpack.security.authc.api_key.enabled` to false in the `elasticsearch.yml` file",
    "vendorFixDate": "2020-05-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1294",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-266"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7014",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1294/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/commit/1c5f53076b625c44111c1e9430dc36327a088583",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/commit/6f59ef267b2c3567754f8bea87daafc34cd9bd59",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/releases/tag/v6.8.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/releases/tag/v7.7.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.elastic.co/community/security/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.elastic.co/community/security/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1294/default-remediation-status"
            }
        ]
    }
}