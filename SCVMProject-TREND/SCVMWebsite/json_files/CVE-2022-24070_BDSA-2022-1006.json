{
    "source": "BDSA",
    "name": "BDSA-2022-1006",
    "title": "Apache Subversion httpd Servers Vulnerable to Denial-of-Service (DoS) via Use-After-Free (UAF) During 'authz' Rules Lookup",
    "description": "Apache Subversion server modules for Apache HTTP server (httpd) are vulnerable to denial-of-service (DoS) issues due to the presence of a use-after-free (UAF) flaw that can occur during path-based authorization (`authz`) rules lookups.\n\nAn attacker could abuse this issue in order to crash the HTTPD worker that handles requests that require a lookup of `authz` rules.\n\n**Note**: If the worker shares its memory address space with the main HTTPD thread, as is the case with e.g. the Event MPM, the entire HTTPD server process will terminate. If the pre-fork MPM is used, the worker will terminate but the HTTPD server will stay up, and service availability will depend on how frequently the attacker is able to send malicious requests which target the vulnerability.",
    "technicalDescription": "Server modules for Apache HTTP server (httpd), such as `mod_dav_svn`, implement hooks that httpd can call. The `post_config` hook can be called multiple times during initialization.\n\nUsually when a module is loaded at startup the `post_config` hook for a module is called for validation purposes and called again later in order to initialize the module. The issue is that in affected versions of Subversion, the first call is treated as the initialization call meaning pointers that are cached become invalid when the memory allocation pools used are cleared. This can lead to later operations occurring on freed memory which can cause a segmentation fault.",
    "publishedDate": "2022-04-13T13:44:57.924Z",
    "updatedDate": "2022-04-13T13:44:57.897Z",
    "disclosureDate": "2021-11-03T00:00:00.000Z",
    "exploitPublishDate": "2021-11-03T00:00:00.000Z",
    "solution": "Fixed in [**1.14.2**](https://archive.apache.org/dist/subversion/) by [this](https://svn.apache.org/viewvc?view=revision&revision=1899339) revision and in [**1.10.8**](https://archive.apache.org/dist/subversion/) by [this](https://svn.apache.org/viewvc?view=revision&revision=1899332) revision.\n\nThe latest stable releases are available [here](https://subversion.apache.org/download.cgi).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Thomas Wei\u00dfschuh (cis-solutions.eu)",
    "workaround": "",
    "vendorFixDate": "2022-03-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1006",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24070",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1006/ranges"
            },
            {
                "rel": "reference",
                "href": "https://archive.apache.org/dist/subversion/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/SVN-4880",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/bg8z05826qho57ggbhgk8dcmwv230xzy",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/jtpsygdt39q1nk8p9xwxff9ghxdt52r1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/lvrbx4dd39cxc4dq52rn7zzb7hzcr0po",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/lvrbx4dd39cxc4dq52rn7zzb7hzcr0po",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://subversion.apache.org/download.cgi",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://subversion.apache.org/security/CVE-2022-24070-advisory.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://svn.apache.org/viewvc?view=revision&revision=1899332",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svn.apache.org/viewvc?view=revision&revision=1899339",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1006/default-remediation-status"
            }
        ]
    }
}