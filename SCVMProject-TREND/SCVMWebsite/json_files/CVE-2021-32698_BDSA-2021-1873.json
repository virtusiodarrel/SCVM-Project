{
    "source": "BDSA",
    "name": "BDSA-2021-1873",
    "title": "eLabFTW Vulnerable to Blind Server Side Request Forgery (SSRF) via HTTP GET Requests",
    "description": "eLabFTW is vulnerable to blind server side request forgery (SSRF) via HTTP GET requests. This could allow an attacker to perform unauthorized GET requests as if they originated from the target server. The attacker is unable to see the result of the request.",
    "technicalDescription": "This issue occurs in the `getContent()` and `tex2svg()` functions of the `src/services/MakePdf.php` file because it was possible to set the source attribute of an image tag to anything and the **.PDF** generation would GET it. It was mitigated by ensuring that image sources pointing to arbitrary elements are now removed.",
    "publishedDate": "2021-06-22T14:05:10.982Z",
    "updatedDate": "2021-06-22T14:05:10.977Z",
    "disclosureDate": "2021-06-21T00:00:00.000Z",
    "solution": "Fixed in [**4.0.0**](https://github.com/elabftw/elabftw/releases/tag/4.0.0) by [this](https://github.com/elabftw/elabftw/commit/3d2db4d3ad90b0915f29f05aeba41eaaf6a7c726) commit.\n\nThe latest stable releases are available [here](https://github.com/elabftw/elabftw/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.8,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rafal Lykowski (@mgrRaf) and Piyush Patil (@xoffense)",
    "workaround": "",
    "vendorFixDate": "2021-06-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1873",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32698",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1873/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elabftw/elabftw/commit/3d2db4d3ad90b0915f29f05aeba41eaaf6a7c726",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elabftw/elabftw/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elabftw/elabftw/releases/tag/4.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elabftw/elabftw/security/advisories/GHSA-mh6g-62p8-26m4",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1873/default-remediation-status"
            }
        ]
    }
}