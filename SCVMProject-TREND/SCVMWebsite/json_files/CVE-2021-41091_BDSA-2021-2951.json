{
    "source": "BDSA",
    "name": "BDSA-2021-2951",
    "title": "Moby Vulnerable to Unauthorized Directory Traversal via Insufficient Restrictions on Data Directory",
    "description": "Moby (Docker engine) has insufficiently restricted permissions on the folders residing in the data directory. Unprivileged Linux users could traverse the directories' contents and execute certain programs residing in them.",
    "technicalDescription": "The vulnerable data directory is typically `/var/lib/docker`. Unprivileged users could traverse directories' contents and execute programs that have extended permissions (such as `setuid`) enabled. If the UID of an unprivileged Linux user on the host collides with the file owner or group inside a container, the unprivileged Linux user on the host can discover, read, and modify those files.\n\nThe vulnerability was fixed by changing both parent and child directory permissions from `0701` to `0710` which only allows users in the group to traverse the directories.",
    "publishedDate": "2021-10-06T13:28:16.615Z",
    "updatedDate": "2021-10-06T13:28:16.602Z",
    "disclosureDate": "2021-10-04T00:00:00.000Z",
    "solution": "Fixed in **[20.10.9](https://github.com/moby/moby/releases/tag/v20.10.9)** by [this](https://github.com/moby/moby/commit/f0ab919f51) commit.\n\nThe latest stable releases can be found [here](https://github.com/moby/moby/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Joan Bruguera",
    "workaround": "The vendor provides the following workaround:\n\n```\nLimit access to the host to trusted users. Limit access to host volumes to trusted containers.\n```",
    "vendorFixDate": "2021-09-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2951",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41091",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2951/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/commit/f0ab919f51",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/releases/tag/v20.10.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/security/advisories/GHSA-3fwx-pjgw-3558",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moby/moby/security/advisories/GHSA-3fwx-pjgw-3558",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2951/default-remediation-status"
            }
        ]
    }
}