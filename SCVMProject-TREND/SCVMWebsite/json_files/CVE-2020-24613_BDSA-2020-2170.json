{
    "source": "BDSA",
    "name": "BDSA-2020-2170",
    "title": "wolfSSL Vulnerable to Man-in-the-Middle (MitM) Attack via Incorrectly Implemented TLS 1.3 Client State Machine",
    "description": "wolfSSL is vulnerable to man-in-the-middle attacks via incorrectly implemented TLS **1.3** client state machine. This could allow an attacker to impersonate any TLS **1.3** server and could potentially lead to sensitive data exposure and modification of data.\n\n**Note:** Users that do not have TLS **1.3** turned on, or that are server side only, are not affected.",
    "technicalDescription": "wolfSSL fails to properly handle TLS server data in the `WAIT_CERT_CR` state within the `SanityCheckTls13MsgReceived` function of the `tls13.c` file. This permits an attacker with a privileged network position to completely impersonate TLS **1.3** servers and modify or read potentially sensitive information between clients utilizing the wolfSSL library and affected TLS servers. \nSpecifically and in the case of server certificate authentication, the wolfSSL TLS client state machine accepts a \u201cFinished\u201d message in the \u201cWAIT_CERT_CR\u201d state, after having processed an \u201cEncryptedExtensions\u201d message. According to TLS **1.3** standards, wolfSSL should allow only `CertificateRequest` or `Certificate` messages as valid input to the state machine in the `WAIT_CERT_CR` state.",
    "publishedDate": "2020-08-26T09:50:48.707Z",
    "updatedDate": "2020-11-02T11:30:37.099Z",
    "disclosureDate": "2020-08-24T00:00:00.000Z",
    "exploitPublishDate": "2020-08-24T00:00:00.000Z",
    "solution": "Fixed in [**4.5.0**](https://github.com/wolfSSL/wolfssl/releases/tag/v4.5.0-stable) by [this](https://github.com/wolfSSL/wolfssl//commit/f59a1fa2954506ba5bde9548726614400f0ec9a0) commit.\n\nThe latest stable releases are available [here](https://github.com/wolfSSL/wolfssl/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.8
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.7,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 0.5,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Gerald Doussot from NCC group",
    "workaround": "",
    "vendorFixDate": "2020-07-29T00:00:00.000Z",
    "vendorNotifiedDate": "2020-07-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2170",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-24613",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2170/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wolfSSL/wolfssl//commit/f59a1fa2954506ba5bde9548726614400f0ec9a0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wolfSSL/wolfssl/releases/tag/v4.5.0-stable",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wolfSSL/wolfssl/releases/tag/v4.5.0-stable",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://research.nccgroup.com/2020/08/24/technical-advisory-wolfssl-tls-1-3-client-man-in-the-middle-attack/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://research.nccgroup.com/2020/08/24/technical-advisory-wolfssl-tls-1-3-client-man-in-the-middle-attack/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2170/default-remediation-status"
            }
        ]
    }
}