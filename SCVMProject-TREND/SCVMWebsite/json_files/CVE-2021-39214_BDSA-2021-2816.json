{
    "source": "BDSA",
    "name": "BDSA-2021-2816",
    "title": "mitmproxy Vulnerable to Access Control and Sanitization Bypass via HTTP Request Smuggling",
    "description": "mitmproxy contains a flaw that allows HTTP request smuggling to occur from a malicious client or server. A remote attacker could leverage this to bypass intended sanitization or access controls.",
    "technicalDescription": "A malicious remote client or server is able to smuggle nested requests through mitmproxy via specially crafted HTTP headers. The smuggled requests are captured by mitmproxy, but do not go through the appropriate sanitization or access control routines that a user may have defined as part of various event hooks. This means that such requests could bypass any intended access control or sanitization.\n\n**Note** This only affects mitmproxy instances used to protect an HTTP/1 services.",
    "publishedDate": "2021-09-20T14:16:16.660Z",
    "updatedDate": "2021-09-20T14:16:16.648Z",
    "disclosureDate": "2021-09-16T00:00:00.000Z",
    "solution": "Fixed in version [**7.0.3**](https://github.com/mitmproxy/mitmproxy/releases/tag/v7.0.3) by [this](https://github.com/mitmproxy/mitmproxy/commit/9fed8ae554a3ba888cc2a9f20f6e8aaa8d8709e7) commit.\n\nThe latest releases can be found [here](https://github.com/mitmproxy/mitmproxy/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jo\u00e3o Sobral (@chinchila)",
    "workaround": "",
    "vendorFixDate": "2021-09-16T00:00:00.000Z",
    "vendorNotifiedDate": "2021-09-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2816",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-39214",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2816/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mitmproxy/mitmproxy/commit/9fed8ae554a3ba888cc2a9f20f6e8aaa8d8709e7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mitmproxy/mitmproxy/releases/tag/v7.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mitmproxy/mitmproxy/security/advisories/GHSA-22gh-3r9q-xf38",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mitmproxy/mitmproxy/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2816/default-remediation-status"
            }
        ]
    }
}