{
    "source": "BDSA",
    "name": "BDSA-2017-1157",
    "title": "Linux Kernel Allows Information Disclosure in Kernel Stack Dump and Kernel Address Space Layout Randomization Bypass",
    "description": "Linux kernel contains a vulnerability within its operand cache which results in a kernel stack dump. This allows local users to gain exposed information from the kernel memory and bypass the kernel's address-space layout randomization (KASLR) mechanism used to protect from memory corruption vulnerabilities.",
    "technicalDescription": "The Linux kernel does not properly flush operand cache which causes a kernel stack dump error.  This flaw exists in the function `acpi_ns_terminate`in file `drivers/acpi/acpica/nsutils.c`and can be exploited via a malicious crafted ACPI table.\n\nThis allows local users to gain exposed information from the kernel memory and bypass the kernel's address-space layout randomization (KASLR) mechanism used to protect from memory corruption vulnerabilities. \n\nThe vulnerable function is called to delete the namespace data and ACPI operand cache if an early abort occurs. However, the code to delete is only executed if the `ACPI_EXEC_APP` exists. If it does not exist, the ACPI operand cache is exposed and a stack error is shown within the kernel log.",
    "publishedDate": "2018-01-02T11:13:30.742Z",
    "updatedDate": "2020-04-21T11:06:44.796Z",
    "disclosureDate": "2017-02-22T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.114**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4c19b00e5588828f0d3198b926efade766dcf2c8) commit.\n* [**4.9.79**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2915f16bdce204621695e7a0dfcd5f73b120cccb) commit.\n* [**4.12-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3b2d69114fefa474fca542e51119036dceb4aa6f) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.7,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2017-02-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1157",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-209"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-358"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-11472",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1157/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2915f16bdce204621695e7a0dfcd5f73b120cccb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3b2d69114fefa474fca542e51119036dceb4aa6f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3b2d69114fefa474fca542e51119036dceb4aa6f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4c19b00e5588828f0d3198b926efade766dcf2c8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/torvalds/linux/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}