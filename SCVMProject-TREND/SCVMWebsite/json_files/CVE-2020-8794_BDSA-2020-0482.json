{
    "source": "BDSA",
    "name": "BDSA-2020-0482",
    "title": "OpenSMTPD Vulnerable to Remote Code Execution (RCE) via Out-Of-Bounds Read in 'mta_io' Function",
    "description": "OpenSMTPD is vulnerable to an out-of-bounds read issue via the `mta_io` function in `mta_session.c`. An attacker could exploit this vulnerability by injecting commands into the envelope file which would then be executed as root.",
    "technicalDescription": "This is exploitable via both client-side and server-side. On the client-side an attacker can use this exploit via remote attack using the default configuration, which allows users to accept mail from local users, but will deliver it to remote severs where it can be executed. On a server-side attack, an attacker can connect to the server and send mail that will create a bounce once connected back to the mail server. If a crash is successfully caused by the attacker, the malicious commands will be executed upon reboot.",
    "publishedDate": "2020-04-03T13:02:31.190Z",
    "updatedDate": "2020-04-03T13:02:31.182Z",
    "disclosureDate": "2020-02-24T00:00:00.000Z",
    "exploitPublishDate": "2020-02-24T00:00:00.000Z",
    "solution": "Fixed in version [**6.6.4p1**](https://github.com/OpenSMTPD/OpenSMTPD/releases/tag/6.6.4p1).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-02-24T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0482",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8794",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0482/ranges"
            },
            {
                "rel": "reference",
                "href": "https://ftp.openbsd.org/pub/OpenBSD/patches/6.6/common/021_smtpd_envelope.patch.sig",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenSMTPD/OpenSMTPD/releases/tag/6.6.4p1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/156534/QSA-CVE-2020-8794.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/48185",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/48185",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.openbsd.org/errata66.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/02/26/1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/03/01/1",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0482/default-remediation-status"
            }
        ]
    }
}