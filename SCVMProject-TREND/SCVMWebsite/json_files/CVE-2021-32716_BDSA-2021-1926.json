{
    "source": "BDSA",
    "name": "BDSA-2021-1926",
    "title": "Shopware Vulnerable to Information Exposure via Improper Administrative API Implementation",
    "description": "Shopware is vulnerable to information exposure due to the the unsafe implementation of an administrative API. An attacker could use the API in order to obtain the contents of hidden internal fields.",
    "technicalDescription": "The script `Core/Framework/Api/Serializer/JsonEntityEncoder.php` contains code which calls the function `removeNotAllowedFields()` in order to prevent sensitive internal fields from being disclosed to clients. One of the arguments to this function is obtained by calling `$field->getReferenceDefinition()`, where `$field` will be an instance of either the `ManyToManyAssociationField` class or the  `OneToManyAssociationField` class. \n\nThe function `getReferenceDefinition()` is implemented within the `AssociationField` class, which is the base class for both `ManyToManyAssociationField` and `OneToManyAssociationField`. This will return a reference to the object's `referenceDefinition` member. However, if `$field` is an instance of the `ManyToManyAssociationField` class, then the object's `toManyDefinition` member should be used instead.\n\nThe `referenceDefinition` member of the object being used instead of the `toManyDefinition` member will cause the data to be incorrectly sanitized by `removeNotAllowedFields()`. As a result of this, the data that is sent to the client will still contain internal fields which should not be exposed to users.",
    "publishedDate": "2021-06-28T15:02:50.938Z",
    "updatedDate": "2021-06-28T15:02:50.923Z",
    "disclosureDate": "2021-06-24T00:00:00.000Z",
    "solution": "Fixed in [**6.4.1.1**](https://github.com/shopware/platform/releases/tag/v6.4.1.1) by [this](https://github.com/shopware/platform/commit/d5c59fbdc9d157a69d46a53b3e43616018a62be4) commit.\n\nThe latest stable releases are available [here](https://github.com/shopware/platform/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The Shopware security plugin can be used if an upgrade cannot be performed. The security plugin can be found [here](https://store.shopware.com/en/detail/index/sArticle/518463/number/Swag136939272659).",
    "vendorFixDate": "2021-06-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1926",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32716",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1926/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/commit/d5c59fbdc9d157a69d46a53b3e43616018a62be4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/releases/tag/v6.4.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/security/advisories/GHSA-gpmh-g94g-qrhr",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/shopware/platform/security/advisories/GHSA-gpmh-g94g-qrhr",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://store.shopware.com/en/detail/index/sArticle/518463/number/Swag136939272659",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1926/default-remediation-status"
            }
        ]
    }
}