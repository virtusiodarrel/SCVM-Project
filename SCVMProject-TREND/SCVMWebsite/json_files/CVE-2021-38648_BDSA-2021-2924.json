{
    "source": "BDSA",
    "name": "BDSA-2021-2924",
    "title": "Microsoft Open Management Infrastructure Vulnerable to Elevation of Privilege",
    "description": "Microsoft Open Management Infrastructure is vulnerable to elevation of privilege. \n\nVMS that use the following management extensions are all impacted:\nLog Analytics Agent (On Premises)\nLog Analytics Agent (Cloud)\nAzure Diagnostics (LAD) (Cloud)\nAzure Automation Update Management (Cloud)\nAzure Automation Update Management (On Premises)\nAzure Automation (Cloud)\nAzure Automation (On Premises)\nAzure Security Center (Cloud)\nAzure Sentinel (Cloud)\nContainer Monitoring Solution (Cloud)\nAzure Stack Hub (On Premises)\nAzure HDInsight (Cloud)\n\nAzure subscriptions can be scanned for vulnerable VMs using the script [here](https://github.com/microsoft/OMS-Agent-for-Linux/tree/master/tools/OMIcheck). The script can also be used to patch the affected VMs using the `upgradeOMI` parameter.\n\n**Note:** that this is a separate issue from CVE-2021-38649 and CVE-2021-38645.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "The vendor has provided the following advice for detecting whether or not the vulnerability has been exploited:\n\n> An attacker that leverages these vulnerabilities to execute commands remotely will have commands run by the SCXcore service. The SCXcore provider runs on AIX **6.1** and later, HP/UX **11.31** and later, Solaris 5.10 and later, and most versions of Linux as far back as RedHat **5.0**, SuSE **10.1**, and Debian **5.0**. SCX has a `RunAsProvider` named `ExecuteShellCommand`. The `ExecuteShellCommand` `RunAsProvider` will execute any UNIX/Linux command using the /bin/sh shell.\n> \n> If you have auditd enabled and are collecting execve logs, look for commands running from the working directory `/var/opt/microsoft/scx/tmp`. You can also enable logging for the SCXadmin tool. If you enable logging using the command: `/opt/microsoft/scx/bin/tools/scxadmin -log-set all verbose`, you will see the commands in the `/var/opt/microsoft/scx/log/scx.log`. To see the commands that are executing, grep for `Invoke_ExecuteShellCommand`.",
    "publishedDate": "2021-10-04T15:47:52.511Z",
    "updatedDate": "2022-05-06T11:23:20.161Z",
    "disclosureDate": "2021-09-14T00:00:00.000Z",
    "exploitPublishDate": "2021-09-14T00:00:00.000Z",
    "solution": "Fixed in [**1.6.8-1**](https://github.com/microsoft/omi/releases/tag/v1.6.8-1) by [this](https://github.com/microsoft/omi/commit/4ce2cf1cb0aa656b8eb934c5acc3f4d6a6796bfa) commit.\n\nThe latest stable releases can be found [here](https://github.com/microsoft/omi).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.3
        },
        "vector": "(AV:L/AC:M/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.2
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nir Ohfeld and Wiz.io Shir Tamari of Wiz.io",
    "workaround": "",
    "vendorFixDate": "2021-09-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2924",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-38648",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2924/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/microsoft/OMS-Agent-for-Linux/tree/master/tools/OMIcheck",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/microsoft/omi",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/microsoft/omi/commit/4ce2cf1cb0aa656b8eb934c5acc3f4d6a6796bfa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/microsoft/omi/releases/tag/v1.6.8-1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://msrc-blog.microsoft.com/2021/09/16/additional-guidance-regarding-omi-vulnerabilities-within-azure-vm-management-extensions/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-38648",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2924/default-remediation-status"
            }
        ]
    }
}