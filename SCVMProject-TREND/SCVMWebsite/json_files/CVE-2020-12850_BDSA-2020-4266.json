{
    "source": "BDSA",
    "name": "BDSA-2020-4266",
    "title": "Pydio Cells Vulnerable to Privilege Escalation via 'show-welcome-message' Script Modification",
    "description": "Pydio Cells contains a privilege escalation vulnerability because it allows a privileged attacker to modify the `show-welcome-message` script and execute malicious code on the server.",
    "technicalDescription": "Exploitation of this vulnerability requires the attacker to have the privileges of the `pydio` user. With these privileges, the attacker could modify the `/opt/pydio/bin/show-welcome-message` script and have it execute malicious code on the server. This script is specified as a part of `/etc/systemd/system/run-before-login-prompt.service`, specifically as a value for  the `ExecStart` variable. However, there's no corresponding entry for `User` that specifies which user privileges this script is supposed to run with. This leads to the script being run with root privileges. As demonstrated in the PoC, an attacker could obtain a reverse shell by modifying the `show-welcome-message` script and waiting for the system to be rebooted.",
    "publishedDate": "2021-03-15T15:02:17.616Z",
    "updatedDate": "2021-03-15T15:02:17.610Z",
    "disclosureDate": "2020-05-20T00:00:00.000Z",
    "exploitPublishDate": "2020-05-20T00:00:00.000Z",
    "solution": "Fixed in [**2.0.7**](https://github.com/pydio/cells/releases/tag/v2.0.7).\n\nThe latest stable releases are available [here](https://github.com/pydio/cells/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.3,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.6
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Iv\u00e1n Koiffman and Ramiro Molina from Core Security Consulting Services",
    "workaround": "",
    "vendorFixDate": "2020-05-26T00:00:00.000Z",
    "discoveryDate": "2020-04-07T00:00:00.000Z",
    "vendorNotifiedDate": "2020-04-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4266",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12850",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4266/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pydio/cells/releases/tag/v2.0.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pydio/cells/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.coresecurity.com/core-labs/advisories/pydio-cells-204-multiple-vulnerabilities",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.coresecurity.com/core-labs/advisories/pydio-cells-204-multiple-vulnerabilities",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4266/default-remediation-status"
            }
        ]
    }
}