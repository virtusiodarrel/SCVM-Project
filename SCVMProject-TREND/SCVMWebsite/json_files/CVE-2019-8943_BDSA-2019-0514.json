{
    "source": "BDSA",
    "name": "BDSA-2019-0514",
    "title": "WordPress Vulnerable to Path Traversal via Modified Post Meta in 'wp_crop_image' Function",
    "description": "The WordPress contains a path traversal vulnerability. This vulnerability allows a remote attacker with author privileges, to write files to any arbitrary location on the hosting server.\n\nThis vulnerability in conjunction with CVE-2019-8942 can lead to remote code execution (RCE).",
    "technicalDescription": "The path traversal vulnerability is due to a lack of validation or sanitization on user supplied file named in the `wp_crop_image()` function. \n\nOne main issue that allows path traversal to take place corresponds to the way Wordpress stores and references its image files.  A `meta_key` and `meta_value`, key value pair can be manipulated to contain any value for the corresponding key. E.g. The `_wp_attached_file` value can be modified to contain any file name. This has been fixed in versions **4.9.9** and **5.0.1**.  But this does not prevent path traversal.\n\nThe path traversal is possible due to the way Wordpress will attempt to download an image file from the server if it is not found locally during the `wp_crop_image()` call. By modifying the file name to be cropped to contain path traversal characters and multiple file extensions (`evil.jpg?/../../evil.jpg`) it is possible to write a file to an arbitrary location on the hosting server.",
    "publishedDate": "2019-02-25T13:39:51.219Z",
    "updatedDate": "2019-04-12T08:58:56.884Z",
    "disclosureDate": "2019-02-19T00:00:00.000Z",
    "exploitPublishDate": "2019-02-19T00:00:00.000Z",
    "solution": "Fixed in version [**5.1**](https://wordpress.org/download/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.3
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.0
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Simon Scannell",
    "workaround": "",
    "vendorFixDate": "2019-02-21T00:00:00.000Z",
    "vendorNotifiedDate": "2018-10-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0514",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-8943",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0514/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://wordpress.org/download/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46662",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0514/default-remediation-status"
            }
        ]
    }
}