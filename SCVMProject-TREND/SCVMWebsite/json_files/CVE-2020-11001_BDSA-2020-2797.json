{
    "source": "BDSA",
    "name": "BDSA-2020-2797",
    "title": "Wagtail Vulnerable to Cross-Site Scripting (XSS) via 'compare.py'",
    "description": "Wagtail has a cross-site scripting (XSS) vulnerability due to an absence of correct parameter input validation. A remote attacker could insert JavaScript code and steal a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "This vulnerability mainly exists in `wagtail/admin/compare.py`. This is particularly relevant to the page revision comparison view within the Wagtail admin interface. Because of lack of security measures, an attacker could inject malicious code within the page revision history which will then be executed within a victim user's browser when they view the page. The malicious code could be used to perform actions with the victim user's privileges.\n\n**Note** This vulnerability can only be exploited by an attacker who has access to an editor account for the Wagtail admin interface with limited privileges.",
    "publishedDate": "2020-10-16T09:54:43.967Z",
    "updatedDate": "2020-10-16T09:54:43.962Z",
    "disclosureDate": "2020-04-14T00:00:00.000Z",
    "solution": "Fixed in [**2.7.2**](https://github.com/wagtail/wagtail/releases/tag/v2.7.2) and [**2.8.1**](https://github.com/wagtail/wagtail/releases/tag/v2.8.1) by [this](https://github.com/wagtail/wagtail/commit/61045ceefea114c40ac4b680af58990dbe732389) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 1.7,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Vlad Gerasimenko",
    "workaround": "A workaround exists on [this](https://github.com/wagtail/wagtail/security/advisories/GHSA-v2wc-pfq2-5cm6) page for situations where upgrading to new versions is not possible.",
    "vendorFixDate": "2020-04-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2797",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-11001",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2797/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/commit/61045ceefea114c40ac4b680af58990dbe732389",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/releases/tag/v2.7.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/releases/tag/v2.8.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/security/advisories/GHSA-v2wc-pfq2-5cm6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wagtail/wagtail/security/advisories/GHSA-v2wc-pfq2-5cm6",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2797/default-remediation-status"
            }
        ]
    }
}