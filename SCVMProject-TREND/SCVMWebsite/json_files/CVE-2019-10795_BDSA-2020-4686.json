{
    "source": "BDSA",
    "name": "BDSA-2020-4686",
    "title": "undefsafe Vulnerable to Prototype Pollution via 'undefsafe' Function",
    "description": "undefsafe is vulnerable to prototype pollution due to insufficient restrictions being placed on object modification functionality. An attacker that is able to control the input to the `undefsafe()` function could leverage that function to modify the prototype of an object. The exact impact that the attacker can achieve will depend on how the object is used, but could potentially include cross-site scripting (XSS) and remote code execution (RCE).",
    "technicalDescription": "The `undefsafe()` function, of file `lib/undefsafe.js`, has the parameters `obj`, `path`, `value` and `__res`. `obj` is a reference to an object that is to be modified. The value of `path` is used to derive the value of the local variable `key`. The function will then proceed to set the `key` property of the object to `value`. The function performs insufficient validation on the property that is to be modified. This allows an attacker that can control the input to `undefsafe()` to perform prototype pollution attacks. The exact impact that the attacker can achieve will depend on how the object is used, but can include cross-site scripting (XSS) and remote code execution (RCE).\n\nThe vulnerability was fixed by ensuring that `key` is a property that directly belongs to the object that is being modified.",
    "publishedDate": "2021-11-18T11:26:36.478Z",
    "updatedDate": "2021-11-18T11:26:35.815Z",
    "disclosureDate": "2020-02-18T00:00:00.000Z",
    "exploitPublishDate": "2020-02-18T00:00:00.000Z",
    "solution": "Fixed in version [**2.0.3**](https://github.com/remy/undefsafe/releases/tag/v2.0.3) by [this](https://github.com/remy/undefsafe/commit/f272681b3a50e2c4cbb6a8533795e1453382c822) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/undefsafe).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "JHU System Security Lab",
    "workaround": "",
    "vendorFixDate": "2020-02-17T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4686",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-915"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10795",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4686/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/remy/undefsafe/commit/f272681b3a50e2c4cbb6a8533795e1453382c822",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/remy/undefsafe/releases/tag/v2.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-UNDEFSAFE-548940",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-UNDEFSAFE-548940",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/undefsafe",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4686/default-remediation-status"
            }
        ]
    }
}