{
    "source": "BDSA",
    "name": "BDSA-2019-3886",
    "title": "XMLSecLibs Vulnerable to XML External Entities (XXE) via Crafted XML files",
    "description": "An XML external entities (XXE) Vulnerability has been discovered in XMLSecLibs. An attacker could include his own message in a signed XML document and have it validated as signed without having access to the signing key.\n\nAn identity provider library called SimpleSAMLphp is also vulnerable to this as it relies on proper implementation of XMLSecLibs. An attacker with an account on identity provider service that runs SimpleSAMLphp could spoof identities by providing a crafted XML document.",
    "technicalDescription": "XMLSecLibs keeps track of signed XML parts in `Reference` elements, which in turn are elements of `SignedInfo`, a signed collection of references. In order to perform signature verification, `XMLSecLibs` iterates over all `Reference` elements in `SignedInfo` by using an `XPath` query. The problem is that the `XPath` query returns references from all `SignedInfo` elements, but only validates the first one. This means that an attacker could modify original XML included in all but the first `SignedInfo` element's references and it would still pass the signature check. \n\nThis vulnerability was fixed by ensuring only a single `SignedInfo` element exists within a signature during verification.",
    "publishedDate": "2019-12-18T15:56:12.662Z",
    "updatedDate": "2019-12-18T15:56:12.644Z",
    "disclosureDate": "2019-11-06T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/robrichards/xmlseclibs/commit/0a53d3c3aa87564910cae4ed01416441d3ae0db5) commit in XMLSecLibs:\n\n* [**3.0.4**](https://github.com/robrichards/xmlseclibs/releases/tag/3.0.4)\n* [**2.1.1**](https://github.com/robrichards/xmlseclibs/releases/tag/2.1.1)\n* [**1.4.3**](https://github.com/robrichards/xmlseclibs/releases/tag/1.4.3)\n\nFixed in SimpleSAMLphp [**1.17.7**](https://github.com/simplesamlphp/simplesamlphp/releases/tag/v1.17.7) by [this](https://github.com/simplesamlphp/simplesamlphp/commit/66cceaa9045492c3e358218922cd89ba7cbc4602) commit and [**1.18.0-rc2**](https://github.com/simplesamlphp/simplesamlphp/tree/v1.18.0-rc2) by [this](https://github.com/simplesamlphp/simplesamlphp/commit/45e389eece45918a4331e5a5104b4694ba19c5db) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Juraj Somorovsky, Karsten Meyer zu Selhausen",
    "workaround": "",
    "vendorFixDate": "2019-11-05T00:00:00.000Z",
    "vendorNotifiedDate": "2019-10-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3886",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-611"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3465",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3886/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/robrichards/xmlseclibs/commit/0a53d3c3aa87564910cae4ed01416441d3ae0db5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/robrichards/xmlseclibs/releases/tag/1.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/robrichards/xmlseclibs/releases/tag/2.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/robrichards/xmlseclibs/releases/tag/3.0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/simplesamlphp/simplesamlphp/commit/45e389eece45918a4331e5a5104b4694ba19c5db",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/simplesamlphp/simplesamlphp/commit/66cceaa9045492c3e358218922cd89ba7cbc4602",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/simplesamlphp/simplesamlphp/releases/tag/v1.17.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/simplesamlphp/simplesamlphp/tree/v1.18.0-rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://simplesamlphp.org/security/201911-01",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.hackmanit.de/en/blog-en/82-xml-signature-validation-bypass-in-simplesamlphp-and-xmlseclibs",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3886/default-remediation-status"
            }
        ]
    }
}