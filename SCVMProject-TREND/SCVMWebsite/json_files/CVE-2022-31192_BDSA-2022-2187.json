{
    "source": "BDSA",
    "name": "BDSA-2022-2187",
    "title": "DSpace Vulnerable to Cross-Site Scripting (XSS) via Insufficient Sanitization in 'Request a Copy' Feature",
    "description": "DSpace is vulnerable to cross-site scripting (XSS) due to the insufficient sanitization of client-provided values within the \"Request a Copy\" feature. A remote attacker could execute malicious scripts within the browser of a victim by tricking that victim into interacting with maliciously crafted content. This could potentially allow the attacker to obtain sensitive information, such as cookies.\n\nThe vulnerability was fixed by introducing additional validation logic to the `processForm()` function of file `dspace-jspui/src/main/java/org/dspace/app/webui/servlet/RequestItemServlet.java`.",
    "technicalDescription": "",
    "publishedDate": "2022-08-05T15:07:32.604Z",
    "updatedDate": "2022-08-05T15:07:32.596Z",
    "disclosureDate": "2022-07-29T00:00:00.000Z",
    "solution": "Fixed in version [**6.4**](https://github.com/DSpace/DSpace/releases/tag/dspace-6.4) by [this](https://github.com/DSpace/DSpace/commit/503a6af57fd720c37b0d86c34de63baa5dd85819) commit, and in [**5.11**](https://github.com/DSpace/DSpace/releases/tag/dspace-5.11) by [this](https://github.com/DSpace/DSpace/commit/28eb8158210d41168a62ed5f9e044f754513bc37) commit.\n\nThe latest stable releases can be found [here](https://github.com/DSpace/DSpace/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrea Bollini (4Science)",
    "workaround": "The vendor has stated [here](https://github.com/DSpace/DSpace/security/advisories/GHSA-4wm8-c2vv-xrpq) that the following workaround can be implemented:\n\n> As a workaround, you can temporarily disable the \"Request a Copy\" feature by either commenting out the below configuration (or setting its value to empty):\n`# Comment out this default value`\n`# request.item.type = all`\n> Once your JSPUI site is patched, you can re-enable this setting. See https://wiki.lyrasis.org/display/DSDOC6x/Request+a+Copy for more information on this setting.",
    "vendorFixDate": "2022-07-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2187",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31192",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2187/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/commit/28eb8158210d41168a62ed5f9e044f754513bc37",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/commit/503a6af57fd720c37b0d86c34de63baa5dd85819",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/releases/tag/dspace-5.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/releases/tag/dspace-6.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/security/advisories/GHSA-4wm8-c2vv-xrpq",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/DSpace/DSpace/security/advisories/GHSA-4wm8-c2vv-xrpq",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://wiki.lyrasis.org/display/DSDOC6x/Request+a+Copy",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2187/default-remediation-status"
            }
        ]
    }
}