{
    "source": "BDSA",
    "name": "BDSA-2019-2064",
    "title": "Linux Kernel Vulnerable to Tracking via IP ID Values of Connectionless Protocols",
    "description": "The Linux kernel is vulnerable to leaking unique identifiers via connectionless protocols. A sufficiently advanced attacker, able to control approximately 400 Internet addresses, and several thousand computers in a cluster, could identify and track Linux based devices in under 100 seconds.",
    "technicalDescription": "The Linux kernel uses an algorithm for the IP ID counter that picks an index (bucket|) to a counter as a function of the source and destination IP address, the protocol, and a key that is initialized upon first IP transmission with random data.\n\nBy observing connectionless network traffic sent from a Linux host, by WebRTC (specifically the STUN protocol, available to attackers through web browsers and JavaScript) for example, it is possible to derive several values that form the key. This key will almost uniquely identify the device.\n\nThe attacker who wants to track the device or host will force the browser to rapidly emit UDP packets to each IP that it controls. The IP IDs can be collected from all IP addresses, and bucket collisions identified by looking for IP pairs whose IP IDs are sequentially close. As noted earlier, the choice of the bucket is a function of the source and destination IP addresses, and a device key. By enumerating over the key space to find the key which generates collisions for the same pairs for which collisions were observed, a device specific identifier will be available to track the device in the future.\n\nIf kernel address space layout randomisation (KASLR) is turned off the key space that an attacker has to search is is 32 bits on both x64 and ARM64 .  With KASLR turned on the keyspace is increased to 41 bits on x64 and 48 bits on ARM64. The reason the keyspace is increased is because 32bits of the address of a kernel networking subsystem structure is added to the key value. The leaking of these bits of a kernel address, as part of this attack, is  CVE-2019-10639 (BDSA-2019-2065) - a remote bypass of KASLR.\n\nThe tracking identifier (key) is refreshed on startup and does not survive a shutdown or reboot of the host/device.",
    "publishedDate": "2019-07-10T14:19:08.460Z",
    "updatedDate": "2019-09-09T09:29:16.043Z",
    "disclosureDate": "2019-06-25T00:00:00.000Z",
    "exploitPublishDate": "2019-06-25T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.16.72**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9ebeec41ed3f52fd94267f25f8b9bf3f4cbf1e4e) commit\n* [**4.4.191**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=66f8c5ff8ed3d99dd21d8f24aac89410de7a4a05) commit\n* [**4.9.190**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b97a2f3d58f439d11ececb2faa21dac775d63c5c) commit\n* [**4.14.124**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e10789acbe6a76b304f45cbc8bb77a926ae4f201) commit\n* [**4.19.48**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=07480da0c8a1979e0973d6dd783b6aed966dccf6) commit\n* [**5.0.21**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8d9b786e1124253738e992a845af24d9d95eac68) commit\n* [**5.1.7**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f2a11618d82a1ccb98a734b7d55f34f1ad404aac) commit\n* [**5.2-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=df453700e8d81b1bdafdf684365ee2b9431fb702) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Amit Klein, Benny Pinkas",
    "workaround": "",
    "vendorFixDate": "2019-03-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2064",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-326"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-331"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-10638",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2064/ranges"
            },
            {
                "rel": "reference",
                "href": "https://arxiv.org/pdf/1906.10478.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://arxiv.org/pdf/1906.10478.pdf",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=df453700e8d81b1bdafdf684365ee2b9431fb702",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}