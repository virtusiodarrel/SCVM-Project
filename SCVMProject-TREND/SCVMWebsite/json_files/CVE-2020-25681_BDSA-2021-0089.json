{
    "source": "BDSA",
    "name": "BDSA-2021-0089",
    "title": "Dnsmasq Vulnerable to Denial-of-Service (DoS) via Heap-Based Buffer Overflow in 'sort_rrset' Function",
    "description": "Dnsmasq is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause a victim's instance of the application to crash by tricking them into connecting to a malicious DNS server.",
    "technicalDescription": "This issue occurs in the `sort_rrset` function within the `src/dnssec.c` file due to improper initialization and comparison of `d`. An attacker on the same network could potentially forge DNS replies so that they are accepted as valid, in an attempt to cause an overflow and subsequent overflow.  It was mitigated by ensuring that the element is clearly defined and that it is subject to a proper comparison. \n\n**Note:** Per the vendor this issue affects any instance of dnsmasq with `DNSSEC` enabled.",
    "publishedDate": "2021-01-19T16:45:53.464Z",
    "updatedDate": "2021-01-27T11:30:17.653Z",
    "disclosureDate": "2021-01-19T00:00:00.000Z",
    "exploitPublishDate": "2021-01-19T00:00:00.000Z",
    "solution": "Fixed in [**2.83**](http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=tag;h=47b4f0e37558e7a947bbf1c5c41e6bc87f1c9ebb) by [this](http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=4e96a4be685c9e4445f6ee79ad0b36b9119b502a) commit.\n\nThe latest stable releases are available [here](http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Moshe Kol and Shlomi Oberman",
    "workaround": "The following Third Party mitigations have been proposed:\n\n*  Configure dnsmasq not to listen on WAN interfaces if unnecessary in your environment.\n* Reduce the maximum queries allowed to be forwarded with the option `--dns-forward-max=<queries>`. The default is 150, but it could be lowered.\n* Temporarily disable DNSSEC validation option until you get a patch.\n* Use protocols that provide transport security for DNS (such as DoT or DoH). This will mitigate Dnspooq but may have other security and privacy implications. Consider your own setup, security goals, and risks before doing this.\n* Reducing the maximum size of EDNS messages will likely mitigate some of the vulnerabilities. This, however, has not been tested and is against the recommendation of the relevant RFC5625",
    "vendorFixDate": "2020-11-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0089",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25681",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0089/ranges"
            },
            {
                "rel": "reference",
                "href": "http://lists.thekelleys.org.uk/pipermail/dnsmasq-discuss/2021q1/014599.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=4e96a4be685c9e4445f6ee79ad0b36b9119b502a",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=tag;h=47b4f0e37558e7a947bbf1c5c41e6bc87f1c9ebb",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ubuntu.com/security/notices/USN-4698-1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.jsof-tech.com/disclosures/dnspooq/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.jsof-tech.com/wp-content/uploads/2021/01/DNSpooq_Technical-Whitepaper.pdf",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.jsof-tech.com/wp-content/uploads/2021/01/DNSpooq_Technical-Whitepaper.pdf",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0089/default-remediation-status"
            }
        ]
    }
}