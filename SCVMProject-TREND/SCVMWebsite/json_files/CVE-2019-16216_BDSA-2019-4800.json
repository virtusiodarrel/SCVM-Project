{
    "source": "BDSA",
    "name": "BDSA-2019-4800",
    "title": "Zulip Server Vulnerable to Cross-Site Scripting (XSS) via MIME Type Validation Flaw",
    "description": "Zulip Server is vulnerable to cross-site scripting (XSS) due to how the file upload functionality does not sufficiently validate the MIME types of uploaded files.\n\nAn attacker could use this issue to upload malicious files containing scripts that can execute in a victim user's browser. These scripts could be used to steal session tokens, cookies or other sensitive information, or execute actions on the user's behalf.",
    "technicalDescription": "Zulip Server is vulnerable to cross-site scripting (XSS) because the file upload functionality can allow users to upload potentially dangerous file types that could contain malicious scripts as the MIME types of these files is not sufficiently validated.\n\nBrowsers that do not support `Content-Security-Policy` can be susceptible to scripts stored in  the uploaded files.\n\nThis issue primarily affects servers running Zulip's local file uploads backend for Ubuntu 16.04 Xenial or newer servers.\nIt has limited impact for the S3 upload backend, and the legecy local file upload backend for Ubuntu 14.04 Trusty is not affected.",
    "publishedDate": "2020-11-10T14:32:20.554Z",
    "updatedDate": "2020-11-10T14:32:20.546Z",
    "disclosureDate": "2019-09-11T00:00:00.000Z",
    "solution": "Fixed in [**2.0.5**](https://github.com/zulip/zulip/releases/tag/2.0.5) by [this](https://github.com/zulip/zulip/commit/1195841dfb9aa26b3b0dabc6f05d72e4af25be3e) commit.\n\nTHe latest stable releases are available [here](https://github.com/zulip/zulip/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-09-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4800",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-16216",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4800/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.zulip.com/2019/09/11/zulip-server-2-0-5-security-release/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zulip/zulip/commit/1195841dfb9aa26b3b0dabc6f05d72e4af25be3e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zulip/zulip/releases/tag/2.0.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4800/default-remediation-status"
            }
        ]
    }
}