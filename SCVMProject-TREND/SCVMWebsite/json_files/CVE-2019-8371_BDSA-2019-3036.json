{
    "source": "BDSA",
    "name": "BDSA-2019-3036",
    "title": "OpenEMR Allows Remote Code Execution (RCE) via Admin's File Editing Feature",
    "description": "OpenEMR is vulnerable to remote code execution (RCE) through file editing feature by the admin. This allows a malicious admin to upload a reverse shell PHP file and run OS commands on the server remotely.",
    "technicalDescription": "This vulnerability exists in the `./interface/super/manage_site_files.php` file and it allows uploading malicious PHP files in the OpenEMR web folder. A malicious superuser can run OS commands on the server as the `www-data` user. The vendor fixed the issue by simply commenting out this feature within the vulnerable file and it is up to the end user's decision to turn this feature back on at deployment.",
    "publishedDate": "2019-09-24T13:49:04.117Z",
    "updatedDate": "2019-09-24T13:49:04.110Z",
    "disclosureDate": "2019-09-10T00:00:00.000Z",
    "exploitPublishDate": "2019-09-10T00:00:00.000Z",
    "solution": "Fixed in [**5.0.2**](https://github.com/openemr/openemr/releases/tag/v5_0_2) by [this](https://github.com/openemr/openemr/commit/19eeccbf31) commit.\n\nThe latest releases can be found [here](https://www.open-emr.org/wiki/index.php/OpenEMR_Downloads).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Chris Davis",
    "workaround": "",
    "vendorFixDate": "2019-08-04T00:00:00.000Z",
    "discoveryDate": "2019-02-17T00:00:00.000Z",
    "vendorNotifiedDate": "2019-02-21T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3036",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-16"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-8371",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3036/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/commit/19eeccbf31",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/pull/2321",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/releases/tag/v5_0_2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://know.bishopfox.com/advisories/openemr-5-0-16-remote-code-execution-cross-site-scripting",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://know.bishopfox.com/advisories/openemr-5-0-16-remote-code-execution-cross-site-scripting",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.open-emr.org/wiki/index.php/OpenEMR_Downloads",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3036/default-remediation-status"
            }
        ]
    }
}