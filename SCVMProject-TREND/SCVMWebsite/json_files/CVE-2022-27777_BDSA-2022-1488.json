{
    "source": "BDSA",
    "name": "BDSA-2022-1488",
    "title": "Ruby on Rails Vulnerable to Cross-Site Scripting (XSS) via 'ActionView::Helpers' Component",
    "description": "Ruby on Rails has a cross-site scripting (XSS) vulnerability due to an absence of correct parameter input validation. A remote attacker could insert JavaScript code and steal a victim's session tokens, cookies, or other sensitive information.",
    "technicalDescription": "This vulnerability exists because the application does not correctly sanitize the tag attributes and tag names for tag helpers in `ActionView::Helpers::FormTagHelper` and `ActionView::Helpers::TagHelper`. This could allow an attacker to pass a malicious  payload like `img%20src=%22/nonexistent%22%20onerror=%22javascript_payload%22` as the hash key for tag attributes. This payload will execute within the context of a victim's browser and it could lead to theft of session tokens and cookies.\n\nThis issue was fixed by sanitizing the tag names and tag attributes by escaping any malicious characters in them.",
    "publishedDate": "2022-05-27T12:33:14.475Z",
    "updatedDate": "2022-05-27T12:34:37.816Z",
    "disclosureDate": "2022-04-27T00:00:00.000Z",
    "solution": "Fixed in:\n* **[5.2.7.1](https://github.com/rails/rails/releases/tag/v5.2.7.1)** by [this](https://github.com/rails/rails/commit/1278c0f0b4a18ea199f92b666b8b94954a74c20b) commit,\n* **[6.0.4.8](https://github.com/rails/rails/releases/tag/v6.0.4.8)** by [this](https://github.com/rails/rails/commit/36a6dad07d572a0098c29d6d96a226638a7caa38) commit,\n* **[6.1.5.1](https://github.com/rails/rails/releases/tag/v6.1.5.1)** by [this](https://github.com/rails/rails/commit/123f42a573f7fcbf391885c135ca809f21615180) commit,\n* **[7.0.2.4](https://github.com/rails/rails/releases/tag/v7.0.2.4)** by [this](https://github.com/rails/rails/commit/5c7dae5a410ff49fe4dcf30b97ee0f9148114b66) commit.\n\nThe latest stable releases can be found [here](https://github.com/rails/rails/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "\u00c1lvaro Mart\u00edn Fraguas",
    "workaround": "",
    "vendorFixDate": "2022-04-12T00:00:00.000Z",
    "vendorNotifiedDate": "2022-01-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1488",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-27777",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1488/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.rubyonrails.org/t/cve-2022-27777-possible-xss-vulnerability-in-action-view-tag-helpers/80534",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/123f42a573f7fcbf391885c135ca809f21615180",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/1278c0f0b4a18ea199f92b666b8b94954a74c20b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/36a6dad07d572a0098c29d6d96a226638a7caa38",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/5c7dae5a410ff49fe4dcf30b97ee0f9148114b66",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v5.2.7.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v6.0.4.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v6.1.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v7.0.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://research.nccgroup.com/2022/05/06/technical-advisory-ruby-on-rails-possible-xss-vulnerability-in-actionview-tag-helpers-cve-2022-27777/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1488/default-remediation-status"
            }
        ]
    }
}