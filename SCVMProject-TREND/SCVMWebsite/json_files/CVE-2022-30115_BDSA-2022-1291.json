{
    "source": "BDSA",
    "name": "BDSA-2022-1291",
    "title": "Curl Vulnerable to Information Exposure via Improper HTTP Strict Transport Security (HSTS) Implementation",
    "description": "Curl is vulnerable to information exposure due to the improper implementation of HTTP Strict Transport Security (HSTS) functionality. An attacker could exploit this vulnerability by leveraging host names that contain trailing dot characters. This will cause curl to transmit data via the cleartext HTTP protocol, instead of encrypting it via TLS.",
    "technicalDescription": "If there is a mismatch between the URL being processed by curl and that which is used in its HSTS cache, whereby one contains a trailing dot and the other doesn't, then curl's HSTS functionality can be bypassed. This is due to the existence of improper logic in the `hsts_create()` function of file `lib/hsts.c`. An attacker could potentially leverage this issue to cause curl to transmit data via the cleartext HTTP protocol, instead of encrypting it via TLS.",
    "publishedDate": "2022-05-10T13:56:37.366Z",
    "updatedDate": "2022-05-11T15:03:00.980Z",
    "disclosureDate": "2022-05-09T00:00:00.000Z",
    "solution": "Fixed in version [**7.83.1**](https://github.com/curl/curl/releases/tag/curl-7_83_1) by [this](https://github.com/curl/curl/commit/fae6fea209a2d4db1582f608bd8cc8000721733a) commit.\n\nThe latest stable releases are available [here](https://curl.se/download.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Axel Chong",
    "workaround": "The vendor has stated [here](https://curl.se/docs/CVE-2022-30115.html) that the following workaround can be implemented:\n\n> Stick to always using HTTPS:// in URLs",
    "vendorFixDate": "2022-05-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1291",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-319"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-30115",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1291/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2022-30115.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2022-30115.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/b27ad8e1d3e68eb3214fcbb398ca436873aa7c67",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/fae6fea209a2d4db1582f608bd8cc8000721733a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_83_1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1291/default-remediation-status"
            }
        ]
    }
}