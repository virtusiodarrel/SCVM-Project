{
    "source": "BDSA",
    "name": "BDSA-2021-1119",
    "title": "Magento LTS Vulnerable to Remote Code Execution via Insecure Deserialization for Zend Stream Wrapper",
    "description": "Magento LTS is vulnerable to remote code execution (RCE) due to the unsafe deserialization of objects. A remote attacker could execute arbitrary code on a vulnerable server by causing the HTTP stream wrapper parsing component to process a maliciously crafted serialized object.",
    "technicalDescription": "The file `lib/Zend/Http/Response/Stream.php` defines the class `Zend_Http_Response_Stream`, which inherits from the `Zend_Http_Response` class. The `__destruct()` method is defined within the `Zend_Http_Response_Stream` class, which invokes `unlink()` using the class's `stream_name` attribute. If a malicious value is used, then the chain of functions that are called during the instance destruction process can end up performing harmful actions, including the execution of malicious code. An attacker could therefore achieve remote code execution by causing a vulnerable endpoint to process a crafted serialized object.",
    "publishedDate": "2021-07-05T13:45:40.633Z",
    "updatedDate": "2022-04-20T10:48:37.771Z",
    "disclosureDate": "2021-04-20T00:00:00.000Z",
    "solution": "Fixed in [**20.0.9**](https://github.com/OpenMage/magento-lts/releases) and in [**19.4.13**](https://github.com/OpenMage/magento-lts/releases/tag/v19.4.13) by [this](https://github.com/OpenMage/magento-lts/commit/6b663bbce99d46823bec690fe7a186df2b855620) commit.\n\nThe latest stable releases are available [here](https://github.com/OpenMage/magento-lts/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-19T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1119",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21426",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1119/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenMage/magento-lts/commit/6b663bbce99d46823bec690fe7a186df2b855620",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenMage/magento-lts/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenMage/magento-lts/releases/tag/v19.4.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenMage/magento-lts/security/advisories/GHSA-m496-x567-f98c",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1119/default-remediation-status"
            }
        ]
    }
}