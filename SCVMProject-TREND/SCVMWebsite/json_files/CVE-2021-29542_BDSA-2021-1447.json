{
    "source": "BDSA",
    "name": "BDSA-2021-1447",
    "title": "TensorFlow Vulnerable to Denial-of-Service (DoS) via Heap-based Buffer Overflow in 'string_ngrams_op.cc' File",
    "description": "TensorFlow contains a heap-based buffer overflow vulnerability because of improper input validation. An attacker could exploit this flaw to cause a denial-of-service (DoS).",
    "technicalDescription": "This vulnerability exists in the `tensorflow/core/kernels/string_ngrams_op.cc` file. The `CreateNgrams()` method in this file does not properly validate the input against special cases. An attacker could supply an input that leads to the generated tokens only containing padding elements. In such cases, when `num_tokens` has the value 0, the attacker could get the `data_start_index` variable initialized with the value 0 in the following code: \n```\nint data_start_index = left_padding > 0 ? 0 : ngram_index - pad_width;\n```\n\nThis can happen because the attacker-supplied input only contains padding elements, thus leading to the condition `left_padding > 0` being evaluated to true. When both these variables have the value 0, this can lead to a heap-based buffer overflow at the following line of code `ngram->append(data[data_start_index + n]);` where the execution could start reading from the value `data[-1]`. The attacker could exploit this flaw locally to cause a denial-of-service. The vendor addressed this issue by introducing appropriate validation to handle such special cases.",
    "publishedDate": "2021-05-19T14:08:41.168Z",
    "updatedDate": "2022-08-05T08:53:41.521Z",
    "disclosureDate": "2021-05-13T00:00:00.000Z",
    "solution": "Fixed in:\n* **[2.1.4](https://github.com/tensorflow/tensorflow/releases/tag/v2.1.4)** by [this](https://github.com/tensorflow/tensorflow/commit/6c0c01094033b8d7233b52ce64933846107fcc4b) commit,\n* **[2.2.3](https://github.com/tensorflow/tensorflow/releases/tag/v2.2.3)** by [this](https://github.com/tensorflow/tensorflow/commit/6e22e75b1e05a4cb3eba91ddd8cf8f7786007d8c) commit,\n* **[2.3.3](https://github.com/tensorflow/tensorflow/releases/tag/v2.3.3)** by [this](https://github.com/tensorflow/tensorflow/commit/318910a5c6a9d3cf1347a9182998472578af93b1) commit,\n* **[2.4.2](https://github.com/tensorflow/tensorflow/releases/tag/v2.4.2)** by [this](https://github.com/tensorflow/tensorflow/commit/38477f349e4cad44801130b2385009c16e908586) commit,\n* **[2.5.0](https://github.com/tensorflow/tensorflow/releases/tag/v2.5.0)** by [this](https://github.com/tensorflow/tensorflow/commit/b9cc6d1746e0914b7efe9ba1a755e99ff5a9860d) commit.\n\nThe latest stable releases are available [here](https://github.com/tensorflow/tensorflow/tags).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Yakun Zhang and Ying Wang of Baidu X-Team",
    "workaround": "",
    "vendorFixDate": "2021-04-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1447",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29542",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1447/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/318910a5c6a9d3cf1347a9182998472578af93b1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/38477f349e4cad44801130b2385009c16e908586",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/6c0c01094033b8d7233b52ce64933846107fcc4b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/6e22e75b1e05a4cb3eba91ddd8cf8f7786007d8c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/b9cc6d1746e0914b7efe9ba1a755e99ff5a9860d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.1.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.2.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.3.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.4.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.5.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-4hrh-9vmp-2jgg",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1447/default-remediation-status"
            }
        ]
    }
}