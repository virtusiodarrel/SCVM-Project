{
    "source": "BDSA",
    "name": "BDSA-2022-1094",
    "title": "HashiCorp Consul Vulnerable to Server Side Request Forgery (SSRF) via HTTP Endpoints",
    "description": "HashiCorp Consul contains a server side request forgery (SSRF) vulnerability. An attacker could exploit this issue by accessing an HTTP endpoint using the health check functionality. This may allow for an attacker to return an HTTP redirect at the endpoint, allowing for users following the endpoint to be externally redirected.",
    "technicalDescription": "This issue was mitigated by including a `disable_redirects` option in Consul's `HTTP + Interval health check configuration`, which prohibits the use of redirects. The `disable_redirects` option is by default set to `false`, and should be set to `true` for mitigation of this issue.",
    "publishedDate": "2022-04-20T16:14:24.772Z",
    "updatedDate": "2022-04-20T16:14:24.756Z",
    "disclosureDate": "2022-04-15T00:00:00.000Z",
    "solution": "Fixed in version:\n\n* [**1.9.17**](https://github.com/hashicorp/consul/releases/tag/v1.9.17) by [this](https://github.com/hashicorp/consul/commit/0e5545580ec92fb4c3d177d16bb1d699edf4d23f) commit.\n* [**1.10.10**](https://github.com/hashicorp/consul/releases/tag/v1.10.10) by [this](https://github.com/hashicorp/consul/commit/09db19a9977595b187ebf8ff295fefd661e864f5) commit.\n* [**1.11.5**](https://github.com/hashicorp/consul/releases/tag/v1.11.5) by [this](https://github.com/hashicorp/consul/commit/a24a8d07a41b9b9d396468f5d78625dfa25b230a) commit.\n\nThe latest stable releases can be found [here](https://github.com/hashicorp/consul/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Offensive Security Research Unit",
    "workaround": "",
    "vendorFixDate": "2022-04-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1094",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-29153",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1094/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.hashicorp.com/t/hcsec-2022-10-consul-s-http-health-check-may-allow-server-side-request-forgery/38393",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/09db19a9977595b187ebf8ff295fefd661e864f5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/0e5545580ec92fb4c3d177d16bb1d699edf4d23f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/a24a8d07a41b9b9d396468f5d78625dfa25b230a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.10.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.11.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.9.17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1094/default-remediation-status"
            }
        ]
    }
}