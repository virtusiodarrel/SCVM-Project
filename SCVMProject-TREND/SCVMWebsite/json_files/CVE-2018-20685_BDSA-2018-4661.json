{
    "source": "BDSA",
    "name": "BDSA-2018-4661",
    "title": "OpenSSH Vulnerable to Access Restriction Bypass via Improper Directory Name Validation",
    "description": "OpenSSH contains an access restriction bypass type vulnerability.  This may allow an attacker to use the \"secure copy\" (`scp`) command to modify the permissions of directories.",
    "technicalDescription": "The access restriction bypass occurs in the `sink` function in `scp.c`.   An insufficient check on filenames is performed during a \"secure copy\" (`scp`) that allows a local attacker to change the permissions on directories that may be restricted to users with higher privileges.\n\nThis is due to an invalid check on the user supplied directory name.  By supplying the string `D0777 0 \\n` or `D0777 0 .\\n` as a target directory name, will result in the modification of privileges.",
    "publishedDate": "2019-01-11T17:02:10.787Z",
    "updatedDate": "2019-01-18T16:50:59.760Z",
    "disclosureDate": "2018-11-16T00:00:00.000Z",
    "solution": "Fixed in revision [**7.9**](https://www.openssh.com/ftp.html) by [this](https://github.com/openbsd/src/commit/4667d15cf6214d4cb6b8c347f13864ca8c72002e) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Harry Sintonen",
    "workaround": "",
    "vendorFixDate": "2018-11-16T00:00:00.000Z",
    "discoveryDate": "2018-08-08T00:00:00.000Z",
    "vendorNotifiedDate": "2018-08-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4661",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-20685",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4661/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/scp.c.diff?f=h&r1=text&tr1=1.198&r2=text&tr2=1.197",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openbsd/src/commit/4667d15cf6214d4cb6b8c347f13864ca8c72002e",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openbsd/src/commit/4667d15cf6214d4cb6b8c347f13864ca8c72002e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://sintonen.fi/advisories/scp-client-multiple-vulnerabilities.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openssh.com/ftp.html",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}