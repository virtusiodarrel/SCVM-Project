{
    "source": "BDSA",
    "name": "BDSA-2020-1281",
    "title": "Kubernetes Clusters Vulnerable to Man-in-the-Middle (MitM) Attacks via Rogue Router Advertisements",
    "description": "It was discovered that Kubernetes IPv4 only clusters were vulnerable to man-in-the-middle (MitM) attacks via IPv6 rogue router advertisements. An attacker who is able to create containers with `CAP_NET_RAW` privileges on an affected cluster could exploit this vulnerability to intercept traffic from other containers or from the host.",
    "technicalDescription": "An attacker able to create containers with `CAP_NET_RAW` privileges on an affected cluster could exploit this flaw by sending rogue router advertisements using a malicious container. This could allow the attacker to reconfigure the host to redirect IPv6 traffic from the host to the attacker-controlled container. Causing HTTP libraries to try and connect via IPv6 regardless whether there was any IPv6 traffic before, if the DNS returns A (IPv4) and AAAA (IPv6) records first, then fallback to IPv4 records, this creates an opportunity for the attacker to intercept and respond.\n\n**Note:** Whilst Kubernetes itself is not considered vulnerable, a Kubernetes cluster that employs an affected networking implementation is vulnerable.\n\n**Note:** Cluster administrators using packages from the Kubernetes repositories may choose to manually upgrade CNI plugins by retrieving the relevant arch tarball from the containernetworking/plugins v0.8.6 release.",
    "publishedDate": "2020-06-02T15:18:43.854Z",
    "updatedDate": "2021-11-08T10:00:01.784Z",
    "disclosureDate": "2020-05-27T00:00:00.000Z",
    "exploitPublishDate": "2020-06-01T00:00:00.000Z",
    "solution": "Fixed in:\n* **[v1.16.11](https://github.com/kubernetes/kubernetes/releases/tag/v1.16.11)** by [this](https://github.com/kubernetes/kubernetes/commit/a64f8e53526) commit.\n* **[v1.17.7](https://github.com/kubernetes/kubernetes/releases/tag/v1.17.7)** by [this](https://github.com/kubernetes/kubernetes/commit/126b5bba2c6) commit.\n* **[v1.18.4](https://github.com/kubernetes/kubernetes/releases/tag/v1.18.4)** by [this](https://github.com/kubernetes/kubernetes/commit/028c40a4cd6) commit.\n* **[v1.19.0-beta.1](https://github.com/kubernetes/kubernetes/releases/tag/v1.19.0-beta.1)** by [this](https://github.com/kubernetes/kubernetes/commit/b692502a9d5) commit.\n\nThe latest releases can be found [here](https://github.com/kubernetes/kubernetes/releases/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.0,
        "impactSubscore": 3.7,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Etienne Champetier",
    "workaround": "Set the host default to reject router advertisements. This should prevent attacks from succeeding, but may break legitimate traffic, depending upon the networking implementation and the network where the cluster is running. \n\nTo change this setting:\n\n* set the sysctl net.ipv6.conf.all.accept_ra to 0.\n* Use TLS with proper certificate validation    \n* Disallow CAP_NET_RAW for untrusted workloads or users. \n\nFor example, a Pod Security Policy with a `RequiredDropCapabilities` that includes `NET_RAW` will prevent this attack for controlled workloads.",
    "vendorFixDate": "2020-05-26T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1281",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10749",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1281/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.champtar.fr/IPv6_RA_MITM/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.champtar.fr/IPv6_RA_MITM/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/issues/91507",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/issues/91507",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/pull/91370/commits/b692502a9d55105ca412eb4f619b74b41fa01225",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kubernetes/kubernetes/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1281/default-remediation-status"
            }
        ]
    }
}