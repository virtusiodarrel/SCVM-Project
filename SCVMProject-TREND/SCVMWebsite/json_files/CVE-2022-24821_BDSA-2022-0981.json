{
    "source": "BDSA",
    "name": "BDSA-2022-0981",
    "title": "XWiki Vulnerable to Privilege Escalation via Improper Access Control in 'AbstractDocumentSkinExtensionPlugin.java' File",
    "description": "XWiki contains a privilege escalation vulnerability. This vulnerability can allow an authenticated attacker to escalate their privileges from \"Standard\" to \"Programming Rights\", which will allow them to edit a document that has content which is controlled by a user who correctly possesses \"Programming Rights\" privileges.",
    "technicalDescription": "The vulnerability exists in the `AbstractDocumentSkinExtensionPlugin.java` file within the `virtualInit()` and `onDocumentEvent()` functions. When an \"always used\" `Skinx` extension is added, the Programming Rights permissions is checked against the content of the document rather than against the author. This means a document that should only be edited by users with \"Programming Rights\" privileges can also be edited by standard users. This could allow an attacker to escalate their privileges to \"Programming Rights\" and obtain sensitive information within documents.\n\nThis has been mitigated by checking permissions against the author instead of the content of the document.",
    "publishedDate": "2022-04-11T16:10:45.687Z",
    "updatedDate": "2022-04-11T16:10:45.675Z",
    "disclosureDate": "2022-04-08T00:00:00.000Z",
    "exploitPublishDate": "2022-04-08T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**12.10.11**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.10.11) by [this](https://github.com/xwiki/xwiki-platform/commit/a76d9bb5f932ccdd8f60a93226efe9242585c68b) commit.\n* [**13.4.6**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.4.6) by [this](https://github.com/xwiki/xwiki-platform/commit/6444fdd4d865ca21e2ae41ac33574da00a30a6bf) commit.\n* [**13.10-rc1**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.10-rc-1) by [this](https://github.com/xwiki/xwiki-platform/commit/b95a1c3d1291e1d7f758ebfb524776def2e50cd0) commit.\n\nThe latest stable releases can be found [here](https://github.com/xwiki/xwiki-platform/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Simon Urli",
    "workaround": "",
    "vendorFixDate": "2021-11-19T00:00:00.000Z",
    "vendorNotifiedDate": "2021-11-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0981",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-648"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24821",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0981/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/6444fdd4d865ca21e2ae41ac33574da00a30a6bf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/a76d9bb5f932ccdd8f60a93226efe9242585c68b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/b95a1c3d1291e1d7f758ebfb524776def2e50cd0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.10.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.10-rc-1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.4.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-ghcq-472w-vf4h",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://jira.xwiki.org/browse/XWIKI-19155",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://jira.xwiki.org/browse/XWIKI-19155",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0981/default-remediation-status"
            }
        ]
    }
}