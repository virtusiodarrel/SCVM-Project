{
    "source": "BDSA",
    "name": "BDSA-2020-3897",
    "title": "imcat Vulnerable to Remote Code Execution (RCE) via Authenticated Unrestricted File Upload",
    "description": "imcat is vulnerable to remote code execution (RCE) via authenticated unrestricted file upload using the picture upload functionality. Super administrator privileges are required in order to exploit this issue. An attacker could exploit this flaw by uploading malicious files which could lead to arbitrary code execution.",
    "technicalDescription": "This issue exists in the `saveRemote`, `getStateInfo`, and `getFileName` function within the `imcat/core/clib/comUpload.php` file. It occurs due to insufficient file restrictions relating to the picture upload functionality. It can be exploited by appending ` .jpg ` to the end of the actual file type in order to bypass filtering. It was mitigated by the addition of checks such as a RegEx comparison and a more thorough file name check. There was also a flag added to prevent appending `.jpg` to file names.",
    "publishedDate": "2020-12-24T12:12:50.151Z",
    "updatedDate": "2020-12-24T12:12:50.144Z",
    "disclosureDate": "2020-06-02T00:00:00.000Z",
    "exploitPublishDate": "2020-06-02T00:00:00.000Z",
    "solution": "Fixed in [**5.3**](https://github.com/peacexie/imcat/releases/tag/v5.3) by [this](https://github.com/peacexie/imcat/commit/870754111fb85f95306dd738b9821919db689ee2) commit. \n\nThe latest stable releases are available [here](https://github.com/peacexie/imcat/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "leommxj from Chaitin Security Research Lab",
    "workaround": "",
    "vendorFixDate": "2020-10-09T00:00:00.000Z",
    "vendorNotifiedDate": "2020-06-02T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3897",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-23520",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3897/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/peacexie/imcat/commit/870754111fb85f95306dd738b9821919db689ee2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/peacexie/imcat/issues/4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/peacexie/imcat/issues/4",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/peacexie/imcat/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/peacexie/imcat/releases/tag/v5.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/peacexie/imcat/security/advisories/GHSA-xmr5-p3hg-222j",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3897/default-remediation-status"
            }
        ]
    }
}