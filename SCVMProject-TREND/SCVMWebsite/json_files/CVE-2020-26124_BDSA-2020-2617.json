{
    "source": "BDSA",
    "name": "BDSA-2020-2617",
    "title": "OpenMediaVault Vulnerable to Remote Code Execution (RCE) via PHP Code Injection in 'sortfield' Parameter",
    "description": "OpenMediaVault is vulnerable to a remote code execution (RCE) issue due to how a user-supplied parameter value can be manipulated during a POST request in order to execute arbitrary PHP code on the system. \n\nThis issue could be abused by an authenticated attacker by injecting malicious PHP code via the affected parameter which could result in a complete takeover of the underlying operating system.",
    "technicalDescription": "OpenMediaVault is vulnerable to remote code execution (RCE) because the `sortfield` parameter of the ` json_encode_safe()` function in the `rpc.php` file is unsafely evaluated by a code interpreter. Since the process is running with root privileges, unauthorized actions will also be executed with root privileges which can worsen the impact of any attacker executed code.\n\n**Note**: In the reporter's advisory [here](https://www.obrela.com/openmediavault-remote-code-execution-rce-vulnerability/), they have stated that this vulnerability can be considered 'blind', as in it is not feasible for an attacker to retrieve any output from executed commands directly. Time-based attacks are also ineffective due to how the application hangs after executing any command. It was instead demonstrated that an attacker could make use of Out-Of-Band (OOB) techniques in order to retrieve output.",
    "publishedDate": "2020-10-05T14:42:08.424Z",
    "updatedDate": "2021-12-07T09:54:48.983Z",
    "disclosureDate": "2020-09-28T00:00:00.000Z",
    "exploitPublishDate": "2020-11-04T00:00:00.000Z",
    "solution": "Fixed in:\n* **3.0.100** by [this](https://github.com/openmediavault/openmediavault/commit/691929893032522b036fd0b99a0f391718e5a593) commit,\n* **4.1.36** by [this](https://github.com/openmediavault/openmediavault/commit/6829535adb8d9d90497cba26fa6a1d4bfa22d590) commit,\n* **5.5.12** by [this](https://github.com/openmediavault/openmediavault/commit/bb67b41e837add2270e123b479201d5c2923d21a) commit.\n\nDownloads for these releases are not yet publicly available.\n\nThe latest releases are available [here](https://www.openmediavault.org/?page_id=77).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Anastasios Stasinopoulos (Obrela Labs Team)",
    "workaround": "",
    "vendorFixDate": "2020-09-26T00:00:00.000Z",
    "vendorNotifiedDate": "2020-09-26T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2617",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-26124",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2617/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openmediavault/openmediavault/commit/6829535adb8d9d90497cba26fa6a1d4bfa22d590",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openmediavault/openmediavault/commit/691929893032522b036fd0b99a0f391718e5a593",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openmediavault/openmediavault/commit/bb67b41e837add2270e123b479201d5c2923d21a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/160223/openmediavault_rpc_rce.rb.txt",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.obrela.com/openmediavault-remote-code-execution-rce-vulnerability/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.obrela.com/openmediavault-remote-code-execution-rce-vulnerability/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.openmediavault.org/?p=2797",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openmediavault.org/?page_id=77",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2617/default-remediation-status"
            }
        ]
    }
}