{
    "source": "BDSA",
    "name": "BDSA-2021-4614",
    "title": "Apache Ozone Vulnerable to Authorization Bypass via Incorrect Check for Dropped Privileges in 'getProtobuf' Function",
    "description": "Apache Ozone is vulnerable to authorization bypass due to a missing permission check on keys. An authenticated attacker could leverage this flaw to retrieve tokens that are persisted to the metadata database even if their permissions to use the key have been revoked.",
    "technicalDescription": "This vulnerability exists within the `hadoop-ozone/common/src/main/java/org/apache/hadoop/ozone/om/helpers/OmKeyLocationInfo.java` file in the `getProtobuf` function as it stores unnecessary block tokens in the OM database.\n\nThis has been mitigated by refactoring the code in the same file to prevent the storage of block tokens which are not needed.",
    "publishedDate": "2022-09-13T14:29:09.212Z",
    "updatedDate": "2022-09-21T13:06:56.566Z",
    "disclosureDate": "2021-11-18T00:00:00.000Z",
    "solution": "Fixed in version [**1.2.0RC0**](https://github.com/apache/ozone/releases/tag/ozone-1.2.0-RC0) by [this](https://github.com/apache/ozone/commit/6e6aefe278073b6eac887f31cf0147bc457ba37c) commit.\n\nThe latest stable releases can be found [here](https://ozone.apache.org/downloads/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Marton Elek",
    "workaround": "",
    "vendorFixDate": "2021-06-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4614",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-273"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-36372",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4614/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ozone/commit/6e6aefe278073b6eac887f31cf0147bc457ba37c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ozone/commit/a6c4d7e6e9cd80ac30ee04643b5cf79f78638649",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ozone/releases/tag/ozone-1.2.0-RC0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/HDDS-5315",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/tft5sknt6yz289npv7vwmlfyzsznz78z",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ozone.apache.org/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4614/default-remediation-status"
            }
        ]
    }
}