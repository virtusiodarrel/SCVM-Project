{
    "source": "BDSA",
    "name": "BDSA-2019-3868",
    "title": "Xen Vulnerable to Privilege Escalation via \"Alternate\" PCI Passthrough Assignment",
    "description": "Xen contains a privilege escalation vulnerability.  This allows an attacker with a guest machine on the the same physical system as the host to gain direct memory access (DMA) to host memory.",
    "technicalDescription": "The privilege escalation vulnerability is due an incomplete fix for CVE-2019-18424.  The previous fix was to ensure the use of libxl's `assignable-add` feature was used to prepare devices being assigned to untrusted guests.\n\nThe vulnerability still persists due to Xen allowing alternate methods for preparing devices for PCI passthrough assignment, including the libvirt library using its own method.\n\nThis causes hosts using alternate methods to still enter a vulnerable state when devices are returned from the guest. \n\nNote:\n\nOnly systems where guests are given direct access to physical devices capable of DMA (PCI pass-through) are vulnerable.\n\nOnly systems which use alternate methods to assign devices to pciback before assignment are vulnerable.  These methods include:\n\n*  Assigning devices on the Linux command-line using `xen-pciback.hide`.\n*  Assigning devices via `xen-pciback` module parameters.\n*  Assigning devices manually via `sysfs`.\n*  Assigning devices using libvirt.",
    "publishedDate": "2019-12-16T17:28:46.437Z",
    "updatedDate": "2019-12-16T17:28:46.428Z",
    "disclosureDate": "2019-11-26T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* [**4.11.3**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1d6777df453eae5fbc9d58cb1139b2ebcdae4a09) commit.\n* [**4.13.0-rc2**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ba2ab00bbb8c74e311a252d816d68dee47c779a0) commit.\n\nFixed in the following branches which have not yet been included in any release:\n* **4.10.x** by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e4899550ff7834e1ea5dfbbfb1c618f64e247761) commit.\n* **4.9.x** by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e60b3a92f74d88039c358631185cb84f3b5a39b4) commit.\n* **4.8.x** by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ec6c25e4674880617747e0a6cd8e742004af7c08) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "(AV:L/AC:H/Au:N/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Marek Marczykowski-G\u00f3recki",
    "workaround": "For hosts using the xl and libvirt libraries for assignment, before assigning a device to a guest, manually run `xl pci-assignable-add`.  This will quarantine the device even if the device has already been assigned to pciback by one of the alternate methods.  This may also work for other libxl based toolstacks, depending on the particular implementation.",
    "vendorFixDate": "2019-11-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3868",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19579",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3868/ranges"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-306.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=1d6777df453eae5fbc9d58cb1139b2ebcdae4a09",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ba2ab00bbb8c74e311a252d816d68dee47c779a0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e4899550ff7834e1ea5dfbbfb1c618f64e247761",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=e60b3a92f74d88039c358631185cb84f3b5a39b4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=ec6c25e4674880617747e0a6cd8e742004af7c08",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3868/default-remediation-status"
            }
        ]
    }
}