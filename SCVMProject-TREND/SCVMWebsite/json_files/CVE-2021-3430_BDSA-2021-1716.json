{
    "source": "BDSA",
    "name": "BDSA-2021-1716",
    "title": "Zephyr OS Bluetooth LE Controller Vulnerable to Denial of Service via Reachable Assertion",
    "description": "Synopsys Cybersecurity Research Center  (CyRC) has discovered that Zephyr's Bluetooth Low Energy Controller (LE Link Layer) is vulnerable to denial-of-service (DoS) when targeted  with repeat `LL_CONNECTION_PARAM_REQ` packets.\n\nTriggering this vulnerability does not require authentication or encryption. The only requirement is that the device is in advertising mode and accepting connections, and that the attacker is within range of the Bluetooth device.",
    "technicalDescription": "Assertion failure occurs in `ctrl_rx()` function in `ull_conn.c` file because the implementation does not allow two Connection Parameters Request procedures to be initiated by central device at the same time.  This is correct behavior from specification point of view, however due to lack of error handling the implementation  results in an assertion failure exception.\n\nAn attacker is able to disrupt all the ongoing communication and cause a denial-of-service (DoS)  by sending repeated `LL_CONNECTION_PARAM_REQ` packets  to any Zephyr based Bluetooth LE device which is advertising and open to connection. If assertions are enabled this will result in an assertion failure exception and system crash. \n\nNote that this vulnerability does not occur If assertions are disabled. This issue was resolved by replacing the assert with comment and marking the buffer ready for release.",
    "publishedDate": "2021-06-22T13:31:34.808Z",
    "updatedDate": "2021-06-22T13:31:34.803Z",
    "disclosureDate": "2021-06-10T00:00:00.000Z",
    "solution": "Fixed in [**2.6.0-rc1**](https://github.com/zephyrproject-rtos/zephyr/tree/v2.6.0-rc1) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/dec6140685b49e5478147962b36abd18b60f574c) commit.\nFix backported to [**1.14-branch**](https://github.com/zephyrproject-rtos/zephyr/tree/v1.14-branch) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/c1af0c226f2f921f8fa73d1a99351afb11975bd3) commit.\nFix backported to [**2.5-branch**]((https://github.com/zephyrproject-rtos/zephyr/tree/v2.5-branch) with [this](https://github.com/zephyrproject-rtos/zephyr/commit/860bb75a6974dd2436d54923902c158a3cc960c6) commit.\nThe most recent release can be found [here](https://www.zephyrproject.org/developer-resources/#current-release).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:A/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matias Karhumaa  (Synopsys Cybersecurity Research Center   (CyRC))",
    "workaround": "",
    "vendorFixDate": "2021-03-12T00:00:00.000Z",
    "discoveryDate": "2021-02-02T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1716",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-617"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3430",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1716/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.zephyrproject.org/latest/security/vulnerabilities.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/860bb75a6974dd2436d54923902c158a3cc960c6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/c1af0c226f2f921f8fa73d1a99351afb11975bd3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/dec6140685b49e5478147962b36abd18b60f574c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/pull/33272",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/policy",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v1.14-branch",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v2.5-branch",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/tree/v2.6.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.synopsys.com/blogs/software-security/cyrc-advisory-zephyr-vulnerability/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.zephyrproject.org/developer-resources/#current",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-133",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1716/default-remediation-status"
            }
        ]
    }
}