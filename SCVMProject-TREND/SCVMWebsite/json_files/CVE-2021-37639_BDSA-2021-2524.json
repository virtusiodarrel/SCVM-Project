{
    "source": "BDSA",
    "name": "BDSA-2021-2524",
    "title": "Tensorflow Vulnerable to Out of Bounds Read and NULL Pointer Dereference in Restoring Tensor Operations",
    "description": "Tensorflow contains a vulnerability when restoring tensors via raw APIs. Successfully exploiting this could allow an attacker to either cause a NULL pointer dereference and denial-of-service (DoS) condition, or to read outside of the bounds of heap allocated data, which could potentially cause information disclosure.",
    "technicalDescription": "This vulnerability exists when restoring tensors via raw APIs in the `RestoreTensor()` function of `tensorflow/core/kernels/save_restore_tensor.cc`.\nIf an attacker does not provide a tensor name, this will force TensorFlow into dereferencing a null pointer, triggering a DoS condition.\nIf an attacker does provide a tensor name, but not enough for a successful restoration, there is no validation to ensure that the provided list has enough values, which can result in the restoration index reading outside of heap bounds causing information disclosure. \n\nThe vendor has mitigated against this by including additional checks on the name of the tensor being restored.",
    "publishedDate": "2021-08-19T16:41:19.316Z",
    "updatedDate": "2021-08-19T16:41:19.298Z",
    "disclosureDate": "2021-08-11T00:00:00.000Z",
    "exploitPublishDate": "2021-08-11T00:00:00.000Z",
    "solution": "Fixed in:\n* **[2.3.4](https://github.com/tensorflow/tensorflow/releases/tag/v2.3.4)** by [this](https://github.com/tensorflow/tensorflow/commit/b7f78808c68) commit,\n* **[2.4.3](https://github.com/tensorflow/tensorflow/releases/tag/v2.4.3)** by [this](https://github.com/tensorflow/tensorflow/commit/5f4d2035579) commit,\n* **[2.5.1](https://github.com/tensorflow/tensorflow/releases/tag/v2.5.1)** by [this](https://github.com/tensorflow/tensorflow/commit/a26f8d26edf) commit,\n* **[2.6.0](https://github.com/tensorflow/tensorflow/releases/tag/v2.6.0)** by [this](https://github.com/tensorflow/tensorflow/commit/af83f1315ca) commit.\n\nThe latest stable releases are available [here](https://github.com/tensorflow/tensorflow/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.2,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.5
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Aivul Team from Qihoo 360.",
    "workaround": "",
    "vendorFixDate": "2021-08-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2524",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-476"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-37639",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2524/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/5f4d2035579",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/a26f8d26edf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/af83f1315ca",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/commit/b7f78808c68",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/releases/tag/v2.6.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-gh6x-4whr-2qv4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-gh6x-4whr-2qv4",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2524/default-remediation-status"
            }
        ]
    }
}