{
    "source": "BDSA",
    "name": "BDSA-2022-2071",
    "title": "Moodle Vulnerable to Remote Code Execution (RCE) via Improper Validation of GhostScript Commands",
    "description": "Moodle is vulnerable to remote code execution (RCE) due to improper validation of GhostScript commands. This could allow an attacker to inject specially crafted PostScript code to compromise the system.\n\n**Note:** Sites running GhostScript versions older than **9.50** are vulnerable.",
    "technicalDescription": "This vulnerability exists within the `mod/assign/feedback/editpdf/classes/pdf.php` file when parsing `$command`. This is due to an omitted execution parameter that an attacker can leverage to perform RCE by injecting and executing malicious PostScript code on the system.\n\nThis has been mitigated by introducing the `SAFER` option within the GhostScript `$command` so that IO and OS commands cannot be executed.",
    "publishedDate": "2022-07-26T11:24:36.415Z",
    "updatedDate": "2022-09-26T11:28:38.734Z",
    "disclosureDate": "2022-07-18T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* [**3.9.15**](https://github.com/moodle/moodle/releases/tag/v3.9.15) by [this](https://github.com/moodle/moodle/commit/c8f9140e707dcd620d31da938e2b16f779738fb0) commit.\n* [**3.11.8**](https://github.com/moodle/moodle/releases/tag/v3.11.8) by [this](https://github.com/moodle/moodle/commit/919f5bfb36edf4fba85c3929b3544765bfd10743) commit.\n* [**4.0.2**](https://github.com/moodle/moodle/releases/tag/v4.0.2) by [this](https://github.com/moodle/moodle/commit/0397ea7e593c85466bbea277976676f187bdb58d) commit.\n\nThe latest stable releases can be found [here](https://github.com/moodle/moodle/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Nick Wojciechowski (CyberCX)",
    "workaround": "The vendor has recommended to ensure older versions of GhostScript are upgraded to version **9.50** or newer.",
    "vendorFixDate": "2022-07-06T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2071",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-35649",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2071/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/0397ea7e593c85466bbea277976676f187bdb58d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/919f5bfb36edf4fba85c3929b3544765bfd10743",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/c8f9140e707dcd620d31da938e2b16f779738fb0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.11.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.9.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v4.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=436456",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=436456",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2071/default-remediation-status"
            }
        ]
    }
}