{
    "source": "BDSA",
    "name": "BDSA-2019-4795",
    "title": "Envoy Vulnerable to Privilege Escalation via Mishandling of Trailing Whitespace in HTTP Headers",
    "description": "Envoy is vulnerable to privilege escalation due to how the HTTP/1 codec component fails to trim whitespace present after HTTP header values.\n\nAn attacker could send manipulated HTTP headers to include whitespace after header content in order to cause the leakage of privileged content.",
    "technicalDescription": "Envoy is vulnerable to a privilege escalation issue because the HTTP/1 codec component incorrectly handles whitespace present after HTTP header values. This trailing whitespace can cause route matchers or access controls to be bypassed. For example, a host header such as 'hostname.com ' would bypass matchers for 'hostname.com'.\n\nIn a multi-level deployment, an unauthenticated attacker could send an altered HTTP header to cause an edge Envoy matcher to fail which would then be proxied to a second level proxy where it can possibly strip the whitespace and leak privileged content.",
    "publishedDate": "2020-11-06T16:14:07.481Z",
    "updatedDate": "2020-11-06T16:14:07.475Z",
    "disclosureDate": "2019-12-10T00:00:00.000Z",
    "solution": "Fixed in [**1.12.2**](https://github.com/envoyproxy/envoy/releases/tag/v1.12.2) by [this](https://github.com/envoyproxy/envoy/commit/6a6ac1ccf928aa9866f19e2cf151c5dd339bb8e6) commit.\n\nThe latest stable releases are available [here](https://github.com/envoyproxy/envoy/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alyssa Wilk, Google",
    "workaround": "The vendor has suggested a workaround [here](https://github.com/envoyproxy/envoy/security/advisories/GHSA-356m-vhw2-wcm4):\n\n* Disable upstream HTTP/1.",
    "vendorFixDate": "2019-12-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4795",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-18802",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4795/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/6a6ac1ccf928aa9866f19e2cf151c5dd339bb8e6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.12.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-356m-vhw2-wcm4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-356m-vhw2-wcm4",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.envoyproxy.io/docs/envoy/v1.12.2/intro/version_history",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4795/default-remediation-status"
            }
        ]
    }
}