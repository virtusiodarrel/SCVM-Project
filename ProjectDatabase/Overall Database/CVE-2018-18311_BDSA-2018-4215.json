{
    "source": "BDSA",
    "name": "BDSA-2018-4215",
    "title": "Perl Vulnerable to Denial-of-Service (DoS) via Integer Overflow in 'Perl_my_setenv'",
    "description": "Perl is vulnerable to denial-of-service (DoS) due to use of a data type which may be insufficient to store the combined value of two variables that can be controlled by an attacker. If the value is large enough it can cause an integer to wrap around and subsequently lead to a crash via heap-based buffer overflow.\n\nTo exploit this flaw an attacker must be able to control the contents of the value that a perl program writes into an environmental variable, and the program has to allow allocation of huge chunks of memory.",
    "technicalDescription": "This flaw lies in the `Perl_my_setenv()` function of the `util.c` source file. The attack is possible because the `nam` and `val` arguments are supplied by the user making `nlen` and `vlen` user-controllable by extension. If an attacker were to pass in two very long strings, it would cause an integer overflow during calculation of `new_env` in `new_env = (char*)safesysmalloc((nlen + vlen + 2) * sizeof(char))`.\n\nThe integer overflow makes `new_env` too small to hold the sum of the lengths of the two input strings. The subsequent call to `memcpy()` will overflow the intended buffer and write arbitrary data to the heap (a heap-based buffer overflow) causing a crash.\n\nThis is mainly a concern on 64-bit systems. Exploiting the flaw on a 32-bit system would require enough free address space to store a 2GB string, which is unlikely due to inherent limitations placed on RAM on such systems.",
    "publishedDate": "2018-12-05T12:11:21.564Z",
    "updatedDate": "2018-12-19T15:34:45.105Z",
    "disclosureDate": "2018-11-29T00:00:00.000Z",
    "exploitPublishDate": "2018-11-29T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.26.3-RC1**](https://www.perl.org/get.html) by [this](https://perl5.git.perl.org/perl.git/commit/5737d31aac51360cc1eb412ef059e36147c9d6d6) commit,\n* [**5.28.1-RC1**](https://www.perl.org/get.html) by [this](https://perl5.git.perl.org/perl.git/commit/0589f071dc6836de80b24fd798c3336c72ead850) commit, and\n* [**5.29.1**](https://www.perl.org/get.html) by [this](https://perl5.git.perl.org/perl.git/commit/34716e2a6ee2af96078d62b065b7785c001194be) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.4
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jayakrishna Menon and Christophe Hauser",
    "workaround": "",
    "vendorFixDate": "2018-06-29T00:00:00.000Z",
    "vendorNotifiedDate": "2018-05-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.4,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4215",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-18311",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4215/ranges"
            },
            {
                "rel": "reference",
                "href": "https://metacpan.org/pod/release/SHAY/perl-5.28.1-RC1/pod/perldelta.pod",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://perl5.git.perl.org/perl.git/commit/0589f071dc6836de80b24fd798c3336c72ead850",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://perl5.git.perl.org/perl.git/commit/34716e2a6ee2af96078d62b065b7785c001194be",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://perl5.git.perl.org/perl.git/commit/5737d31aac51360cc1eb412ef059e36147c9d6d6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://rt.perl.org/Public/Bug/Display.html?id=133204",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.perl.org/get.html",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}