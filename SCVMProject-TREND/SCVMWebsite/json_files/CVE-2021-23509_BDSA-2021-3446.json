{
    "source": "BDSA",
    "name": "BDSA-2021-3446",
    "title": "json-ptr Vulnerable to Prototype Pollution via Type Confusion in \"JSON Pointer\" Implementation",
    "description": "NPM package json-ptr is vulnerable to prototype pollution due to a type confusion error that can occur whenever instances of the JSON Pointer implementation are used with untrusted input. An attacker could modify the prototypes of objects by passing maliciously crafted input to such instances. The exact impact that the attacker can achieve will depend on how the object is used, but can include cross-site scripting (XSS) and remote code execution (RCE).\n\nThis vulnerability exists due to an incomplete fix for **CVE-2020-7766** (**BDSA-2020-3315**).",
    "technicalDescription": "If the `set` operation which is provided by json-ptr is used with untrusted input, then it can be used to modify the prototypes of objects in a malicious manner. This constitutes a prototype pollution vulnerability (**CVE-2020-7766**), which was fixed via the addition of an input sanitization operation. This fix was found to be incomplete. If the untrusted input constitutes an array, then type confusion can occur, which will cause the sanitization process to be bypassed.\n\nThe vulnerability was fixed via the inclusion of a more rigorous input validation procedure.",
    "publishedDate": "2021-11-15T15:55:22.861Z",
    "updatedDate": "2021-11-15T15:55:22.849Z",
    "disclosureDate": "2021-11-03T00:00:00.000Z",
    "exploitPublishDate": "2021-11-03T00:00:00.000Z",
    "solution": "Fixed in version [**3.0.0**](https://github.com/flitbit/json-ptr/releases/tag/v3.0.0) by [this](https://github.com/flitbit/json-ptr/commit/5dc458fbad1c382a2e3ca6d62e66ede3d92849ca) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/json-ptr).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alessio Della Libera (Snyk Research Team)",
    "workaround": "",
    "vendorFixDate": "2021-10-26T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3446",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-915"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23509",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3446/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/flitbit/json-ptr#security-vulnerabilities-resolved",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/flitbit/json-ptr/commit/5dc458fbad1c382a2e3ca6d62e66ede3d92849ca",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/flitbit/json-ptr/releases/tag/v3.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://security.snyk.io/vuln/SNYK-JS-JSONPTR-1577291",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/json-ptr",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3446/default-remediation-status"
            }
        ]
    }
}