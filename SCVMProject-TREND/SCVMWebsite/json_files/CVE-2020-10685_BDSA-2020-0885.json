{
    "source": "BDSA",
    "name": "BDSA-2020-0885",
    "title": "Ansible Vulnerable to Information Disclosure via Unsafe Storage of Unencrypted Data in Temporary Archive",
    "description": "It was discovered that Ansible contains an information disclosure vulnerability. The temporary files created when decrypting with vault are not properly removed. This could result in an attacker with local access gaining access to sensitive information.",
    "technicalDescription": "The vulnerability exists due to the dataloader failing to properly remove temporary files. It occurs when using modules that decrypt vault files e.g. `assemble,` `script`, `unarchive`, `win_copy`, `aws_s3 `or `copy` modules. The temporary directory is created in `/tmp` however the dataloader fails to remove the decrypted file after its usage, leaving the secrets unencrypted allowing a local user to access the temporary files and obtain confidential information.",
    "publishedDate": "2020-04-23T15:36:20.849Z",
    "updatedDate": "2020-04-23T15:36:20.845Z",
    "disclosureDate": "2020-04-22T00:00:00.000Z",
    "solution": "Fixed in: \n* [**2.9.7**](https://github.com/ansible/ansible/releases/tag/v2.9.7) by [this](https://github.com/ansible/ansible/commit/51d2514753544a9d58cd7524e27e696b2c944fb5) commit,\n* [**2.8.11**](https://github.com/ansible/ansible/releases/tag/v2.8.11) by [this](https://github.com/ansible/ansible/commit/e1273b6faf036ed84e4f4edee85b888a4e256aee) commit,\n* [**2.7.17**](https://github.com/ansible/ansible/releases/tag/v2.7.17) by [this](https://github.com/ansible/ansible/commit/4e1fe80e681fa466626e9dea53efe6b0253ea1b2) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.1
        },
        "vector": "(AV:L/AC:M/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-03-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0885",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-311"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10685",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0885/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1814627",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/4e1fe80e681fa466626e9dea53efe6b0253ea1b2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/51d2514753544a9d58cd7524e27e696b2c944fb5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/e1273b6faf036ed84e4f4edee85b888a4e256aee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases/tag/v2.7.17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases/tag/v2.8.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases/tag/v2.9.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0885/default-remediation-status"
            }
        ]
    }
}