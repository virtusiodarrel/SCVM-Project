{
    "source": "BDSA",
    "name": "BDSA-2020-3411",
    "title": "Drupal Core Vulnerable to Remote Code Execution (RCE) via Improper Validation of Uploaded Files",
    "description": "Drupal Core contains an arbitrary file upload vulnerability because of insufficient validation of uploaded files. An attacker could exploit this flaw by uploading files with malicious code which will be executed on the server.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "This vulnerability exists in multiple files which handle file uploads in Drupal Core. These files do not properly sanitize file names and extensions when they are uploaded to the server. This could allow an attacker to upload malicious files with extensions like `.php`, `phar`, `pl`, `py`, `cgi`, `asp`, `js`, `html`, `htm`, `phtml`, etc. Files with extensions other than these can be uploaded too. Thus, the attacker can achieve remote code execution (RCE) when these files are executed on the server.\nThis vulnerability has been fixed by validating uploaded files against a list of allowed extensions. Also, the fixed code renames potentially executable files using symbols like `_` to prevent exploitation.",
    "publishedDate": "2020-11-19T11:16:06.935Z",
    "updatedDate": "2022-01-28T15:12:05.430Z",
    "disclosureDate": "2020-11-18T00:00:00.000Z",
    "exploitPublishDate": "2022-01-18T00:00:00.000Z",
    "solution": "Fixed in [**7.74**](https://git.drupalcode.org/project/drupal/-/tags/7.74) by [this](https://git.drupalcode.org/project/drupal/-/commit/0263ea89cfff630262b8c0bc6d9c629c42aa7a84) commit.\n\nFixed in [**8.8.11**](https://git.drupalcode.org/project/drupal/-/tags/8.8.11) by [this](https://git.drupalcode.org/project/drupal/-/commit/a4e9d62a9a5d508dd950f6bf96d0c399701fde54) commit.\n\nFixed in [**8.9.9**](https://git.drupalcode.org/project/drupal/-/tags/8.9.9) by [this](https://git.drupalcode.org/project/drupal/-/commit/7352bf1fa16f1b4a2b7495340e34a1eebca9620b) commit.\n\nFixed in [**9.0.8**](https://git.drupalcode.org/project/drupal/-/tags/9.0.8) by [this](https://git.drupalcode.org/project/drupal/-/commit/3da1bf499b913093f7e2618dc616098364091967) commit.",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ufku, Mark Ferree, Fr\u00e9d\u00e9ric G. Marand, Samuel Mortenson, Derek Wright",
    "workaround": "",
    "vendorFixDate": "2020-11-17T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3411",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13671",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3411/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.drupalcode.org/project/drupal/-/commit/0263ea89cfff630262b8c0bc6d9c629c42aa7a84",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.drupalcode.org/project/drupal/-/commit/3da1bf499b913093f7e2618dc616098364091967",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.drupalcode.org/project/drupal/-/commit/7352bf1fa16f1b4a2b7495340e34a1eebca9620b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.drupalcode.org/project/drupal/-/commit/a4e9d62a9a5d508dd950f6bf96d0c399701fde54",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.drupalcode.org/project/drupal/-/tags/7.74",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.drupalcode.org/project/drupal/-/tags/8.8.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.drupalcode.org/project/drupal/-/tags/8.9.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.drupalcode.org/project/drupal/-/tags/9.0.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-core-2020-012",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3411/default-remediation-status"
            }
        ]
    }
}