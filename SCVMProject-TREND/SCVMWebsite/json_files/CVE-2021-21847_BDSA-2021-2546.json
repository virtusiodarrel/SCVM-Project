{
    "source": "BDSA",
    "name": "BDSA-2021-2546",
    "title": "GPAC Vulnerable to Remote Code Execution (RCE) via Heap-Based Buffer Overflow in 'stts_box_read()' Function",
    "description": "GPAC is vulnerable to remote code execution (RCE) and denial-of-service (DoS) due to the improper management of system memory resources. An attacker could potentially execute malicious code on a victim's machine by tricking that victim into running the application with a maliciously crafted input file. It is also possible for an attacker to cause the application to crash.",
    "technicalDescription": "The function `stts_box_read()`, of file `src/isomedia/box_code_base.c`, defines the local variable `ptr`. This is a pointer to a `GF_TimeToSampleBox` structure. One of the members of this structure is `nb`, which is of type `u32` (i.e. an unsigned 32-bit integer). Another member is `entries`, which is a pointer to an array of `GF_SttsEntry` structures. The value of `nb` denotes the number of structures which are associated with the array.\n\nThe `entries` array constitutes a buffer on the heap. The buffer is allocated via a call to `gf_malloc()`, which must be passed an argument which specifies the size of the buffer that is required. The size of the buffer is obtained by calculating `sizeof(GF_SttsEntry) * ptr->alloc_size`, with `alloc_size` having been set to equal `nb_size`. An integer overflow can occur whenever this calculation is performed, as the application fails to sufficiently validate `alloc_size` and `nb_size`, or to ensure that a suitably typed variable is used to store the result of the calculation. If an integer overflow occurs, then the value that is passed to `gf_malloc()` will be too small. The buffer that is allocated will therefore not be large enough to store the values associated with the `GF_SttsEntry` array.\n\nWhenever the application evaluates the loop that is used to fill the array, a heap buffer overflow will occur. This can lead to an exception being raised, halting program execution. A remote attacker could therefore cause a denial-of-service (DoS) by tricking a victim into running the application using maliciously crafted video file as input. It may also be possible for an attacker to execute malicious code on the victim's machine, although this has not been demonstrated.",
    "publishedDate": "2021-08-23T15:11:02.268Z",
    "updatedDate": "2022-06-30T08:39:50.736Z",
    "disclosureDate": "2021-08-16T00:00:00.000Z",
    "exploitPublishDate": "2021-08-16T00:00:00.000Z",
    "solution": "Fixed in [**2.0.0**](https://github.com/gpac/gpac/releases/tag/v2.0.0) by [this](https://github.com/gpac/gpac/commit/b515fd04f5f00f4a99df741042f1efb31ad56351) commit.\n\nThe latest stable releases are available [here](https://github.com/gpac/gpac/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Cisco Talos",
    "workaround": "",
    "vendorFixDate": "2021-08-10T00:00:00.000Z",
    "vendorNotifiedDate": "2021-06-24T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2546",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-680"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21847",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2546/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gpac/gpac/commit/b515fd04f5f00f4a99df741042f1efb31ad56351",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gpac/gpac/issues/1814",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gpac/gpac/releases/tag/v2.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gpac/gpac/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2021-1297",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://talosintelligence.com/vulnerability_reports/TALOS-2021-1297",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2546/default-remediation-status"
            }
        ]
    }
}