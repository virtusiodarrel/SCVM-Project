{
    "source": "BDSA",
    "name": "BDSA-2021-0002",
    "title": "Zend and laminas-http Vulnerable to Remote Code Execution (RCE) via '__destruct' Method in 'Zend\\Http\\Response\\Stream' Class",
    "description": "Zend Framework and laminas-http are vulnerable to remote code execution (RCE) via PHP object injection caused by user-controlled input deserialization. This could allow a remote attacker to execute arbitrary OS commands on the host.\n\nNote that the CVE associated with this vulnerability is disputed by the vendor since PHP object injection is not framework specific and can only be avoided by not deserializing untrusted user input.",
    "technicalDescription": "The vulnerability appears when the data passed in a POST request is deserialized and is included as a parameter to the constructor of the `Zend\\Http\\Response\\Stream` class. When the class destructor `__destruct()` is invoked, a series of functions calls will end up executing `Zend\\Validator\\Callback->isValid()` on the malicious parameter. The parameter may be included if the `Zend\\Http\\Response\\Stream` object is constructed via `Zend\\ServiceManager\\ReaderPluginManager` or `Zend\\Config\\Config` classes.\n\nThis vulnerability also exists in the `laminas-http` project which is a continuation of Zend Framework. The vendor has released a patch that helps protect from the scenario above, but the patch is not meant to be a complete fix against PHP object injections.",
    "publishedDate": "2021-01-04T11:45:27.527Z",
    "updatedDate": "2021-02-19T13:46:10.592Z",
    "disclosureDate": "2021-01-03T00:00:00.000Z",
    "exploitPublishDate": "2021-01-03T00:00:00.000Z",
    "solution": "Fixed in laminas-http **[2.14.2](https://github.com/laminas/laminas-http/releases/tag/2.14.2)** by [this](https://github.com/laminas/laminas-http/commit/019f31fe) commit.\n\nThe latest stable releases are available [here](https://github.com/laminas/laminas-http/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ling-Yizhou",
    "workaround": "",
    "vendorFixDate": "2021-02-05T00:00:00.000Z",
    "vendorNotifiedDate": "2020-11-27T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0002",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3007",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0002/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laminas/laminas-http/commit/019f31fe",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laminas/laminas-http/pull/48",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laminas/laminas-http/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laminas/laminas-http/releases/tag/2.14.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0002/default-remediation-status"
            }
        ]
    }
}