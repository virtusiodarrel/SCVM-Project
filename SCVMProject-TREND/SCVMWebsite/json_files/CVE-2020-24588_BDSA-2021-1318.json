{
    "source": "BDSA",
    "name": "BDSA-2021-1318",
    "title": "Linux Kernel Vulnerable to Packet Injection via 'Aggregation Attack'",
    "description": "The Linux Kernel is vulnerable to packet injection due to a flaw in the Wi-Fi 'frame aggregation' feature.\n\nAn attacker in wireless transmission range of an access point could use this issue to trick clients into using a malicious DNS server.",
    "technicalDescription": "The Linux Kernel is vulnerable to packet injection because a design flaw exists in its Wi-Fi's 'frame aggregation' feature, where the 'is aggregated' flag is not authenticated. This allows an attacker to modify it, meaning victims can be tricked into processing the encrypted transported data in an unintended manner.\n\nThis flaw could be abused by an attacker by first tricking a victim user into accessing an attacker controlled server where the attacker can set the 'is aggregated' flag on carefully selected packets. The attacker can then inject arbitrary network packets and trick the victim into using a malicious DNS server.\n\nThe issue reporter has stated [here](https://www.fragattacks.com/#aggregationattack) that an attack is only possible under rare conditions and, as such, considers it a theoretical attack.",
    "publishedDate": "2021-05-14T15:26:04.507Z",
    "updatedDate": "2021-08-06T14:33:14.523Z",
    "disclosureDate": "2021-05-11T00:00:00.000Z",
    "exploitPublishDate": "2021-05-11T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.271**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=daea7ff51861cec93ff7f561095d9048b673b51f) commit\n* [**4.9.271**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=81bcb7d7d5071511eb86cc3b7793607bac9d4060) commit\n* [**4.14.235**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a3558e1b75fefb2299659ee0070ee917927d9220) commit\n* [**4.19.193**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8ea9e997642360ea097710cfa7b1cd750a73fe64) commit\n* [**5.4.124**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fa00d4928eafe4fe8d854028f73f7af8fdbc9c3c) commit\n* [**5.10.42**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c730d72aa6e85a71ee74530d601d4d894d791b43) commit\n* [**5.12.9**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6eec99250f3a0763de58a7ef9ffca53e137356db) commit\n* [**5.13-rc4**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2b8a1fee3488c602aca8bea004a087e60806a5cf) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.8,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.2,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:A/AC:H/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.6,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mathy Vanhoef (New York University Abu Dhabi)",
    "workaround": "",
    "vendorFixDate": "2021-05-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1318",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-24588",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1318/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/CVE-2020-24587",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=079a108feba474b4b32bd3471db03e11f2f83b81",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=270032a2a9c4535799736142e1e7c413ca7b836e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2b8a1fee3488c602aca8bea004a087e60806a5cf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2c2bdd2372afcfcf24fe11c65ebe3361b7e1cd9f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=6eec99250f3a0763de58a7ef9ffca53e137356db",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=81bcb7d7d5071511eb86cc3b7793607bac9d4060",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8ea9e997642360ea097710cfa7b1cd750a73fe64",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a3558e1b75fefb2299659ee0070ee917927d9220",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c730d72aa6e85a71ee74530d601d4d894d791b43",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=daea7ff51861cec93ff7f561095d9048b673b51f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=fa00d4928eafe4fe8d854028f73f7af8fdbc9c3c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/linux-wireless/20210511180259.159598-1-johannes@sipsolutions.net/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://papers.mathyvanhoef.com/fragattacks-overview.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://papers.mathyvanhoef.com/usenix2021.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.fragattacks.com/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.fragattacks.com/#aggregationattack",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/05/11/12",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1318/default-remediation-status"
            }
        ]
    }
}