{
    "source": "BDSA",
    "name": "BDSA-2021-3706",
    "title": "Mozilla Firefox, Firefox ESR and Thunderbird Vulnerable to Memory Corruption via Memory Safety Bugs",
    "description": "Mozilla Firefox, Firefox ESR and Thunderbird are vulnerable to memory corruption due to the presence of multiple memory safety bugs.\n \n **Note:** The vendor has stated [here](https://www.mozilla.org/en-US/security/advisories/mfsa2021-48/#CVE-2021-43534) that they presume that with enough effort some of these could have been exploited to run arbitrary code.\n\nThis has been considered when scoring the impact these memory safety bugs may have on a system.",
    "technicalDescription": "Memory safety issues exist in multiple locations:\n* Race conditions exist between `nsSocketTransport::Close` and `nsSocketTransport::RecoverFromError` called from `OnSocketDetached`, and between `nsSocketTransport::OnInputClosed` and `nsSocketTransport::OpenInputStream` in the `netwerk/base/nsSocketTransport2.h`  file,\n* `nsMenuFrame::PassMenuCommandEventToPopupManager` in `layout/xul/nsMenuFrame.cpp`,\n* Multiple flawed uses of `NS_ADDREF` in `netwerk/base/nsSocketTransport2.cpp`.",
    "publishedDate": "2021-12-09T12:08:46.926Z",
    "updatedDate": "2022-08-12T09:23:28.698Z",
    "disclosureDate": "2021-11-02T00:00:00.000Z",
    "solution": "Fixed in Firefox version [**94.0**](https://ftp.mozilla.org/pub/firefox/releases/94.0/) and Firefox ESR version [**91.3**](https://ftp.mozilla.org/pub/firefox/releases/91.3.0esr/) by the following revisions:\n* [Bug 1606864](https://hg.mozilla.org/mozilla-central/rev/9a3d7d1527ad169b3dfe00180579c206be8b3c70)\n* [Bug 1712671](https://hg.mozilla.org/mozilla-central/rev/8ff01cedda9023f0408e9cfadb054ddd683c7378)\n* [Bug 1730048](https://hg.mozilla.org/mozilla-central/rev/426254fe00c3eceef012bd95090382d148c95747)\n* [Bug 1735152](https://hg.mozilla.org/mozilla-central/rev/d76783498a30c23ffe3e201d42dc32aef8479738)\n\nFixed in Thunderbird version [**91.3**](https://archive.mozilla.org/pub/thunderbird/releases/91.3.0/).\n\n\nThe latest stable releases of Firefox and Firefox ESR are available [here](https://ftp.mozilla.org/pub/firefox/releases/).\nThe latest stable releases of Thunderbird are available [here](https://archive.mozilla.org/pub/thunderbird/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Christian Holler, Valentin Gosu, and Andrew McCreight",
    "workaround": "",
    "vendorFixDate": "2021-10-18T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3706",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-465"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43534",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3706/ranges"
            },
            {
                "rel": "reference",
                "href": "https://archive.mozilla.org/pub/thunderbird/releases/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://archive.mozilla.org/pub/thunderbird/releases/91.3.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/91.3.0esr/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/94.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/426254fe00c3eceef012bd95090382d148c95747",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/8ff01cedda9023f0408e9cfadb054ddd683c7378",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/9a3d7d1527ad169b3dfe00180579c206be8b3c70",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/d76783498a30c23ffe3e201d42dc32aef8479738",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-48/#CVE-2021-43534",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-49/#CVE-2021-43534",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-50/#CVE-2021-43534",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3706/default-remediation-status"
            }
        ]
    }
}