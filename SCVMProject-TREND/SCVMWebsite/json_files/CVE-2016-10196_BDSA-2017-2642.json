{
    "source": "BDSA",
    "name": "BDSA-2017-2642",
    "title": "libevent Vulnerable to Denial-of-Service (DoS) via Buffer Overflow in 'evutil_parse_sockaddr_port' Function",
    "description": "A buffer overflow exists in libevent that can lead to a Denial of Service through the function `evutil_parse_sockaddr_port()`. An attacker could exploit this vulnerability by supplying a system with maliciously crafted requests.",
    "technicalDescription": "libevent provides a mechanism to execute a callback function when a specific event occurs on a file descriptor or after a timeout has been reached. Furthermore, libevent also support callbacks due to signals or regular timeouts. libevent is meant to replace the event loop found in event driven network servers. An application just needs to call `event_dispatch()` and then add or remove events dynamically without having to change the event loop. libevent additionally provides a sophisticated framework for buffered network IO, with support for sockets, filters, rate-limiting, SSL, zero-copy file transmission, and IOCP. libevent includes support for several useful protocols, including DNS, HTTP, and a minimal RPC framework. libevent is used commonly in Mozilla products.\n\nSeaMonkey is an Internet suite offering a built in webbrowser, mail and other functionality. It is the continuation of the former Mozilla Application Suite, based on the same source code, which originated from Netscape Communicator and was the base for Netscape 6 and Netscape 7. Compared to Firefox, the SeaMonkey web browser keeps the far more traditional-looking interface of Netscape and the Mozilla Suite. Many Firefox and Thunderbird add-ons can be modified for compatiblity with SeaMonkey.\n* Firefox is a web browser, originally based on components that formed SeaMonkey.\n* Firefox Mobile is an Android-based browser, developed from the desktop Firefox webbrowser.\n* Thunderbird is a mail client, originally based on components that formed SeaMonkey.\n* Gecko is the HTML rendering engine used by Seamonkey, Firefox and Thunderbird.\n\nThe length between '[' and ']' is cast to signed 32 bit integer on line 1815. Is the length is more than 2<<31 (INT_MAX), len will hold a negative value. Consequently, it will pass the check at line 1816. Segfault happens at line 1819. Affected code in `evutil.c`:\n```\n1798     char buf[128];\n...\n...\n1809     cp = strchr(ip_as_string, ':');\n1810     if (*ip_as_string == '[') {\n1811         int len;\n1812         if (!(cp = strchr(ip_as_string, ']'))) {\n1813             return -1;\n1814         }\n1815         len = (int) ( cp-(ip_as_string + 1) );\n1816         if (len > (int)sizeof(buf)-1) {\n1817             return -1;\n1818         }\n1819         memcpy(buf, ip_as_string+1, len);\n```",
    "publishedDate": "2018-01-03T16:49:37.127Z",
    "updatedDate": "2020-09-15T10:29:19.289Z",
    "disclosureDate": "2017-04-19T00:00:00.000Z",
    "exploitPublishDate": "2017-04-19T00:00:00.000Z",
    "solution": "Fixed in:\n* libevent [**2.1.6**](https://github.com/libevent/libevent/)\n* Mozilla SeaMonkey [**2.49.1**](https://www.seamonkey-project.org/releases/)\n* Mozilla Firefox [**53**](https://www.getfirefox.com/)\n* Mozilla Thunderbird [**53**](https://www.getthunderbird.com/)\n* Mozilla Gecko [**52**](https://developer.mozilla.org/en-US/docs/Mozilla/Gecko/Gecko_SDK#Downloading)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Guido Vranken",
    "workaround": "",
    "vendorFixDate": "2017-04-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2642",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2016-10196",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2642/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1343453",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1343453",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://developer.mozilla.org/en-US/docs/Mozilla/Gecko/Gecko_SDK#Downloading",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libevent/libevent/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libevent/libevent/issues/318",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.getfirefox.com/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.getthunderbird.com/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.seamonkey-project.org/releases/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}