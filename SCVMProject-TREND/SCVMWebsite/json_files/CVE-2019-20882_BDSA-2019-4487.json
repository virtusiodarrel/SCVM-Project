{
    "source": "BDSA",
    "name": "BDSA-2019-4487",
    "title": "Mattermost Vulnerable to Domain Restriction Bypass via 'AuthService' Users",
    "description": "Mattermost Server is vulnerable to the bypassing of domain restrictions, which allows anyone to join open teams. An attacker could exploit this to circumvent the intended domain restrictions and access restricted teams.",
    "technicalDescription": "This vulnerability is present for `AuthService` users and exists due to flawed logic in the `isTeamEmailAddressAllowed()` function of `app/team.go`.\n\nEven if an open team specifies domain restrictions for new users, these are not properly implemented, allowing any `AuthService` user to join the team. An attacker could exploit this to circumvent the intended domain restrictions and access restricted teams.\n\nThe vendor has mitigated against this to ensure that the domain validation applies for these users.",
    "publishedDate": "2020-07-09T14:57:27.272Z",
    "updatedDate": "2020-07-09T14:57:27.265Z",
    "disclosureDate": "2019-01-31T00:00:00.000Z",
    "solution": "Fixed in [**5.8.0-rc1**](https://github.com/mattermost/mattermost-server/releases/tag/v5.8.0-rc1) by [this](https://github.com/mattermost/mattermost-server/commit/4e4f4972f97c8887d3aaf75698fdc84748072e12) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Elias Nahum",
    "workaround": "",
    "vendorFixDate": "2019-02-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4487",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-346"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20882",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4487/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/commit/4e4f4972f97c8887d3aaf75698fdc84748072e12",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/pull/10209",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/releases/tag/v5.8.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mattermost.com/security-updates/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4487/default-remediation-status"
            }
        ]
    }
}