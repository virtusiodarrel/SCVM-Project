{
    "source": "BDSA",
    "name": "BDSA-2020-1216",
    "title": "Dolibarr Vulnerable to Stored Cross-Site Scripting (XSS) and Remote Code Execution (RCE) via '.noexe' Security Mechanism Bypass",
    "description": "Dolibarr is vulnerable to stored cross-site scripting (XSS) and remote code execution (RCE) due to an improperly implemented security mechanism. A remote authenticated attacker can change the name of a file that contains executable code in order to bypass mechanisms intended to prevent the execution of that code.",
    "technicalDescription": "The DMS/ECM module within Dolibarr allows users to upload files, and then share those files with other users via a link. Dolibarr will append the `.noexe`extension to files that may contain executable code. This is implemented using the function `isAFileWithExecutableContent()`, which is defined within the file `functions.lib.php`. This function calls `preg_match()` in order to detect dangerous file extensions. The response that a user receives when they click on the sharing link is generated using code contained within `document.php`. If this code detects that the file to be shared has the `.noexe` extension, it will set the response MIME type to `octet-stream` so that the downloaded prompt is displayed. If an attacker is able to modify the name of an uploaded file, they can change the extension from `.noexe` to `.html` so that this security mechanism is bypassed, causing the contents of the file to be rendered by the victim's browser. This could allow the attacker to execute malicious scripts within the browser of a victim, or even execute malicious code on their machine.",
    "publishedDate": "2020-05-22T16:40:25.665Z",
    "updatedDate": "2020-08-18T16:12:00.330Z",
    "disclosureDate": "2020-05-17T00:00:00.000Z",
    "exploitPublishDate": "2020-05-17T00:00:00.000Z",
    "solution": "Fixed in [**11.0.5**](https://github.com/Dolibarr/dolibarr/releases/tag/11.0.5) and [**12.0.0**](https://github.com/Dolibarr/dolibarr/releases/tag/12.0.0) by [this](https://github.com/Dolibarr/dolibarr/commit/a207365bd2f3373405e04ebd292b29529d3b4217) commit.\n\nThe latest stable releases are available [here](https://github.com/Dolibarr/dolibarr/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.0,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nolan",
    "workaround": "",
    "vendorFixDate": "2020-05-27T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1216",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-73"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13240",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1216/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/commit/a207365bd2f3373405e04ebd292b29529d3b4217",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/releases/tag/11.0.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/releases/tag/12.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.dubget.com/stored-xss-via-file-upload.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.dubget.com/stored-xss-via-file-upload.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1216/default-remediation-status"
            }
        ]
    }
}