{
    "source": "BDSA",
    "name": "BDSA-2019-1556",
    "title": "Intel x86 Processors Vulnerable to Information Disclosure via Microarchitectural Data Sampling Uncacheable Memory (MDSUM)",
    "description": "Many Intel x86 processors are vulnerable to information disclosure due to fundamental design flaws which allow microarchitectural data sampling of uncacheable memory. A local attacker could monitor the state of the processor store buffers, fill buffers and load ports, and (via side-channel analysis) reconstruct protected data that should not be accessible. This is because uncacheable memory accesses still move data through these buffers/ports which means that it can be speculatively forwarded.",
    "technicalDescription": "The Microarchitectural Data Sampling (MDS) vulnerabilities can lead to information disclosure via monitoring of the state of CPU store buffers, fill buffers, and load ports also apply to uncacheable (UC) memory. \n\nEven though UC memory data accesses do not fill new lines into the processor caches, the data still passes through structures susceptible to side-channel analysis. The data may be speculatively returned on faulting or assisting loads and forwarded to a disclosure gadget and used to infer values.",
    "publishedDate": "2019-05-22T08:46:30.688Z",
    "updatedDate": "2022-08-08T16:31:53.948Z",
    "disclosureDate": "2019-05-14T00:00:00.000Z",
    "solution": "Full protection requires disabling hyperthreading which comes with a significant performance drop. The kernel does not do that by default to avoid breaking unattended updates. However a set of mitigating patches has been merged into the codebase.\n\nLinux kernel mitigations:\n* [**3.16.68**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4265ee74d79168dca866e7dd5fbc75868711fad4) commit\n* [**4.4.180**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3092ad5c4f2ed6925847273a65c5598a73ee88d8) commit\n* [**4.9.176**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=025b9cf2a0fcaf8d971b8bea66f661cf3751c245) commit\n* [**4.14.119**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a9411900c4223cbe4926dd2954e762de1816fcec) commit\n* [**4.19.43**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=12a0dad799fbcc94884289f5c9b0ce3a5c77e84d) commit\n* [**5.0.16**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4cf168a94fd508c32c8e63aea2e8e7c0e0990f8a) commit\n* [**5.1.2**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3c01673ec7bf4a27e037bd5a33ccd9b666a776a1) commit\n* [**5.2-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=5c14068f87d04adc73ba3f41c2a303d3c3d1fa12) commit\n\nPatches committed with [this](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=fa4bff165070dc40a3de35b78e4f8da8e8d85ec5) merge.\n\nXen Hypervisor received an additional set of mitigating patches for:\n* xen-unstable\n* Xen 4.12.x\n* Xen 4.11.x\n* Xen 4.10.x\n* Xen 4.9.x\n* Xen 4.8.x\n* Xen 4.7.x\n\nThese can be found [here](https://xenbits.xen.org/xsa/advisory-297.html).\n\nLibvirt mitigating patch has been released with [**5.4.0-rc1**](https://libvirt.org/downloads.html). It can be found [here](https://github.com/libvirt/libvirt/commit/538d873571d7a682852dc1d70e5f4478f4d64e85).\n\nQEMU mitigating patches have been released with [**4.1.0-rc0**](https://www.qemu.org/download/). They can be found [here](https://github.com/qemu/qemu/commit/b2ae52101fca7f9547ac2f388085dbc58f8fe1c0) and [here](https://github.com/qemu/qemu/commit/2c7e82a30774730100da9dbe68d2360459030d91).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.8,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.0,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.3
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ke Sun, Henrique Kawakami, Kekai Hu, Rodrigo Branco, Marina Minkin, Daniel Moghimi, Moritz Lipp, Michael Schwarz, Jo Van Bulck, Daniel Genkin, Daniel Gruss, Berk Sunar, Frank Piessens, and Yuval Yarom",
    "workaround": "",
    "vendorFixDate": "2019-05-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1556",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-203"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-385"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11091",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1556/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=fa4bff165070dc40a3de35b78e4f8da8e8d85ec5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libvirt/libvirt/commit/538d873571d7a682852dc1d70e5f4478f4d64e85",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/qemu/qemu/commit/2c7e82a30774730100da9dbe68d2360459030d91",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/qemu/qemu/commit/b2ae52101fca7f9547ac2f388085dbc58f8fe1c0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://libvirt.org/downloads.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lwn.net/Articles/788456/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lwn.net/Articles/788497/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://software.intel.com/security-software-guidance/software-guidance/microarchitectural-data-sampling",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.qemu.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/xsa/advisory-297.html",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1556/default-remediation-status"
            }
        ]
    }
}