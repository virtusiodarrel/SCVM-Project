{
    "source": "BDSA",
    "name": "BDSA-2020-0152",
    "title": "Sudo Vulnerable to Denial-of-Service (DoS) via Buffer Overflow in 'pwfeedback' Implementation",
    "description": "Sudo is vulnerable to denial-of-service (DoS) via a stack buffer overflow related to the implementation of the `pwfeedback` option.  This vulnerability does not require the attacker to have sudo access. The `pwfeedback` option is not enabled by default in upstream sudo, but some Linux distributions such as Mint and Elementary OS do enable it in their default `sudoers` file. When this option is enabled the stack buffer overflow might allow unprivileged users to escalate their privileges to root. Since the attacker has complete control over the data used to overflow the buffer, there is a strong chance of successful exploitation.",
    "technicalDescription": "The `feedback` option in sudo is used  to provide visual feedback to the user when entering their password. Each keypress results in an asterisk being printed on screen.   \n\nThe issue can be reproduced by passing a large input to sudo via a pipe when it prompts for a password. There are two aspects to this vulnerability. \n\nFirstly the `pwfeedback` option is not ignored, as it should be, when reading from a device that is not a terminal. Due to the lack of a terminal, the saved version of the line erase character remains at its initialized value of 0. \n\nSecondly the code that removes the line of asterisks doesn't properly reset the buffer position when there's a write error, but it does reset the remaining buffer length.  On systems with unidirectional pipes, trying to write to the read end of the pipe will cause a write error. Due to the remaining buffer length not being reset correctly on write errors when the line is erased, a stack buffer can be overflowed.",
    "publishedDate": "2020-01-31T17:38:41.340Z",
    "updatedDate": "2020-01-31T17:38:41.325Z",
    "disclosureDate": "2020-01-30T00:00:00.000Z",
    "exploitPublishDate": "2020-01-30T00:00:00.000Z",
    "solution": "Fixed in [**1.8.31**](https://www.sudo.ws/download.html) by [this](https://github.com/sudo-project/sudo/commit/fa8ffeb17523494f0e8bb49a25e53635f4509078) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Joe Vennix",
    "workaround": "If the `sudoers` file has `pwfeedback` enabled, it should be disabled by pre-pending an exclamation mark:\n\n`Defaults !pwfeedback`",
    "vendorFixDate": "2020-01-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-0152",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-120"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-18634",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-0152/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sudo-project/sudo/commit/fa8ffeb17523494f0e8bb49a25e53635f4509078",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.sudo.ws/alerts/pwfeedback.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.sudo.ws/alerts/pwfeedback.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.sudo.ws/download.html",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}