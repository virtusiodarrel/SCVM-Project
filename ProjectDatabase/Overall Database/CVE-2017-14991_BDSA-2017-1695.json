{
    "source": "BDSA",
    "name": "BDSA-2017-1695",
    "title": "Linux Kernel: Memory Disclosure via SG_GET_REQUEST_TABLE ioctl",
    "description": "The linux kernel is vulnerable to a memory disclosure issue where a local attacker can read sensitive stale kernel memory via the generic scsi device driver.  This can provide a bypass of other kernel protection features such as kernel address space randomization, or potentially leak cryptographic key material.",
    "technicalDescription": "When a local attacker calls the SG_GET_REQUEST_TABLE ioctl for a /dev/sg0 device, a heap memory structure is passed to them that is only partially initialized, the rest containing previous kernel heap memory.  The previous memory may contain code addresses such as function pointers,  allowing the attacker to bypass kernel address space randomisation, enabling further exploitation via other vulnerabilities.  The stale memory may also contain sensitive information such as cryptographic key material.",
    "publishedDate": "2017-10-10T15:04:50.643Z",
    "updatedDate": "2019-05-14T14:08:19.163Z",
    "disclosureDate": "2017-09-15T00:00:00.000Z",
    "solution": "[Fixed](https://www.kernel.org) in versions:\n**3.18.72**\n**4.1.45**\n**4.4.89**\n**4.9.52**\n**4.13.4**\n**4.14-rc2**\n\nAlternatively apply the [patch](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=3e0097499839e0fe3af380410eababe5a47c4cf9)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.7,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "Disable or remove the generic scsi driver `sg`, or recompile the kernel without support for it.",
    "vendorFixDate": "2017-09-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1695",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-201"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-226"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-14991",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1695/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=3e0097499839e0fe3af380410eababe5a47c4cf9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}