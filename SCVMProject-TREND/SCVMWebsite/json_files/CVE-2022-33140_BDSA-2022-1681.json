{
    "source": "BDSA",
    "name": "BDSA-2022-1681",
    "title": "Apache NiFi Vulnerable to OS Command Injection via 'ShellUserGroupProvider'",
    "description": "Apache NiFi is vulnerable to OS command injection due to failure to neutralize arguments for group resolution commands. An authenticated user with authorization to modify access policies could exploit this to inject operating system commands on Linux and macOS platforms.",
    "technicalDescription": "The vulnerability occurs due to failure to neutralize arguments for group resolution commands. An authenticated user with authorization to modify access policies could exploit this to inject operating system commands on Linux and macOS platforms.\n\n**Note:** Command injection requires ShellUserGroupProvider to be one of the enabled User Group Providers in the Authorizers configuration. \n\n**Note:** The ShellUserGroupProvider is not included in the default configuration",
    "publishedDate": "2022-06-17T15:09:17.631Z",
    "updatedDate": "2022-09-13T15:57:25.574Z",
    "disclosureDate": "2022-06-15T00:00:00.000Z",
    "solution": "Fixed in Apache NiFi version [**1.16.3-RC1**](https://github.com/apache/nifi/releases/tag/nifi-1.16.3-RC1) by [this](https://github.com/apache/nifi/commit/a1306a19f78e11c2d809e9aef24336669461403a) commit.\n\nFixed in Apache NiFi  Registry version [**1.16.3**](https://nifi.apache.org/registry.html)\n\nThe latest stable releases can be found [here](https://github.com/apache/nifi/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.6,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.7,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "David Handermann",
    "workaround": "The vendor states that: \"Disabling the ShellUserGroupProvider mitigates the vulnerability.\"",
    "vendorFixDate": "2022-06-13T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 5.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1681",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-33140",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1681/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/nifi/commit/a1306a19f78e11c2d809e9aef24336669461403a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/nifi/releases/tag/nifi-1.16.3-RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/nifi/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/bzs2pcdjsdrh5039oslmfr9mbs9qqdhr",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/bzs2pcdjsdrh5039oslmfr9mbs9qqdhr",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://nifi.apache.org/registry.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1681/default-remediation-status"
            }
        ]
    }
}