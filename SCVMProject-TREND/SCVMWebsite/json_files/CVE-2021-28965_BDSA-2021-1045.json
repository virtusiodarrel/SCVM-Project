{
    "source": "BDSA",
    "name": "BDSA-2021-1045",
    "title": "Ruby REXML Vulnerable to XML Round-Trip Issues via Crafted Input",
    "description": "The Ruby REXML gem is vulnerable to XML round-trip issues due to the presence of multiple XML parsing flaws.\n\nAn attacker could submit a crafted XML document in order to cause an incorrect or otherwise invalid document to be produced.",
    "technicalDescription": "REXML is vulnerable to XML round-trip issues because multiples flaws exist in the XML parsing and serializing functionality. These flaws include cases where REXML can generate or accept invalid notation declarations, accept invalid element start and ends, generate or accept invalid document declarations and ignore data that is before `DOCTYPE`.\n\nThese issues can cause REXML to create an XML document whose structure is different from the original, which, depending upon the context in which REXML is used, could lead to further vulnerabilities.",
    "publishedDate": "2021-05-19T16:17:25.038Z",
    "updatedDate": "2021-05-19T16:17:25.025Z",
    "disclosureDate": "2021-04-05T00:00:00.000Z",
    "exploitPublishDate": "2021-04-15T00:00:00.000Z",
    "solution": "Fixed in [**3.2.5**](https://github.com/ruby/rexml/releases/tag/v3.2.5) by the following commits:\n* [Commit 1](https://github.com/ruby/rexml/commit/a659c63e37414506dfb0d4655e031bb7a2e73fc8)\n* [Commit 2](https://github.com/ruby/rexml/commit/2fe62e29094d95921d7e19abbd2e26b23d78dc5b)\n* [Commit 3](https://github.com/ruby/rexml/commit/6a250d2cd1194c2be72becbdd9c3e770aa16e752)\n* [Commit 4](https://github.com/ruby/rexml/commit/f7bab8937513b1403cea5aff874cbf32fd5e8551)\n* [Commit 5](https://github.com/ruby/rexml/commit/f9d88e4948b4a43294c25dc0edb16815bd9d8618)\n* [Commit 6](https://github.com/ruby/rexml/commit/9b311e59ae05749e082eb6bbefa1cb620d1a786e)\n* [Commit 7](https://github.com/ruby/rexml/commit/3c137eb119550874b2b3e27d12b733ca67033377)\n\nThe latest stable releases are available [here](https://github.com/ruby/rexml/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Juho Nurminen",
    "workaround": "",
    "vendorFixDate": "2021-04-05T00:00:00.000Z",
    "vendorNotifiedDate": "2021-02-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1045",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-611"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28965",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1045/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/rexml/commit/2fe62e29094d95921d7e19abbd2e26b23d78dc5b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/rexml/commit/3c137eb119550874b2b3e27d12b733ca67033377",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/rexml/commit/6a250d2cd1194c2be72becbdd9c3e770aa16e752",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/rexml/commit/9b311e59ae05749e082eb6bbefa1cb620d1a786e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/rexml/commit/a659c63e37414506dfb0d4655e031bb7a2e73fc8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/rexml/commit/f7bab8937513b1403cea5aff874cbf32fd5e8551",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/rexml/commit/f9d88e4948b4a43294c25dc0edb16815bd9d8618",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/rexml/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/rexml/releases/tag/v3.2.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1104077",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1104077",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2021/04/05/xml-round-trip-vulnerability-in-rexml-cve-2021-28965/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1045/default-remediation-status"
            }
        ]
    }
}