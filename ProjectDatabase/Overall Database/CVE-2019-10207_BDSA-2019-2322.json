{
    "source": "BDSA",
    "name": "BDSA-2019-2322",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) via NULL Pointer Execution in Bluetooth 'hci_uart'",
    "description": "The Linux kernel is vulnerable to the execution of a Null pointer through the `hci_uart` bluetooth functionality. A local attacker could  cause a denial-of-service (DoS) of the host.",
    "technicalDescription": "tty operations (`pty_unix98_ops`) can lack `tiocmget()` and `tiocmset()` functions. These get called by several HCI UART protocols (`hci_ath`, `hci_bcm`, `hci_intel`, `hci_mrvl`, `hci_qca`) via `hci_uart_set_flow_control()`or are called directly. This can cause the execution at NULL in these cases. In this type of scenario, if the security options SMEP or `vm.mmap_min_addr` are disabled, the attacker can map code at address 0 from userland and gain control of the kernel's execution context.  This could result in privilege escalation. However, in this case, code execution is not possible because the vulnerable code pathway is within a kernel worker thread, so an attacker has no control over the address space. A denial-of-service (DoS) of the host system is the maximum impact that can occur.\n\nThe easiest case for an attacker to exploit this flaw is with a Marvell `hci_uart`.",
    "publishedDate": "2019-07-25T14:40:25.290Z",
    "updatedDate": "2019-08-05T15:00:45.075Z",
    "disclosureDate": "2019-07-25T00:00:00.000Z",
    "exploitPublishDate": "2019-07-25T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.187**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=37fb924139954a28a1f04959070c3cc762b0de4c) commit\n* [**4.9.187**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=58a01b0bd8ea5fddb51d4d854bb149a1a7312c12) commit\n* [**4.14.136**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=69f9c2bc3f754ad1d610b30b940681d678c8e684) commit\n* [**4.19.64**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=56966212e23f82ced10831f7cca02f7339147428) commit\n* [**5.2.6**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=785b5dc6c06083a874d7bda593de06a01ac7fe6a) commit\n* [**5.3-rc3**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b36a1552d7319bbfd5cf7f08726c23c5c66d4f73) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "syzkaller",
    "workaround": "",
    "vendorFixDate": "2019-07-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.6,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2322",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-476"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-10207",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2322/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=b36a1552d7319bbfd5cf7f08726c23c5c66d4f73",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/linux-bluetooth/20190725120909.31235-1-vdronov@redhat.com/T/#u",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://syzkaller.appspot.com/bug?id=1b42faa2848963564a5b1b7f8c837ea7b55ffa50",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://syzkaller.appspot.com/bug?id=1b42faa2848963564a5b1b7f8c837ea7b55ffa50",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}