{
    "source": "BDSA",
    "name": "BDSA-2018-2938",
    "title": "GnuTLS Vulnerable to Lucky Thirteen Style Attack",
    "description": "A cryptographic timing vulnerability has been discovered in GnuTLS due to the implementation of a cache-based side channel that leads to plain text recovery. An attacker could exploit this vulnerability using a lucky thirteen style attack to recover plaintext in the TLS algorithm.",
    "technicalDescription": "A small number of TLS connections are still utilizing weak CBC-mode cipher suites.  A cache-based side channel in GnuTLS implementation leaves the TLS protocol vulnerable to a new variant of the lucky thirteen attack in combination with a prime+probe attack via cross-vm.  \n\nThe prime+probe attack is achieved by filling the entire cache with attacker data which leaves no space when the encryption process is ran. Any lookup table which is required to be added to the cache must evict the attacker data first, exposing which table indexes were used by the encryption process and leaking information about the key.\n\nThe signatures HMAC-SHA256 and HMAC-SHA384 utilized in the default CBC-mode ciphersuites are vulnerable to a lucky thirteen attack. The original countermeasures introduced to prevent this style of attack where inadequate. An attacker could use a cross-vm prime+probe attack in combination with Lucky-13 attack to recover plain text using crafted packets.",
    "publishedDate": "2018-08-29T14:19:39.017Z",
    "updatedDate": "2018-08-29T14:19:38.990Z",
    "disclosureDate": "2018-08-11T00:00:00.000Z",
    "exploitPublishDate": "2018-06-06T00:00:00.000Z",
    "solution": "Fixed in [**3.6.3**](https://github.com/gnutls/gnutls/releases/tag/gnutls_3_6_3) by the following commits:\n* [commit1](https://github.com/gnutls/gnutls/commit/62248b6adf0c11d469b04b4bf58aa97deff5a813)\n* [commit2](https://github.com/gnutls/gnutls/commit/ce671a6db9e47006cff152d485091141b1569f39)\n* [commit3](https://github.com/gnutls/gnutls/commit/70ebf53b9e19596660b27c3522e8596a31fab4b7)\n* [commit4](https://github.com/gnutls/gnutls/commit/119fffef64aa1c43f082dbe3ffbfdf47b257dd4a)\n* [commit5](https://github.com/gnutls/gnutls/commit/75363e1f237d45609ab03ecf872a720ae0f91c86)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-06-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-2938",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-326"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-385"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-10846",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-2938/ranges"
            },
            {
                "rel": "reference",
                "href": "http://palms.ee.princeton.edu/system/files/SP_vfinal.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://eprint.iacr.org/2018/747.pdf ",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gnutls/gnutls/commit/119fffef64aa1c43f082dbe3ffbfdf47b257dd4a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gnutls/gnutls/commit/62248b6adf0c11d469b04b4bf58aa97deff5a813",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gnutls/gnutls/commit/70ebf53b9e19596660b27c3522e8596a31fab4b7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gnutls/gnutls/commit/75363e1f237d45609ab03ecf872a720ae0f91c86",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gnutls/gnutls/commit/ce671a6db9e47006cff152d485091141b1569f39",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gnutls/gnutls/releases/tag/gnutls_3_6_3",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}