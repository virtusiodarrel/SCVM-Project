{
    "source": "BDSA",
    "name": "BDSA-2021-1558",
    "title": "Admidio Vulnerable to Remote Code Execution (RCE) via 'PHAR' File Upload",
    "description": "Admidio is vulnerable to malicious `.PHAR` files being uploaded. An authenticated attacker could take advantage of this in order to achieve remote code execution (RCE) as well as local file inclusion.",
    "technicalDescription": "This vulnerability exists due to a lack of restrictions on the upload of `.PHAR` files in the `extensionBlocklist` array in `adm_program/system/classes/StringUtils.php`. An authenticated attacker with upload permissions could rename a malicious `php` shell to have a `.phar` extension. The payload will then be executed for any user who visits the file. In addition to this, an authenticated attacker with upload permissions can also move their local files to the `Documents & Folders` view by using the `move to db` ability. This can be exploited to move an attackers malicious local files to the `Documents & Folders` view.",
    "publishedDate": "2021-05-24T16:16:02.527Z",
    "updatedDate": "2022-03-18T13:35:13.487Z",
    "disclosureDate": "2021-05-20T00:00:00.000Z",
    "exploitPublishDate": "2021-05-20T00:00:00.000Z",
    "solution": "Fixed in [**4.0.4**](https://github.com/Admidio/admidio/releases/tag/v4.0.4) by [this](https://github.com/Admidio/admidio/commit/fbffb796cba017ae7138e915bf6869745a628253) commit. \n\nThe latest stable releases are available [here](https://github.com/Admidio/admidio/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-01-22T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1558",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32630",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1558/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Admidio/admidio/commit/fbffb796cba017ae7138e915bf6869745a628253",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Admidio/admidio/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Admidio/admidio/releases/tag/v4.0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Admidio/admidio/security/advisories/GHSA-xpqj-67r8-25j2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Admidio/admidio/security/advisories/GHSA-xpqj-67r8-25j2",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1558/default-remediation-status"
            }
        ]
    }
}