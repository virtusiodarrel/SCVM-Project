{
    "source": "BDSA",
    "name": "BDSA-2021-1312",
    "title": "Linux Kernel Vulnerable to Information Disclosure and Packet Injection via 'Fragment Cache Attack'",
    "description": "The Linux Kernel is vulnerable to information disclosure and packet injection issues due to a flaw in Wi-Fi fragmentation handling.\n\nAn attacker in wireless transmission range of an access point could use this issue to exfiltrate data sent by victim users, or trick clients into using a malicious DNS server.",
    "technicalDescription": "The Linux Kernel is vulnerable to information disclosure and packet injection because a design flaw exists in the Wi-Fi component's 'frame fragmentation' feature where devices are not required to remove non-reassembled fragments from memory when a client disconnects from the network. \n\nThis flaw could be abused by an attacker by injecting a malicious fragment into the fragment cache of an access point. When a victim user connects to the access point and sends a fragmented frame, selected fragments will be reassembled with the injected fragment of the attacker, allowing selected data sent by the victim to be exfiltrated. An attacker could also abuse this flaw by injecting a malicious fragment into the victim's memory in order to cause the victim to use a malicious DNS server.",
    "publishedDate": "2021-05-13T15:42:12.537Z",
    "updatedDate": "2021-08-12T09:36:52.528Z",
    "disclosureDate": "2021-05-11T00:00:00.000Z",
    "exploitPublishDate": "2021-05-11T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.271**](https://www.kernel.org)\n* [**4.9.271**](https://www.kernel.org)\n* [**4.14.235**](https://www.kernel.org)\n* [**4.19.193**](https://www.kernel.org)\n* [**5.4.124**](https://www.kernel.org)\n* [**5.10.42**](https://www.kernel.org)\n* [**5.12.9**](https://www.kernel.org)\n* [**5.13-rc4**](https://www.kernel.org)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=94034c40ab4a3fcf581fbc7f8fdf4e29943c4a24) commit and [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3edc6b0d6c061a70d8ca3c3c72eb1f58ce29bfb1) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.2,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.2,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.5
        },
        "vector": "(AV:A/AC:H/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.9,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mathy Vanhoef (New York University Abu Dhabi)",
    "workaround": "",
    "vendorFixDate": "2021-05-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1312",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-212"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2020-24586",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1312/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/CVE-2020-24586",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3edc6b0d6c061a70d8ca3c3c72eb1f58ce29bfb1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=94034c40ab4a3fcf581fbc7f8fdf4e29943c4a24",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/linux-wireless/20210511180259.159598-1-johannes@sipsolutions.net/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://papers.mathyvanhoef.com/fragattacks-overview.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://papers.mathyvanhoef.com/usenix2021.pdf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.fragattacks.com/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.fragattacks.com/#fragcacheattack",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/05/11/12",
                "label": "ADVISORY"
            }
        ]
    }
}