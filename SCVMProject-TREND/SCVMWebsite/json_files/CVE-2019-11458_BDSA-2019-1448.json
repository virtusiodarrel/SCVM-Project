{
    "source": "BDSA",
    "name": "BDSA-2019-1448",
    "title": "CakePHP Vulnerable to Remote Code Execuiton (RCE) via Deserialization of Untrusted Data in 'SmtpTransport'",
    "description": "CakePHP is vulnerable to remote code execution (RCE) due to an unsafe way in which it parses serialized content supplied by the user. An attacker can exploit applications that open serialized content from user input and overwrite any file the webserver has access to. This can be leveraged to run arbitrary code on the underlying host.",
    "technicalDescription": "This flaw lies in the `__destruct()` function of the `src/Mailer/Transport/SmtpTransport.php` source file. It can be triggered by deserializing malicious input supplied by the user and cause the socket property to get reinitialized in a broken state. This allows an attacker to abuse the `SmtpTransport` functionality to overwrite any file the webserver has write access to and can be leveraged for arbitrary code execution.",
    "publishedDate": "2019-05-09T12:13:24.858Z",
    "updatedDate": "2020-07-28T15:08:02.051Z",
    "disclosureDate": "2019-04-23T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.5.18**](https://github.com/cakephp/cakephp/releases/tag/3.5.18) by [this](https://github.com/cakephp/cakephp/commit/81412fbe2cb88a304dbeeece1955bc0aec98edb1) commit,\n* [**3.6.15**](https://github.com/cakephp/cakephp/releases/tag/3.6.15) by [this](https://github.com/cakephp/cakephp/commit/c25b91bf7c72db43c01b47a634fd02112ff9f1cd) commit, and\n* [**3.7.7**](https://github.com/cakephp/cakephp/releases/tag/3.7.7) by [this](https://github.com/cakephp/cakephp/commit/1a74e798309192a9895c9cedabd714ceee345f4e) commit.\n\nAll releases can be found [here](https://github.com/cakephp/cakephp/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Edgaras Janu\u0161auskas",
    "workaround": "",
    "vendorFixDate": "2019-04-23T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1448",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11458",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1448/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bakery.cakephp.org/2019/04/23/cakephp_377_3615_3518_released.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/commit/1a74e798309192a9895c9cedabd714ceee345f4e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/commit/81412fbe2cb88a304dbeeece1955bc0aec98edb1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/commit/c25b91bf7c72db43c01b47a634fd02112ff9f1cd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/releases/tag/3.5.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/releases/tag/3.6.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cakephp/cakephp/releases/tag/3.7.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1448/default-remediation-status"
            }
        ]
    }
}