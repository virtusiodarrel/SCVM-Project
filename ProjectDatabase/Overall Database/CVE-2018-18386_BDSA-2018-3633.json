{
    "source": "BDSA",
    "name": "BDSA-2018-3633",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) of Terminal Driver via EXTPROC/ICANON Interaction with TIOCINQ",
    "description": "Linux kernel is vulnerable to denial-of-service (DoS) of the terminal driver due to incorrect implementation of functionality meant for disabling several aspects of the driver. An attacker with either physical or local shell access could exploit the ambiguity in the code to confuse the N_TTY layer by manipulating a certain flag's state. This can be leveraged to deny any further usage of any pseudo terminal devices for legitimate users.",
    "technicalDescription": "This flaw lies in the `n_tty_set_termios()` and `n_tty_ioctl()` functions of the `drivers/tty/n_tty.c` source file. It was introduced by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=26df6d13406d1a53b0bda08bd712f1924affd7cd) commit, along with the addition of a new `EXTPROC` control bit to the `termios` local flag word. It was meant to allow disabling of several aspects of the terminal driver.\n\nHowever, ambiguity in the code allows an attacker to confuse the N_TTY layer (which implements terminal I/O processing) by setting the `EXTPROC ` flag and manipulating certain `ICANON` (toggles the canonical mode) invariants to stop them being maintained.\n\nAs a result `TIOCINQ` (responsible for getting the number of bytes in the input buffer) may become confused over whether `ICANON` really means `ICANON` when `EXTPROC` bit is set. This can cause the terminal driver to hang resulting in denial-of-service (DoS).",
    "publishedDate": "2018-10-18T14:54:03.642Z",
    "updatedDate": "2018-10-18T14:54:05.435Z",
    "disclosureDate": "2018-10-17T00:00:00.000Z",
    "solution": "Fixed in [**4.15-rc6**](https://kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=966031f340185eddd05affcf72b740549f056348) commit.\n\nThe fix was cherry-picked and backported into:\n* [**3.2.100**](https://kernel.org/)\n* [**3.16.55**](https://kernel.org/)\n* [**3.18.91**](https://kernel.org/)\n* [**4.1.50**](https://kernel.org/)\n* [**4.4.109**](https://kernel.org/)\n* [**4.9.74**](https://kernel.org/)\n* [**4.14.11**](https://kernel.org/)",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.0,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.5,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.5
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2017-12-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3633",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-372"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-18386",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3633/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.14.11",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=966031f340185eddd05affcf72b740549f056348",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://kernel.org/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}