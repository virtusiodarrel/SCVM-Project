{
    "source": "BDSA",
    "name": "BDSA-2019-3838",
    "title": "Django Vulnerable to Privilege Escalation via Inline Model Editing Functionality",
    "description": "Django is vulnerable to privilege escalation due to improperly implemented data editing functionality. A remote attacker with view-only permissions for a parent model but with edit permissions for an inline model would still be able to trigger the execution of code with elevated permissions by submitting crafted requests to the application.",
    "technicalDescription": "Django implements a model administration interface in which users can view parent models and their associated inline models. This interface implements an authorization mechanism to ensure that the permissions assigned to a user are enforced. These permissions ensure that a user only has read-only access to parent models, and edit permissions for inline models. This authorization mechanism is implemented in a variety of scripts, including `admin/options.py`, `edit_inline/stacked.html` and `edit_inline/tabular.html`. However, whenever a user submits an inline model edit form via a POST request, the parent model's `save()` method is automatically triggered,  which will trigger the invocation of its associated pre-save and post-save signal handlers. This constitutes privilege escalation, as the user is triggering code execution that occurs with privileges beyond those which are assigned to them.",
    "publishedDate": "2019-12-05T15:58:12.693Z",
    "updatedDate": "2019-12-05T15:58:12.683Z",
    "disclosureDate": "2019-12-02T00:00:00.000Z",
    "solution": "Fixed in [**2.2.8**](https://github.com/django/django/releases/tag/2.2.8) by [this](https://github.com/django/django/commit/36f580a17f0b3cb087deadf3b65eea024f479c21) commit.\n \n Fixed in [**2.1.15**](https://github.com/django/django/releases/tag/2.1.15) by [this](https://github.com/django/django/commit/103ebe2b5ff1b2614b85a52c239f471904d26244) commit.\n \n The latest stable releases can be found [here](https://www.djangoproject.com/download/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Shen Ying",
    "workaround": "",
    "vendorFixDate": "2019-11-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3838",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19118",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3838/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/103ebe2b5ff1b2614b85a52c239f471904d26244",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/36f580a17f0b3cb087deadf3b65eea024f479c21",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/2.1.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/2.2.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/weblog/2019/dec/02/security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3838/default-remediation-status"
            }
        ]
    }
}