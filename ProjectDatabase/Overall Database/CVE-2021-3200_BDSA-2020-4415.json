{
    "source": "BDSA",
    "name": "BDSA-2020-4415",
    "title": "libsolv Vulnerable to Denial-of-Service (DoS) via Heap Buffer Overflow in 'testcase_read' Function",
    "description": "libsolv is vulnerable to denial-of-service (DoS) due to a memory management error occurring when opening crafted files. This vulnerability causes libsolv to crash.",
    "technicalDescription": "There is a heap overflow bug in the function `testcase_read()`, file `ext/testcase.c`. The overflow is triggered during `MAPCLR(pool->considered, p)` (equivalent to `pool->considered->map[p >> 3] &= ~(1 << (p & 7))`) when `p>>3` is larger than the size (`pool->considered->size`) of `pool->considered->map`.\n\nThe vulnerability was fixed by not adding new solvables after the considered map is created, the solver is created, or jobs are added. In addition to this, the system now cannot be changed after jobs are added.",
    "publishedDate": "2021-05-19T11:20:08.009Z",
    "updatedDate": "2021-05-19T11:20:08.003Z",
    "disclosureDate": "2020-12-13T00:00:00.000Z",
    "exploitPublishDate": "2020-12-13T00:00:00.000Z",
    "solution": "Fixed in **[0.7.17](https://github.com/openSUSE/libsolv/releases/tag/0.7.17)** by [this](https://github.com/openSUSE/libsolv/commit/0077ef29) commit.\n\nThe latest stable releases are available [here](https://github.com/openSUSE/libsolv/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jager Yeung",
    "workaround": "",
    "vendorFixDate": "2020-12-14T00:00:00.000Z",
    "vendorNotifiedDate": "2020-12-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-4415",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-3200",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-4415/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openSUSE/libsolv/commit/0077ef29",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openSUSE/libsolv/commit/0077ef29",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openSUSE/libsolv/issues/416",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openSUSE/libsolv/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openSUSE/libsolv/releases/tag/0.7.17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yangjiageng/PoC/blob/master/libsolv-PoCs/PoC-testcase_read-2334",
                "label": "POC"
            }
        ]
    }
}