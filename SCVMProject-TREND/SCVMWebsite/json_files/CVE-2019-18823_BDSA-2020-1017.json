{
    "source": "BDSA",
    "name": "BDSA-2020-1017",
    "title": "HTCondor Vulnerable to Authorization Bypass via Improper Access Controls in 'SchedD' Component",
    "description": "HTCondor is vulnerable to authorization bypass due to the improper implementation of access control methods. A remote authenticated attacker could submit jobs as any user by using malicious command sequences.",
    "technicalDescription": "The `SchedD` component of HTCondor is used for job scheduling purposes. This component implements access control mechanisms in order to restrict the ability of users to query and create jobs. These mechanisms use a variety of configuration settings in order to determine the actions that can be performed by a user, including `ALLOW_READ` and `ALLOW_WRITE`. However, a user who can authenticate via a method specified under `SEC_READ_AUTHENTICATION_LIST` can still submit jobs, even if they do not have the required `ALLOW_WRITE` permissions. If the `READ` configuration list contains the `CLAIMTOBE` settings (which is included by default), it is possible for the user to submit jobs as any user. A remote attacker can therefore bypass the `SchedD` component's access control mechanisms provided they have valid credentials for any of the `SEC_READ_AUTHENTICATION_LIST` methods.",
    "publishedDate": "2020-05-07T13:00:57.137Z",
    "updatedDate": "2020-05-07T13:00:57.132Z",
    "disclosureDate": "2020-04-07T00:00:00.000Z",
    "solution": "Fixed in [**8.9.6**](https://github.com/htcondor/htcondor/releases/tag/V8_9_6) and \n[**8.8.8**](https://github.com/htcondor/htcondor/releases/tag/V8_8_8) by the following commits:\n* [Commit 1](https://github.com/htcondor/htcondor/commit/95eaee86e7ad3852c17df46a1b8b193dabd1fd14)\n* [Commit 2](https://github.com/htcondor/htcondor/commit/5c84c6f0b3db4eda1eec42c2c708069bb9393f0b)\n* [Commit 3](https://github.com/htcondor/htcondor/commit/07e33c8b14aa00e04d045d4d79c963db082a3129)\n* [Commit 4](https://github.com/htcondor/htcondor/commit/cbcb93695a932d511c1c7bd40aed1eabeff01d8d)\n* [Commit 5](https://github.com/htcondor/htcondor/commit/3916209123a8ef762b7a9cd84ca0cf8b2cd99716)\n* [Commit 6](https://github.com/htcondor/htcondor/commit/561983fdfa75722dc23b88f924f5732a26652022)\n\nThe latest stable releases can be found [here](https://research.cs.wisc.edu/htcondor/downloads/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Zach Miller",
    "workaround": "The vendor states that the following workaround can be implemented:\n\"...you can change your configuration to not use `CLAIMTOBE` in your authentication methods. Explicitly exclude `CLAIMTOBE` by setting `SEC_READ_AUTHENTICATION_METHODS` if you haven't already. The full list of methods by default should be (on Linux) `\"FS,TOKEN,KERBEROS,GSI,SSL\"` or (on Windows) `\"NTSSPI,TOKEN,SSL\"`. In the 8.8.X series you should exclude `\"TOKEN\"`. You may wish to also exclude other methods you know you are not using.",
    "vendorFixDate": "2020-03-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1017",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-18823",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1017/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/commit/07e33c8b14aa00e04d045d4d79c963db082a3129",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/commit/3916209123a8ef762b7a9cd84ca0cf8b2cd99716",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/commit/561983fdfa75722dc23b88f924f5732a26652022",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/commit/5c84c6f0b3db4eda1eec42c2c708069bb9393f0b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/commit/95eaee86e7ad3852c17df46a1b8b193dabd1fd14",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/commit/cbcb93695a932d511c1c7bd40aed1eabeff01d8d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/releases/tag/V8_8_8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/releases/tag/V8_9_6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://research.cs.wisc.edu/htcondor/downloads",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://research.cs.wisc.edu/htcondor/security/vulnerabilities/HTCONDOR-2020-0003.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://research.cs.wisc.edu/htcondor/security/vulnerabilities/HTCONDOR-2020-0003.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1017/default-remediation-status"
            }
        ]
    }
}