{
    "source": "BDSA",
    "name": "BDSA-2021-1577",
    "title": "Zephyr Vulnerable to Local Code Execution via Kernel Memory Corruption with eswifi SPI Responses",
    "description": "Zephyr contains multiple buffer overflow issues in the eswifi driver. This could allow an attacker, who can manipulate the physical SPI bus between the host and target SoC, to cause kernel memory corruption which the vendor states could potentially allow local code execution with kernel privileges.",
    "technicalDescription": "The issue exists within the file `drivers/wifi/eswifi/eswifi_core.c`. Multiple buffer overflows are exploitable when parsing IP addresses and SSID names by sending maliciously crafted SPI responses on a target system.",
    "publishedDate": "2021-05-25T15:20:17.377Z",
    "updatedDate": "2022-07-22T17:36:19.544Z",
    "disclosureDate": "2021-04-26T00:00:00.000Z",
    "solution": "Fixed in [**2.4.0-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.4.0-rc1) by [this](https://github.com/zephyrproject-rtos/zephyr/commit/40e2d94bc88ac17a3e96bb95d08f1a21c9c6976f) commit, and in [**1.14.3**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v1.14.3) by [this](https://github.com/zephyrproject-rtos/zephyr/commit/6a2f9b647ccbb1ad42578552bc1a74feb8a6d598) commit.\n\nThe latest stable releases are available [here](https://github.com/zephyrproject-rtos/zephyr/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "(AV:L/AC:H/Au:N/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 0.5,
        "severity": "MEDIUM",
        "attackVector": "PHYSICAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.1/AV:P/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ruben Santamarta, IOActive",
    "workaround": "",
    "vendorFixDate": "2020-07-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1577",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-120"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13600",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1577/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.zephyrproject.org/latest/security/vulnerabilities.html#cve-2020-13600",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/40e2d94bc88ac17a3e96bb95d08f1a21c9c6976f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/6a2f9b647ccbb1ad42578552bc1a74feb8a6d598",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v1.14.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.4.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-hx4p-j86p-2mhr",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1577/default-remediation-status"
            }
        ]
    }
}