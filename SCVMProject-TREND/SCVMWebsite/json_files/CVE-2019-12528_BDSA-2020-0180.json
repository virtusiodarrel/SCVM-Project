{
    "source": "BDSA",
    "name": "BDSA-2020-0180",
    "title": "Squid Vulnerable to Information Exposure via FTP Server Listing Translation",
    "description": "Squid is vulnerable to information exposure due to improper processing of FTP server responses. This could allow an attacker to obtain sensitive information from heap memory, which depending on the Squid configuration could contain FTP directory listings or data from other processes on the system.",
    "technicalDescription": "The issue exists in the function `ftpListParseParts()` within the file `src/clients/FtpGateway.cc`. Improper buffer management in this function could lead to an out-of-bounds read condition which exposes random amounts of heap memory. If the `mempools` feature is enabled, the leaked memory will be limited to data from FTP directory listings. If `mempools` is disabled, the leaked memory may belong to other processes on the system.",
    "publishedDate": "2020-02-07T10:08:17.802Z",
    "updatedDate": "2021-09-01T14:26:50.026Z",
    "disclosureDate": "2020-02-02T00:00:00.000Z",
    "exploitPublishDate": "2021-08-27T00:00:00.000Z",
    "solution": "Fixed in **[4.10](https://github.com/squid-cache/squid/releases/tag/SQUID_4_10)** by [this](https://github.com/squid-cache/squid/commit/c1bebac9c1135b7add6589db35c62f16db195b8f) commit.\n\nFixed in the **3.5** branch by [this](https://github.com/squid-cache/squid/commit/8cdb18ca1829a0b7faa1c9e472604ed0e7e105ac) commit which is not included in any release.\n\nThe latest stable releases are available [here](http://www.squid-cache.org/Versions/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jeriko One",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, vendor-supplied patches for **3.x** and **4.x**are available [here](http://www.squid-cache.org/Advisories/SQUID-2020_2.txt).\n\nThe vendor also recommends as a workaround to disable FTP features:\n* Remove from `squid.conf`:\n\t* `acl Safe_ports 21`\n* Add to `squid.conf`:\n\t* `acl FTP proto FTP`\n\t* `http_access deny FTP`\n\nAdditionally, the vendor recommends a mitigation which reduces information leakage while retaining FTP features:\n* Remove from `squid.conf`:\n\t* `memory_pools off`",
    "vendorFixDate": "2019-12-20T00:00:00.000Z",
    "vendorNotifiedDate": "2019-05-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0180",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12528",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0180/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Advisories/SQUID-2020_2.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Advisories/SQUID-2020_2.txt",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/8cdb18ca1829a0b7faa1c9e472604ed0e7e105ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/c1bebac9c1135b7add6589db35c62f16db195b8f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/releases/tag/SQUID_4_10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/824163",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/824163",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0180/default-remediation-status"
            }
        ]
    }
}