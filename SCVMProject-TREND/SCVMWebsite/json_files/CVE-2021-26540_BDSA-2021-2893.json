{
    "source": "BDSA",
    "name": "BDSA-2021-2893",
    "title": "sanitize-html Vulnerable to Open Redirect and Hostname Whitelist Bypass via Improper Validation of Hostnames",
    "description": "It was discovered that sanitize-html failed to correctly handle hostnames set by the `allowedIframeHostnames` option when the `allowIframeRelativeUrls` is set to true.\n\n An attacker could exploit this flaw in order to bypass whitelisting of hostnames for the iframe element, or to trick a victim into being redirected to a malicious site using a crafted URL.",
    "technicalDescription": "This issue occurs in the `sanitizeHtml()` function within the `index.js` file because certain browsers accept `\\` as a substitute for `/` within the `//` element at the start of a url, and since whitespace is also permitted at this point. Tolerance of the use of these characters could potentially lead to successful usage of iframe validation exploits. It was mitigated by the addition of logic designed to ensure that the use of `\\` or whitespace is correctly handled.",
    "publishedDate": "2021-09-29T14:43:16.561Z",
    "updatedDate": "2021-09-29T14:43:16.548Z",
    "disclosureDate": "2021-02-28T00:00:00.000Z",
    "exploitPublishDate": "2021-02-28T00:00:00.000Z",
    "solution": "Fixed in version [**2.3.2**](https://github.com/apostrophecms/sanitize-html/releases/tag/2.3.2) by [this](https://github.com/apostrophecms/sanitize-html/commit/6012524e7824a2c8f6782b2bc5f93b1261723403) commit.\n\nThe latest stable releases can be found [here](https://github.com/apostrophecms/sanitize-html/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "@ronmasas (Ron Masas)",
    "workaround": "",
    "vendorFixDate": "2021-01-26T00:00:00.000Z",
    "discoveryDate": "2021-01-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2893",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-601"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-26540",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2893/ranges"
            },
            {
                "rel": "reference",
                "href": "https://advisory.checkmarx.net/advisory/CX-2021-4309",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://advisory.checkmarx.net/advisory/CX-2021-4309",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apostrophecms/sanitize-html/commit/6012524e7824a2c8f6782b2bc5f93b1261723403",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apostrophecms/sanitize-html/pull/460",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apostrophecms/sanitize-html/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apostrophecms/sanitize-html/releases/tag/2.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2893/default-remediation-status"
            }
        ]
    }
}