{
    "source": "BDSA",
    "name": "BDSA-2021-3878",
    "title": "Apache Solr Vulnerable to Information Disclosure and Remote Code Execution (RCE) via Uncontrolled Access to 'DataImportHandler'",
    "description": "Apache Solr is vulnerable to information disclosure due to insufficient restrictions being imposed on access to the `DataImportHandler` handler class. An attacker could leverage this issue to generate SMB requests and exfiltrate sensitive data from hosts within the network. An attacker could also potentially leverage this issue to execute arbitrary code on misconfigured systems.\n\nIt should be noted that this vulnerability only affects Windows systems.",
    "technicalDescription": "The `DataImportHandler` handler within Apache Solr utilizes the `SolrResourceLoader` class to retrieve resources from hosts.  The `openResource()` method will use this path to locate and read the file. Insufficient access controls are imposed on this functionality, such that an attacker that has access to the network could cause the server to submit malicious SMB requests. The attacker can achieve this if they can provide a UNC path to the `DataImportHandler` that will be resolved. This could allow the attacker to extract sensitive information from hosts on the network. If the hosts are misconfigured, then it may also be possible for the attacker to achieve arbitrary code execution.",
    "publishedDate": "2021-12-23T12:11:13.808Z",
    "updatedDate": "2022-09-29T11:01:19.910Z",
    "disclosureDate": "2021-12-18T00:00:00.000Z",
    "solution": "Fixed in version [**8.11.1**](https://github.com/apache/lucene-solr/releases/tag/releases%2Flucene-solr%2F8.11.1) by [this](https://github.com/apache/lucene-solr/commit/aa95d5440d3eef11fe20ffddd34ef7385cbefbb2) commit.\n\nThe latest stable releases can be found [here](https://solr.apache.org/downloads.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.5,
        "severity": "MEDIUM",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:A/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "LaiHan (Nsfocus Security Team)",
    "workaround": "",
    "vendorFixDate": "2021-12-06T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3878",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-749"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-44548",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3878/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/lucene-solr/commit/aa95d5440d3eef11fe20ffddd34ef7385cbefbb2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/lucene-solr/releases/tag/releases%2Flucene-solr%2F8.11.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/SOLR-15826",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://solr.apache.org/downloads.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://solr.apache.org/security.html#cve-2021-44548-apache-solr-information-disclosure-vulnerability-through-dataimporthandler",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3878/default-remediation-status"
            }
        ]
    }
}