{
    "source": "BDSA",
    "name": "BDSA-2020-0687",
    "title": "SQLite Vulnerable to Denial-of-Service (DoS) via Use-After-Free in 'renameTokenCheckAll' Function",
    "description": "SQLite contains a Use-After-Free vulnerability. Successfully exploiting this issue may allow attackers to cause a denial-of-service (DoS). This allows an attacker to cause SQLite to crash by issuing a crafted SQL query to the database.",
    "technicalDescription": "The `renameTokenCheckAll` function contains a use-after-free vulnerability due to the error-checking routine. The error-checking routine in `src/resolve.c ` does not validate the `IN_RENAME_OBJECT` value in `resolveOrderByTermToExprList` function before calling `db->suppressErr`. \nAdditionally, the `renameUnmapSelectCb` function in `src/alter.c` does not unmap all tokens in the IdList. \nThe combination of these issues can allow an attacker to craft an SQL query which could cause denial of service, this can be accomplished by renaming a table with `RENAME`. The crafted SQL query may require an `ORDER BY` clause that is part of a compound `SELECT` statement.\n\n**NOTE**: The error-checking routine in `renameTokenCheckAll` only runs in debugging mode.",
    "publishedDate": "2020-04-15T10:44:03.412Z",
    "updatedDate": "2020-07-27T14:21:20.105Z",
    "disclosureDate": "2020-04-02T00:00:00.000Z",
    "exploitPublishDate": "2020-04-02T00:00:00.000Z",
    "solution": "Fixed in **[3.32.0](https://github.com/sqlite/sqlite/releases/tag/version-3.32.0)** by [this](https://github.com/sqlite/sqlite/commit/fb99e388ec7f30fe43e4878236e3695ff24ae58d) commit and [this](https://github.com/sqlite/sqlite/commit/4db7ab53f9c30e2e22731ace93ab6b18eef6c4ae) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Henry Liu of Shenzhen Ankki Technologies Co.Ltd",
    "workaround": "",
    "vendorFixDate": "2020-04-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-0687",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2020-11656",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2020-0687/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sqlite/sqlite/commit/4db7ab53f9c30e2e22731ace93ab6b18eef6c4ae",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sqlite/sqlite/commit/fb99e388ec7f30fe43e4878236e3695ff24ae58d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sqlite/sqlite/releases/tag/version-3.32.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/src/info/4722bdab08cb1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.sqlite.org/src/info/4722bdab08cb1",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www3.sqlite.org/cgi/src/info/a10a14e9b4ba2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www3.sqlite.org/cgi/src/info/a10a14e9b4ba2",
                "label": "POC"
            }
        ]
    }
}