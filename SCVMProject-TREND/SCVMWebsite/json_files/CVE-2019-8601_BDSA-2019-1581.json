{
    "source": "BDSA",
    "name": "BDSA-2019-1581",
    "title": "WebKitGTK+ Vulnerable to Remote Code Execution (RCE) via JavaScript Spread Syntax",
    "description": "WebKitGTK+ is vulnerable to remote code execution (RCE) due to improper memory management when parsing JavaScript code. An attacker could leverage this flaw to cause memory corruption and execute arbitrary code on the underlying host by tricking a user into visiting a page with malicious web content.",
    "technicalDescription": "The vulnerability targets WebKit's Data Flow Graph (DFG) Just In Time (JIT) compiler and its incorrect memory allocation for arrays created using [JavaScript spread syntax](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax). The issue occurs specifically in `SpeculativeJIT::emitAllocateButterfly()` in `Source/JavaScriptCore/dfg/DFGSpeculativeJIT32_64.cpp` which performs a bitwise left shift operation on the length of the new array, but does not check if it overflows and becomes a much smaller number. This results in the JavaScript engine thinking it is working with an array of size larger than the actual allocated size and allows to perform out-of-bounds (OOB) reads and writes. By abusing the properties of `ArrayWithDouble` and `ArrayWithContiguous` array types, the OOB reads and writes could be leveraged to write any values to arbitrary memory addresses of the JIT process. Since due to the nature of its functionality the JIT memory page is marked as executable, the instructions written there may also be executed. This essentially allows for RCE just by parsing JavaScript code supplied by a malicious website.",
    "publishedDate": "2019-05-22T10:02:34.658Z",
    "updatedDate": "2020-08-19T09:36:46.207Z",
    "disclosureDate": "2019-05-20T00:00:00.000Z",
    "exploitPublishDate": "2020-01-02T00:00:00.000Z",
    "solution": "Fixed in version [**2.24.1**](https://webkitgtk.org/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Fluoroacetate working with Trend Micro\u2019s Zero Day Initiative",
    "workaround": "",
    "vendorFixDate": "2019-04-09T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1581",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-119"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-8601",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1581/ranges"
            },
            {
                "rel": "reference",
                "href": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/BadAccess11/CVE-2019-8601",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://webkitgtk.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://webkitgtk.org/security/WSA-2019-0003.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.zerodayinitiative.com/blog/2019/11/25/diving-deep-into-a-pwn2own-winning-webkit-bug",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1581/default-remediation-status"
            }
        ]
    }
}