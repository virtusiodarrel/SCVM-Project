{
    "source": "BDSA",
    "name": "BDSA-2019-0759",
    "title": "Rails Vulnerable to Remote Code Execution (RCE) via Weak Secret Token in Developer Mode",
    "description": "A cryptographically weak PRNG (Pseudo-Random Number Generator) vulnerability has been discovered in Ruby on Rails. An attacker could exploit this vulnerability to execute arbitrary code against the target system.",
    "technicalDescription": "A weakness has been discovered in Ruby on Rails which can lead to remote code execution (RCE). The pseudo-random calculation utilized to generate the secret key for the developer mode is not sufficient. An attacker could exploit this vulnerability by guessing the secret key and utilizing other Rails internals to execute arbitrary code against the system.\n\nThe `secret_key_base` function located in the file `railties/lib/rails/application.rb` generated a token value based on MD5 encryption (message-digest algorithm) which is considered extensively vulnerable.",
    "publishedDate": "2019-03-19T15:12:55.832Z",
    "updatedDate": "2019-03-28T10:21:31.513Z",
    "disclosureDate": "2019-03-13T00:00:00.000Z",
    "exploitPublishDate": "2019-03-23T00:00:00.000Z",
    "solution": "Fixed in version [**6.0.0-Beta3**](https://github.com/rails/rails/releases/tag/v6.0.0.beta3) by [this](https://github.com/rails/rails/commit/4c743587ad6a31908503ab317e37d70361d49e66) commit.\nFixed in version [**5.2.2.1**](https://github.com/rails/rails/releases/tag/v5.2.2.1) by [this](https://github.com/rails/rails/commit/7f5ccda38bfecbe0bf00f15e5b8f5e40d52ab3f1) commit.",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ooooooo_q",
    "workaround": "This issue can be mitigated by specifying a secret key in the development mode. In the `config/environments/development.rb` add `config.secret_key_base = SecureRandom.hex(64)`.",
    "vendorFixDate": "2019-03-10T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0759",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-338"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5420",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0759/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1689154",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mpgn/Rails-doubletap-RCE",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/4c743587ad6a31908503ab317e37d70361d49e66",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/7f5ccda38bfecbe0bf00f15e5b8f5e40d52ab3f1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v5.2.2.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v6.0.0.beta3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/forum/#!topic/rubyonrails-security/IsQKvDqZdKw",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0759/default-remediation-status"
            }
        ]
    }
}