{
    "source": "BDSA",
    "name": "BDSA-2020-2343",
    "title": "Knot Resolver Vulnerable to DNS Amplification via Crafted DNS Answer",
    "description": "PowerDNS Recursor is vulnerable to DNS Amplification via a flaw in its implementation of the Domain Name System (DNS) protocol between recursive and authoritative name servers. An attacker that controls an authoritative name server could use crafted replies to amplify the traffic between a recursor and other servers, resulting in degraded performance on both sides.",
    "technicalDescription": "Whenever Unbound is processing NS records that contain an unknown sub-domain in the `NSDNAME` of a NS delegation record, it must send out a request in order to get the associated IP address. If the domain cannot be resolved, the server will attempt to resolve the next unknown sub-domain. This will continue for all of the unknown-sub domains, meaning that a large number of requests can potentially be generated by a server. A remote attacker could therefore cause amplification by sending maliciously crafted delegation records containing random, non-existent sub domains. This could allow the attacker to use the server to conduct a denial-of-service (DoS) attack against another machine.",
    "publishedDate": "2020-09-11T14:44:41.462Z",
    "updatedDate": "2020-09-11T14:44:41.453Z",
    "disclosureDate": "2020-05-19T00:00:00.000Z",
    "solution": "Fixed in [**5.1.1**](https://gitlab.nic.cz/knot/knot-resolver/-/tags/v5.1.1) by [this](https://gitlab.nic.cz/knot/knot-resolver/-/commit/ba7b89db780fe3884b4e90090318e25ee5afb118?merge_request_iid=1003) commit and [this](https://gitlab.nic.cz/knot/knot-resolver/-/commit/54f05e4d7b2e47c0bdd30b84272fc503cc65304b?merge_request_iid=1003) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-05-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2343",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-406"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12667",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2343/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.nxnsattack.com/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.nic.cz/knot/knot-resolver/-/commit/54f05e4d7b2e47c0bdd30b84272fc503cc65304b?merge_request_iid=1003",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.nic.cz/knot/knot-resolver/-/commit/54f05e4d7b2e47c0bdd30b84272fc503cc65304b?merge_request_iid=1003",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.nic.cz/knot/knot-resolver/-/commit/ba7b89db780fe3884b4e90090318e25ee5afb118?merge_request_iid=1003",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.nic.cz/knot/knot-resolver/-/commit/ba7b89db780fe3884b4e90090318e25ee5afb118?merge_request_iid=1003",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.nic.cz/knot/knot-resolver/-/tags/v5.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/05/19/2",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2343/default-remediation-status"
            }
        ]
    }
}