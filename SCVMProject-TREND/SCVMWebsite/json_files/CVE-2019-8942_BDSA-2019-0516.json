{
    "source": "BDSA",
    "name": "BDSA-2019-0516",
    "title": "WordPress Vulnerable to Remote Code Execution (RCE) via Crafted '_wp_attached_file' Post Meta Value File Upload",
    "description": "WordPress is vulnerable to remote code execution (RCE) due to a remote file upload vulnerability.  This allows a remote attacker with the privileges as \"author\" to upload malicious file types that can then be used to execute code on the hosting server.\n\nNote:  This RCE vulnerability works in conjunction with CVE-2019-8943 and CVE-2019-6977.",
    "technicalDescription": "The RCE vulnerability in WordPress core is due to a lack of sanitization or validation on `_wp_attached_file` post meta values.  These values contain the names of files hosted on the system. There are no sufficient validation checks when functions manipulating these values are called, allowing an attacker to change the file name to any arbitrary value.  \n\nThis allows a remote attacker to specify a malicious file type such as `.php`  by appending the file extension to a valid mime type, e.g. `file.jpg?malicious.php`. In some instances, this file will get a valid mime type appended to the file, which will prevent the malicious `.php` file from being executable.  \n\nAlthough research has shown that, since WordPress uses either ImageMagick or libgd (CVE-2019-6977) to process image files, it is possible to embed the malicious code into the `exif` meta data section of the uploaded file. This image file will then be uploaded to an arbitrary location (CVE-2019-8943) and can be executed.",
    "publishedDate": "2019-02-25T17:06:38.761Z",
    "updatedDate": "2019-04-05T11:20:01.393Z",
    "disclosureDate": "2019-02-19T00:00:00.000Z",
    "exploitPublishDate": "2019-02-19T00:00:00.000Z",
    "solution": "Fixed in versions [**4.9.9**](https://wordpress.org/download/releases/) and [**5.0.1**](https://wordpress.org/download/releases/).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.1,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.2
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Simon Scannell",
    "workaround": "",
    "vendorFixDate": "2019-02-21T00:00:00.000Z",
    "vendorNotifiedDate": "2018-10-16T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0516",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-616"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-8942",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0516/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://wordpress.org/download/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.rapid7.com//db/modules/exploit/multi/http/wp_crop_rce",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0516/default-remediation-status"
            }
        ]
    }
}