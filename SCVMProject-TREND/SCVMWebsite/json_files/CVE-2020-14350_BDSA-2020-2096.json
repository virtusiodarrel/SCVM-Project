{
    "source": "BDSA",
    "name": "BDSA-2020-2096",
    "title": "PostgreSQL Vulnerable to Arbitrary SQL Code Execution via CREATE EXTENSION Statements",
    "description": "PostgreSQL is vulnerable to execution of arbitrary SQL functions.  If a superuser executes certain `CREATE EXTENSION` statements then a user may be able to execute arbitrary functions under the identity of the superuser.",
    "technicalDescription": "The attacker must have object creation permissions in the new extension's schema or a schema of a prerequisite extension.  Hostile objects located within the installation-time `search_path` could capture references in an extension's installation or upgrade script. If the extension is being installed with superuser privileges, this could lead to privilege escalation.  Only certain extensions are vulnerable.\n\n Per the vendor:\n \n> To mitigate this risk, be more careful about the search_path used to run an installation script; disable check_function_bodies within the script; and fix catalog-adjustment queries used in some contrib modules to ensure they are secure. Also provide documentation to help third-party extension authors make their installation scripts secure. This is not a complete solution; extensions that depend on other extensions can still be at risk if installed carelessly.",
    "publishedDate": "2020-08-18T15:51:13.471Z",
    "updatedDate": "2020-08-18T15:51:13.606Z",
    "disclosureDate": "2020-08-04T00:00:00.000Z",
    "solution": "Fixed in [**REL_11_9**](https://github.com/postgres/postgres/releases/tag/REL_11_9) by [this](https://github.com/postgres/postgres/commit/afa358786bde70d9cccc0e32f6fad45afe62c3e5) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dhananjay Arunesh",
    "workaround": "",
    "vendorFixDate": "2020-08-10T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2096",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14350",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2096/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/1175194",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/commit/afa358786bde70d9cccc0e32f6fad45afe62c3e5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/postgres/postgres/releases/tag/REL_11_9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.postgresql.org/docs/11/release-11-9.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2096/default-remediation-status"
            }
        ]
    }
}