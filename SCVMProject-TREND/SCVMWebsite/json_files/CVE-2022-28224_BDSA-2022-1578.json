{
    "source": "BDSA",
    "name": "BDSA-2022-1578",
    "title": "Calico Vulnerable to Man-in-the-Middle (MitM) Attacks via Floating IP Address Feature",
    "description": "Calico is vulnerable to man-in-the-middle (MitM) attacks due to insufficient restrictions being placed on the floating IP address feature. An attacker with the ` [\u201cpatch\u201d, \u201cpods\u201d]` Kubernetes Role Based Access Control (RBAC) permission could potentially intercept traffic by annotating a pod after it has been created. This could potentially allow the attacker to obtain or modify sensitive information that resides within the routed traffic.",
    "technicalDescription": "Floating IP addresses can be configured for pods via Calico's pod annotation functionality. This floating IP address feature can be disabled, which should prevent users from configuring such addresses even if they possess the required `[\u201cpatch\u201d, \u201cpods\u201d]` Kubernetes RBAC privilege. However, if a pod is annotated directly after creation, then the floating IP address policy will be ignored. An attacker that possesses the aforementioned privilege could use malicious floating IP address annotations in order to route traffic to a node that they control, which could allow them to obtain (or modify) sensitive information that resides within that traffic.",
    "publishedDate": "2022-06-07T11:49:56.241Z",
    "updatedDate": "2022-06-07T11:49:56.228Z",
    "disclosureDate": "2022-06-01T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.22.2**](https://github.com/projectcalico/calico/releases/tag/v3.22.2) by [this](https://github.com/projectcalico/calico/commit/3def0163642f456e11806efd03825cff920a7a0b) commit.\n* [**3.21.5**](https://github.com/projectcalico/calico/releases/tag/v3.21.5) by [this](https://github.com/projectcalico/calico/commit/7008cd161591e928de455fa1d78b47d87d342564) commit.\n* [**3.20.5**](https://github.com/projectcalico/calico/releases/tag/v3.20.5)\n\nThe latest stable releases can be found [here](https://github.com/projectcalico/calico/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.0,
        "impactSubscore": 3.7,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Aloys Augustin (Cisco)",
    "workaround": "The vendor has stated [here](https://www.tigera.io/security-bulletins-tta-2022-001/) that the following workaround can be implemented:\n\n> Review Kubernetes RBAC and review access to [\u201cpatch\u201d, \u201cpods\u201d].",
    "vendorFixDate": "2022-04-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1578",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-28224",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1578/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/calico/commit/3def0163642f456e11806efd03825cff920a7a0b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/calico/commit/7008cd161591e928de455fa1d78b47d87d342564",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/calico/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/calico/releases/tag/v3.20.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/calico/releases/tag/v3.21.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectcalico/calico/releases/tag/v3.22.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.tigera.io/security-bulletins-tta-2022-001/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.tigera.io/security-bulletins-tta-2022-001/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1578/default-remediation-status"
            }
        ]
    }
}