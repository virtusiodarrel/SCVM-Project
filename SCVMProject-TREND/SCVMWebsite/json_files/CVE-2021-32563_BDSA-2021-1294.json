{
    "source": "BDSA",
    "name": "BDSA-2021-1294",
    "title": "Thunar Vulnerable to Remote Code Execution (RCE) via Command Line Arguments",
    "description": "Thunar is vulnerable to remote code execution (RCE) due to the way in which command line arguments are parsed. This could allow an attacker to execute malicious code.",
    "technicalDescription": "This vulnerability occurs in the `thunar_application_process_files_finish()` function of `thunar/thunar-application.c`. When a command line argument is used to call a regular file, Thunar will look for the default application for the file and will open the file in that application without user confirmation. This could allow an attacker to execute malicious code. \n\nThe vendor has mitigated against this by ensuring Thunar will instead open the containing folder and select the file.",
    "publishedDate": "2021-05-11T13:59:51.403Z",
    "updatedDate": "2022-05-09T14:01:24.714Z",
    "disclosureDate": "2021-05-09T00:00:00.000Z",
    "exploitPublishDate": "2021-05-09T00:00:00.000Z",
    "solution": "Fixed in **4.17.2** by [this](https://gitlab.xfce.org/xfce/thunar/-/commit/9165a61f95e43cc0b5abf9b98eee2818a0191e0b) commit, and in **4.16.7** by [this](https://gitlab.xfce.org/xfce/thunar/-/commit/495324deecaea458fce8cd3778fea23ecd57a044) commit. \n\nHowever this fix introduced a regression which was subsequently fixed in [**4.17.3**](https://gitlab.xfce.org/xfce/thunar/-/tags/thunar-4.17.3) by [this](https://gitlab.xfce.org/xfce/thunar/-/commit/3b54d9d7dbd7fd16235e2141c43a7f18718f5664) commit, and in [**4.16.8**](https://gitlab.xfce.org/xfce/thunar/-/tags/thunar-4.16.8) by [this](https://gitlab.xfce.org/xfce/thunar/-/commit/0afccd803b264d03da0a9b02772400245fe5b6cc) commit. \n\nThe latest stable releases are available [here](https://gitlab.xfce.org/xfce/thunar/-/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-04-30T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1294",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32563",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1294/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.xfce.org/xfce/thunar/-/commit/0afccd803b264d03da0a9b02772400245fe5b6cc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.xfce.org/xfce/thunar/-/commit/3b54d9d7dbd7fd16235e2141c43a7f18718f5664",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.xfce.org/xfce/thunar/-/commit/495324deecaea458fce8cd3778fea23ecd57a044",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.xfce.org/xfce/thunar/-/commit/9165a61f95e43cc0b5abf9b98eee2818a0191e0b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.xfce.org/xfce/thunar/-/issues/121",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.xfce.org/xfce/thunar/-/issues/121",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.xfce.org/xfce/thunar/-/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.xfce.org/xfce/thunar/-/tags/thunar-4.16.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.xfce.org/xfce/thunar/-/tags/thunar-4.17.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/05/09/2",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1294/default-remediation-status"
            }
        ]
    }
}