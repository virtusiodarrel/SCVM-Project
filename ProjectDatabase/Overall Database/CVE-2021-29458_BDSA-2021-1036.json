{
    "source": "BDSA",
    "name": "BDSA-2021-1036",
    "title": "Exiv2 Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Read in 'crwimage_int.cpp' File",
    "description": "Exiv2 contains a out-of-bounds read vulnerability because of improper checks in place for metadata writing operations. An attacker could trick a victim to initiate write operations on a crafted image file and crash the application. This could cause a denial-of-service (DoS).",
    "technicalDescription": "This vulnerability exists in the `src/crwimage_int.cpp` file. The `CrwMap::encode0x1810()` function in this file does not correctly perform bounds checking for `cc->size()` before its value if assigned to `size`. This could lead to a negative integer overflow condition when the value of `cc->size()` is out of bounds.  Subsequently, this can cause an out-of-bounds read condition when the application is handling a crafted image file. An attacker could supply such a crafted file and crash the application when it is writing metadata to this file. For this attack to work, the attacker must trick the victim to use this crafted image file for writing metadata. Also, the victim must use special command-line arguments like `insert` to trigger this vulnerability.\n\n**Note** This vulnerability is only triggered for write operations and not read operations on image files.",
    "publishedDate": "2021-04-20T14:16:59.340Z",
    "updatedDate": "2021-11-30T15:12:26.668Z",
    "disclosureDate": "2021-04-18T00:00:00.000Z",
    "exploitPublishDate": "2021-04-08T00:00:00.000Z",
    "solution": "Fixed in [**0.27.4-RC2**](https://github.com/Exiv2/exiv2/releases/tag/v0.27.4-RC2) by [this](https://github.com/Exiv2/exiv2/commit/9e6a5200893226056c1bb424bb4e3e1caf625991) commit.\n\nThe latest stable releases are available [here](https://github.com/Exiv2/exiv2/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Zhen Zhou of NSFOCUS Security Team",
    "workaround": "",
    "vendorFixDate": "2021-04-09T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1036",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-29458",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1036/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/commit/9e6a5200893226056c1bb424bb4e3e1caf625991",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/issues/1530",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/issues/1530",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/releases/tag/v0.27.4-RC2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/security/advisories/GHSA-57jj-75fm-9rq5",
                "label": "ADVISORY"
            }
        ]
    }
}