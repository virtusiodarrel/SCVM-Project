{
    "source": "BDSA",
    "name": "BDSA-2021-3423",
    "title": "Dolibarr Vulnerable to Remote Code Execution (RCE) via Insufficient Input Sanitization in 'Website' Builder Module",
    "description": "Dolibarr is vulnerable to a remote code execution (RCE) issue due to a lack of sufficient input sanitization in the `website`  module.\n\nAn attacker with administrative privileges could abuse this issue and circumvent existing protection measures by submitting a crafted input that uses backtick (\\`) characters in order to execute arbitrary commands and code on the system.",
    "technicalDescription": "Dolibarr is vulnerable to remote code execution (RCE) because the `website` module does not completely block code execution statements. On default settings, the application blocks statements like `exec()`, `system()` and `shell_exec()`, however, it is possible to use backtick (\\`) characters to avoid protection measures and submit malicious commands or code. The website can then display results of executed commands.\n\nTo remedy this issue, the vendor has added more validation to the security analysis code in the `htdocs/website/index.php` file to specifically block the use of backtick characters.",
    "publishedDate": "2021-11-12T12:13:42.737Z",
    "updatedDate": "2021-11-12T12:13:42.725Z",
    "disclosureDate": "2021-11-10T00:00:00.000Z",
    "exploitPublishDate": "2021-11-10T00:00:00.000Z",
    "solution": "Fixed in [**14.0.0**](https://github.com/Dolibarr/dolibarr/releases/tag/14.0.0) by [this](https://github.com/Dolibarr/dolibarr/commit/2681d581075c69544b67cb1bd491b848896f46ea) commit.\n\nThe latest stable releases are available [here](https://www.dolibarr.org/downloads.php).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Trovent Security GmbH, Nick Decker",
    "workaround": "The third-party issue reporter has recommended [here](https://trovent.io/security-advisory-2106-01) to disable the `website` module until a fixed version can be deployed.",
    "vendorFixDate": "2021-06-09T00:00:00.000Z",
    "discoveryDate": "2021-06-01T00:00:00.000Z",
    "vendorNotifiedDate": "2021-06-09T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3423",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33816",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3423/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/commit/2681d581075c69544b67cb1bd491b848896f46ea",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Dolibarr/dolibarr/releases/tag/14.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://trovent.io/security-advisory-2106-01",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://trovent.io/security-advisory-2106-01",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://trovent.io/security-advisory-2106-01",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.dolibarr.org/downloads.php",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3423/default-remediation-status"
            }
        ]
    }
}