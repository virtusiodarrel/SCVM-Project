{
    "source": "BDSA",
    "name": "BDSA-2020-1364",
    "title": "UPnP Applications Vulnerable to Data Exfiltration and Denial-of-Service (DoS) via UPnP SUBSCRIBE Requests",
    "description": "UPnP applications, including hostapd and ReadyMedia, are vulnerable to data exfiltration and denial-of-service (DoS) due to flaws in the definition of the Open Connectivity Foundation UPnP specification and its implementation. This could allow an attacker, in control of a device connected to a local network, to trigger the connected access point to initiate HTTP connections to arbitrary URLs. This could bypass restrictions on network connections and facilitate unauthorized data exfilitration or amplified TCP distributed denial-of-service (DDoS) attacks. An attacker could also exploit this by suppling crafted requests which can cause a denial-of-service (DoS) via process termination or excessive CPU consumption.",
    "technicalDescription": "The UPnP specification improperly allows SUBSCRIBE requests to be accepted with a delivery URL - which can be controlled by an attacker via the `Callback` header value - that is on a different network segment than the fully qualified event-subscription URL. This can be leveraged by an attacker if they are able to discover the UPnP service on the local network, and can open a TCP connection towards the IP address of the access point. This could allow them to send requests as if they originate from the access point, and exfiltrate data which bypasses any restrictions on connections to external networks that apply to local devices. \n\nThis issue could also be leveraged by an attacker to perform amplified TCP DDoS attacks, against arbitrary targets, using UPnP devices. SUBSCRIBE requests can be used in such attacks as UPnP attempts to establish TCP handshakes with multiple SYN packets for all `Callback` values in the request.\n\nAdditionally in hostapd, implementation-specific issues could be exploited to cause a DoS of the service and host system using malicious SUBSCRIBE requests:\n* insufficient validation of long URL paths could result in a buffer overflow during event message generation which terminates the hostapd process,\n* improper handling of HTTP initiation failures could result in repeated attempts to retransmit events and consumption of excessive CPU resources on the host system.",
    "publishedDate": "2020-06-11T10:19:41.944Z",
    "updatedDate": "2021-10-01T14:20:22.368Z",
    "disclosureDate": "2020-06-08T00:00:00.000Z",
    "exploitPublishDate": "2020-06-08T00:00:00.000Z",
    "solution": "Fixed in hostapd by these commits in the **master** branch which are not yet included in any release:\n* [Commit 1](https://w1.fi/cgit/hostap/commit/?id=5b78c8f961f25f4dc22d6f2b77ddd06d712cec63)\n* [Commit 2](https://w1.fi/cgit/hostap/commit/?id=f7d268864a2660b7239b9a8ff5ad37faeeb751ba)\n* [Commit 3](https://w1.fi/cgit/hostap/commit/?id=85aac526af8612c21b3117dadc8ef5944985b476)\n\nFixed in ReadyMedia version [**1.3.0**](https://sourceforge.net/projects/minidlna/files/minidlna/1.3.0/).\n\nFixed in GuPnP version [**1.0.6**](https://gitlab.gnome.org/GNOME/gupnp/-/tags/gupnp-1.0.6).\n\nFixed in GSSDP version [**1.0.5**](https://gitlab.gnome.org/GNOME/gssdp/-/tags/gssdp-1.0.5).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:A/AC:L/Au:N/C:P/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "CallStranger",
    "workaround": "If upgrading to a fixed hostapd version cannot be performed immediately, the vendor recommends disablinge WPS UPnP support in the hostapd runtime configuration by removing the `upnp_iface` parameter.",
    "vendorFixDate": "2020-06-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1364",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12695",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1364/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yunuscadirci/CallStranger",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/gssdp/-/tags/gssdp-1.0.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.gnome.org/GNOME/gupnp/-/tags/gupnp-1.0.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://kb.cert.org/vuls/id/339275",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q2/173",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2020/q2/173",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://sourceforge.net/projects/minidlna/files/minidlna/1.3.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ubuntu.com/security/notices/USN-4722-1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=5b78c8f961f25f4dc22d6f2b77ddd06d712cec63",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=85aac526af8612c21b3117dadc8ef5944985b476",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=f7d268864a2660b7239b9a8ff5ad37faeeb751ba",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.callstranger.com/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.tenable.com/blog/cve-2020-12695-callstranger-vulnerability-in-universal-plug-and-play-upnp-puts-billions-of",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1364/default-remediation-status"
            }
        ]
    }
}