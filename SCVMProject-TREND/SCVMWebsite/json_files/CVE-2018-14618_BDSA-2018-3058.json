{
    "source": "BDSA",
    "name": "BDSA-2018-3058",
    "title": "Libcurl Vulnerable to Denial-of-service (DOS) via Integer Overflow in NTLM Authentication Code",
    "description": "An integer overflow is present in the NTLM authentication code in Libcurl. This can be exploited by an attacker to trigger a denial-of-service (DoS) condition. This issue is almost identical to CVE-2017-8816. \n\nThe issue is only present on 32-bit systems. It also requires the password field to use more than 2GB of memory which should be rare.",
    "technicalDescription": "The `Curl_ntlm_core_mk_nt_hash` function multiplies the length of the password by two (SUM) to figure out how much heap memory is needed for temporary storage. \n\nThe length is then used to iterate over the password and generate output into the allocated buffer.  On systems with a where `size_t` is 32 bits, the math used to calculate `SUM` will trigger an integer overflow when the password length exceeds 2GB(2^31 bytes).   \n\nThis results in the creation of a very small buffer rather than a very large one triggering a heap buffer overflow.",
    "publishedDate": "2018-09-06T09:50:25.746Z",
    "updatedDate": "2019-11-18T16:40:17.938Z",
    "disclosureDate": "2018-07-18T00:00:00.000Z",
    "exploitPublishDate": "2018-07-18T00:00:00.000Z",
    "solution": "Fixed in [**7.61.1**](https://github.com/curl/curl/releases/tag/curl-7_61_1) by [this](https://github.com/curl/curl/commit/57d299a499155d4b327e341c6024e293b0418243.patch) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Zhaoyang Wu",
    "workaround": "The vendor has given the following advice for mitigation:\n\n\"Put length restrictions on the password you can pass to libcurl\"",
    "vendorFixDate": "2018-08-13T00:00:00.000Z",
    "vendorNotifiedDate": "2018-07-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3058",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-131"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-14618",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3058/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.haxx.se/docs/CVE-2018-14618.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://curl.haxx.se/docs/CVE-2018-14618.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/57d299a499155d4b327e341c6024e293b0418243.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/issues/2756",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/issues/2756",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_61_1",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}