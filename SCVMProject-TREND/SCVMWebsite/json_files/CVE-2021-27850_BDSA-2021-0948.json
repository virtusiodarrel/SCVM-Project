{
    "source": "BDSA",
    "name": "BDSA-2021-0948",
    "title": "Apache Tapestry Vulnerable to Remote Code Execution (RCE) via CVE-2019-0195 Bypass",
    "description": "It was found that the fix to `CVE-2019-0195` was incomplete, leaving Apache Tapestry vulnerable to information disclosure that leads to remote code execution (RCE). An attacker who is able to manipulate the URLs of classpath asset files could download arbitrary files within the classpath. The disclosed information could be used to craft Java deserialization attacks, resulting in arbitrary code injection and RCE.",
    "technicalDescription": "An attacker could download the `AppModule.class` file via a crafted URL, such as `http://localhost:8080/assets/something/services/AppModule.class`. `AppModule.class` contains a secret HMAC key that is used to sign serialized Java objects. The attacker could then use the HMAC key to craft a Java deserialization attack and inject arbitrary code via a Java gadget chain. The attack could be carried out via the `t:formdata` parameter in the `Form` component.\n\nThe vulnerability was initially thought to be fixed by a adding a blacklist filter that checks if the URL ends with `.class`, `.properties` or `.xml`. However it has been found that the filter can be bypassed by adding a `/` character at the end. The bypass has also been fixed.",
    "publishedDate": "2021-04-15T16:19:41.291Z",
    "updatedDate": "2021-07-14T09:50:18.312Z",
    "disclosureDate": "2021-04-14T00:00:00.000Z",
    "exploitPublishDate": "2021-06-25T00:00:00.000Z",
    "solution": "There was an attempt to fix this vulnerability in **5.4.4** by [this](https://github.com/apache/tapestry-5/commit/d4e4982f940b47143fc88ffaecfc813e5b34ee32) and [this](https://github.com/apache/tapestry-5/commit/ff599ed6ba0ed64ee18e12d964b05cd03a958b4a) commit. However, these fixes were incomplete.\n\nThe vulnerability has been fully fixed in **[5.6.3](https://github.com/apache/tapestry-5/releases/tag/5.6.3)** by [this](https://github.com/apache/tapestry-5/commit/2089b0d52) commit and in **[5.7.1](https://github.com/apache/tapestry-5/releases/tag/5.7.1)** by [this](https://github.com/apache/tapestry-5/commit/1a0da382e) commit.\n\nThe latest stable releases are available [here](https://tapestry.apache.org/download.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Johannes Moritz",
    "workaround": "",
    "vendorFixDate": "2021-02-28T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0948",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-27850",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0948/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/commit/1a0da382e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/commit/2089b0d52",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/commit/d4e4982f940b47143fc88ffaecfc813e5b34ee32",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/commit/ff599ed6ba0ed64ee18e12d964b05cd03a958b4a",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/releases/tag/5.6.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/tapestry-5/releases/tag/5.7.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/kahla-sec/CVE-2021-27850_POC",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/5173c4eed06e2fca6fd5576ed723ff6bb1711738ec515cb51a04ab24@%3Cusers.tapestry.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/r237ff7f286bda31682c254550c1ebf92b0ec61329b32fbeb2d1c8751@%3Cusers.tapestry.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://tapestry.apache.org/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0948/default-remediation-status"
            }
        ]
    }
}