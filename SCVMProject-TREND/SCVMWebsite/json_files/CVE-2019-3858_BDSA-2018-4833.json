{
    "source": "BDSA",
    "name": "BDSA-2018-4833",
    "title": "libssh2 Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Read in 'sftp_packet_read()' Function",
    "description": "libssh2 is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could crash a victim's instance of the application by tricking them into connecting to a malicious server.",
    "technicalDescription": "The function `sftp_packet_read()`, defined within `sftp.c`, contains code that is used to store data from received SFTP packets in memory. In order to do so, it allocates a buffer using the function `LIBSSH2_ALLOC()`. The received SFTP packet is accessed as a structure, with the `partial_len` component being used to determine how much memory should be allocated. This memory is then accessed at various offsets so that the packet's data can be written to it. If the `partial_len` variable has a value of zero, no memory will be allocated. Any attempt to access the buffer in order to write data will therefore constitute an out-of-bounds write operation. Such an operation can lead to an exception being generated, which will halt program execution. An attacker could therefore crash a victim's instance of libssh2 by suppling them with SFTP packets in which `partial_len` is zero. The attacker could achieve this by tricking the victim into connecting to a malicious server.",
    "publishedDate": "2019-04-05T13:27:24.249Z",
    "updatedDate": "2019-04-05T13:27:24.230Z",
    "disclosureDate": "2019-03-18T00:00:00.000Z",
    "solution": "Fixed in version [**1.8.1**](https://github.com/libssh2/libssh2/releases/tag/libssh2-1.8.1) by [this](https://github.com/libssh2/libssh2/commit/f15b1e297f72882214988101ccdc5e6ad30d7e6e) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Chris Coulson",
    "workaround": "",
    "vendorFixDate": "2019-03-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-4833",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-3858",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-4833/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libssh2/libssh2/commit/f15b1e297f72882214988101ccdc5e6ad30d7e6e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libssh2/libssh2/releases/tag/libssh2-1.8.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.libssh2.org/CVE-2019-3858.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-4833/default-remediation-status"
            }
        ]
    }
}