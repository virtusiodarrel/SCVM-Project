{
    "source": "BDSA",
    "name": "BDSA-2020-1267",
    "title": "PowerDNS Recursor Vulnerable to DNS Amplification via Crafted Referrals from Authoritative Nameservers",
    "description": "PowerDNS Recursor is vulnerable to DNS Amplification via a flaw in Domain Name System (DNS) protocol between recursive and authoritative name servers. An attacker that controls an authoritative name server could use its crafted reply to amplify the traffic between Recursor and other authoritative name servers, resulting in degraded performance on both sides.",
    "technicalDescription": "This vulnerability comes from the fact that DNS recursive resolvers exchange a lot of (more than expected in theory) messages upon receiving a NS referral response that contains name servers without their corresponding IP addresses. Attackers could abuse this by sending crafted NS referrals to Recursor for names(subdomains) which are authorized using their own authoritative name servers, forcing Recursor to query other name servers to resolve the referred name servers' IP addresses. Because of this the traffic created between Recursor and other name servers may degrade their performance, as well as saturate NS resolvers' caches.",
    "publishedDate": "2020-05-29T15:56:56.343Z",
    "updatedDate": "2020-05-29T15:56:56.337Z",
    "disclosureDate": "2020-05-19T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.3.1**](https://github.com/PowerDNS/pdns/releases/tag/rec-4.3.1) by [this](https://github.com/PowerDNS/pdns/commit/77546322698af9bc25a647a527cb1717d90e9dd6) commit.\n* [**4.2.2**](https://github.com/PowerDNS/pdns/releases/tag/rec-4.2.2) by [this](https://github.com/PowerDNS/pdns/commit/20166d8bccaace7594a6abc4574852b042aca4a8) commit.\n* [**4.1.16**](https://github.com/PowerDNS/pdns/releases/tag/rec-4.1.16) by [this](https://github.com/PowerDNS/pdns/commit/e792445afe660662ce24cea009182fcdbcca85d5) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Lior Shafir, Yehuda Afek, Anat Bremler-Barr",
    "workaround": "",
    "vendorFixDate": "2020-03-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1267",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-406"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10995",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1267/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.nxnsattack.com/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://doc.powerdns.com/recursor/security-advisories/powerdns-advisory-2020-01.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/commit/20166d8bccaace7594a6abc4574852b042aca4a8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/commit/77546322698af9bc25a647a527cb1717d90e9dd6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/commit/e792445afe660662ce24cea009182fcdbcca85d5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/releases/tag/rec-4.1.16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/releases/tag/rec-4.2.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/releases/tag/rec-4.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1267/default-remediation-status"
            }
        ]
    }
}