{
    "source": "BDSA",
    "name": "BDSA-2021-1645",
    "title": "Mozilla Firefox and Firefox ESR Vulnerable to Memory Corruption via Memory Safety Flaws",
    "description": "Mozilla Firefox and Firefox ESR are vulnerable to memory corruption due to the presence of multiple memory safety flaws.\n \n **Note:** The vendor has stated [here](https://www.mozilla.org/en-US/security/advisories/mfsa2021-24/#CVE-2021-29967) that they presume that with enough effort some of these could have been exploited to run arbitrary code.\n\nThis has been considered when scoring the impact these memory safety bugs may have on a system.",
    "technicalDescription": "Memory safety issues exist in multiple locations:\n* Thread crash in `_platform_memmove$VARIANT$Haswell`\n* Heap use after free in `IPC::Channel::CloseClientFileDescriptor()`\n* Thread crash in `mozilla::glue::LoaderObserver::OnEndDllLoad`\n* Failed assertion in `incBitmap->isMarkedAny(cell)`\n* Heap buffer overflow in `js::wasm::LazyStubSegment::addStubs`",
    "publishedDate": "2021-06-03T12:52:34.792Z",
    "updatedDate": "2021-12-06T13:40:28.771Z",
    "disclosureDate": "2021-06-01T00:00:00.000Z",
    "solution": "Fixed in Firefox version [**89.0**](https://ftp.mozilla.org/pub/firefox/releases/89.0/) and Firefox ESR version [**78.11**](https://ftp.mozilla.org/pub/firefox/releases/78.11.0esr/) by the following revisions:\n* [Bug 1602862](https://hg.mozilla.org/mozilla-central/rev/630f37b668d88d30886d42c76e76ee0bef0afd0a)\n* [Bug 1703191](https://hg.mozilla.org/mozilla-central/rev/f96995cdc23511263ad0fd935c4680f8cfe51fa3)\n* [Bug 1703760](https://hg.mozilla.org/mozilla-central/rev/695cd7455aedcd7dd0edd6026ba9c016eec19601)\n* [Bug 1704722](https://hg.mozilla.org/mozilla-central/rev/e1484bb05982e24801a711c757923b6cde77b492)\n* [Bug 1706041](https://hg.mozilla.org/mozilla-central/rev/68af0a79c75edd1ebe42ff4bb7b04dda66817766)\n\nThe latest stable releases are available [here](https://ftp.mozilla.org/pub/firefox/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Gabriele Svelto, Anny Gakhokidze, Alexandru Michis, Christian Holler",
    "workaround": "",
    "vendorFixDate": "2021-05-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1645",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-465"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-29967",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1645/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/buglist.cgi?bug_id=1602862%2C1703191%2C1703760%2C1704722%2C1706041",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/78.11.0esr/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ftp.mozilla.org/pub/firefox/releases/89.0/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/630f37b668d88d30886d42c76e76ee0bef0afd0a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/68af0a79c75edd1ebe42ff4bb7b04dda66817766",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/695cd7455aedcd7dd0edd6026ba9c016eec19601",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/e1484bb05982e24801a711c757923b6cde77b492",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/f96995cdc23511263ad0fd935c4680f8cfe51fa3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2021-24/#CVE-2021-29967",
                "label": "ADVISORY"
            }
        ]
    }
}