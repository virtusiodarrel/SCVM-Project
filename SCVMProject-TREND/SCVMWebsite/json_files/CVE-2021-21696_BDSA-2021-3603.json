{
    "source": "BDSA",
    "name": "BDSA-2021-3603",
    "title": "Jenkins Vulnerable to Remote Code Execution (RCE) via Insufficient Access Control to `libs/` Directory",
    "description": "Jenkins has insufficient access control to to the `libs/` directory when using the `FilePath` APIs. This could allow an attacker to modify the code of a trusted library, in order to achieve remote code execution (RCE) in the Jenkins controller process.\n\n**Note:** The vendor has stated that it is not easily possible to customize the file access rules to prohibit access to the `libs/` directory specifically, as built-in rules (granting access to `<BUILDDIR>` contents) would take precedence over a custom rule prohibiting access",
    "technicalDescription": "This vulnerability exists due to Jenkins not limiting agent read/write access to the `libs/` directory inside build directories when using the `FilePath` APIs. This could allow an attacker who has control of agent processes to modify the code of a trusted library, which can result in RCE in the Jenkins controller process.\n\nThe vendor has mitigated against this by including additional `deny all` checks in the `core/src/main/resources/jenkins/security/s2m/filepath-filter.conf` file of Jenkins.",
    "publishedDate": "2021-11-30T14:01:26.096Z",
    "updatedDate": "2022-07-28T11:34:42.653Z",
    "disclosureDate": "2021-11-04T00:00:00.000Z",
    "solution": "Fixed in version [**2.3.19**](https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.319) by [this](https://github.com/jenkinsci/jenkins/commit/93451e20c20cfd84badeb0f37c38d4c0c7a5dad3) commit and in LTS [**2.303.3**](https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.303.3) by [this](https://github.com/jenkinsci/jenkins/commit/b0ca03abd10d1a501145d6fe402febfde37e6093) commit.\n\nThe latest stable releases are available [here](https://www.jenkins.io/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.6,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.7,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "The vendor has stated a workaround [here](https://www.jenkins.io/security/advisory/2021-11-04/#SECURITY-2455):\n\n\"If you are unable to immediately upgrade to Jenkins 2.319, LTS 2.303.3, you can install the Remoting Security Workaround Plugin. It will prevent all agent-to-controller file access using FilePath APIs. Because it is more restrictive than Jenkins 2.319, LTS 2.303.3, more plugins are incompatible with it. Make sure to read the plugin documentation before installing it.\"",
    "vendorFixDate": "2021-10-25T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 5.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3603",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21696",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3603/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/commit/93451e20c20cfd84badeb0f37c38d4c0c7a5dad3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/commit/b0ca03abd10d1a501145d6fe402febfde37e6093",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.303.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.319",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/security/advisory/2021-11-04/#SECURITY-2455",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/security/advisory/2021-11-04/#SECURITY-2455",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3603/default-remediation-status"
            }
        ]
    }
}