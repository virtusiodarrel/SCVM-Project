{
    "source": "BDSA",
    "name": "BDSA-2021-1968",
    "title": "Istio Vulnerable to Unauthorized Kubernetes Secrets Access via Improper Access Control Flaw in Istiod Component",
    "description": "Istio is vulnerable to a Kubernetes secrets access control issue due to a caching flaw in Istiod that allows credentials or keys to be accessed by clients from other namespaces.\n\nAn attacker with control over a gateway or workload deployment could abuse this issue in order to access sensitive credential information to enable further attacks.",
    "technicalDescription": "Istio is vulnerable to leaking TLS certificate and private key information because Istiod does not correctly restrict gateway or workload deployments from accessing credentials stored in Kubernetes secrets from different namespaces.\n\nIf a cluster has defined `Gateways` or `DestinationRules` with the `credentialName` field specified and does not specify the Istiod flag `PILOT_ENABLE_XDS_CACHE=false`, a flaw in Istiod incorrectly permits an otherwise authorized client the ability to access and retrieve any TLS certificate and private key that is cached in Istiod.",
    "publishedDate": "2021-07-01T11:22:43.096Z",
    "updatedDate": "2021-07-01T11:22:43.089Z",
    "disclosureDate": "2021-06-24T00:00:00.000Z",
    "solution": "Fixed in [**1.10.2**](https://github.com/istio/istio/releases/tag/1.10.2) and [**1.9.6**](https://github.com/istio/istio/releases/tag/1.9.6).\n\nThe latest stable releases are available [here](https://github.com/istio/proxy/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.3,
        "exploitabilitySubscore": 3.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sopra Banking Software (Nishant Virmani, Stephane Mercier, Antonin Nycz), John Howard (Google)",
    "workaround": "The vendor has suggested [here](https://istio.io/latest/news/security/istio-security-2021-007/) that if it is not possible to upgrade, the vulnerability can be mitigated by disabling Istiod caching with the `PILOT_ENABLE_XDS_CACHE=false` Istiod environment variable. \n**Note**: This mitigation can impact system and Istiod performance as this disables XDS caching.",
    "vendorFixDate": "2021-06-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1968",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-34824",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1968/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/releases/tag/1.10.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/istio/releases/tag/1.9.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/istio/proxy/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://istio.io/latest/news/security/istio-security-2021-007/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://istio.io/latest/news/security/istio-security-2021-007/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1968/default-remediation-status"
            }
        ]
    }
}