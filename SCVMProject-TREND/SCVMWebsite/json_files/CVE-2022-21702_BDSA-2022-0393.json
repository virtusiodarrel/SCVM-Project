{
    "source": "BDSA",
    "name": "BDSA-2022-0393",
    "title": "Grafana Vulnerable to Cross-Site Scripting (XSS) via Datasource or Plugin Proxy",
    "description": "Grafana is vulnerable to cross-site scripting (XSS) via HTML content served through the Grafana datasource or plugin proxy. An attacker could either compromise an existing datasource for a specific Grafana instance or either set up its own public service and instruct anyone to set it up in their Grafana instance. The XSS allows the attacker to gain access to other data sources connected to the same Grafana organization.",
    "technicalDescription": "The full list of conditions that make a Grafana instance vulnerable is available [here](https://github.com/grafana/grafana/security/advisories/GHSA-xc3p-28hw-q24g).",
    "publishedDate": "2022-02-09T10:51:07.333Z",
    "updatedDate": "2022-05-10T13:03:15.112Z",
    "disclosureDate": "2022-02-08T00:00:00.000Z",
    "exploitPublishDate": "2022-02-08T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* **[7.5.15](https://github.com/grafana/grafana/releases/v7.5.15)** by [this](https://github.com/grafana/grafana/commit/27726868b3) commit .\n* **[8.3.5](https://github.com/grafana/grafana/releases/v8.3.5)** by [this](https://github.com/grafana/grafana/commit/41c1cd2865) commit.\n* **[8.4.0](https://github.com/grafana/grafana/releases/tag/v8.4.0)** by [this](https://github.com/grafana/grafana/commit/ff8e53a347c7932ca036902e1d0d300e6d865714) commit\n\nThe latest stable releases can be found [here](https://grafana.com/grafana/download).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jasu Viding",
    "workaround": "The vendor proposes the following workaround:\n> Using a proxy, set a response header Content Security Policy: sandbox for the following routes:\n> \n> /api/datasources/proxy*\n> /api/plugin-proxy*\n> /api/plugins/<pluginId>/resources*\n> /api/datasources/<id>/resources*\n> \n> Another possible mitigation is setting the response header Content-Disposition: attachment; \u201cproxy.txt\u201d. Confirmed in both Chrome and Firefox.",
    "vendorFixDate": "2022-01-21T00:00:00.000Z",
    "vendorNotifiedDate": "2022-01-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0393",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-21702",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0393/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/27726868b3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/41c1cd2865",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/ff8e53a347c7932ca036902e1d0d300e6d865714",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/tag/v8.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/v7.5.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/v8.3.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/security/advisories/GHSA-xc3p-28hw-q24g",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/security/advisories/GHSA-xc3p-28hw-q24g",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/security/advisories/GHSA-xc3p-28hw-q24g",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://grafana.com/grafana/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0393/default-remediation-status"
            }
        ]
    }
}