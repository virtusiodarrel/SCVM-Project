{
    "source": "BDSA",
    "name": "BDSA-2021-1984",
    "title": "Craft CMS Vulnerable to Path Traversal via Insufficient Validation of 'File System Path' Setting in Volume Configuration Functionality",
    "description": "Craft CMS is vulnerable to a path traversal issue due to how the 'Volume' configuration functionality does not sufficiently validate the file system path setting.\n\nThis issue could allow an administrative user the ability to configure a local volume with a file system path setting set to a system directory. This could potentially allow malicious users to upload files to sensitive directories.\n\n**Note**: In a third-party [advisory](https://hackberry.xyz/from-burnout-to-rce-getting-out-of-the-rat-race#poc-or-gtfo), the issue reporter indicates that this issue could be chained with an unrestricted file upload issue, **CVE-2021-27902** (**BDSA-2021-1986**), to perform a stored cross-site scripting (XSS) attack against an administrative user in order to achieve remote code execution (RCE).",
    "technicalDescription": "Craft CMS is vulnerable to path traversal because the 'Volume' configuration functionality does not restrict administrative users from setting the file system path setting to a system directory, such as `templates/` or `/vendor`. The `..` syntax could be used to point the volume outside the public directory and could result in users being able to write malicious files to sensitive directories and lead to further attacks.",
    "publishedDate": "2021-07-02T10:42:32.073Z",
    "updatedDate": "2021-07-02T10:42:32.065Z",
    "disclosureDate": "2021-02-23T00:00:00.000Z",
    "exploitPublishDate": "2021-04-07T00:00:00.000Z",
    "solution": "Fixed in [**3.6.7**](https://github.com/craftcms/cms/releases/tag/3.6.7) by [this](https://github.com/craftcms/cms/commit/c17728fa0bec11d3b82c34defe0930ed409aec38) commit.\n\nThe latest stable releases are available [here](https://github.com/craftcms/cms/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-02-16T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 4.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1984",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-27903",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1984/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/craftcms/cms/blob/develop/CHANGELOG.md#security-3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/craftcms/cms/commit/c17728fa0bec11d3b82c34defe0930ed409aec38",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/craftcms/cms/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/craftcms/cms/releases/tag/3.6.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackberry.xyz/from-burnout-to-rce-getting-out-of-the-rat-race#poc-or-gtfo",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackberry.xyz/from-burnout-to-rce-getting-out-of-the-rat-race#poc-or-gtfo",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1984/default-remediation-status"
            }
        ]
    }
}