{
    "source": "BDSA",
    "name": "BDSA-2020-1292",
    "title": "MISP Vulnerable to Stored Cross-Site Scripting (XSS) via Sighting Popover Tool",
    "description": "MISP is vulnerable to stored cross-site scripting (XSS) due to improper validation of user-supplied input. This could allow an attacker to include malicious JavaScript in the sighting popover tool. This could result in the attacker being able to steal authentication tokens, user cookies or other sensitive information from user accounts.",
    "technicalDescription": "The cross site scripting (XSS) vulnerability occurs due to lack of sanitization in the sighting popover tool of MISP. \n\nAn attacker can include malicious JavaScript in the sighting popover tool, in `app/View/Elements/Events/View/sighting_field.ctp`. When any other user browses to this page, the malicious script will be executed in the victim's browser and the attacker will be able to steal authentication tokens, user cookies or other sensitive information.\n\nThe vendor has mitigated against this vulnerability by introducing validation of user-supplied inputs.",
    "publishedDate": "2020-06-03T14:20:06.926Z",
    "updatedDate": "2020-06-03T14:20:06.917Z",
    "disclosureDate": "2020-03-11T00:00:00.000Z",
    "solution": "Fixed in version [**2.4.123**](https://github.com/MISP/MISP/releases/tag/v2.4.123) by [this](https://github.com/MISP/MISP/commit/e24a9eb44c1306adb02c1508e8f266ac6b95b4ed) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Centre for Cyber security Belgium (CCB)",
    "workaround": "",
    "vendorFixDate": "2020-03-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1292",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10247",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1292/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MISP/MISP/commit/e24a9eb44c1306adb02c1508e8f266ac6b95b4ed",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MISP/MISP/releases/tag/v2.4.123",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MISP/MISP/releases/tag/v2.4.123",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1292/default-remediation-status"
            }
        ]
    }
}