{
    "source": "BDSA",
    "name": "BDSA-2021-0936",
    "title": "Gradle Vulnerable to Local Privilege Escalation via 'System' Temporary Directory Open Permissions",
    "description": "Gradle on Unix-like systems is vulnerable to a local privilege escalation issue due to how the system temporary directory can be created with open permissions.\n\nThe open permissions allow multiple users to create and delete files within the directory, and enable an attacker to perform a privilege escalation attack by quickly deleting and recreating files in the system temporary directory.",
    "technicalDescription": "Gradle, when used on Unix-like systems, is vulnerable to a local privilege escalation issue because the system temporary directory can be created with open permissions. \n\nGradle creates the directory with open permissions in the following cases:\n* Where precompiled script plugins are used, Gradle uses a temporary directory in the system temporary directory to execute a build-like process.\n* When using the `ProjectBuilder` API in tests, if you do not specify a project directory Gradle will create one for you in a temporary directory.\n* When using Gradle `TestKit` in tests, `TestKit` uses a well-known path in the system temporary directory to cache some information between runs, like Gradle distributions and dependency downloads.\n\nIn the listed cases, a race condition exists in the creation of this temporary directory. If an attacker is able to write files into the directory created by Gradle, the attacker can execute commands at the same privilege level as the build.\n\n**Note**: The vendor has stated [here](https://github.com/gradle/gradle/security/advisories/GHSA-89qm-pxvm-p336) that you are not affected if:\n* you are using Gradle on Windows or modern versions of macOS,\n* you do not use precompiled script plugins, \n* you do not use `ProjectBuilder`, or you always specify a project directory when using `ProjectBuilder`,\n* you do not use `TestKit`.",
    "publishedDate": "2021-04-14T12:22:59.570Z",
    "updatedDate": "2021-06-21T16:22:43.179Z",
    "disclosureDate": "2021-04-10T00:00:00.000Z",
    "solution": "Fixed in [**7.0.0-M3**](https://github.com/gradle/gradle/releases/tag/v7.0.0-M3) by [this](https://github.com/gradle/gradle/commit/c0f43f2cea1c3eaf822020907520ee2d6a9fdbed) commit and [this](https://github.com/gradle/gradle/commit/e47983a8d620edffdbf0e4a7191011a9b1c9799f) commit.\n\nThe latest stable releases are available [here](https://gradle.org/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:L/AC:M/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.0,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jonathan Leitschuh, Sterling Greene",
    "workaround": "The vendor has stated [here](https://github.com/gradle/gradle/security/advisories/GHSA-89qm-pxvm-p336) that users on Unix-like operating systems should ensure that the `sticky` bit is set. This allows the original user (or root) to delete a file.\n\nThe vendor has also stated: \n\"If you are unable to change the permissions of the system temporary directory, you can move the Java temporary directory by setting the System Property `java.io.tmpdir`. The new path needs to limit permissions to the build user only.\"",
    "vendorFixDate": "2021-02-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0936",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-378"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-379"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29428",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0936/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gradle/gradle/commit/c0f43f2cea1c3eaf822020907520ee2d6a9fdbed",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gradle/gradle/commit/e47983a8d620edffdbf0e4a7191011a9b1c9799f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gradle/gradle/pull/15240",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gradle/gradle/pull/15654",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gradle/gradle/releases/tag/v7.0.0-M3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gradle/gradle/security/advisories/GHSA-89qm-pxvm-p336",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gradle/gradle/security/advisories/GHSA-89qm-pxvm-p336",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://gradle.org/releases/",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0936/default-remediation-status"
            }
        ]
    }
}