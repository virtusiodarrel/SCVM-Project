{
    "source": "BDSA",
    "name": "BDSA-2019-1355",
    "title": "Apache Archiva Vulnerable to Arbitrary File Write via Improper Input Validation in Artifact File Upload Functionality",
    "description": "An improper input validation vulnerability has been discovered in Apache Archiva. An attacker with valid privilege rights can manipulate the file upload functionality to target, overwrite or delete existing files in other path locations.",
    "technicalDescription": "A weakness has been discovered in Apache Archiva which can lead to arbitrary file write or delete. The artifact file upload functionality implemented by the application does not validate the filename value before processing.  The `getStringValue` located in the file `src/main/java/org/apache/archiva/web/api/DefaultFileUploadService.java` utilizes a parameter called `attachment` which is not sanitized against malicious path traversal techniques. The `deleteFile` function in the same location utilizes a parameter called `file` which is also affected by this weakness.",
    "publishedDate": "2019-05-01T13:14:53.276Z",
    "updatedDate": "2021-02-16T13:26:57.949Z",
    "disclosureDate": "2019-04-30T00:00:00.000Z",
    "solution": "Fixed in [**2.2.4**](https://github.com/apache/archiva/releases/tag/archiva-2.2.4) by [this](https://github.com/apache/archiva/commit/cc0d8ad0b525e641855319812877fdc6c8cd327c) commit and [this](https://github.com/apache/archiva/commit/c5bcbaabedc323e778fe03289cbbfaa35b25e2d8) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-04-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1355",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-23"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-0214",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1355/ranges"
            },
            {
                "rel": "reference",
                "href": "http://archiva.apache.org/download.cgi",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://archiva.apache.org/security.html#CVE-2019-0214",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/archiva/commit/93ff501274cbdd29bea79beddaec95ba7a31e7ea",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/archiva/commit/c5bcbaabedc323e778fe03289cbbfaa35b25e2d8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/archiva/commit/cc0d8ad0b525e641855319812877fdc6c8cd327c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/archiva/commit/e9e1fd85687ecf6ff39f59051631991a09650538",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/archiva/releases/tag/archiva-2.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1355/default-remediation-status"
            }
        ]
    }
}