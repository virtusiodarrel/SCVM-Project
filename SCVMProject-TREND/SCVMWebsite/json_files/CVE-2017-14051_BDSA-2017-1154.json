{
    "source": "BDSA",
    "name": "BDSA-2017-1154",
    "title": "Linux Kernel: Integer Overflow in `qla2x00_sysfs_write_optrom_ctl()` Causes Denial of Service",
    "description": "An integer overflow can occur in the sysfs interface to the QLogic Fibre Channel device driver.  This interface is only available to the root user but allows them to cause memory corruption, denial of service and code execution within the context of the kernel.",
    "technicalDescription": "Using the sysfs interface for the Qlogic Fibre Channel device driver the root user can supply a large `size` parameter that will cause an integer overflow in the `qla2x00_sysfs_write_optrom_ctl()` function.  The size overflow causes a memory safety check to pass incorrectly, resulting in a large `vmalloc()`allocation and a subsequent buffer overflow and memory corruption.  This can lead to a denial of service or code execution in the context of the kernel.",
    "publishedDate": "2017-09-28T09:25:26.810Z",
    "updatedDate": "2018-10-03T07:02:06.186Z",
    "disclosureDate": "2017-08-29T00:00:00.000Z",
    "solution": "[Fixed](https://www.kernel.org) in versions:\n**3.2.96**\n**3.10.108**\n**3.16.51**\n**3.18.72**\n**4.1.45**\n**4.4.89**\n**4.9.52**\n**4.13.4**\n**4.14-rc1**\n**4.15-rc1**\n\nAlternatively apply the [patch](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=e6f77540c067b48dee10f1e33678415bfcc89017)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:L/AC:L/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "shqking",
    "workaround": "Alternatively compile the kernel without support for the Qlogic Fibre Channel device driver, or remove the kernel module from the system.",
    "vendorFixDate": "2017-08-30T00:00:00.000Z",
    "discoveryDate": "2017-06-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1154",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-14051",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-1154/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.kernel.org/show_bug.cgi?id=194061",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=e6f77540c067b48dee10f1e33678415bfcc89017",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.suse.com/security/cve/CVE-2017-14051.html",
                "label": "ADVISORY"
            }
        ]
    }
}