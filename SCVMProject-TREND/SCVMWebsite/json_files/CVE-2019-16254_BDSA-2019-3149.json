{
    "source": "BDSA",
    "name": "BDSA-2019-3149",
    "title": "Ruby Vulnerable to HTTP Response Splitting via CR/LF Injection in WEBrick Component",
    "description": "Ruby is vulnerable to HTTP response splitting due to insufficient validation of untrusted input in the WEBrick service. This could allow an attacker to construct HTTP responses with malicious content, which could be leveraged to perform attacks such as cache poisoning or cross-site scripting (XSS).",
    "technicalDescription": "The function `check_header()` within the file `lib/webrick/httpresponse.rb` does not properly validate input to HTTP responses which includes isolated CR or LF newline characters. An attacker could exploit this by supplying maliciously crafted input to a Ruby application which inserts this input into a response header without any further validation, allowing the header to be split and attacker-controlled data to be injected.\n\nThis issue was originally addressed by [this](https://github.com/ruby/ruby/commit/d9d4a28f1cdd05a0e8dabb36d747d40bbcc30f16) commit and disclosed as CVE-2017-17742 (BDSA-2018-0900), but this only validated combined CRLF input, thus a further fix was required.",
    "publishedDate": "2019-10-09T13:52:53.461Z",
    "updatedDate": "2019-10-28T14:32:02.670Z",
    "disclosureDate": "2019-10-01T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/ruby/ruby/commit/3ce238b5f9795581eb84114dcfbdf4aa086bfecc) commit in:\n* **[2.7.0-preview2](https://github.com/ruby/ruby/releases/tag/v2_7_0_preview2)**\n* **[2.6.5](https://www.ruby-lang.org/en/news/2019/10/01/ruby-2-6-5-released/)**\n* **[2.5.7](https://www.ruby-lang.org/en/news/2019/10/01/ruby-2-5-7-released/)**\n* **[2.4.9](https://www.ruby-lang.org/en/news/2019/10/02/ruby-2-4-9-released/)**\n\nNote that in **2.4.x** this issue was originally fixed in **2.4.8**, but an installation issue with this version's tarball required a further **2.4.9** release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Kazuhiro Nishiyama",
    "workaround": "",
    "vendorFixDate": "2019-10-01T00:00:00.000Z",
    "vendorNotifiedDate": "2018-04-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3149",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-113"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-16254",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3149/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/3ce238b5f9795581eb84114dcfbdf4aa086bfecc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/d9d4a28f1cdd05a0e8dabb36d747d40bbcc30f16",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/releases/tag/v2_7_0_preview2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2019/10/01/http-response-splitting-in-webrick-cve-2019-16254/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2019/10/01/ruby-2-5-7-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2019/10/01/ruby-2-6-5-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2019/10/02/ruby-2-4-9-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3149/default-remediation-status"
            }
        ]
    }
}