{
    "source": "BDSA",
    "name": "BDSA-2020-3603",
    "title": "Lilypond Vulnerable to Command Injection via 'embedded-svg' and 'embedded-ps' Stencil Commands",
    "description": "Lilypond contains a command injection vulnerability.  This allows an attacker to inject Postscript or SVG commands into Lilypond commands when being ran in safe mode. This may result in the execution of unwanted commands if an attacker is able to supply a crafted typesheet file with embedded Postscript.",
    "technicalDescription": "The command injection vulnerability exists when the `-dsade` flag is used to run Lilypond in safe mode. The `embedded-ps` and `embedded-svg` stencil commands can be abused where an attacker embeds commands in a `ps` or `svg` file that can be executed unknowingly by Lilypond.",
    "publishedDate": "2020-12-03T13:32:06.702Z",
    "updatedDate": "2020-12-03T13:32:06.673Z",
    "disclosureDate": "2020-08-29T00:00:00.000Z",
    "solution": "Fixed in [**2.21.5-1**](http://git.savannah.gnu.org/gitweb/?p=lilypond.git;a=commit;h=643e0edaf1f8c2f8ea28a419e9715c2510487922) by [this](http://git.savannah.gnu.org/gitweb/?p=lilypond.git;a=commit;h=b84ea4740f3279516905c5db05f4074e777c16ff) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Faidon Liambotis",
    "workaround": "",
    "vendorFixDate": "2020-07-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3603",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-17353",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3603/ranges"
            },
            {
                "rel": "reference",
                "href": "http://git.savannah.gnu.org/gitweb/?p=lilypond.git;a=commit;h=643e0edaf1f8c2f8ea28a419e9715c2510487922",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://git.savannah.gnu.org/gitweb/?p=lilypond.git;a=commit;h=b84ea4740f3279516905c5db05f4074e777c16ff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/show_bug.cgi?id=1174949",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.opensuse.org/opensuse-security-announce/2020-09/msg00076.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.debian.org/security/2020/dsa-4756",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3603/default-remediation-status"
            }
        ]
    }
}