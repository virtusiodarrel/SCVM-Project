{
    "source": "BDSA",
    "name": "BDSA-2021-1143",
    "title": "Underscore Vulnerable to Arbitrary Code Execution via '_.templateSettings.variable' Value",
    "description": "The Underscore Javascript library contains an arbitrary code execution vulnerability.  This allows an attacker to create malicious content that, if processed by Underscore may lead to the execution of code on a system.",
    "technicalDescription": "The code execution vulnerability is due to a lack of sanitization on untrusted input passed to `_.templateSettings.variable` values.  A variable can be modified to contain executable code and then trigged by a call to `_.template(\"\")();`.  This impact of this vulnerability heavily relies on the implementation of the Underscore library.  \n\nIf a system or application bound to the network is passing untrusted input directly to a `_.templateSettings.variable = ` assignment operation,  the worse case scenario or code execution should be assumed.",
    "publishedDate": "2021-04-28T13:29:38.484Z",
    "updatedDate": "2021-05-26T09:43:53.822Z",
    "disclosureDate": "2021-03-29T00:00:00.000Z",
    "exploitPublishDate": "2021-03-29T00:00:00.000Z",
    "solution": "Fixed in:                  \n* [**1.12.1**](https://github.com/jashkenas/underscore/releases/tag/1.12.1) by [this](https://github.com/jashkenas/underscore/commit/bf5a0ed27599f99ea59a0839c5bc2fb27a46c1cf) commit.\n* [**1.13.0-2**](https://github.com/jashkenas/underscore/releases/tag/1.13.0-2) by [this](https://github.com/jashkenas/underscore/commit/bf5a0ed27599f99ea59a0839c5bc2fb27a46c1cf) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alessio Della Libera",
    "workaround": "",
    "vendorFixDate": "2021-03-29T00:00:00.000Z",
    "vendorNotifiedDate": "2021-03-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1143",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23358",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1143/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jashkenas/underscore/commit/bf5a0ed27599f99ea59a0839c5bc2fb27a46c1cf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jashkenas/underscore/pull/2917",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jashkenas/underscore/releases/tag/1.12.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jashkenas/underscore/releases/tag/1.13.0-2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-UNDERSCORE-1080984",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.debian.org/security/2021/dsa-4883",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1143/default-remediation-status"
            }
        ]
    }
}