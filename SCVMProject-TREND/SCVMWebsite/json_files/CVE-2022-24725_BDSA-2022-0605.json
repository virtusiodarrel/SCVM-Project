{
    "source": "BDSA",
    "name": "BDSA-2022-0605",
    "title": "Shescape Vulnerable to Sensitive Data Exposure via  '_shescape_' API",
    "description": "Shescape is vulnerable to sensitive data exposure. A local attacker could exploit this in order to learn the users home directory. \n\nThe Vendor states that directory traversal may be possible in applications using Shescape, depending on how the output of Shescape is used.",
    "technicalDescription": "This issue occurs on Unix systems when using Bash with the `escape` or `escapeAll` functions from the `_shescape_ API` with the `interpolation` option set to `true`. It occurs in the `escapeShellArgWithInterpolation()` function of the `src/unix.js` file due to insufficient escaping. \n\nIt was mitigated by the addition of  `result = result.replace(/(?<=\\=(?:.*?:)?)(~)(?=\\:|$)/g, \"\\\\$1\");`.",
    "publishedDate": "2022-03-04T15:36:17.449Z",
    "updatedDate": "2022-03-04T15:36:17.418Z",
    "disclosureDate": "2022-02-19T00:00:00.000Z",
    "solution": "Fixed in [**1.5.1**](https://github.com/ericcornelissen/shescape/releases/tag/v1.5.1) by [this](https://github.com/ericcornelissen/shescape/commit/413810c786687f73824313a45d4fe287e4957d3f) commit.\n\nThe latest stable releases can be found [here](https://github.com/ericcornelissen/shescape/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The Vendor proposes the following workaround:\n\n> Manually escape all instances of the tilde character (`~`) using `arg.replace(/~/g, \"\\\\~\")`.",
    "vendorFixDate": "2022-02-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0605",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24725",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0605/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/commit/413810c786687f73824313a45d4fe287e4957d3f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/issues/169",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/releases/tag/v1.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/security/advisories/GHSA-446w-rrm4-r47f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/security/advisories/GHSA-446w-rrm4-r47f",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ericcornelissen/shescape/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0605/default-remediation-status"
            }
        ]
    }
}