{
    "source": "BDSA",
    "name": "BDSA-2022-2076",
    "title": "Moodle Vulnerable to Arbitrary File Read via Path Traversal when Importing Lesson Questions",
    "description": "Moodle is vulnerable to path traversal which may lead to sensitive information disclosure on the file system when importing lesson questions. An attacker can exploit this flaw by manipulating directory pathways using unwanted characters to access a resource that is outside the intended directory.\n\n**Note:** This vulnerability only affects those users with teacher, manager and admin permissions.",
    "technicalDescription": "This vulnerability exists within the `lib/moodlelib.php` and `question/format/blackboard_six/format.php` files. They do not have sufficient validation on user-supplied paths when importing lesson questions which allows an attacker to construct a path to a specific resource that they may not be authorized to access.\n\nThis has been mitigated by updating the case `PARAM_SAFEPATH` in `lib/moodlelib.php` to replace any illegal characters which may allow path traversal to occur. `PARAM_SAFEPATH` is then used in the `question/format/blackboard_six/format.php` file within the `readdata()` function to prevent arbitrary file read when importing lesson questions in blackboard format.",
    "publishedDate": "2022-07-26T11:45:30.700Z",
    "updatedDate": "2022-08-24T11:27:28.670Z",
    "disclosureDate": "2022-07-18T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.9.15**](https://github.com/moodle/moodle/releases/tag/v3.9.15) by [this](https://github.com/moodle/moodle/commit/47c211ba0eec1d33bf5e4c3b9ac9e409a49181bd) commit and [this](https://github.com/moodle/moodle/commit/9f270d956e238a185e47f7f47e0971f652360445) commit.\n* [**3.11.8**](https://github.com/moodle/moodle/releases/tag/v3.11.8) by [this](https://github.com/moodle/moodle/commit/46ee4f4062f81aa4cf3876a3d68f4e7328b07dd3) commit and [this](https://github.com/moodle/moodle/commit/edc7eb06b7938f6fefe69d43dfc4cf89705f669f) commit.\n* [**4.0.2**](https://github.com/moodle/moodle/releases/tag/v4.0.2) by [this](https://github.com/moodle/moodle/commit/f38397544a8f0262ebeab0576f41829cfba04cc5) commit and [this](https://github.com/moodle/moodle/commit/a212b1ec3e813b81ba0a42847babf111b309ef0c) commit.\n\nThe latest stable releases can be found [here](https://github.com/moodle/moodle/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "loknop",
    "workaround": "",
    "vendorFixDate": "2022-07-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2076",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-35650",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2076/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/46ee4f4062f81aa4cf3876a3d68f4e7328b07dd3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/47c211ba0eec1d33bf5e4c3b9ac9e409a49181bd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/9f270d956e238a185e47f7f47e0971f652360445",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/a212b1ec3e813b81ba0a42847babf111b309ef0c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/edc7eb06b7938f6fefe69d43dfc4cf89705f669f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/f38397544a8f0262ebeab0576f41829cfba04cc5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.11.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.9.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v4.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=436457",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2076/default-remediation-status"
            }
        ]
    }
}