{
    "source": "BDSA",
    "name": "BDSA-2021-3504",
    "title": "msgpack5 Vulnerable to Denial-of-Service (DoS) and Unexpected Behavior via Prototype Poisoning in 'decoder.js'",
    "description": "msgpack5 is vulnerable to unexpected behavior due to a prototype poisoning vulnerability. This can allow an attacker to throw unexpected exceptions resulting in a denial-of-service (DoS) condition, produce values that appear to be of other types, and have unexpected prototype properties and methods.",
    "technicalDescription": "This vulnerability exists when  when msgpack5 decodes a map containing a key `__proto__`, it will assign the decoded value to `__proto__` and if the value decodes to an object or null, msgpack5 will sets the decoded object's prototype to that value.  This can allow an attacker who can submit crafted MessagePack data to a service to produce unexpected behavior in msgpack5. This could include throwing unexpected exceptions resulting in a denial-of-service (DoS) condition, producing values that appear to be of other types, and having unexpected prototype properties and methods. \n\nThe prototype poisoning vulnerability can be described as a very limited inversion of a prototype pollution attack. Only the decoded value's prototype is affected, and there is no effect on the global prototype. The vendor has stated that they have not found a way to escalate this to true prototype pollution.\n\nThe vendor has mitigated against this vulnerability by including additional checks which will produce an error if an object contains a forbidden prototype property.",
    "publishedDate": "2021-11-18T12:22:28.499Z",
    "updatedDate": "2021-11-18T12:22:28.485Z",
    "disclosureDate": "2021-03-09T00:00:00.000Z",
    "exploitPublishDate": "2021-03-09T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.2.1**](https://github.com/mcollina/msgpack5/releases/tag/v5.2.1) by [this](https://github.com/mcollina/msgpack5/commit/d4e6cb956ae51c8bb2828e71c7c1107c340cf1e8) commit,\n* [**4.5.1**](https://github.com/mcollina/msgpack5/releases/tag/v4.5.1) by [this](https://github.com/mcollina/msgpack5/commit/2f3ade7a0bbb315d467141409bc956fa8742ab3f) commit,\n* [**3.6.1**](https://github.com/mcollina/msgpack5/releases/tag/v3.6.1) by [this](https://github.com/mcollina/msgpack5/commit/d4e6cb956ae51c8bb2828e71c7c1107c340cf1e8) commit.\n\nThe latest stable releases are available [here](https://github.com/mcollina/msgpack5/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.7,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.0
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ninevra",
    "workaround": "The vendor has suggested [here](https://github.com/mcollina/msgpack5/security/advisories/GHSA-gmjw-49p4-pcfm) that as a workaround users should always validate incoming data after parsing before doing any processing.",
    "vendorFixDate": "2021-03-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3504",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-915"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21368",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3504/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcollina/msgpack5/commit/2f3ade7a0bbb315d467141409bc956fa8742ab3f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcollina/msgpack5/commit/d4e6cb956ae51c8bb2828e71c7c1107c340cf1e8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcollina/msgpack5/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcollina/msgpack5/releases/tag/v3.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcollina/msgpack5/releases/tag/v4.5.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcollina/msgpack5/releases/tag/v5.2.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcollina/msgpack5/security/advisories/GHSA-gmjw-49p4-pcfm",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcollina/msgpack5/security/advisories/GHSA-gmjw-49p4-pcfm",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mcollina/msgpack5/security/advisories/GHSA-gmjw-49p4-pcfm",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3504/default-remediation-status"
            }
        ]
    }
}