{
    "source": "BDSA",
    "name": "BDSA-2022-1795",
    "title": "Go Vulnerable to Information Exposure via Improper 'nil' Value Handling in 'Header.Clone' Method",
    "description": "Go is vulnerable to information exposure due to a failure to exclude specified headers from HTTP requests. An attacker could obtain the IP address of the host that originated a request by examining the HTTP header, even if the request was set up in a manner that was supposed to remove the `X-Forwarded-For` header.",
    "technicalDescription": "The `Header.Clone()` method, as defined in the file `src/net/http/header.go`, does not preserve `nil` values that have been applied to HTTP header fields. This will cause Go to include headers within HTTP requests that should have been excluded. This can lead the client host's IP address being leaked via the `X-Forwarded-For` HTTP header.",
    "publishedDate": "2022-06-30T14:18:22.244Z",
    "updatedDate": "2022-07-13T10:38:43.214Z",
    "disclosureDate": "2022-06-17T00:00:00.000Z",
    "exploitPublishDate": "2022-06-17T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.19rc1**](https://github.com/golang/go/releases/tag/go1.19rc1) by [this](https://github.com/golang/go/commit/b2cc0fecc2ccd80e6d5d16542cc684f97b3a9c8a) commit,\n* [**1.18.4**](https://github.com/golang/go/releases/tag/go1.18.4) by [this](https://github.com/golang/go/commit/ebea1e3353fa766025aa5190b9c7cc05cf069187) commit,\n* [**1.17.12**](https://github.com/golang/go/releases/tag/go1.17.12) by [this](https://github.com/golang/go/commit/ed2f33e1a7e0d18f61bd56f7ee067331d612c27e) commit.\n\nThe latest stable releases can be found [here](https://go.dev/dl/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Christian Mehlmauer",
    "workaround": "",
    "vendorFixDate": "2022-06-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1795",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-201"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-32148",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1795/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/b2cc0fecc2ccd80e6d5d16542cc684f97b3a9c8a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/ebea1e3353fa766025aa5190b9c7cc05cf069187",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/ecdbffd4ec68b509998792f120868fec319de59b",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/commit/ed2f33e1a7e0d18f61bd56f7ee067331d612c27e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/issues/53423",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/issues/53423",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases/tag/go1.17.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases/tag/go1.18.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/golang/go/releases/tag/go1.19rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://go.dev/dl/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/golang-announce/c/nqrv9fbR0zE",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1795/default-remediation-status"
            }
        ]
    }
}