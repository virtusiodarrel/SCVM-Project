{
    "source": "BDSA",
    "name": "BDSA-2020-2083",
    "title": "Nextcloud Vulnerable to Malicious File Upload via Improper File Checks",
    "description": "Nextcloud is vulnerable to malicious file upload. An attacker could utilize this to upload files that have been blocked by the administrator.",
    "technicalDescription": "The vulnerability exists in the `lib/private/Files/Type/Detection.php` and `apps/workflowengine/lib/Check/FileMimeType.php` files within Nextcloud. File extensions are checked as opposed to MIME types which can be blocked or allowed depending on file access controls. \nThe vendor has mediated this issue by implementing checks which detect MIME type using both filename and content.",
    "publishedDate": "2020-08-17T16:44:17.661Z",
    "updatedDate": "2020-08-20T11:07:11.989Z",
    "disclosureDate": "2020-03-14T00:00:00.000Z",
    "solution": "Fixed in \n* [**17.0.2**](https://github.com/nextcloud/server/releases/tag/v17.0.2) by the following commits :\n\t* [Commit 1](https://github.com/nextcloud/server/commit/5c9f503146382b5c9bd20022053f16f05f283037) \n\t* [Commit 2](https://github.com/nextcloud/server/commit/1dad2ddf390f3af35a1a343e6d0b21848b765297)\n\t* [Commit 3](https://github.com/nextcloud/server/commit/f7c1fd569e19b83a5afc988a02ba1f87c6a818e4)\n\t* [Commit 4](https://github.com/nextcloud/server/commit/a8b484f2e6bc83232161d46f3859d533287d1a1f)\n\t* [Commit 5](https://github.com/nextcloud/server/commit/848ca717304996eb80d390872ebc7990d99e8c4a)\n\t* [Commit 6](https://github.com/nextcloud/server/commit/6955841c8256121303ae658166e8df2924957af1)\n\t* [Commit 7](https://github.com/nextcloud/server/commit/790de0acefafb63a137e8d53514a32e0d20f6f17)\n\n* [**16.0.7rc1**](https://github.com/nextcloud/server/releases/tag/v16.0.7RC1) by the following commits :\n\t* [Commit 1](https://github.com/nextcloud/server/commit/0f3fe7be2c89ed3b9bf892e7e8f7e64d5d75b981) \n\t* [Commit 2](https://github.com/nextcloud/server/commit/1fe16ca6f52eaa30649e91d8774234d15ba4af20)\n\t* [Commit 3](https://github.com/nextcloud/server/commit/25d7d6965d45ac725f28f17ae32bf03052c643e3)\n\t* [Commit 4](https://github.com/nextcloud/server/commit/b7b7380d6bb45332cc67f801731dd077a915750a)\n\t* [Commit 5](https://github.com/nextcloud/server/commit/877e1bb55b5a454b4cda0ac92bc38c3aa1a04501)\n\t* [Commit 6](https://github.com/nextcloud/server/commit/c743af30d6dd5b76f42f8dc76a23ccfacf494352)\n\t* [Commit 7](https://github.com/nextcloud/server/commit/42a51146d1b353f4e5eaf5bd8132047a668ab6c3)\n\n* [**15.0.14rc1**](https://github.com/nextcloud/server/releases/tag/v15.0.14RC1) by the following commits :\n\t* [Commit 1](https://github.com/nextcloud/server/commit/a52c84b5b8b322bb4d2ed677fd3625a4297153bb) \n\t* [Commit 2](https://github.com/nextcloud/server/commit/663a42dfd539079696eb313e6836171d05d9c20b)\n\t* [Commit 3](https://github.com/nextcloud/server/commit/b50c2078a02fcb32f16ed8b949eaa01d03ddf712)\n\t* [Commit 4](https://github.com/nextcloud/server/commit/1d7db7d1979ed1d218ec585d490219f0e1850abd)\n\t* [Commit 5](https://github.com/nextcloud/server/commit/d5d8bb05770e32ca9e9a1991fae2d848922a9a18)\n\t* [Commit 6](https://github.com/nextcloud/server/commit/290b4f2ece5f2744d698716518a07140dfe23e47)\n\t* [Commit 7](https://github.com/nextcloud/server/commit/18975b3e1dd50c3dc701beeba54cce4a9ed5ca7a)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.0
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ralf Thesing",
    "workaround": "",
    "vendorFixDate": "2019-12-12T00:00:00.000Z",
    "vendorNotifiedDate": "2019-09-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2083",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15613",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2083/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/0f3fe7be2c89ed3b9bf892e7e8f7e64d5d75b981",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/18975b3e1dd50c3dc701beeba54cce4a9ed5ca7a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/1d7db7d1979ed1d218ec585d490219f0e1850abd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/1dad2ddf390f3af35a1a343e6d0b21848b765297",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/1fe16ca6f52eaa30649e91d8774234d15ba4af20",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/25d7d6965d45ac725f28f17ae32bf03052c643e3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/290b4f2ece5f2744d698716518a07140dfe23e47",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/42a51146d1b353f4e5eaf5bd8132047a668ab6c3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/5c9f503146382b5c9bd20022053f16f05f283037",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/663a42dfd539079696eb313e6836171d05d9c20b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/6955841c8256121303ae658166e8df2924957af1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/790de0acefafb63a137e8d53514a32e0d20f6f17",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/848ca717304996eb80d390872ebc7990d99e8c4a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/877e1bb55b5a454b4cda0ac92bc38c3aa1a04501",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/a52c84b5b8b322bb4d2ed677fd3625a4297153bb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/a8b484f2e6bc83232161d46f3859d533287d1a1f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/b50c2078a02fcb32f16ed8b949eaa01d03ddf712",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/b7b7380d6bb45332cc67f801731dd077a915750a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/c743af30d6dd5b76f42f8dc76a23ccfacf494352",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/d5d8bb05770e32ca9e9a1991fae2d848922a9a18",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/f7c1fd569e19b83a5afc988a02ba1f87c6a818e4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v15.0.14RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v16.0.7RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v17.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://nextcloud.com/security/advisory/?id=NC-SA-2020-002",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://t.co/bz0R4QmdfG",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2083/default-remediation-status"
            }
        ]
    }
}