{
    "source": "BDSA",
    "name": "BDSA-2019-0821",
    "title": "Python Vulnerable to Carriage Return Line Feed (CRLF) Injection via URL 'path' Parameter in 'urllib' Library",
    "description": "Python is vulnerable to carriage return line feed (CRLF) injection due to improper input validation in the `urllib` library. This could allow an attacker to perform HTTP response splitting attacks by sending maliciously crafted HTTP headers.",
    "technicalDescription": "The `urllib` library, when parsing URLs within the file `Lib/urllib/parse.py`, uses the `DOTALL` flag in a regular expression for `host`/`path` splitting, which allows `.` to match any character including newline characters. An attacker could exploit this by sending a maliciously crafted request including `\\r` and `\\n` control characters in the header to a vulnerable Python application. If processed, this could allow them to split the header and insert arbitrary content into the application's response. This could be leveraged to trick internal services into accepting malicious data, and perform attacks such as bypassing same-origin policy and cross-site scripting (XSS).",
    "publishedDate": "2019-04-02T14:07:51.528Z",
    "updatedDate": "2019-10-28T15:50:24.458Z",
    "disclosureDate": "2019-02-06T00:00:00.000Z",
    "exploitPublishDate": "2019-02-06T00:00:00.000Z",
    "solution": "Fixed in versions:\n* **[3.8.0a4](https://github.com/python/cpython/releases/tag/v3.8.0a4)** by [this](https://github.com/python/cpython/commit/c4e671eec20dfcb29b18596a89ef075f826c9f96) commit,\n* **[3.7.4rc1](https://github.com/python/cpython/releases/tag/v3.7.4rc1)** by [this](https://github.com/python/cpython/commit/7e200e0763f5b71c199aaf98bd5588f291585619) commit,\n* **[3.6.9rc1](https://github.com/python/cpython/releases/tag/v3.6.9rc1)** by [this](https://github.com/python/cpython/commit/c50d437e942d4c4c45c8cd76329b05340c02eb31) commit,\n* **[3.5.8rc1](https://github.com/python/cpython/releases/tag/v3.5.8rc1)** by [this](https://github.com/python/cpython/commit/afe3a4975cf93c97e5d6eb8800e48f368011d37a) commit,\n* **[2.7.17rc1](https://github.com/python/cpython/releases/tag/v2.7.17rc1)** by [this](https://github.com/python/cpython/commit/bb8071a4cae5ab3fe321481dd3d73662ffb26052) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sihoon Lee",
    "workaround": "",
    "vendorFixDate": "2019-05-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0821",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-113"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9947",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0821/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue30458",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue35906",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue35906",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://bugs.python.org/issue36276",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/7e200e0763f5b71c199aaf98bd5588f291585619",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/afe3a4975cf93c97e5d6eb8800e48f368011d37a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/bb8071a4cae5ab3fe321481dd3d73662ffb26052",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/c4e671eec20dfcb29b18596a89ef075f826c9f96",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/commit/c50d437e942d4c4c45c8cd76329b05340c02eb31",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v2.7.17rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.5.8rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.6.9rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.7.4rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/python/cpython/releases/tag/v3.8.0a4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0821/default-remediation-status"
            }
        ]
    }
}