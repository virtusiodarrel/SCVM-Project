{
    "source": "BDSA",
    "name": "BDSA-2021-2624",
    "title": "Xen Vulnerable to Denial-of-Service (DoS) via Excessive Resource Consumption with Grant Table Iteration",
    "description": "Xen is vulnerable to denial-of-service (DoS) due to improper handling of resource monitoring processes. This could allow a guest attacker to cause excessive CPU consumption on a target system.",
    "technicalDescription": "The issue exists within the file `xen/common/grant_table.c`. When tracking the grant mappings created by a domain (for resource monitoring purposes), Xen performs a brute force linear search across all entries in the grant table. If a domain has a sufficiently large number of entries, this can exhaust CPU resources on the system for an excessive period of time.",
    "publishedDate": "2021-08-31T16:34:13.642Z",
    "updatedDate": "2022-09-05T15:44:18.834Z",
    "disclosureDate": "2021-08-27T00:00:00.000Z",
    "solution": "Fixed in the following branches by the following commits which are not yet included in any release:\n* **staging-4.11** by [this](https://github.com/xen-project/xen/commit/a7599f030881b5e1aca63462712011f52222a56b) and [this](https://github.com/xen-project/xen/commit/02c696719301cdb22bf2f029deae14efc7c41b42) commit,\n* **stable-4.12** by [this](https://github.com/xen-project/xen/commit/090986baef8956eba86ed1f51f4013eb7984298d) and [this](https://github.com/xen-project/xen/commit/e8f95a693826bfb5a87bbb6998313a5b7bff0737) commit.\n\nFixed in:\n* [**4.13.4**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.4) by [this](https://github.com/xen-project/xen/commit/4d65fe936a8b99603e9f2457e1b3ec6b6a1a2b60) and [this](https://github.com/xen-project/xen/commit/9d954c8c1a3e3cd70cddf9dbf7da7305de9b1173) commit,\n* [**4.14.3**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.3) by [this](https://github.com/xen-project/xen/commit/b81187fc4032be56be712f0126c7215f243093ed) and [this](https://github.com/xen-project/xen/commit/29aeeda345168a70facfd7c7ef16fbea6d447061) commit,\n* [**4.15.1**](https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.1) by [this](https://github.com/xen-project/xen/commit/2f6ebcec023be0b0873a5e67ce3a0ab301dbac4f) and [this](https://github.com/xen-project/xen/commit/9bfbde40bc268dc479dde785d2435fd5a2e61efd) commit.\n\nThe latest stable releases are available [here](https://github.com/xen-project/xen/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrew Cooper (Citrix)",
    "workaround": "The vendor states that it is possible to reduce the number of grant mappings Xen would allow guests to establish:\n\n> For example, setting \"gnttab_max_maptrack_frames=256\" on the Xen command line (available from Xen 4.5 onwards) or max_maptrack_frames=256\" in the xl domain configurations (available from Xen 4.10 onwards) may be low enough for all hardware Xen is able to run on.  Note that except for driver domains, guests don't normally have a need to establish grant mappings, i.e. they may be okay to run with \"max_maptrack_frames=0\" in their xl domain configurations.\n\nAdditionally, from Xen **4.14** onwards:\n\n> it is also possible to alter the system wide upper bound of the number of grant mappings Xen would allow guests to establish by writing to the `/params/gnttab_max_maptrack_frames` hypervisor file system node.  Note however that changing the value this way will only affect guests yet to be created on the respective host.",
    "vendorFixDate": "2021-08-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2624",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28698",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2624/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/02c696719301cdb22bf2f029deae14efc7c41b42",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/090986baef8956eba86ed1f51f4013eb7984298d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/29aeeda345168a70facfd7c7ef16fbea6d447061",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/2f6ebcec023be0b0873a5e67ce3a0ab301dbac4f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/4d65fe936a8b99603e9f2457e1b3ec6b6a1a2b60",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/9781b51efde251efcc0291ddb1d9c7cefe2b2555",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/9bfbde40bc268dc479dde785d2435fd5a2e61efd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/9d954c8c1a3e3cd70cddf9dbf7da7305de9b1173",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/a7599f030881b5e1aca63462712011f52222a56b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/b1ee10be5625b7d502cef1e6ee3818610ab0d29c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/b81187fc4032be56be712f0126c7215f243093ed",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/commit/e8f95a693826bfb5a87bbb6998313a5b7bff0737",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.13.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.14.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xen-project/xen/releases/tag/RELEASE-4.15.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-380.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xenproject.org/xsa/advisory-380.txt",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2624/default-remediation-status"
            }
        ]
    }
}