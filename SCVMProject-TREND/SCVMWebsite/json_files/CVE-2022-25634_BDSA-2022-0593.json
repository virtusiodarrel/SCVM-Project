{
    "source": "BDSA",
    "name": "BDSA-2022-0593",
    "title": "Qt Vulnerable to Loading Unintended System Libraries via Use of 'LoadLibrary'",
    "description": "Qt on Windows is vulnerable to an unintended system library loading issue. An application that ships without a required library can potentially cause system library files to be from an unintended working directory due to how `LoadLibrary` is used.\n\nAn attacker could supply a malicious library to the working directory, or somewhere on the system pointed to by the `PATH` environment variable, which could be loaded by Qt which could then execute malicious code.",
    "technicalDescription": "To remedy this issue, the vendor has updated instances in `src/plugins/platforms/windows/qwindowsglcontext.cpp` and `src/plugins/platforms/windows/qwindowsopengltester.cpp` where `LoadLibraryA()` is called to instead call `QSystemLibrary::load()`. This ensures that only the expected copy of the system library is used instead of one that has been placed in the application's working directory, or elsewhere in the `PATH` environment variable.",
    "publishedDate": "2022-03-03T15:27:41.844Z",
    "updatedDate": "2022-07-01T11:03:13.275Z",
    "disclosureDate": "2022-02-17T00:00:00.000Z",
    "solution": "Fixed in:\n* [**6.2.4**](https://code.qt.io/cgit/qt/qtbase.git/tag/?h=v6.2.4) by [this](https://code.qt.io/cgit/qt/qtbase.git/commit/?id=0e7ab00374be050e3795b57e3227f40dd07c1df3) commit,\n* [**6.3.0-beta3**](https://code.qt.io/cgit/qt/qtbase.git/tag/?h=v6.3.0-beta3) by [this](https://code.qt.io/cgit/qt/qtbase.git/commit/?id=ac64e68e13f6b8c36c9aa18e12577520b794d60d) commit,\n\nThe vendor has made dedicated patches available:\n* A patch for the **5.15.x** version series is available [here](http://ftp.fau.de/qtproject/archive/qt/5.15/CVE-2022-25643-5.15.diff).\n* A patch for the **6.2.x** version series is available [here](https://download.qt.io/official_releases/qt/6.2/CVE-2022-25643-6.2.diff).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated [here](https://www.qt.io/blog/security-advisory-qlockfile-qauthenticator-windows-platform-plugin) that users can workaround this issue in any application by calling\n> SetSearchPathMode(BASE_SEARCH_PATH_ENABLE_SAFE_SEARCHMODE | BASE_SEARCH_PATH_PERMANENT);\n\nbefore creating the `Q[Core|Gui]Application` object. This should mean that any calls to `LoadLibrary` will only check in the current working directory after it has searched the other paths which should be suffice to prevent the problem. However, the vendor has later stated that they have received reports that this suggested workaround does not always work and referred users to a [Microsoft support article](https://support.microsoft.com/en-us/topic/secure-loading-of-libraries-to-prevent-dll-preloading-attacks-d41303ec-0748-9211-f317-2edc819682e1) for further options.",
    "vendorFixDate": "2022-02-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0593",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-25634",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0593/ranges"
            },
            {
                "rel": "reference",
                "href": "http://ftp.fau.de/qtproject/archive/qt/5.15/CVE-2022-25643-5.15.diff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://code.qt.io/cgit/qt/qtbase.git/commit/?id=0e7ab00374be050e3795b57e3227f40dd07c1df3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://code.qt.io/cgit/qt/qtbase.git/commit/?id=a14f2d59141e05d4c8e116895e918638b920611d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://code.qt.io/cgit/qt/qtbase.git/commit/?id=ac64e68e13f6b8c36c9aa18e12577520b794d60d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://code.qt.io/cgit/qt/qtbase.git/tag/?h=v6.2.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://code.qt.io/cgit/qt/qtbase.git/tag/?h=v6.3.0-beta3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://codereview.qt-project.org/c/qt/qtbase/+/396440",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://download.qt.io/official_releases/qt/6.2/CVE-2022-25643-6.2.diff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://support.microsoft.com/en-us/topic/secure-loading-of-libraries-to-prevent-dll-preloading-attacks-d41303ec-0748-9211-f317-2edc819682e1",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.qt.io/blog/security-advisory-qlockfile-qauthenticator-windows-platform-plugin",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.qt.io/blog/security-advisory-qlockfile-qauthenticator-windows-platform-plugin",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0593/default-remediation-status"
            }
        ]
    }
}