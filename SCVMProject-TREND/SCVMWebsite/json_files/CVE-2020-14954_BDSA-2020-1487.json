{
    "source": "BDSA",
    "name": "BDSA-2020-1487",
    "title": "Mutt and NeoMutt Vulnerable to Man-in-the-Middle (MitM) Response Injection via STARTTLS Buffering Issue",
    "description": "Mutt and NeoMutt are vulnerable to man-in-the-middle (MitM) response injection due to untrusted input being included in a response. An attacker could exploit this issue to spoof information, potentially forging a new mailbox in POP3 or IMAP.",
    "technicalDescription": "The STARTTLS functionality saves any extra information after the `\\r\\n` from the server response of an `A OK begin TLS\\r\\n` in IMAP or `+OK begin TLS\\r\\n` in POP3 message. This data could be added by an attacker through a MitM attack and therefore should not be trusted, however in Mutt and NeoMutt this data is being saved to an internal buffer for later processing which could result in an attacker causing various unintended TLS related actions to occur, in the worst case being able to mimic a session.",
    "publishedDate": "2020-06-23T09:04:06.474Z",
    "updatedDate": "2021-11-30T15:32:07.754Z",
    "disclosureDate": "2020-06-18T00:00:00.000Z",
    "solution": "Fixed in Mutt version **[1.14.4](https://gitlab.com/muttmua/mutt/-/tags/mutt-1-14-4-rel)** by [this](https://gitlab.com/muttmua/mutt/commit/c547433cdf2e79191b15c6932c57f1472bfb5ff4) commit.\n\nFixed in NeoMutt version **[20200619](https://github.com/neomutt/neomutt/releases/tag/20200619)** by [this](https://github.com/neomutt/neomutt/commit/fb013ec666759cb8a9e294347c7b4c1f597639cc) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Damian Poddebniak and Fabian Ising",
    "workaround": "",
    "vendorFixDate": "2020-06-16T00:00:00.000Z",
    "vendorNotifiedDate": "2020-06-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1487",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14954",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1487/ranges"
            },
            {
                "rel": "reference",
                "href": "http://lists.mutt.org/pipermail/mutt-announce/Week-of-Mon-20200615/000023.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://www.mutt.org/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/neomutt/neomutt/commit/fb013ec666759cb8a9e294347c7b4c1f597639cc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/neomutt/neomutt/releases/tag/20200619",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/muttmua/mutt/-/commit/c547433cdf2e79191b15c6932c57f1472bfb5ff4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/muttmua/mutt/-/issues/248",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/muttmua/mutt/-/tags/mutt-1-14-4-rel",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1487/default-remediation-status"
            }
        ]
    }
}