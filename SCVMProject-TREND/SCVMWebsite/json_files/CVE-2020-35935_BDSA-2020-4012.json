{
    "source": "BDSA",
    "name": "BDSA-2020-4012",
    "title": "Advanced Access Manager Plugin for WordPress Vulnerable to Privilege Escalation and Site Takeover Via Authorization Bypass",
    "description": "Advanced Access Manager Plugin for WordPress is vulnerable to privilege escalation and site takeover via authorization bypass. A privileged attacker could exploit this in order to assign themselves multiple roles.",
    "technicalDescription": "If the `Multiple Roles Support`setting is enabled an attacker with low privileges could switch to, or assign themselves, a new role if that role did not have a user-level attribute, or had a user-level attribute which was equal or less than that of the logged-in user. This is of particular concerns with regard to plugins which utilize custom roles, roles which do not have an assigned user-level, and cloned user roles. These three instances have the potential to result in site takeover or privilege escalation depending on the configuration of the available roles. \n\nThis issue occurs in the `addMultiRoleSupport` function within the `Application/Backend/Manager.php` file due to an improper permission check. It was mitigated by correcting the check.",
    "publishedDate": "2021-01-06T14:55:38.143Z",
    "updatedDate": "2021-01-14T14:07:51.053Z",
    "disclosureDate": "2020-08-20T00:00:00.000Z",
    "exploitPublishDate": "2020-08-20T00:00:00.000Z",
    "solution": "Fixed in [**6.6.3**](https://github.com/aamplugin/advanced-access-manager/releases/tag/6.6.3) by [this](https://github.com/aamplugin/advanced-access-manager/commit/e07e75ab6daf2967baa05914d38968dd3e0564ba) commit.\n\nThe latest stable releases are available [here](https://github.com/aamplugin/advanced-access-manager/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wordfence",
    "workaround": "",
    "vendorFixDate": "2020-08-15T00:00:00.000Z",
    "discoveryDate": "2020-08-13T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4012",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-305"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-35935",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4012/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aamplugin/advanced-access-manager/commit/e07e75ab6daf2967baa05914d38968dd3e0564ba",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aamplugin/advanced-access-manager/issues/138",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aamplugin/advanced-access-manager/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aamplugin/advanced-access-manager/releases/tag/6.6.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.wordfence.com/blog/2020/08/high-severity-vulnerability-patched-in-advanced-access-manager/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.wordfence.com/blog/2020/08/high-severity-vulnerability-patched-in-advanced-access-manager/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4012/default-remediation-status"
            }
        ]
    }
}