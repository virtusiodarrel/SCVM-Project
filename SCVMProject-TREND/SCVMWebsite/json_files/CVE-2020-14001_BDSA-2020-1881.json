{
    "source": "BDSA",
    "name": "BDSA-2020-1881",
    "title": "kramdown Vulnerable to Remote Code Execution (RCE) via Insecure Template Option Processing",
    "description": "kramdown is vulnerable to remote code execution (RCE) due to lack of user input validation when processing `template` options. A remote attacker could read sensitive data or potentially include executable Ruby code.",
    "technicalDescription": "This vulnerability is exploitable when using the `{::options /}` extension with the template option, which is used in kramdown to define the name of the ERB template file for wrapping output. \n\nAn attacker could access sensitive data via read access (e.g. `template=\"etc/passwd\"`) or could embed executable Ruby code by using an option such as`template=\"string://<%= '`.\n\nThis vulnerability has been fixed in `options.rb` by including a new option `forbidden_inline_options` for defining options that can no longer be set using the `{::options}` extension.",
    "publishedDate": "2020-07-29T15:50:42.536Z",
    "updatedDate": "2021-09-01T10:16:33.379Z",
    "disclosureDate": "2020-06-27T00:00:00.000Z",
    "solution": "Fixed in **[2.3.0](https://github.com/gettalong/kramdown/releases/tag/REL_2_3_0)** by [this](https://github.com/gettalong/kramdown/commit/1b8fd33c3120bfc6e5164b449e2c2fc9c9306fde) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-06-27T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1881",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14001",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1881/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gettalong/kramdown/commit/1b8fd33c3120bfc6e5164b449e2c2fc9c9306fde",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gettalong/kramdown/releases/tag/REL_2_3_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://kramdown.gettalong.org/news.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://kramdown.gettalong.org/rdoc/Kramdown/Options.html#Option+Definitions",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://www.cybersecurity-help.cz/vdb/SB2020072739",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1881/default-remediation-status"
            }
        ]
    }
}