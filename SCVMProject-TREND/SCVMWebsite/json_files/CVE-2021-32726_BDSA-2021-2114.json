{
    "source": "BDSA",
    "name": "BDSA-2021-2114",
    "title": "Nextcloud Server Vulnerable to Authentication Bypass via Improper WebAuthn Token Cleanup",
    "description": "Nextcloud Server is vulnerable to authentication bypass due to a failure to remove access tokens when an account is deleted. An attacker who deletes an account would be able to access the account of a victim that re-uses the account's user name.",
    "technicalDescription": "Nextcloud Server stores WebAuthn tokens within database records. These are mapped to an account's user ID. Whenever an account is deleted, the application fails to remove the token entries from the database. If an attacker deletes their account, and a victim later creates an account with the same user name, then the attacker will be able to access the victim's account.\n\nThe vulnerability was fixed by registering a new event handler class called `UserDeletedWebAuthnCleanupListener`. The `handle()` method within this class uses the user ID of the account that is being deleted to remove the relevant database record.",
    "publishedDate": "2021-07-19T10:51:14.312Z",
    "updatedDate": "2021-10-18T14:57:27.008Z",
    "disclosureDate": "2021-06-18T00:00:00.000Z",
    "exploitPublishDate": "2021-08-07T00:00:00.000Z",
    "solution": "Fixed in:\n* [**21.0.3-rc1**](https://github.com/nextcloud/server/releases/tag/v21.0.3rc1) by [this](https://github.com/nextcloud/server/commit/e757a5ecfdcddbddc29edf0e61ba60de1181315b) commit.\n* [**20.0.11-rc1**](https://github.com/nextcloud/server/releases/tag/v20.0.11rc1) by [this](https://github.com/nextcloud/server/commit/a0bd1800e89f4a0b426cced00e571d5157e6f707) commit.\n* [**19.0.13-rc1**](https://github.com/nextcloud/server/releases/tag/v19.0.13rc1) by [this](https://github.com/nextcloud/server/commit/dba013f428098a29cda58c47f7b11236f81518cc) commit.\n\nThe latest stable releases are available [here](https://github.com/nextcloud/server/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-06-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2114",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-672"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32726",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2114/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/a0bd1800e89f4a0b426cced00e571d5157e6f707",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/dba013f428098a29cda58c47f7b11236f81518cc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/e757a5ecfdcddbddc29edf0e61ba60de1181315b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/pull/27532",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v19.0.13rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v20.0.11rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v21.0.3rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1202590",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2114/default-remediation-status"
            }
        ]
    }
}