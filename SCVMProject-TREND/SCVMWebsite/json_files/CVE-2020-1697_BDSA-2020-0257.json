{
    "source": "BDSA",
    "name": "BDSA-2020-0257",
    "title": "Keycloak Vulnerable to Stored Cross-Site Scripting (XSS) via 'BaseURL' Parameter in Clients Settings Interface",
    "description": "Keycloak is vulnerable to stored cross-site scripting (XSS) due to the insufficient validation of client-provided input. A remote attacker with administrator credentials could execute malicious scripts within the browser of a victim by tricking them into visiting a web page that contains maliciously crafted content. This could allow the attacker to obtain sensitive information, such as browser cookies.",
    "technicalDescription": "Keycloak contains an administrator console which allows users with administrator credentials to specify links to external applications. Administrators can submit links within the Clients settings page, via the `BaseURL` request parameter. The specified URI will then be inserted into a web page. The value associated with the `BaseURL ` parameter is not validated prior to its insertion, with users being able to include any characters they choose. This could allow an attacker with administrator credentials to insert malicious scripts into the web pages associated with the external application links. These scripts will be executed within the browser of clients who view those web pages, potentially allowing the attacker to obtain sensitive information such as browser cookies.",
    "publishedDate": "2020-02-19T10:22:18.291Z",
    "updatedDate": "2021-07-07T10:37:25.226Z",
    "disclosureDate": "2020-01-16T00:00:00.000Z",
    "solution": "Fixed in version [**9.0.0**](https://github.com/keycloak/keycloak/releases/tag/9.0.0) by [this](https://github.com/keycloak/keycloak/commit/75457496325c4ae8963199a318d834d6a5eaad16) commit.\n\nThe latest stable release can be found [here](https://github.com/keycloak/keycloak/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.0,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 1.0,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Cure53 Berlin",
    "workaround": "",
    "vendorFixDate": "2019-12-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0257",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-1697",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0257/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-1697",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/75457496325c4ae8963199a318d834d6a5eaad16",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases/tag/9.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0257/default-remediation-status"
            }
        ]
    }
}