{
    "source": "BDSA",
    "name": "BDSA-2020-0580",
    "title": "Nagios Remote Plugin Executor (NRPE) Vulnerable to Command Injection via Insufficient Validation in Configuration File",
    "description": "Nagios Remote Plugin Executor (NRPE) contains a command injection vulnerability due to insufficient validation in the configuration file. An attacker can exploit this vulnerability to execute operating system commands.",
    "technicalDescription": "When NRPE is compiled with command line parameter support, and `dont_blame_nrpe` option is enabled in the configuration file, and a NRPE config file is in use where the `nasty_metachars` value is being overwritten, it is possible for an attacker to perform command injection.\nThis is due to the way NRPE is processing the configuration file, which loses the significance of characters such as `\\n` which will be treated as `\\` and `n` separately instead of a new line.",
    "publishedDate": "2020-03-31T12:15:15.266Z",
    "updatedDate": "2021-11-30T16:05:06.940Z",
    "disclosureDate": "2020-03-04T00:00:00.000Z",
    "exploitPublishDate": "2020-03-04T00:00:00.000Z",
    "solution": "Fixed in version [**4.0.0**](https://github.com/NagiosEnterprises/nrpe/releases/tag/nrpe-4.0.0) by [this](https://github.com/NagiosEnterprises/nrpe/commit/0db345444d0dcb3e37cca1bcbb0027dcbb764197) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tobias Neitzel of usd AG",
    "workaround": "* Do not compile NRPE with command line parameter support.\n* Do not enable the `dont_blame_nrpe` option inside the NRPE configuration file.\n* Do not enable the `nasty_metachars` override in the `/etc/nagios/nrpe.cfg` file.",
    "vendorFixDate": "2020-01-09T00:00:00.000Z",
    "discoveryDate": "2020-01-06T00:00:00.000Z",
    "vendorNotifiedDate": "2020-01-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0580",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-6581",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0580/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NagiosEnterprises/nrpe/commit/04cef56c472a3e6c81e7eafa094e3f9f1f125ec5",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NagiosEnterprises/nrpe/commit/0db345444d0dcb3e37cca1bcbb0027dcbb764197",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NagiosEnterprises/nrpe/releases/tag/nrpe-4.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://herolab.usd.de/security-advisories/usd-2020-0002/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://herolab.usd.de/security-advisories/usd-2020-0002/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://herolab.usd.de/security-advisories/usd-2020-0002/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0580/default-remediation-status"
            }
        ]
    }
}