{
    "source": "BDSA",
    "name": "BDSA-2019-4725",
    "title": "Apache Impala Vulnerable to Privilege Escalation via Exposed Session and Query IDs",
    "description": "Apache Impala contains a privilege escalation vulnerability.  This is due to session and query IDs not being generated with a cryptographically secure random number generator, and not being considered \"sensitive\" in general.  Due to this, certain output logs or interfaces may expose session or query IDs. \n\nWhen Apache Impala is configured with Apache Sentry or Apache Ranger authorization enabled, it may be possible for remote authenticated attackers to hijack sessions resulting in privilege escalation.",
    "technicalDescription": "The vulnerability occurs in the Apache Hive Server2 (HS2) Beeswax protocol session management source, in the `be/src/service/*` directory.  Multiple files relating to the `ImpalaServer` implementation do not consider the session id and query id values to be sensitive, and may output these values to log files.  This can lead to sensitive credentials being retrieved by an attacker.  These can then be used to potentially escalate privileges.",
    "publishedDate": "2020-10-06T14:10:05.273Z",
    "updatedDate": "2020-10-06T14:10:05.265Z",
    "disclosureDate": "2019-11-04T00:00:00.000Z",
    "solution": "Fixed in [**3.3.0-rc1**](https://github.com/apache/impala/releases/tag/3.3.0-rc1) by [this](https://github.com/apache/impala/commit/ab908d54c22861967f693428ec7d9f6d7008607f) commit. \n\nThe latest stable releases are available [here](https://github.com/apache/impala/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.7,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-06-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4725",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10084",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4725/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitbox.apache.org/repos/asf?p=impala.git;h=ab908d5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/impala/commit/ab908d54c22861967f693428ec7d9f6d7008607f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/impala/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/impala/releases/tag/3.3.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/IMPALA-8605",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/ee73dd8dc38ac3b3b132c79c9a02cf9524af9aa11190474c0ebd1f13@%3Cdev.impala.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2019/11/04/1",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4725/default-remediation-status"
            }
        ]
    }
}