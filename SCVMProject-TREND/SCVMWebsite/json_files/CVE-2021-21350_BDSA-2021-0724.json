{
    "source": "BDSA",
    "name": "BDSA-2021-0724",
    "title": "Xstream Vulnerable to Remote Code Execution (RCE) via Input Stream Containing 'PriorityQueue'",
    "description": "Xstream is vulnerable to remote code execution (RCE) by an attacker who can supply a specially crafted input stream.",
    "technicalDescription": "At unmarshalling time, during the processing of a stream containing `PriorityQueue`, XStream uses type information to recreate the objects from supported formats, such as XML and JSON. An attacker can utilize this feature to force Java code to execute arbitrary system commands, or execute other business logic critical functions.\n\nUsers who follow the official recommendation to setup XStream's security framework with a whitelist limited to the minimal required types are not affected by this vulnerability.",
    "publishedDate": "2021-03-23T15:59:20.399Z",
    "updatedDate": "2021-03-23T15:59:36.533Z",
    "disclosureDate": "2021-03-13T00:00:00.000Z",
    "exploitPublishDate": "2021-03-13T00:00:00.000Z",
    "solution": "Fixed in **[1.4.16](https://github.com/x-stream/xstream/releases/tag/XSTREAM_1_4_16)** by [this](https://github.com/x-stream/xstream/commit/d5e51177634afea7213b9dc2d21f101d2e258db9) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "threedr3am",
    "workaround": "Official workarounds for various versions are available [here](https://x-stream.github.io/security.html#workaround).",
    "vendorFixDate": "2021-03-09T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0724",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21350",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0724/ranges"
            },
            {
                "rel": "reference",
                "href": "http://x-stream.github.io/CVE-2021-21350.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/commit/d5e51177634afea7213b9dc2d21f101d2e258db9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/releases/tag/XSTREAM_1_4_16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/security/advisories/GHSA-43gc-mjxg-gvrq",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/security.html#workaround",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0724/default-remediation-status"
            }
        ]
    }
}