{
    "source": "BDSA",
    "name": "BDSA-2022-1482",
    "title": "Guzzle Vulnerable to Cross Domain Cookie Leak via Missing Domain Match Check",
    "description": "Guzzle is vulnerable to a cross domain cookie leak vulnerability. This allows a malicious server to set cookies for other domains, effectively breaking cookie related security protocols.\n\n**Note**: This vulnerability is in the cookie middleware, which is disabled by default. For an application to become vulnerable it must either manually add the cookie middleware to the handler stack or construct the client with `['cookies' => true]`. It should also be noted that, applications which do not use the same Guzzle client to call multiple domains and have disabled redirect forwarding are not affected by this vulnerability.",
    "technicalDescription": "The cross domain cookie leak is due to a missing domain match check in the `extractCookies` function in `src/Cookie/CookieJar.php`.",
    "publishedDate": "2022-05-26T13:37:08.714Z",
    "updatedDate": "2022-05-26T13:37:08.696Z",
    "disclosureDate": "2022-05-25T00:00:00.000Z",
    "solution": "Fixed in versions [**6.5.6**](https://github.com/guzzle/guzzle/releases/tag/6.5.6) by [this](https://github.com/guzzle/guzzle/commit/f092dd734083473658de3ee4bef093ed77d2689c) commit and [**7.4.3**](https://github.com/guzzle/guzzle/releases/tag/7.4.3) by [this](https://github.com/guzzle/guzzle/commit/74a8602c6faec9ef74b7a9391ac82c5e65b1cdab) commit\n\nThe latest stable releases can be found [here](https://github.com/guzzle/guzzle/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor suggests the following workaround to mitigate this vulnerability,\n\n> If you do not need support for cookies, turn off the cookie middleware. It is already off by default, but if you have turned it on and no longer need it, turn it off.",
    "vendorFixDate": "2022-05-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1482",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-565"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-29248",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1482/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/commit/74a8602c6faec9ef74b7a9391ac82c5e65b1cdab",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/commit/f092dd734083473658de3ee4bef093ed77d2689c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/releases/tag/6.5.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/releases/tag/7.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/security/advisories/GHSA-cwmx-hcrq-mhc3",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/security/advisories/GHSA-cwmx-hcrq-mhc3",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1482/default-remediation-status"
            }
        ]
    }
}