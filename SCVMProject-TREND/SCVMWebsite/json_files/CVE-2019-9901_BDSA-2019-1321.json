{
    "source": "BDSA",
    "name": "BDSA-2019-1321",
    "title": "Envoy Vulnerable to Relative Path Traversal via Missing Path Normalization",
    "description": "Envoy is vulnerable to relative path traversal due to the incorrect parsing of URIs. A remote attacker could bypass access control policies by submitting requests that contain crafted resource paths.",
    "technicalDescription": "Envoy processes URIs according to code that is contained in a variety of scripts, such as `config.cc` and `admin.h`. Although a variety of configurations are available for tasks such as rate limiting and routing policies, no normalization of received URIs is conducted. This can lead to discrepancies whereby the proxy component and back-end component can perceive URI in different ways. For example, a URI containing the path `info/../private` will correspond to a prefix match on `info`, but will be used to return the `private` resource. This could allow attackers to gain unauthorized access to resources, and to bypass rate-limiting mechanisms, potentially causing a denial-of-service (DoS).",
    "publishedDate": "2019-04-30T09:03:16.786Z",
    "updatedDate": "2019-04-30T09:03:16.773Z",
    "disclosureDate": "2019-03-29T00:00:00.000Z",
    "exploitPublishDate": "2019-03-29T00:00:00.000Z",
    "solution": "Fixed in version [**1.9.1**](https://github.com/envoyproxy/envoy/releases/tag/v1.9.1) by [this](https://github.com/envoyproxy/envoy/commit/5d03d2b37a768188156d6acf405b1cc1db866b52) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.4
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Erlend Oftedal",
    "workaround": "The vendor advises that the following workaround may be used:\n\n\"External data plane sidecall servers such as ext_authz that interact with Envoy supplied headers can be modified to detect and reject requests with relative path components or perform their own path normalization.\"",
    "vendorFixDate": "2019-03-27T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1321",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9901",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1321/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/5d03d2b37a768188156d6acf405b1cc1db866b52",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/issues/6435",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/issues/6435",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/issues/6435",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.9.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1321/default-remediation-status"
            }
        ]
    }
}