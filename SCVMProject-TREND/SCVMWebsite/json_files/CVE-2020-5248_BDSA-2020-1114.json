{
    "source": "BDSA",
    "name": "BDSA-2020-1114",
    "title": "GLPI Vulnerable to Information Disclosure via Static GLPI Encryption Key",
    "description": "GLPI is vulnerable to information disclosure due to the fact that it uses a default static key to encrypt sensitive data. This means anyone could decrypt sensitive data stored using this key.",
    "technicalDescription": "GLPI uses a static key (defined as `GLPIKEY` in the file `inc/define.php`) to encrypt sensitive data, including passwords for LDAP, SMTP, IMAP, and Proxy. Since the encryption key is the same on all GLPI installs, an attacker could easily decrypt any password, potentially obtained by exploiting other vulnerabilities in GLPI.",
    "publishedDate": "2020-05-15T09:11:31.939Z",
    "updatedDate": "2020-05-15T09:11:31.934Z",
    "disclosureDate": "2020-05-12T00:00:00.000Z",
    "exploitPublishDate": "2020-05-12T00:00:00.000Z",
    "solution": "Fixed in [**9.4.6**](https://github.com/glpi-project/glpi/releases/tag/9.4.6) by [this](https://github.com/glpi-project/glpi/commit/efd14468c92c4da43333aa9735e65fd20cbc7c6c) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "To work around the issue the vendor advises changing the key (for example, using `php bin/console glpi:security:changekey`), but it is also noted that the underlying data has to be re-encrypted. This should be done by storing the data again via the UI.\n\nKey migration will be forced in the next major release (**9.5**).",
    "vendorFixDate": "2020-02-06T00:00:00.000Z",
    "vendorNotifiedDate": "2020-03-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1114",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-321"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5248",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1114/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/commit/efd14468c92c4da43333aa9735e65fd20cbc7c6c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/releases/tag/9.4.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/glpi-project/glpi/security/advisories/GHSA-j222-j9mf-h6j9",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://offsec.almond.consulting/multiple-vulnerabilities-in-glpi.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://offsec.almond.consulting/multiple-vulnerabilities-in-glpi.html",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1114/default-remediation-status"
            }
        ]
    }
}