{
    "source": "BDSA",
    "name": "BDSA-2021-0111",
    "title": "Laravel and illuminate/database Vulnerable to Query Manipulation via 'value' Parameter",
    "description": "Laravel, and the illuminate/database package used by Laravel, are vulnerable to query manipulation due to improper validation of query parameters. This could allow an attacker to send maliciously crafted queries which return unexpected results or perform unexpected actions.",
    "technicalDescription": "The issue exists within the file `src/Illuminate/Database/Query/Builder.php`. The component does not properly validate the `value` query parameter. If an array is passed in this parameter for a field which is not an array, this could lead to more query bindings being added to the query than intended, and allow malicious queries using crafted array values to point to unexpected locations in the target database.",
    "publishedDate": "2021-01-20T16:35:01.299Z",
    "updatedDate": "2021-01-20T16:35:01.292Z",
    "disclosureDate": "2021-01-13T00:00:00.000Z",
    "exploitPublishDate": "2021-01-13T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/laravel/framework/commit/d0954f4574f315f0c2e9e65e92cc74b80eadcac1) commit in Laravel versions:\n* [**6.20.11**](https://github.com/laravel/framework/releases/tag/v6.20.11)\n* [**7.30.2**](https://github.com/laravel/framework/releases/tag/v7.30.2)\n* [**8.22.1**](https://github.com/laravel/framework/releases/tag/v8.22.1)\n\nFixed by [this](https://github.com/illuminate/database/commit/49563a8b1676c13207b3c3bd516f1b7a8c343887) commit in `illuminate/database` versions:\n* [**6.20.12**](https://github.com/illuminate/database/releases/tag/v6.20.12)\n* [**7.30.3**](https://github.com/illuminate/database/releases/tag/v7.30.3)\n* [**8.22.1**](https://github.com/illuminate/database/releases/tag/v8.22.1)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-01-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0111",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21263",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0111/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/illuminate/database/commit/49563a8b1676c13207b3c3bd516f1b7a8c343887",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/illuminate/database/releases/tag/v6.20.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/illuminate/database/releases/tag/v7.30.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/illuminate/database/releases/tag/v8.22.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laravel/framework/commit/d0954f4574f315f0c2e9e65e92cc74b80eadcac1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laravel/framework/releases/tag/v6.20.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laravel/framework/releases/tag/v7.30.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laravel/framework/releases/tag/v8.22.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/laravel/framework/security/advisories/GHSA-3p32-j457-pg5x",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://kanecohen.com/blog/laravel-security-update-jan-13/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://kanecohen.com/blog/laravel-security-update-jan-13/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0111/default-remediation-status"
            }
        ]
    }
}