{
    "source": "BDSA",
    "name": "BDSA-2021-2895",
    "title": "mpath Vulnerable to Prototype Pollution via Type Confusion in 'index.js' File",
    "description": "mpath is vulnerable to prototype pollution due to the existence of a type confusion flaw. A remote attacker could modify the properties of an object by sending maliciously crafted requests to a vulnerable application. The exact impact that the attacker can achieve will depend on how the object is used. Possible impacts include remote code execution (RCE) and denial-of-service (DoS).",
    "technicalDescription": "The `exports.set()` and `exports.unset()` methods of file `lib/index.js` utilize the `parts` variable. This is intended to be an array which is comprised of string or number elements. However, no validation is performed to ensure that this is the case. If the array contains invalid values, then type confusion can occur. This type confusion can allow for the bypassing of prototype pollution protection mechanisms. An attacker could therefore use maliciously crafted requests in order to carry out a prototype pollution attack.\n\nThe vulnerability was fixed by adding a check that ensures that any given element of `parts` constitutes a string or a number.",
    "publishedDate": "2021-09-29T16:07:34.924Z",
    "updatedDate": "2021-09-29T16:07:34.912Z",
    "disclosureDate": "2021-08-31T00:00:00.000Z",
    "exploitPublishDate": "2021-09-01T00:00:00.000Z",
    "solution": "Fixed in version [**0.8.4**](https://github.com/aheckmann/mpath/releases/tag/0.8.4) by [this](https://github.com/aheckmann/mpath/commit/89402d2880d4ea3518480a8c9847c541f2d824fc) commit.\n\nThe latest stable releases can be found [here](https://www.npmjs.com/package/mpath).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alessio Della Libera (Snyk Research Team)",
    "workaround": "",
    "vendorFixDate": "2021-09-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2895",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-668"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-915"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23438",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2895/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aheckmann/mpath/commit/89402d2880d4ea3518480a8c9847c541f2d824fc",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aheckmann/mpath/pull/13",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/aheckmann/mpath/releases/tag/0.8.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-1579548",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/mpath",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2895/default-remediation-status"
            }
        ]
    }
}