{
    "source": "BDSA",
    "name": "BDSA-2020-3536",
    "title": "HashiCorp Consul Vulnerable to Access Control Bypass via Improper Access Control with Connect CA Configuration Endpoint",
    "description": "HashiCorp Consul is vulnerable to access control bypass due to improper permissions management. This could allow an attacker to obtain sensitive Connect CA configuration data, including private keys, in order to access Consul Connect services.",
    "technicalDescription": "The issue exists within the file `agent/consul/connect_ca_endpoint.go`. Consul does not sufficiently restrict access to the `/connect/ca/configuration` endpoint. This could allow an attacker with `operator:read` permissions to access the endpoint if it is explicitly configured, which can be leveraged to sign certificates and perform malicious actions as any Consul Connect service in the mesh.\n\nThe vendor addressed this issue by changing the access permissions required from `operator:read` to `operator:write`.",
    "publishedDate": "2020-11-25T17:28:13.231Z",
    "updatedDate": "2021-10-21T14:28:32.763Z",
    "disclosureDate": "2020-11-19T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.9.0**](https://github.com/hashicorp/consul/releases/tag/v1.9.0) by [this](https://github.com/hashicorp/consul/commit/ff5215d882ac51b49c2647aac46b42aa9c890ce3) commit,\n* [**1.8.6**](https://github.com/hashicorp/consul/releases/tag/v1.8.6) by [this](https://github.com/hashicorp/consul/commit/8ed789766b95b149da2f0d9cb50feda91fbb94b4) commit,\n* [**1.7.10**](https://github.com/hashicorp/consul/releases/tag/v1.7.10) by [this](https://github.com/hashicorp/consul/commit/f7fc4efc5577a2df731b8f5460472a58fd1c9987) commit,\n* [**1.6.10**](https://github.com/hashicorp/consul/releases/tag/v1.6.10) by [this](https://github.com/hashicorp/consul/commit/a5ab619dd5da928155b7719b805db81c48afbbb2) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-11-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3536",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28053",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3536/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/ff5215d882ac51b49c2647aac46b42aa9c890ce3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/pull/9240",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.6.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.7.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.8.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.9.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3536/default-remediation-status"
            }
        ]
    }
}