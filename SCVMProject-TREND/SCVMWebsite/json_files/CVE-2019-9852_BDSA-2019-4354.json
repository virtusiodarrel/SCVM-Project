{
    "source": "BDSA",
    "name": "BDSA-2019-4354",
    "title": "LibreOffice Vulnerable to Arbitrary Code Execution via Directory Traversal in Malformed Document",
    "description": "A path traversal vulnerability has been discovered in LibreOffice. An attacker could exploit this vulnerability via a crafted ODT file to execute arbitrary code against the target system.",
    "technicalDescription": "This vulnerability was originally disclosed under CVE-2018-16858 (described in BDSA-2019-0285), but it was discovered that the implemented fix (included in releases **6.1.3.2** and **6.0.7.3**) could be bypassed due to insufficient validation of URL encoding attacks. Therefore a further fix was required which was disclosed under CVE-2019-9852 (this advisory). However this fix  (included in releases **6.2.6.2** and **6.3.0.3**) could also be bypassed by taking advantage of a flaw in how LibreOffice created the final script URL location directly from components of the passed in path rather than from the sanitized output of the path verification step. An additional fix was required which was disclosed under CVE-2019-9854 (described in BDSA-2019-3105).",
    "publishedDate": "2020-04-06T14:58:28.517Z",
    "updatedDate": "2020-08-14T15:48:28.213Z",
    "disclosureDate": "2019-02-01T00:00:00.000Z",
    "exploitPublishDate": "2019-02-01T00:00:00.000Z",
    "solution": "Fixed in [**6.2.7.1**](https://github.com/LibreOffice/core/releases/tag/libreoffice-6.2.7.1) by the following commits:\n* [Commit 1](https://gerrit.libreoffice.org/c/core/+/61957)\n* [Commit 2](https://gerrit.libreoffice.org/c/core/+/76396)\n* [Commit 3](https://gerrit.libreoffice.org/c/core/+/77377)\n\nFixed in [**6.3.1.1**](https://github.com/LibreOffice/core/releases/tag/libreoffice-6.3.1.1) by the following commits:\n* [Commit 1](https://gerrit.libreoffice.org/c/core/+/61957)\n* [Commit 2](https://gerrit.libreoffice.org/c/core/+/76395)\n* [Commit 3](https://gerrit.libreoffice.org/c/core/+/77379)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.2
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alex Inf\u00fchr",
    "workaround": "",
    "vendorFixDate": "2019-07-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4354",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9852",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4354/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/commit/7942929685fafb0f9c82feb8da7279e5103c87f0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/commit/87959e5deea6d33cd35dbb3b8423056f9566710e#diff-5306ca8749983031c34ab289ee5ccb43",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/commit/87d36feab5ce4b45798b0b80abe566fc7960d194",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/releases/tag/libreoffice-6.2.7.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/LibreOffice/core/releases/tag/libreoffice-6.3.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://insert-script.blogspot.com/2019/02/libreoffice-cve-2018-16858-remote-code.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.debian.org/security/2019/dsa-4381",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/46727",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.libreoffice.org/about-us/security/advisories/CVE-2019-9852",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.libreoffice.org/about-us/security/advisories/CVE-2019-9854/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.libreoffice.org/about-us/security/advisories/cve-2018-16858/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4354/default-remediation-status"
            }
        ]
    }
}