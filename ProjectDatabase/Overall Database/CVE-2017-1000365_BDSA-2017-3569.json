{
    "source": "BDSA",
    "name": "BDSA-2017-3569",
    "title": "Linux Kernel Vulnerable to Denial-of-Service via Stack Size Restriction Bypass through Argument and Environment Pointers",
    "description": "Linux kernel is vulnerable to denial-of-service (DoS) because it doesn't properly limit the amount of memory that can be allocated to the stack. A limit of 1/4 of the `RLIMIT_STACK` is placed on the command-line arguments and environment variables, but can be bypassed by using pointers to these strings instead.\n\nOn its own this vulnerability can allow an attacker to exhaust system memory and overwrite arbitrary memory regions which will typically result in a crash. However, when combined with vulnerability in the stack guard page (CVE-2017-1000364/BDSA-2017-1336), this can allow an attacker to craft privilege escalation and arbitrary code execution exploits by leveraging the Stack Clash technique.",
    "technicalDescription": "This flaw exists in the `/fs/exec.c` source file because the stack memory allocation limit is only placed on the command-line arguments and environment variables but not on the `argv[]` and `envp[]` pointers to these strings. Since the stack will also hold the pointers to the strings they should be handled appropriately, but current implementation of `exec.c` does not include the storage of the pointers to the strings in the calculation. An attacker could leverage this flaw via an exec with a large number of strings and pointers to those strings to overwrite arbitrary memory regions and completely exhaust the stack space. Typically this will lead to a crash, but could also be chained with another known vulnerability (CVE-2017-1000364/BDSA-2017-1336) to craft privilege escalation and arbitrary code execution exploits.",
    "publishedDate": "2018-09-06T15:13:09.996Z",
    "updatedDate": "2018-10-03T10:07:22.981Z",
    "disclosureDate": "2017-06-19T00:00:00.000Z",
    "exploitPublishDate": "2017-06-19T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.2.91**](https://www.kernel.org/)\n* [**3.10.108**](https://www.kernel.org/)\n* [**3.16.46**](https://www.kernel.org/)\n* [**3.18.59**](https://www.kernel.org/)\n* [**4.1.43**](https://www.kernel.org/)\n* [**4.4.75**](https://www.kernel.org/)\n* [**4.9.35**](https://www.kernel.org/)\n* [**4.11.8**](https://www.kernel.org/)\n* [**4.12-rc7**](https://www.kernel.org/)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=98da7d08850fb8bdeb395d6368ed15753304aa0c) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.6,
        "impactSubscore": 7.8,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.4
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:P/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Qualys Inc.",
    "workaround": "",
    "vendorFixDate": "2017-06-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-3569",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-1000365",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-3569/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.qualys.com/securitylabs/2017/06/19/the-stack-clash",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1462147",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=98da7d08850fb8bdeb395d6368ed15753304aa0c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt",
                "label": "POC"
            }
        ]
    }
}