{
    "source": "BDSA",
    "name": "BDSA-2022-1949",
    "title": "ImpressCMS Vulnerable to Remote Code Execution (RCE) via Directory Traversal in 'origName' and 'imageName'",
    "description": "ImpressCMS contains a directory traversal vulnerability. An attacker could exploit this issue by supplying the application with a maliciously crafted image path to carry out a path traversal which could lead to an arbitrary file copy or overwrite. This could be exploited to eventually lead to pre-authentication remote code execution (RCE).",
    "technicalDescription": "Attacker-controlled parameters, `origName` and `imageName`, can be used to call the `copy()` function by an attacker when an undo action is performed. This allows for the arbitrary copying of stored files. In turn, this can allow for an attacker to store malicious PHP code on the server, where it can be copied to a public directory with a `.php` extension, such as through an image format. This can lead to an attacker gaining the ability to execute remote code without the need for authentication.",
    "publishedDate": "2022-07-13T16:04:34.409Z",
    "updatedDate": "2022-07-13T16:04:34.398Z",
    "disclosureDate": "2022-02-12T00:00:00.000Z",
    "exploitPublishDate": "2022-02-12T00:00:00.000Z",
    "solution": "Fixed in version [**1.4.2-rc**](https://github.com/ImpressCMS/impresscms/releases/tag/v1.4.2_rc) by [this](https://github.com/ImpressCMS/impresscms/commit/a66d7bb499faafab803e24833606028fa0ba4261) commit.\n\nFixed in version [**2.0.0-alpha-11**](https://github.com/ImpressCMS/impresscms/releases/tag/v2.0.0_alpha_11) by [this](https://github.com/ImpressCMS/impresscms/commit/7f548cf6cefcca9c55acfa9e5f1fc02ee60d8657) commit.\n\nThe latest stable releases can be found [here](https://github.com/ImpressCMS/impresscms/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "rekter0",
    "workaround": "",
    "vendorFixDate": "2020-12-04T00:00:00.000Z",
    "discoveryDate": "2020-10-30T00:00:00.000Z",
    "vendorNotifiedDate": "2020-11-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1949",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24977",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1949/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImpressCMS/impresscms/commit/7f548cf6cefcca9c55acfa9e5f1fc02ee60d8657",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImpressCMS/impresscms/commit/a66d7bb499faafab803e24833606028fa0ba4261",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImpressCMS/impresscms/releases/tag/v1.4.2_rc",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImpressCMS/impresscms/releases/tag/v2.0.0_alpha_11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ImpressCMS/impresscms/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://r0.haxors.org/posts?id=8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://r0.haxors.org/posts?id=8",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1949/default-remediation-status"
            }
        ]
    }
}