{
    "source": "BDSA",
    "name": "BDSA-2022-1964",
    "title": "Pimcore Vulnerable to Stored Cross-Site Scripting (XSS) via Unrestricted File Upload in 'Appearance and Branding' Settings",
    "description": "Pimcore contains an unrestricted file upload vulnerability due to lack of restrictions on uploaded file types. An attacker with administrator privileges could exploit this vulnerability through the uploading of maliciously crafted SVG files in the \"Appearance and Branding\" section of \"Settings\". This would allow for the execution of malicious scripts on the application upon opening the malicious SVG file's URL by a user.",
    "technicalDescription": "This issue was mitigated in the `displayCustomLogoAction()` function of the `bundles/AdminBundle/Controller/Admin/SettingsController.php` file by the introduction of the following `\"script-src 'none'\"` as a preventative measure against cross-site scripting (XSS).",
    "publishedDate": "2022-07-15T14:20:05.032Z",
    "updatedDate": "2022-07-26T08:42:20.973Z",
    "disclosureDate": "2022-01-17T00:00:00.000Z",
    "exploitPublishDate": "2022-01-17T00:00:00.000Z",
    "solution": "Fixed in version [**10.3.2**](https://github.com/pimcore/pimcore/releases/tag/v10.3.2) by [this](https://github.com/pimcore/pimcore/commit/07ec590718221bc65e460d1eed09953d19208cc5) commit.\n\nThe latest stable releases can be found [here](https://github.com/pimcore/pimcore/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 1.7,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Pocas",
    "workaround": "",
    "vendorFixDate": "2022-01-17T00:00:00.000Z",
    "vendorNotifiedDate": "2022-01-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1964",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-0263",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1964/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/commit/07ec590718221bc65e460d1eed09953d19208cc5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/commit/35d1853baf64d6a1d90fd8803e52439da53a3911",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/releases/tag/v10.2.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/releases/tag/v10.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/96506857-06bc-4c84-88b7-4f397715bcf6/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/96506857-06bc-4c84-88b7-4f397715bcf6/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1964/default-remediation-status"
            }
        ]
    }
}