{
    "source": "BDSA",
    "name": "BDSA-2021-1033",
    "title": "Exiv2 Vulnerable to Denial-of-Service (DoS) via Heap-based Buffer Overflow in 'jp2image.cpp' File",
    "description": "Exiv2 contains a heap-based buffer overflow vulnerability because of improper checks in place for metadata writing operations. An attacker could trick a victim to initiate write operations on a crafted image file and crash the application. This could cause a denial-of-service (DoS).",
    "technicalDescription": "This vulnerability exists in the `src/jp2image.cpp` file. The `void boxes_check()` function does not conduct a proper boundary check for the `box.length` variable. As a result, a heap-based buffer overflow could occur when the application is handling a crafted image file. An attacker could supply such a crafted file and crash the application when it is writing metadata to this file. For this attack to work, the attacker must trick the victim to use this crafted image file for writing metadata. Also, the victim must use special command-line arguments like `insert` to trigger this vulnerability. Exploiting this flaw could also allow an attacker to execute malicious code on the server, although this has not been demonstrated yet.\n\n**Note** This vulnerability is only triggered for write operations and not read operations on image files.",
    "publishedDate": "2021-04-20T13:35:09.279Z",
    "updatedDate": "2021-11-30T15:13:00.321Z",
    "disclosureDate": "2021-04-18T00:00:00.000Z",
    "exploitPublishDate": "2021-04-08T00:00:00.000Z",
    "solution": "Fixed in [**0.27.4-RC2**](https://github.com/Exiv2/exiv2/releases/tag/v0.27.4-RC2) by [this](https://github.com/Exiv2/exiv2/commit/0230620e6ea5e2da0911318e07ce6e66d1ebdf22) commit.\n\nThe latest stable releases are available [here](https://github.com/Exiv2/exiv2/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Zhen Zhou of NSFOCUS Security Team",
    "workaround": "",
    "vendorFixDate": "2021-04-09T00:00:00.000Z",
    "vendorNotifiedDate": "2021-04-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1033",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-29457",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-1033/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/commit/0230620e6ea5e2da0911318e07ce6e66d1ebdf22",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/issues/1529",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/issues/1529",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/releases/tag/v0.27.4-RC2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Exiv2/exiv2/security/advisories/GHSA-v74w-h496-cgqm",
                "label": "ADVISORY"
            }
        ]
    }
}