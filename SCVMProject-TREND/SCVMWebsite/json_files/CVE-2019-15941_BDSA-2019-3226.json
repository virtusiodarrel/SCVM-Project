{
    "source": "BDSA",
    "name": "BDSA-2019-3226",
    "title": "LemonLDAP Connect Issuer Vulnerable to Access Bypass via Crafted OpenID Connect Request",
    "description": "The OpenID Connect Issuer in LemonLDAP could allow an attacker to bypass access control rules via a crafted OpenID Connect authorization request.",
    "technicalDescription": "To be vulnerable, there must be an OIDC relaying party in the LemonLDAP configuration which has weaker access control rules than the target relaying party. Also redirection URIs must not be filtered. For example if one replaying party (R1) is allowed to all users and another (R2) is restricted to admin users, any user (including non-admins) can obtain an OIDC authorization code for R1 using R2's redirect URI. \n\nThis is possible because the developers have not implemented section 3.1.3.2 of the OpenID Connect spec:\n\nEnsure the Authorization Code was issued to the authenticated Client.",
    "publishedDate": "2019-10-16T15:54:12.619Z",
    "updatedDate": "2020-12-14T16:21:12.701Z",
    "disclosureDate": "2019-09-24T00:00:00.000Z",
    "exploitPublishDate": "2019-09-24T00:00:00.000Z",
    "solution": "Fixed in [**2.0.6**](https://lemonldap-ng.org/download) by [this](https://gitlab.ow2.org/lemonldap-ng/lemonldap-ng/commit/daa03a9a9cc213b55838ab99b001d4eced216c1d) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Maxime Besson",
    "workaround": "",
    "vendorFixDate": "2019-08-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3226",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-862"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15941",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3226/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.ow2.org/lemonldap-ng/lemonldap-ng/commit/daa03a9a9cc213b55838ab99b001d4eced216c1d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.ow2.org/lemonldap-ng/lemonldap-ng/issues/1881",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.ow2.org/lemonldap-ng/lemonldap-ng/issues/1881",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://lemonldap-ng.org/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://projects.ow2.org/view/lemonldap-ng/lemonldap-ng-2-0-6-is-out/",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3226/default-remediation-status"
            }
        ]
    }
}