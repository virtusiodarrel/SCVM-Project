{
    "source": "BDSA",
    "name": "BDSA-2022-1663",
    "title": "PowerDNS Authoritative Server and PowerDNS Recursor Vulnerable to Denial-of-Service (DoS) via Insufficient Validation of an IXFR End Condition",
    "description": "An insufficient validation flaw has been identified in PowerDNS Authoritative Server and PowerDNS Recursor. An attacker in control of the network path for IXFR transfers can exploit this in order to cause a denial-of-service (DoS) condition. \n\n**Note:** Per the Vendor, \n* \"In the Authoritative server this issue only applies to secondary zones for which IXFR transfers have been enabled and the network path to the primary server is not trusted. Note that IXFR transfers are not enabled by default.\n* In the Recursor it applies to setups retrieving one or more RPZ zones from a remote server if the network path to the server is not trusted.\"",
    "technicalDescription": "This issue occurs in the `getIXFRDeltas()` function of the `pdns/ixfr.cc` file. It was mitigated by the addition of validation designed to check if the end SOA was seen after the loop, and checks to detect end conditions for both AXFR and IXFR style so as to avoid processing data after the end marker.",
    "publishedDate": "2022-06-15T11:07:39.475Z",
    "updatedDate": "2022-08-01T14:49:53.152Z",
    "disclosureDate": "2022-03-25T00:00:00.000Z",
    "solution": "Fixed in Authoritative Server:\n* [**4.4.3**](https://github.com/PowerDNS/pdns/releases/tag/auth-4.4.3) by [this](https://github.com/PowerDNS/pdns/commit/57312d230d5c01d9aca58cb29ce87e23ccbbefd2) commit,\n* [**4.5.4**](https://github.com/PowerDNS/pdns/releases/tag/auth-4.5.4) by [this](https://github.com/PowerDNS/pdns/commit/fae4de96cb2e15f42b384a5af910bfb61291369d) commit,\n* [**4.6.1**](https://github.com/PowerDNS/pdns/releases/tag/auth-4.6.1) by [this](https://github.com/PowerDNS/pdns/commit/89a28d75ea9b9a817003fc73c6d2381bd86f2a77) commit.\n\nFixed in Recursor:\n* [**4.6.1**](https://github.com/PowerDNS/pdns/releases/tag/rec-4.6.1) by [this](https://github.com/PowerDNS/pdns/commit/933d301555aee6cd44d8ec958865004324dc642f) commit,\n* [**4.5.8**](https://github.com/PowerDNS/pdns/releases/tag/rec-4.5.8) by [this](https://github.com/PowerDNS/pdns/commit/7585d0166cfbdfb201e439620ff5effe2aac63cb) commit,\n* [**4.4.8**](https://github.com/PowerDNS/pdns/releases/tag/rec-4.4.8) by [this](https://github.com/PowerDNS/pdns/commit/ff27c8c8e17bd8093e4668d88865b8eb71039b45) commit.\n\nThe latest stable releases for both Authoritative Server and Recursor can be found [here](https://github.com/PowerDNS/pdns/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Nicolas Dehaine and Dmitry Shabanov from ThreatSTOP",
    "workaround": "",
    "vendorFixDate": "2022-03-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1663",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-27227",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1663/ranges"
            },
            {
                "rel": "reference",
                "href": "https://doc.powerdns.com/authoritative/security-advisories/powerdns-advisory-2022-01.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://docs.powerdns.com/recursor/security-advisories/powerdns-advisory-2022-01.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/commit/57312d230d5c01d9aca58cb29ce87e23ccbbefd2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/commit/7585d0166cfbdfb201e439620ff5effe2aac63cb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/commit/89a28d75ea9b9a817003fc73c6d2381bd86f2a77",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/commit/933d301555aee6cd44d8ec958865004324dc642f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/commit/fae4de96cb2e15f42b384a5af910bfb61291369d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/commit/ff27c8c8e17bd8093e4668d88865b8eb71039b45",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/releases/tag/auth-4.4.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/releases/tag/auth-4.5.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/releases/tag/auth-4.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/releases/tag/rec-4.4.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/releases/tag/rec-4.5.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/releases/tag/rec-4.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/PowerDNS/pdns/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1663/default-remediation-status"
            }
        ]
    }
}