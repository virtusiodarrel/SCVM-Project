{
    "source": "BDSA",
    "name": "BDSA-2020-4336",
    "title": "Ceph Vulnerable to Sensitive Information Disclosure via Insecure Ceph Dashboard JWT Token",
    "description": "Ceph is vulnerable to the disclosure of the Ceph dasboard JWT token due to how it is stored insecurely in users' browsers.\n\nAn attacker could trick a victim user into accessing a malicious page and conduct cross-site scripting (XSS) attacks in an attempt to access the insecure JWT token. The token could then be used to impersonate the victim user on the Ceph dashboard.",
    "technicalDescription": "Ceph is vulnerable to sensitive information disclosure because the JWT token that is provided after authentication with the Ceph dashboard is saved inside the local storage of the browser, making it vulnerable to XSS attacks. On each request, the Ceph dashboard attaches this token to the `Authorization` header to get access to the API.\n\nTo mitigate this issue, the vendor has made changes to store the JWT token in 'secure' cookies instead of local storage.",
    "publishedDate": "2021-04-13T09:25:06.302Z",
    "updatedDate": "2021-04-13T09:25:06.294Z",
    "disclosureDate": "2020-03-13T00:00:00.000Z",
    "solution": "Fixed in:\n* [**16.1.0**](https://github.com/ceph/ceph/releases/tag/v16.1.0) by [this](https://github.com/ceph/ceph/commit/3c72dc309936b23e413dc1aee8ca49c795c48a0f) commit,\n* [**15.2.9**](https://github.com/ceph/ceph/releases/tag/v15.2.9) by [this](https://github.com/ceph/ceph/commit/67edff73234732e69b145d5270d744c3fb8168ab) commit,\n* [**14.2.17**](https://github.com/ceph/ceph/releases/tag/v14.2.17) by [this](https://github.com/ceph/ceph/commit/843b2e9cd4cb996165d1818ebff125f1414f90c5) commit.\n\nThe latest stable releases are available [here](https://github.com/ceph/ceph/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-12-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4336",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-311"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-27839",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4336/ranges"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/cve-2020-27839",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1901330",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/show_bug.cgi?id=1179997",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/commit/3c72dc309936b23e413dc1aee8ca49c795c48a0f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/commit/67edff73234732e69b145d5270d744c3fb8168ab",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/commit/843b2e9cd4cb996165d1818ebff125f1414f90c5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/pull/38259",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases/tag/v14.2.17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases/tag/v15.2.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ceph/ceph/releases/tag/v16.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://tracker.ceph.com/issues/44591",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.suse.com/security/cve/CVE-2020-27839/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4336/default-remediation-status"
            }
        ]
    }
}