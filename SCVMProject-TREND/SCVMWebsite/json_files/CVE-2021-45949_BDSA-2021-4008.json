{
    "source": "BDSA",
    "name": "BDSA-2021-4008",
    "title": "GhostPDL Vulnerable to Memory Corruption via Use-After-Free in 'sampled_data_finish' Function",
    "description": "GhostPDL is vulnerable to memory corruption due to the improper management of system memory resources. An attacker could cause a crash by tricking a victim into running the application with a maliciously crafted input file. It may also be possible for the attacker to modify, or recover, data that resides in memory.",
    "technicalDescription": "The function `sampled_data_continue()`, of file `psi/zfsample.c`, uses the `pop()` function in order to adjust the contents of heap memory. This function fails to handle stack extension blocks correctly, which in turn can cause the size of heap memory buffers which are in use to be incorrect. This can lead to a heap-based buffer overflow whenever `sampled_data_finish()` is called. An attacker could leverage this issue via a maliciously crafted file in order to corrupt the memory of the process. This could allow the attacker to cause a denial-of-service (DoS), or potentially to trigger the modification or disclosure of sensitive in-memory data.",
    "publishedDate": "2022-01-14T15:56:38.689Z",
    "updatedDate": "2022-01-14T15:56:38.674Z",
    "disclosureDate": "2021-03-08T00:00:00.000Z",
    "exploitPublishDate": "2021-03-08T00:00:00.000Z",
    "solution": "Fixed in version [**9.55.0**](https://www.ghostscript.com/releases/index.html) by [this](https://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=2a3129365d3bc0d4a41f107ef175920d1505d1f7) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-06-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4008",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-45949",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4008/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=29903",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=29903",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=2a3129365d3bc0d4a41f107ef175920d1505d1f7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.ghostscript.com/releases/index.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4008/default-remediation-status"
            }
        ]
    }
}