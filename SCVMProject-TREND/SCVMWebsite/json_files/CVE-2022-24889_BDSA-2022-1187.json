{
    "source": "BDSA",
    "name": "BDSA-2022-1187",
    "title": "Nextcloud Vulnerable to Cross-Site Request Forgery (CSRF) via Unsafe Application Installation Functionality",
    "description": "Nextcloud is vulnerable to cross-site request forgery (CSRF) due to insufficient protection mechanisms being implemented for its application installation functionality. A remote authenticated attacker could cause an administrator to inadvertently install applications by tricking that administrator into interacting with crafted web content.",
    "technicalDescription": "Nextcloud's application installation functionality is implemented across a range of files and functions, such as those contained in the files `core/Controller/SetupController.php` and `core/js/dist/install.js`. There are insufficient protection mechanisms implemented within these files to ensure that requests that are received from an administrator were generated via legitimate interactions with the installation pages. An attacker that is able to trick an administrator into interacting with crafted web content leverage this issue in order to cause an administrator to inadvertently install applications.",
    "publishedDate": "2022-04-28T15:59:58.252Z",
    "updatedDate": "2022-06-22T14:44:10.847Z",
    "disclosureDate": "2022-04-27T00:00:00.000Z",
    "exploitPublishDate": "2022-04-29T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**23.0.1-rc3**](https://github.com/nextcloud/server/releases/tag/v23.0.1rc3) by [this](https://github.com/nextcloud/server/commit/2063c586233a647b82279cc76780107d8818178e) commit,\n* [**22.2.4-rc3**](https://github.com/nextcloud/server/releases/tag/v22.2.4rc3) by [this](https://github.com/nextcloud/server/commit/a38ac95ff6b5a6241e5395a1c86b0eefbab7cc34) commit,\n* [**21.0.8-rc3**](https://github.com/nextcloud/server/releases/tag/v21.0.8rc3) by [this](https://github.com/nextcloud/server/commit/2083ed72067dab1832dab790f8618b4c4c76b878) commit.\n\nThe latest stable releases can be found [here](https://github.com/nextcloud/server/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 2.4,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 0.9,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-01-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1187",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24889",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1187/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-5vw6-6prg-gvw6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/2063c586233a647b82279cc76780107d8818178e",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/2083ed72067dab1832dab790f8618b4c4c76b878",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/commit/a38ac95ff6b5a6241e5395a1c86b0eefbab7cc34",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/pull/30615",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v21.0.8rc3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v22.2.4rc3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nextcloud/server/releases/tag/v23.0.1rc3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1403614",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1403614",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1187/default-remediation-status"
            }
        ]
    }
}