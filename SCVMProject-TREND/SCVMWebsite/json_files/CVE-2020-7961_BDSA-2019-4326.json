{
    "source": "BDSA",
    "name": "BDSA-2019-4326",
    "title": "Liferay Portal Vulnerable to Remote Code Execution (RCE) via JSON web services (JSONWS)",
    "description": "Liferay Portal contains a remote code execution (RCE) vulnerability. A remote unauthenticated attacker could utilize JSON web services (JSONWS) to execute arbitrary code on the host system.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "The issue exists due to the way that `JSONWebServiceActionParametersMap`, an object that keeps mappings between parameters passed in a web service call and object types, fills its `_parameterTypes` field. `_parameterTypes` is used to look up the class for deserialization during preparation of the parameters when invoking a web service method. When filling `_parameterTypes` in the `JSONWebServiceActionParametersMap` ,`put` method, the code takes the parameter supplied by the user and checks if it has a colon (`:`) character in it. If it does, it takes anything that goes after it as the parameter's type. Although later there are checks if the specified type extends the type of the corresponding parameter of the method to be invoked, there are services with `java.lang.Object` parameters which allow for the instantiation of arbitrary classes and invocation of arbitrary setter methods.\n\nThis was fixed by using a whitelist of allowed classes.",
    "publishedDate": "2020-03-30T10:31:54.356Z",
    "updatedDate": "2022-05-06T11:10:02.668Z",
    "disclosureDate": "2019-11-25T00:00:00.000Z",
    "exploitPublishDate": "2020-03-26T00:00:00.000Z",
    "solution": "Fixed in [**7.2.1 CE GA2**](https://github.com/community-security-team/liferay-portal/releases/tag/7.2.1-ga2).\n\nA patch for **7.1 GA4** users is available [here](https://github.com/community-security-team/liferay-portal/compare/7.1.3-ga4...7.1.3-cumulative.patch).\n\nA patch for **7.0 GA7** users is available [here](https://github.com/community-security-team/liferay-portal/compare/7.0.6-ga7...7.0.6-cumulative.patch).\n\nA patch for **6.2 GA6** users is available [here](https://github.com/community-security-team/liferay-portal/compare/6.2.5-ga6...6.2.5-cumulative.patch).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Markus Wulftange",
    "workaround": "To work around this issue the vendor advises disabling `JSONWS` by setting the portal.property `jsonws.servlet.hosts.allowed=Not/Available`.",
    "vendorFixDate": "2019-11-07T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4326",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7961",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4326/ranges"
            },
            {
                "rel": "reference",
                "href": "https://codewhitesec.blogspot.com/2020/03/liferay-portal-json-vulns.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/community-security-team/liferay-portal/compare/6.2.5-ga6...6.2.5-cumulative.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/community-security-team/liferay-portal/compare/7.0.6-ga7...7.0.6-cumulative.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/community-security-team/liferay-portal/compare/7.1.3-ga4...7.1.3-cumulative.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/community-security-team/liferay-portal/releases/tag/7.2.1-ga2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mzer0one/CVE-2020-7961-POC/blob/master/poc.py",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/id/117954271",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/id/117954271",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/48332",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4326/default-remediation-status"
            }
        ]
    }
}