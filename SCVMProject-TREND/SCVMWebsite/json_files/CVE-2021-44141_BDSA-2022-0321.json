{
    "source": "BDSA",
    "name": "BDSA-2022-0321",
    "title": "Samba Vulnerable to Information Disclosure via SMB1 Symlink Queries",
    "description": "Samba file server allows malicious clients to detect if a file or directory exists in an area of the server file system not exported under the share definition. Successful exploitation of this vulnerability requires that the client has a write access to the exported part of the file system via SMB1 (Server Message Block version 1.0) Unix extensions or via NFS (Network File Sharing) protocol.",
    "technicalDescription": "The vulnerability can be exploited by creating symlinks that point to arbitrary files or directories on the server filesystem and listening to server error responses to SMB1 unix extension information queries.",
    "publishedDate": "2022-02-03T16:41:32.139Z",
    "updatedDate": "2022-02-03T16:41:32.125Z",
    "disclosureDate": "2022-01-31T00:00:00.000Z",
    "solution": "Fixed in [**4.15.5**](https://github.com/samba-team/samba/releases/tag/samba-4.15.5) and [**4.16.0rc2**](https://github.com/samba-team/samba/releases/tag/samba-4.16.0rc2).\n\nThe latest stable releases can be found [here](https://download.samba.org/pub/samba/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Stefan Behrens",
    "workaround": "The vendor has proposed the following workaround:\n\n> Do not enable SMB1 (please note SMB1 is disabled by default in Samba\n> from version 4.11.0 and onwards). This prevents the creation or\n> querying of symbolic links via SMB1. If SMB1 must be enabled for\n> backwards compatibility then add the parameter:\n> \n> `unix extensions = no`\n> \n> to the [global] section of your smb.conf and restart smbd. This\n> prevents SMB1 clients from creating or reading symlinks on the\n> exported file system.\n> \n> However, if the same region of the file system is also exported\n> allowing write access via NFS, NFS clients can create symlinks that\n> allow SMB1 with unix extensions clients to discover the existance of\n> the NFS created symlink targets.  For non-patched versions of Samba we\n> recommend only exporting areas of the file system by either SMB2 or\n> NFS, not both.",
    "vendorFixDate": "2021-12-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0321",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-209"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-44141",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0321/ranges"
            },
            {
                "rel": "reference",
                "href": "https://attachments.samba.org/attachment.cgi?id=17136",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://attachments.samba.org/attachment.cgi?id=17136",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2046134",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://download.samba.org/pub/samba/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.15.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.16.0rc2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0321/default-remediation-status"
            }
        ]
    }
}