{
    "source": "BDSA",
    "name": "BDSA-2019-5065",
    "title": "Bludit Vulnerable to Arbitrary File Deletion via Path Traversal using 'username' Parameter in '/admin/ajax/upload-profile-picture' Endpoint",
    "description": "Bludit contains a path traversal vulnerability in its `/admin/ajax/upload-profile-picture` endpoint because of improper input sanitization for the `username` parameter. An authenticated attacker could exploit this flaw to delete arbitrary files.",
    "technicalDescription": "This vulnerability exists in `bl-kernel/ajax/upload-profile-picture.php`.  This file doesn't validate the extension type of uploaded image files. Also, it doesn't properly sanitize the contents of `username` parameter. This could allow an attacker with admin privileges to conduct a path traversal attack and delete arbitrary files on the server. As demonstrated in the PoC, an attacker could navigate to the image upload page. Then, they could intercept the request and change the endpoint to `/admin/ajax/upload-profile-picture` and modify the `profilePictureInputFile` and `username` parameters. The `username` parameter can be used to specify a file to be deleted using a payload like `../../bl-content/databases/site1`. The attacker could use different payloads to delete arbitrary files on the server.",
    "publishedDate": "2021-03-05T14:39:19.415Z",
    "updatedDate": "2021-03-05T14:40:37.913Z",
    "disclosureDate": "2019-03-05T00:00:00.000Z",
    "exploitPublishDate": "2019-03-05T00:00:00.000Z",
    "solution": "Fixed in [**3.9.0-beta1**](https://github.com/bludit/bludit/releases/tag/3.9.0-beta1) by [this](https://github.com/bludit/bludit/commit/2d535ad6123bacdd79a78816ccb4b4ae050b2158) commit.\n\nThe latest stable releases are available [here](https://www.bludit.com/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "jadacheng",
    "workaround": "",
    "vendorFixDate": "2019-03-10T00:00:00.000Z",
    "vendorNotifiedDate": "2019-03-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5065",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-18190",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5065/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bludit/bludit/commit/2d535ad6123bacdd79a78816ccb4b4ae050b2158",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bludit/bludit/issues/978",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bludit/bludit/issues/978",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bludit/bludit/releases/tag/3.9.0-beta1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.bludit.com/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5065/default-remediation-status"
            }
        ]
    }
}