{
    "source": "BDSA",
    "name": "BDSA-2019-1285",
    "title": "Npcap Vulnerable to Denial-of-Service via Stack-Based Buffer Overflow in NPF_BufferedWrite",
    "description": "Npcap as used in Nmap contains a  denial-of-service (DoS) vulnerability.  As this library is only available for Windows operating systems, only Windows is affected by this vulnerability.  This allows a local attacker to cause a process crash by supplying npcap with a crafted file.  If a victim processes a crafted file supplied by an attacker, an attacker may be able to cause a denial-of-service condition without local access to the system.",
    "technicalDescription": "The DoS vulnerability is due to a stack-based buffer overflow occurring in the `NPF_BufferedWrite` function in `packetWin7/npf/npf/Write.c`.  This can be triggered by supplying a crafted `.pcap` file to the npcap utility.  A local attacker can craft a pcap file to overwrite the return instruction pointer in `NPF_BufferedWrite`, this will cause memory corruption and result in a crash. \n\nTo successfully exploit this vulnerability the attacker must send the crafted pcap file to the loopback adapter (`127.0.0.1`) using either `pcap_sendqueue_queue` or  `pcap_sendqueue_transmit`.  These functions will either add the raw packets from the pcap to the queue or packets to be transmitted to loopback, or send the packets.  During this process, the queue will become corrupt, and arbitrary memory address will be overwritten with the data contained in the packets. \n\nBy exploiting this vulnerability, an attacker may be able to cause a system to execute unwanted code.  Although this is heavily dependent on the configuration of an affected system.",
    "publishedDate": "2019-04-26T15:46:04.589Z",
    "updatedDate": "2019-04-26T15:46:04.580Z",
    "disclosureDate": "2019-04-22T00:00:00.000Z",
    "exploitPublishDate": "2019-04-22T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/nmap/npcap/commit/75e5b6b8) commit in the Master branch which is not yet included in any release",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Tyler Price",
    "workaround": "",
    "vendorFixDate": "2019-03-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1285",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-121"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11490",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1285/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nmap/nmap/issues/1568",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nmap/nmap/issues/1568",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/nmap/npcap/commit/75e5b6b8",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1285/default-remediation-status"
            }
        ]
    }
}