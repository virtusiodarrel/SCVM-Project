{
    "source": "BDSA",
    "name": "BDSA-2019-1797",
    "title": "libqb Vulnerable to Arbitrary File Overwrite  Due to Insecure Temporary File Handling",
    "description": "libqb is vulnerable to insecure temporary file handling.  A local attacker could overwrite arbitrary system files by leveraging a race condition with a symlink attack.",
    "technicalDescription": "When creating temporary files in `/dev/shm` and in `/tmp` libqb does not use the `O_EXCL` flag and also uses predictable file names.  This allows an attacker to race the creation of these files, and if the linked application has raised privileges, allows the overwriting of arbitrary system files.",
    "publishedDate": "2019-06-17T15:43:05.715Z",
    "updatedDate": "2019-08-19T16:06:09.414Z",
    "disclosureDate": "2019-03-01T00:00:00.000Z",
    "solution": "Fixed in version [**1.0.4**](https://github.com/ClusterLabs/libqb/releases/tag/v1.0.4) by [this](https://github.com/ClusterLabs/libqb/commit/f950a5d3f8e07aa61bec3da91da01f06e762b138) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.7,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-04-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1797",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-377"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12779",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1797/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ClusterLabs/libqb/commit/7cd7b06d52ac80c343f362c7e39ef75495439dfc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ClusterLabs/libqb/commit/e322e98dc264bc5911d6fe1d371e55ac9f95a71e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ClusterLabs/libqb/commit/f950a5d3f8e07aa61bec3da91da01f06e762b138",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ClusterLabs/libqb/issues/338",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ClusterLabs/libqb/releases/tag/v1.0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1797/default-remediation-status"
            }
        ]
    }
}