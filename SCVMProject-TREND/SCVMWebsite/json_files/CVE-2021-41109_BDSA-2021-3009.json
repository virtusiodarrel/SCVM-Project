{
    "source": "BDSA",
    "name": "BDSA-2021-3009",
    "title": "parse-server Vulnerable to Information Disclosure via 'LiveQuery' Payloads",
    "description": "parse-server contains an information disclosure vulnerability. Successfully exploiting this could allow all session tokens created during user sign-ups to be broadcast as part of a LiveQuery payload.",
    "technicalDescription": "This vulnerability exists due to session tokens not being removed from LiveQuery payloads in the `describe()` function of `spec/ParseLiveQuery.spec.js`. if a user has a LiveQuery subscription on the `Parse.User` class, the all session tokens created during user sign-ups to will broadcast as part of a LiveQuery payload. This can allow an attacker access to user session tokens, which can then be used to launch other attacks. \n\nThe vendor has mitigated against this by ensuring they strip out the `sessionToken` when LiveQuery is used on `Parse.User`.",
    "publishedDate": "2021-10-08T14:19:18.535Z",
    "updatedDate": "2021-10-08T14:19:18.524Z",
    "disclosureDate": "2021-09-30T00:00:00.000Z",
    "solution": "Fixed in version [**4.10.4**](https://github.com/parse-community/parse-server/releases/tag/4.10.4) by [this](https://github.com/parse-community/parse-server/commit/4ac4b7f71002ed4fbedbb901db1f6ed1e9ac5559) commit.\n\nThe latest stable releases are available [here](https://github.com/parse-community/parse-server/tags).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "dblythy",
    "workaround": "The vendor has provided the following [workaround](https://github.com/parse-community/parse-server/security/advisories/GHSA-7pr3-p5fm-8r9x):\n> \n> Set user.acl(new Parse.ACL()) in a beforeSave trigger to make the user private already on sign-up.",
    "vendorFixDate": "2021-09-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3009",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-201"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41109",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3009/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/4ac4b7f71002ed4fbedbb901db1f6ed1e9ac5559",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases/tag/4.10.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/security/advisories/GHSA-7pr3-p5fm-8r9x",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/security/advisories/GHSA-7pr3-p5fm-8r9x",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3009/default-remediation-status"
            }
        ]
    }
}