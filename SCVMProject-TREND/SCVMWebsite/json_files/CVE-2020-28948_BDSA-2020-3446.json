{
    "source": "BDSA",
    "name": "BDSA-2020-3446",
    "title": "Archive_Tar Vulnerable to PHAR Deserialization Attacks via Improper Stream Wrapper Validation",
    "description": "Archive_Tar is vulnerable to PHAR deserialization attacks due to the insufficient validation of archive stream wrappers. An attacker could manipulate files, or potentially execute arbitrary code, on a vulnerable system by using a maliciously crafted PHAR file.",
    "technicalDescription": "The functions `_readHeader()` and `_readLongHeader()`, of file `Archive/Tar.php`, are used by Archive_Tar to extract archives. These functions call `_maliciousFilename()`, which defends against Phar deserialization attacks by detecting the presence of `phar://` within file names. This function also will also detect relative paths in a given filename (specifically, the strings `../` and `..\\\\`), in an attempt to prevent arbitrary file overwrite attacks from occurring. \n\nHowever, the checks performed by `_maliciousFilename()` are insufficiently robust. The check for `phar://` is case sensitive, and can be bypassed by using a wrapper name such as `PHAR://`. An attacker could create a malicious PHAR file in order to conduct an deserialization attack against the target host. This could allow the attacker to modify files, and  potentially execute arbitrary code. It should be noted that a successful code execution attack is highly dependent on the classes implemented by the application, and the attacker's knowledge of those classes.",
    "publishedDate": "2020-11-20T12:43:15.659Z",
    "updatedDate": "2020-11-20T12:43:15.652Z",
    "disclosureDate": "2020-11-17T00:00:00.000Z",
    "exploitPublishDate": "2020-11-17T00:00:00.000Z",
    "solution": "Fixed in [**1.4.11**](https://github.com/pear/Archive_Tar/releases/tag/1.4.11) by [this](https://github.com/pear/Archive_Tar/commit/0670a05fdab997036a3fc3ef113b8f5922e574da) commit.\n\nThe latest stable releases are available [here](https://github.com/pear/Archive_Tar/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-11-19T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3446",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-178"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28948",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3446/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pear/Archive_Tar/commit/0670a05fdab997036a3fc3ef113b8f5922e574da",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pear/Archive_Tar/issues/33",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pear/Archive_Tar/issues/33",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pear/Archive_Tar/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pear/Archive_Tar/releases/tag/1.4.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3446/default-remediation-status"
            }
        ]
    }
}