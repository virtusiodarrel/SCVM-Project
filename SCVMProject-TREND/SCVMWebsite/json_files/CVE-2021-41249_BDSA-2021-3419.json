{
    "source": "BDSA",
    "name": "BDSA-2021-3419",
    "title": "GraphQL Playground Vulnerable to Cross-Site Scripting (XSS) via Specially Crafted Schemas",
    "description": "GraphQL Playground is vulnerable to a cross-site scripting (XSS) flaw when processing specially crafted schemas. A remote attacker able to trick a victim into clicking on a specially crafted link could cause the execution of arbitrary JavaScript code in the victims browser on operation autocomplete. This could be used to steal site based information such as cookies, or perform site actions with the victims credentials.",
    "technicalDescription": "GraphQL Playground does not properly sanitize unsafe HTML in type names. A remote attacker could set up a malicious server that provides a specially crafted introspection result that includes a malicious payload in a type name. When directed to load this malicious content via a specially crafted URL, the payload would be executed in the victims browser on operation autocomplete.\n\ngraphql-playground-react **1.7.0** and newer allow this vulnerability to be exploited via a specially crafted URL through functionality which made it possible to override the endpoint URL via query parameter. Versions prior to **1.7.0** may or may not be vulnerable via separate vectors, depending on the configuration (such as use with an untrusted GraphQL server).\n\nThe issue was resolved by escaping all HTML in supplied text, validating all schemas, and ensuring that user-generated HTML is safe.",
    "publishedDate": "2021-11-16T10:25:08.576Z",
    "updatedDate": "2022-02-15T16:59:43.699Z",
    "disclosureDate": "2021-11-04T00:00:00.000Z",
    "exploitPublishDate": "2021-11-04T00:00:00.000Z",
    "solution": "Fixed in graphql-playground-react version [**1.7.28**](https://github.com/graphql/graphql-playground/releases/tag/graphql-playground-react%401.7.28) by [this](https://github.com/graphql/graphql-playground/commit/b8a956006835992f12c46b90384a79ab82bcadad) commit.\n\nThe latest graphql-playground-react releases can be found [here](https://github.com/graphql/graphql-playground/tags).\n\nFixed in apollo-server-core versions **[2.25.3](https://github.com/apollographql/apollo-server/releases/tag/apollo-server-core%402.25.3)** and **[3.4.1](https://github.com/apollographql/apollo-server/releases/tag/apollo-server-core%403.4.1)** by [this](https://github.com/apollographql/apollo-server/commit/c8a3ea90b1ce167e17fad543346246b7d771a0c7) commit.\n\nThe latest apollo-server-core releases can be found [here](https://github.com/apollographql/apollo-server/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "RyotaK",
    "workaround": "apollo-server users may choose to disable graphql, if it is not required, to work around this issue. The vendor supplies the following guidance:\n> If upgrading Apollo Server or GraphQL Playground is challenging, you can also disable GraphQL Playground.\n>\n> In Apollo Server 3, remove the call to ApolloServerPluginLandingPageGraphQLPlayground from your ApolloServer constructor's plugins array. This will replace GraphQL Playground with a simple splash page. See the landing page plugins docs for details.\n> \n> In Apollo Server 2, add playground: false to your ApolloServer constructor: new ApolloServer({ playground: false }). This will replace GraphQL Playground with an attempt to execute a GraphQL operation, which will likely display an error in the browser.",
    "vendorFixDate": "2021-11-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3419",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41249",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3419/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apollographql/apollo-server/commit/c8a3ea90b1ce167e17fad543346246b7d771a0c7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apollographql/apollo-server/releases/tag/apollo-server-core%402.25.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apollographql/apollo-server/releases/tag/apollo-server-core%403.4.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apollographql/apollo-server/security/advisories/GHSA-qm7x-rc44-rrqw",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apollographql/apollo-server/security/advisories/GHSA-qm7x-rc44-rrqw",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apollographql/apollo-server/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/graphql/graphql-playground/commit/b8a956006835992f12c46b90384a79ab82bcadad",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/graphql/graphql-playground/releases/tag/graphql-playground-react%401.7.28",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/graphql/graphql-playground/security/advisories/GHSA-59r9-6jp6-jcm7",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/graphql/graphql-playground/security/advisories/GHSA-59r9-6jp6-jcm7",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/graphql/graphql-playground/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3419/default-remediation-status"
            }
        ]
    }
}