{
    "source": "BDSA",
    "name": "BDSA-2020-3460",
    "title": "Rclone Vulnerable to Weak Password Generation via 'random.Password' Function",
    "description": "Rclone is vulnerable to weak password generation in the `random.Password` function. This could allow an attacker to learn other users' passwords.",
    "technicalDescription": "This vulnerability exists in the `random.Password` function in the `lib/random/random.go` file of Rclone. This function utilizes `math/rand` as a pseudo random number generator, instead of the more secure `crypto/rand` which is a crypto strong random number generator. The seed for `math/rand` is initialized by `rand.Seed(time.Now().Unix())`, however `time.Now().Unix()` only changes every second, which means any passwords generated will only change every second. This means that the passwords which are generated by `random.Password` are therefore completely based on the unix second that Rclone was started, which means that multiple users could be allocated the same password. This could allow an attacker to learn other users passwords.",
    "publishedDate": "2020-11-20T16:20:12.959Z",
    "updatedDate": "2020-11-20T16:20:12.953Z",
    "disclosureDate": "2020-11-18T00:00:00.000Z",
    "exploitPublishDate": "2020-11-18T00:00:00.000Z",
    "solution": "Fixed in [**1.53.3**](https://github.com/rclone/rclone/releases/tag/v1.53.3) by [this](https://github.com/rclone/rclone/commit/4c215cc81ec6143ae3c64633700cb341ca28df2d) commit and [this](https://github.com/rclone/rclone/commit/c8b11d27e1fe261fdfba6b8910fda69356c9c777) commit. \n\nThe latest available version is available [here](https://rclone.org/downloads/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Victor9",
    "workaround": "",
    "vendorFixDate": "2020-11-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3460",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-261"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28924",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3460/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rclone/rclone/commit/193c30d57038017370594d5bc8ee9bc32580ddf2",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rclone/rclone/commit/4c215cc81ec6143ae3c64633700cb341ca28df2d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rclone/rclone/commit/c8b11d27e1fe261fdfba6b8910fda69356c9c777",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rclone/rclone/issues/4783",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rclone/rclone/issues/4783",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rclone/rclone/releases/tag/v1.53.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://rclone.org/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3460/default-remediation-status"
            }
        ]
    }
}