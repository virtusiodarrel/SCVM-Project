{
    "source": "BDSA",
    "name": "BDSA-2019-3145",
    "title": "handlebars Vulnerable to Remote Code Execution (RCE) via Prototype Pollution with 'helperMissing' and 'blockHelperMissing' Helpers",
    "description": "The handlebars package for Node.js is vulnerable to remote code execution (RCE) due to improper restrictions on object access in templates which can lead to prototype pollution. An attacker could exploit this vulnerability by supplying maliciously crafted input.",
    "technicalDescription": "handlebars allows direct access to the helper calls `helperMissing` and `blockHelperMissing` through templates. These calls can be exploited to access an object's constructor and modify its `__proto__` and `__defineGetter__` properties, which could allow injection and execution of arbitrary code.\n\n**Note**: the vendor [states](https://github.com/wycats/handlebars.js/issues/1563) that the initial fix released in **4.3.0** did not fully address this issue, thus an additional fix was required.",
    "publishedDate": "2019-10-07T10:13:41.305Z",
    "updatedDate": "2020-11-11T15:32:15.940Z",
    "disclosureDate": "2019-09-24T00:00:00.000Z",
    "solution": "Fixed in **[4.3.2](https://www.npmjs.com/package/handlebars/v/4.3.2)** by [this](https://github.com/wycats/handlebars.js/commit/2078c727c627f25d4a149962f05c1e069beb18bc) commit and [this](https://github.com/wycats/handlebars.js/commit/213c0bbe3c4bd83a534d67384e5afa0000347ff6) commit, and **[3.0.8](https://github.com/handlebars-lang/handlebars.js/releases/tag/v3.0.8)** by [this](https://github.com/handlebars-lang/handlebars.js/commit/156061eb7707575293613d7fdf90e2bdaac029ee) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "itszn",
    "workaround": "",
    "vendorFixDate": "2019-09-24T00:00:00.000Z",
    "vendorNotifiedDate": "2019-09-16T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3145",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19919",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3145/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/commit/156061eb7707575293613d7fdf90e2bdaac029ee",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/releases/tag/v3.0.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wycats/handlebars.js/blob/master/release-notes.md#v430---september-24th-2019",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wycats/handlebars.js/commit/2078c727c627f25d4a149962f05c1e069beb18bc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wycats/handlebars.js/commit/213c0bbe3c4bd83a534d67384e5afa0000347ff6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wycats/handlebars.js/issues/1558",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/wycats/handlebars.js/issues/1563",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/advisories/1164",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/handlebars/v/4.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3145/default-remediation-status"
            }
        ]
    }
}