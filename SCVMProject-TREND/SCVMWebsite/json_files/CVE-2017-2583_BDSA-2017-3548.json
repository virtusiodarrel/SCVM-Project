{
    "source": "BDSA",
    "name": "BDSA-2017-3548",
    "title": "Linux Kernel Vulnerable to Privilege Escalation and Denial-of-Service via Crafted Application",
    "description": "Linux Kernel is vulnerable to privilege escalation and denial-of-service (DoS) if built with Kernel-based Virtual Machine (KVM) support.  A local attacker can leverage this flaw to crash the guest VM or escalate their privileges inside the guest.",
    "technicalDescription": "This vulnerability exists in the `arch/x86/kvm/emulate.c` source file. The problem is that loading values into the segment selector (SS) register in long mode could lead to an incorrect segment selector (SS) value error.\n\nOn Intel processors this will lead to a failed `vmentry` due to a discrepancy between the documented behavior and actual behavior. Specifically, the check should only be done for a usable SS but that is not what is happening, even though dmesg splat flags the SS as unusable. Since the SS's type is neither 3 nor 7, this will result in a failed `vmentry`. This flaw can be exploited to crash the VM guest.\n\nOn AMD architecture, `svm.c` gets confused and sets `CPL` to `0` in the `vmcb`. This can be leveraged by an attacker to escalate privileges within the VM's boundary.",
    "publishedDate": "2018-08-29T12:13:39.134Z",
    "updatedDate": "2018-10-03T10:10:18.018Z",
    "disclosureDate": "2017-01-12T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.10.106**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2dd7d7e46d791e8a6f85197510a95acae11dbc5b) commit,\n* [**3.12.70**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f043f20c055e3485fb82e0955a9f94f50cdffe15) commit,\n* [**3.16.41**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=448ec74e72bf4c5952e3d369720a862da99c0895) commit,\n* [**4.4.44**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=816307c80d4ddad5414a05ff5861f063d29cda6f) commit,\n* [**4.9.5**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7718ffcf9a64830bbae148432f625346cde2f2d6) commit, and\n* [**4.10-rc4**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=33ab91103b3415e12457e3104f0e4517ce12d0f3) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Xiaohan Zhang (Huawei Inc.)",
    "workaround": "",
    "vendorFixDate": "2017-01-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2017-3548",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-250"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2017-2583",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2017-3548/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.openwall.com/lists/oss-security/2017/01/19/2",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2dd7d7e46d791e8a6f85197510a95acae11dbc5b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=33ab91103b3415e12457e3104f0e4517ce12d0f3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=448ec74e72bf4c5952e3d369720a862da99c0895",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7718ffcf9a64830bbae148432f625346cde2f2d6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=816307c80d4ddad5414a05ff5861f063d29cda6f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f043f20c055e3485fb82e0955a9f94f50cdffe15",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2017-3548/default-remediation-status"
            }
        ]
    }
}