{
    "source": "BDSA",
    "name": "BDSA-2019-1498",
    "title": "Heimdal Vulnerable to Man-in-the-Middle (MitM) via Improper Verification During Key Exchange",
    "description": "Heimdal is vulnerable to improper verification during PA-PKINIT-KX key exchange, which can allow an attacker to become a man-in-the-middle (MitM), enabling them to sniff traffic.",
    "technicalDescription": "RFC8062 for Anonymity Support for Kerberos documents how a Kerberos client can obtain anonymous credentials, without needing to reveal their identity to Kerberos Key Distribution Center (KDC), this is called anonymous PKINIT. This is done by requesting an anonymous ticket. For successful secure channels to be created, a number of different requirements must be met, including verification within the PA-PKINIT-KX key exchange. \n\nTo prevent an attacker from creating channels to either the client or the KDC, a ticket session key must be derived by both the client and Kerberos Key Distribution Center (KDC) from a KDC contribution key (an encrypted randomly generated key) and the reply key. This ticket session key is added to the returned ticket. The client verifies the ticket session key in the returned ticket by decrypting the KDC contribution key to ensure that the ticket session key is a combination of the KDC contribution key and the reply key. \n\nHowever, Heimdal does not have this verification in place, which results in insecure communication channels being creating, impacting the integrity and security of the information being communicated. An attacker could exploit this due to the missing verification to become a man-in-the-middle and sniff traffic. This affects the client-side only when anonymous PKINIT is used to allow secure communication without authenticating as a specific client. \n\nThis issue was introduced via [this](https://github.com/heimdal/heimdal/commit/a1ef548600c5bb51cf52a9a9ea12676506ede19f) commit when support for anonymous PKINIT was added and was addressed by implementing the correct verification of the ticket session key.",
    "publishedDate": "2019-05-17T09:34:08.934Z",
    "updatedDate": "2019-11-28T10:12:47.007Z",
    "disclosureDate": "2019-05-16T00:00:00.000Z",
    "solution": "Fixed in [**7.6.0**](https://github.com/heimdal/heimdal/releases/tag/heimdal-7.6.0) by [this](https://github.com/heimdal/heimdal/commit/2f7f3d9960aa6ea21358bdf3687cee5149aa35cf) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-05-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1498",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-322"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12098",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1498/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.h5l.org/pipermail/heimdal-announce/2019-May/000009.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/heimdal/heimdal/commit/2f7f3d9960aa6ea21358bdf3687cee5149aa35cf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/heimdal/heimdal/releases/tag/heimdal-7.6.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/heimdal/heimdal/releases/tag/heimdal-7.6.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://tools.ietf.org/html/rfc8062#section-7",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1498/default-remediation-status"
            }
        ]
    }
}