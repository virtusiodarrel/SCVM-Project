{
    "source": "BDSA",
    "name": "BDSA-2021-0492",
    "title": "SaltStack Salt Vulnerable to Server-Side Template Injection (SSTI) via Unsafe Defaults for Jinja Renderer",
    "description": "Salt is vulnerable to server-side template injection (SSTI) due to how user input is mishandled and included in templates.\n\nAn attacker could submit a crafted input in template syntax in order to execute malicious code on the server.",
    "technicalDescription": "Salt is vulnerable to server-side template injection (SSTI) because the Jinja renderer default mode is unsafe and does not sufficiently sanitize user input before its inclusion in templates.\n\nTo remedy this issue, the vendor has enabled the safe mode for the Jinja renderer as default.",
    "publishedDate": "2021-03-01T16:51:36.996Z",
    "updatedDate": "2021-03-01T16:51:36.986Z",
    "disclosureDate": "2021-02-25T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3002.5**](https://github.com/saltstack/salt/releases/tag/v3002.5) by [this](https://github.com/saltstack/salt/commit/837a8d6814a094aa2ff90d8f55bde78466c401ac) commit,\n* [**3001.5**](https://github.com/saltstack/salt/releases/tag/3001.5) by [this](https://github.com/saltstack/salt/commit/a8724dde5250707768c520803b239217c624e66f) commit,\n* [**3000.7**](https://github.com/saltstack/salt/releases/tag/3000.7) by [this](https://github.com/saltstack/salt/commit/71cfd290c831f8999b66c17c0767ed0949bfda3c) commit.\n\nThe latest stable releases are available [here](https://repo.saltproject.io/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "1mperio@Tencent Yunding Security Lab",
    "workaround": "The vendor has supplied patches [here](https://gitlab.com/saltstack/open/salt-patches) for the following versions:\n* 3002.2\n* 3001.4\n* 3000.6\n* 2019.2.8\n* 2019.2.5\n* 2018.3.5\n* 2017.7.8\n* 2016.11.10\n* 2016.11.6\n* 2016.11.5\n* 2016.11.3\n* 2016.3.8\n* 2016.3.6\n* 2016.3.4\n* 2015.8.13\n* 2015.8.10\n\nThe vendor has stated [here](https://saltproject.io/security_announcements/active-saltstack-cve-release-2021-feb-25/) that links to each patch file are available from the `readme.md` file. Due to the regression found, there are more than one file per version to apply.",
    "vendorFixDate": "2021-02-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0492",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-25283",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0492/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/71cfd290c831f8999b66c17c0767ed0949bfda3c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/837a8d6814a094aa2ff90d8f55bde78466c401ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/a8724dde5250707768c520803b239217c624e66f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/3000.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/3001.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/v3002.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/saltstack/open/salt-patches",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://repo.saltproject.io/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://saltproject.io/security_announcements/active-saltstack-cve-release-2021-feb-25/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://saltproject.io/security_announcements/active-saltstack-cve-release-2021-feb-25/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0492/default-remediation-status"
            }
        ]
    }
}