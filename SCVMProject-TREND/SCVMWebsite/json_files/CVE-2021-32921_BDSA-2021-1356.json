{
    "source": "BDSA",
    "name": "BDSA-2021-1356",
    "title": "Prosody Vulnerable to Information Disclosure via Timing Attack",
    "description": "Prosody is vulnerable to timing attacks based on timing differences in comparing certain secret strings. This could allow exposure of any secret string over 40 bytes in length to an attacker, gained by observing the timing difference.",
    "technicalDescription": "This vulnerability exists due to Prosody not using a constant-time algorithm for comparing secret strings over 40 bytes in length. \n\nIt affects the following modules:\n* `mod_auth_internal_plain` (which is disabled by default)\n* `mod_muc` (which is disabled by default)\n* `mod_auth_internal_hashed` (enabled by default but doesn't typically use stings over 40 bytes in length)\n* `mod_dialback` (enabled by default, however the vendor believes a timing attack on this module is not possible).",
    "publishedDate": "2021-05-14T14:59:14.955Z",
    "updatedDate": "2021-05-14T14:59:14.948Z",
    "disclosureDate": "2021-05-12T00:00:00.000Z",
    "solution": "Fixed in [**0.11.9**](https://prosody.im/doc/release/0.11.9) by the following commits:\n* [Commit 1](https://hg.prosody.im/trunk/rev/c98aebe601f9)\n* [Commit 2](https://hg.prosody.im/trunk/rev/13b84682518e)\n* [Commit 3](https://hg.prosody.im/trunk/rev/6f56170ea986)\n\nThe latest stable releases are available [here](https://prosody.im/downloads/source/)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matthew Wild, Marvin Zerulla, Robert Gr\u00f6sser",
    "workaround": "The vendor has suggested the following workarounds:\n* Use `mod_auth_internal_hashed` instead of `mod_auth_internal_plain`.\n* If using `mod_muc` ensure any passwords used are shorter than 40 bytes.\n* Enable and configure `mod_limits` in order to enable rate limits.",
    "vendorFixDate": "2021-05-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1356",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32921",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1356/ranges"
            },
            {
                "rel": "reference",
                "href": "https://hg.prosody.im/trunk/rev/13b84682518e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.prosody.im/trunk/rev/6f56170ea986",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.prosody.im/trunk/rev/c98aebe601f9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://prosody.im/doc/release/0.11.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://prosody.im/downloads/source/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://prosody.im/security/advisory_20210512/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://prosody.im/security/advisory_20210512/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1356/default-remediation-status"
            }
        ]
    }
}