{
    "source": "BDSA",
    "name": "BDSA-2020-2107",
    "title": "Elastic Search Vulnerable to Information Discolsure via Scrolling Search",
    "description": "It was discovered the Elastic Search contains an information disclosure vulnerability via field disclosure. An authenticated privileged attacker could exploit this to gain additional permissions against a restricted index if a user with higher privileges recently ran the same search.",
    "technicalDescription": "The issue occurs due to the index access control being is set to `IndicesAccessControl.ALLOW_NO_INDICES` value when the `RBACEngine` authorizes scroll searches. An attacker could gain additional permissions against a restricted index if they run the same query a user with higher privileges recently ran, due to fields being leaked that should be hidden.\n\nThe issue was addressed by configuring the RBACEngine to set the value for the index access control that was produced during the authorization of the initial search that created the scroll, which is now stored in the scroll context.",
    "publishedDate": "2020-08-20T09:53:12.680Z",
    "updatedDate": "2021-02-17T13:32:51.091Z",
    "disclosureDate": "2020-08-18T00:00:00.000Z",
    "solution": "Fixed in version [**7.9.0**](https://github.com/elastic/elasticsearch/releases/tag/v7.9.0) by [this](https://github.com/elastic/elasticsearch/commit/37a38081ec1bf375ce6d480f147a1fdf04e9538b) commit.\n\nFixed in version [**6.8.12**](https://github.com/elastic/elasticsearch/releases/tag/v6.8.12) by [this](https://github.com/elastic/elasticsearch/commit/8dbcd49dc71f0bb9b78b19a4cfb84af599b9c32e) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:C/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-08-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2107",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-270"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7019",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2107/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.elastic.co/t/elastic-stack-7-9-0-and-6-8-12-security-update/245456",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/commit/37a38081ec1bf375ce6d480f147a1fdf04e9538b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/commit/8dbcd49dc71f0bb9b78b19a4cfb84af599b9c32e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/releases/tag/v6.8.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/elasticsearch/releases/tag/v7.9.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2107/default-remediation-status"
            }
        ]
    }
}