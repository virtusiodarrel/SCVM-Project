{
    "source": "BDSA",
    "name": "BDSA-2021-2725",
    "title": "HashiCorp Consul Vulnerable to Authorization Bypass on Txn.Apply Endpoint",
    "description": "HashiCorp Consul is vulnerable to authorization bypass on the `Txn.Apply` endpoint. Services could register proxies for other services, enabling access to service traffic.",
    "technicalDescription": "Consul uses mTLS for communicating between service proxies. This enabled network traffic between services to be encrypted. Service proxy registrations are authorized using Consul ACL tokens. \n\nUsing an ACL token with `service:write` permissions for any service was allowed to register a proxy for another service it was not authorized to. The proxy could then receive traffic for the target service.  \n\nThis issue was addressed by modifying Consul's authorization logic to correctly enforce ACL token policies.",
    "publishedDate": "2021-09-24T14:00:31.185Z",
    "updatedDate": "2021-12-28T13:13:49.313Z",
    "disclosureDate": "2021-09-01T00:00:00.000Z",
    "solution": "Fixed in:\n* [**1.8.15**](https://github.com/hashicorp/consul/releases/tag/v1.8.15) by [this](https://github.com/hashicorp/consul/commit/747844bad6410091f2c6e961216c0c5fc285a44d)\n* [**1.9.9**](https://github.com/hashicorp/consul/releases/tag/v1.9.9) by [this](https://github.com/hashicorp/consul/commit/37527d9121b3780df1bf608c2091106e66a1cbb6)\n* [**1.10.2**](https://github.com/hashicorp/consul/releases/tag/v1.10.2) by [this](https://github.com/hashicorp/consul/commit/1186e38ac64f6159a2e4a79f320d711e90ea2d24) commit. \n\nFixed in [**API/1.10.0**](https://github.com/hashicorp/consul/releases/tag/api%2Fv1.10.0) by [this](https://github.com/hashicorp/consul/commit/c718de730b08ea58d79d57952d5233b2e629e375) commit.\n\nThe latest stable releases can be found [here](https://github.com/hashicorp/consul/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.9,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Consul engineering team",
    "workaround": "",
    "vendorFixDate": "2021-09-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2725",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-863"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-38698",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2725/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.hashicorp.com/t/hcsec-2021-24-consul-missing-authorization-check-on-txn-apply-endpoint/29026",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/1186e38ac64f6159a2e4a79f320d711e90ea2d24",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/37527d9121b3780df1bf608c2091106e66a1cbb6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/747844bad6410091f2c6e961216c0c5fc285a44d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/commit/c718de730b08ea58d79d57952d5233b2e629e375",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/pull/10798",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/api%2Fv1.10.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.10.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.8.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/consul/releases/tag/v1.9.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2725/default-remediation-status"
            }
        ]
    }
}