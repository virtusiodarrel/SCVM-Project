{
    "source": "BDSA",
    "name": "BDSA-2018-2567",
    "title": "Linux Kernel Vulnerable to Memory Corruption via 'ext4_valid_inum' Function",
    "description": "An out-of-bound write vulnerability has been discovered in Linux Kernel. An attacker could exploit this vulnerability locally or through distribution, by unmounting a crafted image filesystem to cause a denial-of-service (DoS) condition.",
    "technicalDescription": "The function `__ext4_get_inode_loc` located in file `fs/ext4/inode.c` and function `ext4_valid_inum` located in file `fs/ext4/ext4.h` does not have validate if the first inode number is greater than `11`. \n\nA crafted image filesystem can be mounted at a lower than intended inode number. The kernel does not check to determine the pointer is valid and makes it possible to point at the journal inode. If the crafted image file system is unmounted it triggers the unmount process in function `ext4_evict_inode()` which attempts to delete the journal inode, resulting in an application crash. \n\nA privileged user such as root is required to mount a filesystem image. It is not possible for unprivileged users with userspace permissions to preform mount actions.",
    "publishedDate": "2018-08-03T15:13:36.708Z",
    "updatedDate": "2019-02-05T11:40:35.240Z",
    "disclosureDate": "2018-06-14T00:00:00.000Z",
    "exploitPublishDate": "2018-06-14T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.16.58**](https://www.kernel.org)\n* [**3.18.124**](https://www.kernel.org)\n* [**4.4.140**](https://www.kernel.org)\n* [**4.9.112**](https://www.kernel.org)\n* [**4.14.55**](https://www.kernel.org)\n* [**4.17.6**](https://www.kernel.org)\n* [**4.18-rc4**](https://www.kernel.org)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c37e9e013469521d9adb932d17a1795c139b36db) git commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.4,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "MULTIPLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:L/Au:M/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 0.6,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:H/UI:R/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wen Xu",
    "workaround": "",
    "vendorFixDate": "2018-06-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-2567",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2018-10882",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-2567/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.kernel.org/show_bug.cgi?id=200069",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-10882",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/torvalds/linux/commit/c37e9e013469521d9adb932d17a1795c139b36db",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/torvalds/linux/releases/tag/v4.18-rc4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-2567/default-remediation-status"
            }
        ]
    }
}