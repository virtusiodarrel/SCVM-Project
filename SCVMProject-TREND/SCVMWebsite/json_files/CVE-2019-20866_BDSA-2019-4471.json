{
    "source": "BDSA",
    "name": "BDSA-2019-4471",
    "title": "Mattermost Server Vulnerable to Denial-of-Service (DoS) via Improper Validation of Source IP Headers",
    "description": "Mattermost Server is vulnerable to a denial-of-service (DoS) condition due to how the user's source IP headers are handled.\n\nAn attacker could send a large amount of requests to the server, using crafted headers to avoid rate limiting, in order to overwhelm the server's resources and cause a denial-of-service.",
    "technicalDescription": "Mattermost Server is vulnerable to a denial-of-service (DoS) condition because the source IP headers, `X-Forwarded-By` and `X-Real-Ip`, are trusted and used without validation.\n\nIf a reverse proxy is not being used with Mattermost, an attacker could manipulate these headers in order to bypass rate limiting measures. This could allow them to flood the server with requests, impacting it's performance and availability to other users. Attackers could also use this issue to bypass audit logs.\n\nThis issue is not present in configurations where the NGINX proxy sets the headers itself.",
    "publishedDate": "2020-07-09T09:02:45.574Z",
    "updatedDate": "2020-07-09T09:03:29.707Z",
    "disclosureDate": "2019-06-16T00:00:00.000Z",
    "solution": "Fixed in [**5.12.0-rc1**](https://github.com/mattermost/mattermost-server/releases/tag/v5.12.0-rc1) by [this](https://github.com/mattermost/mattermost-server/commit/8b8345a4b110b321df147f26474d5ca33836fc7b) commit.\n\nThe latest stable releases are available [here](https://github.com/mattermost/mattermost-server/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "prefix",
    "workaround": "",
    "vendorFixDate": "2019-06-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4471",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20866",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4471/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.mattermost.com/administration/changelog.html#id134",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/commit/8b8345a4b110b321df147f26474d5ca33836fc7b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/pull/10907",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mattermost/mattermost-server/releases/tag/v5.12.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mattermost.com/security-updates/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4471/default-remediation-status"
            }
        ]
    }
}