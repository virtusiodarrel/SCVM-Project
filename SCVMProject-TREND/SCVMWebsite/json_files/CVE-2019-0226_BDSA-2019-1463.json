{
    "source": "BDSA",
    "name": "BDSA-2019-1463",
    "title": "Apache Karaf Vulnerable to Arbitrary File Write via Improper Input Validation in Config Service",
    "description": "An improper input validation vulnerability has been discovered in Apache Karaf. An attacker could exploit this vulnerability via a crafted filename to execute path traversal techniques and overwrite arbitrary system files outside intended directories.",
    "technicalDescription": "A weakness has been discovered in Apache Karaf which can be manipulated to execute arbitrary file write against the system. The configuration service stores and loads all configuration files located in the `etc` folder.  The `InstallCommand ` function located in the file `config/src/main/java/org/apache/karaf/config/command/InstallCommand.java` and the `getConfigs` function located in the file ` config/src/main/java/org/apache/karaf/config/core/impl/ConfigMBeanImpl.java` does not sanitize user-supplied filenames before proceeding with the configuration. \n\nAn attacker could exploit this vulnerability via a crafted filename containing `..` to execute path traversal techniques, granting navigation through the system file structure and overwrite arbitrary files.",
    "publishedDate": "2019-05-10T10:51:07.293Z",
    "updatedDate": "2021-02-11T16:50:28.235Z",
    "disclosureDate": "2019-05-06T00:00:00.000Z",
    "solution": "Fixed in version [**4.2.5**](https://github.com/apache/karaf/releases/tag/karaf-4.2.5) by [this](https://github.com/apache/karaf/commit/bf5ed62d310f9042f9305dafac9a851464bb27cf) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "\u9a6c\u51cc\u6d9b",
    "workaround": "",
    "vendorFixDate": "2019-04-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1463",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-0226",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1463/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/karaf/commit/bf5ed62d310f9042f9305dafac9a851464bb27cf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/karaf/releases/tag/karaf-4.2.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/1baa6f1df0e95fb1cd679067117354af2ab4423277d9a0ff6e8bf790@%3Cdev.karaf.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1463/default-remediation-status"
            }
        ]
    }
}