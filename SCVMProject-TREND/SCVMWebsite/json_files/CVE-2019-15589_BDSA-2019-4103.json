{
    "source": "BDSA",
    "name": "BDSA-2019-4103",
    "title": "GitLab Vulnerable to Access Control Bypass via Re-Usable CI/CD Token for Git Clone and Pull Operations",
    "description": "GitLab  is vulnerable to an access control bypass.  A remote attacker with previous access to a project can perform git clone and pull operations on projects when they have been blocked.",
    "technicalDescription": "The access control bypass can be performed by a remote attacker if they have access to a project, and then are blocked by an administrative user.  The vulnerability can  be used to bypass the restrictions from the blocked status. This occurs when the attacker is able to create a job runner and capture the valid CI/CD token before being blocked.  \n\nThere is a flaw in the way jobs are handled and the attacker is able to cause the job to run indefinitely, resulting in the token being valid after being blocked.  Once blocked, the attacker is able to use the \"captured\" token to perform git pull and clone operations on projects they once had permissions to do so on.",
    "publishedDate": "2020-01-02T16:15:22.727Z",
    "updatedDate": "2020-01-02T16:15:22.711Z",
    "disclosureDate": "2019-12-13T00:00:00.000Z",
    "exploitPublishDate": "2019-12-13T00:00:00.000Z",
    "solution": "Fixed in version [**12.3.2**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.3.2) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/d00f028aac0f8ddeef7007173b8ac69c5d74c4a2) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.8
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.2,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 1.6,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "logan5",
    "workaround": "",
    "vendorFixDate": "2019-08-26T00:00:00.000Z",
    "vendorNotifiedDate": "2019-02-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4103",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-923"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15589",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4103/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/blog/2019/09/30/security-release-gitlab-12-dot-3-dot-2-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/d00f028aac0f8ddeef7007173b8ac69c5d74c4a2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/497047",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4103/default-remediation-status"
            }
        ]
    }
}