{
    "source": "BDSA",
    "name": "BDSA-2020-2629",
    "title": "Apache NiFi Vulnerable to XML External Entities (XXE) via Unvalidated XML Files",
    "description": "Apache NiFi contains an XML external entities (XXE) vulnerability which allows an attacker to upload a malicious XML file capable of making external calls to other services.",
    "technicalDescription": "This vulnerability exists in multiple files which are relevant for XML file handling. Uploaded XML files are not validated properly before being parsed by the server. This could allow an attacker to upload a malicious XML file to the server. If an administrator interacts with this file for configuration, it will lead to the malicious code being parsed and executed on the server. This can lead to external calls being made by the malicious file, thus leading to an XXE attack.",
    "publishedDate": "2020-10-05T16:11:27.618Z",
    "updatedDate": "2022-04-19T10:15:37.201Z",
    "disclosureDate": "2020-08-18T00:00:00.000Z",
    "solution": "Fixed in [**1.12.0-RC1**](https://github.com/apache/nifi/releases/tag/nifi-1.12.0-RC1) by [this](https://github.com/apache/nifi/commit/7f0416ee8bdcee95e28409cc6fae9c1394c2a798) commit.\n\nThe latest stable releases are available [here](https://github.com/apache/nifi/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matt Burgess and Andy LoPresto",
    "workaround": "",
    "vendorFixDate": "2020-07-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2629",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-611"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13940",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2629/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/nifi/commit/7f0416ee8bdcee95e28409cc6fae9c1394c2a798",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/nifi/pull/4436",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/nifi/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/nifi/releases/tag/nifi-1.12.0-RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/NIFI-7680",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://nifi.apache.org/security#CVE-2020-13940",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2629/default-remediation-status"
            }
        ]
    }
}