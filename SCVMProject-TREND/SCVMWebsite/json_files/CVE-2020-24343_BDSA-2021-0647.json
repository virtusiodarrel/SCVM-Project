{
    "source": "BDSA",
    "name": "BDSA-2021-0647",
    "title": "Artifex MuJS Vulnerable to Denial-of-Service (DoS) via Use-After-Free in jsrun.c",
    "description": "Artifex MuJS is vulnerable to denial-of-service (DoS) via a use-after-free in `jsrun.c`.",
    "technicalDescription": "When scanning an iterator object, the iterated object was marked unconditionally. It should instead have been marked only if it wasn't already marked. This flaw was present in the codebase for several years but did not expose the application to a use-after-free until commit 331c5ec. As of this commit, marking an object means inserting it into a linked lists where the nodes of the list are part of the object and therefore marking the same object twice creates a broken linked list. This broken list means that some objects are skipped while scanned, meaning that they aren't marked even when they should be and as a result freed incorrectly while still referenced by other objects. \n\n**Note**: this vulnerability was introduced by [this](https://github.com/ccxvii/mujs/commit/331c5ecbaca705eb8c899e814afe94971b14207b) commit, after the release of **1.0.7** and prior to the release of **1.0.8**. Only snapshots of the [master  branch](https://github.com/libarchive/libarchive) from **2020-05-27** to **2020-07-06** are vulnerable.",
    "publishedDate": "2021-03-18T14:36:10.561Z",
    "updatedDate": "2021-03-18T14:36:10.555Z",
    "disclosureDate": "2020-06-28T00:00:00.000Z",
    "exploitPublishDate": "2020-06-28T00:00:00.000Z",
    "solution": "Fixed in [**1.0.8**](https://github.com/ccxvii/mujs/releases/tag/1.0.8) by [this](https://github.com/ccxvii/mujs/commit/ed33bc01d5f4e9a736830d706371163ab2db8e5a) commit.\n\nThe latest stable releases are available [here](https://mujs.com/download.html).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Changochen",
    "workaround": "",
    "vendorFixDate": "2020-05-27T00:00:00.000Z",
    "vendorNotifiedDate": "2020-06-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0647",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-24343",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0647/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ccxvii/mujs/commit/331c5ecbaca705eb8c899e814afe94971b14207b",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ccxvii/mujs/commit/ed33bc01d5f4e9a736830d706371163ab2db8e5a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ccxvii/mujs/issues/136",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ccxvii/mujs/issues/136",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ccxvii/mujs/releases/tag/1.0.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mujs.com/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0647/default-remediation-status"
            }
        ]
    }
}