{
    "source": "BDSA",
    "name": "BDSA-2020-4101",
    "title": "ProjectSend Vulnerable to Unauthorized Password Resets via Mishandled 'user_data'",
    "description": "ProjectSend is vulnerable to an unauthorized password reset issue due to how the password reset component mishandles the `user_data` value.\n\nAn attacker could use this issue to change the password of a known user without having a valid token.",
    "technicalDescription": "ProjectSend is vulnerable to unauthorized password resets because the `user_data` value in the `reset-password.php` file is not cleaned after being used. This variable is used to process password reset requests. The flaw means that the data contained in this variable can be used maliciously and use the `new_password` form to reset passwords without a valid token.\n\nAn attacker could submit a crafted POST request containing the following information:\n* an invalid `token` parameter,\n* a target username in the `user` parameter,\n* a `form_type` parameter set to `new_password`,\n* the desired password in the `password` parameter, and \n* a valid `csrf_token` obtained elsewhere obtained from the login form.",
    "publishedDate": "2021-01-22T12:42:13.506Z",
    "updatedDate": "2021-01-29T12:26:11.349Z",
    "disclosureDate": "2020-11-19T00:00:00.000Z",
    "exploitPublishDate": "2021-01-21T00:00:00.000Z",
    "solution": "Fixed in [**r1295**](https://github.com/projectsend/projectsend/releases/tag/r1295) by [this](https://github.com/projectsend/projectsend/commit/440204734e9a1687cb9887e1c887173d23c5a93e) commit.\n\nThe latest stable releases are available [here](https://github.com/projectsend/projectsend/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "varandinawer",
    "workaround": "",
    "vendorFixDate": "2020-11-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4101",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-840"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28874",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4101/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectsend/projectsend/commit/440204734e9a1687cb9887e1c887173d23c5a93e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectsend/projectsend/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/projectsend/projectsend/releases/tag/r1295",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/varandinawer/CVE-2020-28874",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/varandinawer/CVE-2020-28874",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4101/default-remediation-status"
            }
        ]
    }
}