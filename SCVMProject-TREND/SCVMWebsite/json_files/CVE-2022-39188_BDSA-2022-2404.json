{
    "source": "BDSA",
    "name": "BDSA-2022-2404",
    "title": "Linux Kernel Vulnerable to Memory Corruption via Use After Free in 'unmap_mapping_range' Function",
    "description": "The Linux kernel is vulnerable to memory corruption due to an exposed race condition in the function `unmap_mapping_range()` which can lead to a use after free and potentially privilege escalation. An attacker could exploit this vulnerability by supplying a system with crafted operations through a malicious device driver.",
    "technicalDescription": "The issue exists due to flaws in the TLB handling code that is found within the file `include/asm-generic/tlb.h`. These flaws can lead to a race condition, whereby the concurrent execution of `unmap_mapping_range()` and `munmap()` can cause pages that contain stale TLB entries to be freed. This could potentially allow malicious userspace code to access sensitive kernel data structures in memory and achieve privilege escalation.\n\nIt should be noted that only `VM_PFNMAP` page mappings are affected.",
    "publishedDate": "2022-08-31T15:30:45.015Z",
    "updatedDate": "2022-09-14T10:38:35.343Z",
    "disclosureDate": "2022-08-29T00:00:00.000Z",
    "solution": "Fixed in version [**5.19-rc8**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b67fbebd4cf980aecbcc750e1462128bffe8ae15) commit.\n\nThe latest stable releases are available [here](https://www.kernel.org).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Jann Horn (Google Security Research)",
    "workaround": "",
    "vendorFixDate": "2022-07-21T00:00:00.000Z",
    "vendorNotifiedDate": "2022-07-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2404",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-39188",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2404/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=2329&q=unmap_mapping_range&can=1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.19",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b67fbebd4cf980aecbcc750e1462128bffe8ae15",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2404/default-remediation-status"
            }
        ]
    }
}