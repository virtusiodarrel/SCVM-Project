{
    "source": "BDSA",
    "name": "BDSA-2019-4227",
    "title": "GitLab Vulnerable to Authorization Bypass via Incorrect Access Control of Blocked User Accounts",
    "description": "GitLab contains an authorization bypass vulnerability due to incorrect access control on privileged functionality for a blocked user account when the Mattermost service is enabled. An attacker could exploit this vulnerability to access issue and deployment commands of a project they no longer have access to.",
    "technicalDescription": "Due to insufficient authorization checks in `app/models/project_services/slash_commands_service.rb` it is possible for an attacker with a blocked user account to continue to use Mattermost slash commands on repositories they previously had access to. Therefore an attacker would be able to access data they should no longer be able to see or interact with.",
    "publishedDate": "2020-01-31T16:04:37.893Z",
    "updatedDate": "2020-01-31T16:04:37.881Z",
    "disclosureDate": "2019-07-29T00:00:00.000Z",
    "exploitPublishDate": "2019-09-03T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**11.11.6**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.11.6) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/1a0528f4d2d0f21c4bf493cba375c37aa8dcc64f) commit,\n* [**12.0.4**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.0.4) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/51e607156c0a7676ffac8a647077b0934d946123) commit,\n* [**12.1.2**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.1.2) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/b7ef342812e36be62ae1ed3ba3a1d3b5774224e8) commit,\n* [**12.2.0-rc31**](https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.2.0-rc31) by [this](https://gitlab.com/gitlab-org/gitlab-foss/commit/7b52cff4896c8f681aea34fb273209400cf3e06e) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "logan5",
    "workaround": "A workround is to remove the blocked user from the team in Mattermost.",
    "vendorFixDate": "2019-07-04T00:00:00.000Z",
    "vendorNotifiedDate": "2019-02-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4227",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5468",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4227/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/releases/2019/07/29/security-release-gitlab-12-dot-1-dot-2-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v11.11.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.1.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/-/tags/v12.2.0-rc31",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/1a0528f4d2d0f21c4bf493cba375c37aa8dcc64f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/51e607156c0a7676ffac8a647077b0934d946123",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/7b52cff4896c8f681aea34fb273209400cf3e06e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/commit/b7ef342812e36be62ae1ed3ba3a1d3b5774224e8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/issues/57556",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-foss/issues/57556",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4227/default-remediation-status"
            }
        ]
    }
}