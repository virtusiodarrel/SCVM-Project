{
    "source": "BDSA",
    "name": "BDSA-2021-3474",
    "title": "BusyBox Vulnerable to Remote Code Execution (RCE) and Denial-of-Service (DoS) via Pointer Free in 'hush' Function",
    "description": "BusyBox contains an attacker-controlled pointer free vulnerability. An attacker could exploit this by supplying a command line to `hush` that contains the special character `&` in order to achieve remote code execution (RCE) or to cause a denial-of-service (DoS) condition.",
    "technicalDescription": "This vulnerability exists due to the mishandling of the special character `&` in `shell/hush.c`. This can cause the application to be tricked into thinking the entire chain of commands supplied are NULL rather than just the last command being NULL.\n\nThe vendor has mitigated against this by including additional checks to ensure the application is not tricked by last command being null.",
    "publishedDate": "2021-11-17T11:34:01.168Z",
    "updatedDate": "2022-08-05T10:12:45.862Z",
    "disclosureDate": "2021-11-09T00:00:00.000Z",
    "solution": "Fixed in [**1.34.0**](https://git.busybox.net/busybox/tag/?h=1_34_0) by [this](https://git.busybox.net/busybox/commit/?id=83a4967e50422867f340328d404994553e56b839) commit.\n\nThe latest stable releases can be found [here](https://busybox.net/downloads/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Vera Mens, Uri Katz, Tal Keren, Sharon Brizinov from Claroty Research Shachar Menashe from JFrog",
    "workaround": "If it is not possible to upgrade BusyBox earlier versions can be compiled without the vulnerable applet as a workaround.\n\nAfter running `make defconfig` in BusyBox\u2019s source directory (or if reusing a previous configuration), edit the `.config` file as such:\n\n`hush` \u2013 Comment out `CONFIG_HUSH=y`",
    "vendorFixDate": "2021-06-15T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3474",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-822"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-42377",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3474/ranges"
            },
            {
                "rel": "reference",
                "href": "https://busybox.net/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.busybox.net/busybox/commit/?id=83a4967e50422867f340328d404994553e56b839",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.busybox.net/busybox/tag/?h=1_34_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jfrog.com/blog/unboxing-busybox-14-new-vulnerabilities-uncovered-by-claroty-and-jfrog/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://jfrog.com/blog/unboxing-busybox-14-new-vulnerabilities-uncovered-by-claroty-and-jfrog/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3474/default-remediation-status"
            }
        ]
    }
}