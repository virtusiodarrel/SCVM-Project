{
    "source": "BDSA",
    "name": "BDSA-2021-0491",
    "title": "WPA Supplicant Vulnerable to Denial-of-Service (DoS) via Use-After-Free in Provision Discovery Request Handling",
    "description": "WPA Supplicant is vulnerable to denial-of-service (DoS) due to the improper management of system memory resources. An adjacent attacker could cause the application to crash by causing it to process maliciously crafted Provision Discovery (PD) request frames.\n\nIt should be noted that the `CONFIG_P2P` build option must have been enabled for a host to vulnerable.",
    "technicalDescription": "The function `p2p_add_device()`, of file `p2p.c`, adds new peer devices to the peer table. If there is insufficient space in the table to add a new peer, the oldest peer in the table can be removed. Any pointers to the peer device object (stored in the `dev` variable) would point to freed memory as a result of this. If an invalid PD request frame is being processed, the application may attempt to dereference the pointer to the freed device object. This use-after-free could cause the application to crash. An attacker within radio range of a vulnerable host could therefore cause a denial-of-service (DoS) by sending maliciously crafted PD request frames to that host. \n\nIt should be noted that the `CONFIG_P2P` build option must have been enabled for a host to vulnerable.",
    "publishedDate": "2021-03-01T15:19:21.747Z",
    "updatedDate": "2022-02-14T16:26:16.656Z",
    "disclosureDate": "2021-02-25T00:00:00.000Z",
    "solution": "Fixed in version [**2.10**](https://w1.fi/cgit/hostap/tag/?h=hostap_2_10) by [this](https://w1.fi/cgit/hostap/commit/?id=8460e3230988ef2ec13ce6b69b687e941f6cdb32) commit.\n\nThe latest stable releases are available [here](https://w1.fi/cgit/hostap/refs/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.5,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.4
        },
        "vector": "(AV:A/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated that the following workarounds can be used:\n> * Disable P2P (control interface command `P2P_SET disabled 1` or `p2p_disabled=1` in (each, if multiple interfaces used) wpa_supplicant configuration file).\n> * Disable P2P from the build (remove `CONFIG_P2P=y`).",
    "vendorFixDate": "2021-02-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-0491",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-27803",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-0491/ranges"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=17bef1e97a5061a8b5443dc24166e28439911f0b",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/commit/?id=8460e3230988ef2ec13ce6b69b687e941f6cdb32",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/refs/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/cgit/hostap/tag/?h=hostap_2_10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/security/2021-1/wpa_supplicant-p2p-provision-discovery-processing-vulnerability.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://w1.fi/security/2021-1/wpa_supplicant-p2p-provision-discovery-processing-vulnerability.txt",
                "label": "WORKAROUND"
            }
        ]
    }
}