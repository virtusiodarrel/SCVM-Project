{
    "source": "BDSA",
    "name": "BDSA-2021-3631",
    "title": "Eclipse Mosquitto Vulnerable to Denial-of-Service (DoS) via User Properties in CONNECT packets",
    "description": "Eclipse Mosquitto is vulnerable to denial-of-service (DoS) due to an excessive CPU usage that can be triggered by crafted CONNECT packets containing lots of user properties. Due to the way the properties are stored, checking for the uniqueness of them in CONNECT packets takes a quadratic time which could be abused by MQTT v5 clients to consume high amounts of computing power.",
    "technicalDescription": "",
    "publishedDate": "2021-12-03T11:51:02.531Z",
    "updatedDate": "2021-12-03T11:51:02.517Z",
    "disclosureDate": "2021-12-01T00:00:00.000Z",
    "solution": "Fixed in **[2.0.12](https://github.com/eclipse/mosquitto/releases/tag/v2.0.12)** by [this](https://github.com/eclipse/mosquitto/commit/9d6a73f9) commit.\n\nThe latest stable releases can be found [here](https://mosquitto.org/download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Zhanxiang Song, Bin Yuan, DeQing Zou, Hai Jin, Luyi Xing, Yan Jia",
    "workaround": "",
    "vendorFixDate": "2021-08-26T00:00:00.000Z",
    "vendorNotifiedDate": "2021-08-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-3631",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-41039",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-3631/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.eclipse.org/bugs/show_bug.cgi?id=575314",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/mosquitto/commit/9d6a73f9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/mosquitto/releases/tag/v2.0.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mosquitto.org/download/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}