{
    "source": "BDSA",
    "name": "BDSA-2019-2613",
    "title": "Squid Vulnerable to Denial-of-service (DoS) via Incorrect String Termination in 'cachemgr.cgi'",
    "description": "Squid is vulnerable to a denial-of-service (DoS) due to the `cachemgr.cgi` binary failing to properly deal with improperly terminated strings. This could allow an attacker to access unallocated memory or cause a DoS.",
    "technicalDescription": "In Squid, `decode_pub_auth()`  expects `base64_decode_update()` to NULL terminate its output. If the output of `base64_decode_update()` is not properly NULL terminated, the `strtok()` call in:\n\n```\n base64_decode_update(&ctx, &decodedLen, buf, ...)\n\n    /* parse ( a lot of memory leaks, but that is cachemgr style :) */\n    host_name = strtok(buf, \"|\");\n```\n\ncan allow an attacker to access memory outside the intended area.\n\nIf the system on which Squid is running has memory protections enabled, this can result in the cachemgr process crashing, if memory protections are not enabled on the system then this may allow an attacker to access unallocated memory.",
    "publishedDate": "2019-08-16T13:24:35.517Z",
    "updatedDate": "2019-08-16T13:24:35.508Z",
    "disclosureDate": "2019-04-10T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/squid-cache/squid/commit/90661806096099e901ea4197a1b8b41ecab33975) commit which has not yet been included in a major release.\n\nFixed in binary versions:\n\n* [**4.8**](http://www.squid-cache.org/Versions/v4/).\n* [**5.0**](http://www.squid-cache.org/Versions/v5/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alex Rousskov",
    "workaround": "According to the vendor:\nEither;\n\n Convert to exclusively using the HTTP manager interface until\n cachemgr.cgi can be upgraded to a fixed build.\n\nOr;\n\n Deny all access with 'manager' ACL in squid.conf.\n\n This completely removes the vulnerability at cost of reduced\n management and monitoring capabilities.",
    "vendorFixDate": "2019-05-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2613",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-170"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12854",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2613/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Advisories/SQUID-2019_1.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v4/changesets/squid-4-2981a957716c61ff7e21eee1d7d6eb5a237e466d.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v5/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/commit/90661806096099e901ea4197a1b8b41ecab33975",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2613/default-remediation-status"
            }
        ]
    }
}