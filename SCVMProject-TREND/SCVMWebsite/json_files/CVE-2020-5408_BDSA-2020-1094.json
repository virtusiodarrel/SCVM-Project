{
    "source": "BDSA",
    "name": "BDSA-2020-1094",
    "title": "Spring Security Vulnerable to Information Exposure via Insecure Text Encryptor",
    "description": "Spring Security is vulnerable to information exposure due to an insecure cryptographic mechanism in the queryable text encryptor. This could be leveraged by an attacker to derive sensitive information from encrypted text using dictionary attacks.",
    "technicalDescription": "The issue exists with the function `queryableText()` in the file `crypto/src/main/java/org/springframework/security/crypto/encrypt/Encryptors.java`. The function insecurely uses a fixed null initialization vector with CBC mode in this text encryptor. This could allow an attacker who can obtain access to affected data to defeat the encryption using dictionary attacks.\n\nThe vendor addresses this issue by deprecating the function, and advises that users should look to their data store for a secure mechanism to query encrypted data.",
    "publishedDate": "2020-05-13T14:57:58.173Z",
    "updatedDate": "2020-05-13T14:57:58.169Z",
    "disclosureDate": "2020-05-07T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/spring-projects/spring-security/commit/db155b30941536e6c33408a20f62e790b2c78a97) commit in:\n* **[5.3.2](https://github.com/spring-projects/spring-security/releases/tag/5.3.2.RELEASE)**\n* **[5.2.4](https://github.com/spring-projects/spring-security/releases/tag/5.2.4.RELEASE)**\n* **[5.1.10](https://github.com/spring-projects/spring-security/releases/tag/5.1.10.RELEASE)**\n* **[5.0.16](https://github.com/spring-projects/spring-security/releases/tag/5.0.16.RELEASE)**\n* **[4.2.16](https://github.com/spring-projects/spring-security/releases/tag/4.2.16.RELEASE)**",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Neil Madden(ForgeRock)",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, users should discontinue use of the function `Encryptors#queryableText(CharSequence, CharSequence)` and look to their data store for a secure mechanism to query encrypted data.",
    "vendorFixDate": "2020-04-30T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1094",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-329"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-5408",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1094/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/commit/db155b30941536e6c33408a20f62e790b2c78a97",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/4.2.16.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.0.16.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.1.10.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.2.4.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/spring-projects/spring-security/releases/tag/5.3.2.RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://tanzu.vmware.com/security/cve-2020-5408",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1094/default-remediation-status"
            }
        ]
    }
}