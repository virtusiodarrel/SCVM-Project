{
    "source": "BDSA",
    "name": "BDSA-2019-2910",
    "title": "Linux Kernel for PowerPC Vulnerable to Information Exposure via Error in Transaction Memory Handling",
    "description": "The Linux Kernel for PowerPC has an error in its transactional memory handling which allows any user to read the FP/VMX registers of a process owned by a different user. Users can also experience corruption of their FP/VMX state. \n\nThis bug is present on all machines were transactional memory is present. This includes all POWER8 variants and POWER9 VMS under KVM or LPARs under POWERVM. POWER9 bare metal doesn't support transactional memory and therefore isn't affected.",
    "technicalDescription": "To trigger the bug, a process starts a transaction with FP/VMX set to 0 and then accepts an interrupt. When the kernel returns to that process FP is changed to 1 but the hardware checkpoint FP state is not updated. If that transaction is rolled back then the FP registers will contain the wrong state.  When returning from a hardware interrupt, the `tmp_active_with_fp` function is incorrectly making `restore_fp` call `load_fp_state` which is setting FP to 1 but with the hardware checkpoint not updated. \n\nFP/VMX availability is controlled by the Kernel and is transparent to the user, meaning that the user must retry the transaction many times to trigger the bug. Large numbers of interrupts can also help trigger the bug. \n\nThis flaw results in corruption of the floating point/VMX registers and allows data in floating point/VMX registers to be leaked from one process to another.",
    "publishedDate": "2019-09-11T14:31:05.687Z",
    "updatedDate": "2019-09-20T09:06:31.750Z",
    "disclosureDate": "2019-09-10T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.19.73**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=569775bd536416ed9049aa580d9f89a0b4307d60) commit\n* [**5.2.15**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=398f2c8277f2de2299fb92e38d9982afc780329b) commit\n* [**5.3-rc8**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a8318c13e79badb92bc6640704a64cc022a6eb97) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Michael Neuling",
    "workaround": "",
    "vendorFixDate": "2019-09-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2910",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15031",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2910/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=a8318c13e79badb92bc6640704a64cc022a6eb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q3/210",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2910/default-remediation-status"
            }
        ]
    }
}