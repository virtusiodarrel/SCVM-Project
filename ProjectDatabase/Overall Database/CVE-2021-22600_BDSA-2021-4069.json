{
    "source": "BDSA",
    "name": "BDSA-2021-4069",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via Double Free in 'packet_set_ring' Function",
    "description": "The Linux kernel is vulnerable to privilege escalation due to the improper management of dynamically-allocated memory resources. A local attacker could potentially elevate their privileges to those of the root user by running a maliciously crafted binary. It may also be possible for an attacker to cause the system to crash.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "The function `packet_set_ring()`, of file `net/packet/af_packet.c`, is invoked by the Linux kernel whenever ring versions are being switched for a packet socket. This function will execute `bitmap_free(rx_owner_map)` in order to free the `rx_owner_map` bitmap. However, this bitmap will only have been allocated if the `pg_vec` buffer has been allocated. The function fails to ensure that this is the case. If `rx_owner_map` does not contain a valid pointer value, then an illegal free event will occur. This could cause the kernel's memory to become corrupted. This could potentially be leveraged by an attacker in order to cause a denial-of-service (DoS) via a system crash. It may also be possible for an attacker to leverage this vulnerability for privilege escalation purposes, however such an attack has not been demonstrated.",
    "publishedDate": "2022-01-27T16:42:02.882Z",
    "updatedDate": "2022-04-12T08:46:47.339Z",
    "disclosureDate": "2021-12-15T00:00:00.000Z",
    "exploitPublishDate": "2021-12-12T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.14.259**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a829ff7c8ec494eca028824628a964cde543dc76) commit\n* [**4.19.222**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=18c73170de6719491f79b04c727ea8314c246b03) commit\n* [**5.4.168**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=027a13973dadb64ef4f19db56c9b619ee82c3375) commit\n* [**5.10.88**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7da349f07e457cad135df0920a3f670e423fb5e9) commit\n* [**5.15.11**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=feb116a0ecc5625d6532c616d9a10ef4ef81514b) commit\n* [**5.16-rc6**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ec6af094ea28f0f2dda1a6a33b14cd57e36a9755) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-12-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-4069",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-415"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-22600",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-4069/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=027a13973dadb64ef4f19db56c9b619ee82c3375",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=18c73170de6719491f79b04c727ea8314c246b03",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7da349f07e457cad135df0920a3f670e423fb5e9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a829ff7c8ec494eca028824628a964cde543dc76",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=ec6af094ea28f0f2dda1a6a33b14cd57e36a9755",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=feb116a0ecc5625d6532c616d9a10ef4ef81514b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit?id=ec6af094ea28f0f2dda1a6a33b14cd57e36a9755",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://syzkaller.appspot.com/bug?id=b32fa08468c9e84e361296e1bc502283ea202ec6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://syzkaller.appspot.com/bug?id=b32fa08468c9e84e361296e1bc502283ea202ec6",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}