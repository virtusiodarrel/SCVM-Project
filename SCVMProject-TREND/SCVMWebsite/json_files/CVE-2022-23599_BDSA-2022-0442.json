{
    "source": "BDSA",
    "name": "BDSA-2022-0442",
    "title": "Plone CMS Vulnerable to Reflected Cross-Site Scripting (XSS) and Open Redirects via 'image_view_fullscreen' Cache Poisoning",
    "description": "Plone CMS is vulnerable to reflected cross-site scripting (XSS) and open redirect issues due to how the `image_view_fullscreen` page unsafely reflects user controlled input.\n\nAn attacker could perform a cache poisoning attack in order to place a compromised version of the `image_view_fullscreen` page in a cache, such as Varnish, in order to execute malicious scripts in the context of a victim user's browser or redirect victims to other potentially malicious sites.\n\n**Note**: The vendor has stated [here](https://community.plone.org/t/security-fix-for-image-view-fullscreen-cache-poisoning/14757?u=mauritsvanrees) that this issue should usually affect anonymous users only, however, this depends on the current cache settings.",
    "technicalDescription": "Plone content management system (CMS) is vulnerable to reflected cross-site scripting (XSS) and open redirect issues because the `image_view_fullsceen` page is susceptible to cache poisoning due to how the `Referer` header is echoed in the page body. This issue affects three packages:\n* **Products.CMFPlone**,\n* **Products.ATContentTypes**, and\n* **plone.app.contenttypes**.\n\n**Note**: No patch is available for the **Products.CMFPlone** package **4.x** series. Versions **5.0** and higher are not affected, however, the two other packages used by these versions are affected. Fixes for these packages have been detailed in the **Solution**.",
    "publishedDate": "2022-02-14T16:24:45.566Z",
    "updatedDate": "2022-02-14T16:24:45.544Z",
    "disclosureDate": "2022-01-28T00:00:00.000Z",
    "solution": "Fixed packages are included in Plone versions [**6.0.0a3**](https://plone.org/download/releases/6.0.0a3) and [**5.2.7**](https://plone.org/download/releases/5.2.7).\n\nThe vulnerable package fixes are as follows:\n* **Products.ATContentTypes** package version [**3.0.6**](https://github.com/plone/Products.ATContentTypes/releases/tag/3.0.6) was fixed by [this](https://github.com/plone/Products.ATContentTypes/commit/fc793f88f35a15a68b52e4abed77af0da5fdbab8) commit,\n* **plone.app.contenttypes** package version [**3.0.0a9**](https://github.com/plone/plone.app.contenttypes/releases/tag/3.0.0a9) was fixed by [this](https://github.com/plone/plone.app.contenttypes/commit/bd5e12f6109510738c2c07305417c5c244979787) commit,\n* **plone.app.contenttypes** package version [**2.2.3**](https://github.com/plone/plone.app.contenttypes/releases/tag/2.2.3) was fixed by [this](https://github.com/plone/plone.app.contenttypes/commit/4cb0916315b9b9497841342c42e1f3c2bd50066e) commit.\n\nThe latest stable releases of Plone are available [here](https://plone.org/download/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Gustav Hansen (F-Secure Consulting)",
    "workaround": "The vendor has stated [here](https://community.plone.org/t/security-fix-for-image-view-fullscreen-cache-poisoning/14757?u=mauritsvanrees) that for all affected Plone versions, with or without a fixed package, the following workaround is available:\n\n> Make sure the `image_view_fullscreen` page is not stored in the cache. In Plone:\n> * Login as Manager and go to Site Setup.\n> * Go to the `Caching` control panel. If this does not exist, or `Enable caching` is not checked, you should normally not be vulnerable.\n> * Click on the tab `Caching operations`.\n> * Under `Legacy template mappings` locate the ruleset `Content item view`.\n> * From the last column (`Templates`) remove `image_view_fullscreen`.\n> * Click on Save.",
    "vendorFixDate": "2022-01-21T00:00:00.000Z",
    "vendorNotifiedDate": "2022-01-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0442",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-601"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23599",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0442/ranges"
            },
            {
                "rel": "reference",
                "href": "https://community.plone.org/t/security-fix-for-image-view-fullscreen-cache-poisoning/14757?u=mauritsvanrees",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://community.plone.org/t/security-fix-for-image-view-fullscreen-cache-poisoning/14757?u=mauritsvanrees",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plone/Products.ATContentTypes/commit/fc793f88f35a15a68b52e4abed77af0da5fdbab8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plone/Products.ATContentTypes/releases/tag/3.0.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plone/Products.ATContentTypes/security/advisories/GHSA-g4c2-ghfg-g5rh",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plone/Products.CMFPlone/security/advisories/GHSA-8w54-22w9-3g8f",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plone/plone.app.contenttypes/commit/4cb0916315b9b9497841342c42e1f3c2bd50066e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plone/plone.app.contenttypes/commit/bd5e12f6109510738c2c07305417c5c244979787",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plone/plone.app.contenttypes/releases/tag/2.2.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plone/plone.app.contenttypes/releases/tag/3.0.0a9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/plone/plone.app.contenttypes/security/advisories/GHSA-f7qw-5fgj-247x",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://plone.org/download/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://plone.org/download/releases/5.2.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://plone.org/download/releases/6.0.0a3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://plone.org/news/2022/plone-6-0-0a3-and-5-2-7-released",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://plone.org/security/hotfix/20220128",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0442/default-remediation-status"
            }
        ]
    }
}