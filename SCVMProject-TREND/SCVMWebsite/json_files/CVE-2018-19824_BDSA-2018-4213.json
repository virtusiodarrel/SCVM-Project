{
    "source": "BDSA",
    "name": "BDSA-2018-4213",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) via Use-after-free in ALSA Driver",
    "description": "The Linux kernel is vulnerable to denial-of-service (DoS) due to an error in handling of USB sound cards by the ALSA driver. An operation is attempted on the memory object of the card after it has been freed. Attaching a USB sound card that reports no live interfaces will lead to a use-after-free (UAF) and a crash.",
    "technicalDescription": "This flaw lies in the `usb_audio_probe()` function of the `/sound/usb/card.c` source file. The function attempts to decrement the number of active chips in the `atomic_dec(&chip->active)` operation after the corresponding memory object of the card is freed. `chip->active` resides within the `chip->card` object so when `snd_card_free(chip->card)` is called it is no longer possible to decrement the number of chips. Attempting to do so results in a use-after-free and a crash.\n\nIntroduced in **3.1-rc8** by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=362e4e49abe53e89d87455dfcd7c1bbaf08a839d) commit.",
    "publishedDate": "2018-12-04T17:10:13.420Z",
    "updatedDate": "2019-02-05T14:00:28.583Z",
    "disclosureDate": "2018-12-03T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.167**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=82fa3e95432f95254fd07556c55b1018145e1439) commit,\n* [**4.9.145**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=73000a4cec933fd331224df79df731ea929bb85c) commit,\n* [**4.14.88**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=19f74e45746253cafb8cb1e773041e7cadbac622) commit,\n* [**4.19.9**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a7e719ace75e4451b7958cb73cbc12c627760007) commit, and\n* [**4.20-rc6**](https://www.kernel.org/) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5f8cf712582617d523120df67d392059eaf2fc4b) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.6,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 0.9,
        "severity": "MEDIUM",
        "attackVector": "PHYSICAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "CVSS:3.0/AV:P/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-12-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.0,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4213",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-19824",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-4213/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.suse.com/show_bug.cgi?id=1118152",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=19f74e45746253cafb8cb1e773041e7cadbac622",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5f8cf712582617d523120df67d392059eaf2fc4b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=73000a4cec933fd331224df79df731ea929bb85c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=82fa3e95432f95254fd07556c55b1018145e1439",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a7e719ace75e4451b7958cb73cbc12c627760007",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}