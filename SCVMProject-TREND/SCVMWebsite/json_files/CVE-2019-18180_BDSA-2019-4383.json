{
    "source": "BDSA",
    "name": "BDSA-2019-4383",
    "title": "OTRS Vulnerable to Denial-of-Service (DoS) by Infinite Loop via Long File Extensions",
    "description": "OTRS framework contains an infinite loop vulnerability where an attacker can add a file extension of an unlimited size and cause the mail processing, in some situations, to continuing processing until the process is stopped manually. This will cause resource leaking, resulting in the framework crashing and a denial-of-service (DoS) condition.",
    "technicalDescription": "When OTRS framework's email parser is parsing attachments, it will default to the email header for a file extension if one is not provided within the Content-Type or Content-Disposition header. The subject string is passed to the `MainObject->FilenameCleanup()` function to sanitize. An attacker can provide a subject with a single dot `.` and a long string greater than 220 characters, once the vulnerable function parses this, it will enter into an endless loop.\n\nThis exists within the PostMaster and file uploads to e-mails. It was addressed by ensuring the filename string including the extension does not exceed 220 characters.",
    "publishedDate": "2020-05-01T15:55:58.150Z",
    "updatedDate": "2020-05-01T15:58:37.646Z",
    "disclosureDate": "2019-08-05T00:00:00.000Z",
    "exploitPublishDate": "2019-10-05T00:00:00.000Z",
    "solution": "Fixed in [**6.0.24**](https://github.com/OTRS/otrs/releases/tag/rel-6_0_24) by [this](https://github.com/OTRS/otrs/commit/799616eb43f7fb53cae4e04c81e2156baaf02e2b) commit.\n\nFixed in [**5.0.39**](https://github.com/OTRS/otrs/releases/tag/rel-5_0_39) by [this](https://github.com/OTRS/otrs/commit/76b301f4e3f45cb23bb6a3d6907028c733d11145) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Stefan Bedorf",
    "workaround": "",
    "vendorFixDate": "2019-10-19T00:00:00.000Z",
    "vendorNotifiedDate": "2019-08-05T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4383",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-835"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-18180",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4383/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.otrs.org/show_bug.cgi?id=14716",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.otrs.org/show_bug.cgi?id=14716",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://community.otrs.com/security-advisory-2019-15-security-update-for-otrs-framework/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OTRS/otrs/commit/76b301f4e3f45cb23bb6a3d6907028c733d11145",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OTRS/otrs/commit/799616eb43f7fb53cae4e04c81e2156baaf02e2b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OTRS/otrs/releases/tag/rel-5_0_39",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OTRS/otrs/releases/tag/rel-6_0_24",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4383/default-remediation-status"
            }
        ]
    }
}