{
    "source": "BDSA",
    "name": "BDSA-2020-4229",
    "title": "Grub2 Vulnerable to SecureBoot Protection Bypass via Use-After-Free in 'rmmod' Command",
    "description": "Grub2 is vulnerable to the bypassing of SecureBoot protection mechanisms due to the improper management of dependencies. An attacker could trigger a use-after-free by executing a malicious command. This could potentially allow them to obtain or modify sensitive data, or to cause a denial-of-service (DoS).",
    "technicalDescription": "The `rmmod` command that is implemented via the `grub_mini_cmd_rmmod()` function of file `grub-core/commands/minicmd.c` is used to remove loaded modules. The command frees the memory that has been allocated in order to store the module's code and data. Modules can be dependent on other modules, and will hold a reference to modules with which this relationship exists. The number of references to a module is stored in the `ref_count` member of the `grub_dl_t` structure. The `rmmod` command does not perform any checks on the value of this variable to ensure that the module to be removed is not referenced by other modules. If this is the case, and the dependent module attempts to access the unloaded module, then a use-after-free will occur. This can be exploited by an attacker in order to bypass Secure Boot protections.",
    "publishedDate": "2021-03-04T15:13:07.237Z",
    "updatedDate": "2021-05-04T09:46:24.454Z",
    "disclosureDate": "2020-09-16T00:00:00.000Z",
    "solution": "Fixed in [**2.06-rc1**](https://git.savannah.gnu.org/cgit/grub.git/tag/?h=grub-2.06-rc1) by [this](https://git.savannah.gnu.org/cgit/grub.git/commit/?id=7630ec5397fe418276b360f9011934b8c034936c) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-03-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4229",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25632",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4229/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.savannah.gnu.org/cgit/grub.git/commit/?id=7630ec5397fe418276b360f9011934b8c034936c",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.savannah.gnu.org/cgit/grub.git/commit/?id=7630ec5397fe418276b360f9011934b8c034936c",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.savannah.gnu.org/cgit/grub.git/tag/?h=grub-2.06-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4229/default-remediation-status"
            }
        ]
    }
}