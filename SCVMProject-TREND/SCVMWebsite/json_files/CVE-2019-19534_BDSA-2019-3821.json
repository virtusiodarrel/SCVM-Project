{
    "source": "BDSA",
    "name": "BDSA-2019-3821",
    "title": "Linux Kernel Vulnerable to Information Disclosure via Kernel Memory Leak in 'peak_usb_create_dev()' Function",
    "description": "The Linux kernel is vulnerable to information disclosure due to the unsafe handling of system memory resources. A local attacker could obtain the contents of kernel memory by interfacing a maliciously configured USB device with a vulnerable system. This could allow the attacker to obtain potentially sensitive data.",
    "technicalDescription": "The function `peak_usb_create_dev()`, which is defined within the file `pcan_usb_core.c`, allocates the heap memory buffer `cmd_buf` in order to store command data. This is an element of the `dev` structure, which is associated with a connected USB device. This buffer is allocated using the `kmalloc()` function, which does not initialize the memory region that is allocated. The first sixteen bytes of this buffer will be automatically sent to the connected device whenever `pcan_usb_send_cmd()` is called. If that uninitialized data has not been overwritten at this point, it will be exposed to the device. This data could potentially contain sensitive information. An attacker could extract this data by connecting a maliciously configured USB to a vulnerable system.",
    "publishedDate": "2019-12-06T14:37:00.589Z",
    "updatedDate": "2019-12-06T14:50:31.635Z",
    "disclosureDate": "2019-11-04T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.201**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1afef2b7a5d8d97cee332aee1c4d5a96597c223d) commit\n* [**4.9.201**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=da281558d20bfbf82823cab457ba7d343ba6b0a0) commit\n* [**4.14.154**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=89a23a5d03956b44eac1a778806449577d690c6c) commit\n* [**4.19.84**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a7be2debb769092c7c07b9a866b055d8bee5afaf) commit\n* [**5.3.11**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=29dd281d2d6c6bf135e2bf8d3bc93f3568668cdd) commit\n* [**5.4-rc7**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f7a1337f0d29b98733c8824e165fca3371d7d4fd) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.6,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 0.9,
        "severity": "MEDIUM",
        "attackVector": "PHYSICAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "CVSS:3.0/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-11-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3821",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-402"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-19534",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3821/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.3.11",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=1afef2b7a5d8d97cee332aee1c4d5a96597c223d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=29dd281d2d6c6bf135e2bf8d3bc93f3568668cdd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=89a23a5d03956b44eac1a778806449577d690c6c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a7be2debb769092c7c07b9a866b055d8bee5afaf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=da281558d20bfbf82823cab457ba7d343ba6b0a0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f7a1337f0d29b98733c8824e165fca3371d7d4fd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3821/default-remediation-status"
            }
        ]
    }
}