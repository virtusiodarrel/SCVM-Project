{
    "source": "BDSA",
    "name": "BDSA-2018-3820",
    "title": "Systemd Vulnerable to Privilege Escalation via 'NotifyAccess' Parameter",
    "description": "An improper input validation vulnerability has been discovered in Systemd. An attacker could exploit this vulnerability by supplying an arbitrary state that influences system execution process to obtain root privilege escalation.",
    "technicalDescription": "The file `src/core/job.c` contains functionality which does not handle supplied input correctly. A longer than normal input utilized in the function `job_deserialize()` is not properly handled by the `fgets()` function which can result in line splitting. This can cause an issue if the malicious input is longer than `LINE_MAX` utilized in the `unit_deserialize()` function during a package upgrade allowing for state injection. \n\nSystemd services that are configured with`NotifyAccess != none` can be exploited by the malicious input to corrupt the process state and gain privilege escalation.",
    "publishedDate": "2018-10-31T10:17:06.305Z",
    "updatedDate": "2019-08-07T14:44:12.227Z",
    "disclosureDate": "2018-10-31T00:00:00.000Z",
    "solution": "Fixed in version [**240**](https://github.com/systemd/systemd/releases/tag/v240) by [this](https://github.com/systemd/systemd/commit/9f1c81d80a435d15ca1bd536a6d043c18c81c047) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.1,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jann Horn",
    "workaround": "",
    "vendorFixDate": "2018-10-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3820",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-15686",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-3820/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1639071",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/commit/9f1c81d80a435d15ca1bd536a6d043c18c81c047",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/pull/10519",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/systemd/systemd/releases/tag/v240",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}