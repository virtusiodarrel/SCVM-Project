{
    "source": "BDSA",
    "name": "BDSA-2021-0334",
    "title": "Magento Vulnerable to Reflected Cross-Site Scripting (XSS) via Encoded File Parameter in URLs",
    "description": "Magento is vulnerable to reflected cross-site scripting (XSS) due to improper sanitization of the file parameter in URLs. An authenticated attacker could insert encoded JavaScript code as part of a URL and send it to the administrator. The script would get executed upon the administrator visiting the link and navigating to the admin panel. This would result in the attacker stealing sensitive information or executing arbitrary actions on the administrator's behalf.",
    "technicalDescription": "If the security configuration `Add Secret Key to URLs` is enabled, a malicious URL would appear as follows:\n\n`https://{baseURL}/{adminPath}/admin/system_design_theme/downloadCss/theme_id/{themeID}/file/{base64encoded_xss_payload}/key/{secret_hash}`\n\nIf `Add Secret Key to URLS` is disabled, the following attack would work:\n\n`https://{baseURL}/{adminPath}/admin/system_design_theme/downloadCss/theme_id/{themeID}/file/{base64encoded_xss_payload}/`\n\nIn both scenarios the payload would be encoded in base64 format.",
    "publishedDate": "2021-02-11T12:34:35.417Z",
    "updatedDate": "2021-02-11T12:34:35.408Z",
    "disclosureDate": "2021-02-10T00:00:00.000Z",
    "exploitPublishDate": "2021-02-10T00:00:00.000Z",
    "solution": "Fixed in [**2.4.2**](https://github.com/magento/magento2/releases/tag/2.4.2).\n\nThe latest stable releases are available [here](https://magento.com/tech-resources/download).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Natsasit Jirathammanuwat (Office Thailand) working with SEC Consult Vulnerability Lab",
    "workaround": "",
    "vendorFixDate": "2021-02-09T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0334",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21029",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0334/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/magento/magento2/releases/tag/2.4.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://helpx.adobe.com/security/products/magento/apsb21-08.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://magento.com/tech-resources/download",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/161364/SA-20210210-0.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/161364/SA-20210210-0.txt",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0334/default-remediation-status"
            }
        ]
    }
}