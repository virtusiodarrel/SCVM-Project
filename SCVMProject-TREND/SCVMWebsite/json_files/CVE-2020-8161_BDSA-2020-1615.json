{
    "source": "BDSA",
    "name": "BDSA-2020-1615",
    "title": "Rack Vulnerable to Information Disclosure via Directory Traversal via Rack::Directory",
    "description": "Rack is vulnerable to directory traversal. An attacker could exploit this vulnerability to access restricted resources.\n\n**Note**: This vulnerability only affects applications that use Rack::Directory",
    "technicalDescription": "This vulnerability occurs in the `Dir[glob]` variable of the `list_directory()` function in the  Rack::Directory application which is part of Rack. \n\nAn attacker is able to use directory traversal to access restricted resources and read the contents of files on the server outside of the specified root directory.",
    "publishedDate": "2020-07-07T14:29:00.016Z",
    "updatedDate": "2020-07-07T14:29:00.009Z",
    "disclosureDate": "2020-05-12T00:00:00.000Z",
    "solution": "Fixed in [**2.2.0**](https://github.com/rack/rack/releases/tag/2.2.0) by [this](https://github.com/rack/rack/commit/a0ccb0912c2dc3187fe477dbdb408e23bad96041) commit, and  [**2.1.3**](https://github.com/rack/rack/releases/tag/2.1.3) by [this](https://github.com/rack/rack/commit/dddb7ad18ed79ca6ab06ccc417a169fde451246e) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "saltyyolk",
    "workaround": "The vendor provided the following workaround:\n> We recommend that developers do not use Rack::Directory in their\napplications.",
    "vendorFixDate": "2020-05-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1615",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8161",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1615/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rack/rack/commit/a0ccb0912c2dc3187fe477dbdb408e23bad96041",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rack/rack/commit/dddb7ad18ed79ca6ab06ccc417a169fde451246e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rack/rack/releases/tag/2.1.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rack/rack/releases/tag/2.2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/forum/#!topic/rubyonrails-security/IOO1vNZTzPA",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/forum/#!topic/rubyonrails-security/IOO1vNZTzPA",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1615/default-remediation-status"
            }
        ]
    }
}