{
    "source": "BDSA",
    "name": "BDSA-2020-2985",
    "title": "ShapeShift KeepKey Vulnerable to Remote Code Execution (RCE)  via Out-of-Bounds Write in '.bss' Segment",
    "description": "ShapeShift KeepKey is vulnerable to denial-of-service (DoS) or potential remote code execution (RCE) via an out-of-bounds write triggered via crafted messages.",
    "technicalDescription": "This issue occurs due to a lack of sufficient checks relating to the USB packet handling of the hardware wallet. KeepKey utilizes a specific packet encoding scheme for transporting custom `protobuf` messages via USB. A subset of these messages are designated as `tiny` and are particularly small and simple in both their encoded as well as decoded form. \nKeepKey is designed to allow specific handling of such messages within certain time periods. All other messages are rejected during these times. This issue lies in the fact that the packet handling logic insufficiently checks whether received messages are actually `tiny`. It was mitigated by the addition of stronger checks relating to which `tiny_msg`'s are permitted to be decoded.",
    "publishedDate": "2020-10-26T15:16:13.836Z",
    "updatedDate": "2020-10-26T15:16:13.827Z",
    "disclosureDate": "2020-02-11T00:00:00.000Z",
    "exploitPublishDate": "2020-02-11T00:00:00.000Z",
    "solution": "Fixed in [**6.2.2**](https://github.com/keepkey/keepkey-firmware/releases/tag/v6.2.2) by [this](https://github.com/keepkey/keepkey-firmware/commit/b222c66cdd7c3203d917c80ba615082d309d80c3) commit.\n\nThe latest stable releases are available [here](https://github.com/keepkey/keepkey-firmware/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Christian Reitter",
    "workaround": "",
    "vendorFixDate": "2019-09-18T00:00:00.000Z",
    "vendorNotifiedDate": "2019-09-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2985",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-18671",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2985/ranges"
            },
            {
                "rel": "reference",
                "href": "https://blog.inhq.net/posts/keepkey-CVE-2019-18671/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://blog.inhq.net/posts/keepkey-CVE-2019-18671/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keepkey/keepkey-firmware/commit/b222c66cdd7c3203d917c80ba615082d309d80c3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keepkey/keepkey-firmware/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keepkey/keepkey-firmware/releases/tag/v6.2.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2985/default-remediation-status"
            }
        ]
    }
}