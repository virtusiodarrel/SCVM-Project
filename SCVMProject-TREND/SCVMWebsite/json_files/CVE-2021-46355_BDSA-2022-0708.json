{
    "source": "BDSA",
    "name": "BDSA-2022-0708",
    "title": "OCS Inventory Vulnerable to Stored Cross-Site Scripting (XSS) via 'ajaxgestionresults()' Function",
    "description": "OCS Inventory is vulnerable to stored cross-site scripting (XSS) due to improper sanitization of data collection. An attacker could exploit this by modifying device names on your computer to hijack sessions and obtain sensitive information such as authentication tokens and user session cookies.",
    "technicalDescription": "The vulnerability exists in the `require/function_table_html.php` file within the `ajaxgestionresults()` function. This occurs due to improper sanitization of the data collected when scanning the network for devices and other assets via the `$rowValue` variable. An attacker can purposely rename devices such as a printer to include malicious scripting code so when this device information is collected and displayed on the application, the scripts are injected and executed directly on the application which may steal or modify sensitive information.\n\nThis has been mitigated by correctly sanitizing `$rowValue` using `htmlspecialchars()` to convert untrusted HTML input into its translated form so that malicious code cannot be executed.",
    "publishedDate": "2022-03-16T12:43:40.644Z",
    "updatedDate": "2022-03-16T12:43:40.630Z",
    "disclosureDate": "2022-02-07T00:00:00.000Z",
    "exploitPublishDate": "2022-02-07T00:00:00.000Z",
    "solution": "Fixed in the **master** by [this](https://github.com/OCSInventory-NG/OCSInventory-ocsreports/commit/f20f39c8af9eab42fa81e90a0787ec0e219f6fed) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Windsor Moreira",
    "workaround": "",
    "vendorFixDate": "2022-02-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0708",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-46355",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0708/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OCSInventory-NG/OCSInventory-ocsreports/commit/3e5bcce7a3607083207929a3a173ca6fb8fb4b35",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OCSInventory-NG/OCSInventory-ocsreports/commit/f20f39c8af9eab42fa81e90a0787ec0e219f6fed",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://medium.com/@windsormoreira/ocs-inventory-2-9-1-cross-site-scripting-xss-cve-2021-46355-a88d72606b7e",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://medium.com/@windsormoreira/ocs-inventory-2-9-1-cross-site-scripting-xss-cve-2021-46355-a88d72606b7e",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0708/default-remediation-status"
            }
        ]
    }
}