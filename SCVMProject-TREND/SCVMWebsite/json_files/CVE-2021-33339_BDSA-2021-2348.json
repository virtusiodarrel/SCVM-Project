{
    "source": "BDSA",
    "name": "BDSA-2021-2348",
    "title": "Liferay Portal Vulnerable to Stored Cross-Site Scripting (XSS) via Insufficient Parameter Validation in 'Fragment ' Module",
    "description": "Liferay Portal is vulnerable to cross-site scripting (XSS) due to the insufficient validation of client-provided input parameters. A remote attacker could execute malicious scripts within the browser of a victim by tricking that victim into viewing maliciously crafted web content. This could allow the attacker to obtain sensitive information, such as browser cookies.",
    "technicalDescription": "The Fragment module within Liferay Portal provides a web page for examining view collections. This page can make use of the `_com_liferay_site_admin_web_portlet_SiteAdminPortlet_name` HTTP request parameter. The value of this parameter is stored by the server and later used to dynamically generate content that will be included in the server's responses. The value is not sanitized or validated prior to its insertion into the dynamically generated content. If the value constitutes a XSS payload, then the payload will be executed by the client's browser whenever the content is rendered.\n\nA remote attacker could therefore carry out a reflected XSS attack by sending a request that contains a maliciously crafted `_com_liferay_site_admin_web_portlet_SiteAdminPortlet_name` parameter, and then tricking a user into viewing content that is dynamically generated using that parameter.",
    "publishedDate": "2021-08-06T14:38:32.861Z",
    "updatedDate": "2021-09-08T12:49:36.338Z",
    "disclosureDate": "2021-05-10T00:00:00.000Z",
    "solution": "Fixed in [**7.3.5**](https://github.com/liferay/liferay-portal/releases/tag/7.3.5-ga6).\n\nA cumulative patch for version **7.2.1** can be found [here](https://github.com/community-security-team/liferay-portal/compare/7.2.1-ga2...7.2.1-cumulative.patch). This cumulative patch has not yet been included in any release.\n\nThe latest stable releases are available [here](https://github.com/liferay/liferay-portal/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 1.7,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-10-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2348",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33339",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2348/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/community-security-team/liferay-portal/compare/7.2.1-ga2...7.2.1-cumulative.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/liferay/liferay-portal/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/liferay/liferay-portal/releases/tag/7.3.5-ga6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/id/120747934",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2348/default-remediation-status"
            }
        ]
    }
}