{
    "source": "BDSA",
    "name": "BDSA-2019-2135",
    "title": "Mozilla Client Applications Vulnerable to SandBox Escape via Upload to 'AddonManager' API",
    "description": "Mozilla client applications including Firefox, Firefox-esr, and Thunderbird are vulnerable to a sandbox escape.  This allows a remote attacker to craft web content that can be used to inject arbitrary XUL.  This will be executed as its own process and not within the browser, effectively escaping the Mozilla sandbox.",
    "technicalDescription": "The Sandbox escape is possible due to the `AddonManager` API in `toolkit/mozapps/extensions/AddonManager.jsm` allowing installation of add-ons without users needing to click a prompt. This means there is no confirmation or sign if a malicious page attempts to make a request to `addons.mozilla.org` (AMO) to install an add-on. \n\nA remote attacker can create web content that will install a malicious language-pack add-on that could be used to inject arbitrary XUL.",
    "publishedDate": "2019-07-17T11:05:49.495Z",
    "updatedDate": "2019-07-17T11:05:49.484Z",
    "disclosureDate": "2019-07-09T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* Firefox [**68**](https://www.mozilla.org/en-GB/firefox/new/)\n* Firefox-esr [**60.8**](https://www.mozilla.org/en-US/firefox/organizations/).\n* Thunderbird [**60.8**](https://www.thunderbird.net/en-GB/).\n\nFixed by [this](https://hg.mozilla.org/mozilla-central/rev/b7e2018b550c) revision.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.3
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Niklas Baumstark",
    "workaround": "",
    "vendorFixDate": "2019-04-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2135",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9811",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2135/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1538007",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1539598",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1563327",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://hg.mozilla.org/mozilla-central/rev/b7e2018b550c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-GB/firefox/new/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/firefox/organizations/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2019-21/#CVE-2019-9811",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2019-22/#CVE-2019-9811",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.mozilla.org/en-US/security/advisories/mfsa2019-23/#CVE-2019-9811",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.thunderbird.net/en-GB/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2135/default-remediation-status"
            }
        ]
    }
}