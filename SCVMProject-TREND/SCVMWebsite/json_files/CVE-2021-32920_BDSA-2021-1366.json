{
    "source": "BDSA",
    "name": "BDSA-2021-1366",
    "title": "Prosody Vulnerable to Denial-of-Service (DoS) via Uncontrolled CPU Consumption due to TLS Renegotiation Request Flooding",
    "description": "Prosody allows repeated TLS renegotiation requests from its clients. An attacker could exploit this flaw by flooding the server with such requests and cause excessive CPU consumption. This can result in a denial-of-service (DoS).",
    "technicalDescription": "This vulnerability primarily exists in the `core/certmanager.lua` file. This file allows the server to process TLS renegotiation requests. This can allow an attacker to flood the server with these requests and cause a denial-of-service. This issue was fixed by disabling TLS renegotiation by default.",
    "publishedDate": "2021-05-17T12:06:18.128Z",
    "updatedDate": "2021-05-17T12:06:18.122Z",
    "disclosureDate": "2021-05-12T00:00:00.000Z",
    "solution": "Fixed in **[0.11.9](https://hg.prosody.im/trunk/file/0.11.9)** by the following commits:\n* [Commit 1](https://hg.prosody.im/trunk/rev/55ef50d6cf65)\n* [Commit 2](https://hg.prosody.im/trunk/rev/5a484bd050a7)\n* [Commit 3](https://hg.prosody.im/trunk/rev/aaf9c6b6d18d)\n\nThe latest stable releases are available [here](https://hg.prosody.im/trunk/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Kim Alvefur",
    "workaround": "The vendor recommends users to have OpenSSL 1.1.1 or higher and LuaSec 0.7 or higher installed on their servers. The following option should be set for SSL/TLS connections:\n```\nssl = {\n    options = {\n      no_renegotiation = true;\n    }\n  }\n```",
    "vendorFixDate": "2021-05-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1366",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32920",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1366/ranges"
            },
            {
                "rel": "reference",
                "href": "https://hg.prosody.im/trunk/file/0.11.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hg.prosody.im/trunk/rev/55ef50d6cf65",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.prosody.im/trunk/rev/5a484bd050a7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.prosody.im/trunk/rev/aaf9c6b6d18d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://hg.prosody.im/trunk/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://prosody.im/security/advisory_20210512/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://prosody.im/security/advisory_20210512/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1366/default-remediation-status"
            }
        ]
    }
}