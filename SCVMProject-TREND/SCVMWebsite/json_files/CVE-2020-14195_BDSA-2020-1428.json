{
    "source": "BDSA",
    "name": "BDSA-2020-1428",
    "title": "FasterXML jackson-databind Vulnerable to Remote Code Execution (RCE) via Polymorphic Typing Issue in 'jsecurity' Gadgets",
    "description": "FasterXML jackson-databind is vulnerable to remote code execution (RCE) due to how polymorphic data types are handled by a gadget used by the application. A remote attacker could execute arbitrary commands on the underlying system by submitting crafted JSON messages to the application. It should be noted that this 'Default Typing' must be enabled for an externally exposed JSON end-path in order for this vulnerability to manifest.",
    "technicalDescription": "The JSON object received by jackson-databind can include a class name as the type ID for certain fields, in order to ensure that the deserializer knows what subtype to use for the values of those fields. Alternatively, if 'Default Typing' is enabled, default class names will be used for all JSON properties that match a given set of criteria. An attacker could potentially provide crafted JSON messages in order to invoke classes that will allow for remote code execution via deserialization. \n\nThe class `org.jsecurity.realm.jndi.JndiRealmFactory` contains a property, `jndiNames`, which is a collection of `String` objects. Whenever a serialized instance of this class is being deserialized, Jackson Databind will invoke the overloaded `setJndiNames()` setter method in order to set the value of the `jndiNames` property. The `getRealms()` method will subsequently be invoked in order to obtain a collection of `Realm` objects. The `Realm` objects will correspond to the JNDI names that are specified in the object. If the value of the `jndiNames` attribute is a LDAP URL, then the application will submit a request to the LDAP server that has been specified. If the LDAP entry is a `Reference` object, then the application can attempt to download and instantiate the remotely hosted factory class that is specified by that object. An attacker could cause arbitrary code to be executed on the server by hosting a crafted factory class, which contains a malicious payload in its constructor or a static initialization block.\n\nIn order for an attacker to exploit this vulnerability, 'Default Typing' must be enabled for an externally exposed JSON end-path. The relevant JAR must also be exposed in the classpath.\n\nIt should be noted that this vulnerability does not affect release **2.10.0** and above.",
    "publishedDate": "2020-06-23T15:21:50.197Z",
    "updatedDate": "2021-08-16T10:12:17.281Z",
    "disclosureDate": "2020-06-13T00:00:00.000Z",
    "exploitPublishDate": "2020-05-27T00:00:00.000Z",
    "solution": "Fixed in [**2.9.10.5**](https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.9.10.5) by [this](https://github.com/FasterXML/jackson-databind/commit/f6d9c664f6d481703138319f6a0f1fdbddb3a259) commit.\n\nFixed in [**2.6.7.4**](https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.6.7.4) by [this](https://github.com/FasterXML/jackson-databind/commit/74aba4042fce35ee0b91bd2847e788c10040d78b) commit.\n\nFixed in the **2.7** and **2.8** branches by [this](https://github.com/FasterXML/jackson-databind/commit/08fbfacf89a4a4c026a6227a1b470ab7a13e2e88) commit which is not yet included in any release.\n\nThe latest stable releases are available [here](https://github.com/FasterXML/jackson-databind/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-06-14T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1428",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14195",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1428/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Al1ex/CVE-2020-14195",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/commit/08fbfacf89a4a4c026a6227a1b470ab7a13e2e88",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/commit/74aba4042fce35ee0b91bd2847e788c10040d78b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/commit/f6d9c664f6d481703138319f6a0f1fdbddb3a259",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/issues/2765",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.6.7.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/FasterXML/jackson-databind/releases/tag/jackson-databind-2.9.10.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1428/default-remediation-status"
            }
        ]
    }
}