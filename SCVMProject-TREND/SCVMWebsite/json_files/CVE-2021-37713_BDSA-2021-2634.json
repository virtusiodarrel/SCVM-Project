{
    "source": "BDSA",
    "name": "BDSA-2021-2634",
    "title": "tar Vulnerable to Arbitrary File Creation/Overwrite via Insufficient Relative Path Sanitization",
    "description": "The tar package for Node.js is vulnerable to arbitrary file creation/overwrite via insufficient relative path sanitization. \n\n**Note:** This only affects users on Windows systems.",
    "technicalDescription": "node-tar tries to ensure that any files which are located outside the extraction target directory are not extracted. However the logic outlined for this is insufficient on Windows when extracting tar files containing a path that was specified a drive letter that was different from the extraction target. In addition, a `..` portion of the path could occur immediately after the drive letter, such as `C:../foo`, and was not properly sanitized by the logic that checked for` ..` within the normalized and split portions of the path.\n\nThis issue was addressed by stripping path roots from all paths before being resolved against the extraction target folder even if these paths are not absolute. Additionally a check was added for paths starting with a drive letter and then 2 dots. Finally if `entry.absolute` is outside the extraction target and `preservePaths:true` mode is not active then a warning is raised on that entry and it is skipped.",
    "publishedDate": "2021-09-01T15:54:23.779Z",
    "updatedDate": "2021-09-01T15:54:23.768Z",
    "disclosureDate": "2021-08-31T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.4.18**](https://github.com/npm/node-tar/releases/tag/v4.4.18) by [this](https://github.com/npm/node-tar/commit/52b09e309bcae0c741a7eb79a17ef36e7828b946) commit. \n* [**5.0.10**](https://github.com/npm/node-tar/releases/tag/v5.0.10) by [this](https://github.com/npm/node-tar/commit/82eac952f7c10765969ed464e549375854b26edc) commit.\n* [**6.1.9**](https://github.com/npm/node-tar/releases/tag/v6.1.9) by [this](https://github.com/npm/node-tar/commit/875a37e3ec031186fc6599f6807341f56c584598) commit.\n\nThe latest stable releases are available [here](https://github.com/npm/node-tar/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.0,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Robert Chen",
    "workaround": "",
    "vendorFixDate": "2021-08-09T00:00:00.000Z",
    "vendorNotifiedDate": "2021-08-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2634",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-37713",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2634/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-5955-9wpr-37jh",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/node-tar/commit/52b09e309bcae0c741a7eb79a17ef36e7828b946",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/node-tar/commit/82eac952f7c10765969ed464e549375854b26edc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/node-tar/commit/875a37e3ec031186fc6599f6807341f56c584598",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/node-tar/releases/tag/v4.4.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/node-tar/releases/tag/v5.0.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/node-tar/releases/tag/v6.1.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/node-tar/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/advisories/1781",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2634/default-remediation-status"
            }
        ]
    }
}