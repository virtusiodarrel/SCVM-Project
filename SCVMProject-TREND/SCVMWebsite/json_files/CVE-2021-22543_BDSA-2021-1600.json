{
    "source": "BDSA",
    "name": "BDSA-2021-1600",
    "title": "Linux Kernel Vulnerable to Memory Tampering via VMA Mishandling in KVM",
    "description": "Linux Kernel is vulnerable to memory tampering issues due to how RO checks can be bypassed and cause pages to be freed while still being accessible to the VMM and guest.\n\nAn attacker with permissions to start and control VMs could use this issue to read or write random pages of memory.",
    "technicalDescription": "Linux Kernel is vulnerable to memory tampering issues because KVM mishandles mapping specific types of host memory into the guest. A VMA that has the `VM_IO` or `VM_PFNMAP` flag set can cause attempts translate the host virtual address to the page required to map into the guest using `get_user_pages()` to fail. In handling this failure pages can potentially be treated as normal pages by KVM where `getpage` / `putpage` is then called on them.\n\nUnder these circumstances, pages can end up being freed by `putpage` at the end of the guest page fault despite the guest and host still referencing the page.",
    "publishedDate": "2021-05-28T13:29:06.123Z",
    "updatedDate": "2021-08-18T08:47:18.722Z",
    "disclosureDate": "2021-05-18T00:00:00.000Z",
    "exploitPublishDate": "2021-05-18T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.14.243**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=46d75ff2c1beebe90e7af8887256d8f0323679e4) commit,\n* [**4.19.199**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=117777467bc015f0dc5fc079eeba0fa80c965149) commit,\n* [**5.4.129**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bb85717e3797123ae7724751af21d0c9d605d61e) commit,\n* [**5.10.47**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=dd8ed6c9bc2224c1ace5292d01089d3feb7ebbc3) commit,\n* [**5.12.14**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c36fbd888dcc27d365c865e6c959d7f7802a207c) commit,\n* [**5.13**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f8be156be163a052a067306417cd0ff679068c97) commit,\n* [**5.14-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f8be156be163a052a067306417cd0ff679068c97) commit.\n\nThe latest stable releases are available [here](https://www.kernel.org).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 2.7,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.0,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "dgstevens, thejh, fluxchief",
    "workaround": "",
    "vendorFixDate": "2021-06-24T00:00:00.000Z",
    "vendorNotifiedDate": "2021-02-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1600",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-119"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22543",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1600/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=117777467bc015f0dc5fc079eeba0fa80c965149",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=46d75ff2c1beebe90e7af8887256d8f0323679e4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=bb85717e3797123ae7724751af21d0c9d605d61e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c36fbd888dcc27d365c865e6c959d7f7802a207c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=dd8ed6c9bc2224c1ace5292d01089d3feb7ebbc3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f8be156be163a052a067306417cd0ff679068c97",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/security-research/security/advisories/GHSA-7wq5-phmq-m584",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/security-research/security/advisories/GHSA-7wq5-phmq-m584",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2021/q2/167",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1600/default-remediation-status"
            }
        ]
    }
}