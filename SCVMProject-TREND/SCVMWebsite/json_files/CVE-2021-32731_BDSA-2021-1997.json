{
    "source": "BDSA",
    "name": "BDSA-2021-1997",
    "title": "XWiki Vulnerable to Information Disclosure via Email Leak on Password Reset Form",
    "description": "XWiki is vulnerable to an information disclosure issue due to how the password reset form can reveal the email address of users. \n\nAn attacker could abuse this flaw by submitting valid usernames to reveal the associated email addresses.",
    "technicalDescription": "XWiki is vulnerable to information disclosure because the password reset functionality, which is implemented in the file `xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/resetpasswordinline.vm`, does not sufficiently obfuscate email addresses when displaying messages after a reset password attempt.",
    "publishedDate": "2021-07-02T15:30:55.482Z",
    "updatedDate": "2021-07-02T15:30:55.476Z",
    "disclosureDate": "2021-07-01T00:00:00.000Z",
    "solution": "Fixed in [**13.2-rc1**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.2-rc-1) by [this](https://github.com/xwiki/xwiki-platform/commit/0cf716250b3645a5974c80d8336dcdf885749dff) commit.\n\nThe latest stable releases are available [here](https://www.xwiki.org/xwiki/bin/view/Download/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has suggested [here](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-h4m4-pgp4-whgm) that it is possible to manually modify the  `xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/resetpasswordinline.vm` file with the changes found in [this](https://github.com/xwiki/xwiki-platform/commit/0cf716250b3645a5974c80d8336dcdf885749dff) commit to resolve this issue.",
    "vendorFixDate": "2021-03-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1997",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-209"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32731",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1997/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/0cf716250b3645a5974c80d8336dcdf885749dff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.2-rc-1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-h4m4-pgp4-whgm",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-h4m4-pgp4-whgm",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://jira.xwiki.org/browse/XWIKI-18400",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.xwiki.org/xwiki/bin/view/Download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1997/default-remediation-status"
            }
        ]
    }
}