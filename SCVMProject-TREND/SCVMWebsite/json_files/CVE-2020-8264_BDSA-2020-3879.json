{
    "source": "BDSA",
    "name": "BDSA-2020-3879",
    "title": "Ruby on Rails Vulnerable to Reflected Cross-SIte Scripting (XSS) via Action Pack Development Mode",
    "description": "Ruby on Rails is vulnerable to reflected cross-site scripting (XSS) due to improper validation of user-supplied input. This could allow an attacker to inject arbitrary web scripts and steal sensitive information such as authentication tokens and user session cookies.",
    "technicalDescription": "The issue exists in the function `redirect_to()` within the file `actionpack/lib/action_dispatch/middleware/actionable_exceptions.rb`, when an application server is running in development mode. Improper parsing of response headers containing `\\r` characters at the beginning of a redirect destination can cause intended redirects to not be performed, and result in any `javascript:` included in the URL of the response being executed if a victim clicks on a crafted link.",
    "publishedDate": "2020-12-23T15:32:01.335Z",
    "updatedDate": "2021-01-08T16:37:32.265Z",
    "disclosureDate": "2020-10-07T00:00:00.000Z",
    "exploitPublishDate": "2020-12-22T00:00:00.000Z",
    "solution": "Fixed in [**6.0.3.4**](https://github.com/rails/rails/releases/tag/v6.0.3.4) by [this](https://github.com/rails/rails/commit/bd5d907e72fe799f5455804843a92695a5f29e63) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "ooooooo_q",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, the vendor recommends that application developers should disable the Actionable Exceptions middleware in their development environment via \na line such as this one in their `config/environment/development.rb`: \n> `config.middleware.delete ActionDispatch::ActionableExceptions`",
    "vendorFixDate": "2020-10-07T00:00:00.000Z",
    "vendorNotifiedDate": "2020-08-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3879",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8264",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3879/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/bd5d907e72fe799f5455804843a92695a5f29e63",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v6.0.3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/rubyonrails-security/c/yQzUVfv42jk",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/rubyonrails-security/c/yQzUVfv42jk",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/904059",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/904059",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3879/default-remediation-status"
            }
        ]
    }
}