{
    "source": "BDSA",
    "name": "BDSA-2019-1926",
    "title": "Moodle Vulnerable to Denial-of-Service (DoS) via File Quota Bypass in Email Uploads",
    "description": "A vulnerability was discovered in Moodle where a user could exceed their maximum file quota by uploading private files via email. A malicious user could exploit this to fill disk space on the server triggering a denial-of-service (DoS) condition.",
    "technicalDescription": "The vulnerability occurs when uploading private files via email. The email attachment size is always set to zero. The file size is checked when the files are uploaded into the draft area against the users remaining allocated quota. The issue occurs because the files are moved out of the draft area as they are processed so it is possible for a user to exceed their limit with multiple files and still pass the check.",
    "publishedDate": "2019-07-01T09:22:50.011Z",
    "updatedDate": "2019-07-01T09:22:50.004Z",
    "disclosureDate": "2019-05-20T00:00:00.000Z",
    "solution": "Fixed in version [**3.7**](https://download.moodle.org/releases/latest/) by [this](http://git.moodle.org/gw?p=moodle.git;a=log;h=refs/tags/v3.7.0) commit.\nFixed in version [**3.6.4**](https://download.moodle.org/releases/supported/) by [this](http://git.moodle.org/g?wp=moodle.git;a=commit;h=a8c51871f4856ac1a6e9883a2d4309c6c54346f8) commit.\nFixed in version[**3.5.6**](https://download.moodle.org/releases/security/) by [this](http://git.moodle.org/gw?p=moodle.git;a=commit;h=e36f1c989670cc8fa2e322622cabad1a7fa5a831) commit.\nFixed in version[**3.4.9**](https://download.moodle.org/releases/legacy/) by [this](http://git.moodle.org/gw?p=moodle.git;a=commit;h=3f4f2da9e0fe17366df855458e06b9914d554568) commit.\nFixed in version [**3.1.18**](https://download.moodle.org/releases/legacy/) by [this](http://git.moodle.org/gw?p=moodle.git;a=commit;h=7ea1b25cac963f6727d8e89f2d678f47308b43cb) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Guillermo Leon Alvarez Salamanca",
    "workaround": "",
    "vendorFixDate": "2019-05-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1926",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10134",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1926/ranges"
            },
            {
                "rel": "reference",
                "href": "http://git.moodle.org/g?wp=moodle.git;a=commit;h=a8c51871f4856ac1a6e9883a2d4309c6c54346f8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://git.moodle.org/gw?p=moodle.git;a=commit;h=3f4f2da9e0fe17366df855458e06b9914d554568",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://git.moodle.org/gw?p=moodle.git;a=commit;h=7ea1b25cac963f6727d8e89f2d678f47308b43cb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://git.moodle.org/gw?p=moodle.git;a=commit;h=e36f1c989670cc8fa2e322622cabad1a7fa5a831",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://git.moodle.org/gw?p=moodle.git;a=log;h=refs/tags/v3.7.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://download.moodle.org/releases/legacy/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://download.moodle.org/releases/security",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://download.moodle.org/releases/supported",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=386524",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1926/default-remediation-status"
            }
        ]
    }
}