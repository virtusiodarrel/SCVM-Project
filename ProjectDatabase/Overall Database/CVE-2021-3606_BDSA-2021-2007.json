{
    "source": "BDSA",
    "name": "BDSA-2021-2007",
    "title": "OpenVPN on Windows Systems Vulnerable to Arbitrary Code Execution via OpenSSL Dynamic Library Loading",
    "description": "OpenVPN on Windows systems is vulnerable to an arbitrary code execution issue due to a feature in the OpenSSL implementation that allows users to load arbitrary dynamic loadable libraries.\n\nThis issue could allow a local user to load an arbitrary library and execute code with the same privilege level as the main OpenVPN process (`openvpn.exe`).",
    "technicalDescription": "OpenVPN on Windows is vulnerable to arbitrary code execution because an issue in how the OpenSSL library is built allows OpenSSL configuration files to be loaded from user-writable directories on the system. A malicious user could use this issue to load arbitrary dynamic loadable libraries via the OpenSSL configuration file in order to execute code.\n\nTo remedy this issue, the vendor has disabled the feature at compile-time of the OpenSSL library so that no external OpenSSL configuration files are loaded from specific folders on the local system.",
    "publishedDate": "2021-07-05T14:13:57.364Z",
    "updatedDate": "2021-12-17T14:15:16.262Z",
    "disclosureDate": "2021-07-01T00:00:00.000Z",
    "solution": "Fixed in [**2.5.3**](https://github.com/OpenVPN/openvpn/releases/tag/v2.5.3) by [this](https://github.com/openvpn/openvpn/commit/447cfb4f30fd96126f7d2945cd14ef39cc13a08a) commit and [this](https://github.com/OpenVPN/openvpn/commit/92535b6a10865f7e6729f766dcf36e094b7f61d4) commit.\n\n**Note**: The vendor later decided that the functionality disabled in these commits could be useful to some users and has reinstated these features in [**2.5.5**](https://github.com/OpenVPN/openvpn/releases/tag/v2.5.5) with [this](https://github.com/openvpn/openvpn/commit/f911b3f69b0a8296918a06d02eb5144bb4cd8a06) commit. This commit also sets OpenSSL environment variables `OPENSSL_CONF`, `OPENSSL_ENGINES`, `OPENSSL_MODULES` which are used to load config, engines and modules to a trusted location. This location is constructed based on installation path and read from registry on startup. If installation path cannot be read, `Windows\\System32` is used as a fallback.\n\nThe latest stable releases are available [here](https://github.com/OpenVPN/openvpn/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.3,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.5
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Xavier Danest",
    "workaround": "",
    "vendorFixDate": "2021-06-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2007",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-427"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-3606",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-2007/ranges"
            },
            {
                "rel": "reference",
                "href": "https://community.openvpn.net/openvpn/wiki/CVE-2021-3606",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenVPN/openvpn/commit/92535b6a10865f7e6729f766dcf36e094b7f61d4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenVPN/openvpn/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenVPN/openvpn/releases/tag/v2.5.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenVPN/openvpn/releases/tag/v2.5.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openvpn/openvpn/commit/447cfb4f30fd96126f7d2945cd14ef39cc13a08a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openvpn/openvpn/commit/a4071b20115c7d4e808df81169a986e65cec4efa",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openvpn/openvpn/commit/f911b3f69b0a8296918a06d02eb5144bb4cd8a06",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mail-archive.com/openvpn-devel@lists.sourceforge.net/msg22567.html",
                "label": "ADVISORY"
            }
        ]
    }
}