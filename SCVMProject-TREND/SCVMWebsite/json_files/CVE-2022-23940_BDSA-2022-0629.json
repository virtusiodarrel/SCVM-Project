{
    "source": "BDSA",
    "name": "BDSA-2022-0629",
    "title": "SuiteCRM Vulnerable to Remote Code Execution (RCE) via 'email_recipients' Parameter in Scheduled Reports",
    "description": "SuiteCRM is vulnerable to remote code execution (RCE) through the Scheduled Reports functionality. Users who are able to create Scheduled Reports could send PHP code in the email recipient parameter which would get executed on the host once the report is accessed.",
    "technicalDescription": "The vulnerable function is `get_email_recipients` in the file `SuiteCRM-Core/public/legacy/modules/AOR_Scheduled_Reports/AOR_Scheduled_Reports.php`. It deserializes the `email_recipients` parameter using PHP's `unserialize` function without verifying the data. This allows storing arbitrary data in the related database which could be leveraged to achieve RCE.\n\nThe vulnerability was fixed by introducing a new `parseRecipients` function in `AOR_Scheduled_Reports.php` which properly sanitizes the `email_recipients` parameter.",
    "publishedDate": "2022-03-08T14:33:07.944Z",
    "updatedDate": "2022-03-08T14:33:07.928Z",
    "disclosureDate": "2022-03-02T00:00:00.000Z",
    "exploitPublishDate": "2022-03-06T00:00:00.000Z",
    "solution": "Fixed in SuiteCRM [**7.12.5**](https://github.com/salesagility/SuiteCRM/releases/tag/v7.12.5) by [this](https://github.com/salesagility/suitecrm/commit/e93b269f637de313f45b32c58cef5ec012a34f58) commit.\n\nFixed in SuiteCRM-Core [**8.0.4**](https://github.com/salesagility/SuiteCRM-Core/releases/tag/v8.0.4) by [this](https://github.com/salesagility/SuiteCRM-Core/commit/5fa70e2794a022003561fe1a701be9f4dcba9fc8) commit.\n\nThe latest stable releases can be found [here](https://suitecrm.com/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Manuel Zametter",
    "workaround": "",
    "vendorFixDate": "2022-03-01T00:00:00.000Z",
    "discoveryDate": "2022-01-24T00:00:00.000Z",
    "vendorNotifiedDate": "2022-01-24T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0629",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23940",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0629/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.suitecrm.com/8.x/admin/releases/8.0/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/manuelz120/CVE-2022-23940",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/manuelz120/CVE-2022-23940",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/salesagility/SuiteCRM-Core/commit/5fa70e2794a022003561fe1a701be9f4dcba9fc8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/salesagility/SuiteCRM-Core/releases/tag/v8.0.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/salesagility/SuiteCRM/releases/tag/v7.12.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/salesagility/suitecrm/commit/e93b269f637de313f45b32c58cef5ec012a34f58",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://suitecrm.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0629/default-remediation-status"
            }
        ]
    }
}