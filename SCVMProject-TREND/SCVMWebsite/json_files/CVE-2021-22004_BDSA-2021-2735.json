{
    "source": "BDSA",
    "name": "BDSA-2021-2735",
    "title": "SaltStack Salt Vulnerable to Behaviour Subversion via Config File Overwrite",
    "description": "SaltStack Salt is vulnerable to behaviour subversion. This allows an attacker to use a crafted minion config file in order to subvert the proper behavior of the given minion software.\n\n**Note:** The vendor has stated that to exploit this vulnerability it requires that a malicious user have access to a Windows system, permission to create directories and files on the root of the system drive, and create a minion config at `C:\\salt\\conf`.",
    "technicalDescription": "This vulnerability exists due to insufficient checks to verify the owner of an existing config file in the `getExistingMinionConfig()` function of file `pkg/windows/installer/Salt-Minion-Setup.nsi`. An attacker can take advantage of this by creating a malicious minion config at `C:\\salt\\conf` before the salt minion installer is run. This new config file will be accepted by the installer, and allows the attacker to subvert the proper behavior of the given minion software.\n\nThe vendor has mitigated against this vulnerability by ensuring that the installer will verify that the owner of the `C:\\salt\\conf` directory is either the Administrators group or the Local System account. If the ownership is not either of these options then the user will be prompted to rename the config directory and the default config will be used.",
    "publishedDate": "2021-09-09T15:05:40.569Z",
    "updatedDate": "2021-10-04T15:27:21.596Z",
    "disclosureDate": "2021-09-02T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3003.3**](https://github.com/saltstack/salt/releases/tag/v3003.3) by [this](https://github.com/saltstack/salt/commit/eaf3aec90121e568aa27a10c067ea62cf5101c08) commit,\n* [**3002.7**](https://github.com/saltstack/salt/releases/tag/v3002.7) by [this](https://github.com/saltstack/salt/commit/7c6b96890065b29c2a2cee06d6a12d41cbf7a9cb) commit,\n* [**3001.8**](https://github.com/saltstack/salt/releases/tag/v3001.8) by [this](https://github.com/saltstack/salt/commit/d199cb3186fa104122e9d793d14bf79621a2bebf) commit.\n\nThe latest stable releases are available [here](https://repo.saltproject.io/index.html)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Salt Windows Working Group",
    "workaround": "",
    "vendorFixDate": "2021-08-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2735",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-15"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22004",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2735/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/7c6b96890065b29c2a2cee06d6a12d41cbf7a9cb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/d199cb3186fa104122e9d793d14bf79621a2bebf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/eaf3aec90121e568aa27a10c067ea62cf5101c08",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/v3001.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/v3002.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/v3003.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://repo.saltproject.io/index.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://saltproject.io/security_announcements/salt-security-advisory-2021-sep-02/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2735/default-remediation-status"
            }
        ]
    }
}