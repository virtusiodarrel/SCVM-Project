{
    "source": "BDSA",
    "name": "BDSA-2020-1469",
    "title": "Apache Archiva Vulnerable to LDAP Injection via Login Functionality",
    "description": "Apache Archiva contains an LDAP injection vulnerability in its login functionality due to a lack of validation of user controlled data. An attacker could include malicious input to obtain sensitive user data.\n\nThis issue occurs in the Apache Archiva Redback component.",
    "technicalDescription": "This issue occurs due to a lack of validation of user controlled input in the login form, including the user name, full name and email. The `authenticate()` function in `redback-authentication/redback-authentication-providers/redback-authentication-ldap/src/main/java/org/apache/archiva/redback/authentication/ldap/LdapBindAuthenticator.java` and `getLdapFilter()` in `redback-users/redback-users-providers/redback-users-ldap/src/main/java/org/apache/archiva/redback/users/ldap/LdapUserQuery.java` do not validate user controlled data before using that data in an LDAP query. \n\nThis issue could allow an attacker to insert malicious code into the LDAP query, which could allow the attacker to obtain user attribute data from the LDAP server. It is possible for arbitrary attribute data to be obtained from user objects due to timing attacks on the LDAP query.",
    "publishedDate": "2020-06-22T13:51:41.373Z",
    "updatedDate": "2021-06-01T16:02:35.911Z",
    "disclosureDate": "2020-06-19T00:00:00.000Z",
    "solution": "Fixed in Apache Archiva version [**2.2.5**](https://github.com/apache/archiva/releases/tag/archiva-2.2.5) by [this](https://github.com/apache/archiva/commit/63d950f8cab37c1b0ea9623e642d7a452ca6cc62) commit.\n\nThe latest stable releases are available [here](http://archiva.apache.org/download.cgi).\n\nFixed in Apache Archiva Redback version [**2.6.1**](https://github.com/apache/archiva-redback-core/releases/tag/redback-2.6.1) by [this](https://github.com/apache/archiva-redback-core/commit/68a7bc4c2ad5a01e8b61431dc0cd3d1809eaa7f1) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-05-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1469",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-90"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-9495",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1469/ranges"
            },
            {
                "rel": "reference",
                "href": "http://archiva.apache.org/download.cgi",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://archiva.apache.org/security.html#CVE-2020-9495",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/archiva-redback-core/commit/68a7bc4c2ad5a01e8b61431dc0cd3d1809eaa7f1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/archiva-redback-core/releases/tag/redback-2.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/archiva/commit/63d950f8cab37c1b0ea9623e642d7a452ca6cc62",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/archiva/releases/tag/archiva-2.2.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1469/default-remediation-status"
            }
        ]
    }
}