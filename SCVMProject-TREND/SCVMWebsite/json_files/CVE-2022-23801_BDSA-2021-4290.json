{
    "source": "BDSA",
    "name": "BDSA-2021-4290",
    "title": "Joomla! Vulnerable to Cross-Site Scripting (XSS) via 'SVG' File in 'MediaHelper.php'",
    "description": "Joomla! is vulnerable to cross-site scripting (XSS). This could allow an authenticated attacker to execute arbitrary code and obtain sensitive information such as authentication tokens and user session cookies or manipulate how pages are rendered.",
    "technicalDescription": "The vulnerability exists in the file `libraries/src/Helper/MediaHelper.php` within the function `canUpload()`. Due to improper validation of file extensions an authenticated attacker can exploit this vulnerability using an SVG file type by storing malicious scripts within it to steal a users session or other sensitive information.\n\nThis has been mitigated by applying appropriate sanitizing techniques where an `SVG` file type is used for upload. This will validate that the file is indeed a valid SVG to prevent XSS from being executed.",
    "publishedDate": "2022-03-31T15:42:34.922Z",
    "updatedDate": "2022-03-31T15:42:34.910Z",
    "disclosureDate": "2022-03-29T00:00:00.000Z",
    "solution": "Fixed in version [**4.1.1**](https://github.com/joomla/joomla-cms/releases/tag/4.1.1) by [this](https://github.com/joomla/joomla-cms/commit/f49c451d1ecb5dcc28b6a99a9e33ef75dd6b4f45) commit.\n\nThe latest stable releases can be found [here](https://github.com/joomla/joomla-cms/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Julia Polner, Simon Stockhause",
    "workaround": "",
    "vendorFixDate": "2022-03-29T00:00:00.000Z",
    "vendorNotifiedDate": "2021-08-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4290",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23801",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4290/ranges"
            },
            {
                "rel": "reference",
                "href": "https://developer.joomla.org/security-centre/878-20220309-core-xss-attack-vector-through-svg.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/joomla/joomla-cms/commit/f49c451d1ecb5dcc28b6a99a9e33ef75dd6b4f45",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/joomla/joomla-cms/releases/tag/4.1.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/joomla/joomla-cms/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.joomla.org/announcements/release-news/5857-joomla-4-1-1-and-3-10-7-release.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4290/default-remediation-status"
            }
        ]
    }
}