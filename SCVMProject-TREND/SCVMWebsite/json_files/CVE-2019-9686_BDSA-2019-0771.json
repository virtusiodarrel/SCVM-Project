{
    "source": "BDSA",
    "name": "BDSA-2019-0771",
    "title": "Pacman Vulnerable to Arbitrary Code Execution via Directory Traversal in 'lib/libalpm/dload.c' File",
    "description": "Pacman is vulnerable to arbitrary code execution. An unauthenticated remote attacker could execute arbitrary code using a crafted file on the system due to insufficient validation of user supplied input.",
    "technicalDescription": "The vulnerability exists in the `curl_download_internal` function in the `lib/libalpm/dload.c` file.\n\nAn attacker with sufficient network access to perform a man-in-the-middle attack or control of the remote package server could exploit this vulnerability by sending a crafted content disposition header. \n\nWhen a user executes the` pacman -U url` command to install a remote package, pacman renames the package file to match the name supplied in the header. This allows the attacker to place the file anywhere in the file system because pacman doesn't sanitize the name from the header.\n\nExploiting this could allow the attacker to execute arbitrary code with root privileges.",
    "publishedDate": "2019-03-25T10:18:48.864Z",
    "updatedDate": "2019-03-25T10:18:48.850Z",
    "disclosureDate": "2019-03-11T00:00:00.000Z",
    "exploitPublishDate": "2019-03-01T00:00:00.000Z",
    "solution": "Fixed in version [**5.1.3**](https://git.archlinux.org/pacman.git/tag/?h=v5.1.3) by [this](https://git.archlinux.org/pacman.git/commit/?id=9702703633bec2c007730006de2aeec8587dfc84) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.6,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Adam Suhl",
    "workaround": "",
    "vendorFixDate": "2019-03-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0771",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9686",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0771/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.archlinux.org/pacman.git/commit/?id=9702703633bec2c007730006de2aeec8587dfc84",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.archlinux.org/pacman.git/commit/?id=9702703633bec2c007730006de2aeec8587dfc84",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.archlinux.org/pacman.git/tag/?h=v5.1.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://security.archlinux.org/ASA-201903-7",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://tools.cisco.com/security/center/viewAlert.x?alertId=59781&vs_f=Alert%20RSS&vs_cat=Security%20Intelligence&vs_type=RSS&vs_p=Arch%20Linux%20pacman%20Remote%20Installation%20Directory%20Traversal",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0771/default-remediation-status"
            }
        ]
    }
}