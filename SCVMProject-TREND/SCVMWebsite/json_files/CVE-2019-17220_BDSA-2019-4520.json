{
    "source": "BDSA",
    "name": "BDSA-2019-4520",
    "title": "Rocket.Chat Vulnerable to Cross-Site Scripting (XSS) via Improper Validation of Headers",
    "description": "Rocket.Chat contains a cross-site scripting (XSS) vulnerability in the title line due to lack of sanitization of user-supplied input. An attacker can exploit this by executing malicious scripts in the context of the browser, allowing the theft of session tokens, cookies and sensitive information.",
    "technicalDescription": "This can be exploited by including a script in the URL using ` ![title] ` and injecting malicious scripts that can then be executed in the victim's browser. This could allow the attacker to obtain sensitive information, such as browser cookies. The vendor has addressed this by introducing header protection for old browsers within the file `app/cors/server/cors.js`.",
    "publishedDate": "2020-07-31T15:26:23.347Z",
    "updatedDate": "2020-07-31T15:26:23.342Z",
    "disclosureDate": "2019-10-03T00:00:00.000Z",
    "exploitPublishDate": "2019-10-03T00:00:00.000Z",
    "solution": "Fixed in [**2.2.0-RC0**](https://github.com/RocketChat/Rocket.Chat/releases/tag/2.2.0-rc.0) by [this](https://github.com/RocketChat/Rocket.Chat/commit/da6025e2e53771294fd3fcc99a41d8701ba4aeea) commit.\n\nThe latest stable releases are available [here](https://github.com/RocketChat/Rocket.Chat/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "3H34N",
    "workaround": "",
    "vendorFixDate": "2019-10-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4520",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-17220",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4520/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat/commit/da6025e2e53771294fd3fcc99a41d8701ba4aeea",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat/pull/15498",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat/releases/tag/2.2.0-rc.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/47537",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/47537",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4520/default-remediation-status"
            }
        ]
    }
}