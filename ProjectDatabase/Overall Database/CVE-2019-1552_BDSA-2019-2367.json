{
    "source": "BDSA",
    "name": "BDSA-2019-2367",
    "title": "OpenSSL Vulnerable to Arbitrary Config/CA Cert/Engine Module Modifications via Insecure Path Defaults",
    "description": "OpenSLL is vulnerable to arbitrary modifications due to use of insecure default paths when being built as part of an application in Mingw on Windows. Mingw configuration targets erroneously assumes that resulting programs and libraries are installed in a Unix-like environment and point to a directory that may be world-writable. This can allow a local attacker to perform arbitrary modifications by tampering with the files in these directories.",
    "technicalDescription": "OpenSSL has internal defaults for a directory path where it can find a configuration file and certificates used for verification in TLS, commonly known as OPENSSLDIR. In current implementation, mingw configuration targets erroneously use a default Unix path `/usr/local`. Since mingw programs are Windows programs, they will end up looking at sub-directories of `C:/usr/local` which may be world-writable. A local attacker could leverage this flaw to introduce arbitrary modification into a solution, e.g. modify OpenSSL's default configuration, insert CA certificates, or modify (or replace) existing engine modules.",
    "publishedDate": "2019-07-31T14:52:29.449Z",
    "updatedDate": "2019-09-19T10:51:51.352Z",
    "disclosureDate": "2019-07-30T00:00:00.000Z",
    "solution": "Fixed in [**1_1_0l**](https://git.openssl.org/?p=openssl.git;a=summary) by [this](https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=e32bc855a81a2d48d215c506bdeb4f598045f7e9 ) and [this](https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=b15a19c148384e73338aa7c5b12652138e35ed28) commit.\n\nFixed in [**1_1_1d**](https://git.openssl.org/?p=openssl.git;a=summary) by [this](https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=54aa9d51b09d67e90db443f682cface795f5af9e) commit.\n\nPlease note that [**1_0_2t**](https://git.openssl.org/?p=openssl.git;a=summary) adds [this](https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=d333ebaf9c77332754a9d5e111e2f53e1de54fdd) commit, which only adds more documentation and examples without actually remediating the issue.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.2,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 0.9
        },
        "vector": "(AV:L/AC:H/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.7,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.1
        },
        "vector": "CVSS:3.0/AV:L/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rich Mirch",
    "workaround": "Use `--openssldir=/safe/path` to change OPENSSLDIR to a non-default location with properly set permissions.",
    "vendorFixDate": "2019-07-27T00:00:00.000Z",
    "vendorNotifiedDate": "2019-06-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.1,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2367",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-15"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-1552",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2367/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=54aa9d51b09d67e90db443f682cface795f5af9e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=b15a19c148384e73338aa7c5b12652138e35ed28",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=d333ebaf9c77332754a9d5e111e2f53e1de54fdd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=e32bc855a81a2d48d215c506bdeb4f598045f7e9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.mail-archive.com/openssl-users@openssl.org/msg86649.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.openssl.org/news/secadv/20190730.txt",
                "label": "ADVISORY"
            }
        ]
    }
}