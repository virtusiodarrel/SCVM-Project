{
    "source": "BDSA",
    "name": "BDSA-2022-0173",
    "title": "Grafana Vulnerable to Information Disclosure via 'Forward OAuth Identity' Token",
    "description": "An information disclosure vulnerability has been discovered in Grafana. If a data source has the `Forward OAuth Identity` token feature enabled it is possible to send a query to that datasource with an API token and this will result in the OAuth Identity of the most recently logged-in user being forwarded. An attacker that holds an API token could exploit this in order to improperly gain the ability to retrieve data. \n\nSuccessful exploitation requires the Grafana instance to have data sources that support the `Forward OAuth Identity` feature, and that the feature is toggled on, that OAuth is enabled, and that the instance has usable API keys.",
    "technicalDescription": "",
    "publishedDate": "2022-01-19T15:48:43.761Z",
    "updatedDate": "2022-01-19T15:48:43.752Z",
    "disclosureDate": "2022-01-18T00:00:00.000Z",
    "solution": "Fixed in [**8.3.4**](https://github.com/grafana/grafana/releases/tag/v8.3.4).\nFixed in [**7.5.13**](https://github.com/grafana/grafana/releases/tag/v7.5.13).\n\nThe latest stable releases can be found [here](https://github.com/grafana/grafana/tags).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "mxalis",
    "workaround": "Administrators of Grafana instances are able to limit the availability of API tokens used to exploit this vulnerability.",
    "vendorFixDate": "2022-01-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0173",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-21673",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0173/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/commit/66ae92abe9aa748bc7c909d73064f5cb6ee5d3ce",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/tag/v7.5.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/releases/tag/v8.3.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/security/advisories/GHSA-8wjh-59cw-9xh4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/security/advisories/GHSA-8wjh-59cw-9xh4",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/grafana/grafana/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0173/default-remediation-status"
            }
        ]
    }
}