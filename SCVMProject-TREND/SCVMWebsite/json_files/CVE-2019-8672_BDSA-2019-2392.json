{
    "source": "BDSA",
    "name": "BDSA-2019-2392",
    "title": "WebKitGTK+ and WPE WebKit Vulnerable to Arbitrary Code Execution via Use-After-Free with 'ValueProfiles' Structure",
    "description": "WebKitGTK+ and WPE WebKit are vulnerable to arbitrary code execution due to improper exception handling and garbage collection in the Baseline Just In Time (JIT) compiler. An attacker could exploit this vulnerability by supplying a victim with maliciously crafted JavaScript.",
    "technicalDescription": "The Baseline JIT compiler incorrectly processes `ValueProfile` structures within the file `Source/JavaScriptCore/jit/JIT.cpp`, which are attached to bytecode operations and keep track of input types that have been observed for each operation. The compiler performs a stack overflow check after value profiling but before a write barrier, which ensures that value profiles are properly updated. This exposes an issue with the garbage collector where `ValueProfiles` may not be properly cleared following a stack overflow exception, which can leave a dangling pointer in the `ValueProfile` and result in a use-after free when the structure is accessed during the next collection cycle.",
    "publishedDate": "2019-08-05T13:39:41.658Z",
    "updatedDate": "2021-10-01T16:00:49.832Z",
    "disclosureDate": "2019-07-29T00:00:00.000Z",
    "exploitPublishDate": "2019-07-29T00:00:00.000Z",
    "solution": "Fixed in WebKitGTK+ version **[2.24.2](https://webkitgtk.org/releases/)** by [this](https://trac.webkit.org/changeset/244865/webkit) commit.\n\nFixed in WPE WebKit version **[2.24.2](https://wpewebkit.org/releases/)**.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Samuel Gro\u00df (Google Project Zero)",
    "workaround": "",
    "vendorFixDate": "2019-05-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2392",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-8672",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2392/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1825",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1825",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://trac.webkit.org/changeset/244865/webkit",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://webkitgtk.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://webkitgtk.org/security/WSA-2019-0004.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://wpewebkit.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://wpewebkit.org/security/WSA-2019-0004.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2392/default-remediation-status"
            }
        ]
    }
}