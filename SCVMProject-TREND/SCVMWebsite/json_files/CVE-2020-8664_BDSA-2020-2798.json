{
    "source": "BDSA",
    "name": "BDSA-2020-2798",
    "title": "Envoy Vulnerable to Unauthorized Access to Services via Missing Update Callback",
    "description": "Envoy is vulnerable to an unauthorized access scenario due to how the update callback for the SDS TLS validation context is only called when the secret is received for the first time, or when its value has changed.\n\nThis issue leads to a complete bypass of rules from the static (`default`) part of the validation context and could allow an attacker to access resources or services without the correct permissions.",
    "technicalDescription": "Envoy is vulnerable to unauthorized access to services because the update callback for the SDS TLS validation context is only called when the secret is received for the first time, or when its value has changed. If the same secret has been used in multiple resources, these resources can remain in an unconfigured state if they were initially configured after the secret was received.\n\nThis issue results in the rules from the dynamic (`secret`) part of the validation context applying, whereas the rules from the static (`default` part of the validation context do not.",
    "publishedDate": "2020-10-16T15:08:11.113Z",
    "updatedDate": "2020-10-16T15:08:11.104Z",
    "disclosureDate": "2020-03-03T00:00:00.000Z",
    "solution": "Fixed in [**1.13.1**](https://github.com/envoyproxy/envoy/releases/tag/v1.13.1) by [this](https://github.com/envoyproxy/envoy/commit/f67a19a777eb2a552954de60a052460af813cedb) commit.\n\nFixed in [**1.12.3**](https://github.com/envoyproxy/envoy/releases/tag/v1.12.3) by [this](https://github.com/envoyproxy/envoy/commit/b49b56079c6eb65f7a5f7d06eaa8078c1045c4cc) commit.\n\nThe latest stable releases are available [here](https://github.com/envoyproxy/envoy/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andon Andonov (Microsoft), Ryan Michela (Salesforce), Scott Beardsley (Pinterest), Jasper Misset (Visma Connect)",
    "workaround": "",
    "vendorFixDate": "2020-03-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2798",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8664",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2798/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/b49b56079c6eb65f7a5f7d06eaa8078c1045c4cc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/f67a19a777eb2a552954de60a052460af813cedb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.12.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.13.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-3x9m-pgmg-xpx8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.envoyproxy.io/docs/envoy/v1.12.3/intro/version_history#march-3-2020",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.envoyproxy.io/docs/envoy/v1.13.1/intro/version_history#march-3-2020",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2798/default-remediation-status"
            }
        ]
    }
}