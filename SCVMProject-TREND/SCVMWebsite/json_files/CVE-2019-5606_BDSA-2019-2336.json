{
    "source": "BDSA",
    "name": "BDSA-2019-2336",
    "title": "FreeBSD Vulnerable to Privilege Escalation via Write-After-Free due to Improper I/O Device Management",
    "description": "FreeBSD is vulnerable to privilege escalation due to the improper management of system resources when conducting device management. A local attacker could obtain root privileges, or could carry out a jailbreak, by manipulating in-memory resources on the target system.",
    "technicalDescription": "FreeBSD makes use of the `posix_openpt` system call in order to obtain a file descriptor for a pseudo-terminal device. Whenever the handle to this device is being closed, the program fails to undo the configuration which can allow other processes to send a SIGIO signal asynchronously. This problem arises due to the fact that the code that is designed to stop this from occurring is improperly implemented. This code can be found in the function `ttydev_leave()`, which is defined in the script `tty.c`. This code calls the function `funsetown()` using a memory reference to the `t_sigio` component of the `tp` structure. This function call should in fact be called just before the TTY deallocation event, which takes place within the function `tty_rel_free()`. An attacker could exploit this flaw to write to a particular section of freed memory, which could potentially allow them to obtain root privileges or conduct a jailbreak. A local attacker could achieve this by manipulating the process's in-memory resource by running a malicious binary.",
    "publishedDate": "2019-07-26T14:37:41.958Z",
    "updatedDate": "2019-07-26T14:37:41.950Z",
    "disclosureDate": "2019-07-24T00:00:00.000Z",
    "solution": "Fixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=349805) commit in the `stable/12/` branch which is not yet included in any release.\n\nFixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=350282) commit in the `releng/12.0/` branch which is not yet included in any release.\n\nFixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=349806) commit in the `stable/11/` branch which is not yet included in any release.\n\nFixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=350282) commit in the `releng/11.2/` branch which is not yet included in any release.\n\nFixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=350282) commit in the `releng/11.3/` branch which is not yet included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:L/AC:L/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-07-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2336",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-265"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5606",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2336/ranges"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=349805",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=349806",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=350282",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-19:13.pts.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2336/default-remediation-status"
            }
        ]
    }
}