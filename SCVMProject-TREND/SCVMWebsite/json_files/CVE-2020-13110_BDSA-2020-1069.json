{
    "source": "BDSA",
    "name": "BDSA-2020-1069",
    "title": "NPM Kerberos Module Vulnerable to Arbitrary Code Execution via DLL Injection",
    "description": "The Kerberos module for Node.js is vulnerable to arbitrary code execution due to the package loading DLLs without specifying the full file path. An attacker could exploit this vulnerability by creating files with the same name in a folder that will be found before the legitimate file which will be loaded into the application and execute arbitrary code.",
    "technicalDescription": "This DLL injection vulnerability exists in the `LoadLibrary` method in `kerberos_sspi`, Security Support Provider Interface (SSPI). An attacker is able to exploit the search order of this method by injecting malicious DLLs  which can be loaded before legitimate ones by providing a full file path. Once `LoadLibrary` searches through the directories and matches on the DLL it is searching for, it stops searching and loads this DLL into memory. If this is a malicious DLL this can result in arbitrary code injection and privilege escalation.",
    "publishedDate": "2020-05-13T10:14:28.398Z",
    "updatedDate": "2021-07-14T15:15:05.863Z",
    "disclosureDate": "2020-05-11T00:00:00.000Z",
    "solution": "Fixed in [**1.0.0**](https://github.com/mongodb-js/kerberos/releases/tag/v1.0.0).\n\nThe latest stable releases are available [here](https://github.com/mongodb-js/kerberos).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.4,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Dan Shallom, OP Innovate Ltd",
    "workaround": "",
    "vendorFixDate": "2018-08-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1069",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-114"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13110",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1069/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb-js/kerberos",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mongodb-js/kerberos/releases/tag/v1.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://medium.com/@kiddo_Ha3ker/dll-injection-attack-in-kerberos-npm-package-cb4b32031cd",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/advisories/1514",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1069/default-remediation-status"
            }
        ]
    }
}