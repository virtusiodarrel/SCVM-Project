{
    "source": "BDSA",
    "name": "BDSA-2022-2079",
    "title": "Moodle Vulnerable to Stored Cross-Site Scripting (XSS) and Blind Server-Side Request Forgery (SSRF) via SCORM Track Details",
    "description": "Moodle is vulnerable to stored cross-site scripting (XSS) and blind server-side request forgery (SSRF). This could allow an attacker to execute arbitrary code to obtain sensitive information such as authentication tokens and user session cookies. An attacker can further leverage this issue via SSRF to access internal resources remotely which would otherwise not be accessible.",
    "technicalDescription": "The vulnerable files are `mod/scorm/lib.php` and `mod/scorm/report/userreporttracks.php` as it contains insufficient escaping of user-supplied data in `$element` and `$value`.\n\nThis was mitigated in the same files by adding correct validation and escaping the output of `$element` and `$value` in `mod/scorm/lib.php` and `$element` in `mod/scorm/report/userreporttracks.php`.",
    "publishedDate": "2022-07-26T14:06:20.507Z",
    "updatedDate": "2022-08-24T11:28:03.757Z",
    "disclosureDate": "2022-07-18T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.9.15**](https://github.com/moodle/moodle/releases/tag/v3.9.15) by [this](https://github.com/moodle/moodle/commit/f9ca67a78d6aae5ade74bba54bf86a97f7fd0ee0) commit.\n* [**3.11.8**](https://github.com/moodle/moodle/releases/tag/v3.11.8) by [this](https://github.com/moodle/moodle/commit/0f4e8413fcb0b66b0e4d0a816e099f4fc754f1e5) commit.\n* [**4.0.2**](https://github.com/moodle/moodle/releases/tag/v4.0.2) by [this](https://github.com/moodle/moodle/commit/7be2023401d8ef76e1e7de0b9b5491ce7e26540b) commit.\n\nThe latest stable releases can be found [here](https://github.com/moodle/moodle/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.3,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Rekter0",
    "workaround": "",
    "vendorFixDate": "2022-07-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2079",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-35651",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2079/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/0f4e8413fcb0b66b0e4d0a816e099f4fc754f1e5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/7be2023401d8ef76e1e7de0b9b5491ce7e26540b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/commit/f9ca67a78d6aae5ade74bba54bf86a97f7fd0ee0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.11.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v3.9.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/releases/tag/v4.0.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/moodle/moodle/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=436458",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2079/default-remediation-status"
            }
        ]
    }
}