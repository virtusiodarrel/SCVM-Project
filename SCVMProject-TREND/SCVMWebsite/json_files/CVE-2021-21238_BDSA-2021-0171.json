{
    "source": "BDSA",
    "name": "BDSA-2021-0171",
    "title": "pysaml2 Vulnerable to Improper Verification of Cryptographic Signature via 'xmlsec1'",
    "description": "pysaml2 contains an improper verification of cryptographic signature vulnerability . An attacker could exploit this to provide an invalid SAML XML document. \n\n**Note:** This vulnerability only affects users of pysaml2 that use the default `CryptoBackendXmlSec1` backend",
    "technicalDescription": "This vulnerability exists when verifying signed SAML documents against an XML schema when using the `CryptoBackendXmlSec1` backend. The `xmlsec1`  is used to verify the signature of signed SAML XML documents, however `xmlsec1` will accept the first signature it finds in the given document as valid.  \n\nThe vendor has mitigated against this by ensuring that XML documents are validated before verifying the signature.",
    "publishedDate": "2021-01-22T12:26:11.722Z",
    "updatedDate": "2021-01-22T12:26:11.716Z",
    "disclosureDate": "2021-01-20T00:00:00.000Z",
    "solution": "Fixed in [**6.5.0**](https://github.com/IdentityPython/pysaml2/releases/tag/v6.5.0) by [this](https://github.com/IdentityPython/pysaml2/commit/1d8fd268f5bf887480a403a7a5ef8f048157cc14) commit.\n\nThe latest stable releases are available [here](https://pypi.org/project/pysaml2/#files).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Victor Sch\u00f6nfelder Garcia, Juraj Somorovsky, Vladislav Mladenov",
    "workaround": "",
    "vendorFixDate": "2021-01-20T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0171",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-347"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21238",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0171/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/IdentityPython/pysaml2/commit/1d8fd268f5bf887480a403a7a5ef8f048157cc14",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/IdentityPython/pysaml2/releases/tag/v6.5.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/IdentityPython/pysaml2/security/advisories/GHSA-f4g9-h89h-jgv9",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://pypi.org/project/pysaml2/#files",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0171/default-remediation-status"
            }
        ]
    }
}