{
    "source": "BDSA",
    "name": "BDSA-2022-0762",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via Use-After-Free in FUSE Filesystem 'write()' Implementation",
    "description": "The Linux kernel is vulnerable to information exposure due to the improper implementation of the `write()` system call for the FUSE file system. A local attacker could potentially elevate their privileges to that of the root user, or could recover data from kernel memory, by executing a malicious binary on a vulnerable system.",
    "technicalDescription": "The function `fuse_get_user_pages()`, of file `fs/fuse/file.c`, retrieves the contents of a buffer from userspace in response to a `write()` system call involving a FUSE file system. The data is retrieved using references to userspace pages. The data that the FUSE file system writes to the userspace buffer can then be sent to userspace via the `fuse_dev_read()` or `fuse_dev_splice_read()` functions, the latter of which uses pipe buffers to provide the data.\nHowever, userspace will lose its access to the pipe buffers once  `fuse_dev_do_read()` marks the request as being complete (which will cause the `write()` system call to return). This can lead to a user-after-free whenever userspace code attempts to access the data. An attacker could potentially leverage this issue in order to elevate their privileges, or to recover sensitive data from kernelspace memory.",
    "publishedDate": "2022-03-21T15:22:25.034Z",
    "updatedDate": "2022-07-19T10:55:06.381Z",
    "disclosureDate": "2022-03-07T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.9.320**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.9.320) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b79d4d0da659) commit,\n* [**4.14.276**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.14.276) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0ab55e14cf5f) commit,\n* [**4.19.238**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.19.238) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=99db28212be6) commit,\n* [**5.4.185**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.4.185) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a9174077febf) commit,\n* [**5.10.106**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.10.106) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ab5595b45f73) commit,\n* [**5.15.29**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.15.29) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ca62747b38f5) commit,\n* [**5.16.15**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.16.15) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=58a9bdff32fd) commit,\n* [**5.17-rc8**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.17-rc8) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0c4bcfdecb1a) commit.\n\nThe latest stable releases are available [here](https://www.kernel.org/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Jann Horn",
    "workaround": "",
    "vendorFixDate": "2022-03-07T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-0762",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2022-1011",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-0762/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/mszeredi/fuse.git/commit/?h=for-next",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0ab55e14cf5f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0c4bcfdecb1a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=58a9bdff32fd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=99db28212be6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a9174077febf",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ab5595b45f73",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b79d4d0da659",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c3021629a0d8",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ca62747b38f5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.14.276",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.19.238",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v4.9.320",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.10.106",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.15.29",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.16.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.17-rc8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.4.185",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}