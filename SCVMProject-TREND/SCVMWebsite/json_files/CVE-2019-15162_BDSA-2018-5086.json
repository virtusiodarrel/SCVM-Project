{
    "source": "BDSA",
    "name": "BDSA-2018-5086",
    "title": "libpcap Vulnerable to Information Disclosure via Error Reporting in 'daemon_AuthUserPwd()' Function",
    "description": "libpcap is vulnerable to information disclosure due to the unsafe utilization of error messages. A remote attacker could infer whether or not a certain user name is valid  by attempting to authenticate with that user name and then observing the application's response. This could assist an attacker in conducting brute force attacks. It should be noted that this vulnerability only affects non-Windows platforms.",
    "technicalDescription": "The function `daemon_AuthUserPwd()`, which is defined within the script `daemon.c`, is called by libpcap whenever a remote client is being authenticated. The client will provide a user name and password, and `daemon_AuthUserPwd()` will call the `LogonUser()` function in order to evaluate the validity of those credentials. If this function returns `0`, `daemon_AuthUserPwd()` will call the function `pcap_fmt_errmsg_for_win32_err()` in order to print an error message. This error message can leak information regarding the validity of the user name that was supplied. In addition to this, error messages that potentially constitute an information leak can be printed if the functions `getpwnam()`or `getspnam()` evaluate to `NULL`, or in conditions where the values of the variables `user_password` and `crypt_password` do not match.\n\nThese information leaks could potentially assist an attacker in conducting a remote brute force attack, by letting them know if the user name they have supplied is invalid.",
    "publishedDate": "2019-10-11T15:37:48.185Z",
    "updatedDate": "2019-10-11T15:37:48.174Z",
    "disclosureDate": "2018-08-06T00:00:00.000Z",
    "solution": "Fixed in version [**1.9.1**](https://github.com/the-tcpdump-group/libpcap/releases/tag/libpcap-1.9.1) by [this](https://github.com/the-tcpdump-group/libpcap/commit/484d60cbf7ca4ec758c3cbb8a82d68b244a78d58) commit.\n\nThe latest release can be found [here](https://github.com/the-tcpdump-group/libpcap/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Include Security F11",
    "workaround": "",
    "vendorFixDate": "2018-08-06T00:00:00.000Z",
    "vendorNotifiedDate": "2018-08-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5086",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-209"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15162",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5086/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/blob/libpcap-1.9/CHANGES",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/commit/484d60cbf7ca4ec758c3cbb8a82d68b244a78d58",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/the-tcpdump-group/libpcap/releases/tag/libpcap-1.9.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2018-5086/default-remediation-status"
            }
        ]
    }
}