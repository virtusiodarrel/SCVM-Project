{
    "source": "BDSA",
    "name": "BDSA-2019-2906",
    "title": "OpenSSL Vulnerable to Padding Oracle Crypto Attack via 'PKCS7_dataDecode' and 'CMS_decrypt_set1_pkey' Functions",
    "description": "OpenSSL is vulnerable to a padding oracle crypto attack via the `PKCS7_dataDecode` and `CMS_decrypt_set1_pkey` functions . An attacker could take advantage of this to decrypt sensitive information. \n\nApplications are not affected if they use a certificate as well as the private RSA key to the `CMS_decrypt` or `PKCS7_decrypt` functions to select the correct recipient info to decrypt.",
    "technicalDescription": "This vulnerability is exploitable in a scenario where an attacker receives some indication of whether or not a decryption attempt has succeeded or failed.  By sending a very large number of messages to be decrypted an attacker could recover a CMS/PKCS7 transported encryption key or decrypt any RSA-encrypted message with the public RSA key. \n\nAn attack is straightforward if the first `CMS_RecipientInfo` is valid but the second one is the chosen ciphertext. If the second `CMS_RecipientInfo` decodes to PKCS #1v1.5 then the correct encryption will  be replaced by garbage and the message will be impossible to decode. However if the RSA decryption fails then the correct encryption key is used and the recipient will be unaware of the attack.",
    "publishedDate": "2019-09-11T11:42:06.149Z",
    "updatedDate": "2019-09-11T11:42:06.138Z",
    "disclosureDate": "2019-09-10T00:00:00.000Z",
    "solution": "Fixed in [1.1.1d](https://github.com/openssl/openssl/releases/tag/OpenSSL_1_1_1d) and [1.1.0l](https://github.com/openssl/openssl/releases/tag/OpenSSL_1_1_0l) and [1.0.2t](https://github.com/openssl/openssl/releases/tag/OpenSSL_1_0_2t) by [this](https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=5840ed0cd1e6487d247efbc1a04136a41d7b3a37) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Bernd Edlinger",
    "workaround": "As a work around for this potential attack the length of the decrypted key must be equal to the cipher default key length.",
    "vendorFixDate": "2019-08-31T00:00:00.000Z",
    "vendorNotifiedDate": "2019-08-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2906",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-310"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-1563",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2906/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=5840ed0cd1e6487d247efbc1a04136a41d7b3a37",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=5840ed0cd1e6487d247efbc1a04136a41d7b3a37",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/pull/9777",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/releases/tag/OpenSSL_1_0_2t",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/releases/tag/OpenSSL_1_1_0l",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openssl/openssl/releases/tag/OpenSSL_1_1_1d",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openssl.org/news/secadv/20190910.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2906/default-remediation-status"
            }
        ]
    }
}