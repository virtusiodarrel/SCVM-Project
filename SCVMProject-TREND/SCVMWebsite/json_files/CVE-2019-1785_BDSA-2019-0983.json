{
    "source": "BDSA",
    "name": "BDSA-2019-0983",
    "title": "ClamAV RAR File Scanning Functionality Vulnerable to Path Traversal Via cli_genfname()",
    "description": "ClamAV is vulnerable to a path traversal vulnerability. An attacker could exploit this to cause the output of a scan to be placed in an arbitrary directory.",
    "technicalDescription": "When ClamAV scans a RAR file, it creates a temporary file for each scanned file.\n\nThe `cli_gentemp_with_prefix` function causes the temporary files which are created to have their name prefixed with the name of the original file that was scanned.\n\nThe file name is then placed in a file path that is used to decide where to place the temporary file. Due to the file name containing a path separator, and it being inserted directly into this path name, an attacker can supply a file with a crafted name and cause a temporary file to be created at an arbitrary location. \n\nIf ClamAV is being run with higher privileges than the attacker's privilege level it is feasible that an attacker could cause files to be created in directories which they would not normally have access to.\n\nThis was fixed by checking for path separators and other characters associated with absolute and relative path traversal.",
    "publishedDate": "2019-04-15T13:04:04.224Z",
    "updatedDate": "2019-04-15T14:41:45.797Z",
    "disclosureDate": "2019-03-01T00:00:00.000Z",
    "exploitPublishDate": "2019-03-01T00:00:00.000Z",
    "solution": "Fixed in version [**0.101.2**](https://github.com/Cisco-Talos/clamav-devel/tree/clamav-0.101.2) by [this](https://github.com/Cisco-Talos/clamav-devel/commit/9180468ad68d5cb132cb6dc3cc629c9a4b763d14) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "aCaB",
    "workaround": "",
    "vendorFixDate": "2019-03-26T00:00:00.000Z",
    "vendorNotifiedDate": "2019-03-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.0,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0983",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-376"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-1785",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0983/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.clamav.net/show_bug.cgi?id=12284",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.clamav.net/show_bug.cgi?id=12284",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Cisco-Talos/clamav-devel/commit/9180468ad68d5cb132cb6dc3cc629c9a4b763d14",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Cisco-Talos/clamav-devel/tree/clamav-0.101.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0983/default-remediation-status"
            }
        ]
    }
}