{
    "source": "BDSA",
    "name": "BDSA-2021-2863",
    "title": "Nokogiri Vulnerable to Information Disclosure via  XML External Entities (XXE) via SAX Parser",
    "description": "Nokogiri on JRuby is vulnerable to XML external entities (XXE) attacks due to the Sax Parser resolving external entities by default. An attacker could exploit this flaw to leak potentially sensitive information.",
    "technicalDescription": "The vulnerability occurs due to the sax parser in the `ext/java/nokogiri/XmlSaxParserContext.java` file resolving external entities by default, The vulnerability affects users on JRuby who parse untrusted documents using any of the following classes:\n\n* Nokogiri::XML::SAX::Parse,\n* Nokogiri::HTML4::SAX::Parser or its alias Nokogiri::HTML::SAX::Parser, \n* Nokogiri::XML::SAX::PushParser,  \n* Nokogiri::HTML4::SAX::PushParser or its alias Nokogiri::HTML::SAX::PushParser\n\nThe issue was addressed by turning off entity-resolution-by-default in the JRuby SAX parsers to match the CRuby SAX parsers' behavior",
    "publishedDate": "2021-09-28T11:51:48.491Z",
    "updatedDate": "2021-09-28T11:51:48.482Z",
    "disclosureDate": "2021-09-27T00:00:00.000Z",
    "solution": "Fixed in version [**1.12.5**](https://github.com/sparklemotion/nokogiri/releases/tag/v1.12.5) by [this](https://github.com/sparklemotion/nokogiri/commit/4bd943cae3039c51c3f54de9cd76abbfb647666b) commit.\n\nThe latest stable releases can be found [here](https://github.com/sparklemotion/nokogiri/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Andrew Crewdson",
    "workaround": "",
    "vendorFixDate": "2021-09-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2863",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-611"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41098",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2863/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sparklemotion/nokogiri/commit/4bd943cae3039c51c3f54de9cd76abbfb647666b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sparklemotion/nokogiri/releases/tag/v1.12.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-2rr5-8q37-2w7h",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sparklemotion/nokogiri/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2863/default-remediation-status"
            }
        ]
    }
}