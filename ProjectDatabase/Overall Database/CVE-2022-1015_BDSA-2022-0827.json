{
    "source": "BDSA",
    "name": "BDSA-2022-0827",
    "title": "Linux Kernel Vulnerable to Arbitrary Code Execution via Out-of-Bounds Write in 'nft_validate_register_*' Functions",
    "description": "The Linux kernel is vulnerable to arbitrary code execution due to the insufficient validation of data that is received from userspace. A local attacker could write to, and read from, the stack by submitting crafted requests to the netfilter subsystem. This could allow the attacker to redirect execution to a location of their choosing.",
    "technicalDescription": "The function `nft_parse_register()`, of file `net/netfilter/nf_tables_api.c`, obtains the values of registers that have been set from userspace. These values are used to access data on the stack. The values are insufficiently validated prior to this. An attacker could use maliciously crafted register values in order to perform out-of-bounds read and write operations on stack data. This could allow the attacker to perform a pointer overwrite in order to redirect code execution to an address of their choosing. This could potentially allow the attacker to elevate their privileges to that of the root user.",
    "publishedDate": "2022-03-31T10:07:37.234Z",
    "updatedDate": "2022-07-29T09:53:24.726Z",
    "disclosureDate": "2022-03-17T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.15.32**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1bd57dea456149619f3b80d67eee012122325af8) commit\n* [**5.16.18**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2c8ebdaa7c9755b85d90c07530210e83665bad9a) commit\n* [**5.17.1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=afdc3f4b81f0ec9f97f0910476af4620a2481a6d) commit\n* [**5.18-rc1**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6e1acfa387b9ff82cfc7db8cc3b6959221a95851) commit\n\nThe latest stable releases are available [here](https://www.kernel.org).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.0,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-03-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-0827",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2022-1015",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-0827/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2065323",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1bd57dea456149619f3b80d67eee012122325af8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2c8ebdaa7c9755b85d90c07530210e83665bad9a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=345023b0db315648ccc3c1a36aee88304a8b4d91",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=49499c3e6e18b7677a63316f3ff54a16533dc28f",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6e1acfa387b9ff82cfc7db8cc3b6959221a95851",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=afdc3f4b81f0ec9f97f0910476af4620a2481a6d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.15.32",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.16.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.17.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "LINK"
            }
        ]
    }
}