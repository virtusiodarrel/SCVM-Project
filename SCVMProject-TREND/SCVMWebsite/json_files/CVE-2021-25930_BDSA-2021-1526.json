{
    "source": "BDSA",
    "name": "BDSA-2021-1526",
    "title": "OpenNMS Vulnerable to Account Removal via Cross-Site Request Forgery (CSRF) in User Management",
    "description": "OpenNMS is vulnerable to cross-site request forgery (CSRF). This could be exploited by an attacker to trick a user into executing unintentional actions.",
    "technicalDescription": "This vulnerability exists due to insufficient CSRF protection as well as insufficient validation of an existing user name while renaming a user. When a user is renamed, the `newName` parameter is sent to the endpoint at `/opennms/admin/userGroupView/users/renameUser`, where there is a insufficient validation to check whether the existing user names are present in the `m_users` map object. An attacker can exploit this in order to trick an admin user into renaming one user with an already existing users name and therefore deny the existing user from logging in and accessing the service.",
    "publishedDate": "2021-05-21T13:40:27.120Z",
    "updatedDate": "2021-08-19T15:05:17.308Z",
    "disclosureDate": "2021-01-23T00:00:00.000Z",
    "solution": "Fixed in OpenNMS [**27.1.1-1**](https://github.com/OpenNMS/opennms/releases/tag/opennms-27.1.1-1) by [this](https://github.com/OpenNMS/opennms/commit/607151ea8f90212a3fb37c977fa57c7d58d26a84) commit\n\nFixed in meridian-foundation [**2019.1.19-1**](https://github.com/OpenNMS/opennms/releases/tag/meridian-foundation-2019.1.19-1) by [this](https://github.com/OpenNMS/opennms/commit/eb08b5ed4c5548f3e941a1f0d0363ae4439fa98c) commit and [**2020.1.7-1**](https://github.com/OpenNMS/opennms/releases/tag/meridian-foundation-2020.1.7-1) by [this](https://github.com/OpenNMS/opennms/commit/607151ea8f90212a3fb37c977fa57c7d58d26a84) commit.\n\nThe latest stable releases are available [here](https://github.com/OpenNMS/opennms/releases)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-03-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1526",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-25930",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1526/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/commit/607151ea8f90212a3fb37c977fa57c7d58d26a84",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/commit/eb08b5ed4c5548f3e941a1f0d0363ae4439fa98c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/releases/tag/meridian-foundation-2019.1.19-1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/releases/tag/meridian-foundation-2020.1.7-1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenNMS/opennms/releases/tag/opennms-27.1.1-1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.opennms.org/browse/NMS-13124",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-25930",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1526/default-remediation-status"
            }
        ]
    }
}