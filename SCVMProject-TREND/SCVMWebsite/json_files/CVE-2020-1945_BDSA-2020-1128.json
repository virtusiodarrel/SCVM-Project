{
    "source": "BDSA",
    "name": "BDSA-2020-1128",
    "title": "Apache Ant Vulnerable to Information Disclosure via Default Temporary Directory Identified by 'java.io.tmpdir'",
    "description": "Apache Ant is vulnerable to information disclosure due to the usage of a default temporary directory for several tasks. Some tasks may also allow the integrity of a build to be damaged.",
    "technicalDescription": "The default temporary directory is identified by the Java system property `java.io.tmpdir` and may leak sensitive information. Tasks `fixcrlf` and `replaceregexp` also copy files from the temporary directory back into the build tree, allowing an attacker to inject modified source files into the build process.",
    "publishedDate": "2020-05-15T11:49:23.882Z",
    "updatedDate": "2020-11-05T10:27:58.044Z",
    "disclosureDate": "2020-05-13T00:00:00.000Z",
    "solution": "Fixed in [**1.10.9-rc1**](https://github.com/apache/ant/releases/tag/ANT_1.10.9_RC1) by [this](https://github.com/apache/ant/commit/87ac51d3c22bcf7cfd0dc07cb0bd04a496e0d428) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mike Salvatore",
    "workaround": "Steps were added to vulnerable versions to work around the issue. \n\nIn [**1.9.15-rc1**](https://github.com/apache/ant/releases/tag/rel%2F1.9.15) and [**1.10.8-rc1**](https://github.com/apache/ant/releases/tag/ANT_1.10.8_RC1), the vendor has added [this](https://github.com/apache/ant/commit/9c1f4d905da59bf446570ac28df5b68a37281f35) commit and [this](https://github.com/apache/ant/commit/926f339ea30362bec8e53bf5924ce803938163b7) commit. \n\nThe changes introduce the `ant.tmpdir` property which holds the safe directory path for temporary files. It has to be set by the user. The directory itself should also be set up by the user since Ant may not have the correct permissions to do it automatically.\n\nIn [**1.10.8-rc1**](https://github.com/apache/ant/releases/tag/ANT_1.10.8_RC1), [this](https://github.com/apache/ant/commit/a8645a151bc706259fb1789ef587d05482d98612) commit was also added. It attempts to set secure temporary file permissions, but does not protect the directory. \n\nTherefore it is strongly recommended that users set up a private secure temporary directory with appropriate permissions.\n\nThe official mitigation for versions from **1.1** to **1.9.14** and **1.10.0** to **1.10.7** is setting the `java.io.tmpdir` system property to point to a directory only readable and writable by the current user prior to running Ant.\n\nVersions **1.9.15** and **1.10.8** can be trusted to use the Ant property `ant.tmpfile`, but the vendor still highly recommends using a safer private temporary directory instead.",
    "vendorFixDate": "2020-08-11T00:00:00.000Z",
    "vendorNotifiedDate": "2020-01-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1128",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-829"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-1945",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1128/ranges"
            },
            {
                "rel": "reference",
                "href": "https://ant.apache.org/security.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ant.apache.org/security.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ant/commit/87ac51d3c22bcf7cfd0dc07cb0bd04a496e0d428",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ant/commit/926f339ea30362bec8e53bf5924ce803938163b7",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ant/commit/9c1f4d905da59bf446570ac28df5b68a37281f35",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ant/commit/a8645a151bc706259fb1789ef587d05482d98612",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ant/releases/tag/ANT_1.10.8_RC1",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ant/releases/tag/ANT_1.10.9_RC1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/ant/releases/tag/ANT_1.9.15_RC1",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2020/05/13/1",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1128/default-remediation-status"
            }
        ]
    }
}