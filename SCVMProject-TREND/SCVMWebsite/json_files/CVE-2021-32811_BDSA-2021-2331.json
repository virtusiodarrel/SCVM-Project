{
    "source": "BDSA",
    "name": "BDSA-2021-2331",
    "title": "Zope Vulnerable to Remote Code Execution (RCE) via 'AccessControl' Module",
    "description": "Zope is vulnerable to insufficient access restrictions to unsafe Python libraries. This could allow an admin level authenticated attacker to achieve remote code execution (RCE).\n\n**Note:** This vulnerability was first disclosed as **CVE-2021-32807** in the Access Control module of Zope. Due to its use of this module, **CVE-2021-32811** refers to the same vulnerability in the main Zope repository\n\n**Note:** The vendor has stated that you are only vulnerable if:\n* You use Python 3 for your Zope deployment (Zope 4 on Python 2 is not affected)\n* You have installed the optional `Products.PythonScripts` add-on package",
    "technicalDescription": "This vulnerability exists due to insufficient restrictions in the `AccessControl` modules security policy, which defines security policies for the use of Python code such as `Script (Python)`. The \n`AccessControl` policy allows full access to the Python `string` module, which means there is full access to the `Formatter` class. An admin authenticated attacker with the Zope `Manager` role can use `Script (Python)` to overwrite the `Formatter` class in order to provide further unrestricted access to Python libraries which should not be accessible. Access to these libraries can allow the attacker to achieve remote code execution (RCE).\n\nThe vendor has mitigated against this by upgrading the `AccessControl ` module in order to apply the fix from **CVE-2021-32807**.",
    "publishedDate": "2021-08-05T09:09:17.761Z",
    "updatedDate": "2022-08-17T11:12:22.350Z",
    "disclosureDate": "2021-07-31T00:00:00.000Z",
    "solution": "Fixed in Zope version:\n* [**5.3**](https://github.com/zopefoundation/Zope/releases/tag/5.3) by [this](https://github.com/zopefoundation/Zope/commit/f72a18dda8e9bf2aedb46168761668464a4be988) commit\n* [**4.6.3**](https://github.com/zopefoundation/Zope/releases/tag/4.6.3) by [this](https://github.com/zopefoundation/Zope/commit/869f947e586517566509e0ccdd4d99b60704cc02) commit. \n\nThe latest stable releases are available [here](https://github.com/zopefoundation/Zope/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has provided the following [workaround](https://github.com/zopefoundation/Zope/security/advisories/GHSA-g4gq-j4p2-j8fr):\n\nA site administrator can restrict adding/editing `Script (Python)` objects through the web using the standard Zope user/role permission mechanisms. Untrusted users should not be assigned the Zope Manager role and adding/editing these scripts through the web should be restricted to trusted users only. This is the default configuration in Zope.",
    "vendorFixDate": "2021-07-31T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2331",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32811",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2331/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/AccessControl/security/advisories/GHSA-qcx9-j53g-ccgf",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/commit/869f947e586517566509e0ccdd4d99b60704cc02",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/commit/f72a18dda8e9bf2aedb46168761668464a4be988",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/releases/tag/4.6.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/releases/tag/5.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/security/advisories/GHSA-g4gq-j4p2-j8fr",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zopefoundation/Zope/security/advisories/GHSA-g4gq-j4p2-j8fr",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2331/default-remediation-status"
            }
        ]
    }
}