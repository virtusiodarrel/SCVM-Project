{
    "source": "BDSA",
    "name": "BDSA-2019-2712",
    "title": "Apache Tapestry Vulnerable to Information Disclosure via Timing Discrepancy in 'validateHMAC()' Function",
    "description": "Apache Tapestry is vulnerable to information disclosure due to a timing discrepancy when performing a string comparison operation. A local attacker could potentially discern sensitive information about client-provided input by examining the time taken to perform such comparison operations.",
    "technicalDescription": "The `validateHMAC` function from `ClientDataEncoderImpl` is used to check HMAC in form submissions by comparing the HMAC signature recorded by the application against the one created using the client's current request. If the HMAC values do not match, an exception is raised. This check is performed by using the value returned by `!storedHmacResult.equals(actual)` within an `if` statement. The comparison itself is performed using the `String.equals` method which exposes the application to a timing attack since the time to taken to complete the string comparison will be dependent on the characteristics of the underlying HMAC.  By examining the time taken to evaluate this code, an attacker could infer potentially sensitive information about the recorded HMAC and the client-provided input. This may prove useful to the attacker in further exploiting the application.",
    "publishedDate": "2019-08-27T16:07:30.303Z",
    "updatedDate": "2020-02-06T15:24:09.263Z",
    "disclosureDate": "2019-08-22T00:00:00.000Z",
    "solution": "Fixed in [**5.4.5**](https://tapestry.apache.org/download.html) and [**5.5.0-beta3**](https://tapestry.apache.org/download.html) by [this](https://git-wip-us.apache.org/repos/asf?p=tapestry-5.git;a=commit;h=d3928ad44714b949d247af2652c84dae3c27e1b1) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "David Tomaschik of the Google Security Team",
    "workaround": "",
    "vendorFixDate": "2019-04-19T00:00:00.000Z",
    "discoveryDate": "2019-03-12T00:00:00.000Z",
    "vendorNotifiedDate": "2019-03-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2712",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-208"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10071",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2712/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git-wip-us.apache.org/repos/asf?p=tapestry-5.git;a=commit;h=d3928ad44714b949d247af2652c84dae3c27e1b1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread.html/6e8f42c88da7be3c60aafe3f6a85eb00b4f8b444de26b38d36233a43@%3Cusers.tapestry.apache.org%3E",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/154207/apachetapestry-timing.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://tapestry.apache.org/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2712/default-remediation-status"
            }
        ]
    }
}