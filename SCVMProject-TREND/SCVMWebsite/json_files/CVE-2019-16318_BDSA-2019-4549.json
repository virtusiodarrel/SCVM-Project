{
    "source": "BDSA",
    "name": "BDSA-2019-4549",
    "title": "Pimcore Vulnerable to Arbitrary File Upload via 'Asset.php' File",
    "description": "Pimcore contains an arbitrary file upload vulnerability. A low-privileged attacker could exploit this flaw by uploading a malicious file and execute arbitrary code on the server.",
    "technicalDescription": "This vulnerability exists in `models/Asset.php`. The function `correctPath()` does not properly validate the length of the uploaded file's name. This will allow an attacker with low privileges to bypass the mandatory `.txt` extension which is appended to the file name in the code itself. This can be done because the auto renaming feature fails for long file names. Thus, if the attacker uploads a PHP file using 256 characters for the file name, then the `.txt` extension won't be added for such a file. Hence, the attacker could upload arbitrary files and possibly cause remote code execution.",
    "publishedDate": "2020-08-10T15:43:08.845Z",
    "updatedDate": "2021-10-13T11:03:20.257Z",
    "disclosureDate": "2019-03-19T00:00:00.000Z",
    "solution": "Fixed in [**5.7.1**](https://github.com/pimcore/pimcore/releases/tag/v5.7.1) by [this](https://github.com/pimcore/pimcore/commit/732f1647cc6e0a29b5b1f5d904b4d726b5e9455f) commit.\n\nThe latest releases are available [here](https://github.com/pimcore/pimcore/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-03-19T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4549",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-16318",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4549/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/commit/732f1647cc6e0a29b5b1f5d904b4d726b5e9455f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/releases/tag/v5.7.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pimcore/pimcore/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-PHP-PIMCOREPIMCORE-451598",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4549/default-remediation-status"
            }
        ]
    }
}