{
    "source": "BDSA",
    "name": "BDSA-2021-0905",
    "title": "dnsmasq Vulnerable to DNS Cache Poisoning via Fixed Outgoing Port",
    "description": "dnsmasq is vulnerable to DNS cache poisoning via use of a fixed outgoing port. An attacker on the network who is able to determine the outgoing port used by dnsmasq could exploit this by guessing the random transmission ID before forging a reply and having it accepted.",
    "technicalDescription": "If dnsmasq is configured with `--server=<address>@<interface>` or similar then it configures a fixed UDP port for all outgoing queries to the specified upstream DNS server. If this port were to be discovered by an attacker then they would simply have to guess the transmission id in order to have a forged reply accepted. It was mitigated by implementing the use of random port where possible.",
    "publishedDate": "2021-04-09T13:44:07.362Z",
    "updatedDate": "2021-04-09T13:44:07.355Z",
    "disclosureDate": "2021-03-16T00:00:00.000Z",
    "exploitPublishDate": "2021-03-16T00:00:00.000Z",
    "solution": "Fixed in [**2.85**](https://thekelleys.org.uk/dnsmasq/) by [this](https://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=74d4fcd756a85bc1823232ea74334f7ccfb9d5d2) commit.\n\nThe latest stable releases are available [here](https://thekelleys.org.uk/dnsmasq/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.2,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.2,
        "severity": "LOW",
        "accessVector": "ADJACENT_NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.5
        },
        "vector": "(AV:A/AC:H/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.9,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Petr Men\u0161\u00edk (Red Hat)",
    "workaround": "",
    "vendorFixDate": "2021-03-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0905",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-358"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3448",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0905/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1939368",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1939368",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://lists.thekelleys.org.uk/pipermail/dnsmasq-discuss/2021q2/014962.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://thekelleys.org.uk/dnsmasq/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=74d4fcd756a85bc1823232ea74334f7ccfb9d5d2",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0905/default-remediation-status"
            }
        ]
    }
}