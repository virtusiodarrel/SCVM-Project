{
    "source": "BDSA",
    "name": "BDSA-2020-2399",
    "title": "Jenkins Mailer Plugin Vulnerable to Man-in-the-Middle (MitM) via Missing Hostname Validation",
    "description": "Jenkins Mailer Plugin is vulnerable to man-in-the-middle (MitM) attacks due to missing hostname validation. An attacker can take advantage of this in order to intercept connections to the SMTP server.",
    "technicalDescription": "This vulnerability exists due to the `mail.smtp.ssl.checkserveridentity` property in the `src/main/java/hudson/tasks/Mailer.java` file being set to `false`.  This means that when connecting to an SMTP server via TLS, Jenkins Mailer Plugin is not performing hostname validation.\n\nThe vendor has mitigated against this by adding in hostname validation as default.",
    "publishedDate": "2020-09-17T10:01:36.582Z",
    "updatedDate": "2022-05-30T10:55:01.623Z",
    "disclosureDate": "2020-09-16T00:00:00.000Z",
    "solution": "Fixed in [**1.32.1**](https://github.com/jenkinsci/mailer-plugin/releases/tag/mailer-1.32.1) by [this](https://github.com/jenkinsci/mailer-plugin/commit/e1893c6d105669f134ee5c5212ef9f3944d7d00d) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor provided the following workaround:\n\"Administrators can set the Java system property `mail.smtp.ssl.checkserveridentity` to `true` on startup.\"",
    "vendorFixDate": "2020-09-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2399",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-354"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-2252",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2399/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/mailer-plugin/commit/e1893c6d105669f134ee5c5212ef9f3944d7d00d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/mailer-plugin/releases/tag/mailer-1.32.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/security/advisory/2020-09-16/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/security/advisory/2020-09-16/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2399/default-remediation-status"
            }
        ]
    }
}