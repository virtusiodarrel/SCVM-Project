{
    "source": "BDSA",
    "name": "BDSA-2020-1466",
    "title": "HashiCorp Vault Vulnerable to Incorrect Access Control via Dynamic Service Accounts",
    "description": "HashiCorp Vault contains an incorrect access control vulnerability due to system TTLs being used instead of the configured settings for service accounts. This issue could allow an attacker to obtain access to the functionality and sensitive data of a service account.",
    "technicalDescription": "This issue is due to service account keys not using the configured default TTL settings at the engine level and instead using the system configurations. This could provide the key with a significantly longer lease time than was intended. The `pathSecretServiceAccountKey()` and `secretKeyRenew()` functions in `vendor/github.com/hashicorp/vault-plugin-secrets-gcp/plugin/secrets_service_account_key.go` file do not use the configured default TTL settings, resulting in the ability of an attacker to obtain access to the functionality and sensitive data of a service account.",
    "publishedDate": "2020-06-22T14:46:36.312Z",
    "updatedDate": "2021-11-30T16:20:14.695Z",
    "disclosureDate": "2020-05-01T00:00:00.000Z",
    "solution": "Fixed in HashiCorp Vault version [**1.4.2**](https://github.com/hashicorp/vault/releases/tag/v1.4.2) by [this](https://github.com/hashicorp/vault/commit/ae6cc3db519a3cd11babfc5266bc57b89498a003) commit.\n\nFixed in HasiCorp Vault Plugin: Google Cloud Platform Secrets Backend version [**0.6.2**](https://github.com/hashicorp/vault-plugin-secrets-gcp/releases/tag/v0.6.2) by [this](https://github.com/hashicorp/vault-plugin-secrets-gcp/commit/e43d20870c50f7428dead1411debcec075b35fb4) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jacob Mammoliti (arctiqjacob)",
    "workaround": "The vendor suggests a workaround of tuning the backend directly with the following: `vault secrets tune -default-lease-ttl=5m -max-lease-ttl=10m gcp`.\n\nA third party provided a workaround of setting the TTL when reading the roleset before tuning. For example, `vault read gcp/key/my-key-roleset ttl=5m`.",
    "vendorFixDate": "2020-05-15T00:00:00.000Z",
    "vendorNotifiedDate": "2020-05-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1466",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-269"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12757",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1466/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault-plugin-secrets-gcp/commit/e43d20870c50f7428dead1411debcec075b35fb4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault-plugin-secrets-gcp/pull/85",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault-plugin-secrets-gcp/releases/tag/v0.6.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/commit/ae6cc3db519a3cd11babfc5266bc57b89498a003",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/issues/8908",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/issues/8908",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/hashicorp/vault/releases/tag/v1.4.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1466/default-remediation-status"
            }
        ]
    }
}