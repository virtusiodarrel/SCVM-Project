{
    "source": "BDSA",
    "name": "BDSA-2019-0515",
    "title": "Drupal Vulnerable to Remote Code Execution (RCE) via Multiple Web Services Modules",
    "description": "Drupal is vulnerable to remote code execution (RCE) due to deserializing untrusted data through multiple web services, such as REST module. An attacker can run arbitrary PHP code on the vulnerable application.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "In Drupal **7.x** and before, RESTful Web Services was a separate module; however with Drupal **8** it comes with the Drupal core, but it is disabled by default.\nREST module checks whether the owner of the HTTP request is authenticated upon receiving `POST` request to modify the content of the web application data. However, it doesn't authenticate the `GET` requests and deserializes the received data from any unauthorized users. This flaw can be used to send crafted payload to the vulnerable application and have it run arbitrary PHP code.  There is a publicly available [exploit](https://www.ambionics.io/blog/drupal8-rce) for this vulnerability.\n\nThis vulnerability is not limited to RESTful web services, please see following list, not exhaustive, for the other affected modules.\n* Font Awesome Icons, Drupal **8**.\n* Translation Management Tool, Drupal **8**.\n* Paragraphs, Drupal **8**.\n* Video, Drupal **8**.\n* Metatag, Drupal **8**.\n* JSON-API, Drupal **8**.\n* Services, Drupal **7**.\n\n\nThe following prerequisites need to be in place to make a web application vulnerable to this issue: \n* Drupal **8**: Having the core RESTful Web Services enabled and allowing `GET`, `PUT`, `PATCH` or `POST`.\n* Drupal **8**: Enabling web services, like JSON-API.\n* Drupal **7**: Enabling Services or RESTful Web Services.",
    "publishedDate": "2019-03-05T10:07:58.058Z",
    "updatedDate": "2022-05-06T14:46:52.227Z",
    "disclosureDate": "2019-02-20T00:00:00.000Z",
    "exploitPublishDate": "2019-02-22T00:00:00.000Z",
    "solution": "Fixed in Drupal Core **[8.6.10](https://github.com/drupal/core/releases/tag/8.6.10)** by [this](https://github.com/drupal/core/commit/24b3fae89eab2b3951f17f80a02e19d9a24750f5) commit.\n\nFixed in Drupal Core **[8.5.11](https://github.com/drupal/core/releases/tag/8.5.11)** by [this](https://github.com/drupal/core/commit/59396df3e7d8c304b2de91a1b34835a8747ab3cc) commit.\n\nAfter updating Drupal Core, update any relevant affected modules:\n\n* Fixed in RESTful Web Service **[7.x-2.8](https://www.drupal.org/project/restws/releases/7.x-2.8)**.\n* Fixed in Font Awesome Icons **[8.x-2.12](https://www.drupal.org/project/fontawesome/releases/8.x-2.12)**.\n* Fixed in Translation Management Tool **[8.x-1.7](https://www.drupal.org/project/TMGMT/releases/8.x-1.7)**.\n* Fixed in Paragraphs **[8.x-1.6](https://www.drupal.org/project/paragraphs/releases/8.x-1.6)**.\n* Fixed in Video **[8.x-1.4](https://www.drupal.org/project/video/releases/8.x-1.4)**.\n* Fixed in Metatag **[8.x-1.8](https://www.drupal.org/project/metatag/releases/8.x-1.8)**.\n* Fixed in JSON-API **[8.x-2.3](https://www.drupal.org/project/jsonapi/releases/8.x-2.3)**.\n* Fixed in JSON-API **[8.x-1.26](https://www.drupal.org/project/jsonapi/releases/8.x-1.25)**.",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Samuel Mortenson",
    "workaround": "Disable all web services or configure them not to allow `GET`, `PUT`, `PATCH` and `POST` requests.",
    "vendorFixDate": "2019-02-20T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0515",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-6340",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0515/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/core/commit/24b3fae89eab2b3951f17f80a02e19d9a24750f5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/core/commit/59396df3e7d8c304b2de91a1b34835a8747ab3cc",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/core/releases/tag/8.5.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/drupal/core/releases/tag/8.6.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ambionics.io/blog/drupal8-rce",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/TMGMT/releases/8.x-1.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/fontawesome/releases/8.x-2.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/jsonapi/releases/8.x-1.25",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/jsonapi/releases/8.x-2.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/metatag/releases/8.x-1.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/paragraphs/releases/8.x-1.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/restws/releases/7.x-2.8",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/project/video/releases/8.x-1.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-contrib-2019-018",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-contrib-2019-019",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-contrib-2019-020",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-contrib-2019-021",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-contrib-2019-022",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-contrib-2019-023",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-contrib-2019-024",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-contrib-2019-025",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-core-2019-003",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-core-2019-003",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.rapid7.com//db/modules/exploit/unix/webapp/drupal_restws_unserialize",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0515/default-remediation-status"
            }
        ]
    }
}