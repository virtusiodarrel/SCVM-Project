{
    "source": "BDSA",
    "name": "BDSA-2021-4124",
    "title": "Linux Kernel bpf Verifier Vulnerable to Information Leak via Improper Bounds Checking in mov32 Instruction Handling",
    "description": "The Linux kernel is vulnerable to an information leak in the bpf verifier functionality. A local attacker could leverage this to reveal sensitive pointer values. This information could allow the attacker to bypass the kernel exploit prevention feature \"kernel address space layout randomization\" (KASLR) and aid in further attacks.",
    "technicalDescription": "Improper handing of bounds checking with the mov32 instruction in the bpf verifier (`kernel/bpf/verifier.c\t`) can lead to the leak of pointer information to unprivileged userspace.  This occurs because of missing calls to  `__update_reg_bounds(dst_reg)`, `__reg_deduce_bounds(dst_reg)` and `__reg_bound_offset(dst_reg)` in the `check_alu_op()` function. This could allow registers that are involved in pointer arithmetic to taint destination registers (that later get exported) via function`adjust_ptr_min_max_vals()`.",
    "publishedDate": "2022-02-14T16:14:28.884Z",
    "updatedDate": "2022-02-14T16:14:28.863Z",
    "disclosureDate": "2021-12-16T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.10.88**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e2aad0b5f2cbf71a31d00ce7bb4dee948adff5a9) commit\n* [**5.15.11**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f77d7a35d4913e4ab27abb36016fbfc1e882a654) commit\n* [**5.16-rc6**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3cf2b61eb06765e27fec6799292d9fb46d0b7e60) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-12-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4124",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-201"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-45402",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4124/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/?id=3cf2b61eb06765e27fec6799292d9fb46d0b7e60",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3cf2b61eb06765e27fec6799292d9fb46d0b7e60",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=e2aad0b5f2cbf71a31d00ce7bb4dee948adff5a9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f77d7a35d4913e4ab27abb36016fbfc1e882a654",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3f50f132d8400e129fc9eb68b5020167ef80a244",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4124/default-remediation-status"
            }
        ]
    }
}