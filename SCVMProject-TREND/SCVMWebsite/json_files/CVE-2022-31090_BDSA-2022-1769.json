{
    "source": "BDSA",
    "name": "BDSA-2022-1769",
    "title": "Guzzle Vulnerable to Information Disclosure via Usage of 'CURLOPT_HTTPAUTH' Option for URI Redirects with Different Origin",
    "description": "Guzzle does not remove the HTTP `Authorization` header from a request that is being redirected to a URI with a different origin. This could allow an attacker to obtain sensitive information from this header.",
    "technicalDescription": "This vulnerability applies to installations that use the Curl handler. When handling a request that will be redirected to a URI with a different origin, the application does not remove the `CURLOPT_HTTPAUTH` and `CURLOPT_USERPWD` options before following the redirect. As a result, Curl will append the `Authorization` header to the new request. This can lead to sensitive information exposure.\n\nThis issue has been fixed by removing the `CURLOPT_HTTPAUTH` and `CURLOPT_USERPWD` options from a new request that will follow a redirect to a URI with a different origin.\n\n**Note** This issue was partially fixed in version [**7.4.2**](https://github.com/guzzle/guzzle/releases/tag/7.4.2) by [this](https://github.com/guzzle/guzzle/commit/cc80b002a0c550d242e20ed28ef52b35e237e0c9) commit. However, this fix only accounted for the change in host and not for any changes in the scheme or port.",
    "publishedDate": "2022-06-28T09:29:20.100Z",
    "updatedDate": "2022-06-28T09:29:20.090Z",
    "disclosureDate": "2022-06-21T00:00:00.000Z",
    "solution": "Fixed in:\n* **[6.5.8](https://github.com/guzzle/guzzle/releases/tag/6.5.8)** by [this](https://github.com/guzzle/guzzle/commit/a52f0440530b54fa079ce76e8c5d196a42cad981) commit,\n* **[7.4.5](https://github.com/guzzle/guzzle/releases/tag/7.4.5)** by [this](https://github.com/guzzle/guzzle/commit/1dd98b0564cb3f6bd16ce683cb755f94c10fbd82) commit.\n\nThe latest stable releases can be found [here](https://github.com/guzzle/guzzle/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor states that users should disable redirects if they do not want redirects to be followed. Alternatively, instead of the Curl handler, users can specify installations to use the Guzzle stream handler backend.",
    "vendorFixDate": "2022-06-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1769",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31090",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1769/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/commit/1dd98b0564cb3f6bd16ce683cb755f94c10fbd82",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/commit/a52f0440530b54fa079ce76e8c5d196a42cad981",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/commit/cc80b002a0c550d242e20ed28ef52b35e237e0c9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/releases/tag/6.5.8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/releases/tag/7.4.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/releases/tag/7.4.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/security/advisories/GHSA-25mq-v84q-4j7r",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/security/advisories/GHSA-25mq-v84q-4j7r",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1769/default-remediation-status"
            }
        ]
    }
}