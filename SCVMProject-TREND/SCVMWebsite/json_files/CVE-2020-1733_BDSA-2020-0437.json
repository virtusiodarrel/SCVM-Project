{
    "source": "BDSA",
    "name": "BDSA-2020-0437",
    "title": "Ansible Vulnerable to Privilege Escalation via Race Condition in '__init__.py'",
    "description": "Ansible contains a privilege escalation vulnerability due to missing checks when creating a temporary directory. An attacker could exploit this vulnerability to gain control of a `become user`, which could allow them to obtain sensitive information and alter the permissions of the files that are owned by the original user.\n\nA patch was developed to fix this vulnerability. However, that patch was found to be incomplete, meaning that privilege escalation was still possible and required a further fix. This is documented in **CVE-2020-10744** (**BDSA-2020-1148**).",
    "technicalDescription": "The `mkdtemp` function in `lib/ansible/plugins/shell/__init__.py` does not check if the folder being created in `/var/tmp` already exists before creating it for a `become user`. This bypasses any permissions or ACLs that may be in place if this folder already exists. An attacker can exploit this as the directory can be accessed by iterating `/proc/<pid>/cmdline`.\n\nA patch was developed to fix this vulnerability. However, that patch was found to be incomplete, meaning that privilege escalation was still possible and required a further fix. This is documented in **CVE-2020-10744** (**BDSA-2020-1148**).",
    "publishedDate": "2020-03-17T16:37:18.829Z",
    "updatedDate": "2021-07-22T14:00:08.136Z",
    "disclosureDate": "2020-02-26T00:00:00.000Z",
    "solution": "Fixed in:\n* **[2.9.12](https://github.com/ansible/ansible/releases/tag/v2.9.12)** by [this](https://github.com/ansible/ansible/commit/84afa8e90c) commit\n* **[2.10.0rc1](https://github.com/ansible/ansible/releases/tag/v2.10.0rc1)** by [this](https://github.com/ansible/ansible/commit/ffd3757fc3) commit\n* **[2.11.0b1](https://github.com/ansible/ansible/releases/tag/v2.11.0b1)** by [this](https://github.com/ansible/ansible/commit/77d0effcc5) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.8,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-04-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0437",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-280"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-362"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-1733",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0437/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-1733",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/77d0effcc5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/84afa8e90c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/commit/ffd3757fc3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/issues/67791",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases/tag/v2.10.0rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases/tag/v2.11.0b1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ansible/ansible/releases/tag/v2.9.12",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0437/default-remediation-status"
            }
        ]
    }
}