{
    "source": "BDSA",
    "name": "BDSA-2020-2633",
    "title": "Ruby WEBrick Vulnerable to HTTP Request Smuggling via Invalid Transfer-Encoding Header",
    "description": "Ruby WEBrick is vulnerable to HTTP request smuggling due to the insufficient validation of client requests. An attacker could maliciously modify legitimate client requests by sending their own crafted web requests to that server.",
    "technicalDescription": "This vulnerability exists due to insufficient validation against invalid Transfer-Encoding headers. This can lead to an inconsistent interpretation between Ruby WEBrick and some HTTP proxy servers. An attacker can take advantage of this in order to smuggle a malicious HTTP requests to a server.",
    "publishedDate": "2020-10-05T16:03:36.236Z",
    "updatedDate": "2021-05-26T15:46:10.641Z",
    "disclosureDate": "2020-09-29T00:00:00.000Z",
    "exploitPublishDate": "2020-10-29T00:00:00.000Z",
    "solution": "Fixed in WEBrick [**1.6.1**](https://github.com/ruby/webrick/releases/tag/v1.6.1) by [this](https://github.com/ruby/webrick/commit/076ac636bf48b7a492887ce4de7041de23e6c00d) commit.\n\nThe latest stable releases are available [here](https://github.com/ruby/webrick/releases).\n\nFixed in Ruby:\n* [**2.7.2**](https://www.ruby-lang.org/en/news/2020/10/02/ruby-2-7-2-released/) by [this](https://github.com/ruby/ruby/commit/d23d2f3f6fbb5d787b0dd80675c489a692be23e2) commit,\n* [**2.6.7**](https://www.ruby-lang.org/en/news/2021/04/05/ruby-2-6-7-released/) by [this](https://github.com/ruby/ruby/commit/8b49c3e4bc767bec8a66ac81cbda033330fb2703) commit,\n* [**2.5.9**](https://www.ruby-lang.org/en/news/2021/04/05/ruby-2-5-9-released/) by [this](https://github.com/ruby/ruby/commit/d6d2f179b02855ce07e8a114b3611dfc1f590986) commit. \n\nThe latest stable releases are available [here](https://www.ruby-lang.org/en/downloads/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "piao",
    "workaround": "",
    "vendorFixDate": "2020-09-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2633",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25613",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2633/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/8b49c3e4bc767bec8a66ac81cbda033330fb2703",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/d23d2f3f6fbb5d787b0dd80675c489a692be23e2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/ruby/commit/d6d2f179b02855ce07e8a114b3611dfc1f590986",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/webrick/commit/076ac636bf48b7a492887ce4de7041de23e6c00d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/webrick/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ruby/webrick/releases/tag/v1.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/965267",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2020/09/29/http-request-smuggling-cve-2020-25613/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2020/10/02/ruby-2-7-2-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2021/04/05/ruby-2-5-9-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.ruby-lang.org/en/news/2021/04/05/ruby-2-6-7-released/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2633/default-remediation-status"
            }
        ]
    }
}