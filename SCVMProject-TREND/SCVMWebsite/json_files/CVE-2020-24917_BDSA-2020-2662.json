{
    "source": "BDSA",
    "name": "BDSA-2020-2662",
    "title": "osTicket Vulnerable to Cross-Site Scripting (XSS) via '_uploadInlineImage' Function",
    "description": "osTicket contains a cross-site scripting (XSS) vulnerability due to a lack of user input validation. A remote attacker could execute arbitrary scripts in the victim's browser which could be used to steal cookie-based session information or other credentials.",
    "technicalDescription": "The vulnerability occurs due to insufficient sanitization of the filename used in the `_uploadInlineImage()` function in the `include/ajax.draft.php` file. An attacker could exploit this flaw to execute malicious scripts in the victim's browser when uploading an attachment via Draft AJAX. The issue was addressed by sanitizing the filename prior to it being returned in the JSON response. The `AttachementFile::format()` was also updated to sanitize the filename before the attachment file is saved to the backend.",
    "publishedDate": "2020-10-07T14:49:55.289Z",
    "updatedDate": "2021-09-29T09:25:34.076Z",
    "disclosureDate": "2020-08-28T00:00:00.000Z",
    "solution": "Fixed in [**1.14.3**](https://github.com/osTicket/osTicket/releases/tag/v1.14.3) by [this](https://github.com/osTicket/osTicket/commit/518de223933eab0c5558741ce317f36958ef193d) commit.\n\nThe latest stable releases are available [here](https://trims.internal.synopsys.com/vulns/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-08-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2662",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-24917",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2662/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/commit/518de223933eab0c5558741ce317f36958ef193d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/releases/tag/v1.14.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/osTicket/osTicket/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://sisl.lab.uic.edu/projects/chess/osticket-xss/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2662/default-remediation-status"
            }
        ]
    }
}