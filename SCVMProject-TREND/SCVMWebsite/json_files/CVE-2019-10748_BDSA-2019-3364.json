{
    "source": "BDSA",
    "name": "BDSA-2019-3364",
    "title": "Sequelize Vulnerable to SQL Injection via Improper Escaping of JSON Path Keys",
    "description": "Sequelize is vulnerable to SQL injection due to the improper handling of client-provided input. A remote attacker could extract sensitive information from back-end databases by submitting crafted requests to the application.",
    "technicalDescription": "The `QueryGenerator` class within Sequelize can process dialects for a variety of database platforms, including MariaDB. The MariaDB dialect can make use of JSON path keys within queries. These keys will be stored by Sequelize within the variable `paths`. The value of this variable is not sanitized. An attacker can craft a malicious request that uses JSON path keys that, when processed by the application, will cause the attacker's input to escape from the data context to the execution context of the SQL interpreter. This could allow them to extract sensitive information from back-end databases.",
    "publishedDate": "2019-10-30T15:32:06.191Z",
    "updatedDate": "2019-10-30T15:32:06.180Z",
    "disclosureDate": "2019-06-20T00:00:00.000Z",
    "exploitPublishDate": "2019-06-20T00:00:00.000Z",
    "solution": "Fixed in version [**5.8.11**](https://github.com/sequelize/sequelize/releases/tag/v5.8.11) by [this](https://github.com/sequelize/sequelize/pull/11089/commits/17096d30f5593952d6211e2a8acde32d6a075a8d) commit.\n\nFixed in version [**4.44.3**](https://github.com/sequelize/sequelize/releases/tag/v4.44.3) \n\nFixed in version [**3.35.1**](https://github.com/sequelize/sequelize/releases/tag/v3.35.1)",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-06-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3364",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10748",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3364/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sequelize/sequelize/pull/11089",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sequelize/sequelize/pull/11089/commits/17096d30f5593952d6211e2a8acde32d6a075a8d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sequelize/sequelize/releases/tag/v3.35.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sequelize/sequelize/releases/tag/v4.44.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/sequelize/sequelize/releases/tag/v5.8.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-SEQUELIZE-450221",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3364/default-remediation-status"
            }
        ]
    }
}