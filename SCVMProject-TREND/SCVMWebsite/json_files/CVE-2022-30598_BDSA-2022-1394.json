{
    "source": "BDSA",
    "name": "BDSA-2022-1394",
    "title": "Moodle Vulnerable to Information Disclosure via Global Search Results",
    "description": "Moodle is vulnerable to an information disclosure vulnerability. This could allow an attacker unauthorized access to the author information of some activities.",
    "technicalDescription": "This vulnerability exists due to insufficient permissions checks when displaying the global search results for user documents. This could allow an attacker unauthorized access to the author information of some activities.\n\nThe vendor has mitigated against this by including additional checks in the `export_for_template()` function of file `search/classes/document.php` to ensure that a user has the correct permissions to view the metadata of specific documents.",
    "publishedDate": "2022-05-19T15:30:20.113Z",
    "updatedDate": "2022-05-19T15:30:20.093Z",
    "disclosureDate": "2022-05-17T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.0.1**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v4.0.1) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=8b098b4a4e5) commit,\n* [**3.11.7**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.11.7) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=5ab6d18354d) commit,\n* [**3.10.11**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.10.11) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=977f196c11f) commit,\n* [**3.9.14**](https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.9.14) by [this](https://git.moodle.org/gw?p=moodle.git;a=commit;h=55e08c48c7c) commit.\n\nThe latest stable releases are available [here](https://download.moodle.org/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.6
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Catalina",
    "workaround": "",
    "vendorFixDate": "2022-05-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1394",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-30598",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1394/ranges"
            },
            {
                "rel": "reference",
                "href": "https://download.moodle.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=55e08c48c7c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=5ab6d18354d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=8b098b4a4e5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=commit;h=977f196c11f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.10.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.11.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v3.9.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.moodle.org/gw?p=moodle.git;a=tag;h=refs/tags/v4.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://moodle.org/mod/forum/discuss.php?d=434580",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1394/default-remediation-status"
            }
        ]
    }
}