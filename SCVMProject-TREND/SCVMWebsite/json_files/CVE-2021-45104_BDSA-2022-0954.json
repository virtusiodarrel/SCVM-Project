{
    "source": "BDSA",
    "name": "BDSA-2022-0954",
    "title": "HTCondor Vulnerable to Sensitive Information Disclosure via Cleartext Transmission of 'ClassAd' Private Attributes",
    "description": "HTCondor is vulnerable to a sensitive information disclosure issue due to how a piece of secret information can be sent over the network in cleartext if HTCondor has been configured to use weaker encryption protocols, or if some of the HTCondor daemons are version **8.8** or earlier.\n\nAn attacker with the ability to capture network traffic between Schedd and Startd or Collector could potentially use this information to control the slot of another user, including running their own code as that user. An attacker could also impersonate a condor_negotiator and condor_startd, tricking the condor_schedd into sending them the jobs of any user.",
    "technicalDescription": "In order to be vulnerable, HTCondor daemons must be configured to use BLOWFISH or 3DES encryption with match password authentication enabled. The vendor has stated [here](https://research.cs.wisc.edu/htcondor/security/vulnerabilities/HTCONDOR-2022-0002) that a condor_schedd communicating to a version **8.8** peer is most likely to be vulnerable.",
    "publishedDate": "2022-04-08T11:31:44.900Z",
    "updatedDate": "2022-04-08T11:31:44.881Z",
    "disclosureDate": "2022-03-15T00:00:00.000Z",
    "solution": "Fixed in [**9.0.10**](https://github.com/htcondor/htcondor/releases/tag/V9_0_10) and [**9.6.0**](https://github.com/htcondor/htcondor/releases/tag/V9_6_0) by [this](https://github.com/htcondor/htcondor/commit/cb6a029dc13abc1d4a033ee2a66711b3844174f9) commit.\n\nThe latest stable releases are available [here](https://htcondor.org/downloads.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.9
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Brian Bockelman, Jaime Frey",
    "workaround": "The vendor has stated [here](https://research.cs.wisc.edu/htcondor/security/vulnerabilities/HTCONDOR-2022-0002) that if upgrading is not possible, the easiest workaround is to ensure all machines are running HTCondor **9.0.0** or above, and that the `SEC_XXX_ENCRYPTION_METHODS` configuration parameters are either unset or list `AES` as the first entry.\n\nIf some machines cannot be upgraded to **9.0.0** or above, then users can configure all machines to use encryption for all communications. To do this, set `SEC_DEFAULT_ENCRYPTION=REQUIRED` and ensure no other `SEC_XXX_ENCRYPTION` parameters set a different value. In **9.0** and above, the configuration templates `use SECURITY: strong` and `use SECURITY: recommended_v9_0` also enable encryption.\n\nIf some execute or central manager machines cannot be upgraded to **9.0.0** or above and their configuration cannot be altered to require encryption, match password authentication can be disabled on submit machines. To do this, set `SEC_ENABLE_MATCH_PASSWORD_AUTHENTICATION=False` in the configuration files. Be advised that this may require additional configuration for authentication and authorization between submit and execute machines. It can also put significant extra load on your submit machines in a large pool (thousands of nodes).",
    "vendorFixDate": "2022-01-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0954",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-319"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-45104",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0954/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/commit/cb6a029dc13abc1d4a033ee2a66711b3844174f9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/releases/tag/V9_0_10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/htcondor/htcondor/releases/tag/V9_6_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://htcondor.org/downloads.html",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://htcondor.readthedocs.io/en/latest/version-history/development-release-series-91.html#version-9-6-0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://research.cs.wisc.edu/htcondor/security/vulnerabilities/HTCONDOR-2022-0002",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://research.cs.wisc.edu/htcondor/security/vulnerabilities/HTCONDOR-2022-0002",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0954/default-remediation-status"
            }
        ]
    }
}