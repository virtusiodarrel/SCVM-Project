{
    "source": "BDSA",
    "name": "BDSA-2021-4099",
    "title": "Linux Kernel Vulnerable to KVM SEV-ES Guest-to-Host Escape via Out-of-Bounds Read and Write with Specially Crafted 'VMGEXIT'",
    "description": "The Linux kernel is vulnerable to a repeatable out-of-bounds read and write flaw in the KVM SEV-ES (Secure Encrypted Virtualization - Encrypted State) feature. A local attacker on the KVM guest machine that uses this feature could leverage the issue to read and write to host memory. This could allow them to escape the virtual machine privilege layer and execute code on the host.",
    "technicalDescription": "The problem lies in the `sev_es_string_io()` function of file `arch/x86/kvm/svm/sev.c` where it incorrectly handles string I/O instructions with guest controlled values for the length and I/O access size. These values are later used on  a copy to a fixed size buffer of one virtual page size in length. This can result in an attacker controlled read and write of adjacent host memory, allowing full compromise of the host from the guest.",
    "publishedDate": "2022-02-04T12:05:49.098Z",
    "updatedDate": "2022-02-04T12:05:49.085Z",
    "disclosureDate": "2021-12-02T00:00:00.000Z",
    "solution": "Fixed in [**5.14.15**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.14.15) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3f54362dc7d7a382483fc4872abd4ad97b734609) commit and in [**5.15-rc7**](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.15-rc7) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=95e16b4792b0429f1933872f743410f00e590c55) commit.\n\nThe latest stable releases are available [here](https://www.kernel.org).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 1.5,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:L/AC:H/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 0.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-10-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-4099",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2021-4093",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2021-4099/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2028584",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7ed9abfe8e9f",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3f54362dc7d7a382483fc4872abd4ad97b734609",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=95e16b4792b0429f1933872f743410f00e590c55",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.14.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v5.15-rc7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}