{
    "source": "BDSA",
    "name": "BDSA-2019-1562",
    "title": "WPO WebPageTest Vulnerable to Information Disclosure via Routeable IP Addresses on EC2 Instances",
    "description": "WPO WebPageTest is vulnerable to information disclosure when used with EC2 instances due to a failure to prevent routing to internal IP addresses. An attacker could exploit this vulnerability to acquire critically secure AWS metadata, and ultimately compromise the instance.",
    "technicalDescription": "WPT does contain code intended to block certain sensitive IP addresses, however it does not block those IP addresses when they are expressed in octal. Once such address is the metadata IP on AWS EC2 instances, through which WPT is able to obtain the `ACCESS_KEY_ID` and the `SECRET_KEY` of the instance. The vulnerability was fixed by null-routing the metadata IP on EC2 agents so that no data is returned from that endpoint.",
    "publishedDate": "2019-05-21T13:07:53.908Z",
    "updatedDate": "2019-05-21T13:07:53.902Z",
    "disclosureDate": "2019-05-16T00:00:00.000Z",
    "exploitPublishDate": "2019-05-16T00:00:00.000Z",
    "solution": "Fixed by [this](https://github.com/WPO-Foundation/wptagent/commit/4dfa1abaf375e303b9debc9abe8d876ff988b2a6) commit and [this](https://github.com/WPO-Foundation/wptagent/commit/9106fc42d08ab430c2b04becfa4a4c40624ee8a5) commit in the master branch, which have not yet been included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-05-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1562",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-923"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12161",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1562/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1550366",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1550366",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WPO-Foundation/wptagent/commit/4dfa1abaf375e303b9debc9abe8d876ff988b2a6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WPO-Foundation/wptagent/commit/9106fc42d08ab430c2b04becfa4a4c40624ee8a5",
                "label": "PATCH"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1562/default-remediation-status"
            }
        ]
    }
}