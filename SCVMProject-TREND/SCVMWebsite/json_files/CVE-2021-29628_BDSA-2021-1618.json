{
    "source": "BDSA",
    "name": "BDSA-2021-1618",
    "title": "FreeBSD Vulnerable to SMAP Security Bypass via Improper Handling of Invalid Page Faults",
    "description": "FreeBSD contains a vulnerability that can lead to bypass of the security measures provided by `Supervisor Mode Access Prevention (SMAP)` module.",
    "technicalDescription": "This vulnerability arises when system calls like `copyin()` and `copyout()` temporarily disable the `Supervisor Mode Access Prevention (SMAP)` module in order to access user memory. However, the application does not correctly handle invalid page faults that are triggered when the relevant user memory is not mapped. This can result in bypass of security measures provided by the SMAP module for the entire duration of a system call. An attacker could combine this flaw with other existing kernel bugs to craft a malicious exploit.\n\nThe vendor addressed this by implementing a constant value header to prevent asm interpreting values as an external global symbol.",
    "publishedDate": "2021-06-03T16:14:24.637Z",
    "updatedDate": "2022-05-26T08:51:01.532Z",
    "disclosureDate": "2021-05-26T00:00:00.000Z",
    "solution": "Fixed in:\n* **[12.3.0](https://cgit.freebsd.org/src/tag/?h=release/12.3.0)** by [this](https://cgit.freebsd.org/src/commit/?id=4590f0345956329d414611c6cee300f486732b53) commit,\n* **[13.1.0](https://cgit.freebsd.org/src/tag/?h=release/13.1.0)** by [this](https://cgit.freebsd.org/src/commit/?id=6bbde34ae6088285af9d1cc587249c3e7a0159a9) commit.\n\nFixed in the **releng/12.2** branch by [this](https://cgit.freebsd.org/src/commit/?id=bb4435255df53118082b3567db6da100962b3822) commit.\n\nFixed in the **releng/13.0** branch by [this](https://cgit.freebsd.org/src/commit/?id=c690965773831b46f84a242b417372fc499302b4) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "@m00nbsd",
    "workaround": "",
    "vendorFixDate": "2021-05-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1618",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-755"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29628",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1618/ranges"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=4590f0345956329d414611c6cee300f486732b53",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=6bbde34ae6088285af9d1cc587249c3e7a0159a9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=bb4435255df53118082b3567db6da100962b3822",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/commit/?id=c690965773831b46f84a242b417372fc499302b4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/tag/?h=release/12.3.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://cgit.freebsd.org/src/tag/?h=release/13.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-21:11.smap.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1618/default-remediation-status"
            }
        ]
    }
}