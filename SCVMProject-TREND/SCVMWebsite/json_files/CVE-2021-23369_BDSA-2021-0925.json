{
    "source": "BDSA",
    "name": "BDSA-2021-0925",
    "title": "handlebars.js Vulnerable to Remote Code Execution (RCE) via 'compat' and 'strict' Compilation Modes on Untrusted Templates",
    "description": "handlebars.js, an extension to the Mustache templating language, is vulnerable to remote code execution (RCE) when compiling templates that come from untrusted sources. Successful exploitation also requires certain compilation options to be used.",
    "technicalDescription": "It is possible to inject code into templates that are compiled in `compat` and `strict` modes. According to the vendor the `strict` mode could be exploited via previously published prototype pollution and template injection vulnerabilities, such as `CVE-2019-19919` (described in `BDSA-2019-3145`), or an exploit described [here](http://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html).\n\nThe vulnerability was fixed by checking prototype property access in `strict` mode and escaping property names in `compat` mode.",
    "publishedDate": "2021-04-13T13:55:48.988Z",
    "updatedDate": "2022-02-15T09:42:56.914Z",
    "disclosureDate": "2021-02-15T00:00:00.000Z",
    "exploitPublishDate": "2021-02-15T00:00:00.000Z",
    "solution": "Fixed in [**4.7.7**](https://github.com/handlebars-lang/handlebars.js/releases/tag/v4.7.7) by [this](https://github.com/handlebars-lang/handlebars.js/commit/f0589701698268578199be25285b2ebea1c1e427) and [this](https://github.com/handlebars-lang/handlebars.js/commit/b6d3de7123eebba603e321f04afdbae608e8fea8) commit.\n\nThe latest stable releases are available [here](https://github.com/handlebars-lang/handlebars.js/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Francois Lajeunesse-Robert",
    "workaround": "A fix for the **3.x** branch is proposed in [this](https://github.com/handlebars-lang/handlebars.js/pull/1751) pull request which has not yet been merged.",
    "vendorFixDate": "2021-02-13T00:00:00.000Z",
    "vendorNotifiedDate": "2021-01-08T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0925",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23369",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0925/ranges"
            },
            {
                "rel": "reference",
                "href": "http://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/commit/b6d3de7123eebba603e321f04afdbae608e8fea8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/commit/f0589701698268578199be25285b2ebea1c1e427",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/issues/1736",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/pull/1751",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/handlebars-lang/handlebars.js/releases/tag/v4.7.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-HANDLEBARS-1056767",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-HANDLEBARS-1056767",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0925/default-remediation-status"
            }
        ]
    }
}