{
    "source": "BDSA",
    "name": "BDSA-2019-4378",
    "title": "libgit2 Vulnerable to Arbitrary File Overwrite and Remote Code Execution (RCE) via 'short name' Attacks",
    "description": "libgit2 contains an arbitrary file overwrite vulnerability which could lead to remote code execution (RCE) due to mishandling of equivalent filenames. An attacker could exploit this vulnerability to execute arbitrary code when cloning a repository.",
    "technicalDescription": "The `checkout_verify_paths` function in `src/checkout.c` incorrectly handles filenames where NTFS short names are used. This could allow an attacker to overwrite files in the `.git` directory and parts of the repository, which could lead to RCE when cloning a repository.\n\nThis issue primarily affects applications running Windows Subsystem for Linux (WSL), however under the right circumstances this could effect any system accessing an NTFS filesystem, including Linux and macOS.",
    "publishedDate": "2020-04-28T14:42:16.066Z",
    "updatedDate": "2021-08-03T14:34:35.687Z",
    "disclosureDate": "2019-09-18T00:00:00.000Z",
    "solution": "Fixed in versions:\n* **[0.27.10](https://github.com/libgit2/libgit2/releases/tag/v0.27.10)** by [this](https://github.com/libgit2/libgit2/commit/ca8a4cd36) commit.\n* **[0.28.4](https://github.com/libgit2/libgit2/releases/tag/v0.28.4)** by [this](https://github.com/libgit2/libgit2/commit/7bf80ab07) commit.\n* **[0.99.0](https://github.com/libgit2/libgit2/releases/tag/v0.99.0)** by [this](https://github.com/libgit2/libgit2/commit/64c612cc3) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-09-18T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4378",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-12279",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4378/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/commit/64c612cc3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/commit/64c612cc3e25eff5fb02c59ef5a66ba7a14751e4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/commit/7bf80ab07",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/commit/ca8a4cd36",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/releases/tag/v0.27.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/releases/tag/v0.28.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/releases/tag/v0.99.0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/libgit2/libgit2/releases/tag/v0.99.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4378/default-remediation-status"
            }
        ]
    }
}