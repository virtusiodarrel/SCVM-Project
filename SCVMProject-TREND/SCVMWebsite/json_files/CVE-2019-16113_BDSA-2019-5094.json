{
    "source": "BDSA",
    "name": "BDSA-2019-5094",
    "title": "Bludit Vulnerable to Remote Code Execution (RCE) via Improper Validation in Admin File Upload Functionality",
    "description": "Bludit is vulnerable to remote code execution (RCE) due to the improper validation within the upload images functionality in the administrative account. An attacker with access to an admin account is able to upload PHP files containing malicious content to the server's `tmp` directory.",
    "technicalDescription": "An attacker can successfully exploit this by uploading a file which is of a valid file type, but modifying the request to change the `filename` to an invalid file type and changing the contents of the file to malicious PHP code.\n\nEven though there is an error that this can not be uploaded, the file does upload to the `tmp` directory. By uploading a new `.htaccess` file to replace the current file, these malicious files can be accessed and executed.\n\nThis was initially thought to be fixed by the maintainer in `upload-images.php` by adding a traversal check on the file name and deleting files in the `tmp` directory later in the process. However a workaround to this fix was discovered soon after, where the value for `uuid` could be manipulated to specify a new folder within the  `tmp`directory. This resulted in a new folder being created in the `tmp` directory containing the uploaded malicious files.\n\nThis was addressed by adding a traversal check on the `uuid` parameter.",
    "publishedDate": "2021-03-17T16:05:01.692Z",
    "updatedDate": "2021-03-17T16:05:01.686Z",
    "disclosureDate": "2019-09-07T00:00:00.000Z",
    "exploitPublishDate": "2019-09-07T00:00:00.000Z",
    "solution": "Fixed in [**3.10.0**](https://github.com/bludit/bludit/releases/tag/3.10.0) by [this](https://github.com/bludit/bludit/commit/a9640ff6b5f2c0fa770ad7758daf24fec6fbf3f5) commit and [this](https://github.com/bludit/bludit/commit/7092697112b8e362703e77de796c05cb61bf63b2) commit. \n\nThe latest stable releases are available [here](https://www.bludit.com/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.2,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Christa",
    "workaround": "",
    "vendorFixDate": "2019-09-08T00:00:00.000Z",
    "vendorNotifiedDate": "2019-09-07T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5094",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-36"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-434"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-16113",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5094/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bludit/bludit/commit/7092697112b8e362703e77de796c05cb61bf63b2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bludit/bludit/commit/a9640ff6b5f2c0fa770ad7758daf24fec6fbf3f5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bludit/bludit/issues/1079",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bludit/bludit/issues/1079",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bludit/bludit/issues/1081",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bludit/bludit/issues/1081",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bludit/bludit/releases/tag/3.10.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/155295/Bludit-Directory-Traversal-Image-File-Upload.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/155295/Bludit-Directory-Traversal-Image-File-Upload.html",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.bludit.com/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5094/default-remediation-status"
            }
        ]
    }
}