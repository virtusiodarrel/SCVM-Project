{
    "source": "BDSA",
    "name": "BDSA-2020-3249",
    "title": "Asterisk Vulnerable to Denial-of-Service (DoS) via SIP Invite Remote Crash in 'res_pjsip_session'",
    "description": "Asterisk is vulnerable to a denial-of-service (DoS) condition due to how returned dialogs are mishandled when receiving a new SIP invite. Under specific circumstances, Asterisk can crash when trying to use this dialog again as it could possibly have been freed.\n\nA remote attacker could use this issue in order to cause Asterisk to crash, impacting the availability of the service to other clients.",
    "technicalDescription": "Asterisk is vulnerable to a denial-of-service (DoS) condition because dialogs can be returned without being locked or referenced when receiving a new SIP Invite. This means it is possible for another thread, under special circumstances and timing, to free this dialog before the thread that created it attempts to use it again.\n\nAn authenticated attacker could use this issue to deny service to other clients, however, it is possible for unauthenticated attackers to make use of this issue if anonymous calling is enabled. Asterisk is affected if a connection oriented protocol is used for the SIP transport (e.g. TCP, TLS).",
    "publishedDate": "2020-11-09T16:19:10.118Z",
    "updatedDate": "2020-11-09T16:19:10.109Z",
    "disclosureDate": "2020-11-05T00:00:00.000Z",
    "exploitPublishDate": "2020-11-06T00:00:00.000Z",
    "solution": "Fixed in Asterisk versions:\n* [**18.0.1**](https://github.com/asterisk/asterisk/releases/tag/18.0.1) by [this](https://github.com/asterisk/asterisk/commit/eed50a17e57817ba7e85bdce253852466639adb0) commit,\n* [**17.8.1**](https://github.com/asterisk/asterisk/releases/tag/17.8.1) by [this](https://github.com/asterisk/asterisk/commit/4bee789d5a6ddcab706a50c195002bab3c4a73e2) commit,\n* [**16.14.1**](https://github.com/asterisk/asterisk/releases/tag/16.14.1) by [this](https://github.com/asterisk/asterisk/commit/f182dfca85f3ef4dc651c58bc70957b1ec0024ae) commit,\n* [**13.37.1**](https://github.com/asterisk/asterisk/releases/tag/13.37.1) by [this](https://github.com/asterisk/asterisk/commit/1f169177ed8ef5f5c00e54bf669b9e50d4b2463d) commit.\n\nFixed in Certified Asterisk version [**16.8-cert5**](https://github.com/asterisk/asterisk/releases/tag/certified%2F16.8-cert5) by [this](https://github.com/asterisk/asterisk/commit/81b48f2d104506bc9e77ef36942d70056b4f8138) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Sandro Gauci",
    "workaround": "",
    "vendorFixDate": "2020-11-05T00:00:00.000Z",
    "vendorNotifiedDate": "2020-10-31T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3249",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-28327",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3249/ranges"
            },
            {
                "rel": "reference",
                "href": "http://downloads.asterisk.org/pub/security/AST-2020-001.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EnableSecurity/advisories/tree/master/ES2020-02-asterisk-tcp-invite-crash",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/EnableSecurity/advisories/tree/master/ES2020-02-asterisk-tcp-invite-crash",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/commit/1f169177ed8ef5f5c00e54bf669b9e50d4b2463d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/commit/4bee789d5a6ddcab706a50c195002bab3c4a73e2",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/commit/81b48f2d104506bc9e77ef36942d70056b4f8138",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/commit/eed50a17e57817ba7e85bdce253852466639adb0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/commit/f182dfca85f3ef4dc651c58bc70957b1ec0024ae",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/releases/tag/13.37.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/releases/tag/16.14.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/releases/tag/17.8.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/releases/tag/18.0.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/asterisk/asterisk/releases/tag/certified%2F16.8-cert5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://issues.asterisk.org/jira/browse/ASTERISK-29057",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3249/default-remediation-status"
            }
        ]
    }
}