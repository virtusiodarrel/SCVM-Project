{
    "source": "BDSA",
    "name": "BDSA-2021-0665",
    "title": "MyBB Vulnerable to SQL Injection (SQLi) via Theme Properties in Theme XML files",
    "description": "MyBB is vulnerable to SQL injection (SQLi) as theme properties included in theme XML files are not escaped properly. Forum administrators could use this vulnerability to read or modify the MyBB database.",
    "technicalDescription": "The vulnerability may be exploited when:\n* a forum administrator with the `Can manage themes?` permission imports a maliciously crafted theme\n* a forum administrator uses the `Export Theme` or `Duplicate Theme` features in the Admin Control Panel\n* a user, for whom the theme has been set, visits a forum page\n\nThe vulnerability was fixed by casting all uses of the `templateset` parameter to `int`.",
    "publishedDate": "2021-03-16T12:16:14.559Z",
    "updatedDate": "2021-03-23T17:11:53.883Z",
    "disclosureDate": "2021-03-10T00:00:00.000Z",
    "exploitPublishDate": "2021-03-22T00:00:00.000Z",
    "solution": "Fixed in [**1.8.26**](https://github.com/mybb/mybb/releases/tag/mybb_1826) by [this](https://github.com/mybb/mybb/commit/561e1c76d85ed92931440730c0e78b63359b27a4) commit.\n\nThe latest stable releases are available [here](https://mybb.com/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor notes that the impact may be reduced when:\n* no themes from untrusted sources are imported\n* the Admin CP's `Can manage themes?` permission is limited to trusted administrators",
    "vendorFixDate": "2021-03-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0665",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-27890",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0665/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mybb/mybb/commit/561e1c76d85ed92931440730c0e78b63359b27a4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mybb/mybb/releases/tag/mybb_1826",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mybb/mybb/security/advisories/GHSA-23m9-w75q-ph4p",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/mybb/mybb/security/advisories/GHSA-23m9-w75q-ph4p",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://mybb.com/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/49696",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.youtube.com/watch?v=xU1Y9_bgoFQ",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0665/default-remediation-status"
            }
        ]
    }
}