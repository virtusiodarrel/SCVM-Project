{
    "source": "BDSA",
    "name": "BDSA-2020-3303",
    "title": "ILIAS Vulnerable to Remote Code Execution (RCE) via 'snoopy.class.inc'",
    "description": "ILIAS contains a remote code execution (RCE) vulnerability because of lack of security measures. An authenticated attacker could exploit this flaw to execute malicious code on the server.",
    "technicalDescription": "ILIAS uses the `Snoopy` library in its `magpierss` module. The `_httpsrequest()` function in this library uses the `exec()` function to call the `curl` command on line 656. Because of lack of security measures, the `curl` command can be used o fetch remote malicious files and upload them to the server. Of course, to exploit this, an attacker needs to know which directory on the server has the appropriate write permissions. When this is done, the attacker can call the uploaded malicious file from the browser and execute malicious commands as shown in the PoC.",
    "publishedDate": "2020-11-11T14:07:20.018Z",
    "updatedDate": "2022-05-11T14:40:03.733Z",
    "disclosureDate": "2020-11-03T00:00:00.000Z",
    "exploitPublishDate": "2020-11-03T00:00:00.000Z",
    "solution": "Fixed in [**6.5**](https://github.com/ILIAS-eLearning/ILIAS/releases/tag/v6.5) and [**5.4.18**](https://github.com/ILIAS-eLearning/ILIAS/releases/tag/v5.4.18) by [this](https://github.com/ILIAS-eLearning/ILIAS/commit/fa10f165476c449efba6d8a3b5a55df77146e96a) commit.\n\nThe latest stable releases are available [here](https://docu.ilias.de/goto.php?target=lm_1719&client_id=docu).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Raimonds Liepins",
    "workaround": "",
    "vendorFixDate": "2020-09-14T00:00:00.000Z",
    "vendorNotifiedDate": "2020-09-06T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3303",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-94"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25268",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3303/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docu.ilias.de/goto.php?target=lm_1719&client_id=docu",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://docu.ilias.de/goto_docu_pg_124776_35.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ILIAS-eLearning/ILIAS/commit/fa10f165476c449efba6d8a3b5a55df77146e96a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ILIAS-eLearning/ILIAS/releases/tag/v5.4.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ILIAS-eLearning/ILIAS/releases/tag/v6.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://medium.com/bugbountywriteup/exploiting-ilias-learning-management-system-4eda9e120620",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://medium.com/bugbountywriteup/exploiting-ilias-learning-management-system-4eda9e120620",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3303/default-remediation-status"
            }
        ]
    }
}