{
    "source": "BDSA",
    "name": "BDSA-2019-1049",
    "title": "Apache Axis Vulnerable to Remote Code Execution (RCE) via Expired Domain Request in 'StockQuoteService' Function",
    "description": "Apache Axis is vulnerable to remote code execution (RCE) due to an example web request that is made to a non-existent domain. An attacker could execute arbitrary code on a victim's Axis server by tricking them into connecting to a malicious web server.",
    "technicalDescription": "Apache Axis contains a script, `StockQuoteService.jws`, that is intended to provide an example Java Web Service. This script uses the `XMLUtils.newDocument()` function to retrieve and parse XML from the domain `www.xmltoday.com`. If the server associated with this domain were to return a crafted HTTP redirect response, it would be possible for that server to trigger RCE on the Axis server that made the request. This is due to errors in how some GET request parameters are parsed. The Axis parsing routine can convert GET request parameters into XML; however, it is possible for attackers to provide parameters that call arbitrary Java classes on the victim's server when they are parsed. The malicious `www.xmltoday.com` server could therefore return a response that redirects the Apache Axis instance to `localhost`, with a request that contains such crafted GET parameters. As Axis will resolve requests to `localhost` using administrative privileges, the attacker can execute their code with administrative privileges as well.\n\nIt should be noted that the `www.xmltoday.com` was registered by the research team that discovered the vulnerability in order to prevent attackers from exploiting it. However, attackers may once again gain the opportunity to exploit this vulnerability should the domain become available again in the future. It could also be possible for an attacker to conduct DNS cache poisoning so that requests to resolve `www.xmltoday` lead the victim to an attacker-controlled server.\n\nAxis servers are also still vulnerable on internal networks.",
    "publishedDate": "2019-04-17T08:35:00.258Z",
    "updatedDate": "2020-02-04T15:57:45.574Z",
    "disclosureDate": "2019-04-09T00:00:00.000Z",
    "exploitPublishDate": "2019-04-09T00:00:00.000Z",
    "solution": "Fixed in [**1.4.1**](https://builds.apache.org/job/axis-trunk/lastSuccessfulBuild/org.apache.axis$distribution/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "David Yesland",
    "workaround": "Delete `StockQuoteService.jws` from the Axis root directory. Ensure that any libraries or services you are running in Axis or Axis2 do not perform HTTP requests or allow users to initiate an HTTP request. Instead, use HTTPS and verify SSL certificates.",
    "vendorFixDate": "2017-06-15T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1049",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-91"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-0227",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1049/ranges"
            },
            {
                "rel": "reference",
                "href": "https://builds.apache.org/job/axis-trunk/lastSuccessfulBuild/org.apache.axis$distribution/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RhinoSecurityLabs/CVEs/tree/master/CVE-2019-0227",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://rhinosecuritylabs.com/application-security/cve-2019-0227-expired-domain-rce-apache-axis/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1049/default-remediation-status"
            }
        ]
    }
}