{
    "source": "BDSA",
    "name": "BDSA-2021-3456",
    "title": "BusyBox Vulnerable to Information Disclosure and Denial-of-Service (DoS) via Out-of-Bounds Read in 'unpack_lzma_stream' Function",
    "description": "BusyBox is vulnerable to information exposure due to an invalid memory access operation. A local attacker could recover data from memory by passing a maliciously crafted file to the `unlzma` utility. It is also possible for an attacker to cause the application to crash.",
    "technicalDescription": "The function `unpack_lzma_stream()`, of file `archival/libarchive/decompress_unlzma.c`, is used to decompress LZMA archives. The function uses the value of the variable `pos` as an index to access the buffer `buffer`. The value of `pos` is dynamically calculated based on the properties of the archive that is being processed. However, the value of `pos` is insufficiently validated. For certain LZMA files, the value of `pos` will correspond to an index that lies outside of the boundaries of `buffer`. This will lead to the occurrence of an out-of-bounds read event. An attacker could therefore use a maliciously crafted LZMA file in order to leak information from memory. The attacker could also cause the application to crash.\n\nThe vulnerability was fixed via code that performs additional validation on the value of `pos.`",
    "publishedDate": "2021-11-16T16:23:05.964Z",
    "updatedDate": "2021-11-16T16:23:05.941Z",
    "disclosureDate": "2021-11-09T00:00:00.000Z",
    "exploitPublishDate": "2021-11-09T00:00:00.000Z",
    "solution": "Fixed in version [**1.34.0**](https://www.busybox.net/downloads/) by [this](https://git.busybox.net/busybox/commit/?h=1_34_stable&id=04f052c56ded5ab6a904e3a264a73dc0412b2e78) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.6,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.8
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.7,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "If it is not possible to upgrade BusyBox earlier versions can be compiled without the vulnerable applet as a workaround.\n\nAfter running `make defconfig` in BusyBox\u2019s source directory (or if reusing a previous configuration), edit the `.config` file as such:\n\n`lzma` \u2013 Comment out `CONFIG_UNLZMA=y, CONFIG_FEATURE_SEAMLESS_LZMA=y and CONFIG_FEATURE_UNZIP_LZMA=y`",
    "vendorFixDate": "2021-06-15T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3456",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-190"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-42374",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3456/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.busybox.net/busybox/commit/?h=1_34_stable&id=04f052c56ded5ab6a904e3a264a73dc0412b2e78",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://jfrog.com/blog/unboxing-busybox-14-new-vulnerabilities-uncovered-by-claroty-and-jfrog/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://jfrog.com/blog/unboxing-busybox-14-new-vulnerabilities-uncovered-by-claroty-and-jfrog/",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://jfrog.com/blog/unboxing-busybox-14-new-vulnerabilities-uncovered-by-claroty-and-jfrog/",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.busybox.net/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3456/default-remediation-status"
            }
        ]
    }
}