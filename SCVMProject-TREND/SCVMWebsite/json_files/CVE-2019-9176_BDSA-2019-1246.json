{
    "source": "BDSA",
    "name": "BDSA-2019-1246",
    "title": "GitLab CE/EE Vulnerable to Cross-site Request Forgery (CSRF) via Kubernetes Cluster Integration",
    "description": "GitLab CE/EE are vulnerable to cross-site request forgery (CSRF) due to a failure to validate the session key during the process of adding a Kubernetes cluster when authorizing with Google Cloud Platform (GCP). An attacker could leverage this flaw by tricking an authenticated user into clicking on a malicious link. If the victim subsequently tries to add a Kubernetes cluster the project will default to a cluster controlled by the attacker. This can ultimately lead to confidential code being deployed to the attacker's server.",
    "technicalDescription": "Current implementation does not validate the session key when attempting to link a GCP account to a GitLab account. This allows an attacker to craft a malicious link with a callback URL which, when clicked by the victim,  will overwrite an existing Kubernetes integration with the attacker's cluster.\n\nThe issue has been fixed by adding validation which will reject the callback if the state parameter does not match the one added to the initiating user's session.",
    "publishedDate": "2019-04-24T15:14:14.239Z",
    "updatedDate": "2019-04-24T15:14:14.228Z",
    "disclosureDate": "2019-04-05T00:00:00.000Z",
    "exploitPublishDate": "2019-04-05T00:00:00.000Z",
    "solution": "Fixed in GitLab CE:\n* [**11.6.10**](https://gitlab.com/gitlab-org/gitlab-ce/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/76caad550a8fe1295e58c469f9512522015f18e3) commit,\n* [**11.7.6**](https://gitlab.com/gitlab-org/gitlab-ce/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/1461913399038aefd786dc807ee5e3361639a565) commit and\n* [**11.8.1**](https://gitlab.com/gitlab-org/gitlab-ce/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ce/commit/e8ec0410490c0e58813e9af03be892da8954d73a) commit.\n\nFixed in GitLab EE:\n* [**11.6.10**](https://gitlab.com/gitlab-org/gitlab-ee/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ee/commit/76caad550a8fe1295e58c469f9512522015f18e3) commit,\n* [**11.7.6**](https://gitlab.com/gitlab-org/gitlab-ee/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ee/commit/1461913399038aefd786dc807ee5e3361639a565) commit and\n* [**11.8.1**](https://gitlab.com/gitlab-org/gitlab-ee/tags) by [this](https://gitlab.com/gitlab-org/gitlab-ee/commit/e8ec0410490c0e58813e9af03be892da8954d73a) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 1.6,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "cache-money",
    "workaround": "",
    "vendorFixDate": "2019-02-13T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1246",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-352"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9176",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1246/ranges"
            },
            {
                "rel": "reference",
                "href": "https://about.gitlab.com/2019/03/04/security-release-gitlab-11-dot-8-dot-1-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/commit/1461913399038aefd786dc807ee5e3361639a565",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/commit/76caad550a8fe1295e58c469f9512522015f18e3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/commit/e8ec0410490c0e58813e9af03be892da8954d73a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/issues/55664",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ce/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ee/commit/1461913399038aefd786dc807ee5e3361639a565",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ee/commit/76caad550a8fe1295e58c469f9512522015f18e3",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ee/commit/e8ec0410490c0e58813e9af03be892da8954d73a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/gitlab-org/gitlab-ee/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1246/default-remediation-status"
            }
        ]
    }
}