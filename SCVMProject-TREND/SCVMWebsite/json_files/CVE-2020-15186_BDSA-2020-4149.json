{
    "source": "BDSA",
    "name": "BDSA-2020-4149",
    "title": "Helm Vulnerable to Unauthorized Behavior Modification via Insufficient Plugin Name Validation",
    "description": "Helm is vulnerable to unauthorized behavior modification due to the insufficient validation of plugin names during the installation process. An attacker could trigger unexpected behavior in Helm by tricking a victim into installing a maliciously crafted plugin.",
    "technicalDescription": "The file `cmd/helm/plugin_install.go` contains code that is used by Helm in order to install plugins. The names of plugins should only contain alphanumeric, underscore, or hyphen characters. Helm performs insufficient validation to ensure that this is the case for plugins that are being installed. If a plugin name contains invalid characters, then unexpected behavior can ensue. Such behavior includes name duplication, or spoofing the output of certain commands (e.g. `helm --help`).",
    "publishedDate": "2021-02-05T16:54:29.641Z",
    "updatedDate": "2021-02-05T16:54:29.634Z",
    "disclosureDate": "2020-09-17T00:00:00.000Z",
    "solution": "Fixed in [**3.3.2**](https://github.com/helm/helm/releases/tag/v3.3.2) by [this](https://github.com/helm/helm/commit/c50b74f93709ac3a390b86bff7fbcb6cf9468fc8) commit, and in [**2.16.11**](https://github.com/helm/helm/releases/tag/v2.16.11) by [this](https://github.com/helm/helm/commit/6aab63765f99050b115f0aec3d6350c85e8da946) commit.\n\nThe latest stable releases are available [here](https://github.com/helm/helm/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated that the following workaround is effective:\n> Do not install untrusted Helm plugins. Examine the name field in the plugin.yaml file for a plugin, looking for characters outside of the [a-zA-Z0-9._-] range.",
    "vendorFixDate": "2020-09-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 2.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4149",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15186",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4149/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/commit/6aab63765f99050b115f0aec3d6350c85e8da946",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/commit/c50b74f93709ac3a390b86bff7fbcb6cf9468fc8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases/tag/v2.16.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases/tag/v3.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/security/advisories/GHSA-m54r-vrmv-hw33",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/security/advisories/GHSA-m54r-vrmv-hw33",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4149/default-remediation-status"
            }
        ]
    }
}