{
    "source": "BDSA",
    "name": "BDSA-2021-0508",
    "title": "Synapse Vulnerable to Open Redirects via Federation and Push Requests",
    "description": "Synapse is vulnerable to open redirects due to allowing user provided domains to make requests to the internal infrastructure's addresses. This vulnerability can be triggered when calculating the key validity for third-party invite events and sending push notifications.",
    "technicalDescription": "The vulnerability was fixed by introducing a new `ip_range_blacklist` for push and key revocation requests. The list contains improved default IP address restrictions and replaces the previously used `federation_ip_range_blacklist`. For better protection the vendor also advises removing the deprecated `federation_ip_range_blacklist` after upgrading to **1.25**.",
    "publishedDate": "2021-03-02T17:18:01.839Z",
    "updatedDate": "2021-03-02T17:18:01.833Z",
    "disclosureDate": "2021-02-25T00:00:00.000Z",
    "solution": "Fixed in **[1.25.0-rc1](https://github.com/matrix-org/synapse/releases/tag/v1.25.0rc1)** by [this](https://github.com/matrix-org/synapse/commit/30fba6210834a4ecd91badf0c8f3eb278b72e746) commit.\n\nThe latest stable releases are available [here](https://github.com/matrix-org/synapse/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "mscherer (GitHub)",
    "workaround": "Requests to internal IP addresses could be blocked at the system or network level.",
    "vendorFixDate": "2020-12-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0508",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-601"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21273",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0508/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/synapse/commit/30fba6210834a4ecd91badf0c8f3eb278b72e746",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/synapse/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/synapse/releases/tag/v1.25.0rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/synapse/security/advisories/GHSA-v936-j8gp-9q3p",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/matrix-org/synapse/security/advisories/GHSA-v936-j8gp-9q3p",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0508/default-remediation-status"
            }
        ]
    }
}