{
    "source": "BDSA",
    "name": "BDSA-2021-0744",
    "title": "Keycloak Vulnerable to Reflected Cross-Site Scripting (XSS) via Referrer URL in New Account Console",
    "description": "Keycloak is vulnerable to reflected cross-site scripting (XSS) via referrer URL in the new account console. This could allow an attacker to inject arbitrary web scripts and obtain sensitive information such as authentication tokens and user session cookies.",
    "technicalDescription": "This issue occurs in the `themes/src/main/resources/theme/keycloak.v2/account/index.ftl` file due to unescaped referrer URLs. It was mitigated by the addition of escaping via `replace('&amp;', '&')`.\n\n**Note**: In versions **9.0.0** - **11.0.1** the new account console is available but not enabled by default.",
    "publishedDate": "2021-03-25T14:12:39.771Z",
    "updatedDate": "2021-03-26T15:58:36.801Z",
    "disclosureDate": "2021-02-03T00:00:00.000Z",
    "solution": "Fixed in [**12.0.3**](https://github.com/keycloak/keycloak/releases/tag/12.0.3) by [this](https://github.com/keycloak/keycloak/commit/010d7eb0ce9e3b5ee8131a7a0d7400b21deeae50) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.1,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Manh Van Nguyen ( ManhNV)",
    "workaround": "",
    "vendorFixDate": "2021-03-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0744",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-79"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-20222",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0744/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1924606",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/commit/010d7eb0ce9e3b5ee8131a7a0d7400b21deeae50",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/keycloak/keycloak/releases/tag/12.0.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0744/default-remediation-status"
            }
        ]
    }
}