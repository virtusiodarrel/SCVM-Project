{
    "source": "BDSA",
    "name": "BDSA-2022-1633",
    "title": "Guzzle Vulnerable to Sensitive Data Exposure via Forwarded 'Cookie' Header",
    "description": "A sensitive data exposure vulnerability has been identified in Guzzle. Cookies were not correctly stripped upon requests made using the `https` scheme to a server which responds with a redirect to a URI with the `http` scheme, or on requests made to a server which responds with a redirect to a URI on a different host. Successful exploitation of this vulnerability could allow an attacker to view the cookie.",
    "technicalDescription": "",
    "publishedDate": "2022-06-13T10:13:04.647Z",
    "updatedDate": "2022-06-13T10:13:04.629Z",
    "disclosureDate": "2022-06-09T00:00:00.000Z",
    "solution": "Fixed in [**6.5.7**](https://github.com/guzzle/guzzle/releases/tag/6.5.7) by [this](https://github.com/guzzle/guzzle/commit/724562fa861e21a4071c652c8a159934e4f05592) commit.\nFixed in [**7.4.4**](https://github.com/guzzle/guzzle/releases/tag/7.4.4) by [this](https://github.com/guzzle/guzzle/commit/e3ff079b22820c2029d4c2a87796b6a0b8716ad8) commit.\n\nThe latest stable releases can be found [here](https://github.com/guzzle/guzzle/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "GrahamCampbell, amammad",
    "workaround": "Per the Vendor, \"An alternative approach would be to use your own redirect middleware, rather than ours, if you are unable to upgrade. If you do not require or expect redirects to be followed, one should simply disable redirects all together.\".",
    "vendorFixDate": "2022-06-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1633",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31042",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1633/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/commit/724562fa861e21a4071c652c8a159934e4f05592",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/commit/e3ff079b22820c2029d4c2a87796b6a0b8716ad8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/releases/tag/6.5.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/releases/tag/7.4.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/security/advisories/GHSA-f2wf-25xc-69c9",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/guzzle/guzzle/security/advisories/GHSA-f2wf-25xc-69c9",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.drupal.org/sa-core-2022-011",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1633/default-remediation-status"
            }
        ]
    }
}