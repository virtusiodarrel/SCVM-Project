{
    "source": "BDSA",
    "name": "BDSA-2022-1442",
    "title": "GoCD Vulnerable to Remote Code Execution (RCE) via Command Injection in Mercurial Hooks/Aliases",
    "description": "GoCD contains a remote code execution (RCE) vulnerability. This vulnerability allows a remote attacker with certain administrator privileges to perform command injection attacks against the GoCD server.  This in turn can lead to remote code execution.",
    "technicalDescription": "The RCE vulnerability is due to a lack of sanitization on Mercurial commands (`hg`) being ran in `domain/src/main/java/com/thoughtworks/go/domain/materials/mercurial/HgCommand.java`. Commands such as `pull` and `clone` use the use supplied \"branch\" argument without sanitizing the parameter.  This allows an attacker that is able to modify a branch name is able to inject additional commands to be executed with the permissions of underlaying GoCD server.\n\nFor an attacker to successfully exploit this vulnerability, the attacker would require access to an account with existing GoCD administration permissions to either:\n\n* create/edit (hg-based) configuration repositories.\n* create/edit pipelines and their (hg-based) materials.\n* where \"pipelines-as-code\" configuration repositories are used, to commit malicious configuration to such an external repository which will be automatically parsed into a pipeline configuration and (hg) material definition by the GoCD serve.",
    "publishedDate": "2022-05-24T15:57:10.072Z",
    "updatedDate": "2022-09-27T13:27:09.686Z",
    "disclosureDate": "2022-05-09T00:00:00.000Z",
    "solution": "Fixed in version [**22.1.0**](https://github.com/gocd/gocd/releases/tag/22.1.0) by [this](https://github.com/gocd/gocd/commit/37d35115db2ada2190173f9413cfe1bc6c295ecb) commit.\n\nThe latest stable releases can be found [here](https://github.com/gocd/gocd/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Alessio Della Libera, Ketan Padegaonkar, Chad Wilson",
    "workaround": "The vendor states that, \n\n> As a workaround, users who do not use/rely upon Mercurial materials can uninstall/remove the `hg`/Mercurial binary from the underlying GoCD Server operating system or Docker image.",
    "vendorFixDate": "2022-03-04T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1442",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-29184",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1442/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gocd/gocd/commit/37d35115db2ada2190173f9413cfe1bc6c295ecb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gocd/gocd/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gocd/gocd/releases/tag/22.1.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gocd/gocd/security/advisories/GHSA-vf5r-r7j2-cf2h",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/gocd/gocd/security/advisories/GHSA-vf5r-r7j2-cf2h",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.gocd.org/releases/#22-1-0",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1442/default-remediation-status"
            }
        ]
    }
}