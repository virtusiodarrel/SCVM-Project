{
    "source": "BDSA",
    "name": "BDSA-2020-3711",
    "title": "Libcurl Vulnerable to Authentication Bypass via Improper Certificate Validation in 'OCSP Stapling' Functionality",
    "description": "Libcurl does not properly validate certificates when the `OCSP Stapling` functionality is being used. Attackers can exploit this flaw to cause an authentication bypass condition by substituting the `OCSP` response with one which results in a successful validation.",
    "technicalDescription": "The application allows users to enable the `OCSP Stapling` functionality using `CURLOPT_SSL_VERIFYSTATUS`. This functionality is used to verify the OCSP response received from the server during TLS handshake. However, this functionality does not verify whether the certificate serial number from the OCSP response is the same as the actual serial number of the certificate. An attacker could submit a crafted OCSP response to the application which will end up getting validated even if the corresponding certificate is a revoked one. Thus, the attacker can establish a validated connection between the application and a malicious website using a crafted OCSP response. \n\n**Note** This vulnerability only affects installations where OpenSSL is being used as the TLS backend. Also, the `OCSP Stapling` is not enabled by default. It has to be explicitly enabled.",
    "publishedDate": "2020-12-10T14:34:56.061Z",
    "updatedDate": "2021-01-08T12:11:20.774Z",
    "disclosureDate": "2020-12-09T00:00:00.000Z",
    "exploitPublishDate": "2020-12-01T00:00:00.000Z",
    "solution": "Fixed in [**7.74.0**](https://github.com/curl/curl/releases/tag/curl-7_74_0) by [this](https://github.com/curl/curl/commit/d9d01672785b8ac04aab1abb6de95fe3072ae199) commit.\n\nThe latest stable releases are available [here](https://github.com/curl/curl/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Ospoco",
    "workaround": "Apart from upgrading to v7.74.0, the vendor has stated that the users should not rely on OCSP. Also, they should use use GnuTLS as a backend instead of OpenSSL.",
    "vendorFixDate": "2020-12-07T00:00:00.000Z",
    "vendorNotifiedDate": "2020-12-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3711",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-299"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-8286",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3711/ranges"
            },
            {
                "rel": "reference",
                "href": "https://curl.se/docs/CVE-2020-8286.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/d1cf5d570663dac157740cb5e49d24614f185da7",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/commit/d9d01672785b8ac04aab1abb6de95fe3072ae199",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/curl/curl/releases/tag/curl-7_74_0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1048457",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1048457",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1048457",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3711/default-remediation-status"
            }
        ]
    }
}