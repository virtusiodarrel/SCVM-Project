{
    "source": "BDSA",
    "name": "BDSA-2021-4135",
    "title": "Contao Vulnerable to Cross-Site Scripting (XSS) via HTML Attributes",
    "description": "Contao is vulnerable to cross-site scripting (XSS) due to improper validation of user-supplied input. This would allow an attacker to inject malicious JavaScript code in to both the back end and front end of the application while using HTML fields. This could lead to an attacker stealing sensitive information such as session cookies or authentication tokens.",
    "technicalDescription": "The cross-site scripting vulnerability occurs due to improper sanitization of HTML attributes in Contao. The attacker can include malicious scripting code in these so that when the preview button is clicked in the back end and when launching the front end, these scripts will be executed to steal sensitive information.\n\nThe vulnerability has been mitigated by introducing a series of data encoding techniques which convert untrusted input into its translated form so that malicious code isn't executed when the back end preview and front end is launched.",
    "publishedDate": "2022-02-22T15:05:11.266Z",
    "updatedDate": "2022-02-22T15:40:11.510Z",
    "disclosureDate": "2021-08-11T00:00:00.000Z",
    "exploitPublishDate": "2021-08-11T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**4.4.56**](https://github.com/contao/contao/releases/tag/4.4.56) by [this](https://github.com/contao/contao/commit/fecfb24f9bc2833beeb5acc355de16f5dde8c48c) commit.\n* [**4.9.18**](https://github.com/contao/contao/releases/tag/4.9.18) by [this](https://github.com/contao/contao/commit/dd0ad7b732aa8fbd0fb869aef94aad61a7102489) commit.\n* [**4.11.7**](https://github.com/contao/contao/releases/tag/4.11.7) by [this](https://github.com/contao/contao/commit/8e9edfb376bea50e205edf3857d5b008d97af70e) commit.\n\nThe latest stable releases can be found [here](https://github.com/contao/contao/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.4,
        "impactSubscore": 2.7,
        "exploitabilitySubscore": 2.3,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Mikhail Khramenko/Moritz Vondano",
    "workaround": "The vendor has provided the following workaround:  \"Disable all fields that allow HTML for untrusted back end users or disable the login for these users.\"",
    "vendorFixDate": "2021-08-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4135",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-35955",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4135/ranges"
            },
            {
                "rel": "reference",
                "href": "https://contao.org/en/security-advisories/cross-site-scripting-via-html-attributes-in-the-back-end.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/commit/8e9edfb376bea50e205edf3857d5b008d97af70e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/commit/dd0ad7b732aa8fbd0fb869aef94aad61a7102489",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/commit/fecfb24f9bc2833beeb5acc355de16f5dde8c48c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/commit/fecfb24f9bc2833beeb5acc355de16f5dde8c48c",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/releases/tag/4.11.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/releases/tag/4.4.56",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/releases/tag/4.9.18",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/security/advisories/GHSA-hr3h-x6gq-rqcp",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/security/advisories/GHSA-hr3h-x6gq-rqcp",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/contao/contao/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4135/default-remediation-status"
            }
        ]
    }
}