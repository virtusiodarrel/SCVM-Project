{
    "source": "BDSA",
    "name": "BDSA-2019-1958",
    "title": "Django Vulnerable to Stored Cross-site Scripting (XSS) via 'Current URL' Link Generated by 'AdminURLFieldWidget'",
    "description": "Django contains a stored cross-site scripting (XSS) vulnerability.  This allows an authenticated attacker with administrative privileges to store URLs containing JavaScript in the backend database.  These can be supplied to the clickable \"Current URL\" link.",
    "technicalDescription": "The XSS vulnerability is due to a lack of sanitization on the input passed to the `get_context()` method in the `AdminURLFieldWidget` class in `django/contrib/admin/widgets.py`.  This class can be used to generate the current URL. It is possible to modify the URL to contain malicious JavaScript. This may then later be stored in the database as a valid URL.",
    "publishedDate": "2019-07-03T09:33:35.294Z",
    "updatedDate": "2019-07-03T09:33:35.284Z",
    "disclosureDate": "2019-06-03T00:00:00.000Z",
    "solution": "Fixed in versions:\n\n* [**2.2.2**](https://github.com/django/django/releases/tag/2.2.2) by [this](https://github.com/django/django/commit/afddabf8428ddc89a332f7a78d0d21eaf2b5a673) commit.\n* [**2.1.9**](https://github.com/django/django/releases/tag/2.1.9) by [this](https://github.com/django/django/commit/09186a13d975de6d049f8b3e05484f66b01ece62) commit.\n* [**1.11.21**](https://github.com/django/django/releases/tag/1.11.21) by [this](https://github.com/django/django/commit/c238701859a52d584f349cce15d56c8e8137c52b) commit.\n\nAdditional versions can be found [here](https://github.com/django/django/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.6,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.3
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-05-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1958",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-12308",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1958/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/09186a13d975de6d049f8b3e05484f66b01ece62",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/afddabf8428ddc89a332f7a78d0d21eaf2b5a673",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/c238701859a52d584f349cce15d56c8e8137c52b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/commit/deeba6d92006999fee9adfbd8be79bf0a59e8008",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/1.11.21",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/2.1.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/django/django/releases/tag/2.2.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.djangoproject.com/weblog/2019/jun/03/security-releases/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1958/default-remediation-status"
            }
        ]
    }
}