{
    "source": "BDSA",
    "name": "BDSA-2019-2635",
    "title": "OpenEMR Vulnerable to Arbitrary File Download and Denial-of-Service (DoS) via Path Traversal in 'filename' Parameter",
    "description": "OpenEMR is vulnerable to path traversal due to improper validation on a user-controlled parameter. This can allow an attacker to access arbitrary files to obtain sensitive information and also to delete files from the server containing scripts for default configuration. The removal of these files can result in a denial-of-service (DoS) condition.",
    "technicalDescription": "This vulnerability exists in the file `custom/ajax_download.php` where an attacker could exploit the improper validation on the `filename` parameter, to traverse paths and download arbitrary files contained in `www-data`. An attacker must be authorized to exploit this vulnerability.\n\nFor an attacker to successfully exploit to cause a denial-of-service condition, the directory `/sites/default/documents/cqm_qrda/` must exist on the server and the path to the accessible file must only contain existing directories due to the current logic of the function `unlink()`. An attacker is able to create this directory and delete the `configs/php` scripts from the server.",
    "publishedDate": "2019-09-04T11:00:32.217Z",
    "updatedDate": "2021-06-22T08:22:28.251Z",
    "disclosureDate": "2019-08-13T00:00:00.000Z",
    "exploitPublishDate": "2019-08-13T00:00:00.000Z",
    "solution": "Fixed in [**5.0.2**](https://github.com/openemr/openemr/releases/tag/v5_0_2) by [this](https://github.com/openemr/openemr/commit/51851dbbd01631fafdced231237396af0e657990) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Wezery",
    "workaround": "",
    "vendorFixDate": "2019-08-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2635",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-36"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-14530",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2635/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Wezery/CVE-2019-14530",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Wezery/CVE-2019-14530",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/commit/51851dbbd01631fafdced231237396af0e657990",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/pull/2592",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/releases/tag/v5_0_2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/50037",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2635/default-remediation-status"
            }
        ]
    }
}