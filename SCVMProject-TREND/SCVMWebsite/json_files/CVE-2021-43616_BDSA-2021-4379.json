{
    "source": "BDSA",
    "name": "BDSA-2021-4379",
    "title": "npm Vulnerable to Invalid Dependency Installation via Insufficient Validation of Lock Files During 'ci' Command Execution",
    "description": "npm is vulnerable to an invalid dependency installation issue due to how lock files are not sufficiently validated. As a result of this issue, the `ci` command can carry out an installation despite differences in dependency information between files, like  `package-lock.json` and `package.json` for example. \n\nThis could cause malware to be inadvertently installed when it was otherwise supposed to be blocked by the lock file. This is inconsistent behavior and does not match the documentation which is available to read [here](https://docs.npmjs.com/cli/v7/commands/npm-ci).",
    "technicalDescription": "To remedy this issue, the vendor has implemented the new `lib/utils/validate-lockfile.js` file containing the `validateLockfile()` function that can throw an error in cases where dependencies being installed do not match those listed in the appropriate lock file.",
    "publishedDate": "2022-05-09T14:58:45.337Z",
    "updatedDate": "2022-05-09T14:58:45.323Z",
    "disclosureDate": "2021-02-15T00:00:00.000Z",
    "exploitPublishDate": "2021-02-15T00:00:00.000Z",
    "solution": "Fixed in [**8.4.1**](https://github.com/npm/cli/releases/tag/v8.4.1) by [this](https://github.com/npm/cli/commit/457e0ae61bbc55846f5af44afa4066921923490f) commit.\n\nThe latest stable releases are available [here](https://github.com/npm/cli/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.3,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.6,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-02-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4379",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-345"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43616",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4379/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.npmjs.com/cli/v7/commands/npm-ci",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/icatalina/CVE-2021-43616",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/cli/commit/457e0ae61bbc55846f5af44afa4066921923490f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/cli/issues/2701",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/cli/issues/2701",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/cli/issues/3947",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/cli/pull/4363",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/cli/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/npm/cli/releases/tag/v8.4.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4379/default-remediation-status"
            }
        ]
    }
}