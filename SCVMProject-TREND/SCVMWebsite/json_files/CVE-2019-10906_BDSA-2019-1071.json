{
    "source": "BDSA",
    "name": "BDSA-2019-1071",
    "title": "Pallets Jinja Vulnerable to Sandbox Escape via 'str.format_map()' String Class Method",
    "description": "Pallets Jinja is vulnerable to sandbox environment escapes due to the use of a dangerous string class method. An attacker could supply crafted strings in order to discover sensitive information about the environment, such as configuration values.",
    "technicalDescription": "Python's standard library implements a `string` class which utilizes a method called `format_map()`. This method is intended to be used for variable substitutions and value formatting, in a similar manner to the `format()` method. However, its functionality can be dangerous when used in a Jinja sandboxed environment. If the application accepts a user-supplied format string as input, and that input is used with the `format_map()` method without validation, an attacker could potentially discover various values that have been set within the environment. For example they could extract the values of configuration variables that have been set prior to the call to the `format_map()` method.",
    "publishedDate": "2019-04-16T08:53:25.951Z",
    "updatedDate": "2019-04-16T08:53:25.933Z",
    "disclosureDate": "2019-04-06T00:00:00.000Z",
    "solution": "Fixed in version [**2.10.1**](https://github.com/pallets/jinja/releases/tag/2.10.1) by [this](https://github.com/pallets/jinja/commit/a2a6c930bcca591a25d2b316fcfd2d6793897b26) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.6
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Brian Welch",
    "workaround": "If you cannot upgrade Jinja, you can override the is_safe_attribute method on the sandbox and explicitly disallow the format_map method on string objects.",
    "vendorFixDate": "2019-04-06T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1071",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-749"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10906",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1071/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pallets/jinja/commit/a2a6c930bcca591a25d2b316fcfd2d6793897b26",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pallets/jinja/releases/tag/2.10.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://palletsprojects.com/blog/jinja-2-10-1-released/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1071/default-remediation-status"
            }
        ]
    }
}