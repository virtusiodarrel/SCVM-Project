{
    "source": "BDSA",
    "name": "BDSA-2019-3323",
    "title": "Elastic Kibana Vulnerable to Local File Disclosure via Malicious Code Repository",
    "description": "The Code application in Elastic Kibana is vulnerable to local file disclosure. An attacker can take advantage of this to read files from the system on which Kibana is running with the permissions of the Kibana user.",
    "technicalDescription": "If a malicious code repository is imported into Code, an attacker can read arbitrary files from the file system on which Kibana is running with the permissions of the Kibana user.\n\nCode is currently disabled by default in Kibana. This vulnerability does not apply if the line ` xpack.code.ui.enabled: true` is not present in the `kibana.yml` configuration file.",
    "publishedDate": "2019-10-25T15:14:24.759Z",
    "updatedDate": "2020-07-15T11:46:42.690Z",
    "disclosureDate": "2019-08-01T00:00:00.000Z",
    "solution": "Fixed in [**7.4.0**](https://github.com/elastic/kibana/releases/tag/v7.4.0).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.6,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "If users cannot upgrade Elasticsearch the Code application in Kibana can be disabled by setting `xpack.code.ui.enabled: false` in `kibana.yml`.",
    "vendorFixDate": "2019-08-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3323",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-7618",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3323/ranges"
            },
            {
                "rel": "reference",
                "href": "https://discuss.elastic.co/t/elastic-stack-7-4-0-security-update/201831",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/elastic/kibana/releases/tag/v7.4.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3323/default-remediation-status"
            }
        ]
    }
}