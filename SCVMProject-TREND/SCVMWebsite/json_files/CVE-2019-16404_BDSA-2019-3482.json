{
    "source": "BDSA",
    "name": "BDSA-2019-3482",
    "title": "OpenEMR Vulnerable to SQL Injection (SQLi) via 'INSERT INTO' Statement in 'interface/forms/eye_mag/js/eye_base.php'",
    "description": "OpenEMR is vulnerable to SQL injection (SQLi) due to improper validation on user-supplied input. This allows a remote authenticated attacker to extract, modify, and delete information from the underlying database.",
    "technicalDescription": "The vulnerability exists in `INSERT INTO` statement in `interface/forms/eye_mag/js/eye_base.php`. An attacker could construct an arbitrary query inside `updatexml()`, a native function, and pass it as one of the arguments in the original query. The attacker's payload will be executed and its results will be displayed as part of the error that will appear due to incorrect use of `updatexml()` function.",
    "publishedDate": "2019-11-14T14:33:37.156Z",
    "updatedDate": "2019-11-14T14:33:37.146Z",
    "disclosureDate": "2019-09-17T00:00:00.000Z",
    "exploitPublishDate": "2019-10-18T00:00:00.000Z",
    "solution": "Fixed in [**5.0.2.1**](https://github.com/openemr/openemr/releases/tag/v5_0_2_1) by [this](https://github.com/openemr/openemr/commit/cd96478bdb9b67397916dd850133969d0bef6773) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Will Porter",
    "workaround": "",
    "vendorFixDate": "2019-09-17T00:00:00.000Z",
    "discoveryDate": "2019-09-16T00:00:00.000Z",
    "vendorNotifiedDate": "2019-09-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3482",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-16404",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3482/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/lodestone-security/CVEs/blob/master/CVE-2019-16404/README.md",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/lodestone-security/CVEs/blob/master/CVE-2019-16404/README.md",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/commit/cd96478bdb9b67397916dd850133969d0bef6773",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/openemr/openemr/releases/tag/v5_0_2_1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-3482/default-remediation-status"
            }
        ]
    }
}