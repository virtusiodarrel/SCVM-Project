{
    "source": "BDSA",
    "name": "BDSA-2021-2104",
    "title": "Icinga Vulnerable to Privilege Escalation via Password Exposure in API Responses",
    "description": "Icinga contains a privilege escalation vulnerability. An authenticated attacker can take advantage of this in order to obtain the `password` attribute of external services, which will allow them to access these services with the permissions of an API user.\n\n**Note:** The vendor has stated that you are vulnerable if your cluster has API users with the one of the following permissions and if objects of the corresponding type exist: \n* `objects/query/IdoMysqlConnection`\n* `objects/query/IdoPgsqlConnection`\n* `objects/query/IcingaDB`\n* `objects/query/ElasticsearchWriter`",
    "technicalDescription": "This vulnerability exists due to the API responses for `IdoMysqlConnection`, `IdoPgsqlConnection`, `IcingaDB`, and `ElasticsearchWriter` objects containing the `password` attribute. An authenticated attacker can take advantage of this in order to obtain the `password` attribute of external services, which will allow them to access these services with the permissions of an API user, and add, modify and delete information there.\n\nThe vendor has mitigated against this issue by ensuring that `lib/db_ido_mysql/idomysqlconnection.ti`,  `lib/db_ido_pgsql/idopgsqlconnection.ti` and `lib/perfdata/elasticsearchwriter.ti` are configured to hide the `password` attribute.",
    "publishedDate": "2021-07-16T14:58:33.837Z",
    "updatedDate": "2021-07-16T14:58:33.831Z",
    "disclosureDate": "2021-07-15T00:00:00.000Z",
    "solution": "Fixed in [**2.11.10**](https://github.com/Icinga/icinga2/releases/tag/v2.11.10) by [this](https://github.com/Icinga/icinga2/commit/5f9957c7d55896dae44c3520c0d3ffcfa19391b0) commit, and in [**2.12.5**](https://github.com/Icinga/icinga2/releases/tag/v2.12.5) by [this](https://github.com/Icinga/icinga2/commit/843353ab69f79b3abfeb38ac249b05e1944369ab) commit.\n\nThe latest stable releases are available [here](https://icinga.com/get-started/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.3,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has provided the following [workaround](https://github.com/Icinga/icinga2/security/advisories/GHSA-wrpw-pmr8-qgj7):\n\nAPI user permissions can be restricted to not allow querying of any affected objects. Either by explicitly listing only the required object types for object query permissions:\n```\nobject ApiUser \"example\" {\n  password = \"secret\"\n  permissions = [ \"objects/query/Host\", \"objects/query/Service\" ]\n}\n```\nOr by applying a filter rule:\n```\nobject ApiUser \"example\" {\n  password = \"secret\"\n  permissions = [ {\n    permission = \"objects/query/*\"\n    filter = {{ ! [\"IdoMysqlConnection\", \"IdoPgsqlConnection\", \"IcingaDB\", \"ElasticsearchWriter\"].contains(obj.type) }}\n  } ]\n}\n```",
    "vendorFixDate": "2021-07-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2104",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-267"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-32743",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2104/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/5f9957c7d55896dae44c3520c0d3ffcfa19391b0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/commit/843353ab69f79b3abfeb38ac249b05e1944369ab",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/releases/tag/v2.11.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/releases/tag/v2.12.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/security/advisories/GHSA-wrpw-pmr8-qgj7",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/Icinga/icinga2/security/advisories/GHSA-wrpw-pmr8-qgj7",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://icinga.com/blog/2021/07/15/releasing-icinga-2-12-5-and-2-11-10/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://icinga.com/get-started/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2104/default-remediation-status"
            }
        ]
    }
}