{
    "source": "BDSA",
    "name": "BDSA-2020-4288",
    "title": "Squid Vulnerable to HTTP Request Smuggling via 'parse()' Function",
    "description": "Squid is vulnerable to HTTP request smuggling due to the improper parsing of URL paths. A remote attacker could bypass Squid's access controls by sending maliciously crafted HTTP requests to a vulnerable endpoint.",
    "technicalDescription": "The `parse()` function, of file `Uri.cc`, performs parsing on client-specified URIs. If the path component of the URI is empty, or contains whitespace characters, then the URI may be mishandled in a manner that allows for HTTP request smuggling. A remote attacker could exploit this in order to bypass certain access control mechanisms that are implemented by Squid.\n\nThe vendor has stated that the vulnerability only manifests whenever the following configurations are used:\n\n> * All Squid with squid.conf containing \"uri_whitespace deny\" are\nnot vulnerable.\n> *All Squid with squid.conf containing \"uri_whitespace encode\" are\nnot vulnerable.\n> *All Squid-4.x up to and including 4.13 without uri_whitespace in\nsquid.conf are vulnerable.\n> *All Squid-4.x up to and including 4.13 with uri_whitespace in\nsquid.conf configured to \"allow\" are vulnerable.\n> *All Squid-4.x up to and including 4.13 with uri_whitespace in\nsquid.conf configured to \"chop\" are vulnerable.\n> *All Squid-4.x up to and including 4.13 with uri_whitespace in\nsquid.conf configured to \"strip\" are vulnerable.\n> *All Squid-5.x up to and including 5.0.4 without uri_whitespace\nin squid.conf are vulnerable.\n> *All Squid-5.x up to and including 5.0.4 with uri_whitespace in\nsquid.conf configured to \"allow\" are vulnerable.\n> *All Squid-5.x up to and including 5.0.4 with uri_whitespace in\nsquid.conf configured to \"chop\" are vulnerable.\n> *All Squid-5.x up to and including 5.0.4 with uri_whitespace in\nsquid.conf configured to \"strip\" are vulnerable.",
    "publishedDate": "2021-03-19T16:50:38.555Z",
    "updatedDate": "2021-03-19T16:50:38.547Z",
    "disclosureDate": "2020-09-01T00:00:00.000Z",
    "solution": "Fixed in [**5.0.5**](http://www.squid-cache.org/Versions/v5/) by [this](http://www.squid-cache.org/Versions/v5/changesets/SQUID-2020_11.patch) patch, and in \n[**4.14**](http://www.squid-cache.org/Versions/v4/) by [this](http://www.squid-cache.org/Versions/v4/changesets/SQUID-2020_11.patch) patch.\n\nhttps://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jianjun Chen (ICSI, Berkeley)",
    "workaround": "Specify the `uri_whitespace deny` or `uri_whitespace encode` settings within `squid.conf`.",
    "vendorFixDate": "2020-09-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4288",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-444"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-25097",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4288/ranges"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v4/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v4/changesets/SQUID-2020_11.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v5/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "http://www.squid-cache.org/Versions/v5/changesets/SQUID-2020_11.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-jvf6-h9gj-pmj6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/squid-cache/squid/security/advisories/GHSA-jvf6-h9gj-pmj6",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4288/default-remediation-status"
            }
        ]
    }
}