{
    "source": "BDSA",
    "name": "BDSA-2020-0385",
    "title": "TestLink Vulnerable to SQL Injection (SQLi) via Multiple Parameters",
    "description": "TestLink contains multiple SQL injection (SQLi) vulnerabilities in various functions due to a lack of validation of user-controlled data. An authenticated attacker could exploit these vulnerabilities to obtain sensitive information, or to make changes to data held by the application, through malicious SQL queries.\n\n**Note**: An attacker must have an account to exploit these vulnerabilities, however a self registered guest account is all that is required. Guest accounts are enabled by default in TestLink configuration.",
    "technicalDescription": "Multiple SQL queries are dynamically constructed using client request parameters with no validation, which allows an attacker to control the resulting SQL query. This could allow an attacker to obtain sensitive information from the database, or to alter and delete data in the database.\n\nThe following parameters and files are vulnerable:\n* parameter `tproject_id` in `keywordsView.php`\n* parameter `req_spec_id` in `reqSpecCompareRevisions.php`\n* parameter `requirement_id` in `reqCompareVersions.php`\n* parameter `build_id` in `planUpdateTC.php` \n* parameter `tplan_id` in `newest_tcversions.php`\n* parameter `tplan_id` in `tcCreatedPerUserGUI.php` \n* parameter `tcase_id` in `tcAssign2Tplan.php` \n* parameter `testcase_id` in `tcCompareVersions.php`\n* parameter `build_id` in `tc_exec_unassign_all.php`\n* parameter `tplan_id` in `testCasesWithCF.php`",
    "publishedDate": "2020-03-09T14:59:52.703Z",
    "updatedDate": "2020-03-09T14:59:52.688Z",
    "disclosureDate": "2020-03-04T00:00:00.000Z",
    "exploitPublishDate": "2020-03-04T00:00:00.000Z",
    "solution": "Fixed in version [**1.9.20**](https://github.com/TestLinkOpenSourceTRMS/testlink-code/releases/tag/1.9.20) by the following commits:\n* [Commit 1](https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/e2d88c9d7f8e02640ba65e5ff74b55d0399a53d0),\n* [Commit 2](https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/7647a7b53ceab31524cfcfb3beb8435af0a30fc1),\n* [Commit 3](https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/d27690c6cb7708a6db0701b6428381d32d51495a),\n* [Commit 4](https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/942c406fcee5d376235a264cb8a79300a0002d20),\n* [Commit 5](https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/146b4f38010a48c36b7d9650060ca354c92ab4ac),\n* [Commit 6](https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/bcf7b971b5c88ea08d2dc47685f319be3b02cea8),\n* [Commit 7](https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/99385ea61bab28b795967fa69e9fa2aa9bb3b459).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.9,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 3.1,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.9
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Krzysztof @ securitum.com",
    "workaround": "",
    "vendorFixDate": "2019-12-31T00:00:00.000Z",
    "vendorNotifiedDate": "2019-12-23T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0385",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-89"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20107",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0385/ranges"
            },
            {
                "rel": "reference",
                "href": "http://mantis.testlink.org/view.php?id=8829",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://mantis.testlink.org/view.php?id=8829",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/146b4f38010a48c36b7d9650060ca354c92ab4ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/7647a7b53ceab31524cfcfb3beb8435af0a30fc1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/942c406fcee5d376235a264cb8a79300a0002d20",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/99385ea61bab28b795967fa69e9fa2aa9bb3b459",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/bcf7b971b5c88ea08d2dc47685f319be3b02cea8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/d27690c6cb7708a6db0701b6428381d32d51495a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/e2d88c9d7f8e02640ba65e5ff74b55d0399a53d0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/TestLinkOpenSourceTRMS/testlink-code/releases/tag/1.9.20",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-0385/default-remediation-status"
            }
        ]
    }
}