{
    "source": "BDSA",
    "name": "BDSA-2021-0735",
    "title": "Xstream Vulnerable to Regular Expression Denial-of-Service (ReDoS) via Crafted Input Stream",
    "description": "Xstream is vulnerable to regular expression denial-of-service (ReDoS) by a remote attacker who can supply a specially crafted input stream. This allows the attacker to occupy a thread that consumes maximum CPU time, making it unavailable for service.",
    "technicalDescription": "At unmarshalling time, during the processing of a stream, XStream uses type information to recreate the objects from supported formats, such as XML and JSON. An attacker can utilize this feature and replace or inject objects that result in executed evaluation of a malicious regular expression which would cause maximum CPU time consumption. An attacker could get XStream to unmarshal some XML (or another supported format like JSON) that contains a malicious `java.io.ByteArrayInputStream` type. \n\n**Note**: The vendor has stated that XStream users who have set up the XStream security framework with a sufficient whitelist limited to the minimal required types are unaffected by this issue.",
    "publishedDate": "2021-03-24T15:34:09.240Z",
    "updatedDate": "2021-11-09T09:12:23.313Z",
    "disclosureDate": "2021-03-13T00:00:00.000Z",
    "exploitPublishDate": "2021-03-13T00:00:00.000Z",
    "solution": "Fixed in **[1.4.16](https://github.com/x-stream/xstream/releases/tag/XSTREAM_1_4_16)** by [this](https://github.com/x-stream/xstream/commit/d5e51177634afea7213b9dc2d21f101d2e258db9) commit.\n\nThe latest stable releases are available [here](https://x-stream.github.io/download.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "threedr3am",
    "workaround": "The vendor recommends the use of XStream's security framework to implement a whitelist for allowed types. \n\nThe vendor has made available a set of [workarounds](https://x-stream.github.io/security.html#workaround) detailing this feature.",
    "vendorFixDate": "2021-03-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0735",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-185"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21348",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0735/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/commit/d5e51177634afea7213b9dc2d21f101d2e258db9",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/releases/tag/XSTREAM_1_4_16",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/x-stream/xstream/security/advisories/GHSA-56p8-3fh9-4cvq",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/CVE-2021-21348.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/CVE-2021-21348.html",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://x-stream.github.io/security.html#workaround",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0735/default-remediation-status"
            }
        ]
    }
}