{
    "source": "BDSA",
    "name": "BDSA-2021-3312",
    "title": "Mahara Vulnerable to Path Traversal via '-' Character Replacement in Help API",
    "description": "Mahara is vulnerable to path traversal due functionality which replaces `-` characters with `/` characters in the help API. An unauthenticated attacker could use this flaw to access HTML files that are beyond the intended access scope.",
    "technicalDescription": "Mahara's help API replaces `-` with `/` for the `page` parameter. This allows for unauthorized path traversal via requests such as `mahara/json/help.php?plugintype=core&pluginname=view&page=..-..-..-..-..-js-tinymce-plugins-mathslate-help`. This vulnerability could also be used to leak user data after using the export function, but it requires the attacker to guess the Unix timestamp at which the export was made.\n\nThe vulnerability was fixed by making sure that the requested file location is within the webroot and contains `help/page/` as part of its path.",
    "publishedDate": "2021-11-04T12:08:47.144Z",
    "updatedDate": "2021-11-04T12:08:47.130Z",
    "disclosureDate": "2021-10-28T00:00:00.000Z",
    "exploitPublishDate": "2021-10-28T00:00:00.000Z",
    "solution": "Fixed in:\n* [**20.04.5**](https://github.com/MaharaProject/mahara/releases/tag/20.04.5_RELEASE) by [this](https://github.com/MaharaProject/mahara/commit/2a9892cdb348c8b097517fb0c30377f540ab2227) commit\n* [**20.10.3**](https://github.com/MaharaProject/mahara/releases/tag/20.10.3_RELEASE) by [this](https://github.com/MaharaProject/mahara/commit/393ab25a15514a21c14835080feb346074d0dade) commit \n* [**21.04.2**](https://github.com/MaharaProject/mahara/releases/tag/21.04.2_RELEASE) by [this](https://github.com/MaharaProject/mahara/commit/89b1398c38ce7f67b13433b8ebc16b365c2518f1) commit \n* [**21.10.0**](https://github.com/MaharaProject/mahara/releases/tag/21.10.0_RELEASE) by [this](https://github.com/MaharaProject/mahara/commit/f8d64e621af581902de82c8ec76f0283e4495398) commit \n\nThe latest stable releases can be found [here](https://mahara.org/view/view.php?id=135849).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.6,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.9,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "dee-see (bugs.launchpad.net/mahara)",
    "workaround": "",
    "vendorFixDate": "2021-10-29T00:00:00.000Z",
    "vendorNotifiedDate": "2021-09-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.3,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3312",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-22"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-43264",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3312/ranges"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/mahara/+bug/1944979",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.launchpad.net/mahara/+bug/1944979",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/commit/2a9892cdb348c8b097517fb0c30377f540ab2227",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/commit/393ab25a15514a21c14835080feb346074d0dade",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/commit/89b1398c38ce7f67b13433b8ebc16b365c2518f1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/commit/f8d64e621af581902de82c8ec76f0283e4495398",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/releases/tag/20.04.5_RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/releases/tag/20.10.3_RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/releases/tag/21.04.2_RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/MaharaProject/mahara/releases/tag/21.10.0_RELEASE",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://mahara.org/view/view.php?id=135849",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3312/default-remediation-status"
            }
        ]
    }
}