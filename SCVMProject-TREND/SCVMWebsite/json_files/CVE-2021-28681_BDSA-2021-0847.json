{
    "source": "BDSA",
    "name": "BDSA-2021-0847",
    "title": "Pion WebRTC Vulnerable to Authentication Bypass via Failed DTLS Certificate Verification",
    "description": "Pion WebRTC is vulnerable to an authentication bypass issue due to how data channel communication can continue despite how DTLS certificate verification may have failed.\n\nAn attacker could potentially abuse this flaw in order to conduct impersonation style attacks using an invalid certificate.",
    "technicalDescription": "Pion WebRTC is vulnerable to authentication bypass because data channel communication is incorrectly allowed with users who have failed DTLS certificate verification. An attacker with knowledge of the ICE password could forge a certificate during the PeerConnection handshake and cause the data channel communication to continue.",
    "publishedDate": "2021-04-01T16:09:55.760Z",
    "updatedDate": "2021-07-07T09:17:59.319Z",
    "disclosureDate": "2021-03-17T00:00:00.000Z",
    "exploitPublishDate": "2021-03-17T00:00:00.000Z",
    "solution": "Fixed in [**3.0.15**](https://github.com/pion/webrtc/releases/tag/v3.0.15) by [this](https://github.com/pion/webrtc/commit/545613dcdeb5dedb01cce94175f40bcbe045df2e) commit.\n\nThe latest stable releases are available [here](https://github.com/pion/webrtc/releases).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated [here](https://github.com/pion/webrtc/security/advisories/GHSA-74xm-qj29-cq8p) that attacks of this nature can be detected by monitoring `PeerConnectionState` in all versions of Pion WebRTC. Users should listen for when `PeerConnectionState` changes to `PeerConnectionStateFailed`. When it enters this state, users should not continue using the PeerConnection.",
    "vendorFixDate": "2021-03-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0847",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-287"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-295"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28681",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0847/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pion/webrtc/commit/545613dcdeb5dedb01cce94175f40bcbe045df2e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pion/webrtc/issues/1708",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pion/webrtc/issues/1708",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pion/webrtc/releases",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pion/webrtc/releases/tag/v3.0.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pion/webrtc/security/advisories/GHSA-74xm-qj29-cq8p",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/pion/webrtc/security/advisories/GHSA-74xm-qj29-cq8p",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0847/default-remediation-status"
            }
        ]
    }
}