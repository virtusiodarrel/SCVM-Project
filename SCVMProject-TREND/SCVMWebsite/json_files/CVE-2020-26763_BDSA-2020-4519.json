{
    "source": "BDSA",
    "name": "BDSA-2020-4519",
    "title": "Rocket.Chat.Electron (Desktop Clients) Vulnerable to Content Redirection via Mishandling of 'openExternal' Functionality",
    "description": "Rocket.Chat.Electron is vulnerable to content redirection and insufficient context isolation. Successfully exploiting this can allow an attacker to open external links without user interaction and poison some preload routines.",
    "technicalDescription": "This vulnerability exists due to the incorrect handling of context isolation in in preload scripts and the `openExternal` functionality on webviews. Successfully exploiting this can allow an attacker to poison some preload routines, as well as to open external links without user interaction.\n\nThe vendor has mitigated against this by ensuring the `contextBridge` is being used in the `src/preload.ts`, and that `webPreferences.contextIsolation` is set to `true` in  `src/ui/main/webviews.ts`, ensuring that context isolation is properly enabled. In addition to this, extra checks have been added before the `openExternal()` function is called in `src/ui/main/webviews.ts`, which ensure that external links will not be opened without a user's permission.",
    "publishedDate": "2021-07-06T16:17:48.897Z",
    "updatedDate": "2022-08-01T12:17:21.874Z",
    "disclosureDate": "2020-09-11T00:00:00.000Z",
    "exploitPublishDate": "2022-08-01T00:00:00.000Z",
    "solution": "Fixed in [**3.0.0**](https://github.com/RocketChat/Rocket.Chat.Electron/releases/tag/3.0.0) by [this](https://github.com/RocketChat/Rocket.Chat.Electron/commit/c43a8a31289290e61eacd0e30dba5f14619ee911) commit.\n\nThe latest stable releases are available [here](https://github.com/RocketChat/Rocket.Chat.Electron/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-09-11T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4519",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-601"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-26763",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4519/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat.Electron/commit/c43a8a31289290e61eacd0e30dba5f14619ee911",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat.Electron/pull/1710",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat.Electron/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/RocketChat/Rocket.Chat.Electron/releases/tag/3.0.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/924151",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/924151",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4519/default-remediation-status"
            }
        ]
    }
}