{
    "source": "BDSA",
    "name": "BDSA-2019-4009",
    "title": "WordPress Vulnerable to Stored Cross-site Scripting (XSS) via `wp_targeted_link_rel` Function",
    "description": "WordPress is vulnerable to stored cross-site scripting (XSS) due to improper validation of user-supplied input. This could allow an attacker to inject arbitrary web scripts and obtain sensitive information such as authentication tokens and user session cookies.",
    "technicalDescription": "The flaw is due to insufficient validation of user controlled input in `wp_targeted_link_rel_callback` function used by the `wp_targeted_link_rel` function.\nThe functionality in `wp_targeted_link_rel` sends all `a` tags through the `wp_targeted_link_rel_callback` function. This function will perform some validation and reformatting of any `rel` attributes identified. The validation includes identifying the delimiter of the value and reformatting the `rel` attribute to ensure all the identified values are escaped within the delimiter. \nIt is this reformatting that can be exploited due to the occurrence when the delimiter is nothing, such as `rel=abc`. In this case the delimiter will be set as `\"`, which would allow an attacker to include `rel=abc \"` which would become `rel=\"abc\" \"` therefore breaking out of the attribute.\n\nAn attacker with a regular user account could create a user description that contains arbitrary code that would execute every time their profile is visited.",
    "publishedDate": "2019-12-20T16:43:07.942Z",
    "updatedDate": "2020-09-04T08:29:32.429Z",
    "disclosureDate": "2019-12-13T00:00:00.000Z",
    "exploitPublishDate": "2020-01-08T00:00:00.000Z",
    "solution": "Fixed in version:\n* [**5.3.1**](https://github.com/WordPress/WordPress/releases/tag/5.3.1) by [this](https://github.com/WordPress/WordPress/commit/8221d6d32063d2167da437eb6bba4512a84ae6bb) commit\n* [**5.2.5**](https://github.com/WordPress/WordPress/releases/tag/5.2.5) by [this](https://github.com/WordPress/WordPress/commit/da95cca74cd3bfec0260ee93b179519a3e740742) commit\n* [**5.1.4**](https://github.com/WordPress/WordPress/releases/tag/5.1.4) by [this](https://github.com/WordPress/WordPress/commit/e391320b733912dc4d05ea56ddc62de44f4cda1a) commit",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 3.5,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 6.8,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.7,
        "impactSubscore": 5.8,
        "exploitabilitySubscore": 2.3,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Simon Scannell of RIPS Technologies",
    "workaround": "",
    "vendorFixDate": "2019-12-12T00:00:00.000Z",
    "vendorNotifiedDate": "2019-03-14T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4009",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-80"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-20042",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4009/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/WordPress/commit/8221d6d32063d2167da437eb6bba4512a84ae6bb",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/WordPress/commit/8221d6d32063d2167da437eb6bba4512a84ae6bb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/WordPress/commit/da95cca74cd3bfec0260ee93b179519a3e740742",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/WordPress/commit/de8936588c8c075968975bb9ceedce67bc193ea3",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/WordPress/commit/e391320b733912dc4d05ea56ddc62de44f4cda1a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/WordPress/releases/tag/5.1.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/WordPress/releases/tag/5.2.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/WordPress/WordPress/releases/tag/5.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/509930",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://wordpress.org/news/2019/12/wordpress-5-3-1-security-and-maintenance-release/",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4009/default-remediation-status"
            }
        ]
    }
}