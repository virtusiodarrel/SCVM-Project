{
    "source": "BDSA",
    "name": "BDSA-2021-2610",
    "title": "Xen Vulnerable to Privilege Escalation via Unsafe Mapping Manipulation Functionality in 'guest_remove_page'",
    "description": "Xen is vulnerable to privilege escalation, information exposure and denial-of-service (DoS) due to a failure to prevent guests from manipulating IOMMU mappings. A local attacker could undo, or remap, these mappings in order to elevate their privileges, recover sensitive data from the application's memory, or cause the application to crash.",
    "technicalDescription": "IOMMU mapping entries are created by the function `set_mmio_p2m_entry()`, of file `xen/arch/x86/mm/p2m.c`, and can be torn down by the function `clear_mmio_p2m_entry()`. The function `guest_remove_page()`, of file `xen/common/memory.c`, uses `clear_mmio_p2m_entry()` in order to allow guests to remove `p2m_mmio_direct` page entries. This could allow a malicious guest to undo, or remap, such entries in order to carry out privilege escalation, information exposure, or DoS attacks.\n\nThe vulnerability was fixed by updating `guest_remove_page()` so that it returns an error if an attempt is made to perform an invalid mapping manipulation operation.",
    "publishedDate": "2021-08-27T16:29:27.636Z",
    "updatedDate": "2022-08-10T15:37:10.946Z",
    "disclosureDate": "2021-08-25T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.13.4**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=89d40f0682f9ad37091cc53685f3ecf63a44bb72) commit,\n* [**4.14.3**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6f4c2146893c10ec17e854242613428f96e86757) commit,\n* [**4.15.1**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7850fe53a59f73fbb0a61c36141c6a6563e3eeca) commit,\n* [**4.16.0-rc1**](https://xenproject.org/downloads/) by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=111469cc7b3f586c2335e70205320ed3c828b89e) commit.\n\nFixed in the **stable-4.11** and **staging-4.11** branches by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=8c02a4943e60a400103a6790de2e6f19854403e5) commit, and in the **stable-4.12** and **staging-4.12** branches by [this](https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=4e5bf7ebbfd0bb4fc57466f8eebfb90047a3e277) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Jan Beulich (SUSE)",
    "workaround": "The vendor has stated that the vulnerability can be mitigated by preventing guests from accessing physical devices. \n\nAn alternative workaround is to only allow untrusted guests to access physical devices \"whose firmware-provided ACPI tables declar identity mappings ... (Provided that there are no identity mapped regions which are specified by the ACPI tables to apply globally.)\".\n\nDetails on these workarounds can be found [here](http://xenbits.xen.org/xsa/advisory-378.html).",
    "vendorFixDate": "2021-08-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2610",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-749"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-28694",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2610/ranges"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-378.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "http://xenbits.xen.org/xsa/advisory-378.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=111469cc7b3f586c2335e70205320ed3c828b89e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=48dfb297a20a8a37de2db45710e3c42db014e7ef",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=4e5bf7ebbfd0bb4fc57466f8eebfb90047a3e277",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=6f4c2146893c10ec17e854242613428f96e86757",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=7850fe53a59f73fbb0a61c36141c6a6563e3eeca",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=89d40f0682f9ad37091cc53685f3ecf63a44bb72",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=8c02a4943e60a400103a6790de2e6f19854403e5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://xenproject.org/downloads/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2610/default-remediation-status"
            }
        ]
    }
}