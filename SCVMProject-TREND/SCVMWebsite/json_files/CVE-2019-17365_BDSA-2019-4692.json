{
    "source": "BDSA",
    "name": "BDSA-2019-4692",
    "title": "Nix Vulnerable to Account Takeover via Profile-Directory Creation",
    "description": "Nix is vulnerable to privilege escalation due to the way profile-directory creation is handled. An attacker could exploit this to escalate their privileges on the target system.",
    "technicalDescription": "An attacker could exploit this issue when a user first installs Nix, but before they've logged in. Due to the fact that Nix creates an empty, world-writable, per-user profile directory but fails to assign it to the user who installed Nix, an attacker is able to create the profile directory before the user logs in and gain control of the profile directory. This could allow an attacker to run code upon user login to Nix.\n\nAdditionally, due to the local profile which the attacker controls being prepended to the victims path, an attacker is able to replace system executables with their own copies, allowing them to escalate privileged to any use that is not the root user. If there are other users with superuser permissions apart from the root user, this could result in the attacker obtaining full access to the system.",
    "publishedDate": "2020-09-22T14:26:14.764Z",
    "updatedDate": "2020-09-22T14:26:14.759Z",
    "disclosureDate": "2019-10-09T00:00:00.000Z",
    "exploitPublishDate": "2019-10-09T00:00:00.000Z",
    "solution": "Fixed in [**2.3.1**](https://github.com/NixOS/nix/releases/tag/2.3.1) by [this](https://github.com/NixOS/nix/commit/5a303093dcae1e5ce9212616ef18f2ca51020b0d) commit.\n\nThe latest stable releases can be found [here](https://github.com/NixOS/nix/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.3,
        "impactSubscore": 5.5,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:L/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Michael Orlitzky",
    "workaround": "",
    "vendorFixDate": "2019-10-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4692",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-266"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-17365",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4692/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NixOS/nix/commit/5a303093dcae1e5ce9212616ef18f2ca51020b0d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NixOS/nix/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/NixOS/nix/releases/tag/2.3.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2019/10/09/4",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2019/10/09/4",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4692/default-remediation-status"
            }
        ]
    }
}