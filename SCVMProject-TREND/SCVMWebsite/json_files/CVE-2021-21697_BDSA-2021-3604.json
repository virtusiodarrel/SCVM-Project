{
    "source": "BDSA",
    "name": "BDSA-2021-3604",
    "title": "Jenkins Vulnerable to Data Read/Write via Insufficient Access Control to Controller File System",
    "description": "Jenkins has insufficient access control to the controller file system. This could allow an attacker to read and write the contents of any build directory stored in Jenkins with very few restrictions.",
    "technicalDescription": "This vulnerability exists due to limited access being allows to files on the Jenkins controller file system. These file include the directories which store build-related metadata during build execution. This means that an attacker is able to read and write the contents of any build directory stored in Jenkins with exception of `build.xml` and some Pipeline-related metadata.",
    "publishedDate": "2021-11-30T16:14:00.649Z",
    "updatedDate": "2021-11-30T16:14:00.634Z",
    "disclosureDate": "2021-11-04T00:00:00.000Z",
    "solution": "Fixed in version [**2.3.19**](https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.319) by [this](https://github.com/jenkinsci/jenkins/commit/cf388d2a04e6016d23eb93fa3cc804f2554b98f0) commit and in LTS [**2.303.3**](https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.303.3) by [this](https://github.com/jenkinsci/jenkins/commit/f4e84978bf855a7b7619e179f8cc4d3a4a0ae487) commit. \n\nThe latest stable releases are available [here](https://www.jenkins.io/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated a workaround [here](https://www.jenkins.io/security/advisory/2021-11-04/#SECURITY-2455):\n\n* \"Update `Pipeline: Nodes and Processes` to version 2.40 or newer for Jenkins to associate Pipeline node blocks with the agent they\u2019re running on for this fix.\"\n\n* \"If you are unable to immediately upgrade to Jenkins 2.319, LTS 2.303.3, you can install the `Remoting Security Workaround` Plugin. It will prevent all agent-to-controller file access using `FilePath` APIs. Because it is more restrictive than Jenkins 2.319, LTS 2.303.3, more plugins are incompatible with it. Make sure to read the plugin documentation before installing it.\"",
    "vendorFixDate": "2021-10-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3604",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-264"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21697",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3604/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/commit/cf388d2a04e6016d23eb93fa3cc804f2554b98f0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/commit/f4e84978bf855a7b7619e179f8cc4d3a4a0ae487",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.303.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/jenkinsci/jenkins/releases/tag/jenkins-2.319",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/security/advisory/2021-11-04/#SECURITY-2428",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.jenkins.io/security/advisory/2021-11-04/#SECURITY-2455",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3604/default-remediation-status"
            }
        ]
    }
}