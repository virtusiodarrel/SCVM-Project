{
    "source": "BDSA",
    "name": "BDSA-2021-0170",
    "title": "Qemu Vulnerable to Privilege Escalation via virtiofsd Daemon",
    "description": "Qemu is vulnerable to privilege escalation via `virtio-fs` module. An attacker with kernel level access to the guest could use the shared file system daemon virtiofsd to escape the virtual machine and gain arbitrary read/write access to the host.",
    "technicalDescription": "The guest escape is possible in a few cases when virtiofsd is used to open special files in the shared directory. This is due to missing safety checks for cases such as `FUSE_OPEN`. Due to the kernel level access requirement, this vulnerability cannot be exploited from the guest user space.\n\nThe proposed patch to this vulnerability is considered temporary since it only adds the missing checks, but does not prevent a compromised virtiofsd process from opening device nodes on the host.",
    "publishedDate": "2021-01-22T11:30:25.245Z",
    "updatedDate": "2021-11-10T10:32:53.833Z",
    "disclosureDate": "2021-01-21T00:00:00.000Z",
    "solution": "Fixed in [**6.0.0-rc0**](https://github.com/qemu/qemu/releases/tag/v6.0.0-rc0) by [this](https://github.com/qemu/qemu/commit/a3fdbbc7f271bff7d53d0501b29d910ece0b3789) commit.\n\nThe latest releases are available [here](https://www.qemu.org/download/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 4.3,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.1,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.2
        },
        "vector": "(AV:L/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.2,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alex Xu",
    "workaround": "",
    "vendorFixDate": "2021-02-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0170",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-754"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-35517",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0170/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/qemu/qemu/commit/a3fdbbc7f271bff7d53d0501b29d910ece0b3789",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/qemu/qemu/releases/tag/v6.0.0-rc0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.gnu.org/archive/html/qemu-devel/2021-01/msg05461.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/01/22/1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.qemu.org/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0170/default-remediation-status"
            }
        ]
    }
}