{
    "source": "BDSA",
    "name": "BDSA-2019-0746",
    "title": "Checkstyle Vulnerable to XML External Entity (XXE) Injection via Insecure DTD Defaults",
    "description": "Checkstyle is vulnerable to XML external entity (XXE) injection due to loading of external Document Type Definitions (DTDs) by default. An attacker who is able to supply crafted DTDs by positioning themselves as a man-in-the-middle (MITM) can leverage this flaw for several attacks. The vulnerability can lead to sensitive information disclosure, denial-of-service (DoS), or can be used for server side request forgery (SSRF).\n\nNote that initially this issue was not properly addressed and a further fix was required, which was disclosed as CVE-2019-10782 (BDSA-2020-0153).",
    "technicalDescription": "An attacker can send a crafted request with XML code that references the server's local resources via a `file://` URI to access resources beyond the intended sphere of control. This allows an attacker to access arbitrary files located on the server or induce a denial-of-service (DoS) condition by using nested or recursive entity references. It is also possible to use the vulnerable server as a pivot to launch attacks that abuse the trust relationship with the server.\n\nInitially this issue was addressed in **8.18**, but it was discovered that this was incomplete and still allowed the loading of external parameter entities by default, thus a further fix was required.",
    "publishedDate": "2019-03-22T15:37:27.224Z",
    "updatedDate": "2021-03-31T11:59:12.020Z",
    "disclosureDate": "2019-02-24T00:00:00.000Z",
    "solution": "Fixed in **[8.29](https://github.com/checkstyle/checkstyle/releases/tag/checkstyle-8.29)** by [this](https://github.com/checkstyle/checkstyle/commit/180b4fe37a2249d4489d584505f2b7b3ab162ec6) commit and [this](https://github.com/checkstyle/checkstyle/commit/c46a16d177e6797895b195c288ae9a9a096254b8) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.0,
        "impactSubscore": 4.7,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Roman Ivanov",
    "workaround": "",
    "vendorFixDate": "2020-01-19T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0746",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-827"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9658",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0746/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/checkstyle/checkstyle/commit/180b4fe37a2249d4489d584505f2b7b3ab162ec6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/checkstyle/checkstyle/commit/c46a16d177e6797895b195c288ae9a9a096254b8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/checkstyle/checkstyle/issues/6474",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/checkstyle/checkstyle/issues/7468",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/checkstyle/checkstyle/releases/tag/checkstyle-8.29",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/checkstyle/checkstyle/security/advisories/GHSA-763g-fqq7-48wg",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-0746/default-remediation-status"
            }
        ]
    }
}