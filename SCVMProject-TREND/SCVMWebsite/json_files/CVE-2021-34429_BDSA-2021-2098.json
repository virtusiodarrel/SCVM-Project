{
    "source": "BDSA",
    "name": "BDSA-2021-2098",
    "title": "Eclipse Jetty Vulnerable to Sensitive Data Exposure via Default Compliance Mode",
    "description": "Eclipse Jetty is vulnerable to sensitive data exposure via default compliance mode. An attacker could exploit this by using a URL containing a `%u002e` segment, for example `/%u002e/WEB-INF/web.xml`. These were improperly allowed to access protected resources in the `WEB-INF` directory, and may also bypass some security constraints.",
    "technicalDescription": "This vulnerability exists due to encodings or adornments to relative URI path segments in Eclipse Jetty not being normalized by the pure RFC URI normalization, however they are normalized by the file system, this then allows protected resources in the `WEB-INF` directory to be accessed via an alias. \n\nThe vendor has mitigated against this by:\n* Ensuring that URIs are first decoded and then normalized\n* Including additional checks during URI parsing looking for specific segments/characters that could be seen ambiguously by an application.\n* Once a received URI has been decoded and normalized by initial URI processing, Jetty will not decode or normalize it again. \n* Ensuring methods check if a passed path is normalized.",
    "publishedDate": "2021-07-16T11:05:28.927Z",
    "updatedDate": "2021-09-16T15:02:39.218Z",
    "disclosureDate": "2021-07-15T00:00:00.000Z",
    "solution": "Fixed in \n* [**9.4.43**](https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.43.v20210629) by [this](https://github.com/eclipse/jetty.project/commit/122a78aafcc3a1e0f0f6192f48291810b100b2ef) commit,\n* [**10.0.6**](https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.6) by [this](https://github.com/eclipse/jetty.project/commit/3c32afa05c5ffcf4ad77a7769a118df4e083b92d) commit,\n* [**11.0.6**](https://github.com/eclipse/jetty.project/releases/tag/jetty-11.0.6).\n\nThe latest stable releases are available [here](https://github.com/eclipse/jetty.project/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "cangqingzhe",
    "workaround": "The vendor has provided the following [workaround](https://github.com/eclipse/jetty.project/security/advisories/GHSA-vjv5-gp2w-65vm)\n\nSome Jetty rewrite rules can be deployed to rewrite any request containing encoded dot segments or null characters in the raw request URI, to a known not found resource:\n```\n<Call name=\"addRule\">\n  <Arg>\n    <New class=\"org.eclipse.jetty.rewrite.handler.RewriteRegexRule\">\n      <Set name=\"regex\">.*/(?:\\.+/)+.*</Set>\n      <Set name=\"replacement\">/WEB-INF/Not-Found</Set>\n    </New>\n  </Arg>\n</Call>\n<Call name=\"addRule\">\n  <Arg>\n    <New class=\"org.eclipse.jetty.rewrite.handler.ValidUrlRule\"/>\n  </Arg>\n</Call>\n```",
    "vendorFixDate": "2021-06-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2098",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-551"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-34429",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2098/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/commit/122a78aafcc3a1e0f0f6192f48291810b100b2ef",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/commit/3c32afa05c5ffcf4ad77a7769a118df4e083b92d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-11.0.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.43.v20210629",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/security/advisories/GHSA-vjv5-gp2w-65vm",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/eclipse/jetty.project/security/advisories/GHSA-vjv5-gp2w-65vm",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2098/default-remediation-status"
            }
        ]
    }
}