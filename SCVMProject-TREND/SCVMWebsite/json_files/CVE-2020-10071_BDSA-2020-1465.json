{
    "source": "BDSA",
    "name": "BDSA-2020-1465",
    "title": "Zephyr Vulnerable to Denial-of-Service (DoS) via Integer Overflow in 'mqtt_handle_packet()' Function",
    "description": "Zephyr is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. A remote attacker could cause a vulnerable server to crash by sending maliciously crafted MQTT packets to that server.",
    "technicalDescription": "The function `mqtt_handle_packet()`, which is defined within the file `mqtt_rx.c`, is used by Zephyr to parse incoming MQTT packets. This function utilizes a variety of variables, such as `remaining` and `length`, to track the size of the buffers that are used to parse these packets, as well as the number of bytes that remain to be copied between the buffers. \nThe function fails to ensure that the arithmetic that is performed on these values does not result in an overflow. Such an overflow can cause the function to write data beyond the boundaries of the destination buffer. This can cause the application to crash. A remote attacker could therefore cause a DoS by sending maliciously crafted MQTT packets to the application that will trigger the aforementioned integer overflow.",
    "publishedDate": "2020-06-19T15:25:54.279Z",
    "updatedDate": "2020-06-19T15:25:54.273Z",
    "disclosureDate": "2020-05-26T00:00:00.000Z",
    "exploitPublishDate": "2020-05-26T00:00:00.000Z",
    "solution": "Fixed in [**2.3.0-rc1**](https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.3.0-rc1) by [this](https://github.com/zephyrproject-rtos/zephyr/commit/6110a7cb637058a9d750870f3cf71130b3e0b89a) commit.\n\nThe latest stable releases can be found [here](https://github.com/zephyrproject-rtos/zephyr/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2020-03-26T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1465",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-680"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10071",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1465/ranges"
            },
            {
                "rel": "reference",
                "href": "https://docs.zephyrproject.org/latest/security/vulnerabilities.html#cve-2020-10071",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/commit/6110a7cb637058a9d750870f3cf71130b3e0b89a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/zephyrproject-rtos/zephyr/releases/tag/v2.3.0-rc1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://research.nccgroup.com/2020/05/26/research-report-zephyr-and-mcuboot-security-assessment",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1465/default-remediation-status"
            }
        ]
    }
}