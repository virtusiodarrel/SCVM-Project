{
    "source": "BDSA",
    "name": "BDSA-2017-1745",
    "title": "Linux Kernel Arbitrary Code Execution on PowerPC",
    "description": "Linux kernel allows arbitrary command execution via out-of-bounds write flaw in signal frame handling on PowerPC hardwares.",
    "technicalDescription": "A flaw was found in the Linux kernel handling of signal frame processing where any user process can craft a signal frame and then do a `sigreturn` so that the kernel will take an exception (*interrupt*), and use the `r1` value from the signal frame as the kernel stack pointer. As part of the exception entry the content of the signal frame is written to the kernel stack, allowing an attacker to overwrite arbitrary locations with arbitrary values. The exception handling does produce an `oops`, and a `panic` if `panic_on_oops=1`, but only after kernel memory has been over written.\n\nIssue was introduced by this [commit](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=5d176f751ee3c6eededd984ad409bff201f436a7).\n\nThis vulnerability can be leveraged to execute arbitrary command by a local attacker utilizing crafted signal frame.\n\nPlease note that this vulnerability exists on Linux kernel running on PowerPC hardware (*Power8 or later*).\n\nKernels built with `CONFIG_PPC_TRANSACTIONAL_MEM=n` are not vulnerable.\n\nThe vendor fixed the problem by switching to the emergency stack if transitional memory (*TM*) Bad Thing received from the kernel.",
    "publishedDate": "2017-11-20T11:48:36.216Z",
    "updatedDate": "2018-10-03T07:02:06.186Z",
    "disclosureDate": "2017-10-09T00:00:00.000Z",
    "solution": "Fixed in versions [**4.9.55**](https://www.kernel.org), [**4.13.6**](https://www.kernel.org), [**4.14-rc5**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=265e60a170d0a0ecfc2d20490134ed2c48dd45ab) git commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:L/AC:L/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Michael Ellerman, Gustavo Romero, Breno Leitao, Paul Mackerras, Cyril Bur",
    "workaround": "Built the kernel with `CONFIG_PPC_TRANSACTIONAL_MEM=n`.",
    "vendorFixDate": "2017-08-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2017-1745",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2017-1000255",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2017-1745/ranges"
            },
            {
                "rel": "reference",
                "href": "http://seclists.org/oss-sec/2017/q4/51",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://access.redhat.com/security/cve/CVE-2017-1000255",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugzilla.redhat.com/show_bug.cgi?id=1498067",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=5d176f751ee3c6eededd984ad409bff201f436a7",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=265e60a170d0a0ecfc2d20490134ed2c48dd45ab",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/144561/USN-3443-1.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2017-1745/default-remediation-status"
            }
        ]
    }
}