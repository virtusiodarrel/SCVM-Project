{
    "source": "BDSA",
    "name": "BDSA-2022-2505",
    "title": "Apache APISIX Vulnerable to Authentication Bypass by Spoofing via 'batch-requests' Plugin",
    "description": "Apache APISIX is vulnerable to authentication bypass by spoofing. An attacker could exploit this flaw by leveraging the `batch-requests` plugin in order to bypass IP restrictions of the `Admin API` and perform remote code execution (RCE).\n\n**Note:** If an attacker is able to leverage CVE-2020-13945 (BDSA-2020-4793), remote code execution will occur. If the admin key was changed or the port of the Admin API was changed to a port that is different from the data panel, the impacts of this vulnerability may be lower.\n\nThis vulnerability is listed as exploitable by the Cybersecurity & Infrastructure Security Agency in their [Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog).",
    "technicalDescription": "This vulnerability is due to insufficient checks on the client IP which is overridden with its remote IP. This can be leveraged by an attacker to bypass IP restrictions and execute remote code.\n\nThis has been mitigated by disabling `batch-requests` by default.",
    "publishedDate": "2022-09-08T12:11:37.209Z",
    "updatedDate": "2022-09-08T12:14:21.760Z",
    "disclosureDate": "2022-02-11T00:00:00.000Z",
    "exploitPublishDate": "2022-03-07T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**2.10.4**](https://github.com/apache/apisix/releases/tag/2.10.4) by [this](https://github.com/apache/apisix/commit/ea47eeb0573a732e7cfcb5fb82588aaf02c7dd9f) commit.\n* [**2.12.1**](https://github.com/apache/apisix/releases/tag/2.12.1) by [this](https://github.com/apache/apisix/commit/f118f5ea7a5d96023a7bd546545f7c1ad6486495) commit.\n\nThe latest stable releases can be found [here](https://github.com/apache/apisix/releases).",
    "severity": "CRITICAL",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.2
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "CRITICAL",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 9.1
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Real World CTF (Chaitin Tech)",
    "workaround": "The vendor has issued the following workaround:\n\n\"Explicitly configure the enabled plugins in `conf/config.yaml`, ensure `batch-requests` is disabled, or comment out `batch-requests` in `conf/config-default.yaml`.\"",
    "vendorFixDate": "2022-02-07T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 9.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2505",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-290"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-24112",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2505/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/apisix/commit/ea47eeb0573a732e7cfcb5fb82588aaf02c7dd9f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/apisix/commit/f118f5ea7a5d96023a7bd546545f7c1ad6486495",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/apisix/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/apisix/releases/tag/2.10.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/apisix/releases/tag/2.12.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/lcdqywz8zy94mdysk7p3gfdgn51jmt94",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/lcdqywz8zy94mdysk7p3gfdgn51jmt94",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/166228/apache_apisix_api_default_token_rce.rb.txt",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
                "label": "EXPLOIT"
            },
            {
                "rel": "reference",
                "href": "https://www.exploit-db.com/exploits/50829",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2505/default-remediation-status"
            }
        ]
    }
}