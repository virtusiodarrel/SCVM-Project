{
    "source": "BDSA",
    "name": "BDSA-2021-3438",
    "title": "Samba DCE/RPC Vulnerable to Altered Behaviour via Fragment Injection",
    "description": "Samba's Distributed Computing Environment / Remote Procedure Call (DCE/RPC) functionality is vulnerable to fragment injection. DCE/RPC request payloads that are fragmented due to the large size are not being properly protected - an attacker could replace subsequent fragments in requests with their own data, which might be able to alter the server's behaviour.",
    "technicalDescription": "Fragmented packets are usually protected at DCE/RPC layer via GSSAPI/Kerberos/NTLMSSP or Netlogon Secure Channel. However, Samba does not perform fragment protection between the policy controls on the header and the subsequent fragments. An attacker could replace subsequent fragments in requests with their own data, which might be able to alter the server's behaviour.\n\nThe vendor also notes that the issue affects Samba  versions greater or equal to **4.10.0** when it is used as an active directory domain controller and **4.13.0** or higher when used as NT4 classic domain controller.",
    "publishedDate": "2021-11-12T16:21:17.112Z",
    "updatedDate": "2021-11-12T16:21:17.102Z",
    "disclosureDate": "2021-11-09T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.15.2**](https://github.com/samba-team/samba/releases/tag/samba-4.15.2)\n* [**4.14.10**](https://github.com/samba-team/samba/releases/tag/samba-4.14.10)\n* [**4.13.14**](https://github.com/samba-team/samba/releases/tag/samba-4.13.14)\n\nThe latest stable releases can be found [here](https://download.samba.org/pub/samba/).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.8,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 2.2,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.2
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Stefan Metzmacher of SerNet",
    "workaround": "The vendor provides the following workaround:\n\n\"Setting `dcesrv:max auth states=0` in the `smb.conf` will provide some mitigation against this issue.\n\nThere are no known problems with this change as NT4 classic domain controller, domain member or standalone server.\n\nBut it disables `Security Context Multiplexing` and may reopen `https://bugzilla.samba.org/show_bug.cgi?id=11892` which means domain members running things like Cisco ISE or VMWare View may no longer work. This applies only to active directory domain controllers.\"",
    "vendorFixDate": "2021-11-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3438",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-924"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-23192",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3438/ranges"
            },
            {
                "rel": "reference",
                "href": "https://download.samba.org/pub/samba/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.13.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.14.10",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.15.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/security/CVE-2021-23192.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/security/CVE-2021-23192.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3438/default-remediation-status"
            }
        ]
    }
}