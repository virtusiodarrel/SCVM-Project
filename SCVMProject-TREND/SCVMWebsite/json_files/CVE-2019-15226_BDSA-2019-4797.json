{
    "source": "BDSA",
    "name": "BDSA-2019-4797",
    "title": "Envoy Vulnerable to Denial-of-Service (DoS) via Large Header Count in HTTP Requests",
    "description": "Envoy is vulnerable to a denial-of-service (DoS) issue due to how a large amount of headers present in HTTP requests can cause Envoy to iterate slowly over existing request headers.\n\nAn attacker could send crafted requests that contain thousands of small headers to cause a negative impact to Envoy performance.",
    "technicalDescription": "Envoy is vulnerable to a denial-of-service (DoS) issue because Envoy has to verify that incoming headers are under the maximum size limit set by both the HTTP/1.1 and HTTP/2 codec. To do this, the `byteSize()` method is called to return the estimated size of the `HeaderMap`. Each time a header is added, this method is called.\n\nAn attacker could send crafted requests that contain thousands of small header which stay below the request header size but cause excessive consumption of CPU resources when processed.\n\nThe size validation implementation in versions 1.10.0 and after for HTTP/1.x traffic, and all versions of Envoy for HTTP/2 traffic, are affected.",
    "publishedDate": "2020-11-06T16:47:13.780Z",
    "updatedDate": "2020-11-06T16:51:21.559Z",
    "disclosureDate": "2019-11-08T00:00:00.000Z",
    "exploitPublishDate": "2019-11-08T00:00:00.000Z",
    "solution": "Fixed in [**1.11.2**](https://github.com/envoyproxy/envoy/releases/tag/v1.11.2) by [this](https://github.com/envoyproxy/envoy/commit/41da9533358b77f2ebf9eed2e33fa6ae130a0855) commit.\n\nThe latest stable releases are available [here](https://github.com/envoyproxy/envoy/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Asra Ali and Harvey Tuch, Google",
    "workaround": "The vendor has suggested a workaround [here](https://github.com/envoyproxy/envoy/security/advisories/GHSA-mxrr-6x92-4x7v):\n\n* In some situations, the maximum request header size can likely be smaller than the default limit of 60 KiB. This is configurable in the HTTP Connection Manager configuration. Lowering this limit can reduce the number of request headers, and possibly mitigate excessive CPU consumption.",
    "vendorFixDate": "2019-10-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4797",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-15226",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4797/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/commit/41da9533358b77f2ebf9eed2e33fa6ae130a0855",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/releases/tag/v1.11.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-mxrr-6x92-4x7v",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-mxrr-6x92-4x7v",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-mxrr-6x92-4x7v",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://www.envoyproxy.io/docs/envoy/v1.11.2/intro/version_history",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-4797/default-remediation-status"
            }
        ]
    }
}