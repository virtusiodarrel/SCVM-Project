{
    "source": "BDSA",
    "name": "BDSA-2020-3104",
    "title": "Samba Vulnerable to Denial-of-Service (DoS) via Crafted DNS Records",
    "description": "Samba is vulnerable to denial-of-service (DoS) due to the improper validation of user-supplied input. An attacker could exploit this flaw to cause the server to crash by sending a specially-crafted DNS message.",
    "technicalDescription": "This vulnerability exists if a DNS record that usually contains data in the additional section (such as MX and NS records) is empty. This will cause the RPC pipe component of the Samba DNS Server to make an error in handling the case and dereference uninitialised memory, which will cause the RPC server to crash. An attacker could exploit this flaw to cause a DoS by sending a specially-crafted DNS message.",
    "publishedDate": "2020-11-02T16:09:44.861Z",
    "updatedDate": "2021-03-31T08:14:38.148Z",
    "disclosureDate": "2020-10-29T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.11.15**](https://github.com/samba-team/samba/releases/tag/samba-4.11.15) by [this](https://download.samba.org/pub/samba/patches/security/samba-4.11.14-security-2020-10-29.patch) patch.\n* [**4.12.9**](https://github.com/samba-team/samba/releases/tag/samba-4.12.9) by [this](https://download.samba.org/pub/samba/patches/security/samba-4.12.8-security-2020-10-29.patch) patch.\n* [**4.13.1**](https://github.com/samba-team/samba/releases/tag/samba-4.13.1) by [this](https://download.samba.org/pub/samba/patches/security/samba-4.13.0-security-2020-10-29.patch) patch.\n\nThe latest stable releases are available [here](https://www.samba.org/samba/download/).",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 4.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 8.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.0
        },
        "vector": "(AV:N/AC:L/Au:S/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 4.3,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 2.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Francis Brosnan",
    "workaround": "The vendor has stated that the dnsserver task can be stopped by setting `dcerpc endpoint servers = -dnsserver` in the smb.conf and restarting Samba.",
    "vendorFixDate": "2020-10-28T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3104",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-14383",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3104/ranges"
            },
            {
                "rel": "reference",
                "href": "https://download.samba.org/pub/samba/patches/security/samba-4.11.14-security-2020-10-29.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://download.samba.org/pub/samba/patches/security/samba-4.12.8-security-2020-10-29.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://download.samba.org/pub/samba/patches/security/samba-4.13.0-security-2020-10-29.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.11.15",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.12.9",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.13.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/download/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/history/security.html",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/security/CVE-2020-14383.html",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/security/CVE-2020-14383.html",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3104/default-remediation-status"
            }
        ]
    }
}