{
    "source": "BDSA",
    "name": "BDSA-2019-2502",
    "title": "Apache Spark Vulnerable to Information Disclosure via Unencrypted Data Written to Disk",
    "description": "Apache spark is vulnerable to information disclosure due to it failing to encrypt user data even when requested by a user. This could allow anyone with access to the local disk to read any files which the user may think are encrypted.",
    "technicalDescription": "When a user requests that their data be encrypted using `spark.io.encryption.enabled=true` spark does not always comply. User data, cached blocks that are fetched to disk, parallelized data from SparkR and Pyspark Broadcast variables and parallelized data can all be written to the local disk unencrypted.\n\nThis was fixed by ensuring that at any point when the file is able to be read by a user it is properly encrypted, if encryption is requested.",
    "publishedDate": "2019-08-09T14:51:32.278Z",
    "updatedDate": "2021-03-01T14:49:01.616Z",
    "disclosureDate": "2019-08-05T00:00:00.000Z",
    "solution": "Fixed in version [**2.3.2-rc6**](https://spark.apache.org/downloads.html) by the following commits.\n\n* [Commit 1](https://github.com/apache/spark/commit/575fea120e25249716e3f680396580c5f9e26b5b)\n* [Commit 2](https://github.com/apache/spark/commit/6d742d1bd71aa3803dce91a830b37284cb18cf70)\n* [Commit 3](https://github.com/apache/spark/commit/09dd34cb1706f2477a89174d6a1a0f17ed5b0a65)\n* [Commit 4](https://github.com/apache/spark/commit/12717ba0edfa5459c9ac2085f46b1ecc0ee759aa)",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 1.9,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.4,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.4
        },
        "vector": "(AV:L/AC:M/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Thomas Graves of NVIDIA",
    "workaround": "",
    "vendorFixDate": "2018-08-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2502",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-311"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-10099",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2502/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/spark/commit/09dd34cb1706f2477a89174d6a1a0f17ed5b0a65",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/spark/commit/12717ba0edfa5459c9ac2085f46b1ecc0ee759aa",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/spark/commit/575fea120e25249716e3f680396580c5f9e26b5b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/spark/commit/6d742d1bd71aa3803dce91a830b37284cb18cf70",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://issues.apache.org/jira/browse/SPARK-28626",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://spark.apache.org/downloads.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://spark.apache.org/security.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2502/default-remediation-status"
            }
        ]
    }
}