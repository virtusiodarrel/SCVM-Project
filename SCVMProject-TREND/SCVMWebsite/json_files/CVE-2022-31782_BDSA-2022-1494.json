{
    "source": "BDSA",
    "name": "BDSA-2022-1494",
    "title": "FreeType Demo Programs Vulnerable to Memory Corruption via Out-of-Bounds Write in 'get_charset' Function",
    "description": "FreeType Demo Programs is vulnerable to an out-of-bounds write operation due to the improper management of dynamically allocated memory resources. An attacker could potentially modify data in memory, or cause the application to crash, by causing it to process maliciously crafted input data.",
    "technicalDescription": "The function `get_charset()`, of file `/targets/struct/freetype/dbg/freetype-demos/src/ftbench.c`, uses the value of the `i` variable as an index into the `charset->code` array. The value of `i` is obtained from the variables `first_index` and `last_index`. The values of these two variables are obtained from the calculation `face->num_glyphs - 1`. The value of `face->num_glyphs` is insufficiently validated. If it is zero, then the value of `i` will end up being negative. This will lead to an out-of-bounds write operation whenever `i` is used to access `charset->code`. An attacker could leverage this issue in order to modify data in memory, or to cause the application to crash.",
    "publishedDate": "2022-05-30T14:45:05.766Z",
    "updatedDate": "2022-09-27T11:42:38.723Z",
    "disclosureDate": "2022-05-24T00:00:00.000Z",
    "exploitPublishDate": "2022-05-24T00:00:00.000Z",
    "solution": "Fixed by [this](https://gitlab.freedesktop.org/freetype/freetype-demos/-/commit/3541af5e7805a4d897b8a1b199eb5037b9f1a477) commit in the **master** branch, which has not yet been included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.0
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2022-05-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1494",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31782",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1494/ranges"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/freetype/freetype-demos/-/commit/3541af5e7805a4d897b8a1b199eb5037b9f1a477",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/freetype/freetype-demos/-/issues/8",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.freedesktop.org/freetype/freetype-demos/-/issues/8",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-1494/default-remediation-status"
            }
        ]
    }
}