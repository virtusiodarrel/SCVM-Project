{
    "source": "BDSA",
    "name": "BDSA-2018-2165",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via Integer Overflow in uvesafb Driver",
    "description": "A local unprivileged attacker with access to a uvesafb frame buffer device can issue an ioctl that causes a memory buffer overflow and allows them to escalate their privileges.",
    "technicalDescription": "The `uvesafb_setcmap` function in `drivers/video/fbdev/uvesafb.c` takes a user supplied `fb_cmap` length argument from an ioctl.  This length is multiplied by `sizeof(uvesafb_pal_entry)`as an argument to `kmalloc` which can overflow causing the size of the allocated heap buffer to be too small for the attacker controlled data copied into it.  The attacker can therefore overwrite adjacent kernel memory enabling them to escalate privileges.",
    "publishedDate": "2018-07-10T14:36:06.525Z",
    "updatedDate": "2018-07-10T14:36:06.518Z",
    "disclosureDate": "2018-05-11T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.18.114**](https://www.kernel.org)\n* [**4.4.139**](https://www.kernel.org)\n* [**4.9.111**](https://www.kernel.org)\n* [**4.14.53**](https://www.kernel.org)\n* [**4.17.4**](https://www.kernel.org)\n* [**4.18-rc1**](https://www.kernel.org)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9f645bcc566a1e9f921bdae7528a01ced5bc3713) commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.2,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:L/AC:L/Au:N/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.5,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.3
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2018-06-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.3,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-2165",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-680"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2018-13406",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2018-2165/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9f645bcc566a1e9f921bdae7528a01ced5bc3713",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}