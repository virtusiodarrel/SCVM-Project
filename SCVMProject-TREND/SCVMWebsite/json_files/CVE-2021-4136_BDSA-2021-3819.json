{
    "source": "BDSA",
    "name": "BDSA-2021-3819",
    "title": "Vim Vulnerable to Memory Corruption via Heap-Based Buffer Overflow in 'skipwhite' Function",
    "description": "Vim is vulnerable to memory corruption due to the improper handling of NULL characters. An attacker could trigger a heap-based buffer overflow by causing the application to process a maliciously crafted file. An attacker could leverage this issue in order to crash the process, or to modify data in memory. It may also be possible for an attacker to achieve arbitrary code execution, but such an attack has not been demonstrated.",
    "technicalDescription": "The function `eval_lambda()`, of file `src/eval.c`, processes the contents of a buffer (`arg`) which corresponds to an array of characters. Pointer arithmetic is performed in order to access each character in this buffer. The function contains logic that causes certain characters (e.g. white space) to be skipped over. This logic is flawed, such that the function can erroneously skip over the NULL byte that terminates an input string whenever a lambda that is associated with an error message is being processed. This can lead to a heap-based buffer overflow. An attacker can leverage this issue in order to cause a denial-of-service (DoS). It may also be possible for an attacker to modify data or execute arbitrary code, but this has not been demonstrated.",
    "publishedDate": "2021-12-20T16:52:48.886Z",
    "updatedDate": "2021-12-20T16:52:48.876Z",
    "disclosureDate": "2021-12-17T00:00:00.000Z",
    "exploitPublishDate": "2021-12-17T00:00:00.000Z",
    "solution": "Fixed in version [**8.2.3847**](https://github.com/vim/vim/releases/tag/v8.2.3847) by [this](https://github.com/vim/vim/commit/605ec91e5a7330d61be313637e495fa02a6dc264) commit.\n\nThe latest stable releases can be found [here](https://github.com/vim/vim/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 3.7,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 1.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 2.9
        },
        "vector": "(AV:L/AC:H/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.4,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Muhammad Aldo Firmansyah",
    "workaround": "",
    "vendorFixDate": "2021-12-18T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3819",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-122"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-4136",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3819/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vim/vim/commit/605ec91e5a7330d61be313637e495fa02a6dc264",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vim/vim/releases/tag/v8.2.3847",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/vim/vim/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/5c6b93c1-2d27-4e98-a931-147877b8c938/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://huntr.dev/bounties/5c6b93c1-2d27-4e98-a931-147877b8c938/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3819/default-remediation-status"
            }
        ]
    }
}