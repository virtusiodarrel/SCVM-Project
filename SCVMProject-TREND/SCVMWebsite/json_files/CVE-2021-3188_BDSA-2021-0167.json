{
    "source": "BDSA",
    "name": "BDSA-2021-0167",
    "title": "phpList Vulnerable to Remote Code Execution (RCE) via CSV Injection in 'email' Parameter",
    "description": "phpList contains a CSV injection vulnerability because of insufficient input validation. An attacker could exploit this flaw to inject malicious code into the application. This will lead to remote code execution (RCE) when a victim downloads and opens an exported CSV file.",
    "technicalDescription": "This vulnerability exists because the application does not sanitize the contents of the `email` parameter on the `Subscriber Profile` page. An attacker could submit malicious code via this page which will be stored on the server. When a victim user exports the corresponding contents to a CSV file, the code will exist in the file without being sanitized first.\n\nThe victim must uncheck the `ID` box while exporting the file for the payload to be interpreted. Also, Excel macros must be enabled by the victim for this vulnerability to be exploitable. If these conditions are met, an attacker can have malicious code execute on the server when the victim opens the CSV file.",
    "publishedDate": "2021-01-21T15:51:42.515Z",
    "updatedDate": "2021-03-08T10:43:58.342Z",
    "disclosureDate": "2021-01-19T00:00:00.000Z",
    "exploitPublishDate": "2021-01-19T00:00:00.000Z",
    "solution": "Fixed in [**3.6.1**](https://github.com/phpList/phplist3/releases/tag/3.6.1) by [this](https://github.com/phpList/phplist3/commit/8cf6d33262cb034559af0473b891a2ba0dee42be) commit.\n\nThe latest stable releases are available [here](https://github.com/phpList/phplist3/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.0,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 6.8,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:M/Au:S/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.4,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 1.7,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "CHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.6
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Rafael Murillo Mercado | WeHackMX",
    "workaround": "",
    "vendorFixDate": "2021-02-05T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0167",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-74"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3188",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0167/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/phpList/phplist3/commit/8cf6d33262cb034559af0473b891a2ba0dee42be",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/phpList/phplist3/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/phpList/phplist3/releases/tag/3.6.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://wehackmx.com/security-research/WeHackMX-2021-001/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://wehackmx.com/security-research/WeHackMX-2021-001/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0167/default-remediation-status"
            }
        ]
    }
}