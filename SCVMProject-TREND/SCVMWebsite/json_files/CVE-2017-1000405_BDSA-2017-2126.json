{
    "source": "BDSA",
    "name": "BDSA-2017-2126",
    "title": "Linux Kernel Vulnerable to Arbitrary Code Execution and Denial of Service via Race Condition with Huge Page (Huge Dirty COW)",
    "description": "Due to an incomplete fix for CVE-2016\u20135195 (\"Dirty COW\"), the Linux kernel remains partially vulnerable to denial of service (*DoS*) and local arbitrary code execution.",
    "technicalDescription": "The fix for CVE-2016\u20135195 (\"Dirty COW\") assumes that the read-only privileged copy of a page will never have a PTE pointing to it with the dirty bit on.  This is however not the case as \"Transparent Huge Pages\" (THP, a page that is 2MB in size) are swappable and can be used in anonymous, shmem and tmpfs mappings.  This provides an attacker with a similar race opportunity as CVE-2016\u20135195:  They get rid of copied version of the THP,  fault the original page twice, first to make it present, and then to turn on the dirty bit.  \n\nOne type of huge page an attacker may target is a \"huge zero page\" (HZP). This is a page filled with zeros and used for a variety of application requirements for zeroed data.  By overwriting data within this page, program assumptions may be broken when they expect zero data but end up with attacker controlled data.  This could allow privilege escalation.",
    "publishedDate": "2017-12-07T10:02:04.341Z",
    "updatedDate": "2018-11-12T14:46:10.789Z",
    "disclosureDate": "2017-11-22T00:00:00.000Z",
    "exploitPublishDate": "2017-11-27T00:00:00.000Z",
    "solution": "Fixed in versions:\n* [**3.16.52**](https://www.kernel.org)\n* [**3.18.86**](https://www.kernel.org)\n* [**4.1.48**](https://www.kernel.org)\n* [**4.4.104**](https://www.kernel.org)\n* [**4.9.67**](https://www.kernel.org)\n* [**4.14.4**](https://www.kernel.org)\n* [**4.15-rc2**](https://www.kernel.org)\n\nFixed by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a8f97366452ed491d13cf1e44241bc0b5740b1f0) git commit.",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 3.1,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:L/AC:L/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 6.0,
        "exploitabilitySubscore": 2.0,
        "severity": "HIGH",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Eylon Ben Yaakov at Bindecy",
    "workaround": "",
    "vendorFixDate": "2017-11-27T00:00:00.000Z",
    "vendorNotifiedDate": "2017-11-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.9,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2126",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-689"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2017-1000405",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2017-2126/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a8f97366452ed491d13cf1e44241bc0b5740b1f0",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/bindecy/HugeDirtyCowPOC",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://medium.com/bindecy/huge-dirty-cow-cve-2017-1000405-110eca132de0",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "www.kernel.org",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}