{
    "source": "BDSA",
    "name": "BDSA-2021-0797",
    "title": "OpenAM Vulnerable to LDAP Injection via 'searchSubOrgNames' Function with Webfinger Protocol",
    "description": "OpenAM is vulnerable to LDAP injection due to improper validation of LDAP queries with the Webfinger protocol. This could allow an unauthenticated attacker to perform filtered user enumeration and obtain sensitive information such as password hashes, session tokens or private keys.",
    "technicalDescription": "The issue exists in the function `searchSubOrgNames()` within the file `openam-core/src/main/java/com/sun/identity/sm/ldap/SMSLdapObject.java`. The function does not properly validate user-supplied resource parameters used to build LDAP filter queries in `FILTER_PATTERN_ORG` which contain special characters. This could enable an attacker to supply maliciously crafted queries via the Webfinger endpoint which allow them to identify user attributes and other sensitive data character-by-character.",
    "publishedDate": "2021-03-26T16:21:20.641Z",
    "updatedDate": "2021-11-01T16:24:49.863Z",
    "disclosureDate": "2021-03-24T00:00:00.000Z",
    "exploitPublishDate": "2021-03-24T00:00:00.000Z",
    "solution": "Fixed in `OpenIdentityPlatform/OpenAM` version [**14.6.3**](https://github.com/OpenIdentityPlatform/OpenAM/releases/tag/14.6.3) by [this](https://github.com/OpenIdentityPlatform/OpenAM/commit/f1fba812263d76bb218d157680a08eedf2ea236c) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Michael Stepankin",
    "workaround": "",
    "vendorFixDate": "2021-05-24T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0797",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-90"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-29156",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0797/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenIdentityPlatform/OpenAM/commit/f1fba812263d76bb218d157680a08eedf2ea236c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenIdentityPlatform/OpenAM/releases/tag/14.6.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://portswigger.net/research/hidden-oauth-attack-vectors",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://portswigger.net/research/hidden-oauth-attack-vectors",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0797/default-remediation-status"
            }
        ]
    }
}