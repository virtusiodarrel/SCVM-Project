{
    "source": "BDSA",
    "name": "BDSA-2022-0117",
    "title": "Log4j Vulnerable to Remote Code Execution (RCE) via Unsafe Deserialization in 'JMSSink' Component",
    "description": "Log4j is vulnerable to remote code execution (RCE) due to the deserialization of untrusted data. An attacker that is able to make the JMSSink component submit requests to a given LDAP server could load malicious Java classes into the vulnerable application's memory by leveraging the JNDI class-loading capability.\n\nIn order to exploit this vulnerability, the attacker must be able to control the configuration of Log4j, or must have access to an LDAP server which the JMSSink component is configured to use. Log4j must also be configured to utilize JMSSink, which is not used by default.",
    "technicalDescription": "JMSSink, as used by Log4j, can connect to a JMS server by using a connection factory that is provided by a JNDI provider. This provider can be an LDAP server which refers the host making the request to a location where they can download a connection factory class. An attacker who is able to manipulate the JMSSink configuration could modify the `TopicConnectionFactoryBindingName` setting so that JNDI requests are resolved via an LDAP server that the attacker controls. Whenever JMSSink attempts to resolve the connection factory, the attacker-controlled LDAP server will cause the vulnerable host to download a malicious class file. This class file will contain an arbitrary payload in its constructor, or in a static initialization block, that will be executed whenever the class is instantiated. The attacker could also carry out such an attack if JMSSink is already configured to resolve the connection factory class via a server that the attacker controls.",
    "publishedDate": "2022-01-18T17:01:09.500Z",
    "updatedDate": "2022-08-09T08:31:10.335Z",
    "disclosureDate": "2022-01-18T00:00:00.000Z",
    "solution": "Fixed in Apache Log4j **2.x** versions.\n\nThe latest stable releases are available [here](https://logging.apache.org/log4j/2.x/download.html).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.1,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 4.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.8
        },
        "vector": "(AV:N/AC:H/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.1,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.2,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "duardo' Vela, Maksim Shudrak, Jacob Butler (Google)",
    "workaround": "Ensure that Log4j is not configured to use JMSSink will  mitigate this vulnerability.",
    "vendorFixDate": "2012-07-29T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0117",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-502"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-23302",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0117/ranges"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/bsr3l5qz4g0myrjhy9h67bcxodpkwj4w",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://logging.apache.org/log4j/2.x/download.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2022/q1/50",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2022/q1/50",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0117/default-remediation-status"
            }
        ]
    }
}