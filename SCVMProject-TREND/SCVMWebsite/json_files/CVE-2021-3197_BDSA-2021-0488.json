{
    "source": "BDSA",
    "name": "BDSA-2021-0488",
    "title": "SaltStack Salt Vulnerable to Shell Injection via SSH Module 'ProxyCommand'",
    "description": "Salt, in use with the SSH module, is vulnerable to a shell injection issue due to a lack of sufficient input sanitization on arguments and API requests.\n\nAn attacker could submit a malicious request containing a `ProxyCommand` in order to execute commands on the target system.",
    "technicalDescription": "Salt is vulnerable to shell injection when the SSH module is installed and running on the minion. This functionality mishandles certain SSH arguments and API requests and allows commands to be injected using the `ProxyCommand` option. \n\nThis `ProxyCommand` option can be included in an argument, or through the use of `ssh_options` for API requests.\n\nTo remedy this issue, the vendor has added functionality to filter out the use of `ProxyCommand` from arguments passed via the CLI or `netapi`.",
    "publishedDate": "2021-03-01T16:36:59.681Z",
    "updatedDate": "2021-03-01T16:36:59.674Z",
    "disclosureDate": "2021-02-25T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3002.3**](https://github.com/saltstack/salt/releases/tag/v3002.3) by [this](https://github.com/saltstack/salt/commit/5273722c2180c394bc426f731450b95809ca952e) commit,\n* [**3001.5**](https://github.com/saltstack/salt/releases/tag/3001.5) by [this](https://github.com/saltstack/salt/commit/5fb5501cda1ad868d5d9998c11a4d7e6d8db6b4e) commit,\n* [**3000.7**](https://github.com/saltstack/salt/releases/tag/3000.7) by [this](https://github.com/saltstack/salt/commit/8235279eacf978b80d9d51b226674d4b12b979c5) commit.\n\nThe latest stable releases are available [here](https://repo.saltproject.io/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Daniel Jensen @dozernz",
    "workaround": "The vendor has supplied patches [here](https://gitlab.com/saltstack/open/salt-patches) for the following versions:\n* 3002.2\n* 3001.4\n* 3000.6\n* 2019.2.8\n* 2019.2.5\n* 2018.3.5\n* 2017.7.8\n* 2016.11.10\n* 2016.11.6\n* 2016.11.5\n* 2016.11.3\n* 2016.3.8\n* 2016.3.6\n* 2016.3.4\n* 2015.8.13\n* 2015.8.10\n\nThe vendor has stated [here](https://saltproject.io/security_announcements/active-saltstack-cve-release-2021-feb-25/) that links to each patch file are available from the `readme.md` file. Due to the regression found, there are more than one file per version to apply.",
    "vendorFixDate": "2021-01-22T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0488",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-78"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-3197",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0488/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/5273722c2180c394bc426f731450b95809ca952e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/5fb5501cda1ad868d5d9998c11a4d7e6d8db6b4e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/commit/8235279eacf978b80d9d51b226674d4b12b979c5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/3000.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/3001.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/saltstack/salt/releases/tag/v3002.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://gitlab.com/saltstack/open/salt-patches",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://repo.saltproject.io/",
                "label": "LINK"
            },
            {
                "rel": "reference",
                "href": "https://saltproject.io/security_announcements/active-saltstack-cve-release-2021-feb-25/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://saltproject.io/security_announcements/active-saltstack-cve-release-2021-feb-25/",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0488/default-remediation-status"
            }
        ]
    }
}