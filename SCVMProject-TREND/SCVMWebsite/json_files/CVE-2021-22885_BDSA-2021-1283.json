{
    "source": "BDSA",
    "name": "BDSA-2021-1283",
    "title": "Ruby On Rails Vulnerable to Information Disclosure via Polymorphic URLs",
    "description": "Ruby on Rails is vulnerable to information disclosure due to redirect statements disclosing the existence of methods which may only be accessible to authenticated users. An unauthenticated attacker could utilize a publicly available redirect statement to learn if certain methods exist in the Ruby on Rails web application.",
    "technicalDescription": "Ruby on Rails web applications that contain Action Pack's `redirect_to(params[:user_input])` or `polymorphic_url` statements can disclose the existence of methods ending with `_url`. The disclosure happens due to the attacker being able to see if their requested method name redirects successfully or results in HTTP 500 error. This vulnerability could also be used to remotely execute any public method.\n\nThe vulnerability was fixed by not allowing strings as polymorphic route arguments in `actionpack/lib/action_dispatch/routing/polymorphic_routes.rb`.",
    "publishedDate": "2021-05-10T16:09:25.199Z",
    "updatedDate": "2021-05-10T16:09:25.193Z",
    "disclosureDate": "2021-05-05T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.2.6**](https://github.com/rails/rails/releases/tag/v5.2.6) and [**5.2.4.6**](https://github.com/rails/rails/releases/tag/v5.2.4.6) by [this](https://github.com/rails/rails/commit/3eb9e74c287750a9fe11f700fc96d3be1e83aa35) commit\n* [**6.0.3.7**](https://github.com/rails/rails/releases/tag/v6.0.3.7) by [this](https://github.com/rails/rails/commit/f202249bdd701f908a57d733e633d366a982f8ce) commit\n* [**6.1.3.2**](https://github.com/rails/rails/releases/tag/v6.1.3.2) by [this](https://github.com/rails/rails/commit/030318784683f76df4c916d5a38b07dbf1f2aec5) commit\n\nThe latest stable releases are available [here](https://github.com/rails/rails/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.4,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.5,
        "impactSubscore": 2.5,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Benoit C\u00f4t\u00e9-Jodoin from Shopify",
    "workaround": "If an upgrade is not possible, the vendor has provided [patches](https://groups.google.com/g/rubyonrails-security/c/NiQl-48cXYI) for **5.2**, **6.0** and **6.1** version series.\n\nTo work around this problem without patching, the vendor advises using an allow list for valid\nparameters passed from the user.  For example:\n\n```\nprivate def check(param)\n  case param\n  when \"valid\"\n    param\n  else\n    \"/\"\n  end\nend\n\ndef index\n  redirect_to(check(params[:some_param]))\nend\n```\n\nOr force the user input to be cast to a string like this:\n\n```\ndef index\n  redirect_to(params[:some_param].to_s)\nend\n```",
    "vendorFixDate": "2021-05-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1283",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-923"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-22885",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1283/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/030318784683f76df4c916d5a38b07dbf1f2aec5",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/3eb9e74c287750a9fe11f700fc96d3be1e83aa35",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/f202249bdd701f908a57d733e633d366a982f8ce",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v5.2.4.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v5.2.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v6.0.3.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v6.1.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/rubyonrails-security/c/NiQl-48cXYI",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/rubyonrails-security/c/NiQl-48cXYI",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://hackerone.com/reports/1106652",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1283/default-remediation-status"
            }
        ]
    }
}