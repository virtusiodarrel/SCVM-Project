{
    "source": "BDSA",
    "name": "BDSA-2019-2713",
    "title": "FreeBSD Vulnerable to Denial-of-Service (DoS) via 'm_pulldown()' Function",
    "description": "FreeBSD is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. A remote attacker could cause the operating system to crash by supplying crafted IPv6 network packets. Only systems that have IPv6 networking capabilities enabled are vulnerable.",
    "technicalDescription": "The function `m_pulldown()`, which is defined within the script `uipc_mbuf2.c`, is used by the IPv6 module of FreeBSD to arrange data as a chain of `mbuf` objects. Building this chain involves prepending the contents of one `mbuf` memory buffer to another. This is performed using pointer arithmetic, whereby the value of the pointer variable `n->m_next->m_data` is decremented by the value of the variable `hlen`. The values of the variables used during this arithmetic are derived from the IPv6 packets being processed. However, the application does not perform any validation to ensure that the values used during this pointer arithmetic ensure that the data will be aligned in the correct positions. It is therefore possible to craft IPv6 packets that will cause the application to misalign the `mbuf` data, which can lead to a kernel panic. A remote attacker could therefore cause the FreeBSD operating system to crash by providing maliciously crafted IPv6 packets that will trigger the aforementioned misalignment event. It should be noted that only systems that have IPv6 networking capabilities enabled are vulnerable.",
    "publishedDate": "2019-08-27T16:15:06.959Z",
    "updatedDate": "2020-01-27T11:14:32.976Z",
    "disclosureDate": "2019-08-20T00:00:00.000Z",
    "solution": "Fixed in version [**12.1.0**](https://www.freebsd.org/releases/) by [this](https://svnweb.freebsd.org/base?view=revision&revision=350828) commit.\n\nFixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=350829) commit in the `stable/11` branch, which has not yet been included in any release.\n\nFixed by [this](https://svnweb.freebsd.org/base?view=revision&revision=351259) commit in the `releng/12.0`, `releng/11.3` and `releng/11.2` branches, which has not yet been included in any release.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.8,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.8
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Clement Lecigne",
    "workaround": "The vendor advises that the following workaround can be implemented:\n\nFor the currently known attack vector, systems with IPv6 not enabled are not vulnerable. On systems with IPv6 active, IPv6 fragmentation may be disabled, or a firewall can be used to filter out packets with certain or excessive amounts of extension headers in a first fragment. These rules may be dependent on the operational needs of each site.",
    "vendorFixDate": "2019-08-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2713",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-465"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-5611",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2713/ranges"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=350828",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=350829",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://svnweb.freebsd.org/base?view=revision&revision=351259",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.freebsd.org/security/advisories/FreeBSD-SA-19:22.mbuf.asc",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-2713/default-remediation-status"
            }
        ]
    }
}