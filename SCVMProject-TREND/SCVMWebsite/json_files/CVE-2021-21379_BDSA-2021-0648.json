{
    "source": "BDSA",
    "name": "BDSA-2021-0648",
    "title": "XWiki Vulnerable to Authorization Bypass via Improper Preservation of Permissions in '{{wikimacrocontent}}' Functionality",
    "description": "XWiki is vulnerable to authorization bypass via improper preservation of permissions. An attacker could exploit this flaw to execute scripts with the rights of a wiki macro, which they should not have access to.",
    "technicalDescription": "This vulnerability exists due to the `{{wikimacrocontent}}` executing content with the rights of the wiki macro author instead of the caller of that wiki macro. Attackers could exploit this by crafting malicious scripts to be injected and executed with the rights of the wiki macro, when extensions are used it is possible for the attacker to gain programming rights.",
    "publishedDate": "2021-03-15T15:43:15.699Z",
    "updatedDate": "2021-11-04T16:10:48.542Z",
    "disclosureDate": "2021-03-11T00:00:00.000Z",
    "solution": "Fixed in [**12.8rc-1**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.8-rc-1) by [this](https://github.com/xwiki/xwiki-platform/commit/2b7f485d31af189a3be8b38bef1901f6f34577ff) commit. \n\nFixed in [**11.10.11**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-11.10.11) by [this](https://github.com/xwiki/xwiki-platform/commit/17b69bff5d4b6eda0321ee7d3a0f21cad561fe05) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "Disable the affected macros",
    "vendorFixDate": "2020-09-09T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0648",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-281"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-21379",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0648/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/17b69bff5d4b6eda0321ee7d3a0f21cad561fe05",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/2b7f485d31af189a3be8b38bef1901f6f34577ff",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-11.10.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.8-rc-1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-v662-xpcc-9xf6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-v662-xpcc-9xf6",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-0648/default-remediation-status"
            }
        ]
    }
}