{
    "source": "BDSA",
    "name": "BDSA-2022-1836",
    "title": "GnuPG Vulnerable to Signature Forgery via Specialized Conditions Allowing Status Line Injection",
    "description": "GnuPG is vulnerable to a flaw that allows status line injection. An attacker who controls the secret part of at least one key in the victim's keyring, and the victim is using an application to call GnuPG like gpgme where certain conditions are met, could forge cryptographic signatures. The end result of this is application dependent, but it could allow email spoofing or authentication bypass.",
    "technicalDescription": "The issue exists in the `write_status_text_and_buffer()` function of file `g10/cpr.c` due to an off by one error in the parsing code that will result in random heap memory being written to the status line.\n\nThe prerequisites for exploitation is the following:\n1) The attacker must control the secret part of a key in the victim's keyring. This key does not have to trusted. It may even be revoked or expired provided the application does not require all signatures to be valid.\n2) The application uses a lax parser that is tolerant of invalid status lines.\n3) The application does not treat a non-zero exit code from GnuPG as an error.",
    "publishedDate": "2022-07-08T16:07:05.995Z",
    "updatedDate": "2022-09-05T14:39:59.137Z",
    "disclosureDate": "2022-06-30T00:00:00.000Z",
    "exploitPublishDate": "2022-06-30T00:00:00.000Z",
    "solution": "Fixed in version [**2.2.36**](https://git.gnupg.org/cgi-bin/gitweb.cgi?p=gnupg.git;a=commit;h=491645b50ec97db12520483d347291d660db209c) by [this](https://git.gnupg.org/cgi-bin/gitweb.cgi?p=gnupg.git;a=commit;h=7b1db7192e6e4d0cfc439b23b13831837c85bc21) commit.\n\nFixed in version [**2.3.7**](https://git.gnupg.org/cgi-bin/gitweb.cgi?p=gnupg.git;a=commit;h=bc5328f5119aa6f6233c4387660f163b77bb9ce1) by [this](https://git.gnupg.org/cgi-bin/gitweb.cgi?p=gnupg.git;a=commit;h=34c649b3601383cd11dbc76221747ec16fd68e1b) commit.\n\nThe latest stable releases can be found [here](https://www.gnupg.org/download/index.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Demi Marie Obenour of Invisible Things Lab",
    "workaround": "",
    "vendorFixDate": "2022-06-14T00:00:00.000Z",
    "vendorNotifiedDate": "2022-06-10T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-1836",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-193"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2022-34903",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2022-1836/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.gnupg.org/cgi-bin/gitweb.cgi?p=gnupg.git;a=commit;h=34c649b3601383cd11dbc76221747ec16fd68e1b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.gnupg.org/cgi-bin/gitweb.cgi?p=gnupg.git;a=commit;h=491645b50ec97db12520483d347291d660db209c",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://git.gnupg.org/cgi-bin/gitweb.cgi?p=gnupg.git;a=commit;h=7b1db7192e6e4d0cfc439b23b13831837c85bc21",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.gnupg.org/cgi-bin/gitweb.cgi?p=gnupg.git;a=commit;h=bc5328f5119aa6f6233c4387660f163b77bb9ce1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.gnupg.org/download/index.html",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2022/06/30/1",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2022/06/30/1",
                "label": "POC"
            }
        ]
    }
}