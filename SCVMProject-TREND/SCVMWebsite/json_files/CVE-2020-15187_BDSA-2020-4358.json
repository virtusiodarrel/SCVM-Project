{
    "source": "BDSA",
    "name": "BDSA-2020-4358",
    "title": "Helm Vulnerable to Arbitrary Code Execution via Improper Duplicate Plugin Handling",
    "description": "Helm is vulnerable to arbitrary code execution due to the improper validation of plugins. An attacker who is able to cause a malicious plugin to be installed on a victim's system could execute arbitrary code on that system. The attacker must have write access to a plugin repository, or be able to conduct a man-in-the-middle (MiTM) attack in order to achieve this.",
    "technicalDescription": "Helm loads plugins via the `LoadDir()` function, of file `pkg/plugin/plugin.go`. This function does not validate the metadata of the plugin which is being loaded. This means that duplicate plugins can be loaded successfully. An attacker could exploit this in order to cause a compromised plugin to be loaded, which could lead to arbitrary code execution. An attacker must have write access to a plugin repository, or be able to conduct a man-in-the-middle attack whilst a plugin is being download, in order to exploit this vulnerability.\n\nThe vulnerability was mitigated by adding a new function which validates plugin metadata (`validateMeta()`). This function is called in `LoadDir()`.",
    "publishedDate": "2021-04-22T16:21:07.628Z",
    "updatedDate": "2021-09-17T15:30:37.795Z",
    "disclosureDate": "2020-09-17T00:00:00.000Z",
    "solution": "Fixed in:\n* [**3.3.2**](https://github.com/helm/helm/releases/tag/v3.3.2) by [this](https://github.com/helm/helm/commit/ac7c07c37d87e09797f714fb57aa5e9cb99d9450) commit.\n* [**2.16.11**](https://github.com/helm/helm/releases/tag/v2.16.11) by [this](https://github.com/helm/helm/commit/c8d6b01d72c9604e43ee70d0d78fadd54c2d8499) commit.\n\nThe latest stable releases are available [here](https://github.com/helm/helm/releases).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 4.6,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.4
        },
        "vector": "(AV:N/AC:H/Au:S/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.4,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 0.5,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "HIGH",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.6
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The vendor has stated that the following workaround is effective:\n> Make sure to install plugins using a secure connection protocol like SSL.",
    "vendorFixDate": "2020-09-17T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 5.6,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4358",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-694"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15187",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4358/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/commit/ac7c07c37d87e09797f714fb57aa5e9cb99d9450",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/commit/c8d6b01d72c9604e43ee70d0d78fadd54c2d8499",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases/tag/v2.16.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/releases/tag/v3.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/security/advisories/GHSA-c52f-pq47-2r9j",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/helm/helm/security/advisories/GHSA-c52f-pq47-2r9j",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4358/default-remediation-status"
            }
        ]
    }
}