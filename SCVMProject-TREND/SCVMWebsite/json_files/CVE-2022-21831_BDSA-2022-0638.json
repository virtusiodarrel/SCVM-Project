{
    "source": "BDSA",
    "name": "BDSA-2022-0638",
    "title": "Ruby on Rails Vulnerable to Code Injection via Active Storage Module",
    "description": "Ruby on Rails contains a code injection vulnerability.  An attacker can take advantage of this in order to inject and execute arbitrary commands.\n\n**Note:** The vendor has stated that this vulnerability impacts applications that use Active Storage with the `image_processing` processing in addition to the `mini_magick` back end for `image_processing`.",
    "technicalDescription": "This vulnerability exists in the Active Storage module of Ruby on Rails due to insufficient validation on the image transformation method. An attacker can take advantage of this by using maliciously crafted arguments in the image transformation method in order to achieve code injection. \n\nThe vendor has mitigated against this by adding image transformation validation via configurable allow-list.",
    "publishedDate": "2022-03-09T13:38:47.486Z",
    "updatedDate": "2022-03-09T13:38:47.460Z",
    "disclosureDate": "2022-03-08T00:00:00.000Z",
    "solution": "Fixed in:\n* [**7.0.2.3**](https://github.com/rails/rails/releases/tag/v7.0.2.3) by [this](https://github.com/rails/rails/commit/0a72f7d670) commit,\n* [**6.1.4.7**](https://github.com/rails/rails/releases/tag/v6.1.4.7) by [this](https://github.com/rails/rails/commit/b0b5eaf477) commit,\n* [**6.0.4.7**](https://github.com/rails/rails/releases/tag/v6.0.4.7) by [this](https://github.com/rails/rails/commit/92f64fec3136baabbebac97073c5213ea055dc53) commit,\n* [**5.2.6.3**](https://github.com/rails/rails/releases/tag/v5.2.6.3) by [this](https://github.com/rails/rails/commit/94e2f00d2abedbea1ef62fc775d031ffda00662c) commit.\n\nThe latest stable releases are available [here](https://github.com/rails/rails/tags).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "gquadros_",
    "workaround": "The vendor has provided the following [workaround](https://groups.google.com/g/rubyonrails-security/c/n-p-W1yxatI):\n\n> Applications should implement a strict allow-list on accepted transformation methods or arguments.  Additionally, a strict image magick security policy will help mitigate this issue.",
    "vendorFixDate": "2022-03-08T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0638",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-21831",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0638/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-w749-p3v6-hccq",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/0a72f7d670",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/92f64fec3136baabbebac97073c5213ea055dc53",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/94e2f00d2abedbea1ef62fc775d031ffda00662c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/commit/b0b5eaf477",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v5.2.6.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v6.0.4.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v6.1.4.7",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/releases/tag/v7.0.2.3",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/rails/rails/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/rubyonrails-security/c/n-p-W1yxatI",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://groups.google.com/g/rubyonrails-security/c/n-p-W1yxatI",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-0638/default-remediation-status"
            }
        ]
    }
}