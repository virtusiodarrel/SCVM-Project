{
    "source": "BDSA",
    "name": "BDSA-2019-1379",
    "title": "phpBB Vulnerable to Denial-of-Service (DoS) via 'keywords' Request Parameter",
    "description": "phpBB is vulnerable to denial-of-service (DoS) due to the use of a problematic SQL query that can consume large amounts of system resources. A remote unauthenticated attacker could cause the application to crash or become unresponsive by submitting a crafted HTTP request.",
    "technicalDescription": "The `split_keywords()` function, which is defined within `fulltext_native.php`, contains code that is used in the dynamic construction of an SQL query. The `$keywords` variable, the value of which is derived from client input, is used in the construction process. A client is allowed to specify an arbitrary number of wild-cards when providing input. By providing multiple wild-cards, a remote  unauthenticated attacker can cause the application to process a SQL query that will lead to a DoS. This DoS will arise as a result of the database engine consuming all available CPU resources. This will cause the application to become unresponsive to legitimate users, and may even cause the process to crash.",
    "publishedDate": "2019-05-03T13:22:20.356Z",
    "updatedDate": "2019-05-03T13:22:20.337Z",
    "disclosureDate": "2019-05-01T00:00:00.000Z",
    "solution": "Fixed in version [**3.2.6**](https://github.com/phpbb/phpbb/releases/tag/release-3.2.6) by [this](https://github.com/phpbb/phpbb/commit/da9910850a168f73c6b8dd8407a01f47d27ca1d8) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.8,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.1
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "The following mitigations are advised if an upgrade is not possible:\n\n1. Set \u201cSearch backend\u201d to an engine other than \u201cphpBB Native Fulltext\u201d\n2. Set the \u201cCan search board\u201d group permission to \u201cNo\u201d for all untrusted user groups\n3. Set \u201cEnable search facilities\u201d to \u201cNo\u201d",
    "vendorFixDate": "2019-04-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1379",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-770"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9826",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1379/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/phpbb/phpbb/commit/da9910850a168f73c6b8dd8407a01f47d27ca1d8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/phpbb/phpbb/releases/tag/release-3.2.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/152695/phpbb325-dos.txt",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1379/default-remediation-status"
            }
        ]
    }
}