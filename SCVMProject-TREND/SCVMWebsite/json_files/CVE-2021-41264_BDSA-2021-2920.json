{
    "source": "BDSA",
    "name": "BDSA-2021-2920",
    "title": "Node.js OpenZeppelin 'Contracts' and 'Contracts Upgradeable' Packages Vulnerable to Denial-of-Service (DoS) via 'UUPSUpgradeable' Contracts Flaw",
    "description": "OpenZeppelin Contracts and Contracts Upgradeable are vulnerable to a denial-of-service (DoS) issue due to a flaw present in `UUPSUpgradeable` contracts.\n\nAgainst uninitialized contracts, an attacker could initialize them, appoint themselves as upgrade administrators and force them to use malicious contracts that impede access to any assets held on the target contract.",
    "technicalDescription": "OpenZeppelin Contracts and Contracts Upgradeable are vulnerable to DoS conditions because the `DELEGATECALL` instructions in the upgrade function of `UUPSUpgradeable` based contracts can be abused to have the implementation contract call into another contract that `SELFDESTRUCT`s itself which causes the called to be destroyed. \n\nIf an attacker manages to successfully attack an uninitialized contract, proxy contracts backed by the implementation can become unusable where an upgrade to the proxy is not possible and assets held on it become inaccessible.",
    "publishedDate": "2021-10-04T15:57:56.594Z",
    "updatedDate": "2022-01-18T15:42:03.104Z",
    "disclosureDate": "2021-09-14T00:00:00.000Z",
    "exploitPublishDate": "2021-09-16T00:00:00.000Z",
    "solution": "Fixed in OpenZeppelin Contracts [**4.3.2**](https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.3.2) by [this](https://github.com/OpenZeppelin/openzeppelin-contracts/commit/024cc50df478d2e8f78539819749e94d6df60592) commit.\n\nFixed in OpenZeppelin Contracts Upgradeable [**4.3.2**](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/releases/tag/v4.3.2) by [this](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/5c21639dc39b9062310ee3ca30aa2c3a4feccd8f) commit.\n\nThe latest stable releases of Contracts are available [here](https://www.npmjs.com/package/@openzeppelin/contracts), and the latest stable releases of Contracts Upgradable are available [here](https://www.npmjs.com/package/@openzeppelin/contracts-upgradeable).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.8,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.5
        },
        "vector": "(AV:N/AC:M/Au:N/C:N/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.1,
        "impactSubscore": 5.2,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Raymond Yeh, Iosiro",
    "workaround": "The vendor has suggested identical workarounds for Contracts and Contracts Upgradeable [here](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-5vp3-v4hc-gx76) and [here](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/security/advisories/GHSA-q4h9-46xg-m3x9):\n> Initialize implementation contracts using `UUPSUpgradeable` by invoking the initializer function (usually called `initialize`). An example is provided in the forum.\n\nThe forum post is viewable [here](https://forum.openzeppelin.com/t/security-advisory-initialize-uups-implementation-contracts/15301).",
    "vendorFixDate": "2021-09-14T00:00:00.000Z",
    "vendorNotifiedDate": "2021-09-03T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2920",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-41264",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2920/ranges"
            },
            {
                "rel": "reference",
                "href": "https://forum.openzeppelin.com/t/security-advisory-initialize-uups-implementation-contracts/15301",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://forum.openzeppelin.com/t/uupsupgradeable-vulnerability-post-mortem/15680",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://geeksg.medium.com/my-journey-to-disclosing-a-vulnerability-that-can-lock-up-millions-in-ethereum-dcb5754ad9bc",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/5c21639dc39b9062310ee3ca30aa2c3a4feccd8f",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/releases/tag/v4.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/security/advisories/GHSA-q4h9-46xg-m3x9",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/security/advisories/GHSA-q4h9-46xg-m3x9",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/024cc50df478d2e8f78539819749e94d6df60592",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.3.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-5vp3-v4hc-gx76",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-5vp3-v4hc-gx76",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/yehjxraymond/exploding-kitten",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://www.iosiro.com/blog/openzeppelin-uups-proxy-vulnerability-disclosure",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/@openzeppelin/contracts",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.npmjs.com/package/@openzeppelin/contracts-upgradeable",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-2920/default-remediation-status"
            }
        ]
    }
}