{
    "source": "BDSA",
    "name": "BDSA-2022-2671",
    "title": "XWiki Vulnerable to Authorisation Bypass via Code Overwrite in 'Copy' Functionality",
    "description": "XWiki contains a privilege escalation vulnerability due to the ability for an attacker to overwrite a page's contents. An attacker with user-level privileges could exploit this issue by creating a new page and renaming it as a terminal page, matching the name of a pre-existing page. This will allow for the same security cache being used for the pre-existing page, which will allow it be accessed.",
    "technicalDescription": "This issue exists due to users being able to modify or delete existing pages through new pages which have been converted to terminal pages.\n\nMitigation for this issue came in the form of adding new functions, `escapeEntryKey()` and `getEntryKey()`.",
    "publishedDate": "2022-09-23T16:28:22.036Z",
    "updatedDate": "2022-09-23T16:28:22.025Z",
    "disclosureDate": "2022-09-07T00:00:00.000Z",
    "exploitPublishDate": "2022-09-07T00:00:00.000Z",
    "solution": "Fixed in versions: \n\n* [**12.10.11**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.10.11) by [this](https://github.com/xwiki/xwiki-platform/commit/4ccf2791619009f26d1767e462f41193c2a98cc1) commit.\n* [**13.10.1**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.10.1) by [this](https://github.com/xwiki/xwiki-platform/commit/d5aa5f916b0edb2a4904a411680ebf284a573693) commit.\n* [**13.4.6**](https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.4.6) by [this](https://github.com/xwiki/xwiki-platform/commit/68d8a8973765c4d8106e05927d8d974eaba3be45) commit.\n\nThe latest stable releases can be found [here](https://github.com/xwiki/xwiki-platform/tags).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.5,
        "impactSubscore": 4.9,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.3
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.1,
        "impactSubscore": 4.2,
        "exploitabilitySubscore": 2.8,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.4
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "surli",
    "workaround": "",
    "vendorFixDate": "2021-11-29T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.4,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2671",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-285"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-31167",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2671/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/4ccf2791619009f26d1767e462f41193c2a98cc1",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/68d8a8973765c4d8106e05927d8d974eaba3be45",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/commit/d5aa5f916b0edb2a4904a411680ebf284a573693",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-12.10.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.10.1",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/releases/tag/xwiki-platform-13.4.6",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-gg53-wf5x-r3r6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/xwiki/xwiki-platform/tags",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://jira.xwiki.org/browse/XWIKI-18983",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://jira.xwiki.org/browse/XWIKI-18983",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2671/default-remediation-status"
            }
        ]
    }
}