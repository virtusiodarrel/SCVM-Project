{
    "source": "BDSA",
    "name": "BDSA-2021-1612",
    "title": "Linux Kernel Vulnerable to Privilege Escalation via Flawed BPF Verifier Calculations",
    "description": "Linux Kernel is vulnerable to a privilege escalation issue due to how the BPF verifier functionality can incorrectly calculate the limits to enforce on pointer arithmetic.\n\nA local attacker could abuse this flaw in order to modify data in memory in order to hijack control flow and escalate privileges.",
    "technicalDescription": "Linux Kernel is vulnerable to privilege escalation because the pointer arithmetic limit calculations for BPF programs are flawed where the `off_reg` sign change causes a masking direction change which results in an incorrect final `aux->alu_limit`.\n\nWhen the incorrect limit is enforced, pointer arithmetic operations can cause out-of-bounds reads and writes to occur in kernel memory. This behavior could be abused in order to examine and modify critical data structures in kernel memory.",
    "publishedDate": "2021-05-28T15:14:16.993Z",
    "updatedDate": "2021-05-28T15:14:16.988Z",
    "disclosureDate": "2021-05-26T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.4.123**](https://www.kernel.org) by the following commits:\n\t*  [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2768f9962231800dab70f5178041b4ff5028fc5d)\n\t*  [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2b3cc41d500a74bb48358faf40b4a4ec6f03e25e)\n\t*  [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3173c7c807854a580c85f04193a6a25aeff3dd96)\n* [**5.10.41**](https://www.kernel.org) by the following commits:\n\t* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4e2c7b297431457663a90d4186e666b61d5da86c)\n\t* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c87ef240a8bbbda5913fac1e84209d224c1aaf50)\n\t* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=27acfd11ba179b746f55077edf9750f8f7cb1cb6)\n* [**5.12.8**](https://www.kernel.org) by the following commits:\n\t* [Commit 1](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9accd53bd479974c434554e3446149884890623a)\n\t* [Commit 2](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4dd2aaaddbcfd8e9f097512c745d69018f8e9801)\n\t* [Commit 3](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f3ab9709b00ed389f870f6b20d323193bcf572c8)\n\nThe latest stable releases are available [here](https://www.kernel.org).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.6,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 2.7,
        "severity": "MEDIUM",
        "accessVector": "LOCAL",
        "accessComplexity": "MEDIUM",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.9
        },
        "vector": "(AV:L/AC:M/Au:S/C:C/I:C/A:C/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-05-21T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1612",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-787"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-33200",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1612/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2768f9962231800dab70f5178041b4ff5028fc5d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=27acfd11ba179b746f55077edf9750f8f7cb1cb6",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=2b3cc41d500a74bb48358faf40b4a4ec6f03e25e",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=3173c7c807854a580c85f04193a6a25aeff3dd96",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4dd2aaaddbcfd8e9f097512c745d69018f8e9801",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=4e2c7b297431457663a90d4186e666b61d5da86c",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=9accd53bd479974c434554e3446149884890623a",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=c87ef240a8bbbda5913fac1e84209d224c1aaf50",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=f3ab9709b00ed389f870f6b20d323193bcf572c8",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7fedb63a8307dda0ec3b8969a3b233a1dd7ea8e0",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2021/05/27/1",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-1612/default-remediation-status"
            }
        ]
    }
}