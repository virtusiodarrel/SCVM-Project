{
    "source": "BDSA",
    "name": "BDSA-2020-1598",
    "title": "Samba Vulnerable to Denial-of-Service (DoS) via Excessive Resource Consumption with NetBIOS over TCP/IP Replies",
    "description": "Samba is vulnerable to denial-of-service (DoS) due to improper processing of NetBIOS over TCP/IP communications. An attacker could exploit this vulnerability by supplying a system with maliciously crafted input, in order to consume excessive CPU resources and restrict or deny access to a target server.",
    "technicalDescription": "The DNS name compression algorithm of Samba does not properly parse crafted names including `.` separators inside the components. This can lead to the component limit of 128 being exceeded and compression requiring an unexpectedly long internal list to be processed. This can result in excessive CPU consumption when generating replies to NetBIOS over TCP/IP name resolution, which uses this compression algorithm.",
    "publishedDate": "2020-07-09T09:53:03.961Z",
    "updatedDate": "2020-07-09T09:53:03.953Z",
    "disclosureDate": "2020-07-02T00:00:00.000Z",
    "solution": "Fixed in:\n* **[4.10.17](https://github.com/samba-team/samba/releases/tag/samba-4.10.17)** by [this](https://download.samba.org/pub/samba/patches/security/samba-4.10.16-security-2020-07-02.patch) patch,\n* **[4.11.11](https://github.com/samba-team/samba/releases/tag/samba-4.11.11)** by [this](https://download.samba.org/pub/samba/patches/security/samba-4.11.10-security-2020-07-02.patch) patch,\n* **[4.12.4](https://github.com/samba-team/samba/releases/tag/samba-4.12.4)** by [this](https://download.samba.org/pub/samba/patches/security/samba-4.12.3-security-2020-07-02.patch) patch.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Honggfuzz",
    "workaround": "If upgrading to a fixed version cannot be performed immediately, the vendor recommends disabling the NBT server in the Activer Directory DC with `disable netbios = yes`. The implementation provided by nmbd in the file-server configuration is not subject to this issue.",
    "vendorFixDate": "2020-06-25T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1598",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-400"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-10745",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1598/ranges"
            },
            {
                "rel": "reference",
                "href": "https://download.samba.org/pub/samba/patches/security/samba-4.10.16-security-2020-07-02.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://download.samba.org/pub/samba/patches/security/samba-4.11.10-security-2020-07-02.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://download.samba.org/pub/samba/patches/security/samba-4.12.3-security-2020-07-02.patch",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.10.17",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.11.11",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/samba-team/samba/releases/tag/samba-4.12.4",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.samba.org/samba/security/CVE-2020-10745.html",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-1598/default-remediation-status"
            }
        ]
    }
}