{
    "source": "BDSA",
    "name": "BDSA-2019-2915",
    "title": "Linux Kernel for PowerPC Vulnerable to Information Exposure via Unavailable Exception in Transaction",
    "description": "The Linux Kernel for PowerPC has an error in how it handles an unavailable exception inside a transaction. This allows any user to read the FP/VMX registers of a process owned by a different user. Users can also experience corruption of their FP/VMX state. \n\nThis bug is present on all machines were transactional memory is present. This includes all POWER8 variants and POWER9 VMS under KVM or LPARs under POWERVM. POWER9 bare metal doesn't support transactional memory and therefore isn't affected.",
    "technicalDescription": "To trigger this bug, a process starts a transaction and reads an FP or VMX register. The FP/VMX must be set to 0 so that an unavailable exception is triggered inside the transaction. The transaction can then fail which causes a rollback to the checkpointed state. The Kernel does not handle this correctly allowing the checkpointed state to be set to the FP/VMX registers of another process.  The checkpointed state can then be read by the process.\n\nWhen an FP unavailable exception happens inside a transaction, the Kernel should account for the hardware FP TM checkpointed registers being incorrect. \nThe code assumes that the current and checkpointed FP registers are the same and therefore copies the current FP registers to the checkpointed ones in the `thread_struct`. \n\nThis copy is performed in` tm_reclaim_thread`. The `thread->ckpt_regs.msr` member is used to determine if FP was on when in userspace. `thread->ckpt_regs.msr` represents the state of the MSR when exiting userspace. This is setup by `check_if_tm_restore_required()`.\n\nThere is an optimisation in `giveup_all` which will return early if `sk->thread.regs->msr`has `FP=VEC=VSX=SPE=0`.  This means that `check_if_tm_restore_required()` is not called and `thread->ckpt_regs.msr` will contain an old value. \n\nThis flaw results in corruption of the floating point/VMX registers and allows data in floating point/VMX registers to be leaked from one process to another.",
    "publishedDate": "2019-09-13T12:29:39.725Z",
    "updatedDate": "2019-09-20T09:01:43.085Z",
    "disclosureDate": "2019-09-10T00:00:00.000Z",
    "solution": "Fixed in:\n* [**4.9.193**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=acdf558ef62ceb71938d87f5b700b7ecc0bbee90) commit\n* [**4.14.144**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=32b803e81ce17eec816f09d5388ef0a1cc9e4c2f) commit\n* [**4.19.73**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=47a0f70d7d9ac3d6b1a96b312d07bc67af3834e9) commit\n* [**5.2.15**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=7f20c56c0b7a79e310ed6b4bf13bc009f339529a) commit\n* [**5.3-rc8**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=8205d5d98ef7f155de211f5e2eb6ca03d95a5a60) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "LOCAL",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:L/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 6.2,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 2.5,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Michael Neuling",
    "workaround": "",
    "vendorFixDate": "2019-09-04T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 5.4,
    "_meta": {
        "allow": [],
        "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2915",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro.app.blackduck.com/api/cwes/CWE-200"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/CVE-2019-15030",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro.app.blackduck.com/api/vulnerabilities/BDSA-2019-2915/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=8205d5d98ef7f155de211f5e2eb6ca03d95a5a60",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://seclists.org/oss-sec/2019/q3/209",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            }
        ]
    }
}