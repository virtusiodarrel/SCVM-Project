{
    "source": "BDSA",
    "name": "BDSA-2019-5056",
    "title": "Vesta Control Panel Vulnerable to Privilege Escalation and Remote Code Execution (RCE) via 'escapeshellarg()' Function",
    "description": "Vesta Control Panel is vulnerable to remote code execution (RCE) and privilege escalation due to insufficient user input validation. Attackers could exploit this by passing maliciously crafted commands to the application.",
    "technicalDescription": "This vulnerability exists within the `web/edit/server/index.php`, `web/list/dns/index.php` and `web/list/mail/index.php` files, due to the `escapeshellarg()` function being implemented improperly. Attackers could exploit this by inputting a maliciously crafted command to trigger remote code execution condition with elevated privileges.",
    "publishedDate": "2021-02-26T16:57:49.006Z",
    "updatedDate": "2021-02-26T16:57:49.001Z",
    "disclosureDate": "2019-04-21T00:00:00.000Z",
    "exploitPublishDate": "2019-04-21T00:00:00.000Z",
    "solution": "Fixed in [**0.9.8-24**](https://github.com/serghey-rodin/vesta/releases/tag/0.9.8-24) by [this](https://github.com/serghey-rodin/vesta/commit/ab95d5d88daa0a49004ddb44b05decff803dc99c) commit.\n\nThe latest stable releases are available [here](https://github.com/serghey-rodin/vesta/releases/).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 9.0,
        "impactSubscore": 10.0,
        "exploitabilitySubscore": 8.0,
        "severity": "HIGH",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "COMPLETE",
        "integrityImpact": "COMPLETE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.1
        },
        "vector": "(AV:N/AC:L/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.9
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-04-15T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 7.9,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5056",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-77"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-9859",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5056/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/serghey-rodin/vesta/commit/ab95d5d88daa0a49004ddb44b05decff803dc99c",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/serghey-rodin/vesta/releases/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/serghey-rodin/vesta/releases/tag/0.9.8-24",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://ssd-disclosure.com/ssd-advisory-vesta-cp-remote-command-execution-to-privilege-escalation/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://ssd-disclosure.com/ssd-advisory-vesta-cp-remote-command-execution-to-privilege-escalation/",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-5056/default-remediation-status"
            }
        ]
    }
}