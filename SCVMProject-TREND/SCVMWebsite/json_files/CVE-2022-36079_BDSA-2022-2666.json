{
    "source": "BDSA",
    "name": "BDSA-2022-2666",
    "title": "Parse Server Vulnerable to Information Disclosure via Brute Forcing Search Patterns",
    "description": "Parse Server is vulnerable to an information disclosure issue due to the existence of an information enumeration flaw that occurs as a result of how query constraints are handled. Normally, internal fields (internal keys used by Parse Server) and protected fields (user defined fields) can be used as query constraints but are removed from query results unless the client is using a valid master key.\n\nAn attacker could abuse the use of query constraints and begin to guess the fields through enumeration until Parse Server returns a response object to the given query.",
    "technicalDescription": "To remedy this issue, the vendor has implemented the `RestQuery.prototype.denyProtectedFields()` function in the `src/RestQuery.js` file to restrict the use of both the internal and protected fields as query constraints to users who provide the master key.",
    "publishedDate": "2022-09-23T16:32:24.705Z",
    "updatedDate": "2022-09-23T16:32:24.689Z",
    "disclosureDate": "2022-09-02T00:00:00.000Z",
    "solution": "Fixed in:\n* **[4.10.14](https://github.com/parse-community/parse-server/releases/tag/4.10.14)** by [this](https://github.com/parse-community/parse-server/commit/634c44ac) commit,\n* **[5.2.5](https://github.com/parse-community/parse-server/releases/tag/5.2.5)** by [this](https://github.com/parse-community/parse-server/commit/e39d51bd) commit,\n* **[5.3.0-alpha22](https://github.com/parse-community/parse-server/releases/tag/5.3.0-alpha.22)** by [this](https://github.com/parse-community/parse-server/commit/4c0c7c77) commit,\n* the **beta** branch by [this](https://github.com/parse-community/parse-server/commit/f0db4ca4) commit.\n\nThe latest stable releases are available [here](https://github.com/parse-community/parse-server/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.7
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.6,
        "impactSubscore": 4.0,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 7.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "s00py",
    "workaround": "The vendor has suggested in their [advisory](https://github.com/parse-community/parse-server/security/advisories/GHSA-2m6g-crv8-p3c6) that users can implement a Parse Cloud Trigger `beforeFind` and manually remove the query constraints, such as:\n```\nParse.Cloud.beforeFind('TestObject', ({ query }) => {\n  for (const key in query._where || []) {\n    // Repeat logic for protected fields\n    if (key.charAt(0) === '_') {\n      delete query._where[key];\n    }\n  }\n});\n```",
    "vendorFixDate": "2022-09-02T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 7.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2666",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-203"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2022-36079",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2666/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/4c0c7c77",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/634c44ac",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/e39d51bd",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/commit/f0db4ca4",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/pull/8144",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases/tag/4.10.14",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases/tag/5.2.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/releases/tag/5.3.0-alpha.22",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/security/advisories/GHSA-2m6g-crv8-p3c6",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/parse-community/parse-server/security/advisories/GHSA-2m6g-crv8-p3c6",
                "label": "WORKAROUND"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2022-2666/default-remediation-status"
            }
        ]
    }
}