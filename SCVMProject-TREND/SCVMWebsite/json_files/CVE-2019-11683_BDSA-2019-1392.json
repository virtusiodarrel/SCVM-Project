{
    "source": "BDSA",
    "name": "BDSA-2019-1392",
    "title": "Linux Kernel Vulnerable to Denial-of-Service (DoS) via Out-of-Bounds Memory Access in 'udp_gro_receive_segment()' Function",
    "description": "The Linux kernel is vulnerable to denial-of-service (DoS) due to the mismanagement of system memory resources. An attacker could cause the operating system of a remote server to crash by providing crafted network traffic.",
    "technicalDescription": "The Linux kernel implements Generic Receive Offload (GRO) functionality using code that is contained within a variety of functions. The usage of GRO necessitates the careful manipulation of packet data within memory buffers. Whenever the GRO processing of UDP packets is being conducted by the Linux kernel, received packets will undergo intial processing via code contained within the function `udp_gro_receive_segment()`. This function conducts some cursory validation regarding checksums and the length field specified in the packet headers. \n\nHowever, the code does not ensure that the packet has a non-zero payload length. This has detrimental implications for the packet aggregation process. For example, within the function `skb_gro_receive()`, an attempt is made to copy packet fragment data from one buffer (pointed to by the `frag2` variable) to another (pointed to by the `frag1` variable). The assumption is that these variables will always point to a memory location containing valid payload data. However, if the payload length is zero, this will not be the case and the application can attempt to access an invalid memory location. This will cause an exception to be raised, halting program execution. \n\nA remote attacker could therefore cause a system crash by providing a crafted UDP packet that has no payload. The possibility of triggering this crash using a padded packet also exists. The kernel's TCP-based GRO processing functionality does not aggregate packets without a payload and so this problem only affects the UDP implementation.",
    "publishedDate": "2019-05-07T10:13:07.306Z",
    "updatedDate": "2019-05-07T10:13:07.298Z",
    "disclosureDate": "2019-05-01T00:00:00.000Z",
    "exploitPublishDate": "2019-05-01T00:00:00.000Z",
    "solution": "Fixed in **[5.1](https://www.kernel.org/)** by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ea9866793d1e925b4d320eaea409263b2a568f38) commit.",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 7.8,
        "impactSubscore": 6.9,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "COMPLETE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.1
        },
        "vector": "(AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "NONE",
        "integrityImpact": "NONE",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2019-05-01T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1392",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-125"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2019-11683",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1392/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/?id=4dd2b82d5adfbe0b1587ccad7a8f76d826120f37",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/?id=4dd2b82d5adfbe0b1587ccad7a8f76d826120f37",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ea9866793d1e925b4d320eaea409263b2a568f38",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org/",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://www.openwall.com/lists/oss-security/2019/05/02/1",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2019-1392/default-remediation-status"
            }
        ]
    }
}