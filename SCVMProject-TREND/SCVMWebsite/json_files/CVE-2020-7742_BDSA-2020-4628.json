{
    "source": "BDSA",
    "name": "BDSA-2020-4628",
    "title": "SimpleSchema Vulnerable to Prototype Pollution in 'merge' Function",
    "description": "SimpleSchema is vulnerable to prototype pollution due to unsafe object recursive merge. This can allow an attacker to inject malicious properties into prototypes, which will then be inherited by all objects in that prototype chain. This could lead to remote code execution (RCE).",
    "technicalDescription": "This vulnerability exists within the function `merge` in the file `package/lib/utility/merge.js` due to improper validation of input for prototype keyword, `__proto__`. An attacker could add or modify properties of `Object.prototype` using  `__proto__`.",
    "publishedDate": "2021-09-30T10:39:13.813Z",
    "updatedDate": "2021-09-30T10:39:13.804Z",
    "disclosureDate": "2020-10-06T00:00:00.000Z",
    "exploitPublishDate": "2020-10-07T00:00:00.000Z",
    "solution": "Fixed in version [**1.10.2**](https://github.com/longshotlabs/simpl-schema/releases/tag/1.10.2) by [this](https://github.com/longshotlabs/simpl-schema/commit/50128841fa7fc2d137c36a397054279144caea3d) commit.\n\nThe latest stable releases can be found [here](https://github.com/longshotlabs/simpl-schema).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.8
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Alessio Della Libera",
    "workaround": "",
    "vendorFixDate": "2020-10-06T00:00:00.000Z",
    "vendorNotifiedDate": "2020-10-01T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4628",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-7742",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4628/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/advisories/GHSA-9mx2-prfp-8hqp",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/longshotlabs/simpl-schema",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/longshotlabs/simpl-schema/commit/50128841fa7fc2d137c36a397054279144caea3d",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/longshotlabs/simpl-schema/commit/7f64e19984091dfebbccd0566a9aef0ed4ae46c9",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/longshotlabs/simpl-schema/releases/tag/1.10.2",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://snyk.io/vuln/SNYK-JS-SIMPLSCHEMA-1016157",
                "label": "POC"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4628/default-remediation-status"
            }
        ]
    }
}