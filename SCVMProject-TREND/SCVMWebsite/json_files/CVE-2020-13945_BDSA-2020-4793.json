{
    "source": "BDSA",
    "name": "BDSA-2020-4793",
    "title": "Apache APISIX Vulnerable to Remote Code Execution (RCE) via Improper Access Control using the Default 'Admin API' Token",
    "description": "Apache APISIX is vulnerable to remote code execution (RCE) via improper access control when using a default `Admin API` token and an allow all IP access. An authenticated attacker could exploit this flaw to execute remote code and gain access to APISIX management data.",
    "technicalDescription": "This vulnerability can be triggered by an authenticated attacker by using a default `Admin API` token and allowing any IP to access the Admin API. This flaw can then allow for unauthorized access to APISIX management data which should otherwise be restricted and allow for the execution of remote code.\n\nThis has been mitigated by displaying a warning message if a user has set a default `Admin API` token and allowed any IP address to access the `Admin API`.",
    "publishedDate": "2022-09-08T12:15:15.349Z",
    "updatedDate": "2022-09-08T12:15:15.339Z",
    "disclosureDate": "2020-12-07T00:00:00.000Z",
    "exploitPublishDate": "2022-03-07T00:00:00.000Z",
    "solution": "Fixed in version [**2.0**](https://github.com/apache/apisix/releases/tag/2.0) by [this](https://github.com/apache/apisix/commit/6a1fe8a546caae6f77dc1a49aae50b8d09f56d32) commit.\n\nThe latest stable releases can be found [here](https://github.com/apache/apisix/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 6.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "SINGLE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.4
        },
        "vector": "(AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 8.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 2.8,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "FUNCTIONAL",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.2
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "\u56fd\u5bb6\u4fe1\u606f\u5b89\u5168\u6f0f\u6d1e\u5171\u4eab\u5e73\u53f0",
    "workaround": "",
    "vendorFixDate": "2020-09-22T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.2,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4793",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-284"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-13945",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4793/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/apisix/commit/6a1fe8a546caae6f77dc1a49aae50b8d09f56d32",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/apisix/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/apache/apisix/releases/tag/2.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://lists.apache.org/thread/m0hzrdzrjy6k2obvbzr459w9lq4ygm33",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://packetstormsecurity.com/files/166228/apache_apisix_api_default_token_rce.rb.txt",
                "label": "EXPLOIT"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-4793/default-remediation-status"
            }
        ]
    }
}