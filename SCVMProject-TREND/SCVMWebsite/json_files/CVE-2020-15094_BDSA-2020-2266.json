{
    "source": "BDSA",
    "name": "BDSA-2020-2266",
    "title": "Symfony Vulnerable to Remote Code Execution (RCE) via Attacker Controlled Response to Request",
    "description": "Symfony is vulnerable to remote code execution (RCE) due to an attacker being able to control a response to a request made by the application.",
    "technicalDescription": "This vulnerability is due to `HttpCache` in the `CachingHttpClient` class of the `HttpClient` Symfony component being used to handle requests. Multiple headers used by `HttpCache` are intended for internal use from trusted parts of the backend, however `CachingHttpClient` exposes these in such a way that an attacker can control the responses to requests made, allowing attackers to give responses that can cause RCE.\n\nThis issue was fixed by stripping out HTTP headers only meant for internal use in `HttpCache` before remote responses are passed to `HttpCache`.",
    "publishedDate": "2020-09-03T16:18:21.645Z",
    "updatedDate": "2021-09-10T08:26:10.454Z",
    "disclosureDate": "2020-09-02T00:00:00.000Z",
    "solution": "Fixed in version [**4.4.13**](https://github.com/symfony/symfony/releases/tag/v4.4.13) and [**5.1.5**](https://github.com/symfony/symfony/releases/tag/v5.1.5) by [this](https://github.com/symfony/symfony/commit/d9910e0b33a2e0f993abff41c6fbc86951b66d78) commit.\n\nThe latest stable releases are available [here](https://github.com/symfony/symfony/releases).",
    "severity": "HIGH",
    "cvss2": {
        "baseScore": 7.5,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 10.0,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.5
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:P/A:P/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 9.8,
        "impactSubscore": 5.9,
        "exploitabilitySubscore": 3.9,
        "severity": "HIGH",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "HIGH",
        "availabilityImpact": "HIGH",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 8.5
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "credit": "Matthias Pigulla",
    "workaround": "",
    "vendorFixDate": "2020-09-02T00:00:00.000Z",
    "bdsaTags": [
        "RCE"
    ],
    "overallScore": 8.5,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2266",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-644"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15094",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2266/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/commit/d9910e0b33a2e0f993abff41c6fbc86951b66d78",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases/tag/v4.4.13",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/releases/tag/v5.1.5",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/symfony/symfony/security/advisories/GHSA-754h-5r27-7x3r",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-2266/default-remediation-status"
            }
        ]
    }
}