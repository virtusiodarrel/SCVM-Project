{
    "source": "BDSA",
    "name": "BDSA-2020-3017",
    "title": "Actions Toolkit Vulnerable to Unauthorized Modifications via Improper Input Validation in 'addPath' and 'exportVariable' Functions",
    "description": "Actions Toolkit contains an unauthorized modification vulnerability. Due to improper input validation an attacker could exploit this flaw to modify path or environmental variables.",
    "technicalDescription": "The vulnerability occurs due to insufficient validation of the `addPath` and `exportVariable` functions in the `@actions/core` npm module. The vulnerable functions generate a string in a specific format which is passed to the Actions Runner over stdout. This results in workflows that log untrusted data to stdout executing these commands, resulting in unintended modification of path or environment variables.",
    "publishedDate": "2020-10-28T15:24:52.117Z",
    "updatedDate": "2021-10-01T10:43:10.721Z",
    "disclosureDate": "2020-10-01T00:00:00.000Z",
    "solution": "Fixed in `actions/runner` version [**2.275.0**](https://github.com/actions/runner/releases/tag/v2.275.0) by [this](https://github.com/actions/runner/commit/a2e32170fd83851569804fa7b27d2cae235a5225) commit.",
    "severity": "LOW",
    "cvss2": {
        "baseScore": 2.1,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 3.9,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "HIGH",
        "authentication": "SINGLE",
        "confidentialityImpact": "NONE",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 1.6
        },
        "vector": "(AV:N/AC:H/Au:S/C:N/I:P/A:N/E:U/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 3.5,
        "impactSubscore": 1.4,
        "exploitabilitySubscore": 1.8,
        "severity": "LOW",
        "attackVector": "NETWORK",
        "attackComplexity": "HIGH",
        "confidentialityImpact": "NONE",
        "integrityImpact": "LOW",
        "availabilityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "CHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "UNPROVEN",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.1
        },
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:N/I:L/A:N/E:U/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "Upgrade to `@actions/core v1.2.6` or later, and replace any instance of the `set-env` or `add-path` commands in workflows with the new [Environment File Syntax](https://github.com/actions/toolkit/blob/main/docs/commands.md#environment-files).",
    "vendorFixDate": "2020-11-16T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 3.1,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3017",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-20"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2020-15228",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3017/ranges"
            },
            {
                "rel": "reference",
                "href": "https://github.com/actions/runner/commit/a2e32170fd83851569804fa7b27d2cae235a5225",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/actions/runner/releases/tag/v2.275.0",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/actions/toolkit/blob/main/docs/commands.md#environment-files",
                "label": "WORKAROUND"
            },
            {
                "rel": "reference",
                "href": "https://github.com/actions/toolkit/security/advisories/GHSA-mfwh-5m23-j46w",
                "label": "ADVISORY"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2020-3017/default-remediation-status"
            }
        ]
    }
}