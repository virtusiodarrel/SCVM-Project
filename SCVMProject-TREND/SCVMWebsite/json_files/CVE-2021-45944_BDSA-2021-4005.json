{
    "source": "BDSA",
    "name": "BDSA-2021-4005",
    "title": "GhostScript Vulnerable to Memory Corruption via Use-After-Free (UAF) in 'sampled_data_sample' Function",
    "description": "GhostScript is vulnerable to memory corruption due to the improper management of system memory resources. An attacker could corrupt the process's memory by tricking a victim into running the application with a maliciously crafted file as input.",
    "technicalDescription": "The function `sampled_data_sample()`, as defined in the file `psi/zfsample.c`, performs operations on a number of different objects which reside in heap memory. Cleanup operations are improperly handled by the application such that this function may end up attempting operations on an object which resides in a freed chunk. This can lead to an exception being raised, halting program execution. An attacker could leverage this issue using a maliciously crafted file in order to cause a denial-of-service (DoS). It may also be possible for the attacker to modify, or recover, sensitive data that resides in memory.",
    "publishedDate": "2022-01-17T15:05:03.915Z",
    "updatedDate": "2022-01-17T15:05:03.903Z",
    "disclosureDate": "2021-03-08T00:00:00.000Z",
    "exploitPublishDate": "2021-03-08T00:00:00.000Z",
    "solution": "Fixed in [**9.54.0**](https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/tag/gs9540) by [this](http://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=7861fcad13c497728189feafb41cd57b5b50ea25) commit.\n\nThe latest stable releases are available [here](https://www.ghostscript.com/download.html).",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 6.8,
        "impactSubscore": 6.4,
        "exploitabilitySubscore": 8.6,
        "severity": "MEDIUM",
        "accessVector": "NETWORK",
        "accessComplexity": "MEDIUM",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "PARTIAL",
        "availabilityImpact": "PARTIAL",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 5.3
        },
        "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 5.3,
        "impactSubscore": 3.4,
        "exploitabilitySubscore": 1.8,
        "severity": "MEDIUM",
        "attackVector": "LOCAL",
        "attackComplexity": "LOW",
        "confidentialityImpact": "LOW",
        "integrityImpact": "LOW",
        "availabilityImpact": "LOW",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "REQUIRED",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 4.8
        },
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": false,
    "parentAdvisory": false,
    "workaround": "",
    "vendorFixDate": "2021-02-12T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 4.8,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4005",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-416"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-45944",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4005/ranges"
            },
            {
                "rel": "reference",
                "href": "http://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=7861fcad13c497728189feafb41cd57b5b50ea25",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=29903",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=29903",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=45e765e59a45b46dcb05e8c729689a7c0574a48c",
                "label": "INTRODUCTORY_COMMIT"
            },
            {
                "rel": "reference",
                "href": "https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/tag/gs9540",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "reference",
                "href": "https://github.com/google/oss-fuzz-vulns/blob/main/vulns/ghostscript/OSV-2021-237.yaml",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.ghostscript.com/download.html",
                "label": "LINK"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-4005/default-remediation-status"
            }
        ]
    }
}