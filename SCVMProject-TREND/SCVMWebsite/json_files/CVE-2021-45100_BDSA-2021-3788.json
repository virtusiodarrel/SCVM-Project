{
    "source": "BDSA",
    "name": "BDSA-2021-3788",
    "title": "Linux Kernel Vulnerable to Plaintext Communication via SMB Protocol Misuse in 'ksmbd' Functionality",
    "description": "The `ksmbd` server functionality used in the Linux Kernel is vulnerable to an information disclosure issue due to how the server can incorrectly communicate in plaintext despite how encryption is enabled.\n\nAn attacker could intercept communications and use this flaw to perform man-in-the-middle (MitM) style attacks to access to potentially sensitive information.",
    "technicalDescription": "The Linux Kernel is vulnerable to an information disclosure issue because the `ksmbd` server functionality does not correctly adhere to specifications when using the SMB 3.1.1 protocol. The server incorrectly sets the `SMB2_GLOBAL_CAP_ENCRYPTION` flag when using the protocol where it should only be set for 3.0 and 3.0.2 dialects. This violation can cause clients to detect anomalies in negotiations and disable encryption.",
    "publishedDate": "2021-12-16T15:22:51.197Z",
    "updatedDate": "2022-07-18T10:07:16.459Z",
    "disclosureDate": "2021-12-15T00:00:00.000Z",
    "exploitPublishDate": "2021-12-15T00:00:00.000Z",
    "solution": "Fixed in:\n* [**5.15.12**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a2c144d17623984fdafa4634ecf4ab64580d29bb) commit\n* [**5.16-rc7**](https://www.kernel.org) by [this](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=83912d6d55be10d65b5268d1871168b9ebe1ec4b) commit",
    "severity": "MEDIUM",
    "cvss2": {
        "baseScore": 5.0,
        "impactSubscore": 2.9,
        "exploitabilitySubscore": 10.0,
        "severity": "LOW",
        "accessVector": "NETWORK",
        "accessComplexity": "LOW",
        "authentication": "NONE",
        "confidentialityImpact": "PARTIAL",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 3.9
        },
        "vector": "(AV:N/AC:L/Au:N/C:P/I:N/A:N/E:POC/RL:OF/RC:C)"
    },
    "cvss3": {
        "baseScore": 7.5,
        "impactSubscore": 3.6,
        "exploitabilitySubscore": 3.9,
        "severity": "MEDIUM",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "confidentialityImpact": "HIGH",
        "integrityImpact": "NONE",
        "availabilityImpact": "NONE",
        "privilegesRequired": "NONE",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "temporalMetrics": {
            "exploitability": "PROOF_OF_CONCEPT",
            "remediationLevel": "OFFICIAL_FIX",
            "reportConfidence": "CONFIRMED",
            "score": 6.7
        },
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C"
    },
    "useCvss3": true,
    "classifications": [],
    "zeroDay": false,
    "underReview": true,
    "parentAdvisory": false,
    "credit": "Marcos Del Sol Vives",
    "workaround": "",
    "vendorFixDate": "2021-12-17T00:00:00.000Z",
    "bdsaTags": [],
    "overallScore": 6.7,
    "_meta": {
        "allow": [
            "GET"
        ],
        "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3788",
        "links": [
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-300"
            },
            {
                "rel": "cwes",
                "href": "https://trendmicro2.app.blackduck.com/api/cwes/CWE-311"
            },
            {
                "rel": "related-vulnerability",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/CVE-2021-45100",
                "label": "NVD"
            },
            {
                "rel": "bdsa-ranges",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3788/ranges"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=83912d6d55be10d65b5268d1871168b9ebe1ec4b",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?id=a2c144d17623984fdafa4634ecf4ab64580d29bb",
                "label": "PATCH"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cifsd-team/ksmbd/issues/550",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cifsd-team/ksmbd/issues/550",
                "label": "POC"
            },
            {
                "rel": "reference",
                "href": "https://github.com/cifsd-team/ksmbd/pull/551",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://lore.kernel.org/lkml/20211216103721.1686600-1-marcos@orca.pet/",
                "label": "ADVISORY"
            },
            {
                "rel": "reference",
                "href": "https://www.kernel.org",
                "label": "VENDOR_UPGRADE"
            },
            {
                "rel": "default-remediation-status",
                "href": "https://trendmicro2.app.blackduck.com/api/vulnerabilities/BDSA-2021-3788/default-remediation-status"
            }
        ]
    }
}